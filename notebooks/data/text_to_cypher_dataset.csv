question,cypher,type,database,syntax_error,timeout,returns_results,false_schema
Who are the top 5 users with the most interactions having a weight greater than 5?,"MATCH (u:User)-[r:INTERACTED]->(:User)
WHERE r.weight > 5
WITH u, count(r) AS interactions
ORDER BY interactions DESC
LIMIT 5
RETURN u",Complex Retrieval Queries,bluesky,False,False,True,
List the top 5 users having the most interactions with a specific key in 'INTERACTED' relationship.,"MATCH (u:User)-[r:INTERACTED]->(:User)
WHERE r.key = 'specific_key'
WITH u, count(r) AS interactions
ORDER BY interactions DESC
LIMIT 5
RETURN u.label, interactions",Complex Retrieval Queries,bluesky,False,False,False,
Which 3 users have the largest size and a color of '#3CB371'?,"MATCH (u:User)
WHERE u.color = '#3CB371' AND u.size IS NOT NULL
RETURN u
ORDER BY u.size DESC
LIMIT 3",Complex Retrieval Queries,bluesky,False,False,True,
Show the top 5 users who have interacted with users having a color of '#FF4500'.,"MATCH (u:User)-[:INTERACTED]->(v:User {color: '#FF4500'})
WITH u, count{(u)-[:INTERACTED]->(v)} AS interactions
ORDER BY interactions DESC
LIMIT 5
RETURN u",Complex Retrieval Queries,bluesky,False,False,True,
Find the top 3 users interacted with by 'sarahp.bsky.social'.,"MATCH (u:User {label: 'sarahp.bsky.social'})-[:INTERACTED]->(interactedUser:User)
RETURN interactedUser
ORDER BY count{(u)-[:INTERACTED]->(interactedUser)} DESC
LIMIT 3",Complex Retrieval Queries,bluesky,False,False,True,
List all interactions where the original weight (ogWeight) is greater than the current weight.,"MATCH (u1:User)-[r:INTERACTED]->(u2:User)
WHERE r.ogWeight > r.weight
RETURN u1, r, u2",Pathfinding Queries,bluesky,False,False,False,
List the top 5 users with the smallest area attribute.,"MATCH (u:User)
RETURN u
ORDER BY u.area ASC
LIMIT 5",Complex Retrieval Queries,bluesky,False,False,True,
Show 3 users who have interacted with users located at y-coordinate values greater than 10000.,"MATCH (u1:User)-[:INTERACTED]->(u2:User)
WHERE u2.y > 10000
RETURN u1
LIMIT 3",Complex Retrieval Queries,bluesky,False,False,True,
Which 5 users have interacted with the most users with a size over 2?,"MATCH (u:User)-[r:INTERACTED]->(v:User)
WHERE v.size > 2
WITH u, count(v) AS interactions
ORDER BY interactions DESC
LIMIT 5
RETURN u",Complex Retrieval Queries,bluesky,False,False,True,
Find the top 3 users who have a label containing 'bsky.social'.,"MATCH (u:User)
WHERE u.label CONTAINS 'bsky.social'
RETURN u
ORDER BY u.size DESC
LIMIT 3",Complex Retrieval Queries,bluesky,False,False,True,
List the top 5 users who have a color attribute of '#4A708B' and size greater than 2.5.,"MATCH (u:User)
WHERE u.color = '#4A708B' AND u.size > 2.5
RETURN u
ORDER BY u.size DESC
LIMIT 5",Complex Retrieval Queries,bluesky,False,False,True,
Which 3 users have interacted with those having a 'color' attribute of '#FF4500'?,"MATCH (u:User)-[:INTERACTED]->(v:User {color: '#FF4500'})
RETURN u
LIMIT 3",Complex Retrieval Queries,bluesky,False,False,True,
Show the top 5 users with the most negative y-coordinate values.,"MATCH (u:User)
WHERE u.y < 0
RETURN u
ORDER BY u.y ASC
LIMIT 5",Complex Retrieval Queries,bluesky,False,False,True,
Who are the top 5 users with x-coordinate values less than -5000?,"MATCH (u:User)
WHERE u.x < -5000
RETURN u
ORDER BY u.x DESC
LIMIT 5",Complex Retrieval Queries,bluesky,False,False,True,
List the top 3 users who have interacted with others but have a size less than 2.,"MATCH (u:User)-[r:INTERACTED]->(:User)
WHERE u.size < 2
RETURN u, count(r) AS interactions
ORDER BY interactions DESC
LIMIT 3",Complex Retrieval Queries,bluesky,False,False,True,
Find 3 users located at x-coordinate values greater than 10000.,"MATCH (u:User)
WHERE u.x > 10000
RETURN u
LIMIT 3",Complex Retrieval Queries,bluesky,False,False,True,
Which 5 users have the least number of interactions?,"MATCH (u:User)
RETURN u, count{(u)-[:INTERACTED]->(:User)} AS interactions
ORDER BY interactions ASC
LIMIT 5",Complex Retrieval Queries,bluesky,False,False,True,
Who are the top 5 users based on their area and size combined?,"MATCH (u:User)
RETURN u.label, u.area + u.size AS combined_area_size
ORDER BY combined_area_size DESC
LIMIT 5",Complex Retrieval Queries,bluesky,False,False,True,
Show 3 users who have a size greater than 2 and a color of '#FF7F50'.,"MATCH (u:User)
WHERE u.size > 2 AND u.color = '#FF7F50'
RETURN u
LIMIT 3",Complex Retrieval Queries,bluesky,False,False,True,
Which top 5 users have the most interactions?,"MATCH (u:User)-[r:INTERACTED]->(:User)
RETURN u.label, count(r) AS interactions
ORDER BY interactions DESC
LIMIT 5",Complex Retrieval Queries,bluesky,False,False,True,
List the 3 users who have interacted most frequently based on the 'weight' attribute of INTERACTED.,"MATCH (u:User)-[r:INTERACTED]->(:User)
RETURN u.label, sum(r.weight) AS totalWeight
ORDER BY totalWeight DESC
LIMIT 3",Complex Retrieval Queries,bluesky,False,False,True,
What are the top 3 users by the smallest x-coordinate values?,"MATCH (u:User)
WHERE u.x IS NOT NULL
RETURN u
ORDER BY u.x ASC
LIMIT 3",Complex Retrieval Queries,bluesky,False,False,True,
Find the top 5 users with 'color' attribute set to '#3CB371'.,"MATCH (u:User {color: '#3CB371'})
RETURN u
ORDER BY u.size DESC
LIMIT 5",Complex Retrieval Queries,bluesky,False,False,True,
Who are the 3 users with the highest y-coordinate values?,"MATCH (u:User)
RETURN u
ORDER BY u.y DESC
LIMIT 3",Complex Retrieval Queries,bluesky,False,False,True,
List the top 5 users who have interacted with 'louisgray.com'.,"MATCH (u:User {label: 'louisgray.com'})-[:INTERACTED]->(other:User)
RETURN other
ORDER BY count{(u)-[:INTERACTED]->(other)} DESC
LIMIT 5",Complex Retrieval Queries,bluesky,False,False,True,
Which 3 users have the smallest size attribute?,"MATCH (u:User)
RETURN u
ORDER BY u.size ASC
LIMIT 3",Complex Retrieval Queries,bluesky,False,False,True,
What are the top 5 users with the largest area?,"MATCH (u:User)
RETURN u
ORDER BY u.area DESC
LIMIT 5",Complex Retrieval Queries,bluesky,False,False,True,
List the top 5 users with y-coordinates within the range of 5000 to 6000.,"MATCH (u:User)
WHERE u.y >= 5000 AND u.y <= 6000
RETURN u
ORDER BY u.y DESC
LIMIT 5",Simple Retrieval Queries,bluesky,False,False,True,
Which 3 users have the closest x-coordinate to 0?,"MATCH (u:User)
WHERE u.x IS NOT NULL
RETURN u
ORDER BY abs(u.x)
LIMIT 3",Simple Retrieval Queries,bluesky,False,False,True,
What are the areas of the top 3 users with a size greater than 3.0?,"MATCH (u:User)
WHERE u.size > 3.0
RETURN u.area
ORDER BY u.area DESC
LIMIT 3",Simple Retrieval Queries,bluesky,False,False,True,
Identify the top 5 users by the color property '#FF4500'.,"MATCH (u:User {color: '#FF4500'})
RETURN u
ORDER BY u.size DESC
LIMIT 5",Simple Retrieval Queries,bluesky,False,False,True,
Find 3 users who have interacted with users having an area greater than 5.,"MATCH (u:User)-[:INTERACTED]->(v:User)
WHERE v.area > 5
RETURN u
LIMIT 3",Complex Retrieval Queries,bluesky,False,False,True,
List the labels of users who have an INTERACTED relationship with a weight of 1. Limit to the first 3.,"MATCH (u1:User)-[r:INTERACTED]->(u2:User)
WHERE r.weight = 1
RETURN u1.label
LIMIT 3",Simple Retrieval Queries,bluesky,False,False,True,
Which top 5 users have interacted with those having a 'color' attribute of '#87CEFA'?,"MATCH (u:User)-[:INTERACTED]->(v:User {color: '#87CEFA'})
RETURN u
ORDER BY count{(u)-[:INTERACTED]->(v)} DESC
LIMIT 5",Complex Retrieval Queries,bluesky,False,False,True,
Who are the top 5 users based on the sum of their area and size attributes?,"MATCH (u:User)
RETURN u.label, (u.area + u.size) AS totalValue
ORDER BY totalValue DESC
LIMIT 5",Complex Retrieval Queries,bluesky,False,False,True,
Show the interaction relationships of 'vtcodes.dev' where the interaction size is greater than 0.5.,"MATCH (u:User {label: 'vtcodes.dev'})-[r:INTERACTED]->(other:User)
WHERE r.size > 0.5
RETURN u, r, other",Pathfinding Queries,bluesky,False,False,True,
What are the x and y coordinates of the first 3 users who interacted with 'dwither.bsky.social'?,"MATCH (u:User {label: 'dwither.bsky.social'})-[:INTERACTED]->(interactedUser:User)
RETURN interactedUser.x, interactedUser.y
LIMIT 3",Pathfinding Queries,bluesky,False,False,True,
List all interactions with a size less than 2 between users.,"MATCH (u1:User)-[r:INTERACTED]->(u2:User)
WHERE r.size < 2
RETURN u1, r, u2",Pathfinding Queries,bluesky,False,True,False,
Which users have an area less than 3 and have interacted with 'inchristbl.bsky.social'?,"MATCH (u:User)-[:INTERACTED]->(:User {label: 'inchristbl.bsky.social'})
WHERE u.area < 3
RETURN u",Pathfinding Queries,bluesky,False,False,True,
Show the users with an x-coordinate less than -5000 who have interacted with any user.,"MATCH (u:User)-[:INTERACTED]->(:User)
WHERE u.x < -5000
RETURN u",Pathfinding Queries,bluesky,False,True,False,
Find the users who have a size greater than 2 and have interacted with 'sarahgerrard.me'.,"MATCH (u:User)-[:INTERACTED]->(target:User {label: 'sarahgerrard.me'})
WHERE u.size > 2
RETURN u",Pathfinding Queries,bluesky,False,False,True,
Which users have an interaction weight of 1 with 'tagomoris.bsky.social'?,"MATCH (u1:User)-[r:INTERACTED]->(u2:User {label: 'tagomoris.bsky.social'})
WHERE r.weight = 1
RETURN u1, r, u2",Pathfinding Queries,bluesky,False,False,True,
What are the first 3 colors of users interacted by 'r0yart.bsky.social'?,"MATCH (u:User {label: 'r0yart.bsky.social'})-[:INTERACTED]->(interactedUser:User)
RETURN interactedUser.color
LIMIT 3",Pathfinding Queries,bluesky,False,False,True,
List the top 5 users by area size who have relations with 'vtcodes.dev'.,"MATCH (u:User)-[:INTERACTED]->(:User {label: 'vtcodes.dev'})
RETURN u.label AS UserLabel, u.area AS UserArea
ORDER BY u.area DESC
LIMIT 5",Pathfinding Queries,bluesky,False,False,True,
Which users have interacted with 'curvylliptic.bsky.social'?,"MATCH (u:User {label: 'curvylliptic.bsky.social'})-[:INTERACTED]->(interactedUser:User)
RETURN interactedUser",Pathfinding Queries,bluesky,False,False,True,
List the first 3 users who have an area greater than 4 and have interacted with users with an area less than 3.,"MATCH (u1:User)-[:INTERACTED]->(u2:User)
WHERE u1.area > 4 AND u2.area < 3
RETURN u1
LIMIT 3",Simple Aggregation Queries,bluesky,False,False,True,
Identify the top 5 users based on the interaction weight who have a color of '#4A708B'.,"MATCH (u:User)-[r:INTERACTED]->(:User)
WHERE u.color = '#4A708B'
RETURN u.label, sum(r.weight) AS totalWeight
ORDER BY totalWeight DESC
LIMIT 5",Simple Aggregation Queries,bluesky,False,False,True,
Display 5 users who have a y-coordinate greater than 5000 and have interacted with users with a y-coordinate less than -5000.,"MATCH (u1:User)-[:INTERACTED]->(u2:User)
WHERE u1.y > 5000 AND u2.y < -5000
RETURN u1
LIMIT 5",Simple Aggregation Queries,bluesky,False,False,True,
List the 3 users who have the highest interaction size and are colored '#FF4500'.,"MATCH (u:User {color: '#FF4500'})-[:INTERACTED]->(v:User)
WITH u, sum(r.size) AS totalInteractionSize
ORDER BY totalInteractionSize DESC
LIMIT 3
RETURN u.label, u.key, totalInteractionSize",Simple Aggregation Queries,bluesky,True,False,False,
Show the top 3 users who have a label containing the word 'com'.,"MATCH (u:User)
WHERE u.label CONTAINS 'com'
RETURN u
ORDER BY u.size DESC
LIMIT 3",Complex Retrieval Queries,bluesky,False,False,True,
Who are the top 3 users by y-coordinate that have interacted with users with a y-coordinate more than 10000?,"MATCH (u1:User)-[:INTERACTED]->(u2:User)
WHERE u2.y > 10000
WITH u1
ORDER BY u1.y DESC
LIMIT 3
RETURN u1",Simple Aggregation Queries,bluesky,False,False,True,
List 5 users who have the color '#1E90FF' and have interacted with users with a color of '#3CB371'.,"MATCH (u1:User {color: '#1E90FF'})-[:INTERACTED]->(u2:User {color: '#3CB371'})
RETURN u1
LIMIT 5",Simple Aggregation Queries,bluesky,False,False,True,
Who are the top 3 users with a size greater than 2 and have interacted with users with a size greater than 2?,"MATCH (u:User)-[r:INTERACTED]->(v:User)
WHERE u.size > 2 AND v.size > 2
RETURN u.label AS UserLabel, count(r) AS InteractionCount
ORDER BY InteractionCount DESC
LIMIT 3",Simple Aggregation Queries,bluesky,False,False,True,
Display the first 3 users with x-coordinates less than -5000.,"MATCH (u:User)
WHERE u.x < -5000
RETURN u
ORDER BY u.x
LIMIT 3",Simple Aggregation Queries,bluesky,False,False,True,
What are the top 5 users who have interacted with others at y-coordinates less than 0?,"MATCH (u:User)-[:INTERACTED]->(:User)
WHERE u.y < 0
RETURN u
ORDER BY u.y
LIMIT 5",Simple Aggregation Queries,bluesky,False,False,True,
Show 3 users who have interacted with users located at x-coordinates greater than -500.,"MATCH (u1:User)-[:INTERACTED]->(u2:User)
WHERE u2.x > -500
RETURN u1
LIMIT 3",Simple Aggregation Queries,bluesky,False,False,True,
List the top 3 users with the largest area who have an interaction weight of 1.,"MATCH (u:User)-[r:INTERACTED]->(:User)
WHERE r.weight = 1
RETURN u.label, u.area
ORDER BY u.area DESC
LIMIT 3",Simple Aggregation Queries,bluesky,False,False,True,
What are the top 5 users in terms of size who have been interacted with the most?,"MATCH (u:User)-[r:INTERACTED]->(:User)
WITH u, count(r) AS interactions
ORDER BY interactions DESC, u.size DESC
RETURN u.label, u.size, interactions
LIMIT 5",Simple Aggregation Queries,bluesky,False,False,True,
Find 3 users who have interacted with users having a color of '#FF4500'.,"MATCH (u:User)-[:INTERACTED]->(v:User {color: '#FF4500'})
RETURN u
LIMIT 3",Simple Aggregation Queries,bluesky,False,False,True,
Which users have a color of '#3CB371' and an area less than 3? Limit to 5 results.,"MATCH (u:User)
WHERE u.color = '#3CB371' AND u.area < 3
RETURN u
LIMIT 5",Simple Aggregation Queries,bluesky,False,False,True,
Identify the top 3 users with the smallest y-coordinate values.,"MATCH (u:User)
WHERE u.y IS NOT NULL
RETURN u
ORDER BY u.y ASC
LIMIT 3",Simple Aggregation Queries,bluesky,False,False,True,
Who are the top 5 users sorted by the x-coordinate in ascending order?,"MATCH (u:User)
RETURN u
ORDER BY u.x ASC
LIMIT 5",Simple Aggregation Queries,bluesky,False,False,True,
List 3 users who have interacted with 'chromevoid.bsky.social'.,"MATCH (u:User {label: 'chromevoid.bsky.social'})-[:INTERACTED]->(interactedUser:User)
RETURN interactedUser
LIMIT 3",Simple Aggregation Queries,bluesky,False,False,True,
Which 3 users have an area greater than 5?,"MATCH (u:User)
WHERE u.area > 5
RETURN u
ORDER BY u.area DESC
LIMIT 3",Simple Aggregation Queries,bluesky,False,False,True,
What are the top 5 users by the size property?,"MATCH (u:User)
RETURN u
ORDER BY u.size DESC
LIMIT 5",Simple Aggregation Queries,bluesky,False,False,True,
Find 3 users with an x-coordinate greater than -1000 and who have interacted with users with an x-coordinate less than -5000.,"MATCH (u1:User)-[:INTERACTED]->(u2:User)
WHERE u1.x > -1000 AND u2.x < -5000
RETURN u1
LIMIT 3",Simple Aggregation Queries,bluesky,False,False,True,
Who are the 3 users that have interacted the most frequently with others?,"MATCH (u:User)-[r:INTERACTED]->(:User)
RETURN u, count(r) AS interactions
ORDER BY interactions DESC
LIMIT 3",Simple Retrieval Queries,bluesky,False,False,True,
Find the keys of the top 5 users who have an INTERACTED relationship with a size greater than 0.1.,"MATCH (u:User)-[r:INTERACTED]->(:User)
WHERE r.size > 0.1
RETURN u.key
ORDER BY r.size DESC
LIMIT 5",Simple Retrieval Queries,bluesky,False,False,True,
What are the top 3 heaviest INTERACTED relationships by ogWeight?,"MATCH (u1:User)-[r:INTERACTED]->(u2:User)
RETURN u1, r, u2
ORDER BY r.ogWeight DESC
LIMIT 3",Simple Retrieval Queries,bluesky,False,False,True,
What are the average x and y coordinates of users who have interacted with users with a size smaller than 2?,"MATCH (u1:User)-[:INTERACTED]->(u2:User)
WHERE u2.size < 2
RETURN avg(u1.x) AS averageX, avg(u1.y) AS averageY",Complex Aggregation Queries,bluesky,False,False,True,
Display the top 5 users with the highest ogWeight in their interactions.,"MATCH (u:User)-[r:INTERACTED]->(:User)
RETURN u.label AS UserLabel, sum(r.ogWeight) AS TotalOgWeight
ORDER BY TotalOgWeight DESC
LIMIT 5",Complex Aggregation Queries,bluesky,False,False,True,
Retrieve the first 3 users with the smallest x-coordinate values who have interacted with others.,"MATCH (u:User)-[:INTERACTED]->(:User)
WHERE u.x IS NOT NULL
RETURN u
ORDER BY u.x ASC
LIMIT 3",Complex Aggregation Queries,bluesky,False,False,True,
Who are the users with the top 5 highest y-coordinate values and have at least one interaction?,"MATCH (u:User)-[:INTERACTED]->(:User)
WITH u
ORDER BY u.y DESC
LIMIT 5
RETURN u",Complex Aggregation Queries,bluesky,False,False,True,
List the users who have interacted and have a color code of '#FF4500'.,"MATCH (u:User)-[:INTERACTED]->(:User)
WHERE u.color = '#FF4500'
RETURN u",Complex Aggregation Queries,bluesky,False,False,True,
What are the most common interaction weights among users who have interacted with more than two different users?,"MATCH (u:User)-[r:INTERACTED]->(:User)
WITH u, r.weight AS weight, count(DISTINCT r) AS interactions
WHERE interactions > 2
RETURN weight, count(weight) AS frequency
ORDER BY frequency DESC",Complex Aggregation Queries,bluesky,False,False,True,
Find the top 3 users with the greatest number of interactions.,"MATCH (u:User)-[r:INTERACTED]->(:User)
RETURN u.label, count(r) AS interactions
ORDER BY interactions DESC
LIMIT 3",Complex Aggregation Queries,bluesky,False,False,True,
Identify users who have interacted with someone and have an area size of exactly 2.6.,"MATCH (u:User)-[:INTERACTED]->(:User)
WHERE u.area = 2.6
RETURN u",Complex Aggregation Queries,bluesky,False,False,True,
Show the ogWeight and weight properties for interactions involving users with a label containing 'social'.,"MATCH (u1:User)-[r:INTERACTED]->(u2:User)
WHERE u1.label CONTAINS 'social' OR u2.label CONTAINS 'social'
RETURN r.ogWeight, r.weight",Complex Aggregation Queries,bluesky,False,True,False,
List the interactions among the first 5 users with the largest size values.,"MATCH (u1:User)-[i:INTERACTED]->(u2:User)
WITH u1, i, u2
ORDER BY u1.size DESC
LIMIT 5
RETURN u1, i, u2",Complex Aggregation Queries,bluesky,False,False,True,
"Which users have a color property of ""#3CB371""? Please list the top 5.","MATCH (u:User {color: ""#3CB371""})
RETURN u
ORDER BY u.key
LIMIT 5",Verbose query,bluesky,False,False,True,
Identify the top 5 users with an area property greater than 4.0.,"MATCH (u:User)
WHERE u.area > 4.0
RETURN u
ORDER BY u.area DESC
LIMIT 5",Verbose query,bluesky,False,False,True,
What are the first 3 users with a size property less than 2.0?,"MATCH (u:User)
WHERE u.size < 2.0
RETURN u
ORDER BY u.size
LIMIT 3",Verbose query,bluesky,False,False,True,
"List the top 5 users who interacted with a user whose color property is ""#1E90FF"".","MATCH (u:User {color: ""#1E90FF""})<-[:INTERACTED]-(interactor:User)
RETURN interactor
ORDER BY count{(interactor)-[:INTERACTED]->(u)} DESC
LIMIT 5",Verbose query,bluesky,False,False,True,
Show the relationship properties for interactions between users with an area greater than 3.0.,"MATCH (u1:User)-[r:INTERACTED]->(u2:User)
WHERE u1.area > 3.0 AND u2.area > 3.0
RETURN r.weight, r.ogWeight, r.size, r.key",Complex Aggregation Queries,bluesky,False,True,False,
Can you find 5 users who have interacted with others more than once?,"MATCH (u:User)-[r:INTERACTED]->(:User)
WHERE r.weight > 1
RETURN u
LIMIT 5",Verbose query,bluesky,False,False,True,
What are the first 3 users with a y property value greater than 10000?,"MATCH (u:User)
WHERE u.y > 10000
RETURN u
ORDER BY u.y ASC
LIMIT 3",Verbose query,bluesky,False,False,True,
List the top 5 users who have an interaction weight greater than 5.,"MATCH (u:User)-[r:INTERACTED]->(:User)
WHERE r.weight > 5
RETURN u.label AS UserLabel, r.weight AS InteractionWeight
ORDER BY r.weight DESC
LIMIT 5",Verbose query,bluesky,False,False,True,
Find all users who have interacted with 'vtcodes.dev'. List the top 5.,"MATCH (u:User)-[:INTERACTED]->(target:User {label: 'vtcodes.dev'})
RETURN u
ORDER BY u.size DESC
LIMIT 5",Verbose query,bluesky,False,False,True,
Who are the top 5 users that have interacted with someone with an area larger than 3.0?,"MATCH (u1:User)-[r:INTERACTED]->(u2:User)
WHERE u2.area > 3.0
RETURN u1.label AS UserLabel, count(r) AS Interactions
ORDER BY Interactions DESC
LIMIT 5",Verbose query,bluesky,False,False,True,
Which users have interacted with 'sarahgerrard.me'? Present the first 5.,"MATCH (u:User {label: 'sarahgerrard.me'})-[:INTERACTED]->(interactedUser:User)
RETURN interactedUser
LIMIT 5",Verbose query,bluesky,False,False,True,
Display the labels of 5 users who have an interaction size of 0.2.,"MATCH (u:User)-[r:INTERACTED]->(:User)
WHERE r.size = 0.2
RETURN u.label
LIMIT 5",Verbose query,bluesky,False,False,True,
Identify the first 5 users who have interacted with a user labeled 'dwither.bsky.social'.,"MATCH (u:User)-[:INTERACTED]->(:User {label: 'dwither.bsky.social'})
RETURN u
LIMIT 5",Verbose query,bluesky,False,False,True,
List the top 5 users based on their size property in descending order.,"MATCH (u:User)
RETURN u
ORDER BY u.size DESC
LIMIT 5",Verbose query,bluesky,False,False,True,
What are the top 5 users with the smallest y property value?,"MATCH (u:User)
WHERE u.y IS NOT NULL
RETURN u
ORDER BY u.y ASC
LIMIT 5",Verbose query,bluesky,False,False,True,
Which users have a label including 'social' and an area more than 2.0? List the top 5.,"MATCH (u:User)
WHERE u.label CONTAINS 'social' AND u.area > 2.0
RETURN u
ORDER BY u.area DESC
LIMIT 5",Verbose query,bluesky,False,False,True,
Display the first 3 users who have interacted with someone located at y values less than -5000.,"MATCH (u1:User)-[:INTERACTED]->(u2:User)
WHERE u2.y < -5000
RETURN u1
LIMIT 3",Verbose query,bluesky,False,False,True,
Identify the first 5 users with an interaction ogWeight of 1.,"MATCH (u:User)-[r:INTERACTED]->(:User)
WHERE r.ogWeight = 1
RETURN u
LIMIT 5",Verbose query,bluesky,False,False,True,
What are the top 5 users who interacted with others having a color '#FF4500'?,"MATCH (u:User)-[:INTERACTED]->(other:User {color: '#FF4500'})
RETURN u.label, count{(u)-[:INTERACTED]->(other)} AS interactions
ORDER BY interactions DESC
LIMIT 5",Verbose query,bluesky,False,False,True,
List the first 3 users with the largest area property.,"MATCH (u:User)
RETURN u
ORDER BY u.area DESC
LIMIT 3",Verbose query,bluesky,False,False,True,
Provide the labels of the top 5 users with an x property value between -5000 and 0.,"MATCH (u:User)
WHERE u.x >= -5000 AND u.x <= 0
RETURN u.label
ORDER BY u.x DESC
LIMIT 5",Verbose query,bluesky,False,False,True,
What are the labels of the top 5 users with the largest interaction size in their relationships?,"MATCH (u:User)-[r:INTERACTED]->(:User)
RETURN u.label AS UserLabel, sum(r.size) AS TotalInteractionSize
ORDER BY TotalInteractionSize DESC
LIMIT 5",Pathfinding Queries,bluesky,False,False,True,
List users who have a green color code and have interacted with users having a red color code.,"MATCH (greenUser:User {color: ""#3CB371""})-[:INTERACTED]->(redUser:User {color: ""#FF0000""})
RETURN greenUser",Complex Aggregation Queries,bluesky,False,False,False,
What is the average weight of interactions for users who have interacted more than 5 times?,"MATCH (u:User)-[r:INTERACTED]->(:User)
WITH u, count(r) AS interactions
WHERE interactions > 5
RETURN avg(r.weight) AS averageWeight",Complex Aggregation Queries,bluesky,True,False,False,
List the 3 users with the most interactions based on the weight of the INTERACTED relationship.,"MATCH (u:User)-[r:INTERACTED]->(:User)
RETURN u.label, sum(r.weight) AS totalWeight
ORDER BY totalWeight DESC
LIMIT 3",Simple Retrieval Queries,bluesky,False,False,True,
What are the labels of 3 users who have interacted with the user labeled 'chromevoid.bsky.social'?,"MATCH (u:User {label: 'chromevoid.bsky.social'})-[:INTERACTED]->(interactedUser:User)
RETURN interactedUser.label
LIMIT 3",Simple Retrieval Queries,bluesky,False,False,True,
Who are the top 5 users with a size less than 2.0?,"MATCH (u:User)
WHERE u.size < 2.0
RETURN u
ORDER BY u.size DESC
LIMIT 5",Simple Retrieval Queries,bluesky,False,False,True,
Find 3 users whose y-coordinate is less than -5000.,"MATCH (u:User)
WHERE u.y < -5000
RETURN u
LIMIT 3",Simple Retrieval Queries,bluesky,False,False,True,
Which users have an area greater than 5.0? Limit the results to the first 3.,"MATCH (u:User)
WHERE u.area > 5.0
RETURN u
LIMIT 3",Simple Retrieval Queries,bluesky,False,False,True,
What are the keys of the top 3 users with the largest x values?,"MATCH (u:User)
RETURN u.key
ORDER BY u.x DESC
LIMIT 3",Simple Retrieval Queries,bluesky,False,False,True,
List the top 5 users with the smallest area values.,"MATCH (u:User)
RETURN u
ORDER BY u.area ASC
LIMIT 5",Simple Retrieval Queries,bluesky,False,False,True,
Which 3 users have a color property of '#3CB371'?,"MATCH (u:User {color: '#3CB371'})
RETURN u
LIMIT 3",Simple Retrieval Queries,bluesky,False,False,True,
Identify the 3 users with the highest size values.,"MATCH (u:User)
RETURN u
ORDER BY u.size DESC
LIMIT 3",Simple Retrieval Queries,bluesky,False,False,True,
List the top 5 users by y-coordinate in ascending order.,"MATCH (u:User)
WHERE u.y IS NOT NULL
RETURN u
ORDER BY u.y ASC
LIMIT 5",Simple Retrieval Queries,bluesky,False,False,True,
Which 3 users have the smallest x values?,"MATCH (u:User)
RETURN u
ORDER BY u.x ASC
LIMIT 3",Simple Retrieval Queries,bluesky,False,False,True,
What are the labels of the top 5 users with the largest area?,"MATCH (u:User)
RETURN u.label
ORDER BY u.area DESC
LIMIT 5",Simple Retrieval Queries,bluesky,False,False,True,
Find the users with a y-coordinate greater than 5000 and have interacted with at least two other users.,"MATCH (u:User)
WHERE u.y > 5000 AND count{(u)-[:INTERACTED]->(:User)} >= 2
RETURN u",Pathfinding Queries,bluesky,False,False,True,
What are the top 5 user interactions based on the interaction weight in descending order?,"MATCH (u1:User)-[r:INTERACTED]->(u2:User)
RETURN u1, u2, r.weight AS interactionWeight
ORDER BY r.weight DESC
LIMIT 5",Pathfinding Queries,bluesky,False,False,True,
Find users who have interacted with more than three different users.,"MATCH (u:User)-[:INTERACTED]->(other:User)
WITH u, count(DISTINCT other) AS interactions
WHERE interactions > 3
RETURN u",Complex Aggregation Queries,bluesky,False,False,True,
Which users have interacted with a user located at x-coordinate less than -10000?,"MATCH (u1:User)-[:INTERACTED]->(u2:User)
WHERE u2.x < -10000
RETURN u1",Pathfinding Queries,bluesky,False,False,True,
Show the interaction details of users with a label containing 'social' and have a size greater than 1.5.,"MATCH (u1:User)-[r:INTERACTED]->(u2:User)
WHERE u1.label CONTAINS 'social' AND u1.size > 1.5
RETURN u1, r, u2",Pathfinding Queries,bluesky,False,True,False,
Which users have interacted with users located at a y-coordinate greater than 10000?,"MATCH (u1:User)-[:INTERACTED]->(u2:User)
WHERE u2.y > 10000
RETURN u1",Complex Aggregation Queries,bluesky,False,False,True,
Identify users who have a label containing 'bsky' and have interacted with users with a label containing 'dev'.,"MATCH (u1:User)-[:INTERACTED]->(u2:User)
WHERE u1.label CONTAINS 'bsky' AND u2.label CONTAINS 'dev'
RETURN u1, u2",Complex Aggregation Queries,bluesky,False,False,True,
What are the unique color codes used by users who have interacted with at least one other user?,"MATCH (u:User)-[:INTERACTED]->(:User)
WHERE u.color IS NOT NULL
RETURN DISTINCT u.color",Complex Aggregation Queries,bluesky,False,False,True,
List the first 3 users by size who have not interacted with any other user.,"MATCH (u:User)
WHERE NOT exists{ (u)-[:INTERACTED]->(:User) }
RETURN u
ORDER BY u.size DESC
LIMIT 3",Complex Aggregation Queries,bluesky,False,False,True,
Find the top 5 users with the largest area who have interacted with others.,"MATCH (u:User)-[:INTERACTED]->(:User)
WHERE u.area IS NOT NULL
RETURN u
ORDER BY u.area DESC
LIMIT 5",Complex Aggregation Queries,bluesky,False,False,True,
List the users who have interacted with users having an area exactly 4.94.,"MATCH (u:User)-[:INTERACTED]->(v:User {area: 4.94})
RETURN u",Pathfinding Queries,bluesky,False,False,True,
Which users have interacted with users having a blue color code?,"MATCH (u:User)-[:INTERACTED]->(v:User {color: ""#0000FF""})
RETURN u",Complex Aggregation Queries,bluesky,False,False,False,
Show the first 3 users based on the descending order of their x-coordinate who have interacted at least once.,"MATCH (u:User)-[:INTERACTED]->(:User)
WITH u
ORDER BY u.x DESC
RETURN u
LIMIT 3",Pathfinding Queries,bluesky,False,False,True,
List the interactions of users whose labels start with 'r' and have interacted with users of size greater than 2.,"MATCH (u1:User)-[i:INTERACTED]->(u2:User)
WHERE u1.label STARTS WITH 'r' AND u2.size > 2
RETURN u1, i, u2",Pathfinding Queries,bluesky,False,False,True,
Find all users who have interacted with 'dwither.bsky.social' and have a size of 3.25.,"MATCH (u:User)-[:INTERACTED]->(:User {label: 'dwither.bsky.social'})
WHERE u.size = 3.25
RETURN u",Pathfinding Queries,bluesky,False,False,True,
Identify the users who have interacted with users located at y-coordinate less than -5000.,"MATCH (u1:User)-[:INTERACTED]->(u2:User)
WHERE u2.y < -5000
RETURN u1",Pathfinding Queries,bluesky,False,True,False,
Which users have an interaction key 'geid_68_0' and have interacted with 'vtcodes.dev'?,"MATCH (u1:User)-[r:INTERACTED]->(u2:User {label: 'vtcodes.dev'})
WHERE r.key = 'geid_68_0'
RETURN u1",Pathfinding Queries,bluesky,False,False,False,
What are the first 3 user labels who have interacted with 'sarahgerrard.me' and have a color '#7EC0EE'?,"MATCH (u1:User {label: 'sarahgerrard.me'})-[:INTERACTED]->(u2:User {color: '#7EC0EE'})
RETURN u2.label
LIMIT 3",Pathfinding Queries,bluesky,False,False,True,
What are the top 5 interactions with the largest area difference between interacting users?,"MATCH (u1:User)-[r:INTERACTED]->(u2:User)
WITH u1, u2, r, abs(u1.area - u2.area) AS areaDifference
ORDER BY areaDifference DESC
RETURN u1.label AS User1, u2.label AS User2, r.weight AS InteractionWeight, areaDifference
LIMIT 5",Pathfinding Queries,bluesky,False,False,True,
Which users have interacted with users having a color '#3CB371'?,"MATCH (u:User)-[:INTERACTED]->(v:User {color: '#3CB371'})
RETURN DISTINCT u",Pathfinding Queries,bluesky,False,False,True,
Which users have asked questions that have both upVotes and downVotes?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.upVotes > 0 AND q.downVotes > 0
RETURN u",Pathfinding Queries,buzzoverflow,False,False,True,
List the first 3 questions which have been marked as answered.,"MATCH (q:Question {answered: true})
RETURN q
ORDER BY q.createdAt
LIMIT 3",Complex Aggregation Queries,buzzoverflow,False,False,True,
List the top 3 questions tagged with 'aws-lambda' that have a score of zero or less.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
WHERE q.score <= 0
RETURN q
ORDER BY q.score ASC
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
What are the first 5 most upvoted questions tagged with 'graphql'?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'graphql'})
RETURN q
ORDER BY q.upVotes DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
List the top 3 most recent questions asked on the platform.,"MATCH (q:Question)
RETURN q
ORDER BY q.createdAt DESC
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
What are the first 3 questions with a score greater than 3 and have been tagged with 'node.js'?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'node.js'})
WHERE q.score > 3
RETURN q
ORDER BY q.createdAt ASC
LIMIT 3",Complex Aggregation Queries,buzzoverflow,False,False,True,
Show the top 5 users who have asked the most questions with a negative score.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.score < 0
WITH u, count(q) AS numNegativeScoreQuestions
ORDER BY numNegativeScoreQuestions DESC
LIMIT 5
RETURN u.display_name, numNegativeScoreQuestions",Complex Aggregation Queries,buzzoverflow,False,False,True,
List the first 3 questions that have been asked by users without a profile image.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.image IS NULL
RETURN q
LIMIT 3",Complex Aggregation Queries,buzzoverflow,False,False,False,
Find the top 5 questions with the least favorites that have been answered.,"MATCH (q:Question)
WHERE q.favorites IS NOT NULL AND q.answered = true
RETURN q
ORDER BY q.favorites ASC
LIMIT 5",Complex Aggregation Queries,buzzoverflow,False,False,True,
Which questions tagged with 'aws-lambda' have been asked by users with a reputation of more than 5000?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
WHERE u.reputation > 5000
RETURN q",Complex Aggregation Queries,buzzoverflow,False,False,True,
What are the first 3 most recent questions asked by users with a reputation over 10000?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation > 10000
RETURN q
ORDER BY q.createdAt DESC
LIMIT 3",Complex Aggregation Queries,buzzoverflow,False,False,True,
Show the top 5 questions with the highest number of favorites that were asked by users with a link containing 'stackoverflow'.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.link CONTAINS 'stackoverflow'
RETURN q
ORDER BY q.favorites DESC
LIMIT 5",Complex Aggregation Queries,buzzoverflow,False,False,True,
List the first 3 users who asked questions with more than 2 tags.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE size((q)-[:TAGGED]->(:Tag)) > 2
RETURN u
LIMIT 3",Complex Aggregation Queries,buzzoverflow,True,False,False,
Which users have asked questions that have not been answered and have a score less than -1?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.answered = FALSE AND q.score < -1
RETURN u",Complex Aggregation Queries,buzzoverflow,False,False,True,
Who are the top 3 users by reputation who have asked a question about 'aws-lambda'?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
RETURN u.display_name, u.reputation
ORDER BY u.reputation DESC
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
List the top 5 questions with the most downvotes that were asked before 2019.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.createdAt < datetime('2019-01-01T00:00:00Z')
RETURN q
ORDER BY q.downVotes DESC
LIMIT 5",Complex Aggregation Queries,buzzoverflow,False,False,True,
Show the top 5 most downvoted questions.,"MATCH (q:Question)
RETURN q
ORDER BY q.downVotes DESC
LIMIT 5",Complex Aggregation Queries,buzzoverflow,False,False,True,
Identify the first 3 questions with a score of 0 or less that were asked by users with an image URL.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.score <= 0 AND u.image IS NOT NULL
RETURN q
ORDER BY q.createdAt
LIMIT 3",Complex Aggregation Queries,buzzoverflow,False,False,True,
Which questions have more than 5 downvotes and are tagged with 'aws-lambda'?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
WHERE q.downVotes > 5
RETURN q",Complex Aggregation Queries,buzzoverflow,False,False,False,
List the top 5 users by number of questions they have asked.,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN u.id, u.display_name, count(q) AS questions_asked
ORDER BY questions_asked DESC
LIMIT 5",Complex Aggregation Queries,buzzoverflow,False,False,True,
Find the first 3 questions that have not been answered and have zero upvotes.,"MATCH (q:Question)
WHERE q.answered = FALSE AND q.upVotes = 0
RETURN q
ORDER BY q.createdAt
LIMIT 3",Complex Aggregation Queries,buzzoverflow,False,False,True,
Show the top 5 questions with the highest score that were asked by users with a reputation under 500.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation < 500
RETURN q
ORDER BY q.score DESC
LIMIT 5",Complex Aggregation Queries,buzzoverflow,False,False,True,
What are the first 3 most recent questions asked on the platform?,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN q
ORDER BY q.createdAt DESC
LIMIT 3",Complex Aggregation Queries,buzzoverflow,False,False,True,
Find the first 3 users who asked questions tagged with 'node.js'.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'node.js'})
RETURN u
ORDER BY q.createdAt
LIMIT 3",Complex Aggregation Queries,buzzoverflow,False,False,True,
Which tags have been used more than twice in the database?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WITH t, count(q) AS usageCount
WHERE usageCount > 2
RETURN t.name, usageCount",Complex Aggregation Queries,buzzoverflow,False,False,True,
Show the first 3 questions asked by 'Christopher'.,"MATCH (u:User {display_name: 'Christopher'})-[:ASKED]->(q:Question)
RETURN q
ORDER BY q.createdAt
LIMIT 3",Complex Aggregation Queries,buzzoverflow,False,False,True,
Which questions have been asked by users with more than 2000 reputation and have scores less than 0?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation > 2000 AND q.score < 0
RETURN q",Complex Aggregation Queries,buzzoverflow,False,False,True,
What are the first 3 questions that have been tagged with 'graphql' and have more than 1 favorite?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'graphql'})
WHERE q.favorites > 1
RETURN q
ORDER BY q.createdAt
LIMIT 3",Complex Aggregation Queries,buzzoverflow,False,False,True,
How many questions has each user asked? List top 5 users by question count.,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u, count(q) AS questions_asked
ORDER BY questions_asked DESC
LIMIT 5
RETURN u.display_name, questions_asked",Pathfinding Queries,buzzoverflow,False,False,True,
Find the first 5 questions with the most favorites that have been answered.,"MATCH (q:Question)
WHERE q.answered = true
RETURN q
ORDER BY q.favorites DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
Identify the top 3 users who have posted the most downvoted questions.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.downVotes IS NOT NULL
RETURN u, SUM(q.downVotes) AS TotalDownVotes
ORDER BY TotalDownVotes DESC
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
Show the first 5 questions asked by users with no reputation points.,"MATCH (u:User {reputation: 0})-[:ASKED]->(q:Question)
RETURN q
LIMIT 5",Verbose query,buzzoverflow,False,False,False,
Find the top 5 users who have asked questions with the most tags associated.,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u, count{(q)-[:TAGGED]->(:Tag)} AS numTags
ORDER BY numTags DESC
LIMIT 5
RETURN u, numTags",Verbose query,buzzoverflow,False,False,True,
What are the first 3 questions with the shortest title length?,"MATCH (q:Question)
RETURN q
ORDER BY length(q.title)
LIMIT 3",Verbose query,buzzoverflow,True,False,False,
List the top 5 questions that were asked by users with an image link containing 'gravatar'.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.image CONTAINS 'gravatar'
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
Identify the first 5 users who asked questions that were tagged with 'graphql' and answered within the same month.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'graphql'})
WHERE q.createdAt.month = q.answeredAt.month AND q.answered = TRUE
RETURN u
LIMIT 5",Verbose query,buzzoverflow,False,False,False,Question.answeredAt
Show the top 3 questions with the most severe negative score (lowest score).,"MATCH (q:Question)
RETURN q
ORDER BY q.score ASC
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
What are the first 5 questions with the longest text descriptions?,"MATCH (q:Question)
RETURN q
ORDER BY length(q.text) DESC
LIMIT 5",Verbose query,buzzoverflow,True,False,False,
Who are the top 3 users who have asked questions with the most combined upvotes and downvotes?,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u, sum(q.upVotes + q.downVotes) AS totalVotes
ORDER BY totalVotes DESC
LIMIT 3
RETURN u.display_name AS UserName, totalVotes",Verbose query,buzzoverflow,False,False,True,
Find the first 5 questions that have been tagged with more than 3 tags.,"MATCH (q:Question)
WHERE size((q)-[:TAGGED]->(:Tag)) > 3
RETURN q
LIMIT 5",Verbose query,buzzoverflow,True,False,False,
List the top 3 questions that have a creation date on a weekend.,"MATCH (q:Question)
WHERE date(q.createdAt).dayOfWeek IN [6, 7]
RETURN q
ORDER BY q.createdAt DESC
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
Show the first 5 users who have asked a question with a link containing 'github'.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.link CONTAINS 'github'
RETURN u
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
Which top 5 users have asked the most questions?,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN u.id, u.display_name, count(q) AS questions_asked
ORDER BY questions_asked DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
Identify the top 5 questions with the highest number of favorites that have been asked in 2020.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.createdAt >= datetime('2020-01-01T00:00:00Z') AND q.createdAt < datetime('2021-01-01T00:00:00Z')
RETURN q
ORDER BY q.favorites DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
List the first 5 questions that have been tagged with 'aws-lambda' and have a positive score.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
WHERE q.score > 0
RETURN q
ORDER BY q.createdAt
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
Which 3 users have the highest average score per question asked?,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u, AVG(q.score) AS avgScore
ORDER BY avgScore DESC
LIMIT 3
RETURN u.display_name AS UserName, avgScore",Verbose query,buzzoverflow,False,False,True,
Find the top 5 most downvoted questions that have been answered.,"MATCH (q:Question)
WHERE q.answered = true AND q.downVotes IS NOT NULL
RETURN q
ORDER BY q.downVotes DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
What are the first 3 questions with a title containing the word 'error' and have at least one upvote?,"MATCH (q:Question)
WHERE q.title CONTAINS 'error' AND q.upVotes > 0
RETURN q
ORDER BY q.createdAt ASC
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
Who are the top 5 users with the most questions associated with more than one tag?,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u, count(q) AS questionsCount
WHERE questionsCount > 1 AND exists {
    (q)-[:TAGGED]->(:Tag)
    WITH q, count{(q)-[:TAGGED]->(:Tag)} AS tagCount
    WHERE tagCount > 1
}
RETURN u
ORDER BY questionsCount DESC
LIMIT 5",Verbose query,buzzoverflow,True,False,False,
List the first 3 users who asked a question in June 2020.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.createdAt >= '2020-06-01T00:00:00Z' AND q.createdAt < '2020-07-01T00:00:00Z'
RETURN u
ORDER BY q.createdAt
LIMIT 3",Verbose query,buzzoverflow,False,False,False,
"What are the top 5 questions with the most comments, sorted by their creation date?","MATCH (q:Question)
WHERE exists{(q)-[:HAS_COMMENT]->(:Comment)}
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,False,Comment
"What are the top 5 questions with the most comments, sorted by their creation date?","MATCH (q:Question)
WHERE exists{(q)-[:HAS_COMMENT]->(:Comment)}
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,False,HAS_COMMENT
Show the first 3 questions that have been tagged with 'graphql' and have no upvotes.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'graphql'})
WHERE q.upVotes = 0
RETURN q
ORDER BY q.createdAt
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
Find the top 5 users who have never asked a question that received a downvote.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE NOT exists{ (u)-[:ASKED]->(:Question {downVotes: 1}) }
RETURN u
ORDER BY u.reputation DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
What are the 3 most recent questions asked by the user with the highest reputation?,"MATCH (u:User)
WITH u ORDER BY u.reputation DESC LIMIT 1
MATCH (u)-[:ASKED]->(q:Question)
RETURN q
ORDER BY q.createdAt DESC LIMIT 3",Verbose query,buzzoverflow,False,False,True,
List the first 5 questions with scores less than zero.,"MATCH (q:Question)
WHERE q.score < 0
RETURN q
ORDER BY q.createdAt
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
What are the top 3 most recent questions asked by users with a display name starting with 'A'?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.display_name STARTS WITH 'A'
RETURN q
ORDER BY q.createdAt DESC
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
What are the links to the questions asked by users with a display name starting with 'Alex'?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.display_name STARTS WITH 'Alex'
RETURN q.link",Pathfinding Queries,buzzoverflow,False,False,True,
List all users who have asked a question about 'apollo-server-lambda'.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'apollo-server-lambda'})
RETURN u",Pathfinding Queries,buzzoverflow,False,False,False,
Which tags are associated with questions that have a score less than -5?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.score < -5
RETURN t.name",Pathfinding Queries,buzzoverflow,False,False,False,
Identify the first 3 users whose questions have never been downVoted.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE NOT exists{ (q)-[:TAGGED]->(:Tag) WHERE q.downVotes > 0 }
RETURN u
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
What are the top 5 most recent questions asked by users with an image link?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.image IS NOT NULL
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
Which 3 users have the lowest average score on their questions?,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u, AVG(q.score) AS avgScore
ORDER BY avgScore ASC
LIMIT 3
RETURN u.display_name AS UserName, avgScore",Verbose query,buzzoverflow,False,False,True,
List the first 3 tags used by the user with id 10251021 for their questions.,"MATCH (u:User {id: 10251021})-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
RETURN t.name
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
What are the top 5 questions with the most complex text content?,"MATCH (q:Question)
RETURN q
ORDER BY size(split(q.text, ' ')) DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
Identify the first 3 questions with no upVotes and no downVotes.,"MATCH (q:Question)
WHERE q.upVotes = 0 AND q.downVotes = 0
RETURN q
ORDER BY q.createdAt
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
List the first 3 users who have only asked questions that were never answered.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE NOT EXISTS {
  MATCH (q)-[:ANSWERED]->()
}
WITH u, COUNT(q) AS questionsCount
WHERE questionsCount = 3
RETURN u
LIMIT 3",Verbose query,buzzoverflow,False,False,True,ANSWERED
Which 3 users' questions have the highest average number of favorites?,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u, avg(q.favorites) AS avgFavorites
ORDER BY avgFavorites DESC
LIMIT 3
RETURN u.display_name AS UserName, avgFavorites",Verbose query,buzzoverflow,False,False,True,
Identify the first 3 questions that were asked by users with a reputation over 100000.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation > 100000
RETURN q
ORDER BY q.createdAt ASC
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
What are the top 5 questions by score that were created in 2020?,"MATCH (q:Question)
WHERE q.createdAt >= '2020-01-01T00:00:00Z' AND q.createdAt <= '2020-12-31T23:59:59Z'
RETURN q
ORDER BY q.score DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,False,
What are the top 5 questions that have been linked the most in external websites?,"MATCH (q:Question)
WHERE q.link IS NOT NULL
RETURN q
ORDER BY q.link DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
Which user has the lowest reputation but has asked a question with a high score?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.score >= 10
RETURN u
ORDER BY u.reputation ASC
LIMIT 1",Verbose query,buzzoverflow,False,False,True,
Identify the first 3 questions with a title containing 'error' or 'issue'.,"MATCH (q:Question)
WHERE q.title CONTAINS 'error' OR q.title CONTAINS 'issue'
RETURN q
ORDER BY q.createdAt ASC
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
What are the top 5 questions with the longest text descriptions?,"MATCH (q:Question)
RETURN q
ORDER BY length(q.text) DESC
LIMIT 5",Verbose query,buzzoverflow,True,False,False,
List the first 3 questions that were tagged 'aws-lambda' and have more than 1 downVotes.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
WHERE q.downVotes > 1
RETURN q
ORDER BY q.createdAt
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
Which 3 users have the highest average favorites on their questions?,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u, AVG(q.favorites) AS avgFavorites
ORDER BY avgFavorites DESC
LIMIT 3
RETURN u.display_name AS UserName, avgFavorites",Verbose query,buzzoverflow,False,False,True,
Identify the first 3 questions that have an exact score of 0 and were asked in June 2020.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.score = 0 AND q.createdAt >= '2020-06-01T00:00:00Z' AND q.createdAt < '2020-07-01T00:00:00Z'
RETURN q
ORDER BY q.createdAt ASC
LIMIT 3",Verbose query,buzzoverflow,False,False,False,
List the top 5 tags for questions with more than 5 favorites.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.favorites > 5
RETURN t.name, count(q) AS question_count
ORDER BY question_count DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
Which 3 users have asked questions that are all unanswered but highly upVoted?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.answered = FALSE AND q.upVotes > 10
WITH u, count(q) AS totalQuestions
WHERE NOT exists{ (u)-[:ASKED]->(:Question {answered: TRUE}) }
RETURN u
ORDER BY totalQuestions DESC
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
Identify the first 3 questions with a creation date on a weekend.,"MATCH (q:Question)
WHERE date(q.createdAt).weekday IN [6, 7]
RETURN q
ORDER BY q.createdAt
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
List the first 3 tags associated with questions that have been answered and have a negative score.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.answered = true AND q.score < 0
RETURN t.name
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
What are the top 5 questions with the most comments visible in their link descriptions?,"MATCH (q:Question)
WHERE q.link CONTAINS ""comments""
RETURN q
ORDER BY q.score DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
Which 3 users have asked questions with the most tags?,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u, count{(q)-[:TAGGED]->(:Tag)} AS numTags
ORDER BY numTags DESC
LIMIT 3
RETURN u",Verbose query,buzzoverflow,False,False,True,
What are the top 3 most upVoted questions that have not been answered?,"MATCH (q:Question)
WHERE q.answered = false
RETURN q
ORDER BY q.upVotes DESC
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
Which user has asked the most questions in the database?,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN u, count(q) AS questions_asked
ORDER BY questions_asked DESC
LIMIT 1",Complex Aggregation Queries,buzzoverflow,False,False,True,
List the first 3 questions that have text containing 'apollo'?,"MATCH (q:Question)
WHERE q.text CONTAINS 'apollo'
RETURN q
ORDER BY q.createdAt
LIMIT 3",Complex Aggregation Queries,buzzoverflow,False,False,True,
What are the first 3 questions with a creation date in 2020?,"MATCH (q:Question)
WHERE q.createdAt >= datetime('2020-01-01T00:00:00Z') AND q.createdAt < datetime('2021-01-01T00:00:00Z')
RETURN q
ORDER BY q.createdAt ASC
LIMIT 3",Complex Aggregation Queries,buzzoverflow,False,False,True,
Which users have asked questions with more than 3 downVotes?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.downVotes > 3
RETURN u",Complex Aggregation Queries,buzzoverflow,False,False,True,
What are the top 5 questions with the least favorites but more than 1 upVote?,"MATCH (q:Question)
WHERE q.favorites IS NOT NULL AND q.upVotes > 1
RETURN q
ORDER BY q.favorites ASC
LIMIT 5",Complex Aggregation Queries,buzzoverflow,False,False,True,
Find the first 3 users who asked questions on '2020-06-05'.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.createdAt >= datetime('2020-06-05T00:00:00Z') AND q.createdAt < datetime('2020-06-06T00:00:00Z')
RETURN u
LIMIT 3",Complex Aggregation Queries,buzzoverflow,False,False,True,
Which questions have a score less than -3?,"MATCH (q:Question)
WHERE q.score < -3
RETURN q",Complex Aggregation Queries,buzzoverflow,False,False,True,
List the first 3 users who have not answered their questions but have a reputation over 50.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation > 50 AND NOT EXISTS {
  (u)-[:ANSWERED]->(q)
}
RETURN u
LIMIT 3",Complex Aggregation Queries,buzzoverflow,False,False,True,ANSWERED
What are the top 5 questions with the highest number of upVotes?,"MATCH (q:Question)
RETURN q
ORDER BY q.upVotes DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
List the first 3 questions with exactly 0 favorites and a positive score.,"MATCH (q:Question)
WHERE q.favorites = 0 AND q.score > 0
RETURN q
ORDER BY q.createdAt
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
List the first 3 users by reputation who have asked a question.,"MATCH (u:User)-[:ASKED]->(:Question)
RETURN u
ORDER BY u.reputation DESC
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
Identify the top 5 questions with the most downVotes.,"MATCH (q:Question)
RETURN q
ORDER BY q.downVotes DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
What are the first 3 questions asked by the user with the highest reputation?,"MATCH (u:User)
WITH u ORDER BY u.reputation DESC LIMIT 1
MATCH (u)-[:ASKED]->(q:Question)
RETURN q
ORDER BY q.createdAt ASC
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
Which user has posted the highest number of questions?,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN u, count(q) AS num_questions
ORDER BY num_questions DESC
LIMIT 1",Verbose query,buzzoverflow,False,False,True,
List the first 3 tags that appear most frequently across all questions.,"MATCH (:Question)-[r:TAGGED]->(t:Tag)
RETURN t.name, count(r) AS frequency
ORDER BY frequency DESC
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
What are the first 3 most recent questions that have been answered?,"MATCH (q:Question)
WHERE q.answered = true
RETURN q
ORDER BY q.createdAt DESC
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
Who are the top 5 users with the most downVoted questions?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.downVotes IS NOT NULL
RETURN u, SUM(q.downVotes) AS totalDownVotes
ORDER BY totalDownVotes DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
Identify the first 3 questions tagged 'graphql' with negative scores.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'graphql'})
WHERE q.score < 0
RETURN q
ORDER BY q.createdAt ASC
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
What are the top 5 oldest questions in the database?,"MATCH (q:Question)
RETURN q
ORDER BY q.createdAt
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
"List the first 3 users who asked questions on or after June 1, 2020.","MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.createdAt >= datetime('2020-06-01T00:00:00Z')
RETURN u
ORDER BY q.createdAt
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
Which tags are associated with the top 3 most favorited questions?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
RETURN t.name, q.favorites
ORDER BY q.favorites DESC
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
List the first 3 tags used in questions asked by users without a profile image.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
WHERE u.image IS NULL
RETURN t.name
LIMIT 3",Verbose query,buzzoverflow,False,False,False,
Which 3 users have questions with the highest average downVotes?,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u, AVG(q.downVotes) AS avgDownVotes
ORDER BY avgDownVotes DESC
LIMIT 3
RETURN u.display_name, avgDownVotes",Verbose query,buzzoverflow,False,False,True,
Identify the first 3 questions with a score greater than 5.,"MATCH (q:Question)
WHERE q.score > 5
RETURN q
ORDER BY q.createdAt ASC
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
List the first 3 questions that have been tagged with 'apollo-server-lambda' and have no favorites.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'apollo-server-lambda'})
WHERE q.favorites = 0
RETURN q
ORDER BY q.createdAt
LIMIT 3",Verbose query,buzzoverflow,False,False,False,
Which 3 users have the most questions with a link to an external website?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.link IS NOT NULL
RETURN u.display_name, count(q) AS num_questions
ORDER BY num_questions DESC
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
Identify the first 3 questions asked by the newest user in the database.,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN q
ORDER BY u.id DESC
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
What are the top 5 questions with the most variety in their vote counts (difference between upVotes and downVotes)?,"MATCH (q:Question)
RETURN q, (q.upVotes - q.downVotes) AS voteDifference
ORDER BY voteDifference DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
List the first 3 questions with a title containing the word 'loading'.,"MATCH (q:Question)
WHERE q.title CONTAINS 'loading'
RETURN q
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
Which 3 users have asked the most questions tagged with 'aws-lambda'?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
WITH u, count(q) AS questions_asked
ORDER BY questions_asked DESC
LIMIT 3
RETURN u.display_name, questions_asked",Verbose query,buzzoverflow,False,False,True,
Identify the first 3 questions that have been answered and have a createdAt date on a public holiday.,"MATCH (q:Question)
WHERE q.answered = true AND q.createdAt IN ['2020-01-01T00:00:00Z', '2020-07-04T00:00:00Z', '2020-12-25T00:00:00Z']  // Example public holidays
RETURN q
ORDER BY q.createdAt
LIMIT 3",Verbose query,buzzoverflow,False,False,False,
What are the top 5 questions asked by users with the most questions in the database?,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u, count(q) AS questions_asked
ORDER BY questions_asked DESC
LIMIT 5
MATCH (u)-[:ASKED]->(top_question:Question)
RETURN u.display_name, top_question.title, top_question.id, questions_asked
ORDER BY questions_asked DESC, top_question.score DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
List the first 3 questions with a negative score and no upVotes.,"MATCH (q:Question)
WHERE q.score < 0 AND q.upVotes = 0
RETURN q
ORDER BY q.createdAt
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
What are the top 5 questions with the most external links mentioned in their text?,"MATCH (q:Question)
WHERE q.text CONTAINS 'http'
RETURN q
ORDER BY size([link IN split(q.text, ' ') WHERE link STARTS WITH 'http']) DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
Which 3 users have asked questions that are most frequently associated with the tag 'apollo'?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'apollo'})
WITH u, count(q) AS questionsCount
ORDER BY questionsCount DESC
LIMIT 3
RETURN u.display_name, questionsCount",Verbose query,buzzoverflow,False,False,True,
What are the top 5 questions with a link that includes 'stackoverflow'?,"MATCH (q:Question)
WHERE q.link CONTAINS 'stackoverflow'
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
List the first 3 questions that have a creation time exactly at noon UTC.,"MATCH (q:Question)
WHERE q.createdAt = datetime(""T12:00:00Z"")
RETURN q
LIMIT 3",Verbose query,buzzoverflow,True,False,False,
Which 3 users have asked the most questions with a score of 5 or higher?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.score >= 5
WITH u, count(q) AS questionsCount
ORDER BY questionsCount DESC
LIMIT 3
RETURN u.display_name, questionsCount",Verbose query,buzzoverflow,False,False,True,
Identify the first 3 questions asked by users who have a reputation of exactly 1000.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation = 1000
RETURN q
ORDER BY q.createdAt ASC
LIMIT 3",Verbose query,buzzoverflow,False,False,False,
What are the top 5 users with the most questions having a score of zero?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.score = 0
WITH u, count(q) AS questionsCount
ORDER BY questionsCount DESC
LIMIT 5
RETURN u.display_name, questionsCount",Verbose query,buzzoverflow,False,False,True,
List the first 3 questions that have been tagged with 'apollo' and have a score of less than -1.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'apollo'})
WHERE q.score < -1
RETURN q
ORDER BY q.createdAt
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
Which 3 users have the most tags associated with their questions?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
WITH u, count(DISTINCT t) AS numTags
ORDER BY numTags DESC
LIMIT 3
RETURN u.display_name, numTags",Verbose query,buzzoverflow,False,False,True,
Identify the first 3 questions with the most references to specific software or technology in their text.,"MATCH (q:Question)
WHERE q.text CONTAINS 'software' OR q.text CONTAINS 'technology'
RETURN q
ORDER BY q.createdAt ASC
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
What are the top 5 most recent questions with a score less than -1?,"MATCH (q:Question)
WHERE q.score < -1
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
Identify the first 3 questions that have been tagged with 'graphql' and have been answered.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'graphql'})
WHERE q.answered = true
RETURN q
ORDER BY q.createdAt
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
Identify the first 3 questions that have been asked more than once by the same user.,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u, q, count(q) AS times_asked
WHERE times_asked > 1
RETURN u, q
ORDER BY q.createdAt ASC
LIMIT 3",Verbose query,buzzoverflow,False,False,False,
Which 3 users have their questions most frequently tagged with 'graphql-js'?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'graphql-js'})
WITH u, count(q) AS questionsCount
ORDER BY questionsCount DESC
LIMIT 3
RETURN u.display_name, questionsCount",Verbose query,buzzoverflow,False,False,True,
List the first 3 questions that have been answered and have a text containing 'bug'.,"MATCH (q:Question)
WHERE q.answered = true AND q.text CONTAINS 'bug'
RETURN q
ORDER BY q.createdAt
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
What are the top 5 questions asked by the most recent users to join?,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN q
ORDER BY u.id DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
List the first 3 users who have asked questions with exactly 2 tags.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE size((q)-[:TAGGED]->(:Tag)) = 2
RETURN u
LIMIT 3",Verbose query,buzzoverflow,True,False,False,
Which 3 users' questions have the most variations in favorites count?,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u, count(DISTINCT q.favorites) AS favVariations
ORDER BY favVariations DESC
LIMIT 3
RETURN u.display_name, favVariations",Verbose query,buzzoverflow,False,False,True,
Identify the first 3 questions asked by users who have a specific image in their profile.,"MATCH (u:User {image: 'https://lh3.googleusercontent.com/-NcFYSuXU0nk/AAA'})-[:ASKED]->(q:Question)
RETURN q
ORDER BY q.createdAt ASC
LIMIT 3",Verbose query,buzzoverflow,False,False,False,
What are the top 5 shortest questions in terms of text content?,"MATCH (q:Question)
RETURN q
ORDER BY length(q.text)
LIMIT 5",Verbose query,buzzoverflow,True,False,False,
List the first 3 questions that have the word 'playground' in the title.,"MATCH (q:Question)
WHERE q.title CONTAINS 'playground'
RETURN q
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
Which 3 users have the most answered questions?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.answered = true
WITH u, count(q) AS answeredQuestions
ORDER BY answeredQuestions DESC
LIMIT 3
RETURN u.display_name, answeredQuestions",Verbose query,buzzoverflow,False,False,True,
Identify the first 3 questions tagged with 'graphql-subscriptions' that have a positive score.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'graphql-subscriptions'})
WHERE q.score > 0
RETURN q
ORDER BY q.createdAt ASC
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
What are the top 5 questions asked by users with a reputation under 500?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation < 500
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
"List the first 3 questions with a createdAt date exactly on January 1, 2020.","MATCH (q:Question)
WHERE q.createdAt = datetime('2020-01-01T00:00:00Z')
RETURN q
LIMIT 3",Verbose query,buzzoverflow,False,False,False,
Which 3 users have asked the oldest questions in the database?,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN u
ORDER BY q.createdAt ASC
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
Identify the first 3 questions with more than 3 tags.,"MATCH (q:Question)
WHERE size{(q)-[:TAGGED]->(:Tag)} > 3
RETURN q
ORDER BY q.createdAt ASC
LIMIT 3",Verbose query,buzzoverflow,True,False,False,
What are the top 5 questions with the shortest titles?,"MATCH (q:Question)
RETURN q
ORDER BY length(q.title) ASC
LIMIT 5",Verbose query,buzzoverflow,True,False,False,
List the first 3 questions that have been tagged with both 'apollo' and 'graphql'.,"MATCH (q:Question)-[:TAGGED]->(t1:Tag), (q)-[:TAGGED]->(t2:Tag)
WHERE t1.name = 'apollo' AND t2.name = 'graphql'
RETURN q
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
Which 3 users have the most questions with zero downVotes?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.downVotes = 0
WITH u, count(q) AS questionsCount
ORDER BY questionsCount DESC
LIMIT 3
RETURN u.display_name, questionsCount",Verbose query,buzzoverflow,False,False,True,
Identify the first 3 questions with the most detailed descriptions based on the number of characters.,"MATCH (q:Question)
RETURN q
ORDER BY size(q.text) DESC
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
What are the top 5 questions with a creation time between 8:00 and 10:00 UTC?,"MATCH (q:Question)
WHERE q.createdAt >= 'T08:00:00Z' AND q.createdAt <= 'T10:00:00Z'
RETURN q
ORDER BY q.createdAt ASC
LIMIT 5",Verbose query,buzzoverflow,False,False,False,
List the first 3 questions that have been tagged with 'aws-lambda' and have a score of exactly 2.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
WHERE q.score = 2
RETURN q
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
Which 3 users have the highest number of questions with a negative score?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.score < 0
WITH u, count(q) AS NegativeQuestions
ORDER BY NegativeQuestions DESC
LIMIT 3
RETURN u.display_name, NegativeQuestions",Verbose query,buzzoverflow,False,False,True,
Identify the first 3 questions that were asked by users with a display name starting with 'A'.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.display_name STARTS WITH 'A'
RETURN q
ORDER BY q.createdAt
LIMIT 3",Verbose query,buzzoverflow,False,False,True,
What are the top 5 most recent questions tagged 'graphql'?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'graphql'})
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Verbose query,buzzoverflow,False,False,True,
What are the first 3 questions asked by the user with the lowest reputation?,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u ORDER BY u.reputation ASC LIMIT 1
MATCH (u)-[:ASKED]->(q)
RETURN q
ORDER BY q.createdAt ASC
LIMIT 3",Complex Aggregation Queries,buzzoverflow,False,False,True,
List all users who have asked a question about 'graphql' according to the tags.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
WHERE t.name = 'graphql'
RETURN u",Complex Aggregation Queries,buzzoverflow,False,False,True,
List the first 3 tags that appear most frequently across all questions.,"MATCH (:Question)-[r:TAGGED]->(t:Tag)
RETURN t.name, count(r) AS frequency
ORDER BY frequency DESC
LIMIT 3",Complex Aggregation Queries,buzzoverflow,False,False,True,
What are the first 3 questions with the highest number of favorites?,"MATCH (q:Question)
RETURN q
ORDER BY q.favorites DESC
LIMIT 3",Complex Aggregation Queries,buzzoverflow,False,False,True,
Which questions have an 'Internal server error' mentioned in their text and were created before 2021?,"MATCH (q:Question)
WHERE q.text CONTAINS 'Internal server error' AND q.createdAt < datetime('2021-01-01T00:00:00Z')
RETURN q",Pathfinding Queries,buzzoverflow,False,False,True,
Find the top 3 users by number of questions asked in 2020.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.createdAt >= datetime('2020-01-01T00:00:00Z') AND q.createdAt < datetime('2021-01-01T00:00:00Z')
RETURN u.id, u.display_name, count(q) AS questions_asked
ORDER BY questions_asked DESC
LIMIT 3",Pathfinding Queries,buzzoverflow,False,False,True,
What are the titles of questions that have exactly 3 upVotes?,"MATCH (q:Question)
WHERE q.upVotes = 3
RETURN q.title",Pathfinding Queries,buzzoverflow,False,False,True,
List all questions that were downvoted but have a score greater than zero.,"MATCH (q:Question)
WHERE q.downVotes > 0 AND q.score > 0
RETURN q",Pathfinding Queries,buzzoverflow,False,False,True,
Which questions tagged with 'apollo' have been asked by more than one user?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'apollo'})
WITH q, count{(q)<-[:ASKED]-(:User)} AS userCount
WHERE userCount > 1
RETURN q",Pathfinding Queries,buzzoverflow,False,False,False,
Provide the image links of users who asked questions about 'apollo-server-lambda'.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'apollo-server-lambda'})
RETURN u.image AS UserImageLink",Pathfinding Queries,buzzoverflow,False,False,False,
List the top 5 questions based on their createdAt dates that have not been answered.,"MATCH (q:Question)
WHERE q.answered = FALSE
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Pathfinding Queries,buzzoverflow,False,False,True,
Which tags are most commonly associated with questions having more than 10 upVotes?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.upVotes > 10
RETURN t.name, count(q) AS questionCount
ORDER BY questionCount DESC",Pathfinding Queries,buzzoverflow,False,False,True,
How many users have asked questions that were tagged with 'graphql' and have a score of zero?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'graphql'})
WHERE q.score = 0
RETURN count(DISTINCT u) AS NumberOfUsers",Pathfinding Queries,buzzoverflow,False,False,True,
List all questions asked by users whose display name ends with 'Le'.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.display_name ENDS WITH 'Le'
RETURN q",Pathfinding Queries,buzzoverflow,False,False,True,
List the questions asked by users with display names containing 'Alex' and sort them by creation date.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.display_name CONTAINS 'Alex'
RETURN q
ORDER BY q.createdAt",Pathfinding Queries,buzzoverflow,False,False,True,
Find all questions asked by users with a reputation less than 500.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation < 500
RETURN q",Pathfinding Queries,buzzoverflow,False,False,True,
Which questions tagged with 'aws-lambda' were created after 2019 and have downVotes?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
WHERE q.createdAt > datetime('2019-01-01T00:00:00Z') AND q.downVotes > 0
RETURN q",Pathfinding Queries,buzzoverflow,False,False,True,
List the questions with a link that includes 'apollo' and their corresponding tags.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.link CONTAINS 'apollo'
RETURN q, collect(t.name) AS Tags",Pathfinding Queries,buzzoverflow,False,False,True,
How many questions have been asked by users with no upVotes and no downVotes?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.upVotes = 0 AND q.downVotes = 0
RETURN count(q) AS NumberOfQuestions",Pathfinding Queries,buzzoverflow,False,False,True,
What are the titles of the questions with a createdAt date on or after 2021-01-01 and less than 5 favorites?,"MATCH (q:Question)
WHERE q.createdAt >= datetime('2021-01-01T00:00:00Z') AND q.favorites < 5
RETURN q.title",Pathfinding Queries,buzzoverflow,False,False,False,
Which users asked questions that have a link ending in '.com'?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.link ENDS WITH '.com'
RETURN u",Pathfinding Queries,buzzoverflow,False,False,False,
List all tags associated with questions that have been answered and have a score less than zero.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.answered = true AND q.score < 0
RETURN t.name",Pathfinding Queries,buzzoverflow,False,False,True,
Which questions have been tagged with 'graphql-js' and asked by users with a reputation over 100000?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
WHERE t.name = 'graphql-js' AND u.reputation > 100000
RETURN q",Pathfinding Queries,buzzoverflow,False,False,False,
List the top 3 questions by score that are also tagged with 'apollo-server-lambda'.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'apollo-server-lambda'})
RETURN q
ORDER BY q.score DESC
LIMIT 3",Pathfinding Queries,buzzoverflow,False,False,False,
What are the top 5 questions with the most downVotes?,"MATCH (q:Question)
RETURN q
ORDER BY q.downVotes DESC
LIMIT 5",Pathfinding Queries,buzzoverflow,False,False,True,
Which questions were asked by users who have an image link ending in '.com'?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.image ENDS WITH '.com'
RETURN q",Pathfinding Queries,buzzoverflow,False,False,False,
Which users with a reputation over 50000 asked questions that were later answered?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation > 50000 AND q.answered = true
RETURN u",Pathfinding Queries,buzzoverflow,False,False,True,
What are the most recent questions asked by users with no image link provided?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.image IS NULL
RETURN q
ORDER BY q.createdAt DESC",Pathfinding Queries,buzzoverflow,False,False,False,
How many users have asked more than 3 questions?,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u, count(q) AS questions_count
WHERE questions_count > 3
RETURN count(u) AS users_with_more_than_3_questions",Pathfinding Queries,buzzoverflow,False,False,True,
What are the titles of the questions that have been answered and have no favorites?,"MATCH (q:Question)
WHERE q.answered = true AND q.favorites = 0
RETURN q.title",Pathfinding Queries,buzzoverflow,False,False,True,
Which questions were asked most recently by users with an image link containing 'googleusercontent'?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.image CONTAINS 'googleusercontent'
RETURN q
ORDER BY q.createdAt DESC",Pathfinding Queries,buzzoverflow,False,False,True,
Find questions with the title containing 'subscription' and list their associated tags.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.title CONTAINS 'subscription'
RETURN q.title, collect(t.name) AS Tags",Pathfinding Queries,buzzoverflow,False,False,True,
List the dates when questions tagged with 'aws-lambda' were created.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
RETURN q.createdAt AS CreationDate",Pathfinding Queries,buzzoverflow,False,False,True,
Which users have the highest reputation among those who asked questions in June 2020?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.createdAt >= datetime('2020-06-01T00:00:00Z') AND q.createdAt < datetime('2020-07-01T00:00:00Z')
RETURN u.display_name, u.reputation
ORDER BY u.reputation DESC",Pathfinding Queries,buzzoverflow,False,False,True,
What are the top 3 longest texts in questions on the platform?,"MATCH (q:Question)
RETURN q.text AS Text, q.id AS QuestionID
ORDER BY length(q.text) DESC
LIMIT 3",Pathfinding Queries,buzzoverflow,True,False,False,
Provide the titles and links of questions that have more than 2 tags.,"MATCH (q:Question)
WHERE size((q)-[:TAGGED]->(:Tag)) > 2
RETURN q.title AS Title, q.link AS Link",Pathfinding Queries,buzzoverflow,True,False,False,
List all tags for questions that were asked by the user with the lowest reputation.,"MATCH (u:User)
WITH u ORDER BY u.reputation ASC LIMIT 1
MATCH (u)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
RETURN t.name AS TagName",Pathfinding Queries,buzzoverflow,False,False,True,
Provide details of questions with a score greater than 5 and tagged with 'graphql-js'.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'graphql-js'})
WHERE q.score > 5
RETURN q",Pathfinding Queries,buzzoverflow,False,False,True,
Which questions received exactly 0 downVotes and were created in 2020?,"MATCH (q:Question)
WHERE q.downVotes = 0 AND q.createdAt >= '2020-01-01T00:00:00Z' AND q.createdAt < '2021-01-01T00:00:00Z'
RETURN q",Pathfinding Queries,buzzoverflow,False,False,False,
List the top 5 questions based on the number of favorites they received.,"MATCH (q:Question)
RETURN q
ORDER BY q.favorites DESC
LIMIT 5",Pathfinding Queries,buzzoverflow,False,False,True,
Which users asked questions with a score of zero and have an image link?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.score = 0 AND u.image IS NOT NULL
RETURN u",Pathfinding Queries,buzzoverflow,False,False,True,
What are the creation dates of questions that have not been answered and have more than 5 upVotes?,"MATCH (q:Question)
WHERE q.answered = false AND q.upVotes > 5
RETURN q.createdAt",Pathfinding Queries,buzzoverflow,False,False,True,
Find all questions tagged with 'graphql-subscriptions' and list their creation dates.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'graphql-subscriptions'})
RETURN q.createdAt AS CreationDate",Pathfinding Queries,buzzoverflow,False,False,True,
Which user links are associated with questions that have a negative score?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.score < 0
RETURN u.link",Pathfinding Queries,buzzoverflow,False,False,True,
What are the titles of questions that were tagged with 'aws-lambda' and have more than 10 upVotes?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
WHERE q.upVotes > 10
RETURN q.title",Pathfinding Queries,buzzoverflow,False,False,True,
Provide the list of users who asked a question on the first day of any month.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE date(q.createdAt).day = 1
RETURN u",Pathfinding Queries,buzzoverflow,False,False,True,
Which questions have a link containing 'stackoverflow' and more than 1 favorite?,"MATCH (q:Question)
WHERE q.link CONTAINS 'stackoverflow' AND q.favorites > 1
RETURN q",Pathfinding Queries,buzzoverflow,False,False,True,
List the users who asked questions with a text containing 'mongodb' and the associated tags.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
WHERE q.text CONTAINS 'mongodb'
RETURN u, collect(t) AS Tags",Pathfinding Queries,buzzoverflow,False,False,True,
What are the most common tags for questions that were answered?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.answered = true
RETURN t.name, count(q) AS question_count
ORDER BY question_count DESC",Pathfinding Queries,buzzoverflow,False,False,True,
Find all users who have asked questions that were tagged with 'graphql-subscriptions' and sort them by reputation.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'graphql-subscriptions'})
RETURN u
ORDER BY u.reputation DESC",Pathfinding Queries,buzzoverflow,False,False,True,
What are the most common tags for questions asked by users with a reputation over 50000?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
WHERE u.reputation > 50000
RETURN t.name, count(q) AS question_count
ORDER BY question_count DESC",Pathfinding Queries,buzzoverflow,False,False,True,
How many questions have been tagged with 'graphql' and have a negative score?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'graphql'})
WHERE q.score < 0
RETURN count(q) AS NegativeScoredGraphQLQuestions",Pathfinding Queries,buzzoverflow,False,False,True,
Provide details of the top 3 users by reputation who have asked questions about 'aws-lambda'.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
RETURN u.id AS UserId, u.display_name AS UserName, u.reputation AS UserReputation, u.link AS UserLink
ORDER BY u.reputation DESC
LIMIT 3",Pathfinding Queries,buzzoverflow,False,False,True,
Which users with a reputation over 100000 have asked questions that have been downvoted?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation > 100000 AND q.downVotes > 0
RETURN u",Pathfinding Queries,buzzoverflow,False,False,True,
List the questions that were asked by users with a reputation over 50000 and have a text containing 'error'.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation > 50000 AND q.text CONTAINS 'error'
RETURN q",Pathfinding Queries,buzzoverflow,False,False,True,
What are the tags of questions that have more than 10 upVotes and were asked by users with a reputation over 100000?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
WHERE q.upVotes > 10 AND u.reputation > 100000
RETURN t.name",Pathfinding Queries,buzzoverflow,False,False,False,
Which questions have a link containing 'apollo' and have been answered?,"MATCH (q:Question)
WHERE q.link CONTAINS 'apollo' AND q.answered = true
RETURN q",Pathfinding Queries,buzzoverflow,False,False,True,
Provide the titles and links of questions that were asked by users with an image link containing 'googleusercontent' and have more than 3 favorites.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.image CONTAINS 'googleusercontent' AND q.favorites > 3
RETURN q.title AS Title, q.link AS Link",Pathfinding Queries,buzzoverflow,False,False,True,
Which questions were asked by the same user more than once and have been tagged with 'aws-lambda'?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
WITH u, q, count(q) AS questions_asked
WHERE questions_asked > 1
RETURN u, collect(q) AS repeated_questions",Pathfinding Queries,buzzoverflow,False,False,False,
List the tags of questions asked by users with a reputation under 500 that have been answered.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
WHERE u.reputation < 500 AND q.answered = true
RETURN t.name",Pathfinding Queries,buzzoverflow,False,False,True,
What are the most common tags for questions that have been asked by users with a display name containing 'Le'?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
WHERE u.display_name CONTAINS 'Le'
RETURN t.name, count(q) AS question_count
ORDER BY question_count DESC",Pathfinding Queries,buzzoverflow,False,False,True,
Which questions have been tagged with 'graphql-subscriptions' and have a score greater than 5?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'graphql-subscriptions'})
WHERE q.score > 5
RETURN q",Pathfinding Queries,buzzoverflow,False,False,True,
Which questions with more than 5 favorites were asked by users who have an image link ending in '.com'?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.favorites > 5 AND u.image ENDS WITH '.com'
RETURN q",Pathfinding Queries,buzzoverflow,False,False,False,
Which questions have a createdAt date in 2020 and were asked by users with a reputation over 100000?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.createdAt >= datetime('2020-01-01T00:00:00Z') AND q.createdAt < datetime('2021-01-01T00:00:00Z')
  AND u.reputation > 100000
RETURN q",Pathfinding Queries,buzzoverflow,False,False,True,
What are the top 3 questions by upVotes that were also tagged with 'graphql-js'?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'graphql-js'})
RETURN q
ORDER BY q.upVotes DESC
LIMIT 3",Pathfinding Queries,buzzoverflow,False,False,True,
What are the top 5 questions with the most upVotes?,"MATCH (q:Question)
RETURN q
ORDER BY q.upVotes DESC
LIMIT 5",Complex Aggregation Queries,buzzoverflow,False,False,True,
Which questions were asked by users with a reputation above 100?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation > 100
RETURN q",Complex Aggregation Queries,buzzoverflow,False,False,True,
Which users have asked questions tagged with 'angular'?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'angular'})
RETURN u",Complex Aggregation Queries,buzzoverflow,False,False,True,
What are the top 5 most recent questions asked in the system?,"MATCH (q:Question)
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Complex Aggregation Queries,buzzoverflow,False,False,True,
List all questions that have more than 5 downVotes.,"MATCH (q:Question)
WHERE q.downVotes > 5
RETURN q",Complex Aggregation Queries,buzzoverflow,False,False,False,
Which tags are associated with questions that have a negative score?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.score < 0
RETURN t.name",Complex Aggregation Queries,buzzoverflow,False,False,True,
Find all users who have asked a question with no upVotes or downVotes.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.upVotes = 0 AND q.downVotes = 0
RETURN u",Complex Aggregation Queries,buzzoverflow,False,False,True,
List the top 5 questions with the most favorites that were asked by users with a reputation under 50000.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation < 50000
RETURN q
ORDER BY q.favorites DESC
LIMIT 5",Pathfinding Queries,buzzoverflow,False,False,True,
List all users who asked questions that have a title containing 'Apollo' and their corresponding tags.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
WHERE q.title CONTAINS 'Apollo'
RETURN u, collect(t.name) AS Tags",Pathfinding Queries,buzzoverflow,False,False,True,
Which questions have been asked by users who have asked more than 20 questions?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE exists {
  MATCH (u)-[:ASKED]->()
  WITH count{(u)-[:ASKED]->()} AS questionsCount
  WHERE questionsCount > 20
}
RETURN q",Pathfinding Queries,buzzoverflow,False,False,True,
What are the titles and tags of questions that have a score of zero and were asked by a user with a reputation over 100000?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
WHERE q.score = 0 AND u.reputation > 100000
RETURN q.title AS QuestionTitle, collect(t.name) AS Tags",Pathfinding Queries,buzzoverflow,False,False,True,
List the questions that were asked by users with a reputation exactly 420137.,"MATCH (u:User {reputation: 420137})-[:ASKED]->(q:Question)
RETURN q",Pathfinding Queries,buzzoverflow,False,False,True,
Which users with a reputation over 100000 asked questions that have been answered?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation > 100000 AND q.answered = true
RETURN u",Pathfinding Queries,buzzoverflow,False,False,True,
List all questions with a score of 0 and their associated tags.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.score = 0
RETURN q, collect(t.name) AS Tags",Pathfinding Queries,buzzoverflow,False,False,True,
Which questions with more than 5 downVotes were asked by users with a reputation under 1000?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.downVotes > 5 AND u.reputation < 1000
RETURN q",Pathfinding Queries,buzzoverflow,False,False,False,
List the top 5 users by reputation who have asked questions tagged with 'apollo'.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'apollo'})
RETURN u.display_name, u.reputation
ORDER BY u.reputation DESC
LIMIT 5",Pathfinding Queries,buzzoverflow,False,False,True,
Which questions have a text containing 'Internal server error' and have been tagged with 'graphql'?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'graphql'})
WHERE q.text CONTAINS 'Internal server error'
RETURN q",Pathfinding Queries,buzzoverflow,False,False,True,
Provide the titles and links of questions asked by users with a display name containing 'Le' and a reputation over 10000.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.display_name CONTAINS 'Le' AND u.reputation > 10000
RETURN q.title AS Title, q.link AS Link",Pathfinding Queries,buzzoverflow,False,False,False,
Which questions have a score of -1 and were asked by users with a display name starting with 'A'?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.score = -1 AND u.display_name STARTS WITH 'A'
RETURN q",Pathfinding Queries,buzzoverflow,False,False,True,
"List all questions that have been answered, have more than 5 favorites, and were asked in 2020.","MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.answered = true AND q.favorites > 5 AND q.createdAt >= datetime('2020-01-01T00:00:00Z') AND q.createdAt < datetime('2021-01-01T00:00:00Z')
RETURN q",Pathfinding Queries,buzzoverflow,False,False,False,
What are the titles of questions that have a text containing 'error' and were asked by users with an image link?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.text CONTAINS 'error' AND u.image IS NOT NULL
RETURN q.title",Pathfinding Queries,buzzoverflow,False,False,True,
Which questions tagged with 'aws-lambda' have a score greater than 0 and were asked by users with a reputation over 50000?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
MATCH (u:User)-[:ASKED]->(q)
WHERE q.score > 0 AND u.reputation > 50000
RETURN q",Pathfinding Queries,buzzoverflow,False,False,False,
List the questions that have been tagged with 'aws-lambda' and have a creation date in 2020.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
WHERE q.createdAt >= datetime('2020-01-01T00:00:00Z') AND q.createdAt < datetime('2021-01-01T00:00:00Z')
RETURN q",Pathfinding Queries,buzzoverflow,False,False,True,
What are the most common tags for questions that have more than 5 downVotes?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.downVotes > 5
RETURN t.name, count(t) AS frequency
ORDER BY frequency DESC",Pathfinding Queries,buzzoverflow,False,False,False,
Which questions have more than 10 favorites and were asked by users with a reputation less than 5000?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.favorites > 10 AND u.reputation < 5000
RETURN q",Pathfinding Queries,buzzoverflow,False,False,True,
List all tags for questions that have a positive score and were asked by users with a reputation over 50000.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
WHERE q.score > 0 AND u.reputation > 50000
RETURN t.name",Pathfinding Queries,buzzoverflow,False,False,True,
Which questions were asked by users with a display name containing 'Alexandre' and have more than 5 upVotes?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.display_name CONTAINS 'Alexandre' AND q.upVotes > 5
RETURN q",Pathfinding Queries,buzzoverflow,False,False,False,
Provide the links to the top 5 questions asked by users with a reputation under 1000.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation < 1000
RETURN q.link
ORDER BY q.score DESC
LIMIT 5",Pathfinding Queries,buzzoverflow,False,False,True,
What are the creation dates of questions that have been answered and have a score greater than 10?,"MATCH (q:Question)
WHERE q.answered = true AND q.score > 10
RETURN q.createdAt AS CreationDate",Pathfinding Queries,buzzoverflow,False,False,True,
Which users asked questions tagged with 'graphql-js' and have a reputation under 5000?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'graphql-js'})
WHERE u.reputation < 5000
RETURN u",Pathfinding Queries,buzzoverflow,False,False,True,
List the titles of questions that have been downvoted and have a score less than -5.,"MATCH (q:Question)
WHERE q.downVotes > 0 AND q.score < -5
RETURN q.title",Pathfinding Queries,buzzoverflow,False,False,False,
Which questions have been asked by users with the highest reputation and have a link containing 'stackoverflow'?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation IS NOT NULL AND q.link CONTAINS 'stackoverflow'
RETURN q
ORDER BY u.reputation DESC
LIMIT 1",Pathfinding Queries,buzzoverflow,False,False,True,
Which user has the highest reputation among those who asked questions tagged with 'apollo'?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'apollo'})
RETURN u.display_name AS UserName, u.reputation AS Reputation
ORDER BY u.reputation DESC
LIMIT 1",Complex Aggregation Queries,buzzoverflow,False,False,True,
What are the top 3 questions with the most favorites?,"MATCH (q:Question)
RETURN q
ORDER BY q.favorites DESC
LIMIT 3",Complex Aggregation Queries,buzzoverflow,False,False,True,
List the top 5 questions with the most favorites and have been answered.,"MATCH (q:Question)
WHERE q.favorites IS NOT NULL AND q.answered = true
RETURN q
ORDER BY q.favorites DESC
LIMIT 5",Complex Aggregation Queries,buzzoverflow,False,False,True,
Which questions were tagged with 'react-apollo' and have a negative score?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'react-apollo'})
WHERE q.score < 0
RETURN q",Complex Aggregation Queries,buzzoverflow,False,False,True,
What are the top 3 questions with the shortest titles?,"MATCH (q:Question)
RETURN q
ORDER BY length(q.title) ASC
LIMIT 3",Complex Retrieval Queries,buzzoverflow,True,False,False,
Who are the first 3 users to ask a question in the year 2019?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.createdAt >= '2019-01-01T00:00:00Z' AND q.createdAt < '2020-01-01T00:00:00Z'
RETURN u
ORDER BY q.createdAt ASC
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,False,
List the top 5 questions that have more than 5 downVotes.,"MATCH (q:Question)
WHERE q.downVotes > 5
RETURN q
ORDER BY q.downVotes DESC
LIMIT 5",Complex Retrieval Queries,buzzoverflow,False,False,False,
Which user has the highest number of answered questions linked to their profile?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.answered = true
RETURN u, count(q) AS AnsweredQuestions
ORDER BY AnsweredQuestions DESC
LIMIT 1",Complex Retrieval Queries,buzzoverflow,False,False,True,
List the top 3 tags that are associated with questions created before 2018.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.createdAt < datetime('2018-01-01T00:00:00Z')
RETURN t.name, count(q) AS question_count
ORDER BY question_count DESC
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,True,
What are the first 5 questions asked by users with an image URL containing 'googleusercontent'?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.image CONTAINS 'googleusercontent'
RETURN q
ORDER BY q.createdAt
LIMIT 5",Complex Retrieval Queries,buzzoverflow,False,False,True,
Which users have asked questions that have exactly 0 favorites? List the first 3.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.favorites = 0
RETURN u
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,True,
Find the top 3 questions that were asked on a weekend.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE apoc.date.format(apoc.date.parse(q.createdAt, 'ms', ""yyyy-MM-dd'T'HH:mm:ss'Z'""), 'ms', 'E') IN ['Sat', 'Sun']
RETURN q
ORDER BY q.createdAt DESC
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,True,
What are the top 5 oldest questions in the database?,"MATCH (q:Question)
RETURN q
ORDER BY q.createdAt ASC
LIMIT 5",Complex Retrieval Queries,buzzoverflow,False,False,True,
Which user with a reputation over 1000 has asked the most questions?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation > 1000
RETURN u, count(q) AS questions_asked
ORDER BY questions_asked DESC
LIMIT 1",Complex Retrieval Queries,buzzoverflow,False,False,True,
List the first 5 questions that have exactly 2 upVotes.,"MATCH (q:Question {upVotes: 2})
RETURN q
LIMIT 5",Complex Retrieval Queries,buzzoverflow,False,False,True,
What are the top 3 questions tagged with 'react-apollo'?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'react-apollo'})
RETURN q
ORDER BY q.score DESC
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,True,
Who asked the question with the most recent creation date?,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN u
ORDER BY q.createdAt DESC
LIMIT 1",Complex Retrieval Queries,buzzoverflow,False,False,True,
List the first 5 users who have asked a question and have a reputation less than 500.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation < 500
RETURN u
LIMIT 5",Complex Retrieval Queries,buzzoverflow,False,False,True,
Which tags have been used by users with a reputation above 3000? List the first 5 tags.,"MATCH (u:User)-[:ASKED]->(:Question)-[:TAGGED]->(t:Tag)
WHERE u.reputation > 3000
RETURN DISTINCT t.name
LIMIT 5",Complex Retrieval Queries,buzzoverflow,True,False,False,
What are the top 3 questions with the most detailed text (longest text length)?,"MATCH (q:Question)
RETURN q
ORDER BY length(q.text) DESC
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,True,
Who are the first 3 users to ask a question after 2020?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.createdAt >= datetime('2020-01-01T00:00:00Z')
RETURN u
ORDER BY q.createdAt ASC
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,True,
List the first 5 questions with a title containing the word 'error'.,"MATCH (q:Question)
WHERE q.title CONTAINS 'error'
RETURN q
LIMIT 5",Complex Retrieval Queries,buzzoverflow,False,False,True,
Which user(s) have asked questions that have a link containing 'stackoverflow'? List the first 3.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.link CONTAINS 'stackoverflow'
RETURN u
LIMIT 3",Complex Retrieval Queries,buzzoverflow,True,False,False,
Which tags are associated with the longest question texts? List the top 3.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
RETURN t.name AS Tag, length(q.text) AS TextLength
ORDER BY TextLength DESC
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,False,
List the first 5 questions that were created in the year 2020.,"MATCH (q:Question)
WHERE q.createdAt >= '2020-01-01T00:00:00Z' AND q.createdAt < '2021-01-01T00:00:00Z'
RETURN q
ORDER BY q.createdAt
LIMIT 5",Complex Retrieval Queries,buzzoverflow,False,False,True,
Who is the user with the lowest reputation to ask a question?,"MATCH (u:User)-[:ASKED]->(:Question)
RETURN u
ORDER BY u.reputation ASC
LIMIT 1",Complex Retrieval Queries,buzzoverflow,False,False,True,
What are the first 5 questions that have received more downVotes than upVotes?,"MATCH (q:Question)
WHERE q.downVotes > q.upVotes
RETURN q
ORDER BY q.createdAt ASC
LIMIT 5",Complex Retrieval Queries,buzzoverflow,False,False,True,
What are the top 5 most recent questions asked on the platform?,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Complex Retrieval Queries,buzzoverflow,False,False,True,
Which users have asked more than 3 questions? List the first 5.,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u, count(q) AS questionsCount
WHERE questionsCount > 3
RETURN u
LIMIT 5",Complex Retrieval Queries,buzzoverflow,False,False,True,
What are the top 3 questions with the highest number of upVotes?,"MATCH (q:Question)
RETURN q
ORDER BY q.upVotes DESC
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,True,
Find the top 5 questions that have been marked as answered.,"MATCH (q:Question {answered: true})
RETURN q
ORDER BY q.score DESC
LIMIT 5",Complex Retrieval Queries,buzzoverflow,False,False,True,
Who are the top 3 users with the highest reputation that have asked a question?,"MATCH (u:User)-[:ASKED]->(:Question)
RETURN u.display_name, u.reputation
ORDER BY u.reputation DESC
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,True,
List the first 5 questions that have at least 1 downVote.,"MATCH (q:Question)
WHERE q.downVotes >= 1
RETURN q
ORDER BY q.createdAt
LIMIT 5",Complex Retrieval Queries,buzzoverflow,False,False,True,
What are the top 3 tags associated with the most favorited questions?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
RETURN t.name AS Tag, sum(q.favorites) AS TotalFavorites
ORDER BY TotalFavorites DESC
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,True,
Which user asked the question with the highest score?,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN u
ORDER BY q.score DESC
LIMIT 1",Complex Retrieval Queries,buzzoverflow,False,False,True,
List the top 5 questions tagged with 'graphql'.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'graphql'})
RETURN q
ORDER BY q.score DESC
LIMIT 5",Complex Retrieval Queries,buzzoverflow,True,False,False,
What are the top 5 tags associated with the most recent questions?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
RETURN t.name, count(q) AS question_count
ORDER BY q.createdAt DESC
LIMIT 5",Complex Retrieval Queries,buzzoverflow,False,False,True,
Who are the top 3 users based on reputation who have asked a question about 'aws-lambda'?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
RETURN u.display_name, u.reputation
ORDER BY u.reputation DESC
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,True,
List the top 3 questions that have not been answered yet.,"MATCH (q:Question)
WHERE q.answered = false
RETURN q
ORDER BY q.createdAt DESC
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,True,
Which tags are associated with questions that have more than 2 upVotes? List the first 5 tags.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.upVotes > 2
RETURN t.name
LIMIT 5",Complex Retrieval Queries,buzzoverflow,False,False,True,
Who asked the first question ever recorded in the system?,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN u
ORDER BY q.createdAt ASC
LIMIT 1",Complex Retrieval Queries,buzzoverflow,False,False,True,
List the top 5 questions that have a negative score.,"MATCH (q:Question)
WHERE q.score < 0
RETURN q
ORDER BY q.score ASC
LIMIT 5",Complex Retrieval Queries,buzzoverflow,False,False,True,
Which users have asked questions that were tagged with 'node.js'? List the first 3.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'node.js'})
RETURN u
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,True,
What are the top 3 questions with the most favorites?,"MATCH (q:Question)
RETURN q
ORDER BY q.favorites DESC
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,True,
Which user has the most questions linked to their profile?,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN u, count(q) AS questions_count
ORDER BY questions_count DESC
LIMIT 1",Complex Retrieval Queries,buzzoverflow,False,False,True,
List the first 5 tags that appear in more than one question.,"MATCH (t:Tag)<-[:TAGGED]-(:Question)
WITH t, count{(t)<-[:TAGGED]-(:Question)} AS questionCount
WHERE questionCount > 1
RETURN t.name
ORDER BY questionCount DESC
LIMIT 5",Complex Retrieval Queries,buzzoverflow,False,False,True,
Find the top 3 users who asked questions that were not favorited.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.favorites = 0
RETURN u.id, u.display_name, count(q) AS questions_asked
ORDER BY questions_asked DESC
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,True,
What are the first 5 most recent questions asked by users with a reputation greater than 2000?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation > 2000
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Complex Retrieval Queries,buzzoverflow,False,False,False,
Show the questions that have been tagged with 'aws'.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'aws'})
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which user asked the question with the lowest score?,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN u
ORDER BY q.score ASC
LIMIT 1",Complex Retrieval Queries,buzzoverflow,False,False,True,
Who are the top 3 users based on the number of questions they have asked that were tagged with 'graphql'?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'graphql'})
WITH u, count(q) AS questionsAsked
ORDER BY questionsAsked DESC
LIMIT 3
RETURN u.display_name AS UserName, questionsAsked",Complex Retrieval Queries,buzzoverflow,False,False,True,
List the questions asked by users with a reputation greater than 100000.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation > 100000
RETURN q",Simple Aggregation Queries,buzzoverflow,False,False,True,
Which tags are associated with questions that have more than 2 downVotes?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.downVotes > 2
RETURN t.name",Simple Aggregation Queries,buzzoverflow,False,False,True,
Who asked the first question in the database?,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN u
ORDER BY q.createdAt ASC
LIMIT 1",Simple Aggregation Queries,buzzoverflow,False,False,True,
What are the titles of questions that have no upVotes and no downVotes?,"MATCH (q:Question)
WHERE q.upVotes = 0 AND q.downVotes = 0
RETURN q.title",Simple Aggregation Queries,buzzoverflow,False,False,False,
List the top 5 questions by score that were asked in 2020.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.createdAt >= '2020-01-01T00:00:00Z' AND q.createdAt < '2021-01-01T00:00:00Z'
RETURN q
ORDER BY q.score DESC
LIMIT 5",Simple Aggregation Queries,buzzoverflow,False,False,True,
Which users have asked questions that were tagged with 'graphql-js'?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'graphql-js'})
RETURN u",Simple Aggregation Queries,buzzoverflow,False,False,True,
Find all questions that have been tagged more than once.,"MATCH (q:Question)
WITH q, count{(q)-[:TAGGED]->(:Tag)} AS tagCount
WHERE tagCount > 1
RETURN q",Simple Aggregation Queries,buzzoverflow,False,False,True,
What are the top 3 questions with the least favorites?,"MATCH (q:Question)
WHERE q.favorites IS NOT NULL
RETURN q
ORDER BY q.favorites ASC
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,
Which questions have a link including 'apollo-server'?,"MATCH (q:Question)
WHERE q.link CONTAINS 'apollo-server'
RETURN q",Simple Aggregation Queries,buzzoverflow,False,False,True,
How many questions have a negative score?,"MATCH (q:Question)
WHERE q.score < 0
RETURN count(q) AS NegativeScoreQuestionsCount",Simple Aggregation Queries,buzzoverflow,False,False,True,
List all questions tagged with 'node.js' and asked by users with a reputation below 5000.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'node.js'})
WHERE u.reputation < 5000
RETURN q",Simple Aggregation Queries,buzzoverflow,False,False,True,
Find the top 5 users by reputation who have asked a question in 2020.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.createdAt >= datetime('2020-01-01T00:00:00Z') AND q.createdAt < datetime('2021-01-01T00:00:00Z')
RETURN u.id, u.display_name, u.reputation
ORDER BY u.reputation DESC
LIMIT 5",Complex Aggregation Queries,buzzoverflow,False,False,False,
List the questions that have been both answered and have a 'createdAt' date in 2018.,"MATCH (q:Question)
WHERE q.createdAt >= '2018-01-01T00:00:00Z' AND q.createdAt <= '2018-12-31T23:59:59Z' AND q.answered = TRUE
RETURN q",Simple Aggregation Queries,buzzoverflow,False,False,True,
Which question has the lowest score and was asked by a user with an image link?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.image IS NOT NULL
RETURN q
ORDER BY q.score ASC
LIMIT 1",Simple Aggregation Queries,buzzoverflow,False,False,True,
How many users have asked a question with exactly 0 favorites?,"MATCH (u:User)-[:ASKED]->(q:Question {favorites: 0})
RETURN count(DISTINCT u) AS NumberOfUsers",Simple Aggregation Queries,buzzoverflow,False,False,True,
What are the three oldest questions in terms of creation date?,"MATCH (q:Question)
RETURN q
ORDER BY q.createdAt ASC
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,
Which questions have been answered and have more than 5 favorites?,"MATCH (q:Question)
WHERE q.answered = TRUE AND q.favorites > 5
RETURN q",Simple Aggregation Queries,buzzoverflow,False,False,True,
List the questions with exactly 1 downVote.,"MATCH (q:Question)
WHERE q.downVotes = 1
RETURN q",Simple Aggregation Queries,buzzoverflow,False,False,True,
Find the users who asked the questions with the most tags.,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH q, count{(q)-[:TAGGED]->(:Tag)} AS tagCount
ORDER BY tagCount DESC
LIMIT 1
MATCH (u:User)-[:ASKED]->(q)
RETURN u",Simple Aggregation Queries,buzzoverflow,False,False,True,
How many questions were created on '2020-06-05'?,"MATCH (q:Question)
WHERE q.createdAt >= '2020-06-05T00:00:00Z' AND q.createdAt < '2020-06-06T00:00:00Z'
RETURN count(q) AS questionsCount",Simple Aggregation Queries,buzzoverflow,False,False,True,
Which questions have titles containing the word 'error'?,"MATCH (q:Question)
WHERE q.title CONTAINS 'error'
RETURN q",Simple Aggregation Queries,buzzoverflow,False,False,True,
Find all the users who have asked a question with a score less than -1.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.score < -1
RETURN u",Simple Aggregation Queries,buzzoverflow,False,False,False,
List the questions that have both more than 5 upVotes and more than 5 downVotes.,"MATCH (q:Question)
WHERE q.upVotes > 5 AND q.downVotes > 5
RETURN q",Simple Aggregation Queries,buzzoverflow,False,False,True,
What are the first 5 questions that received no upVotes or downVotes?,"MATCH (q:Question)
WHERE q.upVotes = 0 AND q.downVotes = 0
RETURN q
ORDER BY q.createdAt
LIMIT 5",Complex Retrieval Queries,buzzoverflow,False,False,True,
Which tags are associated with questions that have a creation date in June 2020? List the top 3.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.createdAt >= datetime('2020-06-01T00:00:00Z') AND q.createdAt < datetime('2020-07-01T00:00:00Z')
RETURN t.name, count(q) AS questionCount
ORDER BY questionCount DESC
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,False,
Who asked the highest scoring question in the year 2019?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.createdAt >= '2019-01-01T00:00:00Z' AND q.createdAt < '2020-01-01T00:00:00Z'
RETURN u, q
ORDER BY q.score DESC
LIMIT 1",Complex Retrieval Queries,buzzoverflow,False,False,True,
Which questions have a score greater than 0?,"MATCH (q:Question)
WHERE q.score > 0
RETURN q",Simple Aggregation Queries,buzzoverflow,False,False,True,
List all questions tagged with 'graphql-subscriptions'.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'graphql-subscriptions'})
RETURN q",Simple Aggregation Queries,buzzoverflow,False,False,True,
Who asked the question titled 'GraphQL subscription delay on first time'?,"MATCH (u:User)-[:ASKED]->(q:Question {title: 'GraphQL subscription delay on first time'})
RETURN u.display_name AS asked_by",Simple Aggregation Queries,buzzoverflow,False,False,True,
What are the top 5 most upvoted questions?,"MATCH (q:Question)
RETURN q
ORDER BY q.upVotes DESC
LIMIT 5",Simple Aggregation Queries,buzzoverflow,False,False,True,
Find all questions asked by the user with id 10251021.,"MATCH (u:User {id: 10251021})-[:ASKED]->(q:Question)
RETURN q",Simple Aggregation Queries,buzzoverflow,False,False,True,
Which users have asked more than 3 questions?,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u, count(q) AS questionsCount
WHERE questionsCount > 3
RETURN u",Simple Aggregation Queries,buzzoverflow,False,False,False,
List the top 3 questions by users who have no profile image link provided.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.image IS NULL
RETURN q
ORDER BY q.score DESC
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,True,
What are the three most recent questions created?,"MATCH (q:Question)
RETURN q
ORDER BY q.createdAt DESC
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,
How many questions have been answered?,"MATCH (q:Question)
WHERE q.answered = true
RETURN count(q) AS AnsweredQuestionsCount",Simple Aggregation Queries,buzzoverflow,False,False,True,
List all tags used in unanswered questions.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.answered = false
RETURN DISTINCT t.name",Simple Aggregation Queries,buzzoverflow,False,False,True,
Who are the top 3 users by reputation who have asked questions?,"MATCH (u:User)-[:ASKED]->(:Question)
RETURN u.display_name, u.reputation
ORDER BY u.reputation DESC
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,
What are the links to the 5 questions with the most favorites?,"MATCH (q:Question)
RETURN q.link
ORDER BY q.favorites DESC
LIMIT 5",Simple Aggregation Queries,buzzoverflow,False,False,True,
Which questions were asked before June 2020?,"MATCH (q:Question)
WHERE q.createdAt < datetime('2020-06-01T00:00:00Z')
RETURN q",Simple Aggregation Queries,buzzoverflow,False,False,True,
List all questions that have been answered and have a score of 0 or less.,"MATCH (q:Question)
WHERE q.answered = true AND q.score <= 0
RETURN q",Simple Aggregation Queries,buzzoverflow,False,False,True,
Which users have asked questions tagged with 'react-apollo'?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'react-apollo'})
RETURN u",Simple Aggregation Queries,buzzoverflow,False,False,True,
How many different users have asked questions that are tagged with 'aws-lambda'?,"MATCH (:Tag {name: 'aws-lambda'})<-[:TAGGED]-(q:Question)<-[:ASKED]-(u:User)
RETURN COUNT(DISTINCT u) AS distinct_users",Simple Aggregation Queries,buzzoverflow,False,False,True,
What are the top 3 most favored questions?,"MATCH (q:Question)
WHERE q.favorites IS NOT NULL
RETURN q
ORDER BY q.favorites DESC
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,
Which question has the highest number of downVotes?,"MATCH (q:Question)
RETURN q
ORDER BY q.downVotes DESC
LIMIT 1",Simple Aggregation Queries,buzzoverflow,False,False,True,
What are the user ids of those who have asked a question with a favorites count of zero?,"MATCH (u:User)-[:ASKED]->(q:Question {favorites: 0})
RETURN u.id",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the questions that have been both tagged with 'graphql' and have a score greater than zero.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'graphql'})
WHERE q.score > 0
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
Identify the first 5 questions tagged with 'apollo' and have downVotes.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'apollo'})
WHERE q.downVotes > 0
RETURN q
ORDER BY q.createdAt
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
What is the highest reputation of a user who has asked a question tagged with 'node.js'?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'node.js'})
RETURN MAX(u.reputation) AS highestReputation",Simple Retrieval Queries,buzzoverflow,False,False,True,
Find questions asked by users with a reputation over 100000.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation > 100000
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which questions have a link containing 'stackoverflow.com/questions'?,"MATCH (q:Question)
WHERE q.link CONTAINS 'stackoverflow.com/questions'
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
Show the first 5 questions that were asked and have a score of zero.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.score = 0
RETURN q
ORDER BY q.createdAt ASC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the first 3 questions tagged with 'apollo' that have been answered?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'apollo'})
WHERE q.answered = true
RETURN q
ORDER BY q.createdAt ASC
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the questions that have a createdAt date on or after '2020-06-05' and a score greater than zero.,"MATCH (q:Question)
WHERE q.createdAt >= datetime('2020-06-05T00:00:00Z') AND q.score > 0
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which users have asked a question with a title containing 'GraphQL'?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.title CONTAINS 'GraphQL'
RETURN u",Simple Retrieval Queries,buzzoverflow,False,False,False,
Show the questions that have been tagged with 'apollo-server-lambda'.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'apollo-server-lambda'})
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the titles of the first 3 questions with the highest number of favorites?,"MATCH (q:Question)
RETURN q.title
ORDER BY q.favorites DESC
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the questions tagged with 'graphql' that have been answered.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'graphql'})
WHERE q.answered = true
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the user ids of those who have asked a question tagged with 'aws-lambda'?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
RETURN u.id",Simple Retrieval Queries,buzzoverflow,False,False,True,
Find the top 5 questions with the least favorites.,"MATCH (q:Question)
WHERE q.favorites IS NOT NULL
RETURN q
ORDER BY q.favorites ASC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,True,False,False,
Which questions have a text length greater than 500 characters?,"MATCH (q:Question)
WHERE length(q.text) > 500
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the questions asked by the user with the highest reputation.,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN u, q
ORDER BY u.reputation DESC
LIMIT 1",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the titles of the first 3 questions asked in the year 2020?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.createdAt >= datetime('2020-01-01T00:00:00Z') AND q.createdAt < datetime('2021-01-01T00:00:00Z')
RETURN q.title
ORDER BY q.createdAt ASC
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which tags are associated with questions that have more than 2 downVotes?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.downVotes > 2
RETURN t.name",Simple Retrieval Queries,buzzoverflow,False,False,True,
Show the user profile links for users who have asked questions tagged with 'apollo'.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'apollo'})
RETURN u.link AS UserProfileLink",Simple Retrieval Queries,buzzoverflow,False,False,True,
Find the first 3 questions with exactly 1 upVote.,"MATCH (q:Question)
WHERE q.upVotes = 1
RETURN q
ORDER BY q.createdAt
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the titles of questions where the user has a reputation less than 5000?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation < 5000
RETURN q.title",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the top 3 oldest questions in the database.,"MATCH (q:Question)
RETURN q
ORDER BY q.createdAt ASC
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which questions have a title containing 'not loading'?,"MATCH (q:Question)
WHERE q.title CONTAINS 'not loading'
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
Find all users who asked a question with the word 'error' in the text.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.text CONTAINS 'error'
RETURN u",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the top 5 tags used in questions with a score less than zero?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.score < 0
RETURN t.name, count(q) AS usage
ORDER BY usage DESC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the first 5 questions tagged with 'aws-lambda'?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
RETURN q
ORDER BY q.createdAt
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the top 3 users by reputation who have asked a question about 'graphql'.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'graphql'})
RETURN u.display_name, u.reputation
ORDER BY u.reputation DESC
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which questions have more than 5 favorites?,"MATCH (q:Question)
WHERE q.favorites > 5
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
Find all questions asked before June 2020.,"MATCH (q:Question)
WHERE q.createdAt < datetime('2020-06-01T00:00:00Z')
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the top 5 most upvoted questions?,"MATCH (q:Question)
RETURN q
ORDER BY q.upVotes DESC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
List all questions with a negative score.,"MATCH (q:Question)
WHERE q.score < 0
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which users have asked more than 3 questions?,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u, count(q) AS questionsCount
WHERE questionsCount > 3
RETURN u",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the titles of questions that have been answered?,"MATCH (q:Question)
WHERE q.answered = true
RETURN q.title",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the top 5 questions with the most downVotes.,"MATCH (q:Question)
RETURN q
ORDER BY q.downVotes DESC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the tags associated with questions that have a score of less than -1.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.score < -1
RETURN t.name",Simple Retrieval Queries,buzzoverflow,False,False,False,
Which questions were created on '2020-06-05'?,"MATCH (q:Question)
WHERE q.createdAt = datetime('2020-06-05T00:00:00Z')
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
Show the top 3 users who have asked the most questions about 'apollo'.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
WHERE t.name = 'apollo'
WITH u, count(q) AS questionsAsked
ORDER BY questionsAsked DESC
LIMIT 3
RETURN u.display_name, questionsAsked",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which questions have been both upvoted and downvoted?,"MATCH (q:Question)
WHERE q.upVotes > 0 AND q.downVotes > 0
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the questions that have no upVotes and no downVotes.,"MATCH (q:Question)
WHERE q.upVotes = 0 AND q.downVotes = 0
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the links to the user profiles of the top 3 most active users in asking questions?,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u, count(q) AS questions_asked
ORDER BY questions_asked DESC
LIMIT 3
RETURN u.link AS UserProfileLink",Simple Retrieval Queries,buzzoverflow,False,False,True,
How many questions have been tagged with 'react-apollo'?,"MATCH (:Tag {name: 'react-apollo'})<-[:TAGGED]-(q:Question)
RETURN count(q) AS NumberOfQuestionsTaggedWithReactApollo",Simple Retrieval Queries,buzzoverflow,False,False,True,
Identify the first 3 questions that have been flagged as answered and have at least 1 favorite.,"MATCH (q:Question)
WHERE q.answered = true AND q.favorites >= 1
RETURN q
ORDER BY q.createdAt
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,False,
What are the titles of questions created in February 2020?,"MATCH (q:Question)
WHERE q.createdAt >= '2020-02-01T00:00:00Z' AND q.createdAt <= '2020-02-29T23:59:59Z'
RETURN q.title",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which users have never received a downvote on their questions?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE NOT exists{ (q)-[:ASKED]->(:User) WHERE q.downVotes > 0 }
RETURN u",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the 3 most recent questions by creation date.,"MATCH (q:Question)
RETURN q
ORDER BY q.createdAt DESC
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the names of tags associated with questions asked by the user with id 10251021?,"MATCH (u:User {id: 10251021})-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
RETURN t.name",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which users have asked questions with a createdAt date in June 2020?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.createdAt >= datetime('2020-06-01T00:00:00Z') AND q.createdAt < datetime('2020-07-01T00:00:00Z')
RETURN u",Simple Retrieval Queries,buzzoverflow,False,False,True,
Show the first 3 questions with a downVotes count of 1.,"MATCH (q:Question)
WHERE q.downVotes = 1
RETURN q
ORDER BY q.createdAt
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the titles of questions that have been asked by users with an image link?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.image IS NOT NULL
RETURN q.title",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which questions have an createdAt date exactly on '2020-06-05T21:49:16Z'?,"MATCH (q:Question)
WHERE q.createdAt = datetime('2020-06-05T21:49:16Z')
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the first 3 questions that have a text containing 'expected behavior'.,"MATCH (q:Question)
WHERE q.text CONTAINS 'expected behavior'
RETURN q
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,False,
What are the titles of questions created in the month of August 2019?,"MATCH (q:Question)
WHERE q.createdAt >= '2019-08-01T00:00:00Z' AND q.createdAt < '2019-09-01T00:00:00Z'
RETURN q.title",Simple Retrieval Queries,buzzoverflow,False,False,True,
Show the user profile links for users who have asked questions with a title including 'error'.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.title CONTAINS 'error'
RETURN u.link AS UserProfileLink",Simple Retrieval Queries,buzzoverflow,False,False,True,
Find the top 5 questions with a createdAt date in 2020.,"MATCH (q:Question)
WHERE q.createdAt >= datetime('2020-01-01T00:00:00Z') AND q.createdAt <= datetime('2020-12-31T23:59:59Z')
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which questions have been tagged with 'apollo' and have a score greater than 1?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'apollo'})
WHERE q.score > 1
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,False,
List the questions that have a createdAt date in 2019 and have been answered.,"MATCH (q:Question)
WHERE q.createdAt >= '2019-01-01T00:00:00Z' AND q.createdAt <= '2019-12-31T23:59:59Z' AND q.answered = true
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the user ids of those who have asked a question with a score less than -1?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.score < -1
RETURN u.id",Simple Retrieval Queries,buzzoverflow,False,False,True,
Show the questions that have been tagged with 'nuxt.js'.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'nuxt.js'})
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
Find all users who asked a question with a title including 'loading'.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.title CONTAINS 'loading'
RETURN u",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the titles of the first 3 questions with a createdAt date in June 2020?,"MATCH (q:Question)
WHERE q.createdAt >= datetime('2020-06-01T00:00:00Z') AND q.createdAt < datetime('2020-07-01T00:00:00Z')
RETURN q.title
ORDER BY q.createdAt
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which users have asked questions with a title containing 'playground'?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.title CONTAINS 'playground'
RETURN u",Simple Retrieval Queries,buzzoverflow,False,False,True,
Show the questions that have been tagged with 'mongoose'.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'mongoose'})
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the titles of the first 3 questions with a score of -1?,"MATCH (q:Question {score: -1})
RETURN q.title
ORDER BY q.createdAt
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the questions asked by users with a reputation of exactly 420137.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation = 420137
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which questions have a text containing 'deployment'?,"MATCH (q:Question)
WHERE q.text CONTAINS 'deployment'
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
Show the first 3 questions with a downVotes count of zero.,"MATCH (q:Question)
WHERE q.downVotes = 0
RETURN q
ORDER BY q.createdAt
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,False,
What are the titles of questions where the user has an image link ending with '.com'?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.image ENDS WITH '.com'
RETURN q.title",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the first 3 questions from users who have a reputation over 100000.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation > 100000
RETURN q
ORDER BY q.createdAt
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which questions were asked by users who have a reputation of exactly 1?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation = 1
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,False,
List the tags associated with questions that have a createdAt date in 2020.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.createdAt >= '2020-01-01T00:00:00Z' AND q.createdAt <= '2020-12-31T23:59:59Z'
RETURN t.name",Simple Retrieval Queries,buzzoverflow,False,False,True,
Show the questions that have been tagged with 'aws-lambda' and have a score of 0.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
WHERE q.score = 0
RETURN q",Simple Aggregation Queries,buzzoverflow,False,False,True,
What are the tags associated with questions that have a score of zero?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.score = 0
RETURN t.name",Simple Retrieval Queries,buzzoverflow,False,False,False,
Which questions have a link that includes 'mongodb.net'?,"MATCH (q:Question)
WHERE q.link CONTAINS 'mongodb.net'
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the first 3 questions from users who have a link in their profile.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.link IS NOT NULL
RETURN q
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which questions were asked by users who have a reputation of exactly 420137?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation = 420137
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
Identify the first 5 questions tagged with 'react-apollo' and have upVotes.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'react-apollo'})
WHERE q.upVotes > 0
RETURN q
ORDER BY q.createdAt ASC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the questions that have been downvoted and contain the word 'internal' in the text.,"MATCH (q:Question)
WHERE q.downVotes > 0 AND q.text CONTAINS 'internal'
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the titles of the first 3 questions with an id over 60000000?,"MATCH (q:Question)
WHERE q.id > 60000000
RETURN q.title
ORDER BY q.id ASC
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
Find all users who have asked questions tagged with 'aws-lambda' and have a reputation over 10000.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
WHERE u.reputation > 10000
RETURN u",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which questions have been both answered and have a favorites count greater than 3?,"MATCH (q:Question)
WHERE q.answered = true AND q.favorites > 3
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the first 3 questions asked by users with a reputation less than 1000.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation < 1000
RETURN q
ORDER BY q.createdAt
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,False,
What are the tags associated with questions asked by users with no image in their profile?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
WHERE u.image IS NULL
RETURN t.name AS TagName",Simple Retrieval Queries,buzzoverflow,False,False,True,
Show the first 3 questions with the most upVotes and answered status.,"MATCH (q:Question)
WHERE q.answered = true
RETURN q
ORDER BY q.upVotes DESC
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
Show the questions that have a text containing 'schema'.,"MATCH (q:Question)
WHERE q.text CONTAINS 'schema'
RETURN q;",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the questions with a downVotes count greater than their upVotes count.,"MATCH (q:Question)
WHERE q.downVotes > q.upVotes
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which questions have a createdAt date in 2020 and a favorites count of zero?,"MATCH (q:Question)
WHERE q.createdAt >= datetime('2020-01-01T00:00:00Z') AND q.createdAt <= datetime('2020-12-31T23:59:59Z') AND q.favorites = 0
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
Show the first 5 questions asked by users who have an id less than 1000000.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.id < 1000000
RETURN q
ORDER BY q.createdAt
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the titles of the first 3 questions with a score equal to zero?,"MATCH (q:Question {score: 0})
RETURN q.title
ORDER BY q.createdAt
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,False,
List the tags associated with questions that have a createdAt date on '2020-06-05'.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.createdAt = datetime('2020-06-05T00:00:00Z')
RETURN t.name",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which users have asked questions with a title containing 'apollo-server'?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.title CONTAINS 'apollo-server'
RETURN u",Simple Retrieval Queries,buzzoverflow,False,False,True,
Show the questions that have been tagged with 'mongodb'.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'mongodb'})
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the titles of the first 3 questions asked by users with a reputation over 300000?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation > 300000
RETURN q.title
ORDER BY q.createdAt
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the questions asked by users with a display name containing 'Le'.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.display_name CONTAINS 'Le'
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the titles of questions where the user's display name is 'Alexandre'?,"MATCH (u:User {display_name: 'Alexandre'})-[:ASKED]->(q:Question)
RETURN q.title",Simple Retrieval Queries,buzzoverflow,False,False,False,
Which user with the highest reputation asked a question on '2020-06-05'?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.createdAt = datetime('2020-06-05T00:00:00Z')
RETURN u
ORDER BY u.reputation DESC
LIMIT 1",Simple Aggregation Queries,buzzoverflow,False,False,False,
What are the three most recent questions asked by users with no profile image?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.image IS NULL
RETURN q
ORDER BY q.createdAt DESC
LIMIT 3",Simple Aggregation Queries,buzzoverflow,True,False,False,
Which questions have a text length greater than 500 characters?,"MATCH (q:Question)
WHERE length(q.text) > 500
RETURN q",Simple Aggregation Queries,buzzoverflow,False,False,True,
Show the top 5 questions based on total vote count (upVotes plus downVotes).,"MATCH (q:Question)
RETURN q.id AS QuestionID, q.title AS Title, (q.upVotes + q.downVotes) AS TotalVotes
ORDER BY TotalVotes DESC
LIMIT 5",Simple Aggregation Queries,buzzoverflow,False,False,True,
What are the 3 questions with the most negative score?,"MATCH (q:Question)
RETURN q
ORDER BY q.score ASC
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,
Which 3 tags are associated with questions that have the highest favorites?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
RETURN t.name AS Tag, sum(q.favorites) AS TotalFavorites
ORDER BY TotalFavorites DESC
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,
List the 3 users who have asked questions with the most tags.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
WITH u, count(t) AS numTags
ORDER BY numTags DESC
LIMIT 3
RETURN u",Simple Aggregation Queries,buzzoverflow,False,False,True,
Identify the top 5 questions with titles containing the word 'error'.,"MATCH (q:Question)
WHERE q.title CONTAINS 'error'
RETURN q
ORDER BY q.score DESC
LIMIT 5",Simple Aggregation Queries,buzzoverflow,False,False,True,
Find the 3 users with the lowest reputation who have asked questions.,"MATCH (u:User)-[:ASKED]->(:Question)
RETURN u
ORDER BY u.reputation ASC
LIMIT 3",Simple Aggregation Queries,buzzoverflow,True,False,False,
Show the 3 questions with the longest link URLs.,"MATCH (q:Question)
RETURN q
ORDER BY length(q.link) DESC
LIMIT 3",Simple Aggregation Queries,buzzoverflow,True,False,False,
Which 3 questions have the most detailed (longest text) descriptions?,"MATCH (q:Question)
RETURN q
ORDER BY length(q.text) DESC
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,False,
List the top 5 most active users based on questions asked in the last year.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.createdAt >= datetime({year: date().year - 1})
WITH u, count(q) AS questions_asked
ORDER BY questions_asked DESC
LIMIT 5
RETURN u.display_name, u.id, questions_asked",Simple Aggregation Queries,buzzoverflow,False,False,True,
What are the 3 oldest questions in terms of creation date?,"MATCH (q:Question)
RETURN q
ORDER BY q.createdAt ASC
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,
Identify 3 users who asked questions tagged with 'graphql'.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'graphql'})
RETURN u
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,
Show the top 5 questions tagged with 'aws-lambda' by upVotes.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
RETURN q
ORDER BY q.upVotes DESC
LIMIT 5",Simple Aggregation Queries,buzzoverflow,False,False,True,
Which 3 questions have the fewest favorites but have been answered?,"MATCH (q:Question {answered: true})
WHERE q.favorites IS NOT NULL
RETURN q
ORDER BY q.favorites ASC
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,
List the 3 tags used the least in the questions database.,"MATCH (t:Tag)<-[:TAGGED]-(:Question)
WITH t, count(*) AS usageCount
ORDER BY usageCount ASC
LIMIT 3
RETURN t.name, usageCount",Simple Aggregation Queries,buzzoverflow,False,False,True,
Find the top 5 users who asked questions most recently.,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN u, q.createdAt AS QuestionDate
ORDER BY q.createdAt DESC
LIMIT 5",Simple Aggregation Queries,buzzoverflow,False,False,True,
What are the 3 questions with the most balanced vote ratio (closest upVotes to downVotes)?,"MATCH (q:Question)
RETURN q
ORDER BY abs(q.upVotes - q.downVotes)
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,
Which 3 users have the highest average score per question asked?,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u, AVG(q.score) AS avgScore
ORDER BY avgScore DESC
LIMIT 3
RETURN u.display_name AS UserName, avgScore",Simple Aggregation Queries,buzzoverflow,False,False,True,
List the 3 tags most frequently associated with unanswered questions.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.answered = false
RETURN t.name, count(q) AS UnansweredCount
ORDER BY UnansweredCount DESC
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,
Identify the 3 users who have asked the most questions without any upVotes.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.upVotes = 0
WITH u, count(q) AS questionsCount
ORDER BY questionsCount DESC
LIMIT 3
RETURN u.display_name, questionsCount",Simple Aggregation Queries,buzzoverflow,False,False,True,
Which 3 questions were created first on the platform?,"MATCH (q:Question)
RETURN q
ORDER BY q.createdAt
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,
List 3 users who have never been downvoted on their questions.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE NOT exists{ (u)-[:ASKED]->(:Question {downVotes: 0}) }
RETURN u
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,
Identify the top 5 questions that have not been answered yet.,"MATCH (q:Question)
WHERE q.answered = FALSE
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Simple Aggregation Queries,buzzoverflow,True,False,False,
Find the 3 questions with the longest title.,"MATCH (q:Question)
RETURN q
ORDER BY length(q.title) DESC
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,
Which questions have the text mentioning 'error' and were asked by a user with an image URL?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.text CONTAINS 'error' AND u.image IS NOT NULL
RETURN q, u",Complex Retrieval Queries,buzzoverflow,False,False,True,
Find all questions with a title containing 'Drupal' and tagged with 'react-apollo'.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'react-apollo'})
WHERE q.title CONTAINS 'Drupal'
RETURN q",Complex Retrieval Queries,buzzoverflow,False,False,False,
What are the first 3 questions that have a createdAt date on '2019-08-15' and have been answered?,"MATCH (q:Question)
WHERE q.createdAt = datetime('2019-08-15T00:00:00Z') AND q.answered = true
RETURN q
ORDER BY q.createdAt
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,True,
List the top 5 most recent questions with a score less than -3.,"MATCH (q:Question)
WHERE q.score < -3
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Complex Retrieval Queries,buzzoverflow,False,False,True,
Which user asked the most questions tagged with 'angular'?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'angular'})
WITH u, count(q) AS questionsCount
ORDER BY questionsCount DESC
LIMIT 1
RETURN u.display_name AS user, questionsCount",Complex Retrieval Queries,buzzoverflow,False,False,True,
"Find all questions that have been answered, have a createdAt date in June 2020, and are tagged with 'node.js'.","MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.createdAt >= datetime('2020-06-01T00:00:00Z') AND q.createdAt < datetime('2020-07-01T00:00:00Z')
  AND q.answered = true AND t.name = 'node.js'
RETURN q",Complex Retrieval Queries,buzzoverflow,False,False,True,
List the 5 most recent questions asked by users with a reputation greater than 50000.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation > 50000
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Simple Aggregation Queries,buzzoverflow,False,False,True,
List 3 questions that have been answered.,"MATCH (q:Question {answered: true})
RETURN q
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,
Which 3 users have the highest reputation?,"MATCH (u:User)
RETURN u
ORDER BY u.reputation DESC
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,
Show the top 5 questions by the number of times they have been favorited.,"MATCH (q:Question)
RETURN q
ORDER BY q.favorites DESC
LIMIT 5",Simple Aggregation Queries,buzzoverflow,False,False,True,
Identify the top 5 questions with the most upVotes.,"MATCH (q:Question)
RETURN q
ORDER BY q.upVotes DESC
LIMIT 5",Simple Aggregation Queries,buzzoverflow,False,False,True,
Which 3 tags are most frequently used in questions?,"MATCH (:Question)-[:TAGGED]->(t:Tag)
RETURN t.name, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,
List the top 5 questions with the most downVotes.,"MATCH (q:Question)
RETURN q
ORDER BY q.downVotes DESC
LIMIT 5",Simple Aggregation Queries,buzzoverflow,False,False,True,
Show the top 3 users who have asked the most questions.,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN u.id, u.display_name, count(q) AS questions_asked
ORDER BY questions_asked DESC
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,
What are the 3 most recent tags added to questions?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
RETURN t.name AS TagName, q.createdAt AS DateAdded
ORDER BY q.createdAt DESC
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,
List 3 questions with the lowest score.,"MATCH (q:Question)
RETURN q
ORDER BY q.score ASC
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,
Which 3 questions have the most comments?,"MATCH (q:Question)
RETURN q
ORDER BY q.commentsCount DESC
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,Question.commentsCount
Show the top 5 users by number of questions they have tagged.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
WITH u, count(q) AS questionsCount
ORDER BY questionsCount DESC
LIMIT 5
RETURN u.display_name, questionsCount",Simple Aggregation Queries,buzzoverflow,True,False,False,
What are the top 3 questions with the shortest text length?,"MATCH (q:Question)
RETURN q
ORDER BY length(q.text)
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,
Which 3 users have posted questions with no upVotes?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.upVotes = 0
RETURN u
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,
Find the 3 most recent questions asked on the platform.,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN q
ORDER BY q.createdAt DESC
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,
List the top 5 questions asked by users who have a reputation less than 100.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation < 100
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Complex Retrieval Queries,buzzoverflow,False,False,True,
What are the 3 questions with the most references to external links in their text?,"MATCH (q:Question)
WHERE q.text CONTAINS 'http'
RETURN q
ORDER BY size([link IN split(q.text, ' ') WHERE link STARTS WITH 'http']) DESC
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,True,
Which users asked questions about GraphQL subscriptions?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
WHERE t.name = 'graphql-subscriptions'
RETURN u",Pathfinding Queries,buzzoverflow,False,False,True,
Find all questions that have been both upvoted and downvoted.,"MATCH (q:Question)
WHERE q.upVotes > 0 AND q.downVotes > 0
RETURN q",Pathfinding Queries,buzzoverflow,False,False,False,
List the tags associated with questions asked in 2018.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.createdAt >= '2018-01-01T00:00:00Z' AND q.createdAt <= '2018-12-31T23:59:59Z'
RETURN t.name",Pathfinding Queries,buzzoverflow,False,False,True,
Which questions have a score of 1 and were created in 2017?,"MATCH (q:Question)
WHERE q.score = 1 AND q.createdAt >= datetime('2017-01-01T00:00:00Z') AND q.createdAt < datetime('2018-01-01T00:00:00Z')
RETURN q",Pathfinding Queries,buzzoverflow,False,False,False,
Identify users who asked questions about GraphQL APIs and list the first 3.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
WHERE t.name = 'GraphQL'
RETURN u
LIMIT 3",Pathfinding Queries,buzzoverflow,False,False,True,
What are the top 5 questions with links including 'github' in their URL?,"MATCH (q:Question)
WHERE q.link CONTAINS 'github'
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Pathfinding Queries,buzzoverflow,False,False,True,
Which questions were asked by users with a display name starting with 'A' and what are their titles?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.display_name STARTS WITH 'A'
RETURN q.title AS QuestionTitle, u.display_name AS UserName",Pathfinding Queries,buzzoverflow,False,False,True,
List the first 3 questions that have 'subscription' mentioned in their text.,"MATCH (q:Question)
WHERE q.text CONTAINS 'subscription'
RETURN q
LIMIT 3",Pathfinding Queries,buzzoverflow,False,False,True,
Which questions have been tagged with 'aws-lambda' and have an 'answered' status of true?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
WHERE q.answered = true
RETURN q",Pathfinding Queries,buzzoverflow,False,False,True,
What are the first 3 most recent questions tagged with 'graphql-js'?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'graphql-js'})
RETURN q
ORDER BY q.createdAt DESC
LIMIT 3",Pathfinding Queries,buzzoverflow,False,False,True,
Identify the tags for questions that have a createdAt date in 2020 and limit the results to the first 3.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.createdAt >= datetime('2020-01-01T00:00:00Z') AND q.createdAt <= datetime('2020-12-31T23:59:59Z')
RETURN t.name
LIMIT 3",Pathfinding Queries,buzzoverflow,False,False,True,
Which users have asked questions that have not received any upvotes and limit the results to the first 3?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.upVotes = 0
RETURN u
LIMIT 3",Pathfinding Queries,buzzoverflow,False,False,True,
List the first 3 questions with the most favorites and include their titles.,"MATCH (q:Question)
RETURN q.title, q.favorites
ORDER BY q.favorites DESC
LIMIT 3",Pathfinding Queries,buzzoverflow,False,False,True,
What are the titles and links of the first 3 questions with exactly one downvote?,"MATCH (q:Question {downVotes: 1})
RETURN q.title, q.link
LIMIT 3",Pathfinding Queries,buzzoverflow,False,False,True,
Which questions have been asked by users with a reputation above 1000 and are tagged with 'graphql'?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
WHERE u.reputation > 1000 AND t.name = 'graphql'
RETURN q",Pathfinding Queries,buzzoverflow,False,False,True,
Identify the first 3 questions asked by users whose link includes 'stackoverflow' and have been answered.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.link CONTAINS 'stackoverflow' AND q.answered = true
RETURN q
ORDER BY q.createdAt
LIMIT 3",Pathfinding Queries,buzzoverflow,False,False,True,
Which tags are associated with questions that have a createdAt date earlier than 2018?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.createdAt < datetime('2018-01-01T00:00:00Z')
RETURN t.name",Pathfinding Queries,buzzoverflow,False,False,True,
Which users have asked more than 5 questions?,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u, count(q) AS questionsCount
WHERE questionsCount > 5
RETURN u",Complex Aggregation Queries,buzzoverflow,False,False,True,
What are the top 5 most upvoted questions?,"MATCH (q:Question)
RETURN q
ORDER BY q.upVotes DESC
LIMIT 5",Complex Aggregation Queries,buzzoverflow,False,False,False,
List the first 3 tags associated with questions that have more than 10 downvotes.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.downVotes > 10
RETURN t.name
LIMIT 3",Complex Aggregation Queries,buzzoverflow,False,False,True,
Which users asked questions that have been favorited at least once and limit the results to the first 3?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.favorites >= 1
RETURN u
LIMIT 3",Pathfinding Queries,buzzoverflow,False,False,True,
List the first 3 users who have asked questions with 'graphql' in the title.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.title CONTAINS 'graphql'
RETURN u
LIMIT 3",Pathfinding Queries,buzzoverflow,False,False,True,
Which questions were tagged with 'graphql' and have a link containing 'stackoverflow'?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE t.name = 'graphql' AND q.link CONTAINS 'stackoverflow'
RETURN q",Pathfinding Queries,buzzoverflow,False,False,True,
What are the first 3 questions asked by users with a reputation less than 500?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation < 500
RETURN q
ORDER BY q.createdAt ASC
LIMIT 3",Pathfinding Queries,buzzoverflow,False,False,True,
What are the top 5 questions with the most upvotes?,"MATCH (q:Question)
RETURN q
ORDER BY q.upVotes DESC
LIMIT 5",Pathfinding Queries,buzzoverflow,False,False,True,
List the first 3 tags associated with questions about GraphQL.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.title CONTAINS ""GraphQL""
RETURN t.name
LIMIT 3",Pathfinding Queries,buzzoverflow,False,False,True,
Which questions were answered and have a score of 1 or more?,"MATCH (q:Question)
WHERE q.answered = true AND q.score >= 1
RETURN q",Pathfinding Queries,buzzoverflow,False,False,True,
Find all users who have asked more than one question.,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u, count(q) AS numQuestions
WHERE numQuestions > 1
RETURN u",Pathfinding Queries,buzzoverflow,False,False,True,
Which questions have been tagged with 'graphql-js' and have downvotes?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'graphql-js'})
WHERE q.downVotes > 0
RETURN q",Pathfinding Queries,buzzoverflow,False,False,True,
What are the top 5 most recent questions asked by users with a reputation above 2000?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation > 2000
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Pathfinding Queries,buzzoverflow,False,False,True,
How many questions have been tagged with 'aws-lambda'?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
RETURN count(q) AS NumberOfQuestions",Pathfinding Queries,buzzoverflow,False,False,False,
List all the questions asked by users with an image link ending in 'identicon' and limit the results to the first 3.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.image ENDS WITH 'identicon'
RETURN q
LIMIT 3",Pathfinding Queries,buzzoverflow,False,False,True,
What are the titles of the questions that have not been answered yet and have a negative score?,"MATCH (q:Question)
WHERE q.answered = FALSE AND q.score < 0
RETURN q.title",Pathfinding Queries,buzzoverflow,False,False,True,
Which 3 users have the highest rate of answered questions?,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u, count(q) AS totalQuestions, sum(CASE WHEN q.answered = true THEN 1 ELSE 0 END) AS answeredQuestions
WHERE totalQuestions > 0
RETURN u.display_name, u.id, u.reputation, (toFloat(answeredQuestions) / totalQuestions) AS answerRate
ORDER BY answerRate DESC, totalQuestions DESC
LIMIT 3",Simple Aggregation Queries,buzzoverflow,False,False,False,
Who are the top 5 users by reputation who have asked a question about hierarchical data types in GraphQL?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
WHERE t.name = 'GraphQL' AND q.title CONTAINS 'hierarchical data types'
RETURN u.display_name, u.reputation
ORDER BY u.reputation DESC
LIMIT 5",Pathfinding Queries,buzzoverflow,False,False,True,
Identify the first 3 questions with zero favorites and at least one upvote.,"MATCH (q:Question)
WHERE q.favorites = 0 AND q.upVotes >= 1
RETURN q
ORDER BY q.createdAt
LIMIT 3",Pathfinding Queries,buzzoverflow,False,False,True,
List the first 3 users who asked questions tagged with 'graphql-subscriptions'.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'graphql-subscriptions'})
RETURN u
LIMIT 3",Pathfinding Queries,buzzoverflow,False,False,True,
"How many questions have a 'createdAt' date on or after June 5, 2020, and are tagged with 'graphql'?","MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'graphql'})
WHERE q.createdAt >= datetime('2020-06-05T00:00:00Z')
RETURN count(q) AS NumberOfQuestions",Pathfinding Queries,buzzoverflow,False,False,True,
What are the links to the questions that have been answered and tagged with 'aws-lambda'?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
WHERE q.answered = true
RETURN q.link",Pathfinding Queries,buzzoverflow,False,False,True,
Which users have asked questions with a score of zero and have not been answered?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.score = 0 AND q.answered = FALSE
RETURN u",Pathfinding Queries,buzzoverflow,False,False,True,
List the top 5 questions that have the most downvotes.,"MATCH (q:Question)
RETURN q
ORDER BY q.downVotes DESC
LIMIT 5",Pathfinding Queries,buzzoverflow,False,False,True,
What are the titles of the first 3 questions with a score greater than or equal to 3?,"MATCH (q:Question)
WHERE q.score >= 3
RETURN q.title
ORDER BY q.createdAt ASC
LIMIT 3",Pathfinding Queries,buzzoverflow,False,False,True,
Which tags are associated with questions that have been downvoted at least once?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.downVotes > 0
RETURN DISTINCT t.name",Pathfinding Queries,buzzoverflow,False,False,True,
Identify the tags of the first 3 questions asked by 'Christopher'.,"MATCH (u:User {display_name: 'Christopher'})-[:ASKED]->(q:Question)
WITH q
ORDER BY q.createdAt ASC
LIMIT 3
MATCH (q)-[:TAGGED]->(t:Tag)
RETURN q.id, q.title, t.name",Pathfinding Queries,buzzoverflow,False,False,False,
Which questions about GraphQL have been asked in June 2020?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE t.name = 'GraphQL' AND q.createdAt >= '2020-06-01T00:00:00Z' AND q.createdAt < '2020-07-01T00:00:00Z'
RETURN q",Pathfinding Queries,buzzoverflow,False,False,True,
What are the first 3 questions with a link containing 'stackoverflow' and more than 1 favorite?,"MATCH (q:Question)
WHERE q.link CONTAINS 'stackoverflow' AND q.favorites > 1
RETURN q
ORDER BY q.createdAt
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,True,
What are the top 5 questions with the highest number of favorites?,"MATCH (q:Question)
RETURN q
ORDER BY q.favorites DESC
LIMIT 5",Simple Aggregation Queries,buzzoverflow,True,False,False,
List the first 3 questions with more than one tag.,"MATCH (q:Question)
WHERE size((q)-[:TAGGED]->(:Tag)) > 1
RETURN q
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the first 3 tags that are associated with more than one question.,"MATCH (t:Tag)<-[:TAGGED]-(q:Question)
WITH t, count(q) AS numQuestions
WHERE numQuestions > 1
RETURN t.name
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the top 5 most recent questions asked?,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
Show the 3 questions with the most downVotes.,"MATCH (q:Question)
RETURN q
ORDER BY q.downVotes DESC
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which 5 users have asked the most questions?,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN u.id, u.display_name, count(q) AS questions_asked
ORDER BY questions_asked DESC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the first 3 questions that have not been answered yet.,"MATCH (q:Question)
WHERE q.answered = false
RETURN q
ORDER BY q.createdAt
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which 5 questions have the lowest score?,"MATCH (q:Question)
RETURN q
ORDER BY q.score ASC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
Show the first 3 questions tagged with 'graphql'.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'graphql'})
RETURN q
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the top 5 users by image link?,"MATCH (u:User)
WHERE u.image IS NOT NULL
RETURN u.image, u.display_name, u.reputation
ORDER BY u.reputation DESC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the 3 questions with the highest number of downVotes that have been answered.,"MATCH (q:Question {answered: true})
RETURN q
ORDER BY q.downVotes DESC
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which 5 questions were created in the year 2020?,"MATCH (q:Question)
WHERE q.createdAt >= datetime('2020-01-01T00:00:00Z') AND q.createdAt < datetime('2021-01-01T00:00:00Z')
RETURN q
ORDER BY q.createdAt
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
Show the first 3 questions asked by a user with a reputation over 2000.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation > 2000
RETURN q
ORDER BY q.createdAt
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the 5 oldest questions in the database?,"MATCH (q:Question)
RETURN q
ORDER BY q.createdAt
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
Find all questions that mention 'schema' in their text and have been tagged with 'aws-lambda'.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
WHERE q.text CONTAINS 'schema'
RETURN q",Complex Retrieval Queries,buzzoverflow,False,False,True,
Which 5 questions have the lowest number of favorites?,"MATCH (q:Question)
RETURN q
ORDER BY q.favorites ASC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
Show the first 3 users who have asked a question about 'react-apollo'.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'react-apollo'})
RETURN u
ORDER BY q.createdAt
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the 5 most recent questions asked by users with a reputation under 1000?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation < 1000
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the top 5 users who have never asked a question about 'node.js'.,"MATCH (u:User)
WHERE NOT EXISTS {
  MATCH (u)-[:ASKED]->(:Question)-[:TAGGED]->(:Tag {name: 'node.js'})
}
RETURN u
ORDER BY u.reputation DESC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,True,False,False,
What are the 5 questions with the shortest title?,"MATCH (q:Question)
RETURN q
ORDER BY length(q.title) ASC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
Show the first 3 questions that have a link to an external site.,"MATCH (q:Question)
WHERE q.link IS NOT NULL
RETURN q
ORDER BY q.createdAt
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which 5 questions have the most upVotes?,"MATCH (q:Question)
RETURN q
ORDER BY q.upVotes DESC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
Show the first 3 users with the highest reputation.,"MATCH (u:User)
RETURN u
ORDER BY u.reputation DESC
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the top 5 questions with the highest score?,"MATCH (q:Question)
RETURN q
ORDER BY q.score DESC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the first 3 questions that have been answered.,"MATCH (q:Question {answered: true})
RETURN q
ORDER BY q.createdAt
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the titles of the questions tagged with 'graphql-js' and have more than 1 upVote?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'graphql-js'})
WHERE q.upVotes > 1
RETURN q.title",Simple Aggregation Queries,buzzoverflow,False,False,True,
How many questions have been asked by users with a display_name starting with 'A'?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.display_name STARTS WITH 'A'
RETURN count(q) AS NumberOfQuestions",Simple Aggregation Queries,buzzoverflow,False,False,True,
List all users who have asked a question that includes the word 'subscription' in the title.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.title CONTAINS 'subscription'
RETURN u",Simple Aggregation Queries,buzzoverflow,False,False,False,
Which questions were created in 2019 and have a score less than 0?,"MATCH (q:Question)
WHERE q.createdAt >= '2019-01-01T00:00:00Z' AND q.createdAt < '2020-01-01T00:00:00Z' AND q.score < 0
RETURN q",Simple Aggregation Queries,buzzoverflow,False,False,True,
Find all questions where the 'link' property includes 'stackoverflow' and the score is more than 2.,"MATCH (q:Question)
WHERE q.link CONTAINS 'stackoverflow' AND q.score > 2
RETURN q",Simple Aggregation Queries,buzzoverflow,False,False,True,
Which questions have a creation date on a Monday?,"MATCH (q:Question)
WHERE date(q.createdAt).dayOfWeek = 1
RETURN q",Simple Aggregation Queries,buzzoverflow,False,False,False,
List the questions that have been tagged with 'graphql' and have a 'createdAt' date in 2018.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'graphql'})
WHERE q.createdAt >= '2018-01-01T00:00:00Z' AND q.createdAt <= '2018-12-31T23:59:59Z'
RETURN q",Simple Aggregation Queries,buzzoverflow,False,False,True,
"What is the average score of questions asked by users with more than 10,000 reputation?","MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation > 10000
RETURN AVG(q.score) AS average_score",Simple Aggregation Queries,buzzoverflow,False,False,True,
List the questions that have a score of 1 and were asked by users with a display_name containing 'Le'.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.score = 1 AND u.display_name CONTAINS 'Le'
RETURN q",Simple Aggregation Queries,buzzoverflow,True,False,False,
List the 5 questions with the longest text content.,"MATCH (q:Question)
RETURN q
ORDER BY length(q.text) DESC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,False,
Which questions have more than 3 favorites and were asked by a user with an id less than 100000?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.favorites > 3 AND u.id < 100000
RETURN q",Simple Aggregation Queries,buzzoverflow,False,False,True,
Who are the users that asked questions with more than 5 favorites?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.favorites > 5
RETURN u",Pathfinding Queries,buzzoverflow,False,False,True,
What are the top 5 most recent questions asked on the platform?,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Pathfinding Queries,buzzoverflow,False,False,True,
Which users have asked questions that were tagged with 'graphql'?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'graphql'})
RETURN u",Pathfinding Queries,buzzoverflow,False,False,True,
List all questions that received more than 10 upVotes.,"MATCH (q:Question)
WHERE q.upVotes > 10
RETURN q",Pathfinding Queries,buzzoverflow,False,False,True,
What are the top 3 most downvoted questions in the database?,"MATCH (q:Question)
RETURN q
ORDER BY q.downVotes DESC
LIMIT 3",Pathfinding Queries,buzzoverflow,False,False,True,
Find all tags associated with questions asked by a user with more than 100000 reputation.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
WHERE u.reputation > 100000
RETURN t.name AS TagName",Pathfinding Queries,buzzoverflow,False,False,True,
Which questions have not been answered and have a creation date before 2020?,"MATCH (q:Question)
WHERE q.answered = FALSE AND q.createdAt < datetime('2020-01-01T00:00:00Z')
RETURN q",Pathfinding Queries,buzzoverflow,False,False,True,
List the top 5 questions with the highest score that were also answered.,"MATCH (q:Question)
WHERE q.answered = true
RETURN q
ORDER BY q.score DESC
LIMIT 5",Pathfinding Queries,buzzoverflow,False,False,True,
What are the top 5 questions with the highest number of favorites?,"MATCH (q:Question)
RETURN q
ORDER BY q.favorites DESC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
How many questions tagged with 'react-apollo' were asked in 2019?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'react-apollo'})
WHERE q.createdAt >= '2019-01-01T00:00:00Z' AND q.createdAt < '2020-01-01T00:00:00Z'
RETURN count(q) AS NumberOfQuestions",Simple Aggregation Queries,buzzoverflow,False,False,True,
Which 5 questions have titles containing the word 'error'?,"MATCH (q:Question)
WHERE q.title CONTAINS 'error'
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
Find the top 3 questions with the most complex text content.,"MATCH (q:Question)
RETURN q
ORDER BY size(split(q.text, ' ')) DESC
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the top 5 questions tagged with 'aws-lambda'?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
RETURN q
ORDER BY q.score DESC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which questions have been answered and have more than 2 upVotes?,"MATCH (q:Question)
WHERE q.answered = true AND q.upVotes > 2
RETURN q",Complex Retrieval Queries,buzzoverflow,False,False,True,
Show the first 3 questions that have been answered and have more than 5 favorites.,"MATCH (q:Question)
WHERE q.answered = true AND q.favorites > 5
RETURN q
ORDER BY q.createdAt
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the first 3 questions that have been downvoted at least 5 times?,"MATCH (q:Question)
WHERE q.downVotes >= 5
RETURN q
ORDER BY q.createdAt
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,True,
List the top 5 questions with the most upVotes that were created in 2020.,"MATCH (q:Question)
WHERE q.createdAt >= datetime('2020-01-01T00:00:00Z') AND q.createdAt <= datetime('2020-12-31T23:59:59Z')
RETURN q
ORDER BY q.upVotes DESC
LIMIT 5",Complex Retrieval Queries,buzzoverflow,False,False,True,
Which user asked the question titled 'Playground is not loading with apollo-server-lambda'?,"MATCH (u:User)-[:ASKED]->(q:Question {title: 'Playground is not loading with apollo-server-lambda'})
RETURN u",Complex Retrieval Queries,buzzoverflow,False,False,True,
Find all questions tagged 'react-apollo' that have not been answered.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'react-apollo'})
WHERE q.answered = FALSE
RETURN q",Complex Retrieval Queries,buzzoverflow,False,False,True,
What are the top 3 most recent questions asked by users with a reputation over 100?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.reputation > 100
RETURN q
ORDER BY q.createdAt DESC
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,True,
List all questions that have 'GraphQL' mentioned in their text and are tagged with 'angular'.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.text CONTAINS 'GraphQL' AND t.name = 'angular'
RETURN q",Complex Retrieval Queries,buzzoverflow,False,False,True,
Which questions were asked by users with an image link containing 'googleusercontent'?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.image CONTAINS 'googleusercontent'
RETURN q",Complex Retrieval Queries,buzzoverflow,False,False,True,
List the top 5 most favorited questions.,"MATCH (q:Question)
RETURN q
ORDER BY q.favorites DESC
LIMIT 5",Complex Retrieval Queries,buzzoverflow,False,False,False,
What are the first 3 questions that were created on '2020-06-05' and have a score below zero?,"MATCH (q:Question)
WHERE q.createdAt = datetime('2020-06-05T00:00:00Z') AND q.score < 0
RETURN q
ORDER BY q.createdAt
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,True,
Which questions have a title containing 'Apollo' and were created before 2020?,"MATCH (q:Question)
WHERE q.title CONTAINS 'Apollo' AND q.createdAt < datetime('2020-01-01T00:00:00Z')
RETURN q",Complex Retrieval Queries,buzzoverflow,False,False,False,
Find all questions with more than 3 downVotes and tagged with 'node.js'.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'node.js'})
WHERE q.downVotes > 3
RETURN q",Complex Retrieval Queries,buzzoverflow,False,False,True,
What are the first 3 questions that have a score of zero and no favorites?,"MATCH (q:Question)
WHERE q.score = 0 AND q.favorites = 0
RETURN q
ORDER BY q.createdAt
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,False,
List the top 5 users by reputation who have asked a question about 'GraphQL'.,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'GraphQL'})
RETURN u.display_name, u.reputation
ORDER BY u.reputation DESC
LIMIT 5",Complex Retrieval Queries,buzzoverflow,False,False,True,
Which user with the display name 'Stzl' asked a question with 'bad request' in the title?,"MATCH (u:User {display_name: 'Stzl'})-[:ASKED]->(q:Question)
WHERE q.title CONTAINS 'bad request'
RETURN u, q",Complex Retrieval Queries,buzzoverflow,False,False,False,
Find all questions with a 'createdAt' date in 2019 and exactly 0 upVotes.,"MATCH (q:Question)
WHERE q.createdAt >= '2019-01-01T00:00:00Z' AND q.createdAt <= '2019-12-31T23:59:59Z' AND q.upVotes = 0
RETURN q",Complex Retrieval Queries,buzzoverflow,False,False,True,
What are the first 3 questions asked by users with a display name starting with 'Alex'?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.display_name STARTS WITH 'Alex'
RETURN q
ORDER BY q.createdAt
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,True,
List the top 5 questions with the highest number of downVotes.,"MATCH (q:Question)
RETURN q
ORDER BY q.downVotes DESC
LIMIT 5",Complex Retrieval Queries,buzzoverflow,False,False,True,
Which questions were asked by a user with an ID greater than 9000000?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.id > 9000000
RETURN q",Complex Retrieval Queries,buzzoverflow,False,False,True,
List the top 5 questions by users who have a link ending in 'alexandre'.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.link ENDS WITH 'alexandre'
RETURN q
ORDER BY q.score DESC
LIMIT 5",Complex Retrieval Queries,buzzoverflow,False,False,True,
What are the first 3 questions asked by the user with a reputation of 65?,"MATCH (u:User {reputation: 65})-[:ASKED]->(q:Question)
RETURN q
ORDER BY q.createdAt ASC
LIMIT 3",Complex Retrieval Queries,buzzoverflow,False,False,True,
Find all questions tagged with 'aws-lambda' that have a negative score.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'aws-lambda'})
WHERE q.score < 0
RETURN q",Complex Retrieval Queries,buzzoverflow,False,False,True,
"What are the top 5 questions that were asked on a holiday (assuming holidays are January 1st, December 25th)?","MATCH (u:User)-[:ASKED]->(q:Question)
WHERE date(q.createdAt).month = 1 AND date(q.createdAt).day = 1 OR
      date(q.createdAt).month = 12 AND date(q.createdAt).day = 25
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the first 3 users with the least reputation who have asked a question.,"MATCH (u:User)-[:ASKED]->(:Question)
RETURN u
ORDER BY u.reputation ASC
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
Find the 5 questions with the most tags.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WITH q, count(t) AS numTags
ORDER BY numTags DESC
LIMIT 5
RETURN q",Simple Retrieval Queries,buzzoverflow,False,False,True,
Show the first 3 questions that were asked by users with an image link containing 'googleusercontent'.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.image CONTAINS 'googleusercontent'
RETURN q
ORDER BY q.createdAt
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the top 5 questions by the number of total votes (upVotes and downVotes combined)?,"MATCH (q:Question)
RETURN q.id AS QuestionID, q.title AS Title, (q.upVotes + q.downVotes) AS TotalVotes
ORDER BY TotalVotes DESC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the 3 questions with the most references to external links in their text.,"MATCH (q:Question)
WHERE q.text CONTAINS 'http'
RETURN q
ORDER BY size([link IN split(q.text, ' ') WHERE link STARTS WITH 'http']) DESC
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the first 3 questions where the user asking has an id less than 5000.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.id < 5000
RETURN q
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
Show the first 3 questions where the score is exactly zero.,"MATCH (q:Question)
WHERE q.score = 0
RETURN q
ORDER BY q.createdAt
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
What are the 5 most recent questions with no favorites?,"MATCH (q:Question)
WHERE q.favorites = 0
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,True,False,False,
List the first 3 tags that appear only once across all questions.,"MATCH (t:Tag)
WHERE size((t)<-[:TAGGED]-(:Question)) = 1
RETURN t.name
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which 5 users have the most distinct tags for questions they've asked?,"MATCH (u:User)-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
WITH u, count(DISTINCT t) AS distinctTags
ORDER BY distinctTags DESC
LIMIT 5
RETURN u.display_name, distinctTags",Simple Retrieval Queries,buzzoverflow,False,False,True,
Show the first 3 questions that have been answered and have a score less than zero.,"MATCH (q:Question)
WHERE q.answered = true AND q.score < 0
RETURN q
ORDER BY q.createdAt
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,False,
Show the first 3 questions that have been linked in more than one answer.,"MATCH (q:Question)
WHERE exists{(q)<-[:ANSWERS]-(:Answer)}
WITH q, count{(q)<-[:ANSWERS]-(:Answer)} AS answersCount
WHERE answersCount > 1
RETURN q
ORDER BY q.createdAt
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,Answer
Show the first 3 questions that have been linked in more than one answer.,"MATCH (q:Question)
WHERE exists{(q)<-[:ANSWERS]-(:Answer)}
WITH q, count{(q)<-[:ANSWERS]-(:Answer)} AS answersCount
WHERE answersCount > 1
RETURN q
ORDER BY q.createdAt
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,ANSWERS
Which 5 questions have text containing the word 'schema'?,"MATCH (q:Question)
WHERE q.text CONTAINS 'schema'
RETURN q
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the first 3 questions with a score greater than 5.,"MATCH (q:Question)
WHERE q.score > 5
RETURN q
ORDER BY q.createdAt
LIMIT 3",Simple Retrieval Queries,buzzoverflow,True,False,False,
What are the top 5 questions with exactly 3 tags?,"MATCH (q:Question)
WHERE size((q)-[:TAGGED]->(:Tag)) = 3
RETURN q
ORDER BY q.score DESC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
Which 5 users have asked questions with the word 'variables' in the title?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.title CONTAINS 'variables'
RETURN u
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
Find the 5 most recent questions tagged 'graphql' that have been answered.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'graphql'})
WHERE q.answered = true
RETURN q
ORDER BY q.createdAt DESC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
List the first 3 questions asked by users with a display name starting with 'A'.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.display_name STARTS WITH 'A'
RETURN q
ORDER BY q.createdAt
LIMIT 3",Simple Retrieval Queries,buzzoverflow,True,False,False,
What are the top 5 longest titles for questions in the database?,"MATCH (q:Question)
RETURN q.title, length(q.title) AS titleLength
ORDER BY titleLength DESC
LIMIT 5",Simple Retrieval Queries,buzzoverflow,False,False,True,
Show the first 3 questions where the createdAt date is on a weekend.,"MATCH (q:Question)
WHERE date(q.createdAt).dayOfWeek IN [6, 7]
RETURN q
ORDER BY q.createdAt
LIMIT 3",Simple Retrieval Queries,buzzoverflow,False,False,True,
Identify the top 3 organizations with the most subsidiaries headquartered in a city named 'Seattle'.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(s:Organization)-[:IN_CITY]->(c:City {name: ""Seattle""})
WITH o, count(s) AS subsidiariesCount
ORDER BY subsidiariesCount DESC
LIMIT 3
RETURN o.name AS OrganizationName, subsidiariesCount",Verbose query,companies,False,False,True,
List the first 5 industry categories mentioned in the database.,"MATCH (ic:IndustryCategory)
RETURN ic.name
LIMIT 5",Simple Retrieval Queries,companies,False,False,True,
Which organizations have more than 100 employees?,"MATCH (o:Organization)
WHERE o.nbrEmployees > 100
RETURN o",Simple Retrieval Queries,companies,False,False,True,
What are the first 3 cities located in the United States of America?,"MATCH (c:City)-[:IN_COUNTRY]->(co:Country {name: ""United States of America""})
RETURN c.name
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Who are the CEOs of the first 3 organizations in the database?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
RETURN o.name AS Organization, p.name AS CEO
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
List top 5 organizations that have a revenue greater than 100 million.,"MATCH (o:Organization)
WHERE o.revenue > 100000000
RETURN o
ORDER BY o.revenue DESC
LIMIT 5",Simple Retrieval Queries,companies,False,False,True,
What are the first 3 articles that mention the organization 'Accenture'?,"MATCH (o:Organization {name: ""Accenture""})<-[:MENTIONS]-(a:Article)
RETURN a
ORDER BY a.date DESC
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Which organizations are located in Seattle?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Seattle""})
RETURN o",Simple Retrieval Queries,companies,False,False,False,
Which organizations have a CEO named 'Julie Spellman Sweet' and a summary mentioning 'Accenture'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""})
WHERE o.summary CONTAINS 'Accenture'
RETURN o",Verbose query,companies,False,False,False,
What are the names of the organizations that have a board member named 'Julie Spellman Sweet' and a revenue greater than 100 million?,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_BOARD_MEMBER]-(o:Organization)
WHERE o.revenue > 100000000
RETURN o.name",Verbose query,companies,False,False,True,
Find the top 3 articles that mention organizations based in 'Seattle'.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(c:City {name: 'Seattle'})
RETURN a
ORDER BY a.date DESC
LIMIT 3",Verbose query,companies,False,False,True,
What are the names of the organizations that have a CEO with a summary mentioning 'Accenture' and a revenue greater than 100 million?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'Accenture' AND o.revenue > 100000000
RETURN o.name",Verbose query,companies,False,False,True,
List the first 5 organizations that have a CEO with a name mentioned in more than one article.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE EXISTS {
  MATCH (a:Article)-[:MENTIONS]->(o)
  WITH p, COUNT(a) AS articlesCount
  WHERE articlesCount > 1
  RETURN p
}
RETURN o
LIMIT 5",Verbose query,companies,False,False,True,
Identify the top 3 organizations that have a subsidiary with the largest number of employees.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)
WHERE sub.nbrEmployees IS NOT NULL
RETURN o.name AS ParentOrganization, sub.name AS Subsidiary, sub.nbrEmployees AS NumberOfEmployees
ORDER BY sub.nbrEmployees DESC
LIMIT 3",Verbose query,companies,False,False,False,
Which organizations have a CEO who has authored an article with a sentiment score greater than 0.5?,"MATCH (org:Organization)-[:HAS_CEO]->(ceo:Person)-[:AUTHORED]->(article:Article)
WHERE article.sentiment > 0.5
RETURN org.name AS OrganizationName, ceo.name AS CEOName, article.title AS ArticleTitle, article.sentiment AS SentimentScore",Verbose query,companies,False,False,True,AUTHORED
List the first 5 organizations that have a supplier headquartered in a city named 'Seattle'.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(supplier:Organization)-[:IN_CITY]->(c:City {name: 'Seattle'})
RETURN o
LIMIT 5",Verbose query,companies,False,False,True,
Find the top 3 organizations that have a CEO with a summary mentioning 'Accenture' and a revenue greater than 50 million.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'Accenture' AND o.revenue > 50000000
RETURN o
ORDER BY o.revenue DESC
LIMIT 3",Verbose query,companies,False,False,True,
What are the names of the first 3 articles authored by 'James Blackman'?,"MATCH (a:Article {author: ""James Blackman""})
RETURN a.title
LIMIT 3",Simple Retrieval Queries,companies,False,False,False,
List the first 5 organizations that have a CEO with a name mentioned in at least two different articles and a revenue greater than 50 million.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)<-[:MENTIONS]-(a:Article)
WHERE o.revenue > 50000000
WITH o, p, count(DISTINCT a) AS articlesCount
WHERE articlesCount >= 2
RETURN o
LIMIT 5",Verbose query,companies,False,False,True,
Can you provide the first 3 organizations that have been dissolved?,"MATCH (o:Organization)
WHERE o.isDissolved = true
RETURN o
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Name 3 organizations that are listed as dissolved.,"MATCH (o:Organization {isDissolved: true})
RETURN o.name
LIMIT 3",Simple Aggregation Queries,companies,False,False,True,
Which organizations are public companies?,"MATCH (o:Organization)
WHERE o.isPublic = true
RETURN o",Simple Retrieval Queries,companies,False,False,True,
What are the industry categories for organizations headquartered in Chattanooga?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Chattanooga""})
MATCH (o)-[:HAS_CATEGORY]->(ic:IndustryCategory)
RETURN o.name AS OrganizationName, ic.name AS IndustryCategory",Complex Aggregation Queries,companies,False,False,True,
List the cities where organizations with a public status are located.,"MATCH (o:Organization {isPublic: true})-[:IN_CITY]->(c:City)
RETURN DISTINCT c.name AS CityName",Complex Aggregation Queries,companies,False,False,False,
Which organizations have a parent organization with a revenue of more than $100 million?,"MATCH (childOrg:Organization)-[:HAS_PARENT]->(parentOrg:Organization)
WHERE parentOrg.revenue > 100000000
RETURN childOrg",Complex Aggregation Queries,companies,False,False,True,
Which organizations are mentioned in articles about cybersecurity?,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS 'cybersecurity'
MATCH (a)-[:MENTIONS]->(o:Organization)
RETURN o",Complex Aggregation Queries,companies,False,False,True,
What are the names of the top 5 organizations in terms of number of employees?,"MATCH (o:Organization)
WHERE o.nbrEmployees IS NOT NULL
RETURN o.name, o.nbrEmployees
ORDER BY o.nbrEmployees DESC
LIMIT 5",Complex Aggregation Queries,companies,False,False,True,
Which organizations have a CEO named 'Julie Spellman Sweet'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
RETURN o",Complex Aggregation Queries,companies,False,False,True,
List the articles that have a sentiment score below 0.3.,"MATCH (a:Article)
WHERE a.sentiment < 0.3
RETURN a",Complex Aggregation Queries,companies,False,False,True,
"Which organizations have more than 10,000 employees and are located in a city that is not the capital of a country?","MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees > 10000 AND NOT EXISTS {
  (c)-[:IS_CAPITAL_OF]->(:Country)
}
RETURN o",Complex Aggregation Queries,companies,False,False,True,IS_CAPITAL_OF
What is the revenue and employee number for organizations headquartered in Rome?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Rome""})
RETURN o.name AS OrganizationName, o.revenue AS Revenue, o.nbrEmployees AS NumberOfEmployees",Complex Aggregation Queries,companies,False,False,False,
Who are the investors in the organization 'Accenture' who are also people?,"MATCH (o:Organization {name: ""Accenture""})<-[:HAS_INVESTOR]-(p:Person)
RETURN p",Complex Aggregation Queries,companies,False,False,True,
Which organizations have a summary that mentions the word 'software'?,"MATCH (o:Organization)
WHERE o.summary CONTAINS 'software'
RETURN o",Complex Aggregation Queries,companies,False,False,True,
List all organizations that are not public but have subsidiaries.,"MATCH (o:Organization {isPublic: false})-[:HAS_SUBSIDIARY]->(sub:Organization)
RETURN o, collect(sub) AS Subsidiaries",Complex Aggregation Queries,companies,False,False,True,
List the authors who have mentioned more than three different organizations in their articles.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WITH a.author AS author, COUNT(DISTINCT o) AS orgCount
WHERE orgCount > 3
RETURN author",Complex Aggregation Queries,companies,False,False,True,
Which organizations have a motto that includes the word 'technology'?,"MATCH (o:Organization)
WHERE o.motto CONTAINS 'technology'
RETURN o",Complex Aggregation Queries,companies,False,False,True,
What is the summary of the city where New Energy Group is located?,"MATCH (o:Organization {name: ""New Energy Group""})-[:IN_CITY]->(c:City)
RETURN c.summary AS CitySummary",Complex Aggregation Queries,companies,False,False,True,
Which organizations have the most subsidiaries? Provide top 3.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)
WITH o, count(sub) AS numSubsidiaries
ORDER BY numSubsidiaries DESC
LIMIT 3
RETURN o.name AS Organization, numSubsidiaries",Complex Aggregation Queries,companies,False,False,True,
List the organizations that have a sentiment score above 0.8 in their latest article mention.,"MATCH (o:Organization)-[:MENTIONS]-(a:Article)
WHERE a.sentiment > 0.8
WITH o, a.date AS articleDate
ORDER BY articleDate DESC
RETURN DISTINCT o",Complex Aggregation Queries,companies,False,False,True,
Which organizations have more than 3 suppliers?,"MATCH (o:Organization)
WHERE count{(o)-[:HAS_SUPPLIER]->(:Organization)} > 3
RETURN o",Complex Aggregation Queries,companies,False,False,False,
What are the names of organizations that have Accenture as their CEO?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: ""Accenture""})
RETURN o.name AS OrganizationName",Complex Aggregation Queries,companies,False,False,True,
List all organizations that are public and have no employees listed.,"MATCH (o:Organization)
WHERE o.isPublic = true AND o.nbrEmployees IS NULL
RETURN o",Complex Aggregation Queries,companies,False,False,True,
What are the names of organizations that are subsidiaries of Accenture?,"MATCH (parent:Organization {name: ""Accenture""})-[:HAS_SUBSIDIARY]->(subsidiary:Organization)
RETURN subsidiary.name AS SubsidiaryName",Complex Aggregation Queries,companies,False,False,True,
Who are the board members of organizations with more than $500 million in revenue?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WHERE o.revenue > 500000000
RETURN o.name AS Organization, p.name AS BoardMember",Complex Aggregation Queries,companies,False,False,True,
Which organizations are mentioned in articles posted on MrWeb?,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk), (a)-[:MENTIONS]->(o:Organization)
WHERE a.siteName = ""MrWeb""
RETURN DISTINCT o.name AS OrganizationName",Complex Aggregation Queries,companies,False,False,True,
List the countries that have organizations with a motto.,"MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country)
WHERE o.motto IS NOT NULL
RETURN DISTINCT c.name AS CountryName",Complex Aggregation Queries,companies,False,False,True,
Which organizations are mentioned in articles from the year 2022?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.date.year = 2022
RETURN o",Complex Aggregation Queries,companies,False,False,True,
Which cities have more than three organizations based in them?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WITH c, count(o) AS orgCount
WHERE orgCount > 3
RETURN c.name, orgCount",Complex Aggregation Queries,companies,False,False,False,
What are the organizations that are headquartered in cities that are also mentioned in articles with a positive sentiment?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)<-[:MENTIONS]-(a:Article)
WHERE a.sentiment > 0
RETURN o.name AS Organization, c.name AS City, a.title AS ArticleTitle",Complex Aggregation Queries,companies,False,False,False,
Which organizations have a CEO who has authored articles?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)-[:AUTHORED]->(a:Article)
RETURN o.name AS Organization, p.name AS CEO, collect(a.title) AS Articles",Complex Aggregation Queries,companies,False,False,True,AUTHORED
List all organizations that have been mentioned in articles with a negative sentiment.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment < 0
RETURN o",Complex Aggregation Queries,companies,False,False,False,
Which organizations have a parent company named 'Accenture'?,"MATCH (child:Organization)-[:HAS_PARENT]->(parent:Organization {name: 'Accenture'})
RETURN child",Complex Aggregation Queries,companies,False,False,True,
What are the names of organizations that are suppliers to more than three other organizations?,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(supplier:Organization)
WITH supplier, count(o) AS numClients
WHERE numClients > 3
RETURN supplier.name",Complex Aggregation Queries,companies,True,False,False,
Who are the board members of the top 5 organizations by revenue?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN o.name AS Organization, collect(p.name) AS BoardMembers
ORDER BY o.revenue DESC
LIMIT 5",Complex Aggregation Queries,companies,False,False,True,
Which organizations have more than 500 employees and have been dissolved?,"MATCH (o:Organization)
WHERE o.nbrEmployees > 500 AND o.isDissolved = true
RETURN o",Complex Aggregation Queries,companies,False,False,False,
List the industries that have organizations with CEOs named 'Julie Spellman Sweet'.,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_CEO]->(org:Organization)
MATCH (org)-[:HAS_CATEGORY]->(ind:IndustryCategory)
RETURN ind.name AS IndustryName",Complex Aggregation Queries,companies,False,False,True,
What are the cities where organizations with the highest number of suppliers are located?,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(supplier:Organization)
WITH o, count(supplier) AS suppliersCount
ORDER BY suppliersCount DESC
LIMIT 1
MATCH (o)-[:IN_CITY]->(city:City)
RETURN city.name AS CityName",Complex Aggregation Queries,companies,False,False,False,
Which organizations are suppliers to companies in the energy sector?,"MATCH (org:Organization)-[:HAS_SUPPLIER]->(supplier:Organization)
WHERE EXISTS { 
    (org)-[:HAS_CATEGORY]->(:IndustryCategory {name: ""Energy""})
}
RETURN supplier",Complex Aggregation Queries,companies,False,True,False,
List all articles that mention organizations headquartered in the United States of America.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: ""United States of America""})
RETURN a",Complex Aggregation Queries,companies,False,False,True,
Which organizations have a CEO and also have a subsidiary?,"MATCH (o:Organization)-[:HAS_CEO]->(:Person)
WHERE exists{ (o)-[:HAS_SUBSIDIARY]->(:Organization) }
RETURN o",Complex Aggregation Queries,companies,False,False,True,
List the countries where organizations with a revenue less than $10 million are located.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE o.revenue < 10000000
RETURN DISTINCT country.name",Complex Aggregation Queries,companies,False,False,True,
What are the challenges faced by organizations headquartered in non-capital cities?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE NOT EXISTS {
  MATCH (c)-[:IS_CAPITAL_OF]->(country)
}
RETURN o.name AS Organization, c.name AS City, country.name AS Country",Complex Aggregation Queries,companies,False,False,True,IS_CAPITAL_OF
Who are the current CEOs of public organizations?,"MATCH (o:Organization {isPublic: true})-[:HAS_CEO]->(ceo:Person)
RETURN o.name AS OrganizationName, ceo.name AS CEOName",Complex Aggregation Queries,companies,False,False,True,
Which organizations have industry categories that include 'Electronic Products Manufacturers'?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Electronic Products Manufacturers""})
RETURN o",Complex Aggregation Queries,companies,False,False,False,
List the top 3 organizations with the highest sentiment score in their mentioned articles.,"MATCH (o:Organization)-[:MENTIONS]->(a:Article)
WITH o, avg(a.sentiment) AS avgSentiment
ORDER BY avgSentiment DESC
LIMIT 3
RETURN o.name AS Organization, avgSentiment",Complex Aggregation Queries,companies,False,False,True,
Which organizations have more than two competitors?,"MATCH (o:Organization)
WHERE count{(o)-[:HAS_COMPETITOR]->(:Organization)} > 2
RETURN o",Complex Aggregation Queries,companies,False,False,True,
Who are the children of persons named in the organization board member directories?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)-[:HAS_CHILD]->(child:Person)
RETURN o.name AS Organization, p.name AS BoardMember, collect(child.name) AS Children",Complex Aggregation Queries,companies,False,False,True,
List all organizations that have subsidiaries and are not dissolved.,"MATCH (o:Organization)
WHERE o.isDissolved = false AND exists{(o)-[:HAS_SUBSIDIARY]->(:Organization)}
RETURN o",Complex Aggregation Queries,companies,False,False,True,
Which countries are associated with cities that host major software companies?,"MATCH (c:City)-[:IN_COUNTRY]->(country:Country)
WHERE EXISTS {
    (c)<-[:IN_CITY]-(org:Organization)-[:HAS_CATEGORY]->(cat:IndustryCategory)
    WHERE cat.name = ""Software Companies"" AND org.isPublic = true
}
RETURN DISTINCT country.name",Complex Aggregation Queries,companies,False,False,True,
What are the summaries of articles mentioning organizations in the electronics industry?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Electronic Products Manufacturers""})
MATCH (a:Article)-[:MENTIONS]->(o)
RETURN a.summary AS ArticleSummary",Complex Aggregation Queries,companies,False,False,False,
Who are the parents of persons who are CEOs of major organizations?,"MATCH (ceo:Person)-[:HAS_CEO]->(org:Organization)
WHERE org.revenue >= 1E8
MATCH (ceo)-[:HAS_PARENT]->(parent:Person)
RETURN ceo.name AS CEOName, parent.name AS ParentName",Complex Aggregation Queries,companies,False,False,True,
Which organizations are headquartered in cities within the United States of America?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: ""United States of America""})
RETURN o.name AS OrganizationName, c.name AS CityName",Complex Aggregation Queries,companies,False,False,True,
Provide the names of the organizations that have more than three board members.,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WITH o, count(p) AS boardMembersCount
WHERE boardMembersCount > 3
RETURN o.name AS OrganizationName",Complex Aggregation Queries,companies,False,False,True,
Which countries have cities that are mentioned in articles with a positive sentiment (>0.5)?,"MATCH (c:City)-[:IN_COUNTRY]->(country:Country)
WHERE exists {
  (c)<-[:IN_CITY]-(o:Organization)<-[:MENTIONS]-(a:Article)
  WHERE a.sentiment > 0.5
}
RETURN DISTINCT country",Complex Aggregation Queries,companies,False,False,True,
List the articles that mention the organization 'New Energy Group'.,"MATCH (o:Organization {name: ""New Energy Group""})<-[:MENTIONS]-(a:Article)
RETURN a",Complex Aggregation Queries,companies,False,False,True,
What are the top 3 articles mentioning 'New Energy Group'?,"MATCH (o:Organization {name: ""New Energy Group""})<-[:MENTIONS]-(a:Article)
RETURN a
ORDER BY a.date DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
List the first 3 countries with organizations that have more than 100 employees.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE o.nbrEmployees > 100
RETURN DISTINCT country
LIMIT 3",Pathfinding Queries,companies,False,False,False,
"Which organizations have a motto related to 'security', list the top 3.","MATCH (o:Organization)
WHERE o.motto CONTAINS 'security'
RETURN o
ORDER BY o.revenue DESC
LIMIT 3",Pathfinding Queries,companies,False,False,False,
List the top 5 cities with the most organizations in the 'Healthcare' industry.,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Healthcare""})
WITH c, count(o) AS orgCount
ORDER BY orgCount DESC
LIMIT 5
RETURN c.name AS City, orgCount AS NumberOfOrganizations",Pathfinding Queries,companies,False,False,False,
Who are the top 3 parents of 'Julie Spellman Sweet'?,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_PARENT]->(parent:Person)
RETURN parent
ORDER BY parent.name
LIMIT 3",Pathfinding Queries,companies,False,False,True,
"Which organizations have more than 2 board members, list the top 3.","MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WITH o, count(p) AS boardMembersCount
WHERE boardMembersCount > 2
RETURN o
ORDER BY boardMembersCount DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
What are the top 5 articles with the highest sentiment scores mentioning organizations in 'Seattle'?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(c:City {name: ""Seattle""})
RETURN a.title, a.sentiment, a.date, a.author
ORDER BY a.sentiment DESC
LIMIT 5",Pathfinding Queries,companies,False,False,True,
List the first 3 organizations with the lowest revenue that are not dissolved.,"MATCH (o:Organization)
WHERE o.isDissolved = false AND o.revenue IS NOT NULL
RETURN o
ORDER BY o.revenue ASC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Which organizations have a CEO named 'Julie Spellman Sweet'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""})
RETURN o",Pathfinding Queries,companies,False,False,True,
List the top 5 organizations that have the most suppliers.,"MATCH (o:Organization)
RETURN o, count{(o)-[:HAS_SUPPLIER]->(:Organization)} AS supplierCount
ORDER BY supplierCount DESC
LIMIT 5",Pathfinding Queries,companies,False,False,True,
List the top 5 organizations that are public and have a revenue less than 10 million.,"MATCH (o:Organization)
WHERE o.isPublic = true AND o.revenue < 10000000
RETURN o
ORDER BY o.revenue DESC
LIMIT 5",Pathfinding Queries,companies,False,False,False,
Who are the board members of the first 3 organizations in the 'Technology' industry?,"MATCH (org:Organization)-[:HAS_CATEGORY]->(cat:IndustryCategory {name: ""Technology""})
WITH org
ORDER BY org.id
LIMIT 3
MATCH (org)-[:HAS_BOARD_MEMBER]->(person:Person)
RETURN org.name AS OrganizationName, collect(person.name) AS BoardMembers",Pathfinding Queries,companies,False,False,True,
"Which organizations have more than 3 subsidiaries, list the top 3.","MATCH (o:Organization)
WHERE count{(o)-[:HAS_SUBSIDIARY]->(:Organization)} > 3
RETURN o
ORDER BY count{(o)-[:HAS_SUBSIDIARY]->(:Organization)} DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
List the first 3 organizations that have 'Google' as a competitor.,"MATCH (o:Organization)-[:HAS_COMPETITOR]->(:Organization {name: ""Google""})
RETURN o
LIMIT 3",Pathfinding Queries,companies,False,False,True,
What are the first 3 articles mentioning organizations based in the United States?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: ""United States of America""})
RETURN a
LIMIT 3",Pathfinding Queries,companies,False,False,True,
"Which industries have more than 5 organizations associated with them, list the top 3.","MATCH (i:IndustryCategory)<-[:HAS_CATEGORY]-(o:Organization)
WITH i, count(o) AS orgCount
WHERE orgCount > 5
RETURN i.name AS Industry, orgCount
ORDER BY orgCount DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
List the top 5 CEOs of organizations with revenue greater than 50 million.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE o.revenue > 50000000
RETURN p.name AS CEO_Name, o.name AS Organization_Name, o.revenue AS Revenue
ORDER BY o.revenue DESC
LIMIT 5",Pathfinding Queries,companies,False,False,False,
Who are the top 3 suppliers of 'New Energy Group'?,"MATCH (o:Organization {name: ""New Energy Group""})<-[:HAS_SUPPLIER]-(supplier:Organization)
RETURN supplier
ORDER BY supplier.revenue DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Find the first 3 organizations that have been investors in more than 3 other organizations.,"MATCH (o:Organization)-[:HAS_INVESTOR]->(invested:Organization)
WITH o, count(invested) AS investments
WHERE investments > 3
RETURN o
LIMIT 3",Pathfinding Queries,companies,False,False,False,
What are the top 3 cities where the software companies are based?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE EXISTS { (o)-[:HAS_CATEGORY]->(:IndustryCategory {name: ""Software""}) }
RETURN c.name, count(o) AS NumberOfCompanies
ORDER BY NumberOfCompanies DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
List the first 3 organizations with the highest number of employees that are public.,"MATCH (o:Organization)
WHERE o.isPublic = true AND o.nbrEmployees IS NOT NULL
RETURN o
ORDER BY o.nbrEmployees DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Which organizations are mentioned in articles authored by 'David Correa'?,"MATCH (a:Article {author: 'David Correa'})-[:MENTIONS]->(o:Organization)
RETURN o",Pathfinding Queries,companies,False,False,True,
What are the top 5 organizations that are mentioned the most in articles with a sentiment below 0.5?,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.sentiment < 0.5
RETURN o.name, count(a) AS mentions
ORDER BY mentions DESC
LIMIT 5",Pathfinding Queries,companies,False,False,False,
"Which organizations in Rome have a 'Software' category, list the top 3.","MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: ""Software""})
WHERE EXISTS { (o)-[:IN_CITY]->(:City {name: ""Rome""}) }
RETURN o
ORDER BY o.revenue DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
List the first 3 industries that have the most organizations with a CEO named 'Julie Spellman Sweet'.,"MATCH (ceo:Person {name: ""Julie Spellman Sweet""})-[:HAS_CEO]-(org:Organization)
WITH org
MATCH (org)-[:HAS_CATEGORY]->(industry:IndustryCategory)
WITH industry, count(org) AS orgCount
ORDER BY orgCount DESC
RETURN industry.name
LIMIT 3",Pathfinding Queries,companies,False,False,True,
What are the top 5 articles with the earliest publication dates mentioning 'Accenture'?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization {name: ""Accenture""})
RETURN a.id, a.title, a.date
ORDER BY a.date ASC
LIMIT 5",Pathfinding Queries,companies,False,False,True,
Which cities host organizations with more than 100 employees?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees > 100
RETURN DISTINCT c.name",Complex Aggregation Queries,companies,False,False,True,
List all people who are board members of organizations in Houston.,"MATCH (c:City {name: ""Houston""})<-[:IN_CITY]-(o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN p",Complex Aggregation Queries,companies,False,False,True,
Which industry categories does New Energy Group belong to?,"MATCH (o:Organization {name: ""New Energy Group""})-[:HAS_CATEGORY]->(ic:IndustryCategory)
RETURN ic.name AS IndustryCategory",Complex Aggregation Queries,companies,False,False,True,
What are the top 5 organizations with the highest revenue?,"MATCH (o:Organization)
WHERE o.revenue IS NOT NULL
RETURN o
ORDER BY o.revenue DESC
LIMIT 5",Complex Aggregation Queries,companies,False,False,True,
Which organizations are suppliers to Accenture?,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(supplier:Organization {name: ""Accenture""})
RETURN o.name AS OrganizationName",Complex Aggregation Queries,companies,False,False,True,
What are the names of organizations that have 'Accenture' as an investor?,"MATCH (o:Organization)<-[:HAS_INVESTOR]-(investor:Organization {name: ""Accenture""})
RETURN o.name AS OrganizationName",Complex Aggregation Queries,companies,False,False,True,
"Which organizations have more than 1,000 employees and are not public?","MATCH (o:Organization)
WHERE o.nbrEmployees > 1000 AND o.isPublic = false
RETURN o",Complex Aggregation Queries,companies,False,False,False,
Which organizations are competitors of Deja vu Security?,"MATCH (o:Organization {name: ""Deja vu Security""})-[:HAS_COMPETITOR]->(competitor:Organization)
RETURN competitor",Complex Aggregation Queries,companies,False,False,True,
Who are the CEOs of organizations located in Seattle?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Seattle""})
MATCH (o)-[:HAS_CEO]->(p:Person)
RETURN o.name AS Organization, p.name AS CEO",Complex Aggregation Queries,companies,False,False,True,
What are the names of organizations dissolved and were public?,"MATCH (o:Organization)
WHERE o.isDissolved = true AND o.isPublic = true
RETURN o.name",Complex Aggregation Queries,companies,False,False,True,
List all organizations that have a revenue greater than $1 billion.,"MATCH (o:Organization)
WHERE o.revenue > 1000000000
RETURN o",Complex Aggregation Queries,companies,False,False,True,
Which organizations are mentioned in articles authored by David Correa?,"MATCH (a:Article {author: ""David Correa""})-[:MENTIONS]->(o:Organization)
RETURN o",Complex Aggregation Queries,companies,False,False,True,
List the first 3 organizations in 'Chicago' that have been mentioned in articles with a sentiment below 0.6.,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Chicago""})
WHERE EXISTS {
    (a:Article)-[:MENTIONS]->(o)
    WHERE a.sentiment < 0.6
}
RETURN o
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Who are the top 3 suppliers of organizations in 'New York City'?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""New York City""})
MATCH (supplier:Organization)-[:HAS_SUPPLIER]->(o)
RETURN supplier.name, count(o) AS numSupplied
ORDER BY numSupplied DESC
LIMIT 3",Pathfinding Queries,companies,False,False,False,
List the top 5 organizations that have an investor named 'Julie Spellman Sweet'.,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_INVESTOR]->(o:Organization)
RETURN o
ORDER BY o.revenue DESC
LIMIT 5",Pathfinding Queries,companies,False,False,True,
"Which organizations have a board member named 'Julie Spellman Sweet', list the top 3.","MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_BOARD_MEMBER]-(o:Organization)
RETURN o
ORDER BY o.name
LIMIT 3",Pathfinding Queries,companies,False,False,True,
List the top 3 articles mentioning organizations with a summary containing 'financial services'.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.summary CONTAINS 'financial services'
RETURN a
ORDER BY a.date DESC
LIMIT 3",Pathfinding Queries,companies,False,False,False,
What are the top 5 organizations in the 'Transportation' industry with the most revenue?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Transportation""})
WHERE o.revenue IS NOT NULL
RETURN o.name, o.revenue
ORDER BY o.revenue DESC
LIMIT 5",Pathfinding Queries,companies,False,False,True,
List the first 3 CEOs of organizations with less than 50 employees.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE o.nbrEmployees < 50
RETURN p.name AS CEO_Name, o.name AS Organization_Name
LIMIT 3",Pathfinding Queries,companies,False,False,True,
"Which organizations have 'Apple' as a competitor, list the top 3.","MATCH (o:Organization)-[:HAS_COMPETITOR]->(:Organization {name: ""Apple""})
RETURN o.name AS OrganizationName
LIMIT 3",Pathfinding Queries,companies,False,False,True,
List the top 5 cities where the electronic products manufacturers are based.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Electronic Products Manufacturers""})
MATCH (o)-[:IN_CITY]->(c:City)
RETURN c.name, count(o) AS numOrganizations
ORDER BY numOrganizations DESC
LIMIT 5",Pathfinding Queries,companies,False,False,True,
Who are the top 3 CEOs of dissolved organizations?,"MATCH (org:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE org.isDissolved = true
RETURN ceo.name AS CEO_Name, org.name AS Organization_Name
ORDER BY org.revenue DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
"Which organizations have been mentioned in articles with a sentiment greater than 0.7, list the top 3.","MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment > 0.7
RETURN o
ORDER BY a.sentiment DESC
LIMIT 3",Pathfinding Queries,companies,False,False,False,
What are the names of the children of Julie Spellman Sweet?,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_CHILD]->(child:Person)
RETURN child.name AS ChildName",Complex Aggregation Queries,companies,False,False,False,
Which organizations have CEOs that are also board members of other organizations?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE EXISTS {
  MATCH (p)-[:HAS_BOARD_MEMBER]->(:Organization)
}
RETURN o.name AS Organization, p.name AS CEO",Complex Aggregation Queries,companies,False,False,False,
"List the organizations that have subsidiaries and are headquartered in cities with more than 500,000 residents.","MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization), (o)-[:IN_CITY]->(c:City)
WHERE c.nbrResidents > 500000
RETURN o",Complex Aggregation Queries,companies,False,False,True,City.nbrResidents
Who are the investors of organizations with a revenue exceeding $500 million?,"MATCH (o:Organization)-[:HAS_INVESTOR]->(investor)
WHERE o.revenue > 500000000
RETURN o.name AS Organization, collect(investor.name) AS Investors",Complex Aggregation Queries,companies,False,False,False,
What are the names of the organizations that have a CEO named after a person with a summary mentioning 'CEO at Accenture'?,"MATCH (p:Person {summary: ""CEO at Accenture""})-[:HAS_CEO]->(org:Organization)
RETURN org.name AS OrganizationName",Verbose query,companies,False,False,True,
List the first 5 organizations that have a supplier with a revenue greater than 100 million.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(supplier:Organization)
WHERE supplier.revenue > 100000000
RETURN o
LIMIT 5",Verbose query,companies,False,False,True,
Identify the top 3 organizations with the most board members.,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WITH o, count(p) AS boardMembersCount
ORDER BY boardMembersCount DESC
LIMIT 3
RETURN o.name AS OrganizationName, boardMembersCount",Verbose query,companies,False,False,True,
Which organizations have a subsidiary in a city named 'Seattle'?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)-[:IN_CITY]->(c:City {name: 'Seattle'})
RETURN o.name AS OrganizationName, sub.name AS SubsidiaryName",Verbose query,companies,False,False,False,
List the first 5 organizations that have a CEO who is also a board member of a competitor.,"MATCH (org:Organization)-[:HAS_CEO]->(ceo:Person)-[:HAS_BOARD_MEMBER]->(:Person)-[:HAS_COMPETITOR]->(competitor:Organization)
WHERE org.id <> competitor.id
RETURN org.name AS Organization, ceo.name AS CEO
LIMIT 5",Verbose query,companies,False,False,True,
Find the top 3 cities mentioned in articles with the highest sentiment scores.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk), (a)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(city:City)
WHERE a.sentiment IS NOT NULL
RETURN city.name, avg(a.sentiment) AS averageSentiment
ORDER BY averageSentiment DESC
LIMIT 3",Verbose query,companies,False,False,True,
What are the names of the organizations that have a CEO with a summary mentioning 'Accenture'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'Accenture'
RETURN o.name",Verbose query,companies,False,False,True,
List the first 5 organizations that have a subsidiary with a summary mentioning 'Dublin'.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(s:Organization)
WHERE s.summary CONTAINS 'Dublin'
RETURN o
LIMIT 5",Verbose query,companies,False,False,True,
Identify the top 3 organizations with the most articles mentioning them.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WITH o, count(a) AS mentions
ORDER BY mentions DESC
LIMIT 3
RETURN o.name, mentions",Verbose query,companies,False,False,False,
Which organizations have a CEO with the name 'Julie Spellman Sweet' and a revenue greater than 100 million?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""})
WHERE o.revenue > 100000000
RETURN o",Verbose query,companies,False,False,True,
Find the top 3 industry categories with the most organizations.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory)
WITH ic, count(o) AS numOrganizations
ORDER BY numOrganizations DESC
LIMIT 3
RETURN ic.name AS IndustryCategory, numOrganizations",Verbose query,companies,False,False,False,
List the first 5 people who have children that are CEOs of an organization.,"MATCH (p:Person)-[:HAS_CHILD]->(child:Person)-[:HAS_CEO]->(org:Organization)
RETURN p.name AS ParentName, child.name AS ChildName, org.name AS OrganizationName
LIMIT 5",Verbose query,companies,False,False,True,
What are the names of the organizations that have a supplier with a revenue less than 5 million?,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(supplier:Organization)
WHERE supplier.revenue < 5000000
RETURN o.name AS OrganizationName",Verbose query,companies,False,False,False,
List the first 5 organizations that have a CEO who is also a board member of another organization.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE exists {
  (p)-[:HAS_BOARD_MEMBER]->(:Organization)
}
RETURN o
LIMIT 5",Verbose query,companies,False,False,True,
Identify the top 3 organizations with the most subsidiaries.,"MATCH (o:Organization)
WITH o, count{(o)-[:HAS_SUBSIDIARY]->(:Organization)} AS numSubsidiaries
ORDER BY numSubsidiaries DESC
LIMIT 3
RETURN o.name, numSubsidiaries",Verbose query,companies,False,False,True,
Which organizations are mentioned in articles with a sentiment score greater than 0.8?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment > 0.8
RETURN o",Verbose query,companies,False,False,True,
List the first 5 industry categories that have organizations with a summary mentioning 'technology'.,"MATCH (ic:IndustryCategory)<-[:HAS_CATEGORY]-(o:Organization)
WHERE o.summary CONTAINS 'technology'
RETURN ic.name
LIMIT 5",Verbose query,companies,False,False,True,
Find the top 3 articles that mention organizations based in Rome.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(c:City {name: ""Rome""})
RETURN a
ORDER BY a.date DESC
LIMIT 3",Verbose query,companies,False,False,True,
What are the names of the organizations that have a CEO with a summary mentioning 'CEO at Accenture'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'CEO at Accenture'
RETURN o.name",Verbose query,companies,False,False,True,
List the first 5 organizations with a revenue greater than 50 million that have a competitor.,"MATCH (o:Organization)-[:HAS_COMPETITOR]->(:Organization)
WHERE o.revenue > 50000000
RETURN o
LIMIT 5",Verbose query,companies,False,False,True,
Identify the top 3 organizations with the smallest number of employees that are public.,"MATCH (o:Organization)
WHERE o.isPublic = true AND o.nbrEmployees IS NOT NULL
RETURN o
ORDER BY o.nbrEmployees ASC
LIMIT 3",Verbose query,companies,False,False,True,
Which organizations have a city with a summary mentioning 'county seat' as their location?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE c.summary CONTAINS 'county seat'
RETURN o",Verbose query,companies,False,False,True,
Find the top 3 organizations that are public and have been mentioned in the most articles.,"MATCH (o:Organization)-[:MENTIONS]-(a:Article)
WHERE o.isPublic = true
RETURN o.name, count(a) AS mentions
ORDER BY mentions DESC
LIMIT 3",Verbose query,companies,False,False,True,
List the first 5 organizations that have a board member with the same name as a CEO of another organization.,"MATCH (org1:Organization)-[:HAS_BOARD_MEMBER]->(p:Person),
      (org2:Organization)-[:HAS_CEO]->(p)
RETURN org1.name AS OrganizationWithBoardMember, org2.name AS OrganizationWithCEO
LIMIT 5",Verbose query,companies,False,False,True,
Which organizations have a supplier named 'Accenture'?,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(supplier:Organization {name: 'Accenture'})
RETURN o.name AS OrganizationName",Verbose query,companies,False,False,True,
Identify the top 3 organizations with the most children as subsidiaries.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(child:Organization)
WITH o, count(child) AS numSubsidiaries
ORDER BY numSubsidiaries DESC
LIMIT 3
RETURN o.name AS OrganizationName, numSubsidiaries",Verbose query,companies,False,False,False,
Which organizations have a board member with a name mentioned in more than one article?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)-[:MENTIONED_IN]->(a:Article)
WITH p, count(DISTINCT a) AS articlesCount, collect(o) AS organizations
WHERE articlesCount > 1
RETURN p.name AS boardMemberName, organizations",Verbose query,companies,False,False,False,MENTIONED_IN
List the first 5 organizations that have a CEO with a summary mentioning 'software'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'software'
RETURN o
LIMIT 5",Verbose query,companies,False,False,False,
Find the top 3 organizations that have the most board members who are also CEOs of other organizations.,"MATCH (o:Organization)<-[:HAS_BOARD_MEMBER]-(p:Person)-[:HAS_CEO]->(otherOrg:Organization)
WITH o, COUNT(DISTINCT p) AS ceoBoardMembers
ORDER BY ceoBoardMembers DESC
LIMIT 3
RETURN o.name AS Organization, ceoBoardMembers",Verbose query,companies,False,True,False,
What are the names of the organizations that have a CEO with a name mentioned in an article with a sentiment score greater than 0.8?,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk), (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE a.sentiment > 0.8 AND c.text CONTAINS p.name
RETURN o.name",Verbose query,companies,False,False,True,
List the first 5 organizations with a subsidiary in a country named 'United States of America'.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: ""United States of America""})
RETURN o
LIMIT 5",Verbose query,companies,True,False,False,
Identify the top 3 organizations with a CEO who has authored an article.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)-[:AUTHORED]->(a:Article)
RETURN o.name AS OrganizationName, p.name AS CEOName, collect(a.title) AS Articles
ORDER BY count(a) DESC
LIMIT 3",Verbose query,companies,False,False,False,AUTHORED
Which organizations have a CEO named 'Julie Spellman Sweet' and are headquartered in 'Seattle'?,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_CEO]->(o:Organization)-[:IN_CITY]->(c:City {name: ""Seattle""})
RETURN o",Verbose query,companies,False,False,False,
List the first 5 organizations that are public and have a CEO with a summary mentioning 'Accenture'.,"MATCH (o:Organization {isPublic: true})-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'Accenture'
RETURN o
LIMIT 5",Verbose query,companies,False,False,True,
Find the top 3 organizations with the most suppliers.,"MATCH (o:Organization)
RETURN o, count{(o)-[:HAS_SUPPLIER]->(:Organization)} AS supplierCount
ORDER BY supplierCount DESC
LIMIT 3",Verbose query,companies,False,False,True,
What are the names of the organizations that have a subsidiary with a revenue greater than 50 million?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(s:Organization)
WHERE s.revenue > 50000000
RETURN o.name AS OrganizationName",Verbose query,companies,False,False,True,
List the first 5 organizations that have a summary mentioning 'software company'.,"MATCH (o:Organization)
WHERE o.summary CONTAINS 'software company'
RETURN o
LIMIT 5",Verbose query,companies,False,False,True,
Identify the top 3 organizations with a CEO who has a summary mentioning 'Accenture'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'Accenture'
RETURN o
ORDER BY o.revenue DESC
LIMIT 3",Verbose query,companies,False,False,False,
Which organizations have a board member who has authored an article?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)-[:AUTHORED]->(a:Article)
RETURN o.name AS OrganizationName, p.name AS BoardMemberName, a.title AS ArticleTitle",Verbose query,companies,False,False,True,AUTHORED
List the first 5 organizations that have a revenue greater than 10 million and are headquartered in a city named 'Seattle'.,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Seattle""})
WHERE o.revenue > 10000000
RETURN o
LIMIT 5",Verbose query,companies,False,False,True,
Find the top 3 articles with the lowest sentiment scores mentioning organizations based in Chicago.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(c:City {name: ""Chicago""})
RETURN a.title, a.sentiment, a.date
ORDER BY a.sentiment ASC
LIMIT 3",Verbose query,companies,False,False,True,
What are the names of the organizations that are competitors and have a CEO named 'Julie Spellman Sweet'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
MATCH (o)-[:HAS_COMPETITOR]->(competitor:Organization)
RETURN competitor.name",Verbose query,companies,False,False,False,
List the first 5 organizations that have an investor with a name mentioned in at least two different articles.,"MATCH (o:Organization)<-[:HAS_INVESTOR]-(p:Person)-[:MENTIONED_IN]->(a:Article)
WITH o, p, count(DISTINCT a) AS articlesCount
WHERE articlesCount >= 2
RETURN o
LIMIT 5",Verbose query,companies,False,False,True,MENTIONED_IN
Identify the top 3 organizations with the most competitors.,"MATCH (o:Organization)
WITH o, count{(o)-[:HAS_COMPETITOR]->(:Organization)} AS competitors
ORDER BY competitors DESC
LIMIT 3
RETURN o.name, competitors",Verbose query,companies,False,False,False,
Which organizations have a CEO with a name mentioned in more than one article?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE EXISTS {
  MATCH (p)-[:MENTIONED_IN]->(a:Article)
  WITH p, count(DISTINCT a) AS articlesCount
  WHERE articlesCount > 1
  RETURN p
}
RETURN o",Verbose query,companies,False,False,False,MENTIONED_IN
List the first 5 organizations with a motto mentioning 'security' and more than 500 employees.,"MATCH (o:Organization)
WHERE o.motto CONTAINS 'security' AND o.nbrEmployees > 500
RETURN o
LIMIT 5",Verbose query,companies,False,False,True,
Find the top 3 countries with the most cities mentioned in the schema.,"MATCH (c:City)-[:IN_COUNTRY]->(country:Country)
WITH country, count(c) AS citiesCount
ORDER BY citiesCount DESC
LIMIT 3
RETURN country.name AS Country, citiesCount",Verbose query,companies,False,False,False,
What are the names of the organizations that have a board member named 'Julie Spellman Sweet'?,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_BOARD_MEMBER]->(o:Organization)
RETURN o.name AS OrganizationName",Verbose query,companies,False,False,False,
List the first 5 organizations that have a CEO who has authored more than one article.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)-[:AUTHORED]->(a:Article)
WITH o, p, count(a) AS articlesCount
WHERE articlesCount > 1
RETURN o
LIMIT 5",Verbose query,companies,False,False,False,AUTHORED
List the first 5 organizations that have a CEO who has authored an article.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)-[:AUTHORED]->(a:Article)
RETURN o.name AS Organization, p.name AS CEO, a.title AS ArticleTitle
LIMIT 5",Verbose query,companies,True,False,False,AUTHORED
Find the top 3 countries mentioned in articles that have the lowest sentiment scores.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WITH country, a.sentiment AS sentiment
ORDER BY sentiment ASC
RETURN country.name AS Country, collect(a.title)[..3] AS Top_3_Lowest_Sentiment_Articles
LIMIT 3",Verbose query,companies,False,False,True,
What are the names of the organizations that have a subsidiary named 'Accenture'?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(s:Organization {name: 'Accenture'})
RETURN o.name",Verbose query,companies,False,False,True,
List the first 5 organizations with the most number of employees that have a subsidiary.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization)
WHERE o.nbrEmployees IS NOT NULL
RETURN o
ORDER BY o.nbrEmployees DESC
LIMIT 5",Verbose query,companies,False,False,True,
Which organizations have the most articles mentioning them in 2022?,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.date.year = 2022
RETURN o.name, count(a) AS mentions
ORDER BY mentions DESC",Complex Aggregation Queries,companies,False,False,True,
Who are the parents of the board members of organizations with revenues over $1 million?,"MATCH (o:Organization) WHERE o.revenue > 1000000
MATCH (o)-[:HAS_BOARD_MEMBER]->(bm:Person)
MATCH (bm)-[:HAS_PARENT]->(p:Person)
RETURN bm.name AS BoardMember, p.name AS Parent",Complex Aggregation Queries,companies,False,False,True,
"List the articles mentioning organizations with revenues under $500,000.","MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.revenue < 500000
RETURN a",Complex Aggregation Queries,companies,False,False,True,
Which organizations have a city location with a summary mentioning 'county seat'?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE c.summary CONTAINS 'county seat'
RETURN o",Complex Aggregation Queries,companies,False,False,False,
What are the names of organizations that are suppliers to those in the telecommunications industry?,"MATCH (org:Organization)-[:HAS_SUPPLIER]->(supplier:Organization)
WHERE EXISTS { (org)-[:HAS_CATEGORY]->(:IndustryCategory {name: ""Telecommunications""}) }
RETURN supplier.name",Complex Aggregation Queries,companies,False,False,False,
List the organizations that have a CEO with the name 'David Correa'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: ""David Correa""})
RETURN o",Complex Aggregation Queries,companies,False,False,True,
Who are the CEOs of organizations that have been dissolved but mentioned in recent articles?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE o.isDissolved = true AND EXISTS {
  (o)<-[:MENTIONS]-(a:Article)
}
RETURN p.name AS CEO_Name, o.name AS Organization_Name",Complex Aggregation Queries,companies,False,False,True,
List the organizations that have more than five categories listed in their industry classification.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory)
WITH o, count(c) AS numCategories
WHERE numCategories > 5
RETURN o",Complex Aggregation Queries,companies,False,False,True,
Which organizations are mentioned in articles with titles containing the word 'security'?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.title CONTAINS 'security'
RETURN o",Complex Aggregation Queries,companies,False,False,True,
What are the countries where organizations with a public status are headquartered?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE o.isPublic = true
RETURN DISTINCT country.name",Complex Aggregation Queries,companies,False,False,False,
Which organizations have a summary that mentions 'consumer behavior'?,"MATCH (o:Organization)
WHERE o.summary CONTAINS 'consumer behavior'
RETURN o",Complex Aggregation Queries,companies,False,False,True,
List the organizations that have been mentioned in articles with a sentiment score of exactly 0.5.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment = 0.5
RETURN o",Complex Aggregation Queries,companies,False,False,True,
Who are the parents of CEOs of organizations that are public?,"MATCH (org:Organization {isPublic: true})-[:HAS_CEO]->(ceo:Person)
MATCH (ceo)-[:HAS_PARENT]->(parent:Person)
RETURN org.name AS Organization, ceo.name AS CEO, parent.name AS Parent",Complex Aggregation Queries,companies,False,False,False,
Which organizations have a board member named 'Julie Spellman Sweet'?,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_BOARD_MEMBER]->(o:Organization)
RETURN o",Complex Aggregation Queries,companies,False,False,True,
What are the names of organizations that have been dissolved but still have a CEO listed?,"MATCH (o:Organization)-[:HAS_CEO]->(:Person)
WHERE o.isDissolved = true
RETURN o.name",Complex Aggregation Queries,companies,False,False,True,
Which organizations have subsidiaries in more than three different countries?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WITH o, count(DISTINCT country) AS countriesCount
WHERE countriesCount > 3
RETURN o.name AS Organization, countriesCount",Complex Aggregation Queries,companies,False,False,True,
List the cities where organizations with more than 500 employees are headquartered.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees > 500
RETURN DISTINCT c.name",Complex Aggregation Queries,companies,False,False,True,
Who are the children of CEOs of organizations with a revenue over $1 billion?,"MATCH (org:Organization)-[:HAS_CEO]->(ceo:Person)-[:HAS_CHILD]->(child:Person)
WHERE org.revenue > 1E9
RETURN ceo.name AS CEOName, child.name AS ChildName",Complex Aggregation Queries,companies,False,False,True,
Which organizations are headquartered in cities named 'Rome' across different countries?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: 'Rome'})
RETURN o.name AS OrganizationName, o.id AS OrganizationID",Complex Aggregation Queries,companies,False,False,True,
What are the names of organizations that have a motto mentioning 'innovation'?,"MATCH (o:Organization)
WHERE o.motto CONTAINS 'innovation'
RETURN o.name",Complex Aggregation Queries,companies,False,True,False,
List articles that mention organizations based in countries not in North America.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE NOT country.name IN ['United States of America', 'Canada', 'Mexico']
RETURN a",Complex Aggregation Queries,companies,False,False,True,
Which organizations have more than one industry category?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory)
WITH o, count(ic) AS numCategories
WHERE numCategories > 1
RETURN o",Complex Aggregation Queries,companies,False,False,True,
What are the names of the top 3 organizations in terms of revenue in the electronics industry?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: ""Electronic Products Manufacturers""})
WHERE o.revenue IS NOT NULL
RETURN o.name AS OrganizationName, o.revenue AS Revenue
ORDER BY o.revenue DESC
LIMIT 3",Complex Aggregation Queries,companies,False,False,True,
List all organizations that have a CEO and more than 10 suppliers.,"MATCH (o:Organization)-[:HAS_CEO]->(:Person)
WHERE count{(o)-[:HAS_SUPPLIER]->(:Organization)} > 10
RETURN o",Complex Aggregation Queries,companies,False,False,True,
List the top 5 countries by number of cities mentioned in the database.,"MATCH (c:City)-[:IN_COUNTRY]->(country:Country)
WITH country, count(c) AS citiesCount
ORDER BY citiesCount DESC
LIMIT 5
RETURN country.name AS Country, citiesCount",Pathfinding Queries,companies,True,False,False,
Who are the investors of organizations mentioned in articles with a positive sentiment?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)<-[:HAS_INVESTOR]-(investor)
WHERE a.sentiment > 0
RETURN o.name AS Organization, collector(investor.name) AS Investors",Complex Aggregation Queries,companies,False,False,False,
"List the first 5 organizations that have been mentioned in articles published after January 1st, 2020.","MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.date >= date('2020-01-01')
RETURN o
LIMIT 5",Verbose query,companies,False,False,True,
Identify the top 3 organizations that have been dissolved but still have a CEO listed.,"MATCH (o:Organization {isDissolved: true})-[:HAS_CEO]->(p:Person)
RETURN o.name AS OrganizationName, p.name AS CEOName
ORDER BY o.revenue DESC
LIMIT 3",Verbose query,companies,False,False,True,
Which organizations have a summary mentioning 'software' and are public companies?,"MATCH (o:Organization)
WHERE o.summary CONTAINS 'software' AND o.isPublic = true
RETURN o",Verbose query,companies,False,False,False,
List the first 5 people who are investors in more than one organization.,"MATCH (p:Person)-[:HAS_INVESTOR]->(o:Organization)
WITH p, count(o) AS numOrgs
WHERE numOrgs > 1
RETURN p
LIMIT 5",Verbose query,companies,False,False,True,
Find the top 3 articles with the highest sentiment scores mentioning organizations with over 1000 employees.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.nbrEmployees > 1000
RETURN a.title, a.sentiment, a.date
ORDER BY a.sentiment DESC
LIMIT 3",Verbose query,companies,False,False,True,
What are the names of the organizations that have an industry category named 'Electronic Products Manufacturers'?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: 'Electronic Products Manufacturers'})
RETURN o.name",Verbose query,companies,False,False,True,
Which organizations are headquartered in a city that is not the capital of its country?,"MATCH (org:Organization)-[:IN_CITY]->(city:City)-[:IN_COUNTRY]->(country:Country)
WHERE NOT EXISTS {
  MATCH (capital:City)-[:IS_CAPITAL_OF]->(country)
  WHERE capital.name = city.name
}
RETURN org",Verbose query,companies,False,False,False,IS_CAPITAL_OF
List the first 5 organizations that have a motto including the word 'security'.,"MATCH (o:Organization)
WHERE o.motto CONTAINS 'security'
RETURN o
LIMIT 5",Verbose query,companies,False,False,True,
Identify the top 3 cities where organizations with a revenue less than 10 million are located.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.revenue < 10000000
RETURN c.name, count(o) AS numOrganizations
ORDER BY numOrganizations DESC
LIMIT 3",Verbose query,companies,False,False,False,
What are the names of the people who are board members of at least two different organizations?,"MATCH (p:Person)-[:HAS_BOARD_MEMBER]->(o:Organization)
WITH p, count(DISTINCT o) AS orgCount
WHERE orgCount >= 2
RETURN p.name AS BoardMemberNames",Verbose query,companies,False,False,True,
List the first 3 organizations with the highest revenue that are also dissolved.,"MATCH (o:Organization)
WHERE o.isDissolved = true AND o.revenue IS NOT NULL
RETURN o
ORDER BY o.revenue DESC
LIMIT 3",Verbose query,companies,False,False,False,
Which organizations have a board member who is also a CEO of another organization?,"MATCH (org:Organization)-[:HAS_BOARD_MEMBER]->(person:Person)
WHERE exists {
    (person)-[:HAS_CEO]->(:Organization)
}
RETURN org",Verbose query,companies,False,False,True,
Identify the first 5 articles that mention organizations headquartered in the United States of America.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: ""United States of America""})
RETURN a
LIMIT 5",Verbose query,companies,False,False,True,
What are the names of the organizations that are headquartered in cities with a summary stating they are a county seat?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE c.summary CONTAINS 'county seat'
RETURN o.name",Verbose query,companies,False,False,False,
Find the top 3 organizations that have been invested in by more than one person.,"MATCH (o:Organization)<-[:HAS_INVESTOR]-(p:Person)
WITH o, count(DISTINCT p) AS investorCount
WHERE investorCount > 1
RETURN o
ORDER BY investorCount DESC
LIMIT 3",Verbose query,companies,False,False,True,
Which organizations have a CEO named 'Julie Spellman Sweet'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""})
RETURN o",Verbose query,companies,False,False,True,
List the first 5 organizations that are competitors and are both public companies.,"MATCH (o1:Organization)-[:HAS_COMPETITOR]->(o2:Organization)
WHERE o1.isPublic = true AND o2.isPublic = true
RETURN o1, o2
LIMIT 5",Verbose query,companies,False,False,True,
Identify the top 3 organizations that have the highest number of suppliers.,"MATCH (o:Organization)
WITH o, count{(o)-[:HAS_SUPPLIER]->(:Organization)} AS supplierCount
ORDER BY supplierCount DESC
LIMIT 3
RETURN o.name, supplierCount",Verbose query,companies,False,False,True,
What are the names of the people who have both a parent and a child listed in the schema?,"MATCH (p:Person)
WHERE exists{(p)-[:HAS_PARENT]->(:Person)} AND exists{(p)-[:HAS_CHILD]->(:Person)}
RETURN p.name",Verbose query,companies,False,False,True,
List the first 3 countries that are home to more than one city mentioned in the schema.,"MATCH (c:City)-[:IN_COUNTRY]->(country:Country)
WITH country, count(c) AS cityCount
WHERE cityCount > 1
RETURN country
LIMIT 3",Verbose query,companies,False,False,True,
Which organizations have a subsidiary with fewer than 50 employees?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(s:Organization)
WHERE s.nbrEmployees < 50
RETURN o.name AS Organization, s.name AS Subsidiary, s.nbrEmployees AS Employees",Verbose query,companies,False,False,False,
Identify the first 5 people who are CEOs of public companies.,"MATCH (p:Person)-[:HAS_CEO]->(o:Organization)
WHERE o.isPublic = true
RETURN p
LIMIT 5",Verbose query,companies,False,False,True,
What are the names of the industry categories that have at least three organizations associated with them?,"MATCH (i:IndustryCategory)<-[:HAS_CATEGORY]-(o:Organization)
WITH i, count(o) AS orgCount
WHERE orgCount >= 3
RETURN i.name AS IndustryCategoryName",Verbose query,companies,False,False,True,
Find the top 3 cities where organizations with more than 500 employees are located.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees > 500
RETURN c.name, count(o) AS numberOfOrganizations
ORDER BY numberOfOrganizations DESC
LIMIT 3",Verbose query,companies,False,False,True,
Which organizations have a revenue greater than 100 million and are not dissolved?,"MATCH (o:Organization)
WHERE o.revenue > 100000000 AND o.isDissolved = false
RETURN o",Verbose query,companies,False,False,False,
Who are the board members of 'New Energy Group'?,"MATCH (o:Organization {name: ""New Energy Group""})-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN p.name AS BoardMemberName",Simple Retrieval Queries,companies,False,False,False,
What are the first 3 industries mentioned in articles with a positive sentiment over 0.8?,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)-[:MENTIONS]->(o:Organization)-[:HAS_CATEGORY]->(i:IndustryCategory)
WHERE a.sentiment > 0.8
RETURN DISTINCT i.name
LIMIT 3",Pathfinding Queries,companies,False,False,False,
"Who are the children of 'Julie Spellman Sweet', list the first 3.","MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_CHILD]->(child:Person)
RETURN child
LIMIT 3",Pathfinding Queries,companies,False,False,True,
What are the first 3 organizations that have a category and a CEO named 'Julie Spellman Sweet'?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(:IndustryCategory), (o)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
RETURN o
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
List the first 5 organizations that have a CEO with a summary mentioning 'Leader'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'Leader'
RETURN o
LIMIT 5",Simple Retrieval Queries,companies,False,False,False,
Which organizations have a CEO who was mentioned in an article on 'RCR Wireless News'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)<-[:MENTIONS]-(a:Article)
WHERE a.siteName = 'RCR Wireless News'
RETURN o",Simple Retrieval Queries,companies,False,False,True,
List the first 3 organizations that have a competitor and a supplier in the same city.,"MATCH (o:Organization)-[:HAS_COMPETITOR]->(competitor:Organization)-[:IN_CITY]->(city:City),
      (o)-[:HAS_SUPPLIER]->(supplier:Organization)-[:IN_CITY]->(city)
RETURN o.name AS Organization, city.name AS City
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Name the first 3 organizations that have a CEO with a name containing 'Julie'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.name CONTAINS 'Julie'
RETURN o
LIMIT 3",Simple Retrieval Queries,companies,False,False,False,
Which organizations have been mentioned in articles authored by women?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.author IN ['female author names list']
RETURN o",Simple Retrieval Queries,companies,False,False,True,
What are the first 3 organizations with a CEO whose name ends with 'Sweet'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.name ENDS WITH 'Sweet'
RETURN o
LIMIT 3",Simple Retrieval Queries,companies,False,False,False,
List the first 5 organizations that have a category named 'Technology'.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: ""Technology""})
RETURN o
LIMIT 5",Simple Retrieval Queries,companies,False,False,True,
Which organizations have a CEO and are headquartered in a country other than the USA?,"MATCH (org:Organization)-[:HAS_CEO]->(:Person), (org)-[:IN_CITY]->(city:City)-[:IN_COUNTRY]->(country:Country)
WHERE country.name <> ""United States of America""
RETURN org",Simple Retrieval Queries,companies,False,False,True,
What are the first 3 organizations with a CEO who has a summary mentioning 'Technology'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'Technology'
RETURN o
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Which organizations are mentioned in articles authored by 'David Correa'?,"MATCH (a:Article {author: 'David Correa'})-[:MENTIONS]->(o:Organization)
RETURN o",Complex Retrieval Queries,companies,False,False,False,
List the names of the first 3 organizations that have both a CEO and a board member named in their summary.,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person), (o)-[:HAS_BOARD_MEMBER]->(bm:Person)
WHERE o.summary CONTAINS ceo.name AND o.summary CONTAINS bm.name
RETURN o.name
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Which organization in Seattle has the most employees?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Seattle""})
RETURN o.name AS Organization, o.nbrEmployees AS Employees
ORDER BY o.nbrEmployees DESC
LIMIT 1",Simple Retrieval Queries,companies,False,False,True,
What are the first 3 articles mentioning an organization with more than 1000 employees?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.nbrEmployees > 1000
RETURN a
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
List the first 5 organizations that have more than one category.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory)
WITH o, count(c) AS numCategories
WHERE numCategories > 1
RETURN o
LIMIT 5",Simple Retrieval Queries,companies,False,False,False,
Name the first 3 organizations that have a CEO and a board member with different nationalities.,"MATCH (org:Organization)-[:HAS_CEO]->(ceo:Person)-[:BORN_IN]->(ceoCountry:Country),
      (org)-[:HAS_BOARD_MEMBER]->(boardMember:Person)-[:BORN_IN]->(boardMemberCountry:Country)
WHERE ceoCountry.name <> boardMemberCountry.name
RETURN org.name AS Organization, ceo.name AS CEO, ceoCountry.name AS CEO_Country, boardMember.name AS Board_Member, boardMemberCountry.name AS Board_Member_Country
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,BORN_IN
Which organizations have been mentioned in articles with a sentiment score lower than 0.5?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment < 0.5
RETURN o",Simple Retrieval Queries,companies,False,False,True,
Who are the investors of the first 3 organizations with a revenue above 50 million?,"MATCH (o:Organization)
WHERE o.revenue > 50000000
WITH o
ORDER BY o.revenue DESC
LIMIT 3
MATCH (o)<-[:HAS_INVESTOR]-(investor)
RETURN o.name AS Organization, collect(investor.name) AS Investors",Simple Retrieval Queries,companies,False,False,False,
What are the first 3 organizations with a CEO who has written an article?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)-[:AUTHORED]->(a:Article)
RETURN o
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,AUTHORED
List the first 5 organizations that have a supplier and are public companies.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(:Organization)
WHERE o.isPublic = true
RETURN o
LIMIT 5",Simple Retrieval Queries,companies,False,False,True,
Which organizations have a category and are located in a city with a name containing 'Rome'?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(:IndustryCategory), (o)-[:IN_CITY]->(c:City)
WHERE c.name CONTAINS 'Rome'
RETURN o",Simple Retrieval Queries,companies,False,False,True,
What are the names of the first 3 organizations that have a CEO with a name starting with 'J'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.name STARTS WITH 'J'
RETURN o.name
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Name the first 3 CEOs of organizations that are headquartered in a city starting with 'S'.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE c.name STARTS WITH 'S'
MATCH (o)-[:HAS_CEO]->(ceo:Person)
RETURN o.name AS Organization, ceo.name AS CEO
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
List the top 5 organizations that have more than 100 employees and are not dissolved.,"MATCH (o:Organization)
WHERE o.nbrEmployees > 100 AND o.isDissolved = false
RETURN o
ORDER BY o.nbrEmployees DESC
LIMIT 5",Complex Retrieval Queries,companies,False,False,True,
What are the names of the organizations that have a public status and revenue greater than 100000000?,"MATCH (o:Organization)
WHERE o.isPublic = true AND o.revenue > 100000000
RETURN o.name",Complex Retrieval Queries,companies,False,False,False,
Name 3 organizations that are suppliers to 'New Energy Group'.,"MATCH (o:Organization {name: ""New Energy Group""})<-[:HAS_SUPPLIER]-(supplier:Organization)
RETURN supplier.name
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
List the CEOs of organizations that have a category in 'Electronic Products Manufacturers'.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Electronic Products Manufacturers""})
MATCH (o)-[:HAS_CEO]->(ceo:Person)
RETURN o.name AS Organization, ceo.name AS CEO",Complex Retrieval Queries,companies,False,False,True,
Identify the organizations that have more than one subsidiary.,"MATCH (o:Organization)
WHERE count{(o)-[:HAS_SUBSIDIARY]->(:Organization)} > 1
RETURN o",Complex Retrieval Queries,companies,False,False,True,
Which articles mention organizations that have been dissolved?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.isDissolved = true
RETURN a",Complex Retrieval Queries,companies,False,False,True,
Name the children and parents of persons who are CEOs of organizations with more than 50 employees.,"MATCH (org:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE org.nbrEmployees > 50
MATCH (ceo)-[:HAS_CHILD]->(child:Person), (ceo)-[:HAS_PARENT]->(parent:Person)
RETURN ceo.name AS CEOName, collect(child.name) AS Children, collect(parent.name) AS Parents",Complex Retrieval Queries,companies,False,False,True,
Which cities have organizations with a public status?,"MATCH (o:Organization {isPublic: true})-[:IN_CITY]->(c:City)
RETURN DISTINCT c.name",Complex Retrieval Queries,companies,False,False,True,
List the organizations that have a category named 'Electronic Products Manufacturers'.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: ""Electronic Products Manufacturers""})
RETURN o",Complex Retrieval Queries,companies,False,False,False,
Who are the investors in 'New Energy Group'?,"MATCH (o:Organization {name: ""New Energy Group""})<-[:HAS_INVESTOR]-(investor)
RETURN investor",Complex Retrieval Queries,companies,False,False,True,
Which organizations are located in cities within 'United States of America'?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: 'United States of America'})
RETURN o.name AS OrganizationName, c.name AS CityName",Complex Retrieval Queries,companies,False,False,True,
What are the top 3 latest articles mentioning any organization?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
RETURN a
ORDER BY a.date DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,False,
Name 3 people who are board members for organizations with a motto.,"MATCH (p:Person)-[:HAS_BOARD_MEMBER]->(o:Organization)
WHERE o.motto IS NOT NULL
RETURN p.name
LIMIT 3",Complex Retrieval Queries,companies,False,False,False,
Which organizations have an investor named 'Accenture'?,"MATCH (o:Organization)<-[:HAS_INVESTOR]-(p:Person {name: 'Accenture'})
RETURN o",Complex Retrieval Queries,companies,False,False,True,
Identify articles mentioning organizations based in 'Rome'.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(c:City {name: 'Rome'})
RETURN a",Complex Retrieval Queries,companies,False,False,True,
List the countries where organizations with a revenue of over 50000000 are located.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE o.revenue > 50000000
RETURN DISTINCT country.name",Complex Retrieval Queries,companies,False,False,False,
What are the names of the parents of people who work in organizations with more than 400 employees?,"MATCH (p:Person)-[:WORKS_FOR]->(o:Organization)
WHERE o.nbrEmployees > 400
MATCH (p)-[:HAS_PARENT]->(parent:Person)
RETURN parent.name AS ParentName",Complex Retrieval Queries,companies,False,False,False,WORKS_FOR
Who are the children of 'Julie Spellman Sweet' listed in the database?,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_CHILD]->(child:Person)
RETURN child",Complex Retrieval Queries,companies,False,False,True,
Which organizations have a summary mentioning 'software' and are located in a city with a population summary mentioning 'capital'?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.summary CONTAINS 'software' AND c.summary CONTAINS 'capital'
RETURN o",Complex Retrieval Queries,companies,False,False,True,
Who are the board members of organizations with revenue over 50000000?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WHERE o.revenue > 50000000
RETURN o.name AS Organization, p.name AS BoardMember",Complex Retrieval Queries,companies,False,False,False,
Which organizations are competitors of 'Deis'?,"MATCH (o:Organization {name: ""Deis""})-[:HAS_COMPETITOR]->(competitor:Organization)
RETURN competitor",Complex Retrieval Queries,companies,False,False,True,
List the industry categories for organizations located in 'Seattle'.,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Seattle""})
MATCH (o)-[:HAS_CATEGORY]->(ic:IndustryCategory)
RETURN ic.name AS IndustryCategory",Complex Retrieval Queries,companies,False,False,True,
Which organizations have 'Julie Spellman Sweet' as a CEO?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""})
RETURN o",Complex Retrieval Queries,companies,False,False,True,
What are the names of the organizations that are subsidiaries of 'Accenture'?,"MATCH (parent:Organization {name: ""Accenture""})-[:HAS_SUBSIDIARY]->(subsidiary:Organization)
RETURN subsidiary.name AS SubsidiaryName",Complex Retrieval Queries,companies,False,False,True,
Identify the top 5 articles with a positive sentiment greater than 0.8.,"MATCH (a:Article)
WHERE a.sentiment > 0.8
RETURN a
ORDER BY a.sentiment DESC
LIMIT 5",Complex Retrieval Queries,companies,False,False,True,
Which cities are home to organizations with more than 300 employees?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees > 300
RETURN DISTINCT c.name",Complex Retrieval Queries,companies,False,False,False,
List the first 3 organizations that have been competitors for more than 5 years.,"MATCH (o:Organization)-[r:HAS_COMPETITOR]->(:Organization)
WHERE r.since IS NOT NULL AND date() - r.since >= duration({years: 5})
RETURN o
LIMIT 3",Simple Retrieval Queries,companies,False,False,False,HAS_COMPETITOR.since
Which organization has the highest number of employees and is located in a capital city?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE EXISTS {
  MATCH (c)-[:IS_CAPITAL_OF]->(:Country)
}
RETURN o
ORDER BY o.nbrEmployees DESC
LIMIT 1",Complex Retrieval Queries,companies,True,False,False,IS_CAPITAL_OF
Which organizations have a CEO named within the first 5 chunks of an article?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person), (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE p.name IN [c1.text, c2.text, c3.text, c4.text, c5.text]
WITH a, COLLECT(c) AS chunks
WHERE chunks[0].text IS NOT NULL AND chunks[1].text IS NOT NULL AND chunks[2].text IS NOT NULL AND chunks[3].text IS NOT NULL AND chunks[4].text IS NOT NULL
WITH chunks[0] AS c1, chunks[1] AS c2, chunks[2] AS c3, chunks[3] AS c4, chunks[4] AS c5, o
RETURN o",Simple Retrieval Queries,companies,False,False,True,
Who are the CEOs of the first 3 organizations that have a category 'Electronic Products Manufacturers'?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Electronic Products Manufacturers""})
WITH o
ORDER BY o.id
LIMIT 3
MATCH (o)-[:HAS_CEO]->(p:Person)
RETURN o.name AS OrganizationName, p.name AS CEOName",Simple Retrieval Queries,companies,False,False,True,
List the first 5 organizations that have a CEO named 'Julie Spellman Sweet'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""})
RETURN o
LIMIT 5",Simple Retrieval Queries,companies,False,False,False,
What are the first 3 organizations mentioned in the article titled 'Funds for Consumer Behavior Specialist Infinite An'?,"MATCH (a:Article {title: 'Funds for Consumer Behavior Specialist Infinite An'})-[:MENTIONS]->(o:Organization)
RETURN o
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Which person has the ID 'Eaf0bpz6NNoqLVUCqNZPAew'?,"MATCH (p:Person {id: 'Eaf0bpz6NNoqLVUCqNZPAew'})
RETURN p",Simple Retrieval Queries,companies,False,False,False,
Provide the names and IDs of the first 3 persons who are CEOs of public companies.,"MATCH (p:Person)-[:HAS_CEO]->(o:Organization)
WHERE o.isPublic = true
RETURN p.name, p.id
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
What are the summaries of the first 3 cities in the database?,"MATCH (c:City)
RETURN c.name, c.summary
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Which organizations have a motto?,"MATCH (o:Organization)
WHERE o.motto IS NOT NULL
RETURN o",Simple Retrieval Queries,companies,False,False,True,
What are the top 5 highest revenue organizations in the database?,"MATCH (o:Organization)
WHERE o.revenue IS NOT NULL
RETURN o
ORDER BY o.revenue DESC
LIMIT 5",Simple Retrieval Queries,companies,False,False,True,
What is the summary of the person with ID 'Eaf0bpz6NNoqLVUCqNZPAew'?,"MATCH (p:Person {id: 'Eaf0bpz6NNoqLVUCqNZPAew'})
RETURN p.summary",Simple Retrieval Queries,companies,False,False,False,
Who are the first 3 parents of 'Julie Spellman Sweet'?,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_PARENT*1..3]->(ancestor:Person)
RETURN ancestor
LIMIT 3",Simple Retrieval Queries,companies,False,False,False,
What are the first 3 children of the person named 'Julie Spellman Sweet'?,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_CHILD]->(child:Person)
RETURN child
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Which organizations have subsidiaries within the same city?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(s:Organization)-[:IN_CITY]->(c:City)
WHERE EXISTS { (o)-[:IN_CITY]->(c) }
RETURN o.name AS ParentOrganization, s.name AS Subsidiary, c.name AS City",Simple Retrieval Queries,companies,False,False,True,
Which organizations are involved in the industry category 'Electronic Products Manufacturers'?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Electronic Products Manufacturers""})
RETURN o",Simple Retrieval Queries,companies,False,False,True,
What are the first 3 articles that have a sentiment score above 0.5?,"MATCH (a:Article)
WHERE a.sentiment > 0.5
RETURN a
ORDER BY a.date DESC
LIMIT 3",Simple Retrieval Queries,companies,False,False,False,
Which organizations are competitors of 'Deja vu Security'?,"MATCH (o:Organization {name: ""Deja vu Security""})-[:HAS_COMPETITOR]->(competitor:Organization)
RETURN competitor",Simple Retrieval Queries,companies,False,False,False,
Who are the investors of the first 3 organizations in the list?,"MATCH (o:Organization)
WITH o
ORDER BY o.id
LIMIT 3
MATCH (o)<-[:HAS_INVESTOR]-(investor)
RETURN o.name AS Organization, collect(investor.name) AS Investors",Simple Retrieval Queries,companies,False,False,True,
Can you provide the names of top 5 articles published before 2020?,"MATCH (a:Article)
WHERE a.date < datetime('2020-01-01T00:00:00Z')
RETURN a.title
ORDER BY a.date DESC
LIMIT 5",Simple Retrieval Queries,companies,False,False,True,
What are the first 3 industry categories for organizations in Rome?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Rome""})
MATCH (o)-[:HAS_CATEGORY]->(ic:IndustryCategory)
RETURN ic.name
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
List the first 5 cities that have organizations with more than 300 employees.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees > 300
RETURN c.name AS CityName
LIMIT 5",Simple Retrieval Queries,companies,False,False,False,
Which organizations does 'New Energy Group' supply?,"MATCH (o:Organization {name: ""New Energy Group""})-[:HAS_SUPPLIER]->(supplied:Organization)
RETURN supplied",Simple Retrieval Queries,companies,False,False,True,
What are the names of the first 3 subsidiaries of 'Accenture'?,"MATCH (o:Organization {name: ""Accenture""})-[:HAS_SUBSIDIARY]->(sub:Organization)
RETURN sub.name
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
List the first 3 parent companies of 'Accenture'.,"MATCH path=(o:Organization {name: ""Accenture""})-[:HAS_SUBSIDIARY*1..3]->(parent:Organization)
RETURN parent.name AS ParentCompanyName
LIMIT 3",Simple Retrieval Queries,companies,False,False,False,
What are the sentiment scores of the first 3 articles mentioning 'Deja vu Security'?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization {name: ""Deja Vu Security""})
RETURN a.sentiment
ORDER BY a.date DESC
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
List the first 3 countries mentioned in the database.,"MATCH (c:Country)
RETURN c.name
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Name the first 3 organizations that have been mentioned in an article from 'MrWeb'.,"MATCH (a:Article {siteName: ""MrWeb""})-[:MENTIONS]->(o:Organization)
RETURN o.name AS OrganizationName
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
What are the names of the first 3 CEOs who work at organizations with a revenue greater than 10 million?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE o.revenue > 10000000
RETURN p.name
LIMIT 3",Simple Retrieval Queries,companies,False,False,False,
Who are the investors of 'Deja vu Security'?,"MATCH (o:Organization {name: ""Deja vu Security""})<-[:HAS_INVESTOR]-(investor)
RETURN investor",Simple Retrieval Queries,companies,False,False,True,
Which organization has the highest revenue in Seattle?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Seattle""})
RETURN o.name AS Organization, o.revenue AS Revenue
ORDER BY o.revenue DESC
LIMIT 1",Simple Retrieval Queries,companies,False,False,True,
List the first 5 organizations that have a CEO with a summary mentioning 'Accenture'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'Accenture'
RETURN o
LIMIT 5",Simple Retrieval Queries,companies,False,False,True,
What are the first 3 organizations that have a CEO and a board member with the same name?,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person), (o)-[:HAS_BOARD_MEMBER]->(bm:Person)
WHERE ceo.name = bm.name
RETURN o
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Name the first 3 organizations that have their CEOs with a summary containing 'CEO at'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'CEO at'
RETURN o
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Which cities have more than three organizations located within them?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WITH c, count(o) AS orgCount
WHERE orgCount > 3
RETURN c.name, orgCount",Simple Retrieval Queries,companies,False,False,True,
List the first 3 organizations that have a subsidiary and an investor.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization)
WHERE exists{ (o)-[:HAS_INVESTOR]->() }
RETURN o
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
What are the top 5 organizations by number of employees?,"MATCH (o:Organization)
WHERE o.nbrEmployees IS NOT NULL
RETURN o
ORDER BY o.nbrEmployees DESC
LIMIT 5",Simple Retrieval Queries,companies,False,False,False,
Who are the first 3 persons mentioned as investors in organizations?,"MATCH (p:Person)-[:HAS_INVESTOR]->(o:Organization)
RETURN p.name AS InvestorName
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Which organizations have more than two competitors?,"MATCH (o:Organization)
WHERE count{(o)-[:HAS_COMPETITOR]->(:Organization)} > 2
RETURN o.name, count{(o)-[:HAS_COMPETITOR]->(:Organization)} AS competitors_count",Simple Retrieval Queries,companies,False,False,True,
What are the first 3 organizations that have been mentioned in articles by 'David Correa'?,"MATCH (a:Article {author: ""David Correa""})-[:MENTIONS]->(o:Organization)
RETURN o
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
List the first 5 organizations that have a motto containing 'world'.,"MATCH (o:Organization)
WHERE o.motto CONTAINS 'world'
RETURN o
LIMIT 5",Simple Retrieval Queries,companies,False,False,True,
Who are the first 3 CEOs of organizations that have been dissolved?,"MATCH (o:Organization {isDissolved: true})-[:HAS_CEO]->(p:Person)
RETURN p.name AS CEO_Name, o.name AS Organization_Name
LIMIT 3",Simple Retrieval Queries,companies,True,False,False,
Which organizations have a parent organization within the same city?,"MATCH (childOrg:Organization)-[:HAS_SUBSIDIARY]->(parentOrg:Organization)
WHERE EXISTS {
    (childOrg)-[:IN_CITY]->(city:City) 
    AND (parentOrg)-[:IN_CITY]->(city)
}
RETURN childOrg, parentOrg",Simple Retrieval Queries,companies,False,False,True,
"What are the first 3 articles with a date after January 1, 2021?","MATCH (a:Article)
WHERE a.date > datetime('2021-01-01T00:00:00Z')
RETURN a
ORDER BY a.date ASC
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
List the first 3 organizations that are competitors within the same industry category.,"MATCH (o1:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory)<-[:HAS_CATEGORY]-(o2:Organization)
WHERE o1 <> o2 AND EXISTS {(o1)-[:HAS_COMPETITOR]->(o2)}
RETURN o1.name AS Organization1, o2.name AS Organization2, ic.name AS IndustryCategory
LIMIT 3",Simple Retrieval Queries,companies,False,False,False,
Name the first 3 organizations that have a supplier named 'New Energy Group'.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(supplier:Organization {name: 'New Energy Group'})
RETURN o.name AS OrganizationName
LIMIT 3",Simple Retrieval Queries,companies,False,False,False,
What are the first 3 organizations that have the industry category 'Software company'?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Software company""})
RETURN o
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Who are the board members of the first 3 public organizations?,"MATCH (o:Organization {isPublic: true})
WITH o
LIMIT 3
MATCH (o)-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN o.name AS Organization, collect(p.name) AS BoardMembers",Simple Retrieval Queries,companies,False,False,True,
List the first 3 articles that mention an organization with a revenue less than 5 million.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.revenue < 5000000
RETURN a
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Which organizations are headquartered in a city with a summary containing 'capital'?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE c.summary CONTAINS 'capital'
RETURN o",Simple Retrieval Queries,companies,False,False,True,
Provide the names of the first 5 organizations that have at least one subsidiary.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization)
RETURN o.name
LIMIT 5",Simple Retrieval Queries,companies,False,False,True,
What are the summaries of the first 3 organizations that have more than 200 employees?,"MATCH (o:Organization)
WHERE o.nbrEmployees > 200
RETURN o.summary
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
List the first 3 organizations that have an investor who is a person.,"MATCH (o:Organization)-[:HAS_INVESTOR]->(p:Person)
RETURN o
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
What are the first 3 organizations that have a public status and more than 500 employees?,"MATCH (o:Organization)
WHERE o.isPublic = true AND o.nbrEmployees > 500
RETURN o
ORDER BY o.nbrEmployees DESC
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
What are the top 5 articles with the highest sentiment scores?,"MATCH (a:Article)
RETURN a
ORDER BY a.sentiment DESC
LIMIT 5",Complex Retrieval Queries,companies,False,False,True,
List all organizations that have a supplier named 'Accenture'.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(supplier:Organization {name: 'Accenture'})
RETURN o",Complex Retrieval Queries,companies,False,False,True,
Which organizations have a CEO and are also public companies?,"MATCH (o:Organization)-[:HAS_CEO]->(:Person)
WHERE o.isPublic = true
RETURN o",Complex Retrieval Queries,companies,False,False,False,
Which 3 organizations have changed their CEOs in the last year?,"MATCH (o:Organization)-[r:HAS_CEO]->(p1:Person), (o)-[r2:HAS_CEO]->(p2:Person)
WHERE r.endDate IS NOT NULL AND r2.startDate >= date()-duration({years:1}) AND r.endDate < r2.startDate
RETURN o.name AS Organization, p1.name AS Previous_CEO, p2.name AS Current_CEO
LIMIT 3",Simple Aggregation Queries,companies,False,False,False,"HAS_CEO.endDate, HAS_CEO.startDate"
Who are the top 3 CEOs of tech companies by number of articles mentioning them?,"MATCH (ceo:Person)<-[:HAS_CEO]-(org:Organization)-[:HAS_CATEGORY]->(cat:IndustryCategory {name: ""Technology""})
WITH ceo, org
MATCH (article:Article)-[:MENTIONS]->(org)
WITH ceo, COUNT(article) AS mentions
ORDER BY mentions DESC
LIMIT 3
RETURN ceo.name AS CEOName, mentions",Simple Aggregation Queries,companies,False,False,False,
List the 5 most recent articles that mention organizations in the technology sector.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: ""Technology""})
RETURN a
ORDER BY a.date DESC
LIMIT 5",Simple Aggregation Queries,companies,False,False,False,
Which 3 organizations have the oldest founding dates?,"MATCH (o:Organization)
WHERE o.foundingDate IS NOT NULL
RETURN o
ORDER BY o.foundingDate ASC
LIMIT 3",Simple Aggregation Queries,companies,False,False,False,Organization.foundingDate
List the first 5 organizations that have a CEO with a name mentioned in more than one article and a revenue greater than 100 million.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE o.revenue > 100000000
WITH o, p, count{(p)<-[:MENTIONS]-(:Article)} AS mentionsCount
WHERE mentionsCount > 1
RETURN o
LIMIT 5",Verbose query,companies,False,False,False,
What are the top 5 cities mentioned in recent articles?,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)-[:MENTIONS]->(city:City)
WHERE a.date >= date() - duration({days: 30})
RETURN city.name, count(a) AS mentions
ORDER BY mentions DESC
LIMIT 5",Simple Aggregation Queries,companies,False,False,True,
Who are the investors in the top 3 organizations by revenue?,"MATCH (o:Organization)
WHERE o.revenue IS NOT NULL
WITH o
ORDER BY o.revenue DESC
LIMIT 3
MATCH (o)<-[:HAS_INVESTOR]-(investor)
RETURN o.name AS Organization, collect(investor.name) AS Investors",Simple Aggregation Queries,companies,False,False,True,
List 3 organizations that have a competitor in the same industry.,"MATCH (o1:Organization)-[:HAS_CATEGORY]->(cat:IndustryCategory)<-[:HAS_CATEGORY]-(o2:Organization)
WHERE o1 <> o2 AND EXISTS { (o1)-[:HAS_COMPETITOR]->(o2) }
RETURN o1.name AS Organization, o2.name AS Competitor, cat.name AS Industry
LIMIT 3",Simple Aggregation Queries,companies,False,False,True,
Which 5 organizations have the most subsidiaries?,"MATCH (o:Organization)
WITH o, count{(o)-[:HAS_SUBSIDIARY]->(:Organization)} AS numSubsidiaries
ORDER BY numSubsidiaries DESC
LIMIT 5
RETURN o.name, numSubsidiaries",Simple Aggregation Queries,companies,False,False,True,
Name 3 countries hosting organizations with revenue over 100 million.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE o.revenue > 100000000
RETURN DISTINCT country.name
LIMIT 3",Simple Aggregation Queries,companies,False,False,True,
Name the top 5 industries by number of organizations associated with them.,"MATCH (i:IndustryCategory)<-[:HAS_CATEGORY]-(o:Organization)
RETURN i.name AS Industry, count(o) AS NumberOfOrganizations
ORDER BY NumberOfOrganizations DESC
LIMIT 5",Simple Aggregation Queries,companies,False,False,True,
What are the top 5 cities by number of organizations located in them?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
RETURN c.name AS City, count(o) AS NumberOfOrganizations
ORDER BY NumberOfOrganizations DESC
LIMIT 5",Simple Aggregation Queries,companies,True,False,False,
Who are the board members of the top 3 organizations by revenue?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN o.name AS Organization, collect(p.name) AS BoardMembers
ORDER BY o.revenue DESC
LIMIT 3",Simple Aggregation Queries,companies,False,False,True,
List the top 5 articles by positive sentiment.,"MATCH (a:Article)
RETURN a
ORDER BY a.sentiment DESC
LIMIT 5",Simple Aggregation Queries,companies,False,False,False,
Which 3 organizations have a CEO named 'Julie Spellman Sweet'?,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_CEO]->(o:Organization)
RETURN o
LIMIT 3",Simple Aggregation Queries,companies,False,False,True,
Can you name 3 organizations that have subsidiaries?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)
RETURN DISTINCT o.name
LIMIT 3",Simple Aggregation Queries,companies,False,False,True,
What are the 5 latest articles mentioning the organization 'New Energy Group'?,"MATCH (o:Organization {name: ""New Energy Group""})<-[:MENTIONS]-(a:Article)
RETURN a
ORDER BY a.date DESC
LIMIT 5",Simple Aggregation Queries,companies,False,False,True,
Which 3 industries are most commonly associated with organizations in Seattle?,"MATCH (org:Organization)-[:IN_CITY]->(city:City {name: ""Seattle""})
WITH org
MATCH (org)-[:HAS_CATEGORY]->(ind:IndustryCategory)
RETURN ind.name, count(org) AS numOrganizations
ORDER BY numOrganizations DESC
LIMIT 3",Simple Aggregation Queries,companies,False,False,True,
Name 5 organizations that have been marked as public.,"MATCH (o:Organization {isPublic: true})
RETURN o
LIMIT 5",Simple Aggregation Queries,companies,False,False,True,
List the top 3 organizations with the most employees.,"MATCH (o:Organization)
WHERE o.nbrEmployees IS NOT NULL
RETURN o
ORDER BY o.nbrEmployees DESC
LIMIT 3",Simple Aggregation Queries,companies,False,False,True,
Which 3 cities have organizations that are not dissolved?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.isDissolved = false
RETURN c.name, count(o) AS numOrganizations
ORDER BY numOrganizations DESC
LIMIT 3",Simple Aggregation Queries,companies,False,False,True,
What are the top 5 organizations with the highest revenue?,"MATCH (o:Organization)
WHERE o.revenue IS NOT NULL
RETURN o
ORDER BY o.revenue DESC
LIMIT 5",Simple Aggregation Queries,companies,False,False,True,
Name 3 organizations that have suppliers.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(supplier:Organization)
RETURN o.name AS OrganizationName, supplier.name AS SupplierName
LIMIT 3",Simple Aggregation Queries,companies,False,False,False,
What are the 3 latest investments made by organizations in the software industry?,"MATCH (org:Organization)-[:HAS_INVESTOR]->(invested:Organization)-[:HAS_CATEGORY]->(cat:IndustryCategory {name: ""Software Industry""})
WITH invested, org
ORDER BY invested.date DESC
LIMIT 3
RETURN org.name AS Investor, invested.name AS InvestedCompany, invested.date AS InvestmentDate",Simple Aggregation Queries,companies,False,False,False,Organization.date
List 5 organizations that have acquired other organizations in the past year.,"MATCH (o:Organization)-[:HAS_INVESTOR]->(acquired:Organization)
WHERE acquired.isDissolved = true AND acquired.revenue IS NOT NULL
RETURN o.name AS Organization, acquired.name AS Acquired_Organization
LIMIT 5",Simple Aggregation Queries,companies,False,False,True,
Which 3 organizations have the highest number of board members?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WITH o, count(p) AS boardMembers
ORDER BY boardMembers DESC
LIMIT 3
RETURN o.name, boardMembers",Simple Aggregation Queries,companies,False,False,True,
"Which cities are linked to more than 5 organizations, list the first 3.","MATCH (c:City)<-[:IN_CITY]-(o:Organization)
WITH c, count(o) AS orgCount
WHERE orgCount > 5
RETURN c.name AS CityName
LIMIT 3",Pathfinding Queries,companies,False,False,False,
What are the top 3 articles mentioning organizations in the 'Financial Services' industry?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Financial Services""})
RETURN a
ORDER BY a.date DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
"Which organizations have more than 2 competitors, list the top 3.","MATCH (o:Organization)
WHERE count{(o)-[:HAS_COMPETITOR]->(:Organization)} > 2
RETURN o
ORDER BY count{(o)-[:HAS_COMPETITOR]->(:Organization)} DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
List the first 3 organizations that have 'Accenture' as a supplier.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(supplier:Organization {name: ""Accenture""})
RETURN o
LIMIT 3",Pathfinding Queries,companies,False,False,False,
Who are the top 3 investors of 'New Energy Group'?,"MATCH (o:Organization {name: ""New Energy Group""})<-[:HAS_INVESTOR]-(investor)
RETURN investor
ORDER BY investor.name
LIMIT 3",Pathfinding Queries,companies,False,False,False,
List the first 3 organizations in the 'Software' industry category.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Software""})
RETURN o
LIMIT 3",Pathfinding Queries,companies,False,False,True,
"Which organizations in New York City have the most employees, list the top 3.","MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""New York City""})
WHERE o.nbrEmployees IS NOT NULL
RETURN o.name, o.nbrEmployees
ORDER BY o.nbrEmployees DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
What are the top 5 highest revenue organizations that are not public?,"MATCH (o:Organization)
WHERE o.isPublic = false AND o.revenue IS NOT NULL
RETURN o
ORDER BY o.revenue DESC
LIMIT 5",Pathfinding Queries,companies,False,False,True,
List the first 3 cities where 'Accenture' has subsidiaries.,"MATCH (org:Organization {name: ""Accenture""})-[:HAS_SUBSIDIARY]->(sub:Organization)-[:IN_CITY]->(city:City)
RETURN DISTINCT city.name
LIMIT 3",Pathfinding Queries,companies,False,False,True,
What are the names of the top 5 organizations that have been dissolved?,"MATCH (o:Organization)
WHERE o.isDissolved = true
RETURN o.name
ORDER BY o.revenue DESC
LIMIT 5",Pathfinding Queries,companies,False,False,True,
Who are the board members of the first 3 public organizations?,"MATCH (o:Organization {isPublic: true})
WITH o
LIMIT 3
MATCH (o)-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN o.name AS Organization, collect(p.name) AS BoardMembers",Pathfinding Queries,companies,False,False,True,
Find the top 5 organizations with revenue over 100 million that have subsidiaries.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization)
WHERE o.revenue > 100000000
RETURN o
ORDER BY o.revenue DESC
LIMIT 5",Pathfinding Queries,companies,False,False,True,
Which organizations in the city of Chicago have more than 300 employees?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Chicago""})
WHERE o.nbrEmployees > 300
RETURN o",Pathfinding Queries,companies,False,False,True,
List the first 3 organizations mentioned in articles published by 'Silicon UK'.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.siteName = 'Silicon UK'
RETURN o
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Who are the top 5 CEOs of organizations based in Seattle?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Seattle""})
MATCH (o)-[:HAS_CEO]->(p:Person)
RETURN p.name AS CEO_Name, o.name AS Organization_Name
ORDER BY o.revenue DESC
LIMIT 5",Pathfinding Queries,companies,False,False,True,
Name the top 5 organizations by number of articles mentioning them.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WITH o, count(a) AS mentions
ORDER BY mentions DESC
LIMIT 5
RETURN o.name, mentions",Simple Aggregation Queries,companies,True,False,False,
Which 3 organizations have the most detailed organizational summaries?,"MATCH (o:Organization)
WHERE o.summary IS NOT NULL
RETURN o
ORDER BY length(o.summary) DESC
LIMIT 3",Simple Aggregation Queries,companies,False,False,True,
List the 5 organizations with the most diverse industry categories.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory)
WITH o, count(DISTINCT c) AS numCategories
ORDER BY numCategories DESC
LIMIT 5
RETURN o.name, numCategories",Simple Aggregation Queries,companies,False,False,True,
Which 3 organizations have the most negative sentiment in recent articles?,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.sentiment IS NOT NULL
RETURN o.name, avg(a.sentiment) AS avgSentiment
ORDER BY avgSentiment ASC
LIMIT 3",Simple Aggregation Queries,companies,False,False,False,
Who are the 3 most recently appointed CEOs in the tech industry?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person), (o)-[:HAS_CATEGORY]->(c:IndustryCategory {name: ""Tech""})
RETURN p.name AS CEO_Name, o.name AS Organization_Name, p.summary AS CEO_Summary
ORDER BY p.startDate DESC
LIMIT 3",Simple Aggregation Queries,companies,False,False,True,Person.startDate
What are the 5 most recent articles about organizations in 'Seattle'?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(c:City {name: ""Seattle""})
RETURN a
ORDER BY a.date DESC
LIMIT 5",Simple Aggregation Queries,companies,False,False,False,
List the top 3 cities where tech organizations are based.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE EXISTS { (o)-[:HAS_CATEGORY]->(:IndustryCategory {name: ""Technology""}) }
RETURN c.name, count(o) AS NumberOfOrganizations
ORDER BY NumberOfOrganizations DESC
LIMIT 3",Simple Aggregation Queries,companies,False,False,True,
Name 3 organizations that have been involved in legal disputes according to recent articles.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS ""legal dispute""
WITH DISTINCT a
MATCH (a)-[:MENTIONS]->(o:Organization)
RETURN o.name AS OrganizationName
LIMIT 3",Simple Aggregation Queries,companies,False,False,False,
Identify organizations that have both a CEO and an investor named 'Julie Spellman Sweet'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
WHERE EXISTS {
  (o)-[:HAS_INVESTOR]->(:Person {name: 'Julie Spellman Sweet'})
}
RETURN o",Complex Retrieval Queries,companies,False,False,True,
What are the top 3 articles mentioning organizations with more than 200 employees?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.nbrEmployees > 200
RETURN a
ORDER BY a.date DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
List the organizations that have a public status and a summary mentioning 'software'.,"MATCH (o:Organization)
WHERE o.isPublic = true AND o.summary CONTAINS 'software'
RETURN o",Complex Retrieval Queries,companies,False,False,False,
Which organizations have a CEO named 'Julie Spellman Sweet' and have a revenue exceeding 50000000?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""})
WHERE o.revenue > 50000000
RETURN o",Complex Retrieval Queries,companies,False,False,True,
Which organizations have more than two categories and are located in 'United States of America'?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: ""United States of America""})
WHERE count{(o)-[:HAS_CATEGORY]->(:IndustryCategory)} > 2
RETURN o",Complex Retrieval Queries,companies,True,False,False,
Identify the organizations that are suppliers to public companies.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(supplier:Organization)
WHERE EXISTS { (o)-[:IS_PUBLIC]->() AND o.isPublic = true }
RETURN supplier",Complex Retrieval Queries,companies,False,False,True,
List the cities where organizations with a summary mentioning 'financial services' are based.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.summary CONTAINS 'financial services'
RETURN DISTINCT c.name",Complex Retrieval Queries,companies,False,False,True,
What are the organizations mentioned in articles with a sentiment score below 0.5?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment < 0.5
RETURN o",Complex Retrieval Queries,companies,False,False,False,
Who are the CEOs of organizations that have a competitor named 'New Energy Group'?,"MATCH (org:Organization)-[:HAS_COMPETITOR]->(:Organization {name: 'New Energy Group'})
MATCH (org)-[:HAS_CEO]->(ceo:Person)
RETURN org.name AS OrganizationName, ceo.name AS CEOName",Complex Retrieval Queries,companies,False,True,False,
Which organizations have subsidiaries and are located in the same city?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization), (o)-[:IN_CITY]->(c:City)
RETURN o.name, c.name",Complex Retrieval Queries,companies,False,False,True,
What are the relationships of 'Julie Spellman Sweet' within the context of the organization she is associated with?,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_CEO|HAS_BOARD_MEMBER|HAS_INVESTOR]-(o:Organization)
OPTIONAL MATCH (o)-[r:HAS_SUBSIDIARY|HAS_SUPPLIER|HAS_INVESTOR|HAS_COMPETITOR]->(relatedOrg:Organization)
RETURN p, o, r, relatedOrg",Complex Retrieval Queries,companies,False,False,True,
List the industry categories of organizations that have a revenue above 100000000.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory)
WHERE o.revenue > 100000000
RETURN ic.name",Complex Retrieval Queries,companies,False,False,True,
Which organizations are public and have been mentioned in articles with a positive sentiment?,"MATCH (o:Organization)-[:MENTIONS]-(a:Article)
WHERE o.isPublic = true AND a.sentiment > 0.5
RETURN o",Complex Retrieval Queries,companies,False,False,True,
Identify the organizations that have an investor with more than 50 employees.,"MATCH (o:Organization)<-[:HAS_INVESTOR]-(investor:Organization)
WHERE investor.nbrEmployees > 50
RETURN o",Complex Retrieval Queries,companies,False,False,True,
What are the titles of articles that report negative sentiments and mention organizations?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment < 0
RETURN a.title",Complex Retrieval Queries,companies,False,False,True,
List the articles that mention organizations headquartered in 'Rome'.,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Rome""})
MATCH (a:Article)-[:MENTIONS]->(o)
RETURN a",Complex Retrieval Queries,companies,False,False,False,
Which organizations have board members who are also CEOs of other organizations?,"MATCH (org:Organization)-[:HAS_BOARD_MEMBER]->(person:Person)
WHERE exists {
    MATCH (person)-[:HAS_CEO]->(otherOrg:Organization)
    WHERE org <> otherOrg
}
RETURN org.name AS Organization, collect(person.name) AS BoardMemberCEOs",Complex Retrieval Queries,companies,False,True,False,
Name the organizations that have subsidiaries and are located in cities with a summary mentioning 'county seat'.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization), (o)-[:IN_CITY]->(c:City)
WHERE c.summary CONTAINS 'county seat'
RETURN o.name AS OrganizationName",Complex Retrieval Queries,companies,False,False,False,
What is the sentiment of articles authored by 'David Correa' regarding organizations in the tech industry?,"MATCH (a:Article {author: ""David Correa""})-[:HAS_CHUNK]->(c:Chunk),
      (a)-[:MENTIONS]->(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory)
WHERE ic.name CONTAINS ""tech""
RETURN a.sentiment, a.title, o.name",Complex Retrieval Queries,companies,False,False,True,
Which organizations in 'United States of America' have more than 200 employees?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: ""United States of America""})
WHERE o.nbrEmployees > 200
RETURN o",Complex Retrieval Queries,companies,False,False,False,
List the organizations that have 'Julie Spellman Sweet' as an investor.,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_INVESTOR]->(o:Organization)
RETURN o",Complex Retrieval Queries,companies,False,False,False,
Who are the children of people working in organizations in 'Seattle'?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Seattle""})
MATCH (p:Person)-[:WORKS_FOR]->(o)
MATCH (p)-[:HAS_CHILD]->(child:Person)
RETURN p.name AS ParentName, child.name AS ChildName",Complex Retrieval Queries,companies,False,False,True,WORKS_FOR
What are the summaries of organizations that have a CEO named 'Julie Spellman Sweet'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
RETURN o.summary AS OrganizationSummary",Complex Retrieval Queries,companies,False,False,False,
Identify the organizations that have been mentioned in articles published after 2021-01-01.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.date > date('2021-01-01')
RETURN o",Complex Retrieval Queries,companies,False,False,True,
Which articles have chunks containing the text 'consumer behavior analyses'?,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS 'consumer behavior analyses'
RETURN a",Complex Retrieval Queries,companies,False,False,False,
List 3 organizations that have their headquarters in a city that is also a capital.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IS_CAPITAL_OF]->(country:Country)
RETURN o.name AS Organization, c.name AS City, country.name AS Country
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,IS_CAPITAL_OF
Name the organizations with competitors that have more than 300 employees.,"MATCH (o:Organization)-[:HAS_COMPETITOR]->(competitor:Organization)
WHERE competitor.nbrEmployees > 300
RETURN o.name AS OrganizationName, competitor.name AS CompetitorName, competitor.nbrEmployees AS CompetitorEmployees",Complex Retrieval Queries,companies,False,False,False,
Name the organizations headquartered in cities that are capitals and have more than one industry category.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE exists{(c)-[:IS_CAPITAL_OF]->(country)} AND count{(o)-[:HAS_CATEGORY]->(:IndustryCategory)} > 1
RETURN o.name AS OrganizationName, c.name AS CityName, country.name AS CountryName",Complex Retrieval Queries,companies,False,False,True,IS_CAPITAL_OF
List the top 5 organizations that are competitors of 'Accenture'.,"MATCH (o:Organization {name: ""Accenture""})-[:HAS_COMPETITOR]->(competitor:Organization)
RETURN competitor
ORDER BY competitor.name
LIMIT 5",Pathfinding Queries,companies,False,False,False,
Which organizations have a CEO who is also a board member of another organization?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE exists {
  (p)-[:HAS_BOARD_MEMBER]->(:Organization)
}
RETURN o",Complex Retrieval Queries,companies,False,False,True,
What are the top 5 articles that mention organizations based in 'United States of America'?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: 'United States of America'})
RETURN a
ORDER BY a.date DESC
LIMIT 5",Complex Retrieval Queries,companies,False,False,True,
Identify the organizations that have a CEO with a summary including 'executive' and are located in a country named 'United States of America'.,"MATCH (org:Organization)-[:HAS_CEO]->(ceo:Person), (org)-[:IN_CITY]->(city:City)-[:IN_COUNTRY]->(country:Country {name: ""United States of America""})
WHERE ceo.summary CONTAINS 'executive'
RETURN org",Complex Retrieval Queries,companies,False,False,True,
What are the summaries of organizations that have a supplier named 'Accenture'?,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(:Organization {name: 'Accenture'})
RETURN o.name, o.summary",Complex Retrieval Queries,companies,False,False,False,
List the children of CEOs who are mentioned as investors in the database.,"MATCH (ceo:Person)-[:HAS_CEO]->(org:Organization)<-[:HAS_INVESTOR]-(investor:Person)-[:HAS_CHILD]->(child:Person)
RETURN ceo.name AS CEOName, org.name AS OrganizationName, investor.name AS InvestorName, child.name AS ChildName",Complex Retrieval Queries,companies,False,False,True,
Name the organizations headquartered in 'Rome' that have a public status.,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Rome""})
WHERE o.isPublic = true
RETURN o",Complex Retrieval Queries,companies,False,False,True,
Which organizations have a CEO and a motto that includes 'innovation'?,"MATCH (o:Organization)-[:HAS_CEO]->(:Person)
WHERE o.motto CONTAINS 'innovation' AND o.motto IS NOT NULL
RETURN o",Complex Retrieval Queries,companies,False,False,True,
List the organizations that have competitors and a public status.,"MATCH (o:Organization)
WHERE o.isPublic = true AND exists{(o)-[:HAS_COMPETITOR]->(:Organization)}
RETURN o",Complex Retrieval Queries,companies,False,True,False,
Who are the investors in organizations that have subsidiaries in 'United States of America'?,"MATCH (c:Country {name: ""United States of America""})<-[:IN_COUNTRY]-(city:City)<-[:IN_CITY]-(org:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)
MATCH (inv)-[:HAS_INVESTOR]->(org)
RETURN inv",Complex Retrieval Queries,companies,False,False,False,
Identify the articles that mention organizations with a CEO named 'Julie Spellman Sweet' and a revenue over 100000000.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""})
WHERE o.revenue > 100000000
MATCH (a:Article)-[:MENTIONS]->(o)
RETURN a",Complex Retrieval Queries,companies,False,False,False,
List the organizations located in cities that have been mentioned in articles with a high sentiment score.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)<-[:MENTIONS]-(a:Article)
WHERE a.sentiment > 0.5
RETURN o.name AS Organization, c.name AS City, a.title AS ArticleTitle, a.sentiment AS SentimentScore",Complex Retrieval Queries,companies,False,False,True,
Name the organizations that are public and have a category in 'Electronic Products Manufacturers'.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: ""Electronic Products Manufacturers""})
WHERE o.isPublic = true
RETURN o",Complex Retrieval Queries,companies,False,False,False,
Which organizations have a board member named 'Julie Spellman Sweet'?,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_BOARD_MEMBER]->(o:Organization)
RETURN o",Complex Retrieval Queries,companies,False,False,True,
List the organizations that have a subsidiary and also have a supplier named 'Accenture'.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization)
WHERE EXISTS {
  (o)-[:HAS_SUPPLIER]->(:Organization {name: 'Accenture'})
}
RETURN o",Complex Retrieval Queries,companies,False,False,True,
What are the articles mentioning organizations that have a CEO with a name containing 'Sweet'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.name CONTAINS 'Sweet'
MATCH (a:Article)-[:MENTIONS]->(o)
RETURN a",Complex Retrieval Queries,companies,False,False,True,
Name the top 3 countries where organizations with a revenue of over 100000000 are based.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE o.revenue > 100000000
RETURN country.name, count(o) AS NumberOfOrganizations
ORDER BY NumberOfOrganizations DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,False,
Which organizations have investors who are also board members?,"MATCH (o:Organization)<-[:HAS_INVESTOR]-(p:Person)-[:HAS_BOARD_MEMBER]->(o)
RETURN o",Complex Retrieval Queries,companies,False,False,False,
What are the names of organizations with a CEO named 'Julie Spellman Sweet' and are located in a city named 'Seattle'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""}), (o)-[:IN_CITY]->(c:City {name: ""Seattle""})
RETURN o.name",Complex Retrieval Queries,companies,False,False,True,
List the industry categories of organizations that have a CEO with a summary mentioning 'executive'.,"MATCH (org:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE ceo.summary CONTAINS 'executive'
MATCH (org)-[:HAS_CATEGORY]->(category:IndustryCategory)
RETURN category.name AS IndustryCategory",Complex Retrieval Queries,companies,False,True,False,
Which organizations are competitors and are located in the same country?,"MATCH (o1:Organization)-[:HAS_COMPETITOR]->(o2:Organization)
MATCH (o1)-[:IN_CITY]->(c1:City)-[:IN_COUNTRY]->(country:Country)
MATCH (o2)-[:IN_CITY]->(c2:City)-[:IN_COUNTRY]->(country)
RETURN o1.name AS Organization1, o2.name AS Organization2, country.name AS Country",Complex Retrieval Queries,companies,False,False,False,
Identify the organizations that have CEOs who are also investors in other companies.,"MATCH (org:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE exists {
  (ceo)-[:HAS_INVESTOR]->(:Organization)
}
RETURN org",Complex Retrieval Queries,companies,False,False,True,
What are the top 3 articles mentioning organizations with a public status?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.isPublic = true
RETURN a
ORDER BY a.date DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
List the cities that are home to organizations with a revenue exceeding 50000000.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.revenue > 50000000
RETURN DISTINCT c.name",Complex Retrieval Queries,companies,False,False,False,
Name the organizations that have investors named 'Julie Spellman Sweet'.,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_INVESTOR]->(o:Organization)
RETURN o.name AS OrganizationName",Complex Retrieval Queries,companies,False,False,True,
Which organizations have a summary that includes 'based in San Francisco' and are not dissolved?,"MATCH (o:Organization)
WHERE o.summary CONTAINS 'based in San Francisco' AND o.isDissolved = false
RETURN o",Complex Retrieval Queries,companies,False,False,True,
List the top 3 organizations by revenue that are located in a city with a summary mentioning 'metropolitan'.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE c.summary CONTAINS 'metropolitan'
RETURN o.name, o.revenue
ORDER BY o.revenue DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Identify the top 3 organizations with the highest revenue that are headquartered in a country named 'United States of America'.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: ""United States of America""})
WHERE o.revenue IS NOT NULL
RETURN o.name, o.revenue
ORDER BY o.revenue DESC
LIMIT 3",Verbose query,companies,False,False,False,
List the first 5 organizations that have a CEO with a name mentioned in at least two different articles.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE exists {
  MATCH (a1:Article)-[:MENTIONS]->(p)
  WITH p, count(DISTINCT a1) AS articlesCount
  WHERE articlesCount >= 2
  RETURN p
}
RETURN o
LIMIT 5",Verbose query,companies,False,False,True,
What are the first 3 organizations that have subsidiaries and more than 500 employees?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization)
WHERE o.nbrEmployees > 500
RETURN o
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Name 3 organizations that have been mentioned in articles with a sentiment score above 0.5.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment > 0.5
RETURN o.name
LIMIT 3",Pathfinding Queries,companies,False,False,False,
Who are the first 3 CEOs of organizations in the manufacturing industry?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person), (o)-[:HAS_CATEGORY]->(c:IndustryCategory {name: ""Manufacturing""})
RETURN p.name AS CEO_Name, o.name AS Organization_Name
LIMIT 3",Pathfinding Queries,companies,False,False,True,
List the top 5 cities where the headquarters of public organizations are located.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.isPublic = true
RETURN c.name, count(o) AS numberOfPublicOrgs
ORDER BY numberOfPublicOrgs DESC
LIMIT 5",Pathfinding Queries,companies,False,False,True,
Which 3 organizations have the largest number of competitors?,"MATCH (o:Organization)
WITH o, count{(o)-[:HAS_COMPETITOR]->(:Organization)} AS competitorsCount
ORDER BY competitorsCount DESC
LIMIT 3
RETURN o.name, competitorsCount",Pathfinding Queries,companies,False,False,False,
Name the first 3 organizations that have at least one board member who is also a CEO of another organization.,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WHERE exists {
    MATCH (p)-[:HAS_CEO]->(:Organization)
}
RETURN o.name AS OrganizationName
LIMIT 3",Pathfinding Queries,companies,True,False,False,
Which 3 people have the most children listed in the database?,"MATCH (p:Person)
WITH p, size((p)-[:HAS_CHILD]->()) AS children_count
ORDER BY children_count DESC
LIMIT 3
RETURN p.name, children_count",Pathfinding Queries,companies,False,False,True,
What are the names of the first 3 organizations that are investors in other organizations?,"MATCH (o:Organization)-[:HAS_INVESTOR]->(:Organization)
RETURN o.name
LIMIT 3",Pathfinding Queries,companies,False,False,True,
List the top 5 articles that mention organizations based in Seattle.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(c:City {name: ""Seattle""})
RETURN a
ORDER BY a.date DESC
LIMIT 5",Pathfinding Queries,companies,False,False,False,
Name 3 organizations that are competitors in the software industry.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Software Industry""})
WHERE EXISTS {
    (o)-[:HAS_COMPETITOR]->(:Organization)
}
RETURN o.name
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Which 3 countries have the most cities with organizations based in them?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WITH country, count(DISTINCT c) AS citiesCount
ORDER BY citiesCount DESC
LIMIT 3
RETURN country.name AS Country, citiesCount",Pathfinding Queries,companies,False,False,True,
What are the names of the first 3 organizations that have subsidiaries?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization)
RETURN o.name
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Who are the board members of the first 3 organizations with the highest revenue?,"MATCH (o:Organization)
WHERE o.revenue IS NOT NULL
WITH o
ORDER BY o.revenue DESC
LIMIT 3
MATCH (o)-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN o.name AS Organization, collect(p.name) AS BoardMembers",Pathfinding Queries,companies,False,False,True,
Which 3 industry categories have the most organizations with public status?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory)
WHERE o.isPublic = true
RETURN ic.name, count(o) AS numOrganizations
ORDER BY numOrganizations DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Which 3 cities are mentioned most frequently in articles?,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)<-[:MENTIONS]-(a:Article)
RETURN c.name, count(a) AS mentions
ORDER BY mentions DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
What are the names of 3 industry categories that the most organizations belong to?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory)
WITH ic.name AS IndustryName, count(o) AS OrgCount
ORDER BY OrgCount DESC
LIMIT 3
RETURN IndustryName",Pathfinding Queries,companies,False,False,True,
Can you identify 3 organizations mentioned in articles published in 2022?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.date.year = 2022
RETURN o
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Name the top 5 articles with the highest sentiment scores.,"MATCH (a:Article)
RETURN a
ORDER BY a.sentiment DESC
LIMIT 5",Pathfinding Queries,companies,False,False,True,
Which 3 organizations have the most employees?,"MATCH (o:Organization)
WHERE o.nbrEmployees IS NOT NULL
RETURN o
ORDER BY o.nbrEmployees DESC
LIMIT 3",Pathfinding Queries,companies,False,False,False,
What are the names of the first 3 people who are CEOs of public organizations?,"MATCH (p:Person)-[:HAS_CEO]->(o:Organization)
WHERE o.isPublic = true
RETURN p.name
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Which 3 cities have the most organizations based in them?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WITH c, count(o) AS numOrganizations
ORDER BY numOrganizations DESC
LIMIT 3
RETURN c.name AS City, numOrganizations",Pathfinding Queries,companies,False,False,True,
List the names of 3 organizations that are dissolved.,"MATCH (o:Organization {isDissolved: true})
RETURN o.name
LIMIT 3",Pathfinding Queries,companies,False,False,True,
What are the names of the top 5 organizations with the highest revenue?,"MATCH (o:Organization)
WHERE o.revenue IS NOT NULL
RETURN o.name, o.revenue
ORDER BY o.revenue DESC
LIMIT 5",Pathfinding Queries,companies,False,False,True,
Who are the top 5 CEOs in terms of the revenue of the organizations they lead?,"MATCH (org:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE org.revenue IS NOT NULL
RETURN ceo, org.name AS Organization, org.revenue AS Revenue
ORDER BY org.revenue DESC
LIMIT 5",Simple Aggregation Queries,companies,False,False,False,
Which organizations have a CEO who is also a board member in another organization?,"MATCH (org:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE EXISTS {
    MATCH (ceo)-[:HAS_BOARD_MEMBER]->(otherOrg:Organization)
    WHERE org <> otherOrg
}
RETURN org.name AS OrganizationName, ceo.name AS CEOName",Simple Aggregation Queries,companies,False,False,True,
What are the first 3 countries with organizations that have more than 1000 employees?,"MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country)
WHERE o.nbrEmployees > 1000
RETURN c.name AS CountryName, count(o) AS NumberOfOrganizations
ORDER BY NumberOfOrganizations DESC
LIMIT 3",Simple Aggregation Queries,companies,True,False,False,
List the top 3 organizations by the number of articles mentioning them in 2021.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.date >= date('2021-01-01T00:00:00Z') AND a.date <= date('2021-12-31T23:59:59Z')
RETURN o.name, count(a) AS mentions
ORDER BY mentions DESC
LIMIT 3",Simple Aggregation Queries,companies,False,False,False,
List the names of 3 organizations that are suppliers to technology companies.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(supplier:Organization)
WHERE EXISTS { (o)-[:HAS_CATEGORY]->(:IndustryCategory {name: ""Technology""}) }
RETURN supplier.name
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Which organization has the most suppliers and what is its name?,"MATCH (o:Organization)
WITH o, count{(o)-[:HAS_SUPPLIER]->(:Organization)} AS supplierCount
ORDER BY supplierCount DESC
LIMIT 1
RETURN o.name AS OrganizationName, supplierCount",Simple Aggregation Queries,companies,True,False,False,
List the first 3 cities that are in countries with more than 100 organizations based in them.,"MATCH (c:City)-[:IN_COUNTRY]->(country:Country)
WHERE size{(country)<-[:IN_CITY]-(:Organization)} > 100
RETURN c.name AS CityName
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Which 3 organizations have the highest number of investors?,"MATCH (o:Organization)
WITH o, count{(o)-[:HAS_INVESTOR]->()} AS numInvestors
ORDER BY numInvestors DESC
LIMIT 3
RETURN o.name, numInvestors",Pathfinding Queries,companies,False,False,True,
List the first 3 articles that mention new energy technologies.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.name CONTAINS ""New Energy""
RETURN a
ORDER BY a.date DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Which 3 organizations have the most board members?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WITH o, count(p) AS boardMembersCount
ORDER BY boardMembersCount DESC
LIMIT 3
RETURN o.name, boardMembersCount",Pathfinding Queries,companies,False,False,False,
What are the names of organizations that have a CEO who is younger than 40 years old?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.age < 40
RETURN o.name AS OrganizationName",Pathfinding Queries,companies,False,False,True,Person.age
Name the first 3 cities that have organizations with revenues exceeding $500 million.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.revenue > 500000000
RETURN DISTINCT c.name
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Who are the first 3 people who have both parent and child roles in the database?,"MATCH (p:Person)
WHERE exists{(p)-[:HAS_PARENT]->(:Person)} AND exists{(p)-[:HAS_CHILD]->(:Person)}
RETURN p
LIMIT 3",Pathfinding Queries,companies,False,False,False,
List the names of the cities where the headquarters of the first 5 organizations founded before 1950 are located.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.founded < 1950
RETURN c.name
LIMIT 5",Pathfinding Queries,companies,False,False,True,Organization.founded
Which 3 organizations have the most articles mentioning them with a negative sentiment score?,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.sentiment < 0
RETURN o.name, count(a) AS mentions
ORDER BY mentions DESC
LIMIT 3",Pathfinding Queries,companies,False,False,False,
What are the names of 3 organizations that have a CEO who was previously a board member of a competitor?,"MATCH (org:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE EXISTS {
    MATCH (ceo)-[:HAS_BOARD_MEMBER]->(comp:Organization)-[:HAS_COMPETITOR]->(org)
}
RETURN org.name
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Name the first 3 organizations that have been dissolved but still have active subsidiaries.,"MATCH (o:Organization {isDissolved: true})-[:HAS_SUBSIDIARY]->(s:Organization {isDissolved: false})
RETURN o.name AS DissolvedOrganization, collect(s.name) AS ActiveSubsidiaries
LIMIT 3",Pathfinding Queries,companies,False,False,True,
List the names of the first 3 organizations that have a public motto.,"MATCH (o:Organization)
WHERE o.motto IS NOT NULL AND o.motto <> """"
RETURN o.name
LIMIT 3",Pathfinding Queries,companies,False,False,False,
Which 3 people are mentioned as investors in multiple organizations?,"MATCH (p:Person)-[:HAS_INVESTOR]->(o:Organization)
WITH p, count(o) AS orgs
WHERE orgs > 1
RETURN p
LIMIT 3",Pathfinding Queries,companies,False,False,False,
Name the top 3 articles that discuss organizations with a history of more than 50 years.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.summary CONTAINS ""more than 50 years""
RETURN a.title, a.date, a.author
ORDER BY a.date DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
What are the names of the organizations where the CEOs have the same last name?,"MATCH (o1:Organization)-[:HAS_CEO]->(p1:Person), (o2:Organization)-[:HAS_CEO]->(p2:Person)
WHERE p1.name <> p2.name AND last(split(p1.name, "" "")) = last(split(p2.name, "" ""))
RETURN DISTINCT o1.name AS Organization1, o2.name AS Organization2",Pathfinding Queries,companies,False,False,True,
Which 3 countries have organizations that are major players in the electronics industry?,"MATCH (c:Country)<-[:IN_COUNTRY]-(city:City)<-[:IN_CITY]-(org:Organization)-[:HAS_CATEGORY]->(ind:IndustryCategory {name: ""Electronic Products Manufacturers""})
WHERE EXISTS { (org)-[:HAS_COMPETITOR]->(:Organization) }
RETURN c.name AS Country, count(org) AS NumberOfOrganizations
ORDER BY NumberOfOrganizations DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
What are the names of the first 3 industry categories that have organizations with revenues over $100 million?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory)
WHERE o.revenue > 100000000
RETURN DISTINCT ic.name
LIMIT 3",Pathfinding Queries,companies,False,False,False,
Name the first 3 organizations that are headquartered in cities with more than 5 million inhabitants.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE c.nbrResidents > 5000000
RETURN o.name AS OrganizationName
LIMIT 3",Pathfinding Queries,companies,False,False,True,City.nbrResidents
Which 3 cities are the most frequently mentioned settings in articles about finance?,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS ""finance""
WITH a
MATCH (a)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(city:City)
RETURN city.name, count(a) AS mentions
ORDER BY mentions DESC
LIMIT 3",Pathfinding Queries,companies,False,False,False,
What are the names of organizations that have both a supplier and a subsidiary in Europe?,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(supplier:Organization), 
      (o)-[:HAS_SUBSIDIARY]->(subsidiary:Organization)
WHERE EXISTS {
    (supplier)-[:IN_CITY]->(city:City)-[:IN_COUNTRY]->(country:Country)
    WHERE country.name CONTAINS ""Europe""
} AND EXISTS {
    (subsidiary)-[:IN_CITY]->(city:City)-[:IN_COUNTRY]->(country:Country)
    WHERE country.name CONTAINS ""Europe""
}
RETURN DISTINCT o.name",Pathfinding Queries,companies,False,False,True,
List the first 3 organizations that have a CEO and a board member with the same name.,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person), (o)-[:HAS_BOARD_MEMBER]->(bm:Person)
WHERE ceo.name = bm.name
RETURN o
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Which 3 organizations have the most suppliers?,"MATCH (o:Organization)
WITH o, count{(o)-[:HAS_SUPPLIER]->(:Organization)} AS supplierCount
ORDER BY supplierCount DESC
LIMIT 3
RETURN o.name, supplierCount",Pathfinding Queries,companies,False,False,True,
Name the top 3 organizations by number of articles mentioning them in 2021.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.date >= datetime('2021-01-01T00:00:00Z') AND a.date <= datetime('2021-12-31T23:59:59Z')
RETURN o.name, count(a) AS mentions
ORDER BY mentions DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Who are the first 3 children of people who are CEOs of public organizations?,"MATCH (org:Organization {isPublic: true})-[:HAS_CEO]->(ceo:Person)-[:HAS_CHILD]->(child:Person)
RETURN ceo.name AS CEOName, child.name AS ChildName
LIMIT 3",Pathfinding Queries,companies,False,False,True,
List the top 5 organizations that have a subsidiary in the same city where they are headquartered.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)<-[:IN_CITY]-(s:Organization)
WHERE (o)-[:HAS_SUBSIDIARY]->(s)
RETURN o.name AS Organization, c.name AS City, s.name AS Subsidiary
ORDER BY o.name
LIMIT 5",Pathfinding Queries,companies,False,False,True,
Which 3 countries are mentioned the most in articles regarding technology advancements?,"MATCH (c:Country)<-[:IN_COUNTRY]-(city:City)<-[:IN_CITY]-(org:Organization)-[:HAS_CATEGORY]->(cat:IndustryCategory)
WHERE cat.name CONTAINS ""Technology""
WITH c, count(DISTINCT org) AS mentions
ORDER BY mentions DESC
LIMIT 3
RETURN c.name, mentions",Pathfinding Queries,companies,False,False,False,
What are the names of 3 organizations that have been dissolved but are still mentioned in recent articles?,"MATCH (o:Organization)-[:MENTIONS]-(a:Article)
WHERE o.isDissolved = true AND a.date >= date('2023-01-01')
RETURN o.name
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Name the first 3 organizations that have been mentioned in articles related to environmental issues.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS ""environmental issues""
MATCH (a)-[:MENTIONS]->(o:Organization)
RETURN o.name AS OrganizationName
LIMIT 3",Pathfinding Queries,companies,True,False,False,
List the names of 3 organizations that have changed their CEOs more than twice according to the database.,"MATCH (o:Organization)
WHERE size{(o)-[:HAS_CEO]->()} > 2
RETURN o.name
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Who are the CEOs of organizations that have been dissolved?,"MATCH (o:Organization {isDissolved: true})-[:HAS_CEO]->(p:Person)
RETURN o.name AS OrganizationName, p.name AS CEOName",Simple Aggregation Queries,companies,False,False,True,
What are the first 5 organizations that are mentioned in articles from 'RCR Wireless News'?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.siteName = 'RCR Wireless News'
RETURN o
LIMIT 5",Simple Aggregation Queries,companies,False,False,True,
Which cities have the most organizations that are dissolved?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.isDissolved = true
RETURN c.name, count(o) AS dissolvedOrganizations
ORDER BY dissolvedOrganizations DESC",Simple Aggregation Queries,companies,False,False,False,
Who are the children of 'Julie Spellman Sweet'?,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_CHILD]->(child:Person)
RETURN child",Simple Aggregation Queries,companies,False,False,True,
Which city has the most organizations with public status?,"MATCH (o:Organization {isPublic: true})-[:IN_CITY]->(c:City)
RETURN c.name AS City, count(o) AS NumberOfPublicOrganizations
ORDER BY NumberOfPublicOrganizations DESC
LIMIT 1",Simple Aggregation Queries,companies,False,False,True,
What organizations are headquartered in cities that are in the 'United States of America'?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: ""United States of America""})
RETURN o.name AS OrganizationName, c.name AS CityName",Simple Aggregation Queries,companies,False,False,True,
What are the first 3 articles about organizations with a public status?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.isPublic = true
RETURN a
LIMIT 3",Simple Aggregation Queries,companies,False,False,True,
Who wrote the article with the highest sentiment score mentioning 'SAP'?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization {name: ""SAP""})
RETURN a.author AS author
ORDER BY a.sentiment DESC
LIMIT 1",Simple Aggregation Queries,companies,False,False,True,
What are the industry categories of organizations located in 'Seattle'?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: 'Seattle'})
MATCH (o)-[:HAS_CATEGORY]->(ic:IndustryCategory)
RETURN ic.name AS IndustryCategory",Simple Aggregation Queries,companies,False,False,True,
Which countries host organizations that have a revenue over 50 million?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE o.revenue > 50000000
RETURN DISTINCT country.name",Simple Aggregation Queries,companies,False,False,True,
List the organizations that have more than one subsidiary.,"MATCH (o:Organization)
WHERE count{(o)-[:HAS_SUBSIDIARY]->(:Organization)} > 1
RETURN o",Simple Aggregation Queries,companies,False,False,True,
Which organizations have a motto containing the word 'technology'?,"MATCH (o:Organization)
WHERE o.motto CONTAINS 'technology'
RETURN o",Simple Aggregation Queries,companies,False,False,True,
What is the sentiment of the article that has the highest sentiment score mentioning 'Accenture'?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization {name: ""Accenture""})
RETURN a.title, a.sentiment
ORDER BY a.sentiment DESC
LIMIT 1",Simple Aggregation Queries,companies,False,False,False,
List the first 3 organizations that were mentioned in articles published in 2022.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.date >= date('2022-01-01') AND a.date <= date('2022-12-31')
RETURN o
LIMIT 3",Simple Aggregation Queries,companies,False,False,True,
Which organizations are competitors to 'SAP'?,"MATCH (o:Organization {name: ""SAP""})-[:HAS_COMPETITOR]->(competitor:Organization)
RETURN competitor",Simple Aggregation Queries,companies,False,False,False,
List the parents of 'David Correa'.,"MATCH (p:Person {name: ""David Correa""})-[:HAS_PARENT]->(parent:Person)
RETURN parent",Simple Aggregation Queries,companies,False,False,True,
Which cities are these organizations based in that have more than 50 employees but less than 200?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees > 50 AND o.nbrEmployees < 200
RETURN c.name AS CityName",Simple Aggregation Queries,companies,False,False,False,
List three persons who are both investors and board members in any organization.,"MATCH (p:Person)-[:HAS_INVESTOR]->(o:Organization)
WHERE exists{ (p)-[:HAS_BOARD_MEMBER]->(o) }
RETURN p.name
LIMIT 3",Simple Aggregation Queries,companies,False,False,True,
What organizations are mentioned in the article titled 'Funds for Consumer Behavior Specialist Infinite Analytics'?,"MATCH (a:Article {title: 'Funds for Consumer Behavior Specialist Infinite Analytics'})-[:MENTIONS]->(o:Organization)
RETURN o",Simple Aggregation Queries,companies,False,False,True,
How many organizations are there in the 'United States of America'?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: ""United States of America""})
RETURN count(o) AS NumberOfOrganizations",Simple Aggregation Queries,companies,False,False,True,
What are the first 5 cities by the number of organizations located there?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WITH c, count(o) AS orgCount
ORDER BY orgCount DESC
RETURN c.name, orgCount
LIMIT 5",Simple Aggregation Queries,companies,False,False,True,
Which organization has the highest number of employees?,"MATCH (o:Organization)
WHERE o.nbrEmployees IS NOT NULL
RETURN o
ORDER BY o.nbrEmployees DESC
LIMIT 1",Simple Aggregation Queries,companies,False,False,True,
What are the top 3 articles by sentiment that mention an organization with a revenue of over 1 billion?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.revenue > 1E9
RETURN a
ORDER BY a.sentiment DESC
LIMIT 3",Simple Aggregation Queries,companies,False,False,False,
Who are the investors of 'New Energy Group'?,"MATCH (o:Organization {name: ""New Energy Group""})<-[:HAS_INVESTOR]-(investor)
RETURN investor",Simple Aggregation Queries,companies,False,False,True,
List the top 5 articles mentioning 'Accenture'.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization {name: ""Accenture""})
RETURN a
ORDER BY a.date DESC
LIMIT 5",Simple Aggregation Queries,companies,False,False,True,
Which organizations have dissolved and are no longer operational?,"MATCH (o:Organization)
WHERE o.isDissolved = true
RETURN o",Simple Aggregation Queries,companies,False,False,True,
What organizations have 'Electronic Products Manufacturers' as their industry category?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Electronic Products Manufacturers""})
RETURN o",Simple Aggregation Queries,companies,False,False,True,
List all the subsidiary companies of 'Accenture'.,"MATCH (o:Organization {name: ""Accenture""})-[:HAS_SUBSIDIARY]->(subsidiary:Organization)
RETURN subsidiary",Simple Aggregation Queries,companies,False,False,True,
What are the first 3 cities that have organizations with more than 500 employees?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees > 500
RETURN c.name
LIMIT 3",Simple Aggregation Queries,companies,False,False,True,
Which organizations are suppliers to 'Accenture'?,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(supplier:Organization {name: 'Accenture'})
RETURN o.name AS OrganizationName",Simple Aggregation Queries,companies,False,False,True,
Which person has the most direct connections to other persons within the graph?,"MATCH (p:Person)
WITH p, count{(p)-[:HAS_PARENT|:HAS_CHILD]->(:Person)} AS connections
RETURN p.name, connections
ORDER BY connections DESC
LIMIT 1",Simple Aggregation Queries,companies,False,False,True,
What are the first 3 organizations mentioned in articles from 'MrWeb'?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.siteName = 'MrWeb'
RETURN o
LIMIT 3",Simple Aggregation Queries,companies,False,False,False,
Which organizations are both public and have a CEO named 'Julie Spellman Sweet'?,"MATCH (o:Organization {isPublic: true})-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""})
RETURN o",Simple Aggregation Queries,companies,False,False,False,
List the organizations that are public and have a CEO who is a female.,"MATCH (o:Organization {isPublic: true})-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'female'
RETURN o",Simple Aggregation Queries,companies,False,False,True,
Which organizations are headquartered in a city that is not in 'United States of America' and have a revenue of over 100 million?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE country.name <> 'United States of America' AND o.revenue > 100000000
RETURN o",Simple Aggregation Queries,companies,False,False,False,
Who are the top 3 investors in terms of the number of organizations they invest in?,"MATCH (p:Person)-[:HAS_INVESTOR]->(o:Organization)
WITH p, count(o) AS investments
ORDER BY investments DESC
LIMIT 3
RETURN p.name, investments",Simple Aggregation Queries,companies,False,False,True,
What is the name of the organization with the most board members?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WITH o, count(p) AS boardMemberCount
ORDER BY boardMemberCount DESC
LIMIT 1
RETURN o.name AS OrganizationName",Simple Aggregation Queries,companies,False,False,True,
Which person has the most children within the graph?,"MATCH (p:Person)
WITH p, count{(p)-[:HAS_CHILD]->()} AS childrenCount
RETURN p.name AS PersonName, childrenCount
ORDER BY childrenCount DESC
LIMIT 1",Simple Aggregation Queries,companies,False,False,True,
What is the name of the organization that has the highest number of employees and is headquartered in a city named 'Seattle'?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: 'Seattle'})
WHERE o.nbrEmployees IS NOT NULL
RETURN o.name AS OrganizationName, o.nbrEmployees AS NumberOfEmployees
ORDER BY o.nbrEmployees DESC
LIMIT 1",Simple Aggregation Queries,companies,False,False,True,
List the first 3 organizations that were mentioned in articles with a sentiment less than 0.5.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment < 0.5
RETURN o
LIMIT 3",Simple Aggregation Queries,companies,False,False,True,
Which organizations have a city named 'Seattle' as their headquarters and more than 500 employees?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: 'Seattle'})
WHERE o.nbrEmployees > 500
RETURN o",Simple Aggregation Queries,companies,False,False,True,
List the organizations that have the most number of competitors.,"MATCH (o:Organization)
WITH o, count{(o)-[:HAS_COMPETITOR]->(:Organization)} AS competitors
RETURN o.name AS Organization, competitors
ORDER BY competitors DESC",Simple Aggregation Queries,companies,False,False,False,
Which articles mention any organizations that are suppliers to 'New Energy Group'?,"MATCH (o:Organization {name: ""New Energy Group""})<-[:HAS_SUPPLIER]-(supplier:Organization)
MATCH (article:Article)-[:MENTIONS]->(supplier)
RETURN article",Simple Aggregation Queries,companies,False,False,False,
Who are the children of CEOs who are also board members of other organizations?,"MATCH (ceo:Person)-[:HAS_CEO]->(org:Organization)
WHERE EXISTS {
  (ceo)-[:HAS_BOARD_MEMBER]->(:Organization)
}
MATCH (ceo)-[:HAS_CHILD]->(child:Person)
RETURN ceo.name AS CEOName, org.name AS Organization, child.name AS ChildName",Simple Aggregation Queries,companies,False,False,True,
Which organization has the most subsidiaries and what is its name?,"MATCH (o:Organization)
WHERE EXISTS {(o)-[:HAS_SUBSIDIARY]->(:Organization)}
WITH o, count{(o)-[:HAS_SUBSIDIARY]->()} AS numSubsidiaries
RETURN o.name AS OrganizationName, numSubsidiaries
ORDER BY numSubsidiaries DESC
LIMIT 1",Simple Aggregation Queries,companies,False,False,True,
What are the first 3 organizations that have been mentioned in an article with a sentiment score greater than 0.9?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment > 0.9
RETURN o
LIMIT 3",Simple Aggregation Queries,companies,False,False,True,
Who are the CEOs of the top 5 organizations by revenue?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
RETURN o.name AS Organization, p.name AS CEO
ORDER BY o.revenue DESC
LIMIT 5",Simple Aggregation Queries,companies,False,False,True,
Which countries have organizations with a revenue less than 10 million?,"MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country)
WHERE o.revenue < 10000000
RETURN DISTINCT c.name",Simple Aggregation Queries,companies,False,False,True,
What are the names of organizations that have at least 2 board members?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WITH o, count(p) AS boardMembersCount
WHERE boardMembersCount >= 2
RETURN o.name AS OrganizationName",Simple Aggregation Queries,companies,False,False,True,
List the organizations that have less than 50 employees and are still operational.,"MATCH (o:Organization)
WHERE o.nbrEmployees < 50 AND o.isDissolved = false
RETURN o",Simple Aggregation Queries,companies,False,False,True,
Which organizations have a city as their headquarters and have a revenue of over 1 million?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.revenue > 1000000
RETURN o, c",Simple Aggregation Queries,companies,False,False,False,
List the first 5 articles mentioning organizations that have a CEO named 'Julie Spellman Sweet'.,"MATCH (o:Organization)-[:HAS_CEO]->(:Person {name: ""Julie Spellman Sweet""})<-[:MENTIONS]-(a:Article)
RETURN a
LIMIT 5",Simple Aggregation Queries,companies,False,False,True,
"Which organizations have more than 10,000 employees and are located in a country outside of 'United States of America'?","MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE o.nbrEmployees > 10000 AND country.name <> 'United States of America'
RETURN o",Simple Aggregation Queries,companies,False,False,False,
Who are the investors of organizations that have been dissolved?,"MATCH (o:Organization {isDissolved: true})<-[:HAS_INVESTOR]-(investor)
RETURN o.name AS OrganizationName, investor.name AS InvestorName",Simple Aggregation Queries,companies,False,False,True,
Which organization has the highest revenue and is not public?,"MATCH (o:Organization)
WHERE o.isPublic = false AND o.revenue IS NOT NULL
RETURN o
ORDER BY o.revenue DESC
LIMIT 1",Simple Aggregation Queries,companies,False,False,True,
List the latest 3 articles mentioning any organization based in 'Rome'.,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Rome""})
MATCH (a:Article)-[:MENTIONS]->(o)
RETURN a
ORDER BY a.date DESC
LIMIT 3",Simple Aggregation Queries,companies,False,False,True,
What are the top 3 industries by the number of organizations in each?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(i:IndustryCategory)
WITH i.name AS Industry, count(o) AS NumberOfOrganizations
ORDER BY NumberOfOrganizations DESC
RETURN Industry, NumberOfOrganizations
LIMIT 3",Simple Aggregation Queries,companies,False,False,True,
Which cities have more than two industries represented by organizations within them?,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)-[:HAS_CATEGORY]->(ind:IndustryCategory)
WITH c, count(DISTINCT ind) AS numIndustries
WHERE numIndustries > 2
RETURN c.name AS City, numIndustries AS IndustriesCount",Simple Aggregation Queries,companies,False,False,True,
List the top 5 countries by the number of organizations headquartered there.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WITH country, count(o) AS orgCount
ORDER BY orgCount DESC
LIMIT 5
RETURN country.name AS Country, orgCount AS NumberOfOrganizations",Simple Aggregation Queries,companies,False,False,True,
What is the summary description of the organization with the lowest number of employees?,"MATCH (o:Organization)
WHERE o.nbrEmployees IS NOT NULL
RETURN o.summary AS SummaryDescription
ORDER BY o.nbrEmployees ASC
LIMIT 1",Simple Aggregation Queries,companies,False,False,True,
Name the top 3 organizations in terms of number of times they are mentioned as competitors in different industries.,"MATCH (o:Organization)-[:HAS_COMPETITOR]->(competitor:Organization)
WITH competitor, count(DISTINCT o) AS mentions
ORDER BY mentions DESC
RETURN competitor.name, mentions
LIMIT 3",Pathfinding Queries,companies,False,False,False,
Who are the board members of 'New Energy Group'?,"MATCH (o:Organization {name: ""New Energy Group""})-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN p.name AS BoardMemberName",Simple Aggregation Queries,companies,False,False,False,
Which 3 organizations have CEOs who have written articles about their own organizations?,"MATCH (org:Organization)-[:HAS_CEO]->(ceo:Person)-[:AUTHORED]->(article:Article)-[:MENTIONS]->(mentionedOrg)
WHERE org.id = mentionedOrg.id
RETURN org.name AS Organization, ceo.name AS CEO, article.title AS ArticleTitle
LIMIT 3",Pathfinding Queries,companies,False,False,True,AUTHORED
Name the first 3 organizations that have been mentioned in articles about cybersecurity.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS 'cybersecurity'
MATCH (a)-[:MENTIONS]->(o:Organization)
RETURN o.name AS OrganizationName
LIMIT 3",Pathfinding Queries,companies,False,False,False,
Name the cities that are mentioned in articles about organizations in the 'Software' industry.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk), (a)-[:MENTIONS]->(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Software""})
MATCH (o)-[:IN_CITY]->(city:City)
RETURN DISTINCT city.name",Complex Aggregation Queries,companies,False,False,True,
List the organizations that have been mentioned in articles related to security threats.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS 'security threats'
RETURN o.name AS OrganizationName, collect(a.title) AS ArticleTitles",Complex Aggregation Queries,companies,False,False,False,
Which persons are investors in organizations that have a revenue over 100 million?,"MATCH (p:Person)-[:HAS_INVESTOR]->(o:Organization)
WHERE o.revenue > 100000000
RETURN p",Complex Aggregation Queries,companies,False,False,True,
What are the names of organizations that have both public and private subsidiaries?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(publicSub:Organization {isPublic: true}),
      (o)-[:HAS_SUBSIDIARY]->(privateSub:Organization {isPublic: false})
WHERE publicSub <> privateSub
RETURN DISTINCT o.name AS OrganizationName",Complex Aggregation Queries,companies,True,False,False,
Identify organizations that have more than 3 board members.,"MATCH (o:Organization)
WHERE size{(o)-[:HAS_BOARD_MEMBER]->(:Person)} > 3
RETURN o",Complex Aggregation Queries,companies,False,False,True,
Which organizations have been mentioned in the most negative sentiment articles?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment < 0
RETURN o.name, count(a) AS NegativeMentions
ORDER BY NegativeMentions DESC",Complex Aggregation Queries,companies,False,False,True,
Name the industry categories that have the most organizations associated with them.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory)
WITH ic, count(o) AS numOrganizations
ORDER BY numOrganizations DESC
RETURN ic.name, numOrganizations",Complex Aggregation Queries,companies,False,False,True,
List all the organizations and their respective CEOs who are mentioned in the same article.,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person), (a:Article)-[:MENTIONS]->(o)
RETURN o.name AS Organization, ceo.name AS CEO, a.title AS ArticleTitle",Complex Aggregation Queries,companies,False,False,True,
Which organizations have the most articles mentioning them?,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
RETURN o.name, count(a) AS mentions
ORDER BY mentions DESC",Complex Aggregation Queries,companies,False,False,True,
What are the names of organizations that have at least three categories associated with them?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory)
WITH o, count(c) AS numCategories
WHERE numCategories >= 3
RETURN o.name AS OrganizationName",Complex Aggregation Queries,companies,False,False,False,
Identify all organizations that have a motto containing the word 'security'.,"MATCH (o:Organization)
WHERE o.motto CONTAINS 'security'
RETURN o",Complex Aggregation Queries,companies,False,False,True,
Which organizations are based in cities not in the 'United States of America'?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE country.name <> 'United States of America'
RETURN o",Complex Aggregation Queries,companies,False,False,True,
What is the revenue of the subsidiaries of 'Accenture'?,"MATCH (o:Organization {name: ""Accenture""})-[:HAS_SUBSIDIARY]->(subsidiary:Organization)
RETURN subsidiary.name AS SubsidiaryName, subsidiary.revenue AS Revenue",Complex Aggregation Queries,companies,False,False,False,
Name the children of 'Julie Spellman Sweet'.,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_CHILD]->(child:Person)
RETURN child",Complex Aggregation Queries,companies,False,False,True,
What are the names and summaries of organizations mentioned in articles with a high sentiment score (>0.9)?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment > 0.9
RETURN o.name AS OrganizationName, o.summary AS OrganizationSummary",Complex Aggregation Queries,companies,False,False,True,
Which articles mention organizations with a revenue less than 10 million?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.revenue < 10000000
RETURN a",Complex Aggregation Queries,companies,False,False,True,
Identify the organizations with the highest revenue in the 'Electronic Products Manufacturers' industry.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Electronic Products Manufacturers""})
RETURN o.name AS OrganizationName, o.revenue AS Revenue
ORDER BY o.revenue DESC",Complex Aggregation Queries,companies,False,False,True,
Which organizations are both suppliers and competitors to other organizations?,"MATCH (o1:Organization)-[:HAS_SUPPLIER]->(o2:Organization)
WHERE exists{ (o1)-[:HAS_COMPETITOR]->(o2) }
RETURN o1.name AS SupplierAndCompetitor, o2.name AS CompetingSupplier",Complex Aggregation Queries,companies,False,False,True,
List the top 5 organizations by number of employees.,"MATCH (o:Organization)
WHERE o.nbrEmployees IS NOT NULL
RETURN o
ORDER BY o.nbrEmployees DESC
LIMIT 5",Complex Aggregation Queries,companies,False,False,True,
What are the names of organizations that have at least one investor but no subsidiaries?,"MATCH (o:Organization)
WHERE EXISTS { (o)<-[:HAS_INVESTOR]-() }
AND NOT EXISTS { (o)-[:HAS_SUBSIDIARY]->() }
RETURN o.name",Complex Aggregation Queries,companies,False,False,True,
Name the organizations that are suppliers to 'Accenture'.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(supplier:Organization {name: ""Accenture""})
RETURN o.name AS OrganizationName",Complex Aggregation Queries,companies,False,False,True,
Which organizations are investors in more than two other organizations?,"MATCH (o:Organization)-[:HAS_INVESTOR]->(invested:Organization)
WITH o, count(invested) AS investments
WHERE investments > 2
RETURN o",Complex Aggregation Queries,companies,False,False,True,
What is the summary of the country where 'Seattle' is located?,"MATCH (c:City {name: ""Seattle""})-[:IN_COUNTRY]->(country:Country)
RETURN country.summary AS CountrySummary",Complex Aggregation Queries,companies,False,False,True,
List the persons who have at least two children recorded in the schema.,"MATCH (p:Person)-[:HAS_CHILD]->(child:Person)
WITH p, count(child) AS childrenCount
WHERE childrenCount >= 2
RETURN p",Complex Aggregation Queries,companies,False,False,False,
Which organizations are mentioned in articles published after 2020?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.date >= date('2021-01-01')
RETURN o",Complex Aggregation Queries,companies,False,False,True,
Name articles authored by 'David Correa' that mention any technology companies.,"MATCH (a:Article {author: ""David Correa""})-[:MENTIONS]->(o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory)
WHERE c.name CONTAINS ""Technology""
RETURN a.title, a.date, a.summary",Complex Aggregation Queries,companies,False,False,False,
List the organizations that have their CEOs also serving as board members in other organizations.,"MATCH (ceo:Person)-[:HAS_CEO]->(org:Organization)
MATCH (ceo)-[:HAS_BOARD_MEMBER]->(otherOrg:Organization)
RETURN org.name AS Organization, ceo.name AS CEO, otherOrg.name AS BoardMemberOf",Complex Aggregation Queries,companies,False,False,True,
What are the names of cities that host organizations with a public status?,"MATCH (o:Organization {isPublic: true})-[:IN_CITY]->(c:City)
RETURN DISTINCT c.name",Complex Aggregation Queries,companies,False,False,True,
List the organizations that have the most investors.,"MATCH (o:Organization)
WITH o, count{(o)-[:HAS_INVESTOR]->()} AS investorCount
RETURN o.name, investorCount
ORDER BY investorCount DESC",Complex Aggregation Queries,companies,False,False,False,
Name the top 3 organizations by revenue within the 'Financial Services' category.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: ""Financial Services""})
WHERE o.revenue IS NOT NULL
RETURN o.name, o.revenue
ORDER BY o.revenue DESC
LIMIT 3",Complex Aggregation Queries,companies,False,False,True,
List the organizations that have more than one category associated with them.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory)
WITH o, count(c) AS numCategories
WHERE numCategories > 1
RETURN o",Complex Aggregation Queries,companies,False,False,False,
Name the organizations that have changed their CEO in the past year.,"MATCH (o:Organization)-[r:HAS_CEO]->(p1:Person)
WHERE r.startDate >= date({year: date().year - 1})
AND NOT EXISTS {
    (o)-[:HAS_CEO {endDate: r.startDate}]->(p2:Person)
    WHERE p1 <> p2
}
RETURN o.name AS Organization, p1.name AS CurrentCEO",Complex Aggregation Queries,companies,False,True,False,"HAS_CEO.endDate, HAS_CEO.startDate"
Which organizations have been mentioned in articles with a sentiment score lower than 0.5?,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk), (a)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment < 0.5
RETURN o.name, a.title, a.sentiment",Complex Aggregation Queries,companies,False,False,True,
List the top 5 cities by number of public organizations.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.isPublic = true
RETURN c.name, count(o) AS NumberOfPublicOrganizations
ORDER BY NumberOfPublicOrganizations DESC
LIMIT 5",Complex Aggregation Queries,companies,False,False,False,
Name the organizations with the most board members who are also CEOs of other organizations.,"MATCH (o:Organization)<-[:HAS_BOARD_MEMBER]-(p:Person)
WHERE exists{ (p)-[:HAS_CEO]->(:Organization) }
RETURN o.name AS Organization, count(p) AS NumberOfBoardMembersWhoAreCEOs
ORDER BY NumberOfBoardMembersWhoAreCEOs DESC",Complex Aggregation Queries,companies,False,False,False,
Which organizations have CEOs who have been in their position for less than 3 years?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'CEO' AND p.summary ENDS WITH 'for less than 3 years'
RETURN o.name AS OrganizationName, p.name AS CEOName, p.summary AS CEOSummary",Complex Aggregation Queries,companies,False,False,True,
List the organizations that have both a high revenue and a high number of employees.,"MATCH (o:Organization)
WHERE o.revenue > 1E8 AND o.nbrEmployees > 1000
RETURN o",Complex Aggregation Queries,companies,False,False,False,
Identify organizations that have undergone a merger in the last 5 years.,"MATCH (o:Organization)
WHERE EXISTS {
    (o)-[:HAS_MERGED_WITH]->(:Organization)
    WHERE o.mergerDate >= date({years: date().year - 5})
}
RETURN o",Complex Aggregation Queries,companies,False,False,True,HAS_MERGED_WITH
Which organizations have a CEO who is also an investor in other organizations?,"MATCH (org:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE EXISTS {
  (ceo)-[:HAS_INVESTOR]->(:Organization)
}
RETURN org",Complex Aggregation Queries,companies,False,False,False,
Name the industry categories for organizations that have been mentioned in articles about environmental issues.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS ""environmental issues""
MATCH (a)-[:MENTIONS]->(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory)
RETURN ic.name AS IndustryCategory",Complex Aggregation Queries,companies,False,False,True,
"Which organizations are based in a city with a population less than 100,000?","MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE c.population < 100000
RETURN o",Complex Aggregation Queries,companies,False,False,False,City.population
List the articles that mention organizations headquartered in 'Seattle'.,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Seattle""})
MATCH (a:Article)-[:MENTIONS]->(o)
RETURN a",Complex Aggregation Queries,companies,False,False,True,
Which organizations have a board member named 'David Correa'?,"MATCH (p:Person {name: ""David Correa""})-[:HAS_BOARD_MEMBER]->(o:Organization)
RETURN o",Complex Aggregation Queries,companies,False,False,False,
Identify the organizations that have the most subsidiaries.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)
RETURN o.name AS Organization, count(sub) AS NumberOfSubsidiaries
ORDER BY NumberOfSubsidiaries DESC",Complex Aggregation Queries,companies,False,False,False,
List the board members of organizations in the 'Healthcare' industry.,"MATCH (org:Organization)-[:HAS_CATEGORY]->(cat:IndustryCategory {name: ""Healthcare""})
MATCH (org)-[:HAS_BOARD_MEMBER]->(person:Person)
RETURN org.name AS Organization, person.name AS BoardMember",Complex Aggregation Queries,companies,False,False,True,
Identify the organizations that have been dissolved but still mentioned in recent articles.,"MATCH (o:Organization {isDissolved: true})-[:MENTIONS]-(a:Article)
WHERE a.date >= date('2023-01-01')
RETURN o.name, a.title, a.date",Complex Aggregation Queries,companies,False,False,True,
Name the CEOs of the top 5 organizations by number of employees.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE o.nbrEmployees IS NOT NULL
RETURN o.name AS Organization, p.name AS CEO
ORDER BY o.nbrEmployees DESC
LIMIT 5",Complex Aggregation Queries,companies,False,False,True,
Which organizations have the most suppliers?,"MATCH (o:Organization)
WHERE EXISTS { (o)-[:HAS_SUPPLIER]->(:Organization) }
RETURN o.name, count{(o)-[:HAS_SUPPLIER]->(:Organization)} AS NumberOfSuppliers
ORDER BY NumberOfSuppliers DESC",Complex Aggregation Queries,companies,False,False,False,
List the cities that have organizations with a revenue exceeding 500 million.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.revenue > 500000000
RETURN DISTINCT c.name",Complex Aggregation Queries,companies,False,False,False,
Name the organizations that are headquartered in cities known for their technology industry.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE EXISTS {
    (c)-[:IN_COUNTRY]->(:Country)-[:HAS_INDUSTRY]->(:IndustryCategory {name: ""Technology""})
}
RETURN o.name AS OrganizationName, c.name AS CityName",Complex Aggregation Queries,companies,False,False,False,HAS_INDUSTRY
Which organizations have been investors in 'New Energy Group'?,"MATCH (o:Organization {name: ""New Energy Group""})<-[:HAS_INVESTOR]-(investor:Organization)
RETURN investor",Complex Aggregation Queries,companies,False,False,False,
List the organizations that are public and have more than one CEO.,"MATCH (o:Organization {isPublic: true})-[:HAS_CEO]->(p:Person)
WITH o, count(p) AS ceoCount
WHERE ceoCount > 1
RETURN o",Complex Aggregation Queries,companies,False,False,False,
What are the names of organizations that have been competitors for more than 10 years?,"MATCH (o:Organization)-[r:HAS_COMPETITOR]->(competitor:Organization)
WHERE r.since IS NOT NULL AND date() - r.since >= duration({years: 10})
RETURN o.name AS OrganizationName, competitor.name AS CompetitorName",Complex Aggregation Queries,companies,False,False,False,HAS_COMPETITOR.since
Identify the organizations where 'Julie Spellman Sweet' is a board member.,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_BOARD_MEMBER]->(o:Organization)
RETURN o",Complex Aggregation Queries,companies,False,False,True,
Which organizations have a CEO who has written an article?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)-[:AUTHORED]->(a:Article)
RETURN o.name AS Organization, p.name AS CEO, a.title AS ArticleTitle",Complex Aggregation Queries,companies,False,False,True,AUTHORED
List the organizations that have been mentioned in the most articles.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WITH o, count(a) AS mentions
RETURN o.name, mentions
ORDER BY mentions DESC",Complex Aggregation Queries,companies,False,False,True,
Which countries have the most cities with public organizations?,"MATCH (c:City)-[:IN_COUNTRY]->(country:Country)
WHERE EXISTS {
    (c)<-[:IN_CITY]-(o:Organization)
    WHERE o.isPublic = true
}
RETURN country.name, count(c) AS cityCount
ORDER BY cityCount DESC",Complex Aggregation Queries,companies,False,False,True,
Identify articles with a sentiment score above 0.8.,"MATCH (a:Article)
WHERE a.sentiment > 0.8
RETURN a",Complex Aggregation Queries,companies,False,True,False,
What are the names of organizations with suppliers that have a revenue above 50 million?,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(supplier:Organization)
WHERE supplier.revenue > 50000000
RETURN o.name AS OrganizationName",Complex Aggregation Queries,companies,False,False,False,
Which organizations have competitors also based in the same country?,"MATCH (o1:Organization)-[:HAS_COMPETITOR]->(o2:Organization)
MATCH (o1)-[:IN_CITY]->(c1:City)-[:IN_COUNTRY]->(country:Country)
MATCH (o2)-[:IN_CITY]->(c2:City)-[:IN_COUNTRY]->(country)
RETURN o1.name AS Organization, o2.name AS Competitor, country.name AS Country",Complex Aggregation Queries,companies,False,False,True,
List the names of the first 3 organizations that have a public commitment to diversity and inclusion.,"MATCH (o:Organization)
WHERE exists{(o)-[:HAS_CATEGORY]->(:IndustryCategory {name: ""Diversity and Inclusion""})} AND o.isPublic = true
RETURN o.name
LIMIT 3",Pathfinding Queries,companies,False,False,False,
Which 3 organizations have the most subsidiaries in different industries?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)-[:HAS_CATEGORY]->(cat:IndustryCategory)
WITH o, count(DISTINCT cat) AS distinctIndustries
ORDER BY distinctIndustries DESC
RETURN o.name AS Organization, distinctIndustries
LIMIT 3",Pathfinding Queries,companies,True,False,False,
Name the first 3 organizations that have a CEO who has authored a book on leadership.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)-[:AUTHORED]->(b:Book {topic: ""Leadership""})
RETURN o.name AS OrganizationName
LIMIT 3",Pathfinding Queries,companies,False,False,True,Book
Name the first 3 organizations that have a CEO who has authored a book on leadership.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)-[:AUTHORED]->(b:Book {topic: ""Leadership""})
RETURN o.name AS OrganizationName
LIMIT 3",Pathfinding Queries,companies,False,False,True,AUTHORED
Name the first 3 organizations that have a CEO who has authored a book on leadership.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)-[:AUTHORED]->(b:Book {topic: ""Leadership""})
RETURN o.name AS OrganizationName
LIMIT 3",Pathfinding Queries,companies,False,False,True,Book.topic
List the first 3 articles that mention organizations with a significant number of layoffs in the past year.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE exists {
  (o)-[:HAS_EVENT]->(e:Event {type: 'Layoff'})
  AND e.date >= date({years: date().year - 1})
}
RETURN a
LIMIT 3",Pathfinding Queries,companies,False,False,False,
Which 3 organizations have been featured in the most articles about market expansions?,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.summary CONTAINS 'market expansion'
WITH o, count(a) AS articlesCount
ORDER BY articlesCount DESC
LIMIT 3
RETURN o.name, articlesCount",Pathfinding Queries,companies,False,False,False,
Name the top 3 organizations in terms of revenue that are headquartered in countries with developing economies.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE country.summary CONTAINS 'developing economy' AND o.revenue IS NOT NULL
RETURN o.name AS Organization, o.revenue AS Revenue
ORDER BY o.revenue DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
List the names of 3 organizations that have at least one female board member.,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WHERE p.gender = 'female'
RETURN o.name
LIMIT 3",Pathfinding Queries,companies,False,False,False,Person.gender
Which 3 cities are most frequently cited in articles about urban development?,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS ""urban development""
WITH a
MATCH (a)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(city:City)
RETURN city.name, count(a) AS mentions
ORDER BY mentions DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Name the first 3 organizations that have been involved in mergers in the past 5 years.,"MATCH (o:Organization)-[r:HAS_MERGED_WITH]->(:Organization)
WHERE r.date >= date({years: date().year - 5})
RETURN o.name AS OrganizationName
LIMIT 3",Pathfinding Queries,companies,False,False,True,HAS_MERGED_WITH
Name the first 3 organizations that have been involved in mergers in the past 5 years.,"MATCH (o:Organization)-[r:HAS_MERGED_WITH]->(:Organization)
WHERE r.date >= date({years: date().year - 5})
RETURN o.name AS OrganizationName
LIMIT 3",Pathfinding Queries,companies,False,False,True,HAS_MERGED_WITH.date
List the names of 3 organizations that have a motto related to sustainability.,"MATCH (o:Organization)
WHERE o.motto CONTAINS ""sustainability""
RETURN o.name
LIMIT 3",Pathfinding Queries,companies,False,False,False,
Which 3 organizations have the most articles mentioning them with a sentiment score below 0.3?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment < 0.3
WITH o, count(a) AS mentions
ORDER BY mentions DESC
LIMIT 3
RETURN o.name, mentions",Pathfinding Queries,companies,False,False,True,
Name the top 3 countries by number of organizations that have been mentioned in articles related to healthcare.,"MATCH (c:Country)<-[:IN_COUNTRY]-(city:City)<-[:IN_CITY]-(o:Organization)-[:MENTIONS]-(a:Article)
WHERE EXISTS { (o)-[:HAS_CATEGORY]->(:IndustryCategory {name: ""Healthcare""}) }
RETURN c.name AS Country, count(o) AS NumberOfMentions
ORDER BY NumberOfMentions DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Name the top 3 organizations with the most mentions in articles about technology innovation.,"MATCH (o:Organization)-[:MENTIONS]-(a:Article)
WHERE exists{ (a)-[:HAS_CHUNK]->(c:Chunk) WHERE c.text CONTAINS ""technology innovation"" }
RETURN o.name, count(a) AS mentions
ORDER BY mentions DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
"List the names of the first 3 organizations that have more than 10,000 employees.","MATCH (o:Organization)
WHERE o.nbrEmployees > 10000
RETURN o.name
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Name the first 3 organizations that have both a CEO and a board member from the same family.,"MATCH (org:Organization)-[:HAS_CEO]->(ceo:Person)-[:HAS_PARENT|HAS_CHILD*]-(familyMember:Person)-[:HAS_BOARD_MEMBER]-(sameOrg:Organization)
WHERE org.id = sameOrg.id
RETURN org.name AS OrganizationName, ceo.name AS CEOName, familyMember.name AS BoardMemberName
LIMIT 3",Pathfinding Queries,companies,False,False,False,
List the top 3 articles that focus on the impact of technology on education.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS ""technology"" AND c.text CONTAINS ""education""
RETURN a
ORDER BY a.date DESC
LIMIT 3",Pathfinding Queries,companies,False,False,False,
Which 3 organizations have the longest history of continuous operation according to their founding dates in the database?,"MATCH (o:Organization)
WHERE o.foundingDate IS NOT NULL
RETURN o
ORDER BY o.foundingDate ASC
LIMIT 3",Pathfinding Queries,companies,False,False,False,Organization.foundingDate
Name the first 3 organizations that are headquartered in capital cities and are in the telecommunications industry.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE EXISTS {
  (c)-[:IS_CAPITAL_OF]->(country)
} AND EXISTS {
  (o)-[:HAS_CATEGORY]->(:IndustryCategory {name: ""Telecommunications""})
}
RETURN o
LIMIT 3",Pathfinding Queries,companies,False,False,False,IS_CAPITAL_OF
List the names of organizations that have a CEO and an investor who are siblings.,"MATCH (org:Organization)-[:HAS_CEO]->(ceo:Person),
      (org)-[:HAS_INVESTOR]->(investor:Person)
WHERE (ceo)-[:HAS_SIBLING]-(investor)
RETURN org.name AS OrganizationName",Pathfinding Queries,companies,False,False,False,HAS_SIBLING
Which 3 cities have the most organizations in the food industry?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Food Industry""})
WITH o
MATCH (o)-[:IN_CITY]->(c:City)
RETURN c.name, count(o) AS numOrganizations
ORDER BY numOrganizations DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Name the top 3 organizations with CEOs who have been in their position for over a decade.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'CEO for over 10 years'
RETURN o.name AS OrganizationName, p.name AS CEOName
ORDER BY o.revenue DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
List the names of the first 3 organizations that have invested in startups in the past year.,"MATCH (o:Organization)-[:HAS_INVESTOR]->(s:Organization)
WHERE s.isPublic IS NOT NULL AND s.isPublic = true
RETURN o.name
LIMIT 3",Pathfinding Queries,companies,False,False,False,
Which 3 organizations have the most diverse range of industry categories they belong to?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory)
WITH o, count(DISTINCT ic) AS numCategories
ORDER BY numCategories DESC
LIMIT 3
RETURN o.name, numCategories",Pathfinding Queries,companies,False,False,False,
Name the top 3 cities by number of organizations that are involved in environmental technology.,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Environmental Technology""})
WITH c, count(o) AS orgCount
ORDER BY orgCount DESC
LIMIT 3
RETURN c.name AS City, orgCount AS NumberOfOrganizations",Pathfinding Queries,companies,False,False,False,
List the names of the first 3 organizations that have a CEO with a PhD.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'PhD'
RETURN o.name
LIMIT 3",Pathfinding Queries,companies,False,False,False,
Which 3 organizations are the most frequent collaborators in joint ventures?,"MATCH (o1:Organization)-[:HAS_PARTNER]->(o2:Organization)
WITH o1, o2, count(*) AS collaborations
ORDER BY collaborations DESC
RETURN o1.name AS Organization1, o2.name AS Organization2, collaborations
LIMIT 3",Pathfinding Queries,companies,False,False,False,HAS_PARTNER
Which 3 organizations have been involved in the most legal disputes according to articles?,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.title CONTAINS ""legal dispute""
RETURN o.name, count(a) AS disputes
ORDER BY disputes DESC
LIMIT 3",Pathfinding Queries,companies,False,False,False,
Which 3 organizations have a CEO who has won international business awards?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE exists{ (p)-[:HAS_AWARD]->(:Award {type: 'International Business'}) }
RETURN o
LIMIT 3",Pathfinding Queries,companies,False,False,False,Award
Which 3 organizations have a CEO who has won international business awards?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE exists{ (p)-[:HAS_AWARD]->(:Award {type: 'International Business'}) }
RETURN o
LIMIT 3",Pathfinding Queries,companies,False,False,False,HAS_AWARD
Which 3 organizations have a CEO who has won international business awards?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE exists{ (p)-[:HAS_AWARD]->(:Award {type: 'International Business'}) }
RETURN o
LIMIT 3",Pathfinding Queries,companies,False,False,False,Award.type
List the names of 3 organizations that have undergone a major rebranding in the last decade.,"MATCH (o:Organization)
WHERE o.summary CONTAINS ""rebranding"" AND o.isDissolved IS NOT NULL
RETURN o.name
LIMIT 3",Pathfinding Queries,companies,False,False,False,
Name the first 3 organizations that have a parent company with a revenue over $1 billion.,"MATCH (child:Organization)-[:HAS_PARENT]->(parent:Organization)
WHERE parent.revenue > 1E9
RETURN child.name
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Name persons who are board members of more than three organizations.,"MATCH (p:Person)-[:HAS_BOARD_MEMBER]->(o:Organization)
WITH p, count(o) AS orgCount
WHERE orgCount > 3
RETURN p.name AS BoardMember, orgCount",Complex Aggregation Queries,companies,False,False,True,
List all organizations that have subsidiaries.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)
RETURN DISTINCT o",Complex Aggregation Queries,companies,False,False,True,
Which cities have more than 10 organizations based in them?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WITH c, count(o) AS orgCount
WHERE orgCount > 10
RETURN c.name AS CityName, orgCount",Complex Aggregation Queries,companies,False,False,True,
What are the names of industry categories that have associated organizations with more than 100 employees?,"MATCH (ic:IndustryCategory)<-[:HAS_CATEGORY]-(o:Organization)
WHERE o.nbrEmployees > 100
RETURN DISTINCT ic.name",Complex Aggregation Queries,companies,False,False,True,
Identify organizations that have been dissolved.,"MATCH (o:Organization)
WHERE o.isDissolved = true
RETURN o",Complex Aggregation Queries,companies,False,False,False,
Which organizations are public and are based in cities within the United States of America?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE o.isPublic = true AND country.name = ""United States of America""
RETURN o",Complex Aggregation Queries,companies,False,False,True,
List the names of persons who are CEOs of organizations with more than 500 employees.,"MATCH (p:Person)-[:HAS_CEO]->(o:Organization)
WHERE o.nbrEmployees > 500
RETURN p.name",Complex Aggregation Queries,companies,False,False,True,
What are the names of organizations that have a revenue greater than 100 million?,"MATCH (o:Organization)
WHERE o.revenue > 100000000
RETURN o.name",Complex Aggregation Queries,companies,False,False,True,
Which 3 organizations have been mentioned the most in articles about financial crises?,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS 'financial crises'
WITH a
MATCH (a)-[:MENTIONS]->(o:Organization)
RETURN o.name, count(a) AS mentions
ORDER BY mentions DESC
LIMIT 3",Pathfinding Queries,companies,False,False,False,
Name the top 3 organizations with the most subsidiaries according to the database.,"MATCH (o:Organization)
WITH o, count{(o)-[:HAS_SUBSIDIARY]->(:Organization)} AS numSubsidiaries
ORDER BY numSubsidiaries DESC
LIMIT 3
RETURN o.name AS Organization, numSubsidiaries",Pathfinding Queries,companies,False,False,False,
List the names of 3 organizations that have been involved in major international trade deals in the past year.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""International Trade""})
WHERE EXISTS {
    (o)-[:PARTICIPATED_IN]->(:TradeDeal {date: date() - duration('P1Y')})
}
RETURN o.name
LIMIT 3",Pathfinding Queries,companies,False,False,False,TradeDeal
List the names of 3 organizations that have been involved in major international trade deals in the past year.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""International Trade""})
WHERE EXISTS {
    (o)-[:PARTICIPATED_IN]->(:TradeDeal {date: date() - duration('P1Y')})
}
RETURN o.name
LIMIT 3",Pathfinding Queries,companies,False,False,False,PARTICIPATED_IN
List the names of 3 organizations that have been involved in major international trade deals in the past year.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""International Trade""})
WHERE EXISTS {
    (o)-[:PARTICIPATED_IN]->(:TradeDeal {date: date() - duration('P1Y')})
}
RETURN o.name
LIMIT 3",Pathfinding Queries,companies,False,False,False,TradeDeal.date
Which 3 organizations have the most patents filed according to the database?,"MATCH (o:Organization)-[:HAS_PATENT]->(p:Patent)
RETURN o.name, count(p) AS patentCount
ORDER BY patentCount DESC
LIMIT 3",Pathfinding Queries,companies,False,False,False,Patent
Which 3 organizations have the most patents filed according to the database?,"MATCH (o:Organization)-[:HAS_PATENT]->(p:Patent)
RETURN o.name, count(p) AS patentCount
ORDER BY patentCount DESC
LIMIT 3",Pathfinding Queries,companies,False,False,False,HAS_PATENT
Name the first 3 organizations that have a board member who has been a government advisor.,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WHERE exists{ (p)-[:HAS_ROLE]->(:Role {name: 'Government Advisor'}) }
RETURN o.name AS OrganizationName
LIMIT 3",Pathfinding Queries,companies,False,False,True,Role
Name the first 3 organizations that have a board member who has been a government advisor.,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WHERE exists{ (p)-[:HAS_ROLE]->(:Role {name: 'Government Advisor'}) }
RETURN o.name AS OrganizationName
LIMIT 3",Pathfinding Queries,companies,False,False,True,HAS_ROLE
Name the first 3 organizations that have a board member who has been a government advisor.,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WHERE exists{ (p)-[:HAS_ROLE]->(:Role {name: 'Government Advisor'}) }
RETURN o.name AS OrganizationName
LIMIT 3",Pathfinding Queries,companies,False,False,True,Role.name
List the names of the first 3 organizations that have a CEO who is also a significant philanthropist.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE exists{(p)-[:IS_PHILANTHROPIST]->()}
RETURN o.name
LIMIT 3",Pathfinding Queries,companies,False,False,True,IS_PHILANTHROPIST
Which 3 organizations have been consistently mentioned in articles about corporate social responsibility?,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.summary CONTAINS ""corporate social responsibility""
WITH o, count(a) AS mentions
ORDER BY mentions DESC
LIMIT 3
RETURN o.name, mentions",Pathfinding Queries,companies,False,False,False,
Name the top 3 organizations in terms of environmental impact according to articles.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.summary CONTAINS ""environmental impact""
RETURN o.name, count(a) AS mentions
ORDER BY mentions DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
List the names of the first 3 organizations that have a significant influence in the media industry.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Media""})
WHERE EXISTS { (a:Article)-[:MENTIONS]->(o) }
RETURN o.name
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Which 3 organizations have the most diverse geographical distribution of subsidiaries?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(s:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WITH o, count(DISTINCT country) AS countriesCount
ORDER BY countriesCount DESC
LIMIT 3
RETURN o.name AS OrganizationName, countriesCount",Pathfinding Queries,companies,False,False,False,
Name the first 3 organizations that have been involved in a public scandal according to articles.,"MATCH (o:Organization)-[:MENTIONS]-(a:Article)
WHERE a.summary CONTAINS ""scandal""
RETURN o.name, o.id
LIMIT 3",Pathfinding Queries,companies,False,False,True,
List the names of 3 organizations that have a CEO who has been featured in a major business magazine.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)-[:MENTIONED_IN]->(a:Article)
WHERE a.siteName IN ['Forbes', 'Business Insider', 'The Economist', 'Bloomberg']
RETURN o.name AS OrganizationName
LIMIT 3",Pathfinding Queries,companies,False,False,False,MENTIONED_IN
Which 3 organizations have the most detailed corporate histories available in the database?,"MATCH (o:Organization)
WHERE o.summary IS NOT NULL
RETURN o.name, o.summary
ORDER BY size(o.summary) DESC
LIMIT 3",Pathfinding Queries,companies,False,False,False,
Name the top 3 articles that mention organizations affected by global economic changes.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE exists {
  (o)-[:HAS_CATEGORY]->(:IndustryCategory {name: ""Global Economic Changes""})
}
RETURN a.title, a.date, a.sentiment
ORDER BY a.date DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
List the names of the first 3 organizations that have announced significant technological breakthroughs in the past year.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.date >= date({year: date().year - 1, month: date().month, day: date().day})
  AND a.summary CONTAINS ""technological breakthroughs""
RETURN o.name
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Which 3 organizations have the most complex supply chains according to the database?,"MATCH (o:Organization)
WHERE EXISTS { (o)-[:HAS_SUPPLIER]->(:Organization) }
RETURN o.name, count{(o)-[:HAS_SUPPLIER]->()} AS supplierCount
ORDER BY supplierCount DESC
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Name the first 3 organizations that are involved in more than one industry category and have subsidiaries in at least two different countries.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory)
WITH o, count(DISTINCT ic) AS numCategories
WHERE numCategories > 1
MATCH (o)-[:HAS_SUBSIDIARY]->(sub:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WITH o, count(DISTINCT country) AS numCountries
WHERE numCountries >= 2
RETURN o
LIMIT 3",Pathfinding Queries,companies,False,False,False,
List the names of the first 3 articles that discuss changes in corporate governance.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS ""corporate governance""
RETURN a.title
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Which 3 countries have the highest number of organizations involved in the energy sector?,"MATCH (c:Country)<-[:IN_CITY]-(:City)<-[:IN_CITY]-(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Energy""})
WITH c, count(o) AS orgCount
ORDER BY orgCount DESC
LIMIT 3
RETURN c.name AS Country, orgCount AS NumberOfOrganizations",Pathfinding Queries,companies,False,False,True,
List the names of 3 organizations that have subsidiaries in more than 3 countries.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WITH o, count(DISTINCT country) AS countries
WHERE countries > 3
RETURN o.name
LIMIT 3",Pathfinding Queries,companies,False,False,True,
Which organizations are public and have a revenue of over 500 million?,"MATCH (o:Organization)
WHERE o.isPublic = true AND o.revenue > 500000000
RETURN o",Simple Aggregation Queries,companies,False,False,True,
What are the top 5 organizations in terms of revenue?,"MATCH (o:Organization)
WHERE o.revenue IS NOT NULL
RETURN o
ORDER BY o.revenue DESC
LIMIT 5",Simple Aggregation Queries,companies,False,False,True,
List the first 3 organizations that have more than 1000 employees.,"MATCH (o:Organization)
WHERE o.nbrEmployees > 1000
RETURN o
LIMIT 3",Simple Aggregation Queries,companies,False,False,False,
List the organizations that have been mentioned in articles about environmental issues.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS 'environmental'
MATCH (a)-[:MENTIONS]->(o:Organization)
RETURN o",Simple Aggregation Queries,companies,False,False,True,
Which organizations have a CEO who has written an article?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)-[:AUTHORED]->(a:Article)
RETURN o.name AS Organization, p.name AS CEO, a.title AS ArticleTitle",Simple Aggregation Queries,companies,False,False,False,AUTHORED
List the top 5 cities by the number of organizations based there.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WITH c, count(o) AS orgCount
ORDER BY orgCount DESC
LIMIT 5
RETURN c.name AS City, orgCount AS NumberOfOrganizations",Simple Aggregation Queries,companies,False,False,False,
Which organizations have a parent organization with a higher revenue?,"MATCH (childOrg:Organization)-[:HAS_PARENT]->(parentOrg:Organization)
WHERE parentOrg.revenue > childOrg.revenue
RETURN childOrg.name AS ChildOrganization, parentOrg.name AS ParentOrganization, parentOrg.revenue AS ParentRevenue, childOrg.revenue AS ChildRevenue",Simple Aggregation Queries,companies,True,False,False,
List the organizations that have a summary mentioning 'software' and are in the tech industry category.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: ""Tech""})
WHERE o.summary CONTAINS 'software'
RETURN o",Simple Aggregation Queries,companies,False,False,False,
Which organizations have changed their CEO in the last 5 years according to articles?,"MATCH (o:Organization)-[:HAS_CEO]->(p1:Person)<-[:MENTIONS]-(a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE a.date >= date({years: date().year - 5})
AND EXISTS {
    MATCH (o)-[:HAS_CEO]->(p2:Person)
    WHERE p1 <> p2 AND a.date >= p2.startDate
}
RETURN o.name AS Organization, p1.name AS PreviousCEO, p2.name AS CurrentCEO, a.date AS ChangeDate",Simple Aggregation Queries,companies,False,False,True,Person.startDate
List the persons who are both investors and board members in the same organization.,"MATCH (p:Person)-[:HAS_INVESTOR]->(o:Organization)<-[:HAS_BOARD_MEMBER]-(p)
RETURN p.name AS PersonName, o.name AS OrganizationName",Simple Aggregation Queries,companies,False,False,True,
Which organizations have subsidiaries in more than three different cities?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)-[:IN_CITY]->(c:City)
WITH o, count(DISTINCT c) AS citiesCount
WHERE citiesCount > 3
RETURN o.name AS Organization, citiesCount",Simple Aggregation Queries,companies,False,False,True,
List the organizations that are investors in more than one other organization.,"MATCH (o:Organization)-[:HAS_INVESTOR]->(investor:Organization)
WITH investor, count(o) AS investments
WHERE investments > 1
RETURN investor",Simple Aggregation Queries,companies,False,False,False,
Who are the children of persons who are CEOs of public organizations?,"MATCH (org:Organization {isPublic: true})-[:HAS_CEO]->(p:Person)
MATCH (p)-[:HAS_CHILD]->(child:Person)
RETURN p.name AS CEO_Name, collect(child.name) AS Children_Names",Simple Aggregation Queries,companies,False,False,True,
Which organizations have a revenue decrease mentioned in any articles?,"MATCH (o:Organization)-[:MENTIONS]-(a:Article)
WHERE a.summary CONTAINS ""revenue decrease""
RETURN o.name, o.id, a.title, a.date",Simple Aggregation Queries,companies,False,False,False,
List the organizations that are mentioned in the most articles.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
RETURN o.name, count(a) AS mentions
ORDER BY mentions DESC",Simple Aggregation Queries,companies,False,False,False,
Which organizations are involved in legal disputes according to articles?,"MATCH (o:Organization)-[:MENTIONED_IN]->(a:Article)
WHERE a.summary CONTAINS ""legal dispute""
RETURN o.name, a.title, a.date",Simple Aggregation Queries,companies,False,False,True,MENTIONED_IN
Which organizations have their headquarters in a city that is also the country's capital?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE c.name = country.capital
RETURN o.name AS OrganizationName, c.name AS CityName, country.name AS CountryName",Simple Aggregation Queries,companies,False,False,False,Country.capital
List the organizations that have a CEO named 'Julie Spellman Sweet'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""})
RETURN o",Simple Aggregation Queries,companies,False,False,True,
Which organizations have foreign investors (investors from a different country)?,"MATCH (o:Organization)<-[:HAS_INVESTOR]-(p:Person)-[:LIVES_IN]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE NOT EXISTS {
    (o)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(country)
}
RETURN DISTINCT o.name AS OrganizationName, country.name AS InvestorCountry",Simple Aggregation Queries,companies,False,False,True,LIVES_IN
List the articles that mention both public and private organizations.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.isPublic IS NOT NULL
WITH a, collect(o.isPublic) AS publicStatuses
WHERE ALL(status IN publicStatuses WHERE status = TRUE) OR ALL(status IN publicStatuses WHERE status = FALSE)
RETURN a",Simple Aggregation Queries,companies,False,False,True,
Which articles published in 2022 mention organizations with more than 100 employees?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.date.year = 2022 AND o.nbrEmployees > 100
RETURN a",Simple Aggregation Queries,companies,False,False,True,
List the top 5 articles by sentiment that mention organizations based in California.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: ""United States of America""})
WHERE c.name = ""California"" AND a.sentiment IS NOT NULL
RETURN a
ORDER BY a.sentiment DESC
LIMIT 5",Simple Aggregation Queries,companies,False,False,False,
Which organizations have a motto and are based in cities in the United States?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: ""United States of America""})
WHERE o.motto IS NOT NULL
RETURN o.name, o.motto, c.name",Simple Aggregation Queries,companies,False,False,True,
What are the names of organizations that have suppliers also mentioned in articles?,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(supplier:Organization)
WHERE EXISTS {
  MATCH (supplier)-[:MENTIONS]->(:Article)
}
RETURN DISTINCT o.name AS OrganizationName",Simple Aggregation Queries,companies,False,False,True,
Which organizations have 'Electronic Products Manufacturers' as their industry category?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Electronic Products Manufacturers""})
RETURN o",Simple Aggregation Queries,companies,False,False,False,
List the cities where organizations with more than 500 employees are based.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees > 500
RETURN DISTINCT c.name",Simple Aggregation Queries,companies,False,False,True,
Which organizations are competitors of 'New Energy Group'?,"MATCH (o:Organization {name: ""New Energy Group""})-[:HAS_COMPETITOR]->(competitor:Organization)
RETURN competitor",Simple Aggregation Queries,companies,False,False,True,
Who are the CEOs of organizations that have subsidiaries?,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE exists{(o)-[:HAS_SUBSIDIARY]->(:Organization)}
RETURN o.name AS OrganizationName, ceo.name AS CEOName",Simple Aggregation Queries,companies,False,False,True,
Which organizations have a revenue greater than 100 million and are not public?,"MATCH (o:Organization)
WHERE o.revenue > 100000000 AND o.isPublic = FALSE
RETURN o",Simple Aggregation Queries,companies,False,False,True,
Who are the board members of organizations that have more than 1000 employees?,"MATCH (o:Organization) WHERE o.nbrEmployees > 1000
MATCH (o)-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN o.name AS Organization, p.name AS BoardMember",Simple Aggregation Queries,companies,False,False,True,
What are the names of the organizations dissolved and were founded in Sydney?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Sydney""})
WHERE o.isDissolved = true
RETURN o.name",Simple Aggregation Queries,companies,False,True,False,
Who are the investors in organizations that have a motto mentioning 'innovation'?,"MATCH (o:Organization)-[:HAS_INVESTOR]->(investor)
WHERE o.motto CONTAINS 'innovation'
RETURN DISTINCT investor",Simple Aggregation Queries,companies,False,False,True,
Which organizations have a supplier based in a different country?,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(supplier:Organization)-[:IN_CITY]->(city:City)-[:IN_COUNTRY]->(country:Country),
      (o)-[:IN_CITY]->(oCity:City)-[:IN_COUNTRY]->(oCountry:Country)
WHERE country.name <> oCountry.name
RETURN o.name AS OrganizationName, supplier.name AS SupplierName, country.name AS SupplierCountry, oCountry.name AS OrganizationCountry",Simple Aggregation Queries,companies,False,False,True,
Name the first 3 cities in which organizations with more than 1000 employees are located.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees > 1000
RETURN c.name
LIMIT 3",Simple Retrieval Queries,companies,False,False,False,
Which countries are mentioned in the latest 5 articles about organizations in the electronic products industry?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Electronic Products Manufacturers""})
WITH a
ORDER BY a.date DESC
LIMIT 5
MATCH (a)-[:HAS_CHUNK]->(c:Chunk)
MATCH (city:City)-[:IN_COUNTRY]->(country:Country)
WHERE c.text CONTAINS country.name
RETURN DISTINCT country.name AS CountryMentioned",Simple Retrieval Queries,companies,False,False,True,
Name 3 organizations mentioned in articles written by David Correa.,"MATCH (a:Article {author: ""David Correa""})-[:HAS_CHUNK]->(c:Chunk)-[:MENTIONS]->(o:Organization)
RETURN o.name AS OrganizationName
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Which organizations have more than 500 employees and are located in Seattle?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Seattle""})
WHERE o.nbrEmployees > 500
RETURN o",Simple Retrieval Queries,companies,False,False,True,
What are the names of the first 3 organizations with a motto?,"MATCH (o:Organization)
WHERE o.motto IS NOT NULL
RETURN o.name
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
List the top 5 suppliers of Accenture.,"MATCH (o:Organization {name: ""Accenture""})-[:HAS_SUPPLIER]->(supplier:Organization)
RETURN supplier
ORDER BY supplier.name
LIMIT 5",Simple Retrieval Queries,companies,False,False,False,
Which organizations have a sentiment score higher than 0.8 in their latest article?,"MATCH (o:Organization)-[:MENTIONS]-(a:Article)
WHERE a.sentiment > 0.8
WITH o, a ORDER BY a.date DESC
RETURN DISTINCT o.name AS Organization, a.title AS ArticleTitle, a.date AS ArticleDate, a.sentiment AS SentimentScore",Simple Retrieval Queries,companies,False,False,True,
What are the first 3 companies that are competitors of New Energy Group?,"MATCH (o:Organization {name: ""New Energy Group""})-[:HAS_COMPETITOR]->(competitor:Organization)
RETURN competitor
LIMIT 3",Simple Retrieval Queries,companies,False,False,False,
List the first 3 subsidiaries of Accenture.,"MATCH (o:Organization {name: ""Accenture""})-[:HAS_SUBSIDIARY]->(subsidiary:Organization)
RETURN subsidiary
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Who are the children of Julie Spellman Sweet?,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_CHILD]->(child:Person)
RETURN child",Simple Retrieval Queries,companies,False,False,True,
What are the top 3 most recent articles mentioning Deja vu Security?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization {name: ""Deja vu Security""})
RETURN a
ORDER BY a.date DESC
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
List the countries where the top 5 organizations by revenue are based.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE o.revenue IS NOT NULL
RETURN country.name AS Country, max(o.revenue) AS Revenue
ORDER BY Revenue DESC
LIMIT 5",Simple Retrieval Queries,companies,False,False,True,
List the organizations that have a subsidiary that was dissolved.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(subsidiary:Organization)
WHERE subsidiary.isDissolved = true
RETURN o.name AS OrganizationName, subsidiary.name AS DissolvedSubsidiaryName",Simple Aggregation Queries,companies,False,False,False,
What are the industry categories for the first 5 organizations with more than 100 employees?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory)
WHERE o.nbrEmployees > 100
RETURN o.name, ic.name
LIMIT 5",Simple Retrieval Queries,companies,False,False,True,
Who are the board members of New Energy Group?,"MATCH (o:Organization {name: ""New Energy Group""})-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN p.name AS BoardMemberName",Simple Retrieval Queries,companies,False,False,True,
What are the names of the first 5 organizations dissolved and publicly traded?,"MATCH (o:Organization)
WHERE o.isDissolved = true AND o.isPublic = true
RETURN o.name
ORDER BY o.id
LIMIT 5",Simple Retrieval Queries,companies,False,False,False,
List the top 3 cities where organizations with a revenue of more than 100 million are located.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.revenue > 100000000
RETURN c.name, count(o) AS NumberOfOrganizations
ORDER BY NumberOfOrganizations DESC
LIMIT 3",Simple Retrieval Queries,companies,False,False,False,
Which organizations have Julie Spellman Sweet as their CEO?,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_CEO]->(o:Organization)
RETURN o",Simple Retrieval Queries,companies,False,False,False,
Which organizations are based in cities with a population of more than one million people according to city summaries?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE c.summary CONTAINS ""population of more than one million""
RETURN o.name AS OrganizationName, c.name AS CityName",Simple Aggregation Queries,companies,False,False,False,
List organizations that have a philanthropic foundation as an investor.,"MATCH (o:Organization)-[:HAS_INVESTOR]->(investor:Organization {name: ""Philanthropic Foundation""})
RETURN o",Simple Aggregation Queries,companies,False,False,True,
Which organizations have a CEO who has authored more than three articles?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE exists {
  MATCH (p)-[:AUTHORED]->(a:Article)
}
WITH o, p, count{(p)-[:AUTHORED]->(a:Article)} AS articlesCount
WHERE articlesCount > 3
RETURN o.name AS OrganizationName, p.name AS CEOName, articlesCount",Simple Aggregation Queries,companies,False,False,False,AUTHORED
List the organizations that have undergone a merger or acquisition according to articles.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.summary CONTAINS ""merger"" OR a.summary CONTAINS ""acquisition""
RETURN o.name, a.title, a.date",Simple Aggregation Queries,companies,False,False,True,
Which organizations have a female CEO and are in the healthcare industry category?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {gender: 'Female'}), (o)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Healthcare'})
RETURN o.name AS OrganizationName, p.name AS CEOName",Simple Aggregation Queries,companies,False,False,False,Person.gender
List articles that mention organizations headquartered in Seattle.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(c:City {name: ""Seattle""})
RETURN a",Simple Aggregation Queries,companies,False,False,True,
Which CEOs have led an organization for more than 10 years?,"MATCH (p:Person)-[r:HAS_CEO]->(o:Organization)
WHERE r.since IS NOT NULL AND date() - r.since >= duration({years: 10})
RETURN p.name AS CEO_Name, o.name AS Organization_Name, r.since AS Start_Date",Simple Aggregation Queries,companies,False,False,False,HAS_CEO.since
List the organizations that have more than three competitors.,"MATCH (o:Organization)
WHERE count{(o)-[:HAS_COMPETITOR]->(:Organization)} > 3
RETURN o",Simple Aggregation Queries,companies,False,False,True,
Can you name 3 people who are both investors and CEOs of different organizations?,"MATCH (p:Person)-[:HAS_CEO]->(org1:Organization), (p)-[:HAS_INVESTOR]->(org2:Organization)
WHERE org1.id <> org2.id
RETURN p.name
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
List the top 5 organizations by revenue that are based in Rome.,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Rome""})
WHERE o.revenue IS NOT NULL
RETURN o
ORDER BY o.revenue DESC
LIMIT 5",Simple Aggregation Queries,companies,False,False,True,
Which organizations are public and have more than 300 employees?,"MATCH (o:Organization)
WHERE o.isPublic = true AND o.nbrEmployees > 300
RETURN o",Simple Aggregation Queries,companies,False,False,True,
Which organizations have subsidiaries and are located in countries outside the United States?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE NOT country.name = ""United States of America"" AND exists{(o)-[:HAS_SUBSIDIARY]->(:Organization)}
RETURN o",Complex Retrieval Queries,companies,False,False,True,
List the first 3 organizations that have a city as their headquarters and are also public.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.isPublic = true
RETURN o, c
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
What are the names of the first 3 organizations with the most competitors?,"MATCH (o:Organization)
WITH o, count{(o)-[:HAS_COMPETITOR]->(:Organization)} AS competitors
ORDER BY competitors DESC
LIMIT 3
RETURN o.name AS OrganizationName",Simple Retrieval Queries,companies,False,False,True,
Who are the first 3 board members of organizations that are public?,"MATCH (o:Organization {isPublic: true})-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN o.name AS Organization, p.name AS BoardMember
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
List the first 3 organizations that have a revenue greater than $100 million but fewer than 500 employees.,"MATCH (o:Organization)
WHERE o.revenue > 100000000 AND o.nbrEmployees < 500
RETURN o
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
List the first 3 organizations that were dissolved but mentioned in recent articles.,"MATCH (o:Organization)-[:MENTIONS]-(a:Article)
WHERE o.isDissolved = true
RETURN o, a
ORDER BY a.date DESC
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Which organizations are based in cities that are part of a country with the summary containing 'North America'?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE country.summary CONTAINS 'North America'
RETURN o",Simple Retrieval Queries,companies,False,False,True,
List the names of the first 3 organizations that have suppliers.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(:Organization)
RETURN o.name
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
What are the titles of the first 5 articles that mention organizations in 'Rome'?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(c:City {name: 'Rome'})
RETURN a.title
LIMIT 5",Simple Retrieval Queries,companies,False,False,False,
List the top 3 most recent articles about organizations in the 'Electronic Products Manufacturers' industry.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Electronic Products Manufacturers""})
RETURN a
ORDER BY a.date DESC
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Who are the first 3 persons mentioned as CEOs of organizations in the technology industry?,"MATCH (p:Person)-[:HAS_CEO]->(o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: ""Technology""})
RETURN p.name AS CEO_Name
LIMIT 3",Simple Retrieval Queries,companies,False,False,False,
Which organizations have a public status and are located in cities within the 'United States of America'?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: ""United States of America""})
WHERE o.isPublic IS NOT NULL AND o.isPublic = true
RETURN o",Simple Retrieval Queries,companies,False,False,False,
List the top 3 people who are investors in more than one organization.,"MATCH (p:Person)-[:HAS_INVESTOR]->(o:Organization)
WITH p, count(o) AS numOrgs
WHERE numOrgs > 1
RETURN p.name, numOrgs
ORDER BY numOrgs DESC
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Find the first 3 people who have the role of CEO in more than one organization.,"MATCH (p:Person)-[:HAS_CEO]->(o:Organization)
WITH p, count(o) AS numOrgs
WHERE numOrgs > 1
RETURN p
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Find the top 5 organizations by revenue that are not dissolved.,"MATCH (o:Organization)
WHERE o.isDissolved = false AND o.revenue IS NOT NULL
RETURN o
ORDER BY o.revenue DESC
LIMIT 5",Simple Retrieval Queries,companies,False,False,True,
Which organizations have the highest number of subsidiaries and what are their names?,"MATCH (o:Organization)
WHERE EXISTS {(o)-[:HAS_SUBSIDIARY]->(:Organization)}
WITH o, count{(o)-[:HAS_SUBSIDIARY]->(:Organization)} AS numSubsidiaries
ORDER BY numSubsidiaries DESC
RETURN o.name AS OrganizationName, numSubsidiaries",Simple Retrieval Queries,companies,False,False,True,
List the names of the first 3 organizations that have subsidiaries.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization)
RETURN o.name
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Who are the authors of the first 5 articles that mention any organization headquartered in 'Seattle'?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: 'Seattle'})
MATCH (a:Article)-[:MENTIONS]->(o)
RETURN a.author AS Author
LIMIT 5",Simple Retrieval Queries,companies,False,False,True,
What are the names of the first 3 cities that have organizations with more than 100 employees?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees > 100
RETURN DISTINCT c.name
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
List the top 3 industries mentioned in articles about 'Accenture'.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization {name: ""Accenture""})-[:HAS_CATEGORY]->(ic:IndustryCategory)
RETURN ic.name, count(a) AS mentions
ORDER BY mentions DESC
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
List the names of the first 3 organizations that are competitors of 'Accenture'.,"MATCH (o:Organization {name: ""Accenture""})-[:HAS_COMPETITOR]->(competitor:Organization)
RETURN competitor.name
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Which organizations have 'Accenture' as an investor?,"MATCH (o:Organization)<-[:HAS_INVESTOR]-(investor:Organization {name: ""Accenture""})
RETURN o",Simple Retrieval Queries,companies,True,False,False,
Find the top 3 countries with the most cities hosting public organizations.,"MATCH (c:City)-[:IN_COUNTRY]->(country:Country)
WHERE EXISTS {
    (o:Organization)-[:IN_CITY]->(c)
    WHERE o.isPublic = true
}
RETURN country.name, count(c) AS numCities
ORDER BY numCities DESC
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Who are the board members of the first 5 organizations listed by revenue in descending order?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN o.name AS Organization, collect(p.name) AS BoardMembers
ORDER BY o.revenue DESC
LIMIT 5",Simple Retrieval Queries,companies,False,False,True,
List the first 3 organizations dissolved and their cities.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.isDissolved = true
RETURN o.name, c.name
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Which cities are home to organizations that have more than 500 employees?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees > 500
RETURN DISTINCT c.name",Simple Retrieval Queries,companies,False,False,False,
Find the top 5 articles with the highest sentiment score.,"MATCH (a:Article)
RETURN a
ORDER BY a.sentiment DESC
LIMIT 5",Simple Retrieval Queries,companies,False,False,True,
List the first 3 organizations mentioned in articles published in 2022.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.date >= date('2022-01-01') AND a.date <= date('2022-12-31')
RETURN o
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
List the names and IDs of the top 5 cities by the number of public organizations located in them.,"MATCH (o:Organization {isPublic: true})-[:IN_CITY]->(c:City)
WITH c, count(o) AS numOrgs
ORDER BY numOrgs DESC
LIMIT 5
RETURN c.name AS CityName, c.id AS CityID",Simple Retrieval Queries,companies,False,False,True,
Who are the authors of the first 3 articles that negatively mention any organization?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment < 0
RETURN a.author AS Author
ORDER BY a.date ASC
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
List the names of the first 3 organizations that have had articles with a sentiment higher than 0.8.,"MATCH (o:Organization)-[:MENTIONS]-(a:Article)
WHERE a.sentiment > 0.8
RETURN o.name
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
"Find the top 5 organizations with a summary containing 'based in Dublin, Ireland'.","MATCH (o:Organization)
WHERE o.summary CONTAINS 'based in Dublin, Ireland'
RETURN o
ORDER BY o.revenue DESC
LIMIT 5",Complex Retrieval Queries,companies,False,False,True,
Which organizations have a CEO with the summary 'CEO at Accenture'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {summary: ""CEO at Accenture""})
RETURN o",Complex Retrieval Queries,companies,False,False,True,
List the names and summaries of articles that mention organizations with a revenue of at least $1 million.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.revenue >= 1000000
RETURN a.title AS ArticleTitle, a.summary AS ArticleSummary",Complex Retrieval Queries,companies,False,False,False,
Identify organizations that are both suppliers and investors to other organizations.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(org:Organization)
WHERE exists{ (o)-[:HAS_INVESTOR]->(org) }
RETURN o, org",Complex Retrieval Queries,companies,False,False,False,
Which organizations have an investor named 'David Correa'?,"MATCH (p:Person {name: ""David Correa""})-[:HAS_INVESTOR]->(o:Organization)
RETURN o",Complex Retrieval Queries,companies,False,False,True,
Find the organizations that are suppliers to 'New Energy Group' and their number of employees.,"MATCH (o:Organization {name: ""New Energy Group""})<-[:HAS_SUPPLIER]-(supplier:Organization)
RETURN supplier.name, supplier.nbrEmployees",Complex Retrieval Queries,companies,False,False,True,
Who are the board members of organizations with more than 300 employees?,"MATCH (o:Organization) WHERE o.nbrEmployees > 300
MATCH (o)-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN o.name AS Organization, p.name AS BoardMember",Complex Retrieval Queries,companies,False,False,True,
List the names and titles of articles mentioning organizations that have been dissolved.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.isDissolved = true
RETURN a.title AS ArticleTitle, a.summary AS ArticleSummary",Complex Retrieval Queries,companies,False,False,True,
What articles published in 2022 mention organizations based in Rome?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(c:City {name: ""Rome""})
WHERE a.date.year = 2022
RETURN a",Complex Retrieval Queries,companies,False,False,False,
Find the top 3 organizations that have a motto and are located in Seattle.,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Seattle""})
WHERE o.motto IS NOT NULL
RETURN o
ORDER BY o.revenue DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Which organizations are competitors of the 'New Energy Group'?,"MATCH (o:Organization {name: ""New Energy Group""})-[:HAS_COMPETITOR]->(competitor:Organization)
RETURN competitor",Complex Retrieval Queries,companies,False,False,True,
Which countries have cities that are home to more than three organizations?,"MATCH (c:City)-[:IN_COUNTRY]->(country:Country)
WHERE exists {
  (c)<-[:IN_CITY]-(o:Organization)
}
WITH country, count{(c)<-[:IN_CITY]-(o:Organization)} AS orgCount
WHERE orgCount > 3
RETURN country",Complex Retrieval Queries,companies,False,False,True,
List all organizations with the word 'Energy' in their name and their corresponding industry categories.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory)
WHERE o.name CONTAINS 'Energy'
RETURN o.name, ic.name",Complex Retrieval Queries,companies,False,False,True,
Who are the CEOs of organizations that have subsidiaries?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization)
MATCH (o)-[:HAS_CEO]->(ceo:Person)
RETURN o.name AS Organization, ceo.name AS CEO",Complex Retrieval Queries,companies,False,False,True,
Identify the top 3 articles with the highest sentiment that mention a public organization.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.isPublic = true
RETURN a
ORDER BY a.sentiment DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,False,
What are the names of the top 5 organizations with the most employees?,"MATCH (o:Organization)
WHERE o.nbrEmployees IS NOT NULL
RETURN o.name, o.nbrEmployees
ORDER BY o.nbrEmployees DESC
LIMIT 5",Complex Retrieval Queries,companies,False,False,True,
Find all organizations that are public and have a CEO named 'Julie Spellman Sweet'.,"MATCH (o:Organization {isPublic: true})-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""})
RETURN o",Complex Retrieval Queries,companies,False,False,True,
Which organizations have a revenue greater than $50 million and are not dissolved?,"MATCH (o:Organization)
WHERE o.revenue > 50000000 AND o.isDissolved = false
RETURN o",Complex Retrieval Queries,companies,False,False,True,
List the top 3 cities where organizations are based that have at least 100 employees.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees >= 100
RETURN c.name, count(o) AS NumberOfOrganizations
ORDER BY NumberOfOrganizations DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Who are the first 3 authors of articles mentioning organizations with revenues over $50 million?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.revenue > 50000000
RETURN DISTINCT a.author
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
List the first 3 cities that have more than three organizations based in them.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WITH c, count(o) AS orgCount
WHERE orgCount > 3
RETURN c.name AS CityName, orgCount
ORDER BY orgCount DESC
LIMIT 3",Simple Retrieval Queries,companies,False,False,False,
What are the names of the first 3 organizations and their CEOs where the organization is not public?,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE o.isPublic = false
RETURN o.name AS OrganizationName, ceo.name AS CEOName
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Which people are board members in organizations with more than 1000 employees?,"MATCH (p:Person)-[:HAS_BOARD_MEMBER]->(o:Organization)
WHERE o.nbrEmployees > 1000
RETURN p",Simple Retrieval Queries,companies,False,False,True,
List the first 3 organizations that are suppliers to more than one organization.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(supplier:Organization)
WITH supplier, count(DISTINCT o) AS numClients
WHERE numClients > 1
RETURN supplier
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
What are the names of the first 3 organizations that have a motto containing 'world'?,"MATCH (o:Organization)
WHERE o.motto CONTAINS 'world'
RETURN o.name
LIMIT 3",Simple Retrieval Queries,companies,False,False,False,
List the first 3 organizations that have more than one investor.,"MATCH (o:Organization)
WHERE count{(o)-[:HAS_INVESTOR]->()} > 1
RETURN o
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Which organizations have been mentioned in articles dated before 2020?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.date < date('2020-01-01')
RETURN o",Simple Retrieval Queries,companies,False,False,True,
Who are the first 3 people mentioned as board members in organizations headquartered in the United States of America?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: ""United States of America""})
MATCH (o)-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN p.name AS BoardMember, o.name AS Organization
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
List the first 3 articles mentioning organizations with a revenue less than 5 million.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.revenue < 5000000
RETURN a
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
What are the names of the first 3 organizations that have the same investor?,"MATCH (o1:Organization)<-[:HAS_INVESTOR]-(investor)-[:HAS_INVESTOR]->(o2:Organization)
WHERE o1 <> o2
RETURN o1.name AS Organization1, o2.name AS Organization2
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Which organizations have subsidiaries and are located in Paris?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Paris""})
WHERE exists{ (o)-[:HAS_SUBSIDIARY]->(:Organization) }
RETURN o",Simple Retrieval Queries,companies,False,False,True,
Who are the first 3 board members of organizations with revenues less than 5000000?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WHERE o.revenue < 5000000
RETURN o.name AS Organization, p.name AS BoardMember
LIMIT 3",Complex Retrieval Queries,companies,False,False,False,
Identify the top 3 organizations that have a CEO and are based in 'New York City'.,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""New York City""})
WHERE EXISTS {(o)-[:HAS_CEO]->(:Person)}
RETURN o
ORDER BY o.revenue DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,False,
Find the first 3 organizations that have a CEO named 'Julie Spellman Sweet' and are based in 'Seattle'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""}), (o)-[:IN_CITY]->(c:City {name: ""Seattle""})
RETURN o
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Which organizations have a revenue above 1 billion and are in the 'Technology' industry?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: ""Technology""})
WHERE o.revenue > 1000000000
RETURN o",Complex Retrieval Queries,companies,False,False,True,
List the first 3 articles mentioning organizations with more than 500 employees and a low sentiment score.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.nbrEmployees > 500 AND a.sentiment < 0.5
RETURN a
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Who are the first 3 CEOs of organizations that have subsidiaries and a revenue above 1 billion?,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE o.revenue > 1E9 AND EXISTS {(o)-[:HAS_SUBSIDIARY]->(:Organization)}
RETURN ceo
LIMIT 3",Complex Retrieval Queries,companies,False,False,False,
Identify the top 3 organizations that have been dissolved and are mentioned in high sentiment articles.,"MATCH (o:Organization)-[:MENTIONS]-(a:Article)
WHERE o.isDissolved = true AND a.sentiment > 0.5
RETURN o.name, o.id, a.title, a.sentiment
ORDER BY a.sentiment DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,False,
Find the first 3 articles mentioning organizations with a CEO named 'Julie Spellman Sweet' and a revenue above 500 million.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""})
WHERE o.revenue > 500000000
MATCH (a:Article)-[:MENTIONS]->(o)
RETURN a
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Which organizations have a CEO named 'Julie Spellman Sweet' and are based in 'Italy'?,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_CEO]->(o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: ""Italy""})
RETURN o",Complex Retrieval Queries,companies,False,False,True,
List the first 3 organizations with the most board members.,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WITH o, count(p) AS boardMembers
ORDER BY boardMembers DESC
LIMIT 3
RETURN o.name, boardMembers",Complex Retrieval Queries,companies,False,False,False,
Identify the top 3 organizations that have a public status and are based in 'Italy'.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: ""Italy""})
WHERE o.isPublic = true
RETURN o
ORDER BY o.revenue DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Find the first 3 articles that mention organizations in the 'Healthcare' industry with a high sentiment score.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Healthcare""})
WHERE a.sentiment > 0.5
RETURN a
ORDER BY a.sentiment DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,False,
List the first 3 organizations that have been mentioned in articles with a sentiment score above 0.9.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment > 0.9
RETURN o
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Which organizations have investors from 'Seattle'?,"MATCH (o:Organization)<-[:HAS_INVESTOR]-(p:Person)-[:LIVES_IN]->(c:City {name: 'Seattle'})
RETURN o",Complex Retrieval Queries,companies,False,False,True,LIVES_IN
Who are the first 3 investors in organizations that have a revenue greater than 500 million?,"MATCH (o:Organization)-[:HAS_INVESTOR]->(investor)
WHERE o.revenue > 500000000
RETURN investor
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Identify the first 3 organizations that have a CEO and are mentioned in articles with a low sentiment score.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person), (a:Article)-[:MENTIONS]->(o)
WHERE a.sentiment < 0.5
RETURN o, p, a
ORDER BY a.sentiment ASC
LIMIT 3",Complex Retrieval Queries,companies,False,False,False,
Find the top 3 organizations that have subsidiaries in more than one country.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WITH o, count(DISTINCT country) AS countries
WHERE countries > 1
RETURN o
ORDER BY countries DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,False,
Which organizations based in 'Seattle' have a CEO named 'Julie Spellman Sweet' and have a public status?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: 'Seattle'}),
      (o)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
WHERE o.isPublic = true
RETURN o",Complex Retrieval Queries,companies,False,False,True,
List the 3 most recent articles mentioning any organization with a CEO named 'Julie Spellman Sweet'.,"MATCH (ceo:Person {name: ""Julie Spellman Sweet""})-[:HAS_CEO]->(org:Organization)
MATCH (article:Article)-[:MENTIONS]->(org)
RETURN article
ORDER BY article.date DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Who are the first 3 competitors of organizations named 'Accenture'?,"MATCH (o:Organization {name: ""Accenture""})-[:HAS_COMPETITOR]->(competitor:Organization)
RETURN competitor
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Identify the top 3 cities with the most organizations in the 'Electronic Products Manufacturers' category.,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Electronic Products Manufacturers""})
WITH c, count(o) AS orgCount
ORDER BY orgCount DESC
LIMIT 3
RETURN c.name AS City, orgCount AS NumberOfOrganizations",Complex Retrieval Queries,companies,False,False,False,
Find the first 3 organizations that have been mentioned in articles authored by 'James Blackman'.,"MATCH (a:Article {author: ""James Blackman""})-[:MENTIONS]->(o:Organization)
RETURN o
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Which organizations have CEOs named 'Julie Spellman Sweet' and are in the 'Software' industry?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""})
WHERE EXISTS { (o)-[:HAS_CATEGORY]->(:IndustryCategory {name: ""Software""}) }
RETURN o",Complex Retrieval Queries,companies,False,False,False,
List the first 3 organizations with the highest number of employees that are not public.,"MATCH (o:Organization)
WHERE o.isPublic = false AND o.nbrEmployees IS NOT NULL
RETURN o
ORDER BY o.nbrEmployees DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Which organizations have more than 1000 employees and are in the 'Finance' industry?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: ""Finance""})
WHERE o.nbrEmployees > 1000
RETURN o",Complex Retrieval Queries,companies,True,False,False,
List the top 3 organizations that have been mentioned in articles with a sentiment score below 0.3.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment < 0.3
RETURN o.name, count(a) AS mentions
ORDER BY mentions DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
List the first 3 organizations with CEOs who have been mentioned in multiple articles.,"MATCH (org:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE exists {
  MATCH (ceo)-[:MENTIONED_IN]->(article:Article)
}
WITH org, count(article) AS mentions
WHERE mentions > 1
RETURN org
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,MENTIONED_IN
Which organizations have a CEO named 'Julie Spellman Sweet' and have subsidiaries named 'Icon Integration'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
WHERE EXISTS {
    (o)-[:HAS_SUBSIDIARY]->(:Organization {name: 'Icon Integration'})
}
RETURN o",Complex Retrieval Queries,companies,False,False,True,
Find the first 3 organizations based in 'Seattle' that have a public status and are not dissolved.,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Seattle""})
WHERE o.isPublic = true AND o.isDissolved = false
RETURN o
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Identify the first 3 organizations that have a subsidiary and a CEO named 'Julie Spellman Sweet'.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization), (o)-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""})
RETURN o
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Who is the CEO of an organization named 'Accenture'?,"MATCH (o:Organization {name: ""Accenture""})-[:HAS_CEO]->(ceo:Person)
RETURN ceo",Simple Aggregation Queries,companies,False,False,True,
Which organizations have a revenue greater than 100 million but less than 500 million?,"MATCH (o:Organization)
WHERE o.revenue > 100E6 AND o.revenue < 500E6
RETURN o",Simple Aggregation Queries,companies,False,False,False,
Identify the top 3 organizations that have been mentioned in articles authored by 'James Blackman'.,"MATCH (a:Article {author: 'James Blackman'})-[:MENTIONS]->(o:Organization)
RETURN o.name, count(a) AS mentions
ORDER BY mentions DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Find the first 3 organizations that have CEOs named 'Julie Spellman Sweet' and are based in 'Seattle'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""}), (o)-[:IN_CITY]->(c:City {name: ""Seattle""})
RETURN o
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Which organizations based in 'United States of America' have a public status and more than 1000 employees?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: ""United States of America""})
WHERE o.isPublic = true AND o.nbrEmployees > 1000
RETURN o",Complex Retrieval Queries,companies,False,False,True,
List the first 3 organizations that have been mentioned in articles with a sentiment score above 0.7 and have a CEO named 'Julie Spellman Sweet'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""})
WHERE EXISTS {
    (a:Article)-[:MENTIONS]->(o)
    WHERE a.sentiment > 0.7
}
RETURN o
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Who are the first 3 board members of organizations that have a CEO and are based in 'United States of America'?,"MATCH (org:Organization)-[:IN_CITY]->(city:City)-[:IN_COUNTRY]->(country:Country {name: ""United States of America""})
WHERE EXISTS { (org)-[:HAS_CEO]->(:Person) }
MATCH (org)-[:HAS_BOARD_MEMBER]->(person:Person)
RETURN org.name AS Organization, person.name AS BoardMember
LIMIT 3",Complex Retrieval Queries,companies,False,False,False,
Identify the top 3 organizations that have a CEO and have been mentioned in the latest articles with a high sentiment score.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person), (a:Article)-[:MENTIONS]->(o)
WHERE a.sentiment > 0.5
WITH o, a.date AS articleDate
ORDER BY articleDate DESC
RETURN o.name AS OrganizationName, o.summary AS OrganizationSummary
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Find the first 3 organizations that have a CEO named 'Julie Spellman Sweet' and have a revenue above 1 billion.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""})
WHERE o.revenue > 1E9
RETURN o
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Which organizations based in 'Seattle' have more than 1000 employees and are public?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Seattle""})
WHERE o.nbrEmployees > 1000 AND o.isPublic = true
RETURN o",Complex Retrieval Queries,companies,False,False,True,
List the first 3 articles mentioning organizations with a CEO named 'Julie Spellman Sweet' and have a sentiment score below 0.5.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""})
MATCH (a:Article)-[:MENTIONS]->(o)
WHERE a.sentiment < 0.5
RETURN a
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Who are the first 3 CEOs of organizations that have a public status and a revenue above 1 billion?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE o.isPublic = true AND o.revenue > 1E9
RETURN p.name AS CEO_Name, o.name AS Organization_Name
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Identify the top 3 organizations that have a CEO and more than 1000 employees.,"MATCH (o:Organization)-[:HAS_CEO]->(:Person)
WHERE o.nbrEmployees > 1000
RETURN o
ORDER BY o.nbrEmployees DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Find the first 3 organizations based in 'Italy' that have a public status and are not dissolved.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: ""Italy""})
WHERE o.isPublic = true AND o.isDissolved = false
RETURN o
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Which organizations have a CEO named 'Julie Spellman Sweet' and have been mentioned in articles with a sentiment score above 0.8?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""})
MATCH (a:Article)-[:MENTIONS]->(o)
WHERE a.sentiment > 0.8
RETURN o",Complex Retrieval Queries,companies,False,False,False,
List the first 3 organizations that have a public status and more than 500 employees.,"MATCH (o:Organization)
WHERE o.isPublic = true AND o.nbrEmployees > 500
RETURN o
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Who are the first 3 board members of organizations with a CEO named 'Julie Spellman Sweet' and a revenue above 500 million?,"MATCH (org:Organization)-[:HAS_CEO]->(ceo:Person {name: 'Julie Spellman Sweet'})
WHERE org.revenue > 500000000
MATCH (org)-[:HAS_BOARD_MEMBER]->(boardMember:Person)
RETURN org.name AS OrganizationName, collect(boardMember.name)[..3] AS BoardMembers",Complex Retrieval Queries,companies,False,False,True,
Identify the top 3 organizations that have more than 100 employees and are subsidiaries of 'Accenture'.,"MATCH (parent:Organization {name: ""Accenture""})-[:HAS_SUBSIDIARY]->(sub:Organization)
WHERE sub.nbrEmployees > 100
RETURN sub
ORDER BY sub.nbrEmployees DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,False,
Find the first 3 organizations based in 'Seattle' that have been mentioned in articles authored by 'David Correa'.,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Seattle""}),
      (a:Article {author: ""David Correa""})-[:MENTIONS]->(o)
RETURN o
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Which organizations have more than 1000 employees and are mentioned in articles with a sentiment score below 0.5?,"MATCH (o:Organization)-[:MENTIONS]->(a:Article)
WHERE o.nbrEmployees > 1000 AND a.sentiment < 0.5
RETURN o",Complex Retrieval Queries,companies,False,False,False,
List the first 3 organizations based in 'Italy' that have a CEO and are public.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: ""Italy""})
WHERE o.isPublic = true AND EXISTS {(o)-[:HAS_CEO]->(:Person)}
RETURN o
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Who are the first 3 competitors of organizations with a CEO named 'Julie Spellman Sweet'?,"MATCH (ceo:Person {name: 'Julie Spellman Sweet'})-[:HAS_CEO]->(org:Organization)
MATCH (org)-[:HAS_COMPETITOR]->(competitor:Organization)
RETURN competitor
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Identify the first 3 organizations that have the same investor and are based in 'Italy'.,"MATCH (o1:Organization)-[:HAS_INVESTOR]->(i:Person)<-[:HAS_INVESTOR]-(o2:Organization),
      (o1)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: ""Italy""})
WHERE o1 <> o2
RETURN o1.name AS Organization1, o2.name AS Organization2, i.name AS Investor
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Find the first 3 organizations that have CEOs named 'Julie Spellman Sweet' and are mentioned in articles with a sentiment score above 0.5.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""})
WHERE EXISTS {
    (o)<-[:MENTIONS]-(a:Article)
    WHERE a.sentiment > 0.5
}
RETURN o
LIMIT 3",Complex Retrieval Queries,companies,True,False,False,
Which organizations based in 'United States of America' have a revenue less than 10 million?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: ""United States of America""})
WHERE o.revenue < 10000000
RETURN o",Complex Retrieval Queries,companies,False,False,True,
List the top 3 organizations that have a CEO and have been mentioned in the most recent articles.,"MATCH (o:Organization)-[:HAS_CEO]->(:Person), (a:Article)-[:MENTIONS]->(o)
WHERE a.date IS NOT NULL
RETURN o.name, o.id, COUNT(a) AS mentions
ORDER BY a.date DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Who are the first 3 investors in organizations with less than 50 employees?,"MATCH (o:Organization)-[:HAS_INVESTOR]->(investor)
WHERE o.nbrEmployees < 50
RETURN investor
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Who are the first 3 board members of organizations based in 'Italy'?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: 'Italy'})
MATCH (o)-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN o.name AS Organization, p.name AS BoardMember
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Who are the CEOs of the first 3 public companies?,"MATCH (o:Organization {isPublic: true})-[:HAS_CEO]->(p:Person)
RETURN o.name AS CompanyName, p.name AS CEOName
LIMIT 3",Simple Retrieval Queries,companies,False,False,False,
Identify the first 3 articles where the organizations mentioned have more than 50 employees.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.nbrEmployees > 50
RETURN a
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Which organizations based in 'United States of America' have a CEO named 'Julie Spellman Sweet' and are not dissolved?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""}), (o)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: ""United States of America""})
WHERE o.isDissolved = false
RETURN o",Complex Retrieval Queries,companies,False,False,False,
Which 3 organizations have been dissolved and are mentioned in articles with a sentiment score below 0.5?,"MATCH (o:Organization)-[:MENTIONS]-(a:Article)
WHERE o.isDissolved = true AND a.sentiment < 0.5
RETURN o
LIMIT 3",Complex Retrieval Queries,companies,False,False,False,
Identify the top 3 countries with the most organizations in the 'Electronic Products Manufacturers' category.,"MATCH (c:Country)<-[:IN_CITY]-(:City)<-[:IN_CITY]-(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Electronic Products Manufacturers""})
WITH c, count(o) AS orgCount
ORDER BY orgCount DESC
LIMIT 3
RETURN c.name AS Country, orgCount AS NumberOfOrganizations",Complex Retrieval Queries,companies,False,False,True,
Which cities host organizations that are public and have a CEO named 'Julie Spellman Sweet'?,"MATCH (o:Organization {isPublic: true})-[:IN_CITY]->(c:City)
WHERE EXISTS {
    (o)-[:HAS_CEO]->(:Person {name: 'Julie Spellman Sweet'})
}
RETURN c.name AS CityName",Complex Retrieval Queries,companies,False,False,False,
Who are the first 3 board members of organizations with more than 100 million in revenue?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WHERE o.revenue > 100000000
RETURN o.name AS Organization, p.name AS BoardMember
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Which organizations have more than 50 employees and are in the 'Software' industry?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: ""Software""})
WHERE o.nbrEmployees > 50
RETURN o",Complex Retrieval Queries,companies,False,False,True,
What are the names of the organizations that have 'Icon Integration' as a subsidiary?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization {name: ""Icon Integration""})
RETURN o.name",Complex Retrieval Queries,companies,False,False,True,
List the first 3 organizations mentioned in articles authored by 'David Correa'.,"MATCH (a:Article {author: ""David Correa""})-[:MENTIONS]->(o:Organization)
RETURN o
LIMIT 3",Complex Retrieval Queries,companies,False,False,False,
Who are the first 3 CEOs of public organizations?,"MATCH (o:Organization {isPublic: true})-[:HAS_CEO]->(ceo:Person)
RETURN o.name AS Organization, ceo.name AS CEO
LIMIT 3",Complex Retrieval Queries,companies,False,False,False,
Which articles about 'New Energy Group' were published after 2020-01-01?,"MATCH (o:Organization {name: ""New Energy Group""})<-[:MENTIONS]-(a:Article)
WHERE a.date >= date('2020-01-01')
RETURN a",Complex Retrieval Queries,companies,False,False,True,
What are the names of the first 3 people who are investors in organizations based in 'Seattle'?,"MATCH (p:Person)-[:HAS_INVESTOR]->(o:Organization)-[:IN_CITY]->(c:City {name: 'Seattle'})
RETURN p.name
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Find the top 5 organizations that are competitors of 'Accenture'.,"MATCH (o:Organization {name: ""Accenture""})-[:HAS_COMPETITOR]->(competitor:Organization)
RETURN competitor
ORDER BY competitor.name
LIMIT 5",Complex Retrieval Queries,companies,False,False,False,
Which 5 articles mention 'Accenture' and have a sentiment score above 0.8?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization {name: ""Accenture""})
WHERE a.sentiment > 0.8
RETURN a
LIMIT 5",Complex Retrieval Queries,companies,False,False,True,
List the first 3 articles that mention any organization with more than 1000 employees and are written after 2021-01-01.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.nbrEmployees > 1000 AND a.date > date('2021-01-01')
RETURN a
ORDER BY a.date ASC
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
List the top 3 cities where 'Electronic Products Manufacturers' organizations are located.,"MATCH (org:Organization)-[:HAS_CATEGORY]->(cat:IndustryCategory {name: ""Electronic Products Manufacturers""})
MATCH (org)-[:IN_CITY]->(city:City)
RETURN city.name, count(org) AS NumberOfOrganizations
ORDER BY NumberOfOrganizations DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Identify the first 3 organizations that are public and have more than 1000 employees.,"MATCH (o:Organization)
WHERE o.isPublic = true AND o.nbrEmployees > 1000
RETURN o
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
What are the names of the first 3 organizations dissolved and have revenue greater than 10000000?,"MATCH (o:Organization)
WHERE o.isDissolved = true AND o.revenue > 10000000
RETURN o.name
ORDER BY o.revenue DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
List the top 5 industries where the organizations are based in 'Seattle'.,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Seattle""})
MATCH (o)-[:HAS_CATEGORY]->(ind:IndustryCategory)
RETURN ind.name, count(o) AS NumberOfOrganizations
ORDER BY NumberOfOrganizations DESC
LIMIT 5",Complex Retrieval Queries,companies,False,False,True,
Which organizations have a CEO named 'Julie Spellman Sweet'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
RETURN o",Complex Retrieval Queries,companies,False,False,False,
Which organizations are mentioned in articles with a sentiment higher than 0.5 and are based in Belgium?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: ""Belgium""})
WHERE a.sentiment > 0.5
RETURN o.name AS OrganizationName, o.id AS OrganizationID",Simple Retrieval Queries,companies,False,False,True,
Who are the parents of the first 3 persons listed as CEOs in publicly traded companies?,"MATCH (o:Organization {isPublic: true})-[:HAS_CEO]->(p:Person)
WITH p
ORDER BY p.id
LIMIT 3
MATCH (p)-[:HAS_PARENT]->(parent:Person)
RETURN p.name AS CEO_Name, parent.name AS Parent_Name",Simple Retrieval Queries,companies,False,False,True,
What are the names of the first 3 organizations that have been dissolved but still mentioned in recent articles?,"MATCH (o:Organization)-[:MENTIONS]-(a:Article)
WHERE o.isDissolved = true
RETURN o.name
LIMIT 3",Simple Retrieval Queries,companies,False,False,False,
List the first 3 countries where organizations with a public status are located.,"MATCH (o:Organization {isPublic: true})-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
RETURN DISTINCT country.name
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Name the first 3 organizations that have investments from Julie Spellman Sweet.,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_INVESTOR]->(o:Organization)
RETURN o
LIMIT 3",Simple Retrieval Queries,companies,False,False,True,
Which cities are the headquarters for the top 5 organizations by number of employees?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
RETURN c.name AS City, o.name AS Organization, o.nbrEmployees AS Employees
ORDER BY o.nbrEmployees DESC
LIMIT 5",Simple Retrieval Queries,companies,False,False,True,
Who are the first 3 CEOs of organizations that are dissolved?,"MATCH (o:Organization {isDissolved: true})-[:HAS_CEO]->(p:Person)
RETURN p.name AS CEO_Name, o.name AS Organization_Name
LIMIT 3",Simple Retrieval Queries,companies,False,False,False,
What are the top 3 industries with the most organizations in them?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(i:IndustryCategory)
WITH i, count(o) AS orgCount
ORDER BY orgCount DESC
LIMIT 3
RETURN i.name AS Industry, orgCount",Simple Retrieval Queries,companies,False,False,False,
Who are the board members of 'New Energy Group'?,"MATCH (o:Organization {name: ""New Energy Group""})-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN p.name AS BoardMemberName",Complex Retrieval Queries,companies,False,False,True,
Who are the children of 'Julie Spellman Sweet' listed as 'Person' nodes?,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_CHILD]->(child:Person)
RETURN child",Complex Retrieval Queries,companies,False,False,False,
Find the top 5 parent persons of CEOs of organizations with revenues exceeding 100 million.,"MATCH (org:Organization)-[:HAS_CEO]->(ceo:Person)-[:HAS_PARENT]->(parent:Person)
WHERE org.revenue > 100000000
RETURN parent
ORDER BY org.revenue DESC
LIMIT 5",Complex Retrieval Queries,companies,False,False,True,
Which organizations have a motto containing 'security' and have a CEO named 'Julie Spellman Sweet'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""})
WHERE o.motto CONTAINS 'security'
RETURN o",Complex Retrieval Queries,companies,False,False,False,
List the first 3 articles that mention organizations with CEOs named 'Julie Spellman Sweet' and have a sentiment score above 0.75.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""})
MATCH (a:Article)-[:MENTIONS]->(o)
WHERE a.sentiment > 0.75
RETURN a
ORDER BY a.date DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,False,
Who are the first 3 CEOs of organizations that have been mentioned in the most articles?,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WITH o, count(a) AS mentions
ORDER BY mentions DESC
LIMIT 3
MATCH (o)-[:HAS_CEO]->(ceo:Person)
RETURN o.name AS Organization, ceo.name AS CEO",Complex Retrieval Queries,companies,False,False,False,
Identify the top 3 organizations that have a public status and are in the 'Healthcare' industry category.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: ""Healthcare""})
WHERE o.isPublic = true
RETURN o
ORDER BY o.revenue DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
List the first 3 organizations that have a dissolved status and are mentioned in articles authored by 'David Correa'.,"MATCH (o:Organization)-[:MENTIONS]-(a:Article {author: 'David Correa'})
WHERE o.isDissolved = true
RETURN o
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Which organizations are based in 'Seattle' and have a revenue less than 5000000?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Seattle""})
WHERE o.revenue < 5000000
RETURN o",Complex Retrieval Queries,companies,False,False,False,
Find the first 3 organizations that have been mentioned in articles related to 'consumer behavior' and have a sentiment score above 0.6.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS 'consumer behavior' AND a.sentiment > 0.6
MATCH (a)-[:MENTIONS]->(o:Organization)
RETURN o
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Which organizations have investors named 'Julie Spellman Sweet'?,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_INVESTOR]->(o:Organization)
RETURN o",Complex Retrieval Queries,companies,False,False,True,
List the first 3 organizations that have a motto and are public.,"MATCH (o:Organization)
WHERE o.motto IS NOT NULL AND o.isPublic = true
RETURN o
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Who are the first 3 children of CEOs of organizations with more than 500 million in revenue?,"MATCH (org:Organization)-[:HAS_CEO]->(ceo:Person)-[:HAS_CHILD]->(child:Person)
WHERE org.revenue > 500000000
RETURN ceo.name AS CEOName, child.name AS ChildName
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Identify the first 3 organizations that have more than one industry category associated with them.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory)
WITH o, count(ic) AS numCategories
WHERE numCategories > 1
RETURN o
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
List the top 3 organizations that have a CEO and are mentioned in the latest articles.,"MATCH (o:Organization)-[:HAS_CEO]->(:Person), (a:Article)-[:MENTIONS]->(o)
WHERE o.name IS NOT NULL
WITH o, a.date AS articleDate
ORDER BY articleDate DESC
RETURN o.name AS OrganizationName, o.summary AS OrganizationSummary
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Which organizations based in 'United States of America' have more than 10000 employees?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: ""United States of America""})
WHERE o.nbrEmployees > 10000
RETURN o",Complex Retrieval Queries,companies,False,False,True,
Find the first 3 organizations that have been mentioned in articles by 'MrWeb' site.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.siteName = 'MrWeb'
RETURN o
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Which organizations have subsidiaries named 'SuccessFactors'?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(s:Organization {name: 'SuccessFactors'})
RETURN o",Complex Retrieval Queries,companies,False,False,True,
List the first 3 organizations that have the highest revenue and are not dissolved.,"MATCH (o:Organization)
WHERE o.isDissolved = false AND o.revenue IS NOT NULL
RETURN o
ORDER BY o.revenue DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,False,
Identify the top 3 cities where the headquarters of organizations with more than 1000 employees are located.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees > 1000
RETURN c.name, count(o) AS numberOfOrganizations
ORDER BY numberOfOrganizations DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Which organizations have CEOs who are also board members of other organizations?,"MATCH (org:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE EXISTS {
  (ceo)-[:HAS_BOARD_MEMBER]->(:Organization)
}
RETURN org.name AS OrganizationName, ceo.name AS CEOName",Complex Retrieval Queries,companies,False,False,True,
List the first 3 articles that mention 'Seattle' based organizations and have a sentiment score above 0.7.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(c:City {name: ""Seattle""})
WHERE a.sentiment > 0.7
RETURN a
ORDER BY a.date DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,False,
Who are the first 3 competitors of organizations with more than 1 billion in revenue?,"MATCH (o:Organization)-[:HAS_COMPETITOR]->(competitor:Organization)
WHERE o.revenue > 1E9
RETURN o.name AS Organization, competitor.name AS Competitor
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Find the first 3 organizations that have a public status and are in the 'Technology' industry category.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: ""Technology""})
WHERE o.isPublic = true
RETURN o
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Which 3 organizations have the most subsidiaries within the same country?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WITH o, country
MATCH (o)-[:HAS_SUBSIDIARY]->(sub:Organization)-[:IN_CITY]->(c2:City)-[:IN_COUNTRY]->(country)
WITH o, country, count(sub) AS numSubsidiaries
RETURN o.name, country.name, numSubsidiaries
ORDER BY numSubsidiaries DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Identify the first 3 organizations that have the same investor and are competitors.,"MATCH (o1:Organization)-[:HAS_INVESTOR]->(i)<-[:HAS_INVESTOR]-(o2:Organization)
WHERE o1 <> o2 AND EXISTS { (o1)-[:HAS_COMPETITOR]->(o2) }
RETURN o1.name AS Organization1, o2.name AS Organization2, i.name AS Investor
LIMIT 3",Complex Retrieval Queries,companies,False,False,False,
List the top 3 CEOs of organizations that are subsidiaries of 'Accenture'.,"MATCH (parentOrg:Organization {name: ""Accenture""})-[:HAS_SUBSIDIARY]->(sub:Organization)-[:HAS_CEO]->(ceo:Person)
RETURN sub.name AS SubsidiaryName, ceo.name AS CEOName
ORDER BY sub.revenue DESC
LIMIT 3",Complex Retrieval Queries,companies,False,False,False,
Which 3 organizations are suppliers to 'New Energy Group' and are based in 'United States of America'?,"MATCH (o:Organization {name: ""New Energy Group""})<-[:HAS_SUPPLIER]-(supplier:Organization)-[:IN_CITY]->(city:City)-[:IN_COUNTRY]->(country:Country {name: ""United States of America""})
RETURN supplier
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
What are the names of organizations with more than 500 employees and have been mentioned in articles with high sentiment scores?,"MATCH (o:Organization)-[:MENTIONS]->(a:Article)
WHERE o.nbrEmployees > 500 AND a.sentiment > 0.5
RETURN o.name",Complex Retrieval Queries,companies,False,False,True,
Who are the first 3 investors in 'Accenture' and what other organizations do they invest in?,"MATCH (o:Organization {name: ""Accenture""})<-[:HAS_INVESTOR]-(investor)
WITH investor
LIMIT 3
MATCH (investor)-[:HAS_INVESTOR]->(otherOrgs)
RETURN investor.name, collect(otherOrgs.name) AS investedOrganizations",Complex Retrieval Queries,companies,False,False,False,
List the first 3 articles that have chunks containing the text 'consumer behavior'.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS 'consumer behavior'
RETURN a
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Find the first 3 organizations that have a supplier named 'Icon Integration'.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(supplier:Organization {name: 'Icon Integration'})
RETURN o
LIMIT 3",Complex Retrieval Queries,companies,False,False,True,
Identify the organizations that are both public and have more than 1000 employees.,"MATCH (o:Organization)
WHERE o.isPublic = true AND o.nbrEmployees > 1000
RETURN o",Complex Aggregation Queries,companies,False,False,False,
Which organizations are based in the same city as 'Accenture'?,"MATCH (o1:Organization {name: ""Accenture""})-[:IN_CITY]->(c:City)<-[:IN_CITY]-(o2:Organization)
WHERE o1 <> o2
RETURN o2.name AS OrganizationName",Complex Aggregation Queries,companies,False,False,False,
Which organizations have a board member who is a CEO of a competitor organization?,"MATCH (org:Organization)-[:HAS_BOARD_MEMBER]->(ceo:Person)-[:HAS_CEO]->(comp:Organization)
WHERE org <> comp AND EXISTS { (ceo)-[:HAS_CEO]->(comp) }
RETURN org.name AS Organization, ceo.name AS CEO, comp.name AS Competitor",Complex Aggregation Queries,companies,True,False,False,
Which organizations are suppliers to New Energy Group?,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(supplier:Organization {name: ""New Energy Group""})
RETURN o.name AS OrganizationName",Verbose query,companies,False,False,False,
Who are the first 3 people with children also working in the same organization?,"MATCH (p:Person)-[:HAS_CHILD]->(child:Person)
WHERE exists {
  (p)-[:WORKS_FOR]->(org:Organization)
  AND (child)-[:WORKS_FOR]->(org)
}
RETURN p
LIMIT 3",Verbose query,companies,False,False,True,
What are the names of the first 3 organizations that have ceased operations but are still mentioned in recent articles?,"MATCH (o:Organization {isDissolved: true})-[:MENTIONS]-(a:Article)
WHERE a.date >= date('2023-01-01')
RETURN o.name
LIMIT 3",Verbose query,companies,False,False,True,
List the top 5 organizations by number of employees that are located in a country with 'America' in its name.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE country.name CONTAINS 'America'
RETURN o.name AS Organization, o.nbrEmployees AS Employees
ORDER BY o.nbrEmployees DESC
LIMIT 5",Verbose query,companies,False,False,False,
Which organizations have a revenue greater than 1 billion and are public?,"MATCH (o:Organization)
WHERE o.revenue > 1000000000 AND o.isPublic = true
RETURN o",Verbose query,companies,False,False,False,
What are the names of the first 3 persons who are investors in more than one organization?,"MATCH (p:Person)-[:HAS_INVESTOR]->(o:Organization)
WITH p, count(o) AS numOrgs
WHERE numOrgs > 1
RETURN p.name
ORDER BY p.name
LIMIT 3",Verbose query,companies,False,False,True,
Identify the first 3 cities mentioned in articles about technology advancements.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk), (a)-[:MENTIONS]->(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory)
WHERE ic.name CONTAINS ""Technology""
WITH c, a
ORDER BY a.date DESC
LIMIT 3
MATCH (c)-[:MENTIONS]->(city:City)
RETURN DISTINCT city.name",Verbose query,companies,False,False,True,
What are the names of the first 3 organizations with the least number of employees?,"MATCH (o:Organization)
WHERE o.nbrEmployees IS NOT NULL
RETURN o.name
ORDER BY o.nbrEmployees ASC
LIMIT 3",Verbose query,companies,False,False,True,
Which organizations have been mentioned in articles with a sentiment score above 0.9?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment > 0.9
RETURN o",Verbose query,companies,False,False,True,
Who are the first 3 CEOs of organizations that have been invested in by another organization?,"MATCH (investor:Organization)-[:HAS_INVESTOR]->(org:Organization)-[:HAS_CEO]->(ceo:Person)
RETURN org.name AS Organization, ceo.name AS CEO
LIMIT 3",Verbose query,companies,False,False,False,
List the top 5 organizations that have more than one supplier.,"MATCH (o:Organization)
WHERE count{(o)-[:HAS_SUPPLIER]->(:Organization)} > 1
RETURN o
ORDER BY count{(o)-[:HAS_SUPPLIER]->(:Organization)} DESC
LIMIT 5",Verbose query,companies,False,False,True,
What are the names of the first 3 organizations mentioned in articles published on MrWeb?,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)-[:MENTIONS]->(o:Organization)
WHERE a.siteName = ""MrWeb""
RETURN o.name
LIMIT 3",Verbose query,companies,False,False,True,
What are the names of the first 3 organizations that have subsidiaries?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization)
RETURN o.name
LIMIT 3",Verbose query,companies,False,False,True,
Which organizations are based in a city that is also a county seat?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE c.summary CONTAINS ""county seat""
RETURN o.name AS OrganizationName, c.name AS CityName",Verbose query,companies,False,False,True,
List the first 3 countries where organizations with over 500 employees are based.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE o.nbrEmployees > 500
RETURN DISTINCT country.name
LIMIT 3",Verbose query,companies,False,False,True,
What are the names of the first 3 organizations that have a CEO named Julie Spellman Sweet?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: ""Julie Spellman Sweet""})
RETURN o.name
LIMIT 3",Verbose query,companies,False,False,True,
Who are the first 3 board members of organizations that have a revenue of over 1 million?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WHERE o.revenue > 1000000
RETURN o.name AS Organization, p.name AS BoardMember
LIMIT 3",Verbose query,companies,False,False,True,
Which organizations are mentioned in the most recent 5 articles by date?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
RETURN o, a.date AS article_date
ORDER BY a.date DESC
LIMIT 5",Verbose query,companies,False,False,True,
List the first 3 organizations that have subsidiaries in more than one country.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WITH o, count(DISTINCT country) AS countriesCount
WHERE countriesCount > 1
RETURN o
LIMIT 3",Verbose query,companies,False,False,True,
Which organizations are headquartered in a city that is not the capital of its country?,"MATCH (org:Organization)-[:IN_CITY]->(city:City)-[:IN_COUNTRY]->(country:Country)
WHERE NOT EXISTS {
  MATCH (capital:City)-[:IS_CAPITAL_OF]->(country)
  WHERE capital.name = city.name
}
RETURN org",Verbose query,companies,False,False,True,IS_CAPITAL_OF
Identify the first 3 organizations that have both a subsidiary and a supplier.,"MATCH (o:Organization)
WHERE exists{(o)-[:HAS_SUBSIDIARY]->(:Organization)} AND exists{(o)-[:HAS_SUPPLIER]->(:Organization)}
RETURN o
LIMIT 3",Verbose query,companies,False,False,True,
What are the names of the first 3 CEOs of organizations that are not public?,"MATCH (o:Organization {isPublic: false})-[:HAS_CEO]->(ceo:Person)
RETURN ceo.name
LIMIT 3",Verbose query,companies,False,False,True,
List the first 3 countries mentioned in articles related to consumer behavior.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS ""consumer behavior""
MATCH (a)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(city:City)-[:IN_COUNTRY]->(country:Country)
RETURN DISTINCT country.name
LIMIT 3",Verbose query,companies,False,False,True,
What are the names of the first 3 'Electronic Products Manufacturers' with a revenue of over 500 million?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Electronic Products Manufacturers""})
WHERE o.revenue > 500000000
RETURN o.name
LIMIT 3",Verbose query,companies,False,False,False,
Who are the first 3 people who have both parent and child relationships in the database?,"MATCH (p:Person)
WHERE EXISTS { (p)-[:HAS_PARENT]->(:Person) } AND EXISTS { (p)-[:HAS_CHILD]->(:Person) }
RETURN p
LIMIT 3",Verbose query,companies,False,False,True,
List the articles that mention organizations with the most employees.,"MATCH (o:Organization)
WITH o ORDER BY o.nbrEmployees DESC LIMIT 1
MATCH (a:Article)-[:MENTIONS]->(o)
RETURN a",Complex Aggregation Queries,companies,False,False,True,
Identify the first 3 organizations that have a public status and are mentioned in articles with a negative sentiment.,"MATCH (o:Organization)-[:MENTIONS]-(a:Article)
WHERE o.isPublic = true AND a.sentiment < 0
RETURN o
LIMIT 3",Verbose query,companies,False,False,True,
What are the first 5 articles that mention organizations based in the United States?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: ""United States of America""})
RETURN a
LIMIT 5",Verbose query,companies,False,False,True,
List the top 5 organizations where the number of employees is greater than 1000.,"MATCH (o:Organization)
WHERE o.nbrEmployees > 1000
RETURN o
ORDER BY o.nbrEmployees DESC
LIMIT 5",Simple Retrieval Queries,companies,False,False,True,
Which organizations have SAP as a competitor?,"MATCH (o:Organization)-[:HAS_COMPETITOR]->(:Organization {name: ""SAP""})
RETURN o",Verbose query,companies,False,False,True,
List the first 3 organizations categorized under 'Electronic Products Manufacturers'.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Electronic Products Manufacturers""})
RETURN o
LIMIT 3",Verbose query,companies,False,False,True,
Which organizations have more than 5 board members?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WITH o, count(p) AS boardMembersCount
WHERE boardMembersCount > 5
RETURN o.name, boardMembersCount",Complex Aggregation Queries,companies,False,False,True,
Identify the organizations that have been mentioned in articles about innovation.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS 'innovation'
MATCH (a)-[:MENTIONS]->(o:Organization)
RETURN o",Complex Aggregation Queries,companies,False,False,False,
List the organizations that have a CEO named 'Julie Spellman Sweet'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
RETURN o",Complex Aggregation Queries,companies,False,False,True,
Which organizations are based in a country other than their CEO's nationality?,"MATCH (org:Organization)-[:IN_CITY]->(city:City)-[:IN_COUNTRY]->(country:Country),
      (org)-[:HAS_CEO]->(ceo:Person)-[:NATIONALITY]->(ceoCountry:Country)
WHERE NOT country = ceoCountry
RETURN org.name AS OrganizationName, country.name AS CountryName, ceo.name AS CEOName, ceoCountry.name AS CEONationality",Complex Aggregation Queries,companies,False,False,True,NATIONALITY
Name the organizations that have made the most investments in startups.,"MATCH (o:Organization)-[:HAS_INVESTOR]->(s:Organization)
WHERE s.isPublic = false
RETURN o.name, count(s) AS investments
ORDER BY investments DESC",Complex Aggregation Queries,companies,False,False,True,
List the cities where the most CEOs of large organizations reside.,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)-[:HAS_CEO]->(p:Person)
WHERE o.revenue >= 1E9
RETURN c.name, count(p) AS NumberOfCEOs
ORDER BY NumberOfCEOs DESC",Complex Aggregation Queries,companies,False,False,False,
Which organizations have the most positive sentiment articles mentioning them?,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.sentiment IS NOT NULL
RETURN o.name AS Organization, avg(a.sentiment) AS AverageSentiment
ORDER BY AverageSentiment DESC",Complex Aggregation Queries,companies,False,True,False,
Name the organizations that have been mentioned in articles about financial fraud.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.summary CONTAINS 'financial fraud'
RETURN o.name",Complex Aggregation Queries,companies,False,False,True,
List the organizations that have a subsidiary and a supplier in the same country.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(subsidiary:Organization)-[:IN_CITY]->(city:City)-[:IN_COUNTRY]->(country:Country),
      (o)-[:HAS_SUPPLIER]->(supplier:Organization)-[:IN_CITY]->(city2:City)-[:IN_COUNTRY]->(country2:Country)
WHERE country.name = country2.name
RETURN DISTINCT o.name AS Organization, country.name AS Country",Complex Aggregation Queries,companies,False,False,True,
Which organizations have the most diverse board of directors?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WITH o, count(DISTINCT p) AS diversity
ORDER BY diversity DESC
RETURN o.name, diversity",Complex Aggregation Queries,companies,False,False,True,
Identify the organizations that have been mentioned in the most articles about technology.,"MATCH (o:Organization)-[:MENTIONS]-(a:Article)
WHERE EXISTS { (a)-[:HAS_CHUNK]->(c:Chunk) WHERE c.text CONTAINS ""technology"" }
RETURN o.name, count(a) AS mentions
ORDER BY mentions DESC",Complex Aggregation Queries,companies,False,False,True,
List the organizations that are mentioned in articles with a sentiment score of exactly 0.5.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment = 0.5
RETURN o",Complex Aggregation Queries,companies,False,False,False,
List the organizations that have the most negative sentiment articles mentioning them.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.sentiment IS NOT NULL
RETURN o.name AS Organization, a.title AS Article, a.sentiment AS Sentiment
ORDER BY a.sentiment ASC
LIMIT 10",Complex Aggregation Queries,companies,False,False,False,
Name the organizations that have undergone significant restructuring in the past year.,"MATCH (o:Organization)
WHERE o.summary CONTAINS 'restructuring' AND o.isDissolved IS NOT NULL
RETURN o.name, o.summary",Complex Aggregation Queries,companies,False,False,False,
Who are the top 3 investors in the tech industry?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: ""Tech""})
MATCH (o)<-[:HAS_INVESTOR]-(investor)
RETURN investor.name, count(o) AS investments
ORDER BY investments DESC
LIMIT 3",Verbose query,companies,False,False,False,
Which organizations have a CEO who has authored more than one article?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE exists {
  MATCH (p)-[:AUTHORED]->(a:Article)
}
WITH o, p, count{(p)-[:AUTHORED]->(:Article)} AS articlesCount
WHERE articlesCount > 1
RETURN o.name AS Organization, p.name AS CEO, articlesCount",Complex Aggregation Queries,companies,False,False,True,AUTHORED
What are the names of the first 5 people who are board members of more than one organization?,"MATCH (p:Person)-[:HAS_BOARD_MEMBER]->(o:Organization)
WITH p, count(o) AS orgCount
WHERE orgCount > 1
RETURN p.name
LIMIT 5",Verbose query,companies,False,False,True,
Identify the first 3 cities where organizations with more than 1000 employees are located.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees > 1000
RETURN c.name
LIMIT 3",Verbose query,companies,False,False,False,
What are the names of the first 3 organizations that have a motto?,"MATCH (o:Organization)
WHERE o.motto IS NOT NULL
RETURN o.name
LIMIT 3",Verbose query,companies,False,False,False,
Identify the first 3 industries mentioned in articles written by David Correa.,"MATCH (a:Article {author: ""David Correa""})-[:HAS_CHUNK]->(c:Chunk)-[:MENTIONS]->(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory)
RETURN DISTINCT ic.name
LIMIT 3",Verbose query,companies,False,False,True,
Name the top 3 organizations by revenue in the 'Technology' category.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: ""Technology""})
WHERE o.revenue IS NOT NULL
RETURN o.name, o.revenue
ORDER BY o.revenue DESC
LIMIT 3",Complex Aggregation Queries,companies,False,False,True,
Which organizations are located in Seattle?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: ""Seattle""})
RETURN o",Verbose query,companies,False,False,True,
List the top 5 organizations with the highest revenue.,"MATCH (o:Organization)
WHERE o.revenue IS NOT NULL
RETURN o
ORDER BY o.revenue DESC
LIMIT 5",Verbose query,companies,False,False,True,
What are the names of the first 3 organizations that have been dissolved?,"MATCH (o:Organization)
WHERE o.isDissolved = true
RETURN o.name
LIMIT 3",Verbose query,companies,False,False,True,
Who are the CEOs of the top 3 public organizations by number of employees?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE o.isPublic = true
RETURN o.name AS Organization, p.name AS CEO
ORDER BY o.nbrEmployees DESC
LIMIT 3",Verbose query,companies,False,False,True,
Which organizations have been mentioned in articles about corporate social responsibility?,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS ""corporate social responsibility""
MATCH (a)-[:MENTIONS]->(o:Organization)
RETURN o",Complex Aggregation Queries,companies,False,False,True,
List the top 5 organizations by number of articles mentioning them.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
RETURN o.name, count(a) AS mentions
ORDER BY mentions DESC
LIMIT 5",Complex Aggregation Queries,companies,False,False,True,
Which 3 entities have the most relationships with filings where the originator bank country is 'United Kingdom'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank_country = 'United Kingdom'
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e",Verbose query,fincen,False,False,True,
List the top 3 filings by amount where the originator bank is 'CIMB Bank Berhad'.,"MATCH (f:Filing {originator_bank: 'CIMB Bank Berhad'})
RETURN f
ORDER BY f.amount DESC
LIMIT 3",Verbose query,fincen,False,False,True,
What are the first 3 filings where the originator bank's country is 'Angola'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE c.name = 'Angola'
RETURN f
LIMIT 3",Verbose query,fincen,False,False,True,
Which 3 filings involve entities that are both the originator and beneficiary of the filing?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity), (f)-[:BENEFITS]->(e)
RETURN f
LIMIT 3",Verbose query,fincen,False,False,False,
List the top 3 filings where the beneficiary bank is 'Barclays Bank Plc' with the amount specified.,"MATCH (f:Filing {beneficiary_bank: 'Barclays Bank Plc'})
WHERE f.amount IS NOT NULL
RETURN f
ORDER BY f.amount DESC
LIMIT 3",Verbose query,fincen,False,False,True,
What are the first 3 entities linked to countries with the top-level domain '.sg'?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {tld: '.sg'})
RETURN e
LIMIT 3",Verbose query,fincen,False,False,True,
Find the top 5 originator banks with filings that have the shortest duration between begin and end dates.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WITH e.name AS originator_bank, duration.between(f.begin, f.end) AS duration
ORDER BY duration ASC
RETURN originator_bank, duration
LIMIT 5",Verbose query,fincen,False,False,True,
Which 3 entities have filed the most transactions where the amount is greater than 1 million USD?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.amount > 1000000
WITH e, count(f) AS transactions
ORDER BY transactions DESC
LIMIT 3
RETURN e.name, transactions",Verbose query,fincen,False,False,False,
List the top 3 filings with the smallest amounts.,"MATCH (f:Filing)
RETURN f
ORDER BY f.amount ASC
LIMIT 3",Verbose query,fincen,False,False,True,
Identify the top 5 entities based on the number of filings where they have acted as both originator and beneficiary.,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)-[:BENEFITS]->(e)
WITH e, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5
RETURN e.name, filings_count",Verbose query,fincen,False,False,True,
List the top 3 countries based on the number of beneficiary banks.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c, count(e) AS num_beneficiary_banks
ORDER BY num_beneficiary_banks DESC
RETURN c.name AS country_name, num_beneficiary_banks
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
What are the first 3 filings with a beneficiary bank located in 'United Kingdom' that involve an amount greater than 1 million USD?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.amount > 1000000
RETURN f
ORDER BY f.begin
LIMIT 3",Verbose query,fincen,False,False,True,
List the top 3 countries by the number of filings where the originator bank is located.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, count(f) AS FilingsCount
ORDER BY FilingsCount DESC
LIMIT 3",Verbose query,fincen,False,False,True,
Which 3 entities have the most filings that concern entities based in 'China'?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'China'})
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e.name, filingsCount",Verbose query,fincen,False,False,True,
Identify the top 5 filings where the beneficiary bank is 'United Overseas Bank Ltd' and the amount specified.,"MATCH (f:Filing {beneficiary_bank: 'United Overseas Bank Ltd'})
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Verbose query,fincen,False,False,True,
List the top 3 filings involving entities from 'Singapore' based on the amount.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'Singapore'})
RETURN f
ORDER BY f.amount DESC
LIMIT 3",Verbose query,fincen,False,False,True,
Which 3 countries have the most entities involved as beneficiaries in filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, count(e) AS NumberOfEntities
ORDER BY NumberOfEntities DESC
LIMIT 3",Verbose query,fincen,False,False,True,
"Find the top 5 filings where the originator bank's country is 'Angola' and the amount is over 100,000 USD.","MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank_country = 'Angola' AND f.amount > 100000
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Verbose query,fincen,False,False,True,
What are the first 3 filings where the originator and beneficiary banks have the same country of origin?,"MATCH (f:Filing)-[:ORIGINATOR]->(o:Entity)-[:COUNTRY]->(oc:Country),
      (f)-[:BENEFITS]->(b:Entity)-[:COUNTRY]->(bc:Country)
WHERE oc.code = bc.code
RETURN f
LIMIT 3",Verbose query,fincen,False,False,True,
List the top 3 entities based on the number of relationships they have with countries.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country)
WITH e, count(c) AS numCountries
ORDER BY numCountries DESC
LIMIT 3
RETURN e.name, numCountries",Verbose query,fincen,False,False,True,
Which 3 filings have the most significant difference in latitude between originator and beneficiary banks?,"MATCH (f:Filing)
WHERE f.origin_lat IS NOT NULL AND f.beneficiary_lat IS NOT NULL
RETURN f, abs(toFloat(f.origin_lat) - toFloat(f.beneficiary_lat)) AS lat_difference
ORDER BY lat_difference DESC
LIMIT 3",Verbose query,fincen,False,False,True,
What are the first 3 countries that have the most entities with filings in the database?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS CountryName, count(e) AS EntityCount
ORDER BY EntityCount DESC",Verbose query,fincen,False,False,True,
"Find the top 5 filings where the beneficiary bank country is 'Singapore' and the amount is over 500,000 USD.","MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'Singapore' AND f.amount > 500000
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Verbose query,fincen,False,False,True,
What are the first 3 filings with the shortest duration between begin and end dates?,"MATCH (f:Filing)
WHERE f.begin IS NOT NULL AND f.end IS NOT NULL
RETURN f
ORDER BY duration.between(f.begin, f.end)
LIMIT 3",Verbose query,fincen,False,False,False,
List the top 5 countries by the number of entities based on the [:COUNTRY] relationship.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, count(e) AS NumberOfEntities
ORDER BY NumberOfEntities DESC
LIMIT 5",Verbose query,fincen,False,False,False,
List the first 3 entities that have filed the most transactions with a beneficiary in 'China'.,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:BENEFITS]->(b:Entity)
WHERE b.country = 'China'
WITH e, count(f) AS transactions
ORDER BY transactions DESC
LIMIT 3
RETURN e",Verbose query,fincen,False,False,True,
Which 5 entities have their locations in countries with the top-level domain '.cn'?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {tld: '.cn'})
RETURN e
LIMIT 5",Complex Aggregation Queries,fincen,False,False,True,
Find the top 3 filings with the earliest begin dates and amounts over 100000.,"MATCH (f:Filing)
WHERE f.amount > 100000
RETURN f
ORDER BY f.begin ASC
LIMIT 3",Complex Aggregation Queries,fincen,False,False,True,
Which 5 filings ended the latest and concern entities in 'China'?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'China'})
RETURN f
ORDER BY f.end DESC
LIMIT 5",Complex Aggregation Queries,fincen,False,False,True,
List the top 3 filings with originator banks in 'Singapore' and amounts exceeding 1500000.,"MATCH (f:Filing)
WHERE f.originator_bank_country = 'Singapore' AND f.amount > 1500000
RETURN f
ORDER BY f.amount DESC
LIMIT 3",Complex Aggregation Queries,fincen,False,False,True,
What are the top 5 entities linked to the most filings where the beneficiary bank country is 'United Kingdom'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.beneficiary_bank_country = 'United Kingdom'
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 5
RETURN e, filingsCount",Complex Aggregation Queries,fincen,False,False,True,
Which 3 countries have entities that have filed the most filings with beneficiary banks in 'Singapore'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.beneficiary_bank_country = 'Singapore'
WITH c, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN c.name AS Country, filingsCount",Complex Aggregation Queries,fincen,False,False,True,
List the top 5 filings where the originator bank country is 'Singapore' and the amount is between 500000 and 2000000.,"MATCH (f:Filing)
WHERE f.originator_bank_country = 'Singapore' AND f.amount >= 500000 AND f.amount <= 2000000
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Complex Aggregation Queries,fincen,False,False,True,
What are the top 3 entities with the most filings that benefit entities in 'United Kingdom'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'United Kingdom'})
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e, filingsCount",Complex Aggregation Queries,fincen,False,False,True,
Which 5 countries have entities that are beneficiaries in filings where the amount is over 2500000?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.amount > 2500000
RETURN c.name, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5",Complex Aggregation Queries,fincen,False,False,False,
List the top 3 filings where the originator bank is 'CIMB Bank Berhad' and the beneficiary bank country is 'United Kingdom'.,"MATCH (f:Filing)
WHERE f.originator_bank = 'CIMB Bank Berhad' AND f.beneficiary_bank_country = 'United Kingdom'
RETURN f
ORDER BY f.begin DESC
LIMIT 3",Complex Aggregation Queries,fincen,False,False,True,
What are the top 5 countries with entities that have originated filings with the highest average amounts?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WITH e, avg(f.amount) AS avgAmount
ORDER BY avgAmount DESC
LIMIT 5
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS CountryName, avgAmount",Complex Aggregation Queries,fincen,False,False,True,
Identify the top 5 filings where the originator bank is 'CIMB Bank Berhad'.,"MATCH (f:Filing {originator_bank: 'CIMB Bank Berhad'})
RETURN f
ORDER BY f.begin DESC
LIMIT 5",Verbose query,fincen,False,False,True,
Find the first 3 filings that originated from entities in Singapore.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: ""Singapore""})
MATCH (e)-[:FILED]->(f:Filing)
RETURN f
ORDER BY f.begin
LIMIT 3",Verbose query,fincen,False,False,True,
What are the top 5 entities that have filed the most transactions with a beneficiary in the United Kingdom?,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:BENEFITS]->(b:Entity)
WHERE f.beneficiary_bank_country = ""United Kingdom""
WITH e, count(f) AS transactions
ORDER BY transactions DESC
LIMIT 5
RETURN e.name, transactions",Verbose query,fincen,False,False,True,
Which 3 filings involved the highest amounts between March 2015 and September 2015?,"MATCH (f:Filing)
WHERE f.begin_date_format >= '2015-03-01T00:00:00Z' AND f.end_date_format <= '2015-09-30T23:59:59Z'
RETURN f
ORDER BY f.amount DESC
LIMIT 3",Verbose query,fincen,False,False,True,
Identify the top 3 countries where the originator banks of filings are located.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, count(f) AS Filings
ORDER BY Filings DESC
LIMIT 3",Verbose query,fincen,False,False,True,
"What are the first 5 filings with an amount greater than 500,000 USD?","MATCH (f:Filing)
WHERE f.amount > 500000
RETURN f
ORDER BY f.begin
LIMIT 5",Verbose query,fincen,False,False,True,
List the top 3 originator banks that have initiated filings with beneficiary banks located in Singapore.,"MATCH (f:Filing)-[:ORIGINATOR]->(originator:Entity),
      (f)-[:BENEFITS]->(beneficiary:Entity)-[:COUNTRY]->(c:Country {name: ""Singapore""})
RETURN originator.name AS OriginatorBank, count(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 3",Verbose query,fincen,False,False,True,
Which 3 entities have been involved as beneficiaries in the most filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
RETURN e.name, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3",Verbose query,fincen,False,False,True,
Find the top 5 filings by amount where the beneficiary bank's country is 'United Kingdom'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'United Kingdom'})
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Verbose query,fincen,False,False,True,
What are the first 3 entities that have filed a transaction where the originator and beneficiary banks are from different countries?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.originator_bank_country IS NOT NULL AND f.beneficiary_bank_country IS NOT NULL
  AND f.originator_bank_country <> f.beneficiary_bank_country
RETURN e
LIMIT 3",Verbose query,fincen,False,False,True,
Identify the top 5 filings where the originator bank's country is 'Singapore' and the beneficiary bank's country is 'United Kingdom'.,"MATCH (f:Filing)
WHERE f.originator_bank_country = 'Singapore' AND f.beneficiary_bank_country = 'United Kingdom'
RETURN f
ORDER BY f.begin DESC
LIMIT 5",Verbose query,fincen,False,False,True,
What are the top 3 filings with the longest duration between begin and end dates?,"MATCH (f:Filing)
WHERE f.begin IS NOT NULL AND f.end IS NOT NULL
RETURN f, duration.between(f.begin, f.end) AS Duration
ORDER BY Duration DESC
LIMIT 3",Verbose query,fincen,False,False,True,
Identify the top 5 filings by amount where the beneficiary bank's country is 'Singapore'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'Singapore'})
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Verbose query,fincen,False,False,False,
What are the first 3 filings with a beneficiary bank located in 'Singapore' that have the smallest amounts?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE c.name = 'Singapore'
RETURN f
ORDER BY f.amount ASC
LIMIT 3",Verbose query,fincen,False,False,True,
Which 3 entities have the most relationships with filings where the beneficiary bank country is 'Angola'?,"MATCH (e:Entity)-[:FILED]->(f:Filing {beneficiary_bank_country: 'Angola'})
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e",Verbose query,fincen,False,False,False,
Which 3 filings have involved entities with the longest relationships based on begin and end dates?,"MATCH (f:Filing)-[:CONCERNS|:BENEFITS|:ORIGINATOR]->(e:Entity)
WITH f, duration.between(f.begin, f.end) AS relationship_duration
ORDER BY relationship_duration DESC
LIMIT 3
RETURN f",Verbose query,fincen,False,False,False,
Which 3 entities have the most filings as originators and are located in 'China'?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WHERE e.country = 'CHN'
RETURN e, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
What are the names of the top 3 originator banks that have initiated the most filings with a beneficiary in 'USA'?,"MATCH (f:Filing)-[:ORIGINATOR]->(originator:Entity)
WHERE exists {
    (f)-[:BENEFITS]->(:Entity)-[:COUNTRY]->(:Country {name: 'USA'})
}
RETURN originator.name AS OriginatorBankName, count(f) AS FilingsCount
ORDER BY FilingsCount DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
Identify the top 5 beneficiary banks that have received the highest amounts from filings where the originator bank country is 'Germany'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.originator_bank_country = 'Germany'
RETURN e.name AS BeneficiaryBank, sum(f.amount) AS TotalReceived
ORDER BY TotalReceived DESC
LIMIT 5",Complex Retrieval Queries,fincen,False,False,True,
Which 3 countries have the most filings where the originator bank is based in their territory?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN c.name AS Country, filingsCount",Complex Retrieval Queries,fincen,False,False,False,
List the top 3 filings by amount that involve an originator bank from 'Singapore'.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank_country = 'Singapore'
RETURN f
ORDER BY f.amount DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
What are the top 3 countries by the number of entities that have filed filings with a beneficiary bank in 'France'?,"MATCH (e:Entity)-[:FILED]->(f:Filing {beneficiary_bank_country: 'France'})
WITH e, count(e) AS filings_count
ORDER BY filings_count DESC
LIMIT 3
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS country_name, filings_count",Complex Retrieval Queries,fincen,False,False,True,
Identify the top 5 countries by the number of filings where the beneficiary bank is located.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, count(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 5",Complex Retrieval Queries,fincen,False,False,True,
Which 3 entities have originated the most filings with a beneficiary bank in 'United Kingdom'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.beneficiary_bank_country = 'United Kingdom'
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e",Complex Retrieval Queries,fincen,False,False,True,
List the first 3 filings where the beneficiary bank country is 'Spain' and the amount is over 5 million USD.,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'Spain' AND f.amount > 5000000
RETURN f
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
What are the top 3 countries by the number of filings where they are the beneficiary bank country?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, count(f) AS FilingsCount
ORDER BY FilingsCount DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
List the first 3 entities that have been beneficiaries in filings with an amount over 50 million USD.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.amount > 50000000
RETURN e
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
Identify the top 5 entities by number of filings where the originator bank is 'HSBC'.,"MATCH (e:Entity)-[:FILED]->(f:Filing {originator_bank: 'HSBC'})
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 5
RETURN e, filingsCount",Complex Retrieval Queries,fincen,False,False,True,
List the first 3 filings with the highest number of transactions that involve a beneficiary bank from 'Japan'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'Japan'})
RETURN f
ORDER BY f.number DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,False,
What are the top 3 countries by the number of filings where they appear as the originator bank country?,"MATCH (f:Filing)
WHERE f.originator_bank_country IS NOT NULL
RETURN f.originator_bank_country AS Country, count(f) AS Filings
ORDER BY Filings DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
Identify the top 5 filings by amount where the originator bank is 'The Bank of New York Mellon Corp.'.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity {name: 'The Bank of New York Mellon Corp.'})
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Complex Retrieval Queries,fincen,False,False,False,
Which 3 entities have filed the most number of filings concerning banks in 'Australia'?,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:CONCERNS]->(bank:Entity)
WHERE exists {
    (bank)-[:COUNTRY]->(:Country {name: 'Australia'})
}
RETURN e.name, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
List the first 3 filings where the originator bank's country is 'Italy' and the amount transferred is over 10 million USD.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank_country = 'Italy' AND f.amount > 10000000
RETURN f
LIMIT 3",Complex Retrieval Queries,fincen,False,False,False,
What are the top 5 entities by amount received in filings where they are the beneficiary?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
RETURN e.name AS EntityName, sum(f.amount) AS TotalAmountReceived
ORDER BY TotalAmountReceived DESC
LIMIT 5",Complex Retrieval Queries,fincen,False,False,True,
Which 3 filings involve an entity from 'Mexico' as the beneficiary and the amount is over 500000 USD?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'Mexico'})
WHERE f.amount > 500000
RETURN f
LIMIT 3",Complex Retrieval Queries,fincen,False,False,False,
Identify the top 5 countries where the originator banks of the filings are based.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, count(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 5",Complex Retrieval Queries,fincen,False,False,True,
List the top 3 entities by the number of filings they are concerned in.,"MATCH (e:Entity)-[:CONCERNS]->(f:Filing)
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e.name, filingsCount",Complex Retrieval Queries,fincen,False,False,False,
Which 3 countries have the most entities linked as beneficiaries in filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name, count(e) AS num_entities
ORDER BY num_entities DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
Which 3 entities have been the originator in the filings with the longest durations from beginning to end date?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WITH e, duration.between(f.begin, f.end) AS dur
ORDER BY dur DESC
RETURN e.name AS EntityName, dur AS Duration
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
Identify the top 5 filings by number that involve 'CIMB Bank Berhad' as the originator.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity {name: 'CIMB Bank Berhad'})
RETURN f
ORDER BY f.number DESC
LIMIT 5",Complex Retrieval Queries,fincen,False,False,True,
What are the top 3 countries by the number of filings where they appear as the originator bank country?,"MATCH (f:Filing)
WHERE f.originator_bank_country IS NOT NULL
RETURN f.originator_bank_country AS Country, count(f) AS FilingsCount
ORDER BY FilingsCount DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
List the top 3 countries by the number of filings that have a beneficiary bank based in their territory.,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)<-[:BENEFITS]-(f:Filing)
WITH c, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN c.name AS CountryName, filingsCount",Complex Retrieval Queries,fincen,False,False,True,
Find the top 5 filings by number where the originator bank's country is 'United Kingdom'.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'United Kingdom'})
RETURN f
ORDER BY f.number DESC
LIMIT 5",Verbose query,fincen,False,False,True,
What are the first 3 entities that have filed transactions where the originator bank is located in 'Angola'?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.originator_bank_country = 'Angola'
RETURN e
LIMIT 3",Verbose query,fincen,False,False,True,
List the top 3 countries by the number of originator banks located there based on the filings.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c, count(e) AS numBanks
ORDER BY numBanks DESC
LIMIT 3
RETURN c.name AS Country, numBanks",Verbose query,fincen,False,False,True,
Which 3 filings involve the highest amounts where the beneficiary bank's country is 'United Kingdom' and the originator bank's country is 'Singapore'?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.originator_bank_country = 'Singapore'
RETURN f
ORDER BY f.amount DESC
LIMIT 3",Verbose query,fincen,False,False,True,
Identify the top 5 entities based on the total amount of their filings where the beneficiary bank's country is 'Singapore'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.beneficiary_bank_country = 'Singapore'
RETURN e, sum(f.amount) as total_amount
ORDER BY total_amount DESC
LIMIT 5",Verbose query,fincen,False,False,False,
What are the first 3 countries that are linked to the most entities based on the [:COUNTRY] relationship?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country)
WITH c, count(e) AS entityCount
ORDER BY entityCount DESC
RETURN c.name AS CountryName, entityCount
LIMIT 3",Verbose query,fincen,False,False,True,
List the top 3 filings where the originator bank is from a country with a top-level domain '.uk'.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {tld: '.uk'})
RETURN f
ORDER BY f.begin DESC
LIMIT 3",Verbose query,fincen,False,False,True,
Which 3 entities have filed the most transactions where the beneficiary bank is located in 'United Kingdom'?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom'
WITH e, count(f) AS transactions
ORDER BY transactions DESC
LIMIT 3
RETURN e.name, transactions",Verbose query,fincen,False,False,False,
Find the top 5 filings with the shortest durations where the originator bank's country is 'Singapore'.,"MATCH (f:Filing)
WHERE f.originator_bank_country = 'Singapore' AND f.begin IS NOT NULL AND f.end IS NOT NULL
RETURN f
ORDER BY duration.between(f.begin, f.end) ASC
LIMIT 5",Verbose query,fincen,False,False,True,
What are the first 3 filings with a beneficiary bank located in 'Angola' that involves the smallest amounts?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'Angola'})
WITH f
ORDER BY f.amount ASC
RETURN f
LIMIT 3",Verbose query,fincen,False,False,True,
List the top 3 originator banks based on the number of filings where the beneficiary bank is located in 'United Kingdom'.,"MATCH (f:Filing)-[:ORIGINATOR]->(originator:Entity)
WHERE f.beneficiary_bank_country = 'United Kingdom'
WITH originator, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN originator.name AS OriginatorBank, filingsCount",Verbose query,fincen,False,False,True,
List the top 3 countries connected to entities that have originated filings with amounts over 2000000.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.amount > 2000000
RETURN c.name, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3",Complex Aggregation Queries,fincen,False,False,True,
Identify the top 5 countries based on the number of filings where the beneficiary bank is located.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.beneficiary_bank IS NOT NULL
RETURN c.name AS Country, count(f) AS FilingsCount
ORDER BY FilingsCount DESC
LIMIT 5",Verbose query,fincen,False,False,True,
What are the first 3 entities that have filed transactions where the beneficiary bank is located in 'Singapore'?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.beneficiary_bank_country = 'Singapore'
RETURN e
LIMIT 3",Verbose query,fincen,False,False,True,
Which 3 countries have beneficiary banks that received the highest total amounts in filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, sum(f.amount) AS TotalAmount
ORDER BY TotalAmount DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
What are the top 3 entities that have originated filings concerning banks in 'China'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'China'})
WHERE exists{ (f)-[:CONCERNS]->(:Entity)-[:COUNTRY]->(:Country {name: 'China'}) }
RETURN e.name, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
Identify the top 5 filings that ended in the year 2014 and involve an originator bank from 'United Kingdom'.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'United Kingdom'})
WHERE f.end.year = 2014
RETURN f
ORDER BY f.end DESC
LIMIT 5",Complex Retrieval Queries,fincen,False,False,True,
List the top 3 filings by amount where the beneficiary bank is from 'USA'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {code: 'USA'})
RETURN f
ORDER BY f.amount DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
Which 3 entities have the most filings as beneficiaries and are located in 'India'?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: 'India'})
WITH e
MATCH (e)<-[:BENEFITS]-(f:Filing)
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e.name, filingsCount",Complex Retrieval Queries,fincen,False,False,False,
What are the top 5 filings by amount that involve an originator bank from 'Australia'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'Australia'})
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Complex Retrieval Queries,fincen,False,False,False,
List the first 3 entities that have originated filings with an end date after '2016-01-01'.,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WHERE f.end > datetime('2016-01-01T00:00:00Z')
RETURN e
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
Which 3 countries have the most entities linked as originators in the filings?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS CountryName, count(e) AS NumberOfEntities
ORDER BY NumberOfEntities DESC",Complex Retrieval Queries,fincen,False,False,True,
Identify the top 5 entities by number of filings where the beneficiary bank is 'Barclays Bank Plc'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.beneficiary_bank = 'Barclays Bank Plc'
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 5
RETURN e.name, filingsCount",Complex Retrieval Queries,fincen,False,False,True,
"List the top 3 entities that have filed the most transactions involving an amount greater than 500,000 USD.","MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.amount > 500000
RETURN e.name, count(f) AS transactions_count
ORDER BY transactions_count DESC
LIMIT 3",Verbose query,fincen,False,False,True,
What are the top 5 filings from originators in 'Singapore' concerning entities in 'United Kingdom'?,"MATCH (f:Filing)-[:ORIGINATOR]->(originator:Entity)-[:COUNTRY]->(originatorCountry:Country {name: 'Singapore'}),
      (f)-[:CONCERNS]->(concerned:Entity)-[:COUNTRY]->(concernedCountry:Country {name: 'United Kingdom'})
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Complex Aggregation Queries,fincen,False,False,False,
Show the top 3 Filings where the originator bank is 'CIMB Bank Berhad'.,"MATCH (f:Filing {originator_bank: 'CIMB Bank Berhad'})
RETURN f
ORDER BY f.begin DESC
LIMIT 3",Pathfinding Queries,fincen,False,False,True,
List the top 5 entities that have originated filings with amounts greater than 500000.,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WHERE f.amount > 500000
RETURN e, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5",Complex Aggregation Queries,fincen,False,False,False,
What are the names of the top 3 beneficiary banks based on the number of different originator banks they have interacted with in filings?,"MATCH (f:Filing)-[:BENEFITS]->(b:Entity)
WITH b, count(DISTINCT f.originator_bank) AS distinctOriginators
ORDER BY distinctOriginators DESC
LIMIT 3
RETURN b.name AS BeneficiaryBankName, distinctOriginators",Simple Aggregation Queries,fincen,False,False,True,
Which 3 countries have the largest number of entities that are originators in filings?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS CountryName, filingsCount
ORDER BY filingsCount DESC",Simple Aggregation Queries,fincen,False,False,True,
List the top 5 filings where the originator bank's country is 'Singapore'.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank_country = 'Singapore'
RETURN f
ORDER BY f.begin DESC
LIMIT 5",Simple Aggregation Queries,fincen,False,False,True,
"What are the top 5 countries where the beneficiary banks are located, based on the total number of filings?","MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, count(f) AS TotalFilings
ORDER BY TotalFilings DESC
LIMIT 5",Simple Aggregation Queries,fincen,False,False,True,
Which 3 entities have the largest number of incoming [:BENEFITS] relationships?,"MATCH (e:Entity)<-[:BENEFITS]-(f:Filing)
RETURN e, count(f) AS benefitsCount
ORDER BY benefitsCount DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
List the top 3 countries where the originator banks have originated the smallest total amounts in filings.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, SUM(f.amount) AS total_amount
ORDER BY total_amount ASC
RETURN country, total_amount
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
What are the top 5 filings by amount where the filing year is 2017?,"MATCH (f:Filing)
WHERE f.begin.year = 2017
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Simple Aggregation Queries,fincen,False,False,True,
Which 3 countries have the highest number of filings where the beneficiary bank's country is 'Germany'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.beneficiary_bank_country = 'Germany'
RETURN c.name, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
List the top 5 filings where the originator bank's country and beneficiary bank's country are the same but not 'United Kingdom'.,"MATCH (f:Filing)
WHERE f.originator_bank_country = f.beneficiary_bank_country AND f.originator_bank_country <> 'United Kingdom'
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Simple Aggregation Queries,fincen,False,False,True,
"What are the top 5 countries by the number of filings where the amount is between 100,000 and 1,000,000?","MATCH (f:Filing)-[:CONCERNS|:ORIGINATOR|:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.amount >= 100000 AND f.amount <= 1000000
RETURN c.name AS Country, count(f) AS FilingsCount
ORDER BY FilingsCount DESC
LIMIT 5",Simple Aggregation Queries,fincen,False,False,True,
"Which 3 filings have the longest duration from 'begin' to 'end' where the amount is over 500,000?","MATCH (f:Filing)
WHERE f.amount > 500000
RETURN f, duration.between(f.begin, f.end) AS Duration
ORDER BY Duration DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
List the top 5 entities based on the number of [:CONCERNS] relationships they are involved in.,"MATCH (e:Entity)<-[:CONCERNS]-(f:Filing)
RETURN e, count(f) AS concerns_count
ORDER BY concerns_count DESC
LIMIT 5",Simple Aggregation Queries,fincen,False,False,True,
Identify the top 5 filings with the most distinct beneficiary banks involved.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WITH f, count(DISTINCT e.beneficiary_bank) AS distinct_banks
ORDER BY distinct_banks DESC
LIMIT 5
RETURN f, distinct_banks",Simple Aggregation Queries,fincen,False,False,True,Entity.beneficiary_bank
Which 3 countries have the most filings where the originator bank's country is 'United States'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.originator_bank_country = 'United States'
RETURN c.name, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
List the top 5 originator banks that have originated filings with the highest average amounts.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WITH e.name AS originator_bank, AVG(f.amount) AS avg_amount
ORDER BY avg_amount DESC
LIMIT 5
RETURN originator_bank, avg_amount",Simple Aggregation Queries,fincen,False,False,True,
What are the names of the top 3 entities based on the number of [:FILED] relationships?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
RETURN e.name, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
Which 3 beneficiary banks have been involved in filings with the smallest total amounts?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WITH e.name AS bank_name, SUM(f.amount) AS total_amount
ORDER BY total_amount ASC
LIMIT 3
RETURN bank_name, total_amount",Simple Aggregation Queries,fincen,False,False,True,
List the top 5 countries by the number of filings where the originator bank is located in 'China'.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'China'})
WITH c, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 5
RETURN c.name AS CountryName, filingsCount",Simple Aggregation Queries,fincen,False,False,True,
What are the top 5 countries by the number of beneficiary banks involved in filings with amounts over 2 million?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.amount > 2000000
RETURN c.name AS Country, count(DISTINCT e) AS BeneficiaryBanksCount
ORDER BY BeneficiaryBanksCount DESC
LIMIT 5",Simple Aggregation Queries,fincen,False,False,True,
Which 3 filings have the smallest amounts where the beneficiary bank's country is 'Japan'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'Japan'})
WHERE f.amount IS NOT NULL
RETURN f
ORDER BY f.amount ASC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
Who are the beneficiaries in the filings from originator country 'Singapore'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.originator_bank_country = 'Singapore'
RETURN e.name AS Beneficiary",Simple Aggregation Queries,fincen,False,False,True,
List the top 5 filings where the beneficiary bank's country and originator bank's country are different and the amount is above 1 million.,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country <> f.originator_bank_country AND f.amount > 1000000
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Simple Aggregation Queries,fincen,False,False,False,
List the top 5 Filings with the highest amounts.,"MATCH (f:Filing)
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Pathfinding Queries,fincen,False,False,True,
List the top 5 originator banks based on the total number of filings they have originated.,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WITH e, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5
RETURN e.name AS Originator_Bank, filings_count",Simple Aggregation Queries,fincen,False,False,True,
Which Entities have filed more than 3 Filings?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, count(f) AS filingsCount
WHERE filingsCount > 3
RETURN e",Pathfinding Queries,fincen,False,False,True,
Which 3 filings have the largest amounts where the beneficiary bank's country is 'United Kingdom'?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom'
RETURN f
ORDER BY f.amount DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
List the top 3 filings with the largest number of transactions where the originator bank's country and beneficiary bank's country are different.,"MATCH (f:Filing)
WHERE f.originator_bank_country IS NOT NULL AND f.beneficiary_bank_country IS NOT NULL
  AND f.originator_bank_country <> f.beneficiary_bank_country
RETURN f
ORDER BY f.number DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
What are the top 5 filings by amount in 2015?,"MATCH (f:Filing)
WHERE f.begin_date_format >= '2015-01-01T00:00:00Z' AND f.end_date_format <= '2015-12-31T23:59:59Z'
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Simple Aggregation Queries,fincen,False,False,True,
Which 3 countries have the most filings where the originator bank is not in the same country as the beneficiary bank?,"MATCH (f:Filing)-[:ORIGINATOR]->(o:Entity)-[:COUNTRY]->(oc:Country),
      (f)-[:BENEFITS]->(b:Entity)-[:COUNTRY]->(bc:Country)
WHERE oc.code <> bc.code
WITH bc, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN bc.name AS Country, filingsCount",Simple Aggregation Queries,fincen,False,False,True,
Identify the top 5 entities by the number of filings they filed.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 5
RETURN e.name, filingsCount",Simple Aggregation Queries,fincen,False,False,True,
What are the names of the top 3 originator banks that have originated the highest amounts in filings?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
RETURN e.name AS OriginatorBankName, sum(f.amount) AS TotalAmount
ORDER BY TotalAmount DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
Which 3 beneficiary banks have been involved in filings with the highest total amounts?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
RETURN e.name AS BeneficiaryBank, sum(f.amount) AS TotalAmount
ORDER BY TotalAmount DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
List the top 3 filings with the highest number of transactions in a single filing.,"MATCH (f:Filing)
RETURN f
ORDER BY f.number DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
What are the top 5 countries in terms of total amount received by beneficiary banks?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, sum(f.amount) AS TotalAmountReceived
ORDER BY TotalAmountReceived DESC
LIMIT 5",Simple Aggregation Queries,fincen,False,False,True,
Which 3 entities have been filed against the most in terms of number of filings?,"MATCH (e:Entity)<-[:CONCERNS]-(f:Filing)
RETURN e.name, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
List the top 5 countries where most originator banks are located based on filings.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, count(f) AS FilingsCount
ORDER BY FilingsCount DESC
LIMIT 5",Simple Aggregation Queries,fincen,False,False,False,
What are the top 3 filings in terms of amount that occurred in 2016?,"MATCH (f:Filing)
WHERE f.begin.year = 2016
RETURN f
ORDER BY f.amount DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,False,
Which 3 countries have the highest average amounts in filings where they are listed as originator?,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)-[:ORIGINATOR]->(f:Filing)
WITH c.name AS country, AVG(f.amount) AS avg_amount
RETURN country, avg_amount
ORDER BY avg_amount DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
Identify the top 5 entities that have originated the most filings.,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
RETURN e, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5",Simple Aggregation Queries,fincen,False,False,True,
What are the top 5 filings by duration (from 'begin' to 'end')?,"MATCH (f:Filing)
WHERE f.begin IS NOT NULL AND f.end IS NOT NULL
RETURN f, duration.between(f.begin, f.end) AS Duration
ORDER BY Duration DESC
LIMIT 5",Simple Aggregation Queries,fincen,False,False,False,
Which 3 countries have beneficiary banks that have been involved in the highest number of filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, count(f) AS Filings
ORDER BY Filings DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
List the top 5 entities that have been concerned in filings the most.,"MATCH (e:Entity)-[:CONCERNS]->(f:Filing)
RETURN e.name, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5",Simple Aggregation Queries,fincen,False,False,True,
Which 3 countries have the most filings where the amount is above 1 million?,"MATCH (f:Filing)-[:CONCERNS|:BENEFITS|:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.amount > 1000000
RETURN c.name AS Country, count(f) AS FilingsCount
ORDER BY FilingsCount DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
List the top 5 filings with the shortest duration between 'begin' and 'end'.,"MATCH (f:Filing)
WHERE f.begin IS NOT NULL AND f.end IS NOT NULL
RETURN f, duration.between(f.begin, f.end) AS Duration
ORDER BY Duration ASC
LIMIT 5",Simple Aggregation Queries,fincen,False,False,True,
What are the names of the top 3 originator banks that have initiated filings with the most distinct beneficiary banks?,"MATCH (f:Filing)-[:ORIGINATOR]->(originator:Entity)
WITH originator, count(DISTINCT f.beneficiary_bank) AS distinct_beneficiaries
ORDER BY distinct_beneficiaries DESC
LIMIT 3
RETURN originator.name AS OriginatorBankName, distinct_beneficiaries",Simple Aggregation Queries,fincen,False,False,True,
Identify the top 5 countries by the number of entities filed against.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, count(f) AS filings
ORDER BY filings DESC
LIMIT 5
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, filings AS NumberOfFilings",Simple Aggregation Queries,fincen,False,False,True,
Which 3 originator banks have the most filings associated with them?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
RETURN e.name AS OriginatorBank, count(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
List the top 5 filings where the originator and beneficiary banks are in the same country.,"MATCH (f:Filing)-[:ORIGINATOR]->(o:Entity)-[:COUNTRY]->(oc:Country),
      (f)-[:BENEFITS]->(b:Entity)-[:COUNTRY]->(bc:Country)
WHERE oc.code = bc.code
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Simple Aggregation Queries,fincen,False,False,True,
What are the top 5 countries in terms of total amount sent by originator banks?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, sum(f.amount) AS TotalAmountSent
ORDER BY TotalAmountSent DESC
LIMIT 5",Simple Aggregation Queries,fincen,False,False,True,
Which 3 entities have benefited from the most filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
RETURN e, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
Identify the top 5 entities that have the most connections to countries through the relationship [:COUNTRY].,"MATCH (e:Entity)-[:COUNTRY]->(c:Country)
RETURN e, count(c) AS connections
ORDER BY connections DESC
LIMIT 5",Simple Aggregation Queries,fincen,False,False,True,
Which 3 countries have the most entities with filings related to 'Barclays Bank Plc' as the beneficiary bank?,"MATCH (f:Filing {beneficiary_bank: 'Barclays Bank Plc'})-[:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c, count(e) AS entityCount
ORDER BY entityCount DESC
LIMIT 3
RETURN c.name AS Country, entityCount",Complex Aggregation Queries,fincen,False,False,True,
Find the top 3 Countries based on the number of originating Filings.,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)<-[:ORIGINATOR]-(f:Filing)
RETURN c.name AS Country, count(f) AS NumberOfOriginatingFilings
ORDER BY NumberOfOriginatingFilings DESC
LIMIT 3",Pathfinding Queries,fincen,False,False,True,
Who are the beneficiaries in Filings that originated from entities in 'Singapore'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'Singapore'})
MATCH (f)-[:BENEFITS]->(beneficiary:Entity)
RETURN beneficiary.name AS BeneficiaryName",Pathfinding Queries,fincen,False,False,True,
Show the top 3 Entities that have filed the most number of Filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
RETURN e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3",Pathfinding Queries,fincen,False,False,True,
"List the Entities that have benefited from Filings with an amount over $2,000,000.","MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.amount > 2000000
RETURN e",Pathfinding Queries,fincen,False,False,False,
Which Filings have an originator bank with a country code of 'SGP'?,"MATCH (f:Filing)
WHERE f.originator_iso = 'SGP'
RETURN f",Pathfinding Queries,fincen,False,False,True,
Display the top 5 Entities by the number of Filings they have originated.,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 5
RETURN e, filingsCount",Pathfinding Queries,fincen,False,False,True,
What are the names of the top 3 Countries that have beneficiary banks in Filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS CountryName, count(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 3",Pathfinding Queries,fincen,False,False,True,
Which Filings are concerned by Entities located in 'Singapore'?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'Singapore'})
RETURN f",Pathfinding Queries,fincen,False,False,True,
"List the Filings where the amount is greater than $1,500,000.","MATCH (f:Filing)
WHERE f.amount > 1500000
RETURN f",Pathfinding Queries,fincen,False,False,True,
Find the top 5 Filings with the shortest duration between begin and end dates.,"MATCH (f:Filing)
WHERE f.begin IS NOT NULL AND f.end IS NOT NULL
RETURN f
ORDER BY duration.between(f.begin, f.end) ASC
LIMIT 5",Pathfinding Queries,fincen,False,False,True,
"Who are the beneficiaries in Filings that involved an amount over $2,000,000?","MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.amount > 2000000
RETURN e.name AS Beneficiary",Pathfinding Queries,fincen,False,False,True,
Display all Filings where the originator and beneficiary banks are from 'Singapore'.,"MATCH (f:Filing)
WHERE f.originator_bank_country = 'Singapore' AND f.beneficiary_bank_country = 'Singapore'
RETURN f",Pathfinding Queries,fincen,False,False,True,
What are the top 5 Filings where the beneficiary bank is located in the 'United Kingdom'?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom'
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Pathfinding Queries,fincen,False,False,True,
Which Filings have a beneficiary bank in 'China'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE c.name = 'China'
RETURN f",Pathfinding Queries,fincen,False,False,True,
What are the top 5 filings by amount that involved 'Bank of Baku' as the originator?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity {name: 'Bank of Baku'})
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Complex Retrieval Queries,fincen,False,False,True,
List the Entities that are concerned by Filings where the originator bank is in 'Angola'.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WHERE f.originator_bank_country = 'Angola'
RETURN e",Pathfinding Queries,fincen,False,False,True,
Find the top 5 Filings with the lowest number of transactions.,"MATCH (f:Filing)
RETURN f
ORDER BY f.number ASC
LIMIT 5",Pathfinding Queries,fincen,False,False,True,
Which Countries have the most beneficiary banks in Filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, count(e) AS BeneficiaryBankCount
ORDER BY BeneficiaryBankCount DESC",Pathfinding Queries,fincen,False,False,True,
Show the top 3 Filings with the latest end dates.,"MATCH (f:Filing)
RETURN f
ORDER BY f.end DESC
LIMIT 3",Pathfinding Queries,fincen,False,False,True,
What are the names of the Entities that have filed the Filings with a begin date in '2014'?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.begin_date_format STARTS WITH '2014'
RETURN DISTINCT e.name",Pathfinding Queries,fincen,False,False,True,
What are the top 3 filings by amount where the originator bank country is 'Singapore'?,"MATCH (f:Filing)
WHERE f.originator_bank_country = 'Singapore'
RETURN f
ORDER BY f.amount DESC
LIMIT 3",Complex Aggregation Queries,fincen,False,False,True,
List the top 5 countries by the number of entities located there.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, count(e) AS NumberOfEntities
ORDER BY NumberOfEntities DESC
LIMIT 5",Complex Aggregation Queries,fincen,False,False,True,
Which 3 entities filed the most filings between 2010 and 2015?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.begin >= datetime('2010-01-01T00:00:00Z') AND f.end <= datetime('2015-12-31T23:59:59Z')
RETURN e.name, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3",Complex Aggregation Queries,fincen,False,False,True,
Find the top 5 filings with the largest amounts that concern entities in 'China'.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'China'})
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Complex Aggregation Queries,fincen,False,False,False,
What are the top 3 filings where the beneficiary bank is 'Barclays Bank Plc' and the amount is over 1000000?,"MATCH (f:Filing)
WHERE f.beneficiary_bank = 'Barclays Bank Plc' AND f.amount > 1000000
RETURN f
ORDER BY f.amount DESC
LIMIT 3",Complex Aggregation Queries,fincen,False,False,True,
Which Filings have a beneficiary bank in 'Angola'?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'Angola'
RETURN f",Pathfinding Queries,fincen,False,False,True,
"What are the names of Entities that are concerned by Filings involving more than $1,000,000?","MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WHERE f.amount > 1000000
RETURN DISTINCT e.name",Pathfinding Queries,fincen,False,False,True,
Find the top 5 Filings by amount where the originator is from 'United Kingdom'.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'United Kingdom'})
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Pathfinding Queries,fincen,False,False,True,
Show the top 3 Filings where the beneficiary bank country is 'Singapore'.,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'Singapore'
RETURN f
ORDER BY f.end DESC
LIMIT 3",Pathfinding Queries,fincen,False,False,True,
Display the top 5 longest Filings by duration between begin and end dates.,"MATCH (f:Filing)
WHERE f.begin IS NOT NULL AND f.end IS NOT NULL
RETURN f, duration.between(f.begin, f.end) AS Duration
ORDER BY Duration DESC
LIMIT 5",Pathfinding Queries,fincen,False,False,True,
What are the names of the top 3 Entities by the total amount of Filings they have benefited from?,"MATCH (e:Entity)<-[:BENEFITS]-(f:Filing)
WITH e, sum(f.amount) AS totalAmount
ORDER BY totalAmount DESC
LIMIT 3
RETURN e.name AS EntityName, totalAmount",Pathfinding Queries,fincen,False,False,True,
Which Country has the most Entities registered with it?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, count(e) AS NumberOfEntities
ORDER BY NumberOfEntities DESC
LIMIT 1",Pathfinding Queries,fincen,False,False,False,
"Show the top 5 Filings where the amount is between $500,000 and $1,000,000.","MATCH (f:Filing)
WHERE f.amount >= 500000 AND f.amount <= 1000000
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Pathfinding Queries,fincen,False,False,True,
List Entities that originated Filings to more than two different countries.,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WITH e, collect(DISTINCT f.originator_bank_country) AS countries
WHERE size(countries) > 2
RETURN e",Pathfinding Queries,fincen,False,False,True,
Which Filings have a beneficiary bank located in the 'United Kingdom'?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom'
RETURN f",Pathfinding Queries,fincen,False,False,True,
Show the top 3 Filings with the earliest begin dates.,"MATCH (f:Filing)
RETURN f
ORDER BY f.begin
LIMIT 3",Pathfinding Queries,fincen,False,False,True,
Which Entities are associated with Filings that have the originator bank country as 'Angola'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank_country = 'Angola'
RETURN DISTINCT e",Pathfinding Queries,fincen,False,False,True,
List the Filings where the beneficiary bank and originator bank are from the same country.,"MATCH (f:Filing)
WHERE f.originator_bank_country = f.beneficiary_bank_country AND f.originator_bank_country IS NOT NULL
RETURN f",Pathfinding Queries,fincen,False,False,True,
Find the top 3 Filings with the smallest amount.,"MATCH (f:Filing)
RETURN f
ORDER BY f.amount ASC
LIMIT 3",Pathfinding Queries,fincen,False,False,True,
Display the Entities that are associated with the most number of Filings as a beneficiary.,"MATCH (e:Entity)<-[:BENEFITS]-(f:Filing)
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
RETURN e, filingsCount",Pathfinding Queries,fincen,False,False,True,
What are the top 5 Countries where the Filings' beneficiary banks are located?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, count(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 5",Pathfinding Queries,fincen,False,False,True,
Which Filings involve Entities that are linked to the 'CHN' country code?,"MATCH (f:Filing)-[:CONCERNS|:ORIGINATOR|:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {code: 'CHN'})
RETURN f",Pathfinding Queries,fincen,False,False,True,
"List the top 3 Filings where the amount is exactly $1,000,000.","MATCH (f:Filing {amount: 1000000})
RETURN f
ORDER BY f.begin DESC
LIMIT 3",Pathfinding Queries,fincen,False,False,True,
Who are the Entities that filed the Filings with a begin date in 'March 2015'?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.begin_date_format STARTS WITH '2015-03'
RETURN e",Pathfinding Queries,fincen,False,False,True,
Find the top 5 Filings by number of transactions.,"MATCH (f:Filing)
RETURN f
ORDER BY f.number DESC
LIMIT 5",Pathfinding Queries,fincen,False,False,True,
Show the names of Entities that have originator banks in 'Singapore'.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank_country = 'Singapore'
RETURN e.name",Pathfinding Queries,fincen,False,False,True,
Which Filings have an end date later than 'September 2015'?,"MATCH (f:Filing)
WHERE f.end >= datetime('2015-10-01T00:00:00Z')
RETURN f",Pathfinding Queries,fincen,False,False,True,
List the top 3 longest Filings in terms of duration from the begin to the end date.,"MATCH (f:Filing)
WHERE f.begin IS NOT NULL AND f.end IS NOT NULL
RETURN f, duration.between(f.begin, f.end) AS Duration
ORDER BY Duration DESC
LIMIT 3",Pathfinding Queries,fincen,False,False,True,
Who are the beneficiaries in Filings that have an originator bank from 'Angola'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.originator_bank_country = 'Angola'
RETURN e.name AS Beneficiary",Pathfinding Queries,fincen,False,False,True,
Display all Filings where the originator and beneficiary banks are different.,"MATCH (f:Filing)
WHERE f.originator_bank_id IS NOT NULL AND f.beneficiary_bank_id IS NOT NULL AND f.originator_bank_id <> f.beneficiary_bank_id
RETURN f",Pathfinding Queries,fincen,False,False,False,
What are the top 5 Filings with the highest number of transactions?,"MATCH (f:Filing)
RETURN f
ORDER BY f.number DESC
LIMIT 5",Pathfinding Queries,fincen,False,False,True,
Which Countries have the most Entities as originators in Filings?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS CountryName, count(e) AS NumberOfEntities
ORDER BY NumberOfEntities DESC",Pathfinding Queries,fincen,False,False,True,
List the Filings where the originator bank country and beneficiary bank country are the same.,"MATCH (f:Filing)
WHERE f.originator_bank_country = f.beneficiary_bank_country
RETURN f",Pathfinding Queries,fincen,False,False,True,
List the first 3 entities that have been beneficiaries in filings originating from 'United Arab Emirates'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.originator_bank_country = 'United Arab Emirates'
RETURN e
LIMIT 3",Complex Retrieval Queries,fincen,False,False,False,
What are the top 5 filings by number where 'Deutsche Bank AG' is the beneficiary bank?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity {name: 'Deutsche Bank AG'})
RETURN f
ORDER BY f.number DESC
LIMIT 5",Complex Retrieval Queries,fincen,False,False,True,
Which 3 entities have been the originator in filings with the highest total amounts transferred?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WITH e, sum(f.amount) AS totalAmount
ORDER BY totalAmount DESC
LIMIT 3
RETURN e.name AS EntityName, totalAmount",Complex Retrieval Queries,fincen,False,False,True,
Which countries have entities that have filed more than 5 filings?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, count(f) AS filingsCount
WHERE filingsCount > 5
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS CountryName, count(DISTINCT e) AS EntitiesCount",Simple Aggregation Queries,fincen,False,False,False,
List the top 3 filings with the most complex routing involving multiple transit countries.,"MATCH (f:Filing)-[:ORIGINATOR]->(originator:Entity)-[:COUNTRY]->(originCountry:Country),
      (f)-[:BENEFITS]->(beneficiary:Entity)-[:COUNTRY]->(beneficiaryCountry:Country)
WHERE originCountry.code <> beneficiaryCountry.code
WITH f, count(DISTINCT originCountry) + count(DISTINCT beneficiaryCountry) AS complexity
ORDER BY complexity DESC
LIMIT 3
RETURN f",Complex Retrieval Queries,fincen,False,False,False,
Find the top 5 entities that have originated the most filings with a beneficiary bank in Germany.,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WHERE f.beneficiary_bank_country = ""Germany""
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 5
RETURN e, filingsCount",Complex Retrieval Queries,fincen,False,False,True,
What are the top 3 filings in terms of number involving entities from China as the beneficiaries in 2001?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {name: ""China""})
WHERE f.begin.year = 2001
RETURN f
ORDER BY f.number DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
Which five filings involved a beneficiary bank from the United Kingdom with amounts over 2 million USD?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {name: ""United Kingdom""})
WHERE f.amount > 2000000
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Complex Retrieval Queries,fincen,False,False,False,
List the three entities with the most filings where the originator bank is located in Singapore.,"MATCH (e:Entity)-[:FILED]->(f:Filing {originator_bank_country: ""Singapore""})
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e, filingsCount",Complex Retrieval Queries,fincen,False,False,False,
Which three countries have entities that were the originators in the most filings in 2002?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WHERE f.begin.year = 2002
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS CountryName, filingsCount
ORDER BY filingsCount DESC",Complex Retrieval Queries,fincen,False,False,True,
Find the top 5 entities that benefited from filings in 2003.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.begin.year = 2003
RETURN e, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5",Complex Retrieval Queries,fincen,False,False,True,
"What are the top 3 originator bank countries in filings involving an amount greater than 500,000 USD in 2004?","MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.amount > 500000 AND f.begin.year = 2004
RETURN f.originator_bank_country AS OriginatorCountry, count(f) AS FilingsCount
ORDER BY FilingsCount DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
List the top 5 filings with the shortest duration between begin and end in 2005.,"MATCH (f:Filing)
WHERE f.begin.year = 2005 AND f.end.year = 2005
RETURN f
ORDER BY duration.between(f.begin, f.end) ASC
LIMIT 5",Complex Retrieval Queries,fincen,False,False,True,
List the top 5 countries by the number of entities they host.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, count(e) AS NumberOfEntities
ORDER BY NumberOfEntities DESC
LIMIT 5",Simple Aggregation Queries,fincen,False,False,False,
Which three beneficiary banks were involved in filings with the highest amounts in 2006?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.begin.year = 2006
RETURN e.name AS BeneficiaryBank, f.amount AS Amount
ORDER BY f.amount DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
Find the top 5 countries where entities are located that filed filings with an amount over 1 million USD in 2008.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.amount > 1000000 AND f.begin.year = 2008
WITH e
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name, count(e) AS num_entities
ORDER BY num_entities DESC
LIMIT 5",Complex Retrieval Queries,fincen,False,False,True,
Which three filings had the longest duration from begin to end in 2009?,"MATCH (f:Filing)
WHERE f.begin >= datetime('2009-01-01T00:00:00Z') AND f.end <= datetime('2009-12-31T23:59:59Z')
RETURN f
ORDER BY duration.between(f.begin, f.end) DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
List the top 5 entities that have filed the most filings where the beneficiary bank is located in the United States.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.beneficiary_bank_country = ""United States""
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 5
RETURN e.name, filingsCount",Complex Retrieval Queries,fincen,False,False,True,
Which three countries are most frequently listed as the originator bank country in filings during 2010?,"MATCH (f:Filing)
WHERE f.begin.year = 2010
RETURN f.originator_bank_country AS Country, count(f) AS Filings
ORDER BY Filings DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
Find the top 5 filings with the largest amount transferred in 2011.,"MATCH (f:Filing)
WHERE f.begin.year = 2011
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Complex Retrieval Queries,fincen,False,False,True,
What are the top 3 originator banks by the number of filings with an end date in 2012?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.end >= datetime('2012-01-01T00:00:00Z') AND f.end <= datetime('2012-12-31T23:59:59Z')
RETURN e.name AS OriginatorBank, count(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
Which three filings have the highest amount transferred and involve a UK beneficiary bank?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.beneficiary_bank_country = ""United Kingdom""
RETURN f
ORDER BY f.amount DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
List the top 5 entities by the number of filings concerning them in 2013.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WHERE f.begin >= datetime('2013-01-01T00:00:00Z') AND f.end <= datetime('2013-12-31T23:59:59Z')
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 5
RETURN e.name, filingsCount",Complex Retrieval Queries,fincen,False,False,True,
Which three countries have entities that benefited from the highest amount in filings in 2014?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.begin.year = 2014
RETURN c.name AS Country, sum(f.amount) AS TotalAmount
ORDER BY TotalAmount DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,False,
What are the top 5 beneficiary banks in terms of the total amount transferred in filings during 2016?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.begin.year = 2016
RETURN e.name AS BeneficiaryBank, sum(f.amount) AS TotalAmountTransferred
ORDER BY TotalAmountTransferred DESC
LIMIT 5",Complex Retrieval Queries,fincen,False,False,True,
What are the top 3 entities by the number of filings they originated in 2007?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WHERE f.begin >= datetime('2007-01-01T00:00:00Z') AND f.begin <= datetime('2007-12-31T23:59:59Z')
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e.name, filingsCount",Complex Retrieval Queries,fincen,False,False,True,
What are the names of all entities in 'United Kingdom'?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: 'United Kingdom'})
RETURN e.name",Simple Aggregation Queries,fincen,False,False,False,
How many filings were ended in the year 2015?,"MATCH (f:Filing)
WHERE f.end >= datetime('2015-01-01T00:00:00Z') AND f.end <= datetime('2015-12-31T23:59:59Z')
RETURN count(f) AS filings_ended_in_2015",Simple Aggregation Queries,fincen,False,False,False,
What are the top 3 originator banks by the number of filings they initiated?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
RETURN e.name AS OriginatorBank, count(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
Which 5 entities are most frequently listed as originators in filings from 2010 to 2015?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WHERE f.begin >= datetime('2010-01-01T00:00:00Z') AND f.end <= datetime('2015-12-31T23:59:59Z')
RETURN e.name, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
Show the first 3 originator countries by the total amount sent in transactions.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS OriginatorCountry, sum(f.amount) AS TotalAmount
ORDER BY TotalAmount DESC
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
List the top 5 beneficiary banks by the total amount received from filings.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
RETURN e.name AS BeneficiaryBank, sum(f.amount) AS TotalAmountReceived
ORDER BY TotalAmountReceived DESC
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
Which 3 filings have the shortest duration from begin to end date?,"MATCH (f:Filing)
WHERE f.begin IS NOT NULL AND f.end IS NOT NULL
RETURN f
ORDER BY duration.between(f.begin, f.end)
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
What are the 3 most frequent beneficiary banks in transactions over $1 million?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.amount > 1000000
RETURN e.name AS BeneficiaryBank, count(f) AS TransactionsCount
ORDER BY TransactionsCount DESC
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
List the first 5 countries by the number of filings where they are the beneficiary.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c, count(f) AS filingsCount
ORDER BY filingsCount DESC
RETURN c.name AS CountryName, filingsCount
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
Show the top 3 originator banks by the total number of transactions in 2014.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.begin >= datetime('2014-01-01T00:00:00Z') AND f.begin <= datetime('2014-12-31T23:59:59Z')
WITH e, count(f) AS transactions
ORDER BY transactions DESC
LIMIT 3
RETURN e.name AS OriginatorBank, transactions",Simple Retrieval Queries,fincen,False,False,True,
Which 5 filings involved the highest number of entities as beneficiaries?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WITH f, count(e) AS numEntities
ORDER BY numEntities DESC
LIMIT 5
RETURN f, numEntities",Simple Retrieval Queries,fincen,False,False,False,
List the first 3 entities that have filed the most number of transactions in 2015.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.begin_date_format >= '2015-01-01T00:00:00Z' AND f.end_date_format <= '2015-12-31T23:59:59Z'
WITH e, count(f) AS transactions
ORDER BY transactions DESC
LIMIT 3
RETURN e, transactions",Simple Retrieval Queries,fincen,False,False,True,
What are the top 5 countries based on the number of originator entities they have?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country)
WHERE exists{(e)-[:ORIGINATOR]->(:Filing)}
WITH c, count(e) AS originator_count
ORDER BY originator_count DESC
LIMIT 5
RETURN c.name AS country_name, originator_count",Simple Retrieval Queries,fincen,False,False,True,
Show the first 5 entities that have been beneficiaries the most times.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WITH e, count(f) AS benefitsCount
ORDER BY benefitsCount DESC
LIMIT 5
RETURN e, benefitsCount",Simple Retrieval Queries,fincen,False,False,True,
List the top 3 filings with the highest amount.,"MATCH (f:Filing)
RETURN f
ORDER BY f.amount DESC
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
Which 3 countries have the highest number of beneficiary entities?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, count(e) AS NumberOfBeneficiaries
ORDER BY NumberOfBeneficiaries DESC
LIMIT 3",Simple Retrieval Queries,fincen,False,False,False,
Show the top 5 originator banks by the total amount of transactions.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
RETURN e.name AS OriginatorBank, sum(f.amount) AS TotalAmount
ORDER BY TotalAmount DESC
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
Which 5 entities have been concerned the most in filings?,"MATCH (e:Entity)-[:CONCERNS]->(f:Filing)
RETURN e, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5",Simple Retrieval Queries,fincen,False,False,False,
What are the first 3 banks that have filed the most filings?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3
RETURN e.name AS BankName, filings_count",Simple Retrieval Queries,fincen,False,False,True,
List the top 5 countries by the number of filings where they are the originator.,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)-[:ORIGINATOR]->(f:Filing)
RETURN c.name AS Country, count(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
What is the average amount of filings that ended in 2017?,"MATCH (f:Filing)
WHERE f.end >= datetime('2017-01-01T00:00:00Z') AND f.end <= datetime('2017-12-31T23:59:59Z')
RETURN avg(f.amount) AS average_amount",Simple Aggregation Queries,fincen,False,False,True,
How many countries are represented by the beneficiary banks in the filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN count(DISTINCT c) AS num_countries",Simple Aggregation Queries,fincen,False,False,True,
What are the entities concerned in the top 5 filings by amount?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
RETURN e
ORDER BY f.amount DESC
LIMIT 5",Simple Aggregation Queries,fincen,False,False,True,
List the 3 most recent filings in the database.,"MATCH (f:Filing)
RETURN f
ORDER BY f.end DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
Which entities are associated with originator bank 'CIMB Bank Berhad'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank = 'CIMB Bank Berhad'
RETURN e",Simple Aggregation Queries,fincen,False,False,True,
Find all entities that are beneficiaries in filings where the amount is greater than 1000000.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.amount > 1000000
RETURN e",Simple Aggregation Queries,fincen,False,False,True,
Who are the top 3 originator banks with the most filings in 2015?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.begin_date_format >= '2015-01-01T00:00:00Z' AND f.end_date_format <= '2015-12-31T23:59:59Z'
RETURN e.name AS OriginatorBank, count(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
Find the top 3 countries where entities have filed the most number of filings in 2017.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.begin.year = 2017
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS CountryName, filingsCount",Complex Retrieval Queries,fincen,False,False,True,
Which three entities have filed the most number of filings between 2010 and 2015?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.begin >= datetime('2010-01-01T00:00:00Z') AND f.end <= datetime('2015-12-31T23:59:59Z')
RETURN e.name, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
List the top 5 countries by the number of filings originating from them.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS CountryName, count(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 5",Complex Retrieval Queries,fincen,False,False,True,
Retrieve the first 3 filings where the originator bank country is 'Singapore' and the beneficiary bank country is 'United Kingdom'.,"MATCH (f:Filing)
WHERE f.originator_bank_country = 'Singapore' AND f.beneficiary_bank_country = 'United Kingdom'
RETURN f
LIMIT 3",Simple Retrieval Queries,fincen,False,False,False,
What are the names of the top 5 originator banks in filings that ended in the year 2014?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.end >= datetime('2014-01-01T00:00:00Z') AND f.end < datetime('2015-01-01T00:00:00Z')
RETURN e.name AS OriginatorBankName, count(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
List the first 3 countries where the filings have originated from entities based in 'Angola'.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: 'Angola'}),
      (e)-[:FILED]->(f:Filing)-[:ORIGINATOR]->(origin:Entity)-[:COUNTRY]->(originCountry:Country)
RETURN DISTINCT originCountry.name
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
What are the names of the top 5 beneficiary banks in filings that have an amount greater than 200000?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.amount > 200000
RETURN e.name AS BeneficiaryBankName, count(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
List the first 3 entities that have filed the most number of filings concerning banks in 'Singapore'.,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:CONCERNS]->(bank:Entity)
WHERE f.originator_bank_country = 'Singapore'
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e, filingsCount",Simple Retrieval Queries,fincen,False,False,True,
Retrieve the first 3 filings where the beneficiary bank country is 'United Kingdom' and the amount is above 100000.,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.amount > 100000
RETURN f
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
What are the names of the top 3 banks that served as beneficiary banks in the most filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
RETURN e.name AS BankName, count(f) AS FilingsCount
ORDER BY FilingsCount DESC
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
List the origin countries of the first 5 filings by 'The Bank of New York Mellon Corp.',"MATCH (e:Entity {name: ""The Bank of New York Mellon Corp.""})-[:FILED]->(f:Filing)
RETURN DISTINCT f.originator_bank_country
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
Find the top 3 entities that have filed the most number of filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
RETURN e, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
Which 5 filings have the earliest begin dates?,"MATCH (f:Filing)
RETURN f
ORDER BY f.begin
LIMIT 5",Simple Retrieval Queries,fincen,False,False,False,
Retrieve the first 5 countries with a top-level domain of 'AO'.,"MATCH (c:Country {tld: 'AO'})
RETURN c
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
What are the names of the top 3 entities that originated filings with amounts over 1000000?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WHERE f.amount > 1000000
RETURN e.name AS EntityName, count(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
List the first 3 filings where the originator bank is 'CIMB Bank Berhad'.,"MATCH (f:Filing {originator_bank: 'CIMB Bank Berhad'})
RETURN f
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
What are the names of the first 5 entities that are beneficiaries in filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
RETURN e.name AS EntityName
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
Find the top 3 countries that have entities with the most filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS CountryName, filingsCount
ORDER BY filingsCount DESC",Simple Retrieval Queries,fincen,False,False,False,
Which 5 filings have a beneficiary bank country of 'Singapore' and amount greater than 500000?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'Singapore' AND f.amount > 500000
RETURN f
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
List all entities that are the originator for filings involving banks in 'Singapore'.,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WHERE f.originator_bank_country = 'Singapore'
RETURN e",Simple Retrieval Queries,fincen,False,False,True,
Retrieve the first 3 beneficiary banks located in 'United Kingdom'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'United Kingdom'})
RETURN e.name AS BeneficiaryBank
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
What are the names of the entities that have filed between '2015-01-01' and '2015-12-31'?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.begin >= datetime('2015-01-01T00:00:00Z') AND f.end <= datetime('2015-12-31T23:59:59Z')
RETURN DISTINCT e.name",Simple Retrieval Queries,fincen,False,False,True,
Find the top 5 filings with the highest amounts.,"MATCH (f:Filing)
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
Which entities are connected to the country with the code 'SGP'?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {code: 'SGP'})
RETURN e",Simple Retrieval Queries,fincen,False,False,True,
List the first 3 filings made by 'The Bank of New York Mellon Corp.',"MATCH (e:Entity {name: ""The Bank of New York Mellon Corp.""})-[:FILED]->(f:Filing)
RETURN f
ORDER BY f.begin
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
What are the names of the top 5 countries by number of filings?,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)-[:FILED]->(f:Filing)
WITH c.name AS countryName, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 5
RETURN countryName, filingsCount",Simple Retrieval Queries,fincen,False,False,False,
Find the top 3 entities that are concerned in filings where the amount is above 500000.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WHERE f.amount > 500000
RETURN e, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
List the first 3 entities by the number of concerns they have in filings.,"MATCH (e:Entity)-[:CONCERNS]->(f:Filing)
WITH e, count(f) AS concernsCount
ORDER BY concernsCount DESC
LIMIT 3
RETURN e, concernsCount",Simple Retrieval Queries,fincen,False,False,True,
List the first 5 countries connected to entities that have filed more than 10 filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, count(f) AS filingsCount
WHERE filingsCount > 10
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN DISTINCT c
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
Retrieve the top 5 filings with beneficiary banks located in 'Singapore' and amounts less than 300000.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE c.name = 'Singapore' AND f.amount < 300000
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
List the first 3 entities that have filed the most number of filings with a beneficiary bank country of 'United Kingdom'.,"MATCH (e:Entity)-[:FILED]->(f:Filing {beneficiary_bank_country: 'United Kingdom'})
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e, filingsCount",Simple Retrieval Queries,fincen,False,False,True,
Retrieve the first 3 filings where the beneficiary bank country is 'Singapore' and the amount is above 200000.,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'Singapore' AND f.amount > 200000
RETURN f
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
What are the names of the top 5 entities that are originators in filings with an originator bank country of 'Singapore'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank_country = 'Singapore'
RETURN e.name
ORDER BY e.name
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
List the first 3 entities that are concerned in filings with a beneficiary bank country of 'United Kingdom' and an amount greater than 1000000.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.amount > 1000000
RETURN e
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
Retrieve the first 3 filings with a beneficiary bank country of 'United Kingdom' and an amount less than 500000.,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.amount < 500000
RETURN f
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
What are the names of the top 5 entities that have the most filings with a beneficiary bank country of 'Singapore'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.beneficiary_bank_country = 'Singapore'
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 5
RETURN e.name AS EntityName, filingsCount",Simple Retrieval Queries,fincen,False,False,True,
List the first 3 entities that are originators in filings where the originator bank is 'CIMB Bank Berhad' and the amount is above 500000.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank = 'CIMB Bank Berhad' AND f.amount > 500000
RETURN e
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
Retrieve the first 3 filings where the originator bank country is 'United Kingdom' and the amount is above 200000.,"MATCH (f:Filing)
WHERE f.originator_bank_country = 'United Kingdom' AND f.amount > 200000
RETURN f
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
What are the names of the top 5 entities that have originator banks in 'Angola'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank_country = 'Angola'
RETURN e.name AS EntityName
ORDER BY e.name
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
List the first 3 entities that have filed the most number of filings with a beneficiary bank in 'Barclays Bank Plc'.,"MATCH (e:Entity)-[:FILED]->(f:Filing {beneficiary_bank: 'Barclays Bank Plc'})
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e",Simple Retrieval Queries,fincen,False,False,True,
Retrieve the first 3 countries connected to entities that are beneficiaries in filings with amounts over 1000000.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.amount > 1000000
RETURN c
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
What are the names of the top 5 filings in terms of amount where the originator bank is 'CIMB Bank Berhad'?,"MATCH (f:Filing {originator_bank: 'CIMB Bank Berhad'})
RETURN f.id AS FilingID, f.amount AS Amount
ORDER BY f.amount DESC
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
List the first 3 entities that are originators in filings with a beneficiary bank country of 'United Kingdom' and amount less than 500000.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.amount < 500000
RETURN e
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
Retrieve the first 3 filings with a beneficiary bank country of 'Singapore' and an amount greater than 200000.,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'Singapore' AND f.amount > 200000
RETURN f
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
What are the names of the top 5 originator banks for filings that started in the year 2015?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.begin_date_format STARTS WITH '2015'
RETURN e.name AS OriginatorBankName, count(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
List the first 3 entities that are concerned in filings with an amount greater than 1000000.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WHERE f.amount > 1000000
RETURN e
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
Retrieve the first 3 filings where the beneficiary bank country is 'United Kingdom' and the beneficiary iso is 'GBR'.,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.beneficiary_iso = 'GBR'
RETURN f
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
What are the names of the top 5 entities that have benefited from filings originated by banks in 'Singapore'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.originator_bank_country = 'Singapore'
RETURN e.name AS EntityName, count(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
List the first 3 entities that originated filings with a beneficiary bank country of 'United Kingdom' and amount over 500000.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.amount > 500000
RETURN e
LIMIT 3",Simple Retrieval Queries,fincen,True,False,False,
Retrieve the first 3 filings with an originator bank country of 'Angola' and a beneficiary bank country of 'Singapore'.,"MATCH (f:Filing)
WHERE f.originator_bank_country = 'Angola' AND f.beneficiary_bank_country = 'Singapore'
RETURN f
LIMIT 3",Simple Retrieval Queries,fincen,False,False,False,
What are the names of the top 3 entities that have filings with an originator iso code of 'SGP'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_iso = 'SGP'
RETURN e.name AS EntityName
ORDER BY count(f) DESC
LIMIT 3",Simple Retrieval Queries,fincen,False,False,False,
Find the top 5 countries where the entities have filed the least number of filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, count(f) AS filingsCount
ORDER BY filingsCount ASC
LIMIT 5
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS CountryName, filingsCount
ORDER BY filingsCount ASC",Simple Retrieval Queries,fincen,False,False,True,
List the first 3 entities that benefit from filings where the originator bank is 'The Bank of New York Mellon Corp.',"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.originator_bank = 'The Bank of New York Mellon Corp.'
RETURN e
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
What are the names of the first 3 entities that originated filings with a beneficiary bank in 'Barclays Bank Plc'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.beneficiary_bank = 'Barclays Bank Plc'
RETURN e.name
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
Show the top 5 beneficiary entities based on the total amount received.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
RETURN e.name AS Beneficiary, sum(f.amount) AS TotalAmountReceived
ORDER BY TotalAmountReceived DESC
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
What are the first 3 filings with the most number of concerns?,"MATCH (f:Filing)
WITH f, count{(f)-[:CONCERNS]->(:Entity)} AS concernsCount
ORDER BY concernsCount DESC
LIMIT 3
RETURN f",Simple Retrieval Queries,fincen,False,False,True,
Which 5 filings have the longest duration from begin to end date?,"MATCH (f:Filing)
WHERE f.begin IS NOT NULL AND f.end IS NOT NULL
RETURN f, duration.between(f.begin, f.end) AS Duration
ORDER BY Duration DESC
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
Which 5 filings have the highest amount transferred between 2015 and 2017?,"MATCH (f:Filing)
WHERE f.begin >= datetime('2015-01-01T00:00:00Z') AND f.end <= datetime('2017-12-31T23:59:59Z')
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Complex Retrieval Queries,fincen,False,False,True,
What are the names of the top 3 countries by the number of originator banks based on filings?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS countryName, count(DISTINCT f.originator_bank) AS numberOfBanks
ORDER BY numberOfBanks DESC
LIMIT 3
RETURN countryName, numberOfBanks",Complex Retrieval Queries,fincen,False,False,False,
Show the first 5 filings with the most entities involved as concerns from different sectors.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WITH f, count(DISTINCT e) AS entitiesCount
ORDER BY entitiesCount DESC
LIMIT 5
RETURN f, entitiesCount",Simple Retrieval Queries,fincen,False,False,True,
List the top 3 entities by the number of filings they are involved in as originators in the technology sector.,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WHERE exists{(f)-[:CONCERNS]->(:Entity {sector: 'technology'})}
RETURN e.name, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,Entity.sector
Which 5 countries have the highest number of filings involving transactions below $1 million?,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)<-[:CONCERNS|:BENEFITS|:ORIGINATOR]-(f:Filing)
WHERE f.amount < 1000000
RETURN c.name, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5",Simple Retrieval Queries,fincen,True,False,False,
What are the top 3 filings with the most entities involved as concerns from the same country?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, c, count(e) AS entitiesCount
ORDER BY entitiesCount DESC
RETURN f.id AS FilingID, f.begin_date AS BeginDate, f.end_date AS EndDate, c.name AS Country, entitiesCount
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
Show the first 5 countries with the highest number of filings involving transactions involving multiple countries.,"MATCH (f:Filing)
WHERE f.originator_bank_country IS NOT NULL AND f.beneficiary_bank_country IS NOT NULL
  AND f.originator_bank_country <> f.beneficiary_bank_country
WITH f.originator_bank_country AS originCountry, f.beneficiary_bank_country AS beneficiaryCountry
MATCH (c:Country)
WHERE c.code IN [originCountry, beneficiaryCountry]
WITH c, count(f) AS filingsCount
RETURN c.name AS CountryName, filingsCount
ORDER BY filingsCount DESC
LIMIT 5",Simple Retrieval Queries,fincen,False,False,False,
List the top 3 filings with the highest number of entities involved as originators from different sectors.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WITH f, count(DISTINCT e) AS numEntities
ORDER BY numEntities DESC
LIMIT 3
RETURN f, numEntities",Simple Retrieval Queries,fincen,False,False,True,
Which 5 countries have the highest number of filings where they are both originator and beneficiary in transactions involving multiple currencies?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country),
      (f)-[:BENEFICIARY]->(e)
WHERE f.originator_iso IS NOT NULL AND f.beneficiary_iso IS NOT NULL
  AND f.originator_iso <> f.beneficiary_iso
WITH c, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5
RETURN c.name AS Country, filings_count",Simple Retrieval Queries,fincen,False,False,True,BENEFICIARY
What are the top 3 filings with the highest number of entities involved as originators from the same sector?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:FILED]->(f2:Filing)
WITH f, count(e) AS entitiesCount
ORDER BY entitiesCount DESC
LIMIT 3
RETURN f, entitiesCount",Simple Retrieval Queries,fincen,False,False,True,
Show the first 5 filings with the longest duration and involve entities from more than three different countries.,"MATCH (f:Filing)
WHERE f.end IS NOT NULL AND f.begin IS NOT NULL
WITH f, duration.between(f.begin, f.end) AS dur
ORDER BY dur DESC
LIMIT 5
WITH f
MATCH (f)-[:CONCERNS|:BENEFITS|:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, count(DISTINCT c) AS countryCount
WHERE countryCount > 3
RETURN f",Simple Retrieval Queries,fincen,True,False,False,
List the top 3 beneficiary banks by the number of filings involving transactions over $2 million.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.amount > 2000000
RETURN e.name AS BeneficiaryBank, count(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
Which 5 countries have the most filings involving entities from more than two different sectors?,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)-[:FILED]->(f:Filing)
WITH c, count(DISTINCT e) AS sectorCount
WHERE sectorCount > 2
RETURN c.name AS Country, count(f) AS FilingsCount
ORDER BY FilingsCount DESC
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
What are the top 3 filings with the most number of different beneficiary banks involved?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WITH f, count(DISTINCT e.beneficiary_bank) AS num_beneficiary_banks
ORDER BY num_beneficiary_banks DESC
LIMIT 3
RETURN f, num_beneficiary_banks",Simple Retrieval Queries,fincen,False,False,False,Entity.beneficiary_bank
Show the first 5 filings with the most entities involved as benefits from the same country.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, c, count(e) AS entitiesCount
ORDER BY entitiesCount DESC
RETURN f, c.name AS Country, entitiesCount
LIMIT 5",Simple Retrieval Queries,fincen,False,False,False,
List the top 3 entities by the number of filings they are involved in as concerns in the financial sector.,"MATCH (e:Entity)-[:CONCERNS]->(f:Filing)
WHERE e.country = 'CHN' AND f.filer_org_name CONTAINS 'Financial'
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e.name, filingsCount",Simple Retrieval Queries,fincen,False,False,True,
Which 5 countries have the highest total amount of transactions where they are the originator?,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)-[:ORIGINATOR]->(f:Filing)
RETURN c.name AS Country, sum(f.amount) AS TotalAmount
ORDER BY TotalAmount DESC
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
What are the first 3 filings with the highest number of entities listed as benefits from different countries?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, count(DISTINCT c) AS num_countries
ORDER BY num_countries DESC
RETURN f
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
Show the top 5 filings with the most entities involved as originators from different sectors.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WITH f, count(DISTINCT e) AS entities_count
ORDER BY entities_count DESC
LIMIT 5
RETURN f, entities_count",Simple Retrieval Queries,fincen,False,False,True,
List the first 3 filings with the highest number of entities involved as originators from the same country.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, c, count(e) AS numEntities
ORDER BY numEntities DESC
RETURN f, c.name AS countryName, numEntities
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
Which 5 countries have the most filings as beneficiaries in the first half of any year?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE date(f.begin).month <= 6
WITH c, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 5
RETURN c.name AS Country, filingsCount",Simple Retrieval Queries,fincen,False,False,True,
What are the top 3 beneficiary banks by the number of filings involving transactions from Europe?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE c.name IN ['Albania', 'Andorra', 'Armenia', 'Austria', 'Azerbaijan', 'Belarus', 'Belgium', 'Bosnia and Herzegovina', 'Bulgaria', 'Croatia', 'Cyprus', 'Czech Republic', 'Denmark', 'Estonia', 'Finland', 'France', 'Georgia', 'Germany', 'Greece', 'Hungary', 'Iceland', 'Ireland', 'Italy', 'Kazakhstan', 'Kosovo', 'Latvia', 'Liechtenstein', 'Lithuania', 'Luxembourg', 'Malta', 'Moldova', 'Monaco', 'Montenegro', 'Netherlands', 'North Macedonia', 'Norway', 'Poland', 'Portugal', 'Romania', 'Russia', 'San Marino', 'Serbia', 'Slovakia', 'Slovenia', 'Spain', 'Sweden', 'Switzerland', 'Turkey', 'Ukraine', 'United Kingdom', 'Vatican City']
WITH e, COUNT(f) AS filings
RETURN e.name AS bank, filings
ORDER BY filings DESC
LIMIT 3",Simple Retrieval Queries,fincen,False,False,False,
"Show the first 5 countries with the highest number of filings involving transactions under $500,000.","MATCH (f:Filing)-[:CONCERNS|:BENEFITS|:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.amount < 500000
WITH c, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 5
RETURN c.name AS CountryName, filingsCount",Simple Retrieval Queries,fincen,False,False,False,
List the first 3 originator banks located in 'Australia'.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: 'Australia'})
WHERE exists{(e)-[:ORIGINATOR]->(:Filing)}
RETURN e.name AS OriginatorBank
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
List the top 3 entities by the number of filings they are involved in as beneficiary in the healthcare sector.,"MATCH (e:Entity)-[:BENEFITS]->(f:Filing)
WHERE e.sector = 'healthcare'
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e.name, filingsCount",Simple Retrieval Queries,fincen,False,False,True,Entity.sector
What are the top 5 beneficiary banks that have received funds from 'CIMB Bank Berhad'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.originator_bank = 'CIMB Bank Berhad'
RETURN e.name AS BeneficiaryBank, sum(f.amount) AS TotalReceivedFunds
ORDER BY TotalReceivedFunds DESC
LIMIT 5",Complex Retrieval Queries,fincen,True,False,False,
Which 3 filings have an end date later than '2017-01-01'?,"MATCH (f:Filing)
WHERE f.end > datetime('2017-01-01T00:00:00Z')
RETURN f
ORDER BY f.end DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,False,
What are the names of the top 3 originator banks that have initiated filings with an end date before '2005-01-01'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.end < datetime('2005-01-01T00:00:00Z')
RETURN e.name AS OriginatorBankName
ORDER BY COUNT(f) DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
List the first 3 filings where the beneficiary bank's country is 'Brazil' and the amount is over 1 million USD.,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'Brazil' AND f.amount > 1000000
RETURN f
LIMIT 3",Complex Retrieval Queries,fincen,False,False,False,
Which 3 countries have beneficiary banks that received the highest total amounts in filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, sum(f.amount) AS TotalAmount
ORDER BY TotalAmount DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
What are the top 3 entities that have originated filings concerning banks in 'Russia'?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)-[:CONCERNS]->(bank:Entity)
WHERE bank.country = 'Russia'
RETURN e.name, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
Identify the top 5 filings that ended in the year 2016 and involve an originator bank from 'Canada'.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'Canada'})
WHERE f.end >= datetime('2016-01-01T00:00:00Z') AND f.end < datetime('2017-01-01T00:00:00Z')
RETURN f
ORDER BY f.end DESC
LIMIT 5",Complex Retrieval Queries,fincen,False,False,True,
List the top 3 filings by amount where the beneficiary bank is from 'Switzerland'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'Switzerland'})
RETURN f
ORDER BY f.amount DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
Which 3 filings have the smallest number of transactions but involve a beneficiary bank from 'India'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'India'})
RETURN f
ORDER BY f.number ASC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,False,
What are the top 5 entities by number of filings where the beneficiary bank is 'HSBC'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.beneficiary_bank = 'HSBC'
RETURN e.name, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5",Complex Retrieval Queries,fincen,False,False,True,
Which 3 filings have the longest duration from beginning to end date and involve an originator bank from 'USA'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank_country = 'USA'
RETURN f, duration.between(f.begin, f.end) AS Duration
ORDER BY Duration DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
List the top 3 countries by the number of entities that have filed more than 30 filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, count(f) AS filingsCount
WHERE filingsCount > 30
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name, count(DISTINCT e) AS entityCount
ORDER BY entityCount DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
Identify the top 3 beneficiary banks that have received funds in filings where the originator bank is 'Barclays Bank Plc'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.originator_bank = 'Barclays Bank Plc'
RETURN e.name AS BeneficiaryBank, sum(f.amount) AS TotalReceivedFunds
ORDER BY TotalReceivedFunds DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,False,
Which 3 entities have the most filings as beneficiaries and are located in 'Germany'?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: 'Germany'})
WITH e
MATCH (e)<-[:BENEFITS]-(f:Filing)
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e.name, filingsCount",Complex Retrieval Queries,fincen,False,False,True,
List the first 3 entities that originated filings with an amount over 100 million USD.,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WHERE f.amount > 100000000
RETURN e
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
Which 3 filings have the smallest amount and involve an entity from 'France' as the originator?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'France'})
RETURN f
ORDER BY f.amount ASC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
What are the top 3 countries by the number of filings where they appear as the beneficiary bank country?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, count(f) AS Filings
ORDER BY Filings DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
Identify the top 5 beneficiary banks that received funds from filings where the originator bank country is 'China'.,"MATCH (f:Filing)-[:BENEFITS]->(b:Entity)
WHERE f.originator_bank_country = 'China'
RETURN b.name AS BeneficiaryBank, sum(f.amount) AS TotalReceivedFunds
ORDER BY TotalReceivedFunds DESC
LIMIT 5",Complex Retrieval Queries,fincen,False,False,False,
List the first 3 filings where the originator bank is from 'Japan'.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE c.name = 'Japan'
RETURN f
LIMIT 3",Complex Retrieval Queries,fincen,False,False,False,
What are the names of the top 3 entities by number of filings they have originated?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
RETURN e.name, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
Which 3 countries have the most entities linked as originators in the filings?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS CountryName, count(e) AS NumberOfEntities
ORDER BY NumberOfEntities DESC",Complex Retrieval Queries,fincen,False,False,True,
What are the top 5 filings by amount that involve 'The Bank of New York Mellon Corp.' as the filer?,"MATCH (e:Entity {name: ""The Bank of New York Mellon Corp.""})-[:FILED]->(f:Filing)
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Complex Retrieval Queries,fincen,False,False,True,
Which 3 beneficiary banks received the highest total amount in transactions from filings originated in 'United Kingdom'?,"MATCH (f:Filing)-[:BENEFITS]->(b:Entity)
WHERE f.originator_bank_country = 'United Kingdom'
RETURN b.name AS BeneficiaryBank, sum(f.amount) AS TotalAmount
ORDER BY TotalAmount DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,False,
List the first 3 originator banks from 'Singapore'.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'Singapore'})
RETURN e.name AS OriginatorBankName
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
What are the names of the top 3 entities that have been concerned in filings more than 20 times?,"MATCH (e:Entity)-[:CONCERNS]->(f:Filing)
WITH e, count(f) AS filingsCount
WHERE filingsCount > 20
RETURN e.name
ORDER BY filingsCount DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
"Identify the top 3 countries where the beneficiary banks are located, based on the total amount transferred.","MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, sum(f.amount) AS TotalAmountTransferred
ORDER BY TotalAmountTransferred DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,True,
Identify the top 5 countries by the number of filings where the originator bank is located.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, count(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 5",Complex Retrieval Queries,fincen,False,False,True,
Which 5 countries have the most filings involving transactions above $10 million?,"MATCH (f:Filing)-[:ORIGINATOR|:BENEFITS|:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.amount > 10000000
RETURN c.name, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5",Simple Retrieval Queries,fincen,False,False,False,
Show the top 5 countries with the most filings where they are both originator and beneficiary in transactions involving multiple currencies.,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)-[:FILED]->(f:Filing)-[:ORIGINATOR|BENEFITS]->(e2:Entity)-[:COUNTRY]->(c2:Country)
WHERE c.code <> c2.code
WITH c, count(DISTINCT f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 5
RETURN c.name AS Country, filingsCount",Simple Retrieval Queries,fincen,False,False,True,
Show the top 5 entities with the most filings as a beneficiary in the financial sector.,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:BENEFITS]->(beneficiary:Entity)
WHERE exists{ (e)-[:COUNTRY]->(:Country {name: 'Financial Sector'}) }
WITH beneficiary, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 5
RETURN beneficiary.name, filingsCount",Simple Retrieval Queries,fincen,False,False,True,
List the first 3 filings with a duration of exactly one month from begin to end date.,"MATCH (f:Filing)
WHERE duration.between(f.begin, f.end) = duration('P1M')
RETURN f
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
Which 5 filings involve the most number of different originator iso codes?,"MATCH (f:Filing)
WITH f, count(DISTINCT f.originator_iso) AS distinctOriginatorIsos
ORDER BY distinctOriginatorIsos DESC
LIMIT 5
RETURN f",Simple Retrieval Queries,fincen,False,False,True,
What are the top 3 countries with the most filings as an originator in 2012?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.begin.year = 2012
RETURN c.name AS Country, count(f) AS Filings
ORDER BY Filings DESC
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
Show the first 5 filings that involved a change in beneficiary bank during the transaction.,"MATCH (f1:Filing)-[:BENEFITS]->(e1:Entity), (f2:Filing)-[:BENEFITS]->(e2:Entity)
WHERE f1.sar_id = f2.sar_id AND f1.beneficiary_bank_id <> f2.beneficiary_bank_id
RETURN f1, f2
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
"List the top 3 countries by the number of filings with transactions over $500,000.","MATCH (f:Filing)-[:CONCERNS|:ORIGINATOR|:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.amount > 500000
RETURN c.name AS Country, count(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 3",Simple Retrieval Queries,fincen,False,False,False,
Which 5 countries have the highest total amount of transactions where they are the beneficiary?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, sum(f.amount) AS TotalAmount
ORDER BY TotalAmount DESC
LIMIT 5",Simple Retrieval Queries,fincen,False,False,False,
What are the first 3 filings with entities from three different continents as originators?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, collect(DISTINCT c.location.continent) AS continents
WHERE size(continents) >= 3
RETURN f
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
Show the top 5 countries by the number of filings they are involved in as both originator and beneficiary.,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)-[:ORIGINATOR|BENEFITS]->(f:Filing)
WITH c, count(f) AS filingsCount
RETURN c.name AS Country, filingsCount
ORDER BY filingsCount DESC
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
List the first 3 filings that involved entities from both Europe and Asia as originators.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE c.name IN ['Europe', 'Asia']
WITH f, collect(c.name) AS regions
WHERE ALL(region IN ['Europe', 'Asia'] WHERE region IN regions)
RETURN f
LIMIT 3",Simple Retrieval Queries,fincen,False,False,False,
Which 5 filings involved the most distinct banks as beneficiaries?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WITH f, count(DISTINCT e) AS distinctBanks
ORDER BY distinctBanks DESC
LIMIT 5
RETURN f, distinctBanks",Simple Retrieval Queries,fincen,False,False,True,
What are the top 3 beneficiary entities in transactions from Asia?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE c.name IN ['China', 'India', 'Indonesia', 'Pakistan', 'Bangladesh', 'Japan', 'Philippines', 'Vietnam', 'Turkey', 'Iran', 'Thailand', 'Myanmar', 'South Korea', 'Iraq', 'Afghanistan', 'Saudi Arabia', 'Uzbekistan', 'Malaysia', 'Yemen', 'Nepal', 'North Korea', 'Sri Lanka', 'Kazakhstan', 'Syria', 'Cambodia', 'Jordan', 'Azerbaijan', 'United Arab Emirates', 'Tajikistan', 'Israel', 'Laos', 'Lebanon', 'Kyrgyzstan', 'Turkmenistan', 'Singapore', 'Oman', 'State of Palestine', 'Kuwait', 'Georgia', 'Mongolia', 'Armenia', 'Qatar', 'Bahrain', 'Timor-Leste', 'Cyprus', 'Bhutan', 'Maldives', 'Brunei']
WITH e, count(f) AS transactions
ORDER BY transactions DESC
LIMIT 3
RETURN e.name AS EntityName, transactions",Simple Retrieval Queries,fincen,False,False,True,
Show the first 5 originator entities by the total number of transactions they initiated.,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WITH e, count(f) AS transactions
ORDER BY transactions DESC
LIMIT 5
RETURN e, transactions",Simple Retrieval Queries,fincen,False,False,True,
List the top 3 countries based on the number of beneficiary banks they have.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c, count(e) AS num_beneficiary_banks
ORDER BY num_beneficiary_banks DESC
RETURN c.name AS country_name, num_beneficiary_banks
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
Which 5 filings have entities from more than one country as originators?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, count(DISTINCT c) AS numCountries
WHERE numCountries > 1
RETURN f
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
What are the first 3 filings with the smallest amount transferred?,"MATCH (f:Filing)
RETURN f
ORDER BY f.amount ASC
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
Show the top 5 beneficiary countries by the total amount received in transactions.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, sum(f.amount) AS TotalAmountReceived
ORDER BY TotalAmountReceived DESC
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
List the first 3 countries by the number of originator banks they have.,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)<-[:ORIGINATOR]-(f:Filing)
WITH c, count(DISTINCT e) AS numOriginatorBanks
ORDER BY numOriginatorBanks DESC
RETURN c.name AS CountryName, numOriginatorBanks
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
Which 5 entities have the most filings concerning them from Germany?,"MATCH (e:Entity)<-[:CONCERNS]-(f:Filing)-[:ORIGINATOR]->(origin:Entity)-[:COUNTRY]->(c:Country {name: ""Germany""})
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 5
RETURN e.name, filingsCount",Simple Retrieval Queries,fincen,False,False,True,
What are the top 3 originator banks in filings from the United Kingdom?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank_country = ""United Kingdom""
RETURN e.name AS OriginatorBank, count(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
Show the first 5 filings with the largest amount of money transferred.,"MATCH (f:Filing)
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Simple Retrieval Queries,fincen,False,False,False,
List the filings where the beneficiary bank country is 'United Kingdom'.,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom'
RETURN f",Simple Aggregation Queries,fincen,False,False,True,
List the top 3 countries with the most filings as a beneficiary in 2013.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.begin.year = 2013
RETURN c.name AS Country, count(f) AS Filings
ORDER BY Filings DESC
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
What are the first 3 countries with entities that have filed the most in the technology sector?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE e.sector = 'technology'
WITH e, count(f) AS filings
ORDER BY filings DESC
LIMIT 3
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, filings",Simple Retrieval Queries,fincen,False,False,True,Entity.sector
What are the first 3 filings with the highest number of entities listed as concerns from different countries?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, count(DISTINCT c) AS distinctCountries
ORDER BY distinctCountries DESC
LIMIT 3
RETURN f",Simple Retrieval Queries,fincen,False,False,False,
Which 5 filings had the most entities listed as originators?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WITH f, count(e) AS originator_count
ORDER BY originator_count DESC
LIMIT 5
RETURN f, originator_count",Simple Retrieval Queries,fincen,False,False,True,
Show the top 5 filings with the largest number of concerns.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WITH f, count(e) AS concerns_count
ORDER BY concerns_count DESC
LIMIT 5
RETURN f, concerns_count",Simple Retrieval Queries,fincen,False,False,True,
List the first 3 filings with entities from more than three different countries as beneficiaries.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, count(DISTINCT c) AS countries
WHERE countries > 3
RETURN f
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
Which 5 filings have the most distinct beneficiary iso codes involved?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WITH f, count(DISTINCT e.country) AS distinctBeneficiaryIsoCount
ORDER BY distinctBeneficiaryIsoCount DESC
LIMIT 5
RETURN f, distinctBeneficiaryIsoCount",Simple Retrieval Queries,fincen,False,False,True,
What are the top 3 beneficiary banks in transactions involving multiple currencies?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.originator_iso IS NOT NULL AND f.beneficiary_iso IS NOT NULL AND f.originator_iso <> f.beneficiary_iso
RETURN e.name AS BeneficiaryBank, count(f) AS Transactions
ORDER BY Transactions DESC
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
Show the first 5 filings with the most entities involved as concerns from the same sector.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WITH f, count(e) AS entitiesCount
ORDER BY entitiesCount DESC
LIMIT 5
RETURN f, entitiesCount",Simple Retrieval Queries,fincen,False,False,True,
"List the top 3 originator banks by the number of filings involving transactions below $50,000.","MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.amount < 50000
RETURN e.name AS OriginatorBank, count(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 3",Simple Retrieval Queries,fincen,False,False,False,
Which 5 countries have the most filings as originators in the last quarter of any year?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.begin.month >= 10 AND f.begin.month <= 12
WITH c, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 5
RETURN c.name AS Country, filingsCount",Simple Retrieval Queries,fincen,False,False,True,
What are the top 3 filings with the highest number of entities involved as concerns from different sectors?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WITH f, count(DISTINCT e) AS entitiesCount
ORDER BY entitiesCount DESC
LIMIT 3
RETURN f, entitiesCount",Simple Retrieval Queries,fincen,False,False,True,
Show the top 5 entities by the number of filings they are involved in as both originator and beneficiary.,"MATCH (e:Entity)-[:ORIGINATOR|:BENEFITS]->(f:Filing)
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 5
RETURN e.name AS EntityName, filingsCount",Simple Retrieval Queries,fincen,False,False,True,
List the first 3 filings with the longest duration and involve entities from more than two countries.,"MATCH (f:Filing)-[:CONCERNS|:ORIGINATOR|:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, duration.between(f.begin, f.end) AS dur, collect(DISTINCT c.name) AS countries
WHERE size(countries) > 2
RETURN f.id, f.begin, f.end, dur, countries
ORDER BY dur DESC
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
Which 5 countries have the highest number of filings with entities as both originator and beneficiary?,"MATCH (f:Filing)-[:ORIGINATOR]->(e1:Entity), (f)-[:BENEFITS]->(e2:Entity)
WHERE e1.id = e2.id
WITH e1, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5
MATCH (e1)-[:COUNTRY]->(c:Country)
RETURN c.name AS country, filings_count",Simple Retrieval Queries,fincen,False,False,True,
What are the first 3 filings with the highest total number of concerns?,"MATCH (f:Filing)
WITH f, count{(f)-[:CONCERNS]->(:Entity)} AS concernsCount
ORDER BY concernsCount DESC
RETURN f
LIMIT 3",Simple Retrieval Queries,fincen,False,False,False,
Show the top 5 filings with the most entities involved as originators from the same country.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, c, count(e) AS numEntities
ORDER BY numEntities DESC
LIMIT 5
RETURN f, c.name AS Country, numEntities",Simple Retrieval Queries,fincen,False,False,True,
List the first 3 countries by the number of filings they have as a beneficiary in transactions involving multiple currencies.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.originator_iso IS NOT NULL AND f.beneficiary_iso IS NOT NULL AND f.originator_iso <> f.beneficiary_iso
WITH c, COUNT(f) AS filingsCount
ORDER BY filingsCount DESC
RETURN c.name AS CountryName, filingsCount
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
Which 5 countries have the highest total number of filings as an originator?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 5
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS CountryName, filingsCount",Simple Retrieval Queries,fincen,False,False,True,
What are the top 3 filings with the most entities listed as originators from different countries?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, count(DISTINCT c) AS distinctCountries
ORDER BY distinctCountries DESC
LIMIT 3
RETURN f",Simple Retrieval Queries,fincen,False,False,True,
Show the first 5 entities that have filed the most number of transactions involving multiple countries.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE exists {
    MATCH (f)-[:ORIGINATOR]->(origin:Entity)-[:COUNTRY]->(originCountry:Country),
          (f)-[:BENEFITS]->(benefit:Entity)-[:COUNTRY]->(benefitCountry:Country)
    WHERE originCountry.code <> benefitCountry.code
}
RETURN e, count(f) AS transactions
ORDER BY transactions DESC
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
List the top 3 originator banks with the most filings involving transactions above $1 million.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.amount > 1000000
RETURN e.name AS OriginatorBank, count(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
Which 5 countries have the least number of filings as a beneficiary?,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)<-[:BENEFITS]-(f:Filing)
WITH c, count(f) AS filingsCount
ORDER BY filingsCount ASC
LIMIT 5
RETURN c.name AS Country, filingsCount",Simple Retrieval Queries,fincen,False,False,True,
What are the first 3 filings with the highest number of entities concerned from the same country?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, c, count(e) AS numEntities
ORDER BY numEntities DESC
RETURN f, c.name AS country, numEntities
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
"Show the first 5 countries with the most filings involving transactions below $100,000.","MATCH (c:Country)<-[:COUNTRY]-(e:Entity)-[:FILED]->(f:Filing)
WHERE f.amount < 100000
RETURN c.name, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
List the top 3 filings with the most entities involved as beneficiaries from the same country.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, c, count(e) AS numEntities
ORDER BY numEntities DESC
RETURN f.id AS FilingID, c.name AS Country, numEntities
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
Which 5 countries have the highest number of filings involving transactions above $2 million?,"MATCH (f:Filing)-[:CONCERNS|:ORIGINATOR|:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.amount > 2000000
RETURN c.name AS Country, count(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 5",Simple Retrieval Queries,fincen,False,False,True,
What are the first 3 filings where the originator and beneficiary are the same entity?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity), (f)-[:BENEFITS]->(e)
RETURN f
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
List the first 3 filings with entities that are both originator and beneficiary.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity), (f)-[:BENEFITS]->(e)
RETURN f, e
LIMIT 3",Simple Retrieval Queries,fincen,False,False,True,
Which 3 entities have filed the most number of filings?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
RETURN e.name, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3",Complex Retrieval Queries,fincen,False,False,False,
Which entities have filed a filing with an amount over 500000?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.amount > 500000
RETURN e",Simple Aggregation Queries,fincen,False,False,True,
What are the names of the top 5 countries by the number of originating banks?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS CountryName, count(DISTINCT e) AS NumberOfOriginatingBanks
ORDER BY NumberOfOriginatingBanks DESC
LIMIT 5",Simple Aggregation Queries,fincen,False,False,False,
Display the country codes for the top 3 countries where the originator entities of filings are located.,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.code AS CountryCode, count(e) AS OriginatorCount
ORDER BY OriginatorCount DESC
LIMIT 3",Complex Aggregation Queries,fincen,False,False,True,
List the 3 filings with the shortest duration from beginning to end.,"MATCH (f:Filing)
WHERE f.begin IS NOT NULL AND f.end IS NOT NULL
RETURN f
ORDER BY duration.between(f.begin, f.end)
LIMIT 3",Complex Aggregation Queries,fincen,False,False,True,
What are the names of the top 5 entities that originated the most filings?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 5
RETURN e.name AS EntityName, filingsCount",Complex Aggregation Queries,fincen,False,False,True,
Which 3 countries have entities that filed the most filings with an end date in 2016?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.end >= datetime('2016-01-01T00:00:00Z') AND f.end <= datetime('2016-12-31T23:59:59Z')
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name, filingsCount",Complex Aggregation Queries,fincen,False,False,True,
List the top 5 filings by number that had a beneficiary bank in 'United Kingdom'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.beneficiary_bank_country = 'United Kingdom'
RETURN f
ORDER BY f.number DESC
LIMIT 5",Complex Aggregation Queries,fincen,False,False,True,
"What are the names and locations of the top 3 entities that benefited from filings where the amount exceeded 500,000?","MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.amount > 500000
RETURN e.name AS EntityName, e.location AS Location
ORDER BY f.amount DESC
LIMIT 3",Complex Aggregation Queries,fincen,False,False,True,
How many entities are connected to a filing where the originator bank country is 'Singapore'? Limit to top 3 results.,"MATCH (f:Filing {originator_bank_country: 'Singapore'})-[:ORIGINATOR]->(e:Entity)
RETURN e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3",Complex Aggregation Queries,fincen,False,False,True,
List the countries of origin for the top 5 filings with the highest amounts.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS CountryName, f.amount AS Amount
ORDER BY f.amount DESC
LIMIT 5",Complex Aggregation Queries,fincen,False,False,True,
Which 3 filings have the largest difference in latitude between originator and beneficiary locations?,"MATCH (f:Filing)
WHERE f.origin_lat IS NOT NULL AND f.beneficiary_lat IS NOT NULL
RETURN f, abs(toFloat(f.origin_lat) - toFloat(f.beneficiary_lat)) AS lat_difference
ORDER BY lat_difference DESC
LIMIT 3",Complex Aggregation Queries,fincen,False,False,True,
Name the top 3 entities that filed the most filings with a beneficiary bank in 'United Kingdom'.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom'
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e.name AS EntityName, filingsCount",Complex Aggregation Queries,fincen,False,False,True,
What are the top 3 filings with the highest amounts that involve an entity based in 'China'?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: 'China'})
MATCH (f:Filing)-[:CONCERNS|:BENEFITS|:ORIGINATOR]->(e)
RETURN f
ORDER BY f.amount DESC
LIMIT 3",Complex Aggregation Queries,fincen,False,False,False,
List the last 3 filings by end date that concerned entities based in 'China'.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'China'})
WITH f
ORDER BY f.end DESC
LIMIT 3
RETURN f",Complex Aggregation Queries,fincen,False,False,True,
Which top 5 countries are most frequently listed as the beneficiary bank country in filings?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country IS NOT NULL
RETURN f.beneficiary_bank_country AS Country, count(f) AS FilingsCount
ORDER BY FilingsCount DESC
LIMIT 5",Complex Aggregation Queries,fincen,False,False,True,
"List the top 3 entities based on the number of filings they originated with an amount over 2,000,000.","MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WHERE f.amount > 2000000
RETURN e.name, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3",Complex Aggregation Queries,fincen,False,False,True,
List the top 3 countries by the number of entities registered there.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, count(e) AS NumberOfEntities
ORDER BY NumberOfEntities DESC
LIMIT 3",Verbose query,fincen,False,False,True,
Identify the top 5 filer organizations by the total amount of filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
RETURN e.name AS FilerOrganization, sum(f.amount) AS TotalAmount
ORDER BY TotalAmount DESC
LIMIT 5",Verbose query,fincen,False,False,True,
Which 3 countries have the most originator banks associated with filings?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name, count(e) AS num_originator_banks
ORDER BY num_originator_banks DESC
LIMIT 3",Verbose query,fincen,False,False,True,
Find the 3 highest amounts of filings that originated from the United Kingdom.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {code: ""GBR""})
RETURN f.id AS FilingID, f.amount AS Amount
ORDER BY f.amount DESC
LIMIT 3",Verbose query,fincen,False,False,True,
What are the top 5 filings based on the number of beneficiaries they concern?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WITH f, count(e) AS numBeneficiaries
ORDER BY numBeneficiaries DESC
LIMIT 5
RETURN f, numBeneficiaries",Verbose query,fincen,False,False,True,
"What are the top 5 filings by amount that were filed between January 1, 2015, and December 31, 2015?","MATCH (f:Filing)
WHERE f.begin >= datetime('2015-01-01T00:00:00Z') AND f.end <= datetime('2015-12-31T23:59:59Z')
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Complex Aggregation Queries,fincen,False,False,True,
How many filings are associated with the entity 'The Bank of New York Mellon Corp.' as both originator and beneficiary?,"MATCH (e:Entity {name: 'The Bank of New York Mellon Corp.'})
MATCH (f:Filing)-[:ORIGINATOR]->(e)
MATCH (f)-[:BENEFITS]->(e)
RETURN count(f) AS NumberOfFilings",Complex Aggregation Queries,fincen,False,False,True,
Which entities benefited from filings where the originator bank was 'CIMB Bank Berhad'? Limit to top 3 results.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.originator_bank = 'CIMB Bank Berhad'
RETURN e
LIMIT 3",Complex Aggregation Queries,fincen,False,False,True,
List the names of countries where the beneficiary bank of the filing is located. Limit to top 5 results.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN DISTINCT c.name
LIMIT 5",Complex Aggregation Queries,fincen,False,False,True,
What are the top 5 filings where the beneficiary bank country is 'United Kingdom' and the originator bank country is 'Singapore'?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.originator_bank_country = 'Singapore'
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Pathfinding Queries,fincen,False,False,False,
Which entities are connected to a country with the code 'AFG' via the COUNTRY relationship?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {code: 'AFG'})
RETURN e",Pathfinding Queries,fincen,False,False,True,
List the top 5 entities by the number of filings where the originator bank's country code is 'SGP'.,"MATCH (e:Entity)-[:FILED]->(f:Filing {originator_iso: 'SGP'})
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 5
RETURN e.name AS EntityName, filingsCount",Pathfinding Queries,fincen,False,False,True,
What are the three highest amounts filed by entities located in 'China'?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE e.country = 'CHN'
RETURN f.amount AS Amount
ORDER BY f.amount DESC
LIMIT 3",Pathfinding Queries,fincen,False,False,True,
Identify the top 3 filings where the beneficiary bank's country is 'United Kingdom' and the amount is over 500000.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'United Kingdom'})
WHERE f.amount > 500000
RETURN f, e, c
ORDER BY f.amount DESC
LIMIT 3",Pathfinding Queries,fincen,False,False,True,
List the three entities with the most filings where the originator bank's ISO code is 'SGP'.,"MATCH (e:Entity)-[:FILED]->(f:Filing {originator_iso: 'SGP'})
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e, filingsCount",Pathfinding Queries,fincen,False,False,False,
What are the top 5 filings with the largest amounts where the beneficiary bank's ISO code is 'GBR'?,"MATCH (f:Filing)
WHERE f.beneficiary_iso = 'GBR'
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Pathfinding Queries,fincen,False,False,True,
Which filings have a beneficiary bank in 'United Kingdom' and an amount greater than 1000000?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.amount > 1000000
RETURN f",Pathfinding Queries,fincen,False,False,True,
Find the first 3 entities with filings that involve a country with the top-level domain '.AF'.,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:COUNTRY]->(c:Country {tld: '.AF'})
RETURN e
LIMIT 3",Pathfinding Queries,fincen,False,False,True,
List the first 3 entities that have filed something concerning a beneficiary in Afghanistan.,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:CONCERNS]->(beneficiary:Entity)-[:COUNTRY]->(c:Country {name: ""Afghanistan""})
RETURN e
LIMIT 3",Verbose query,fincen,False,False,True,
Which three entities have the most filings where the originator bank is 'Barclays Bank Plc'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank = 'Barclays Bank Plc'
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e.name, filingsCount",Pathfinding Queries,fincen,False,False,True,
What are the three entities with the highest total filing amounts where the originator bank country is 'Singapore'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank_country = 'Singapore'
RETURN e, sum(f.amount) as total_amount
ORDER BY total_amount DESC
LIMIT 3",Pathfinding Queries,fincen,False,False,False,
Identify the top 3 entities based on the total amount of filings where the beneficiary bank's country is 'United Kingdom'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.beneficiary_bank_country = 'United Kingdom'
RETURN e.name AS EntityName, sum(f.amount) AS TotalAmount
ORDER BY TotalAmount DESC
LIMIT 3",Pathfinding Queries,fincen,False,False,True,
List the top 5 filings by number where the filing began in 2015.,"MATCH (f:Filing)
WHERE f.begin_date_format STARTS WITH '2015'
RETURN f
ORDER BY f.number DESC
LIMIT 5",Pathfinding Queries,fincen,False,False,False,
Which three entities have the most filings ending in the year 2015?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.end_date_format ENDS WITH '2015'
WITH e, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3
RETURN e.name, filings_count",Pathfinding Queries,fincen,False,False,True,
Find the first 3 countries associated with entities that have filed more than 10 filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, count(f) AS filingsCount
WHERE filingsCount > 10
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c
LIMIT 3",Pathfinding Queries,fincen,False,False,True,
What are the top 5 countries by the number of filings where the beneficiary bank country code is 'GBR'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.beneficiary_bank_country = 'GBR'
RETURN c.name AS Country, count(f) AS FilingsCount
ORDER BY FilingsCount DESC
LIMIT 5",Pathfinding Queries,fincen,False,False,True,
List the three entities with the most filings involving a beneficiary bank in 'United Kingdom' and an originator bank in 'Singapore'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.originator_bank_country = 'Singapore'
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e, filingsCount",Pathfinding Queries,fincen,False,False,True,
Which filings originated from entities in 'Singapore' and ended in 2015? Limit to top 5 results.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'Singapore'})
WHERE f.end_date_format CONTAINS '2015'
RETURN f
LIMIT 5",Complex Aggregation Queries,fincen,False,False,True,
"What are the names of entities that filed a filing with an amount greater than 1,000,000? Limit to first 3 results.","MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.amount > 1000000
RETURN e.name
LIMIT 3",Complex Aggregation Queries,fincen,False,False,False,
List the top 5 filings by amount where the beneficiary bank is 'Barclays Bank Plc'.,"MATCH (f:Filing {beneficiary_bank: 'Barclays Bank Plc'})
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Pathfinding Queries,fincen,False,False,True,
Which 3 filings have the highest number of originator entities involved?,"MATCH (f:Filing)
WITH f, count{(f)-[:ORIGINATOR]->(:Entity)} AS originatorCount
ORDER BY originatorCount DESC
LIMIT 3
RETURN f",Verbose query,fincen,False,False,True,
Identify the top 5 originator banks by the total number of filings they initiated.,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
RETURN e.name AS OriginatorBank, count(f) AS TotalFilings
ORDER BY TotalFilings DESC
LIMIT 5",Verbose query,fincen,False,False,True,
What are the first 3 filings made by 'The Bank of New York Mellon Corp.'?,"MATCH (e:Entity {name: 'The Bank of New York Mellon Corp.'})-[:FILED]->(f:Filing)
RETURN f
ORDER BY f.begin
LIMIT 3",Verbose query,fincen,False,False,True,
Which 3 filings have beneficiary banks located at a longitude less than 0?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.beneficiary_lng < ""0""
RETURN f
LIMIT 3",Verbose query,fincen,False,False,True,
Identify the top 3 entities that have filed the least amount of filings but have the highest amounts in those filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, count(f) AS filingsCount, sum(f.amount) AS totalAmount
ORDER BY filingsCount ASC, totalAmount DESC
RETURN e.name, filingsCount, totalAmount
LIMIT 3",Verbose query,fincen,False,False,True,
List the first 3 countries where the most filings have ended.,"MATCH (f:Filing)-[:CONCERNS|:BENEFITS|:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.end IS NOT NULL
RETURN c.name, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3",Verbose query,fincen,True,False,False,
What are the top 5 filings with the most entities involved as originators?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WITH f, count(e) AS numEntities
ORDER BY numEntities DESC
LIMIT 5
RETURN f, numEntities",Verbose query,fincen,False,False,True,
Which 3 filings have the shortest duration from begin to end date?,"MATCH (f:Filing)
WHERE f.begin IS NOT NULL AND f.end IS NOT NULL
RETURN f
ORDER BY duration.between(f.begin, f.end) ASC
LIMIT 3",Verbose query,fincen,False,False,False,
List the first 3 countries that have the most filings where the originator bank's country is different from the beneficiary bank's country.,"MATCH (f:Filing)
WHERE f.originator_bank_country IS NOT NULL AND f.beneficiary_bank_country IS NOT NULL
  AND f.originator_bank_country <> f.beneficiary_bank_country
WITH f.originator_bank_country AS originCountry, f.beneficiary_bank_country AS beneficiaryCountry
MATCH (c:Country)
WHERE c.code IN [originCountry, beneficiaryCountry]
WITH c, count(f) AS filingsCount
RETURN c.name AS CountryName, filingsCount
ORDER BY filingsCount DESC
LIMIT 3",Verbose query,fincen,False,False,False,
Identify the top 5 filings with the most entities involved as beneficiaries.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WITH f, count(e) AS numEntities
ORDER BY numEntities DESC
LIMIT 5
RETURN f, numEntities",Verbose query,fincen,False,False,True,
Which 3 countries have entities that have filed the most concerning filings?,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:CONCERNS]->(e2:Entity)
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS CountryName, filingsCount",Verbose query,fincen,False,False,True,
List the first 3 filings made by entities located in countries with the top-level domain '.de'.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {tld: '.de'})
MATCH (e)-[:FILED]->(f:Filing)
RETURN f
ORDER BY f.begin
LIMIT 3",Verbose query,fincen,False,False,True,
Find the top 5 countries where entities have filed the most filings that began in 2017.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.begin >= datetime('2017-01-01T00:00:00Z') AND f.begin < datetime('2018-01-01T00:00:00Z')
WITH e, count(f) AS filingsCount
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name, sum(filingsCount) AS totalFilings
ORDER BY totalFilings DESC
LIMIT 5",Verbose query,fincen,False,False,False,
Find the top 5 entities that have the most filings concerning entities in their own country.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country)
WITH e, c
MATCH (e)-[:FILED]->(f:Filing)-[:CONCERNS]->(concerned:Entity)-[:COUNTRY]->(c)
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 5
RETURN e.name AS EntityName, filingsCount",Verbose query,fincen,False,False,True,
Identify the top 3 filings with the latest end dates.,"MATCH (f:Filing)
RETURN f
ORDER BY f.end DESC
LIMIT 3",Verbose query,fincen,False,False,False,
List the first 3 entities based in 'Singapore' that have filed something concerning a beneficiary in 'Malaysia'.,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:CONCERNS]->(beneficiary:Entity)
WHERE e.country = 'Singapore' AND beneficiary.country = 'Malaysia'
RETURN e
LIMIT 3",Verbose query,fincen,False,False,True,
What are the top 5 filings by the amount that originated from entities in 'Germany'?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: 'Germany'})
MATCH (e)-[:FILED]->(f:Filing)
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Verbose query,fincen,False,False,True,
Which 3 entities have filed the most filings that originated from a country other than their own?,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:ORIGINATOR]->(originator:Entity)
WHERE e.country IS NOT NULL AND originator.country IS NOT NULL AND e.country <> originator.country
RETURN e.name, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3",Verbose query,fincen,False,False,True,
List the first 3 entities that have filed the most filings where the beneficiary bank's country is the same as the originator bank's country.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.beneficiary_bank_country = f.originator_bank_country
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e",Verbose query,fincen,False,False,False,
Identify the top 3 filings where the originator bank and the beneficiary bank are located at the same latitude.,"MATCH (f:Filing)
WHERE f.origin_lat = f.beneficiary_lat
RETURN f
ORDER BY f.amount DESC
LIMIT 3",Verbose query,fincen,False,False,False,
Which 3 countries have the most filings where the originator bank's country is the same as the beneficiary bank's country?,"MATCH (f:Filing)
WHERE f.originator_bank_country = f.beneficiary_bank_country AND f.originator_bank_country IS NOT NULL
WITH f.originator_bank_country AS country_code, COUNT(f) AS filings_count
RETURN country_code, filings_count
ORDER BY filings_count DESC
LIMIT 3",Verbose query,fincen,False,False,True,
List the first 3 countries with the most filings where the beneficiary bank's country is different from the filer organization's country.,"MATCH (f:Filing)-[:BENEFITS]->(b:Entity)-[:COUNTRY]->(bc:Country),
      (f)-[:FILED]->(filer:Entity)-[:COUNTRY]->(fc:Country)
WHERE bc.name <> fc.name
WITH bc, count(f) AS filingsCount
ORDER BY filingsCount DESC
RETURN bc.name AS Country, filingsCount
LIMIT 3",Verbose query,fincen,False,False,True,
What are the top 5 countries by the total number of filings that have entities as both originators and beneficiaries?,"MATCH (o:Entity)-[:ORIGINATOR]->(f:Filing)-[:BENEFITS]->(b:Entity)
WHERE o.id = b.id
WITH o, count(f) AS filingsCount
MATCH (o)-[:COUNTRY]->(c:Country)
RETURN c.name AS countryName, filingsCount
ORDER BY filingsCount DESC
LIMIT 5",Verbose query,fincen,False,False,True,
Which 3 countries have the most entities involved as beneficiaries in filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c, count(e) AS numEntities
ORDER BY numEntities DESC
LIMIT 3
RETURN c.name AS Country, numEntities",Verbose query,fincen,False,False,True,
Find the first 3 countries where the total amount of filings exceeds 1000000.,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)-[:FILED]->(f:Filing)
WITH c, sum(f.amount) AS totalAmount
WHERE totalAmount > 1000000
RETURN c.name AS CountryName, totalAmount
ORDER BY totalAmount DESC
LIMIT 3",Pathfinding Queries,fincen,False,False,False,
List the first 3 filings where the beneficiary bank and the filer organization name are the same.,"MATCH (f:Filing)
WHERE f.beneficiary_bank = f.filer_org_name
RETURN f
LIMIT 3",Verbose query,fincen,False,False,True,
Identify the top 3 filings where the originator and beneficiary banks are in the same country.,"MATCH (f:Filing)-[:ORIGINATOR]->(o:Entity)-[:COUNTRY]->(c:Country),
      (f)-[:BENEFITS]->(b:Entity)-[:COUNTRY]->(c)
RETURN f
ORDER BY f.amount DESC
LIMIT 3",Verbose query,fincen,False,False,True,
Identify the top 3 entities that have been the originator in the most filings.,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e, filingsCount",Verbose query,fincen,False,False,True,
"Which 3 filings have the largest amounts and were filed between January 1, 2010, and December 31, 2015?","MATCH (f:Filing)
WHERE f.begin >= datetime('2010-01-01T00:00:00Z') AND f.end <= datetime('2015-12-31T23:59:59Z')
RETURN f
ORDER BY f.amount DESC
LIMIT 3",Verbose query,fincen,False,False,True,
List the first 3 countries where the beneficiary latitude is greater than 50 degrees.,"MATCH (c:Country)<-[:COUNTRY]-(:Entity)<-[:BENEFITS]-(f:Filing)
WHERE f.beneficiary_lat > '50'
RETURN c
LIMIT 3",Verbose query,fincen,False,False,True,
What are the top 5 filings that ended in the year 2015?,"MATCH (f:Filing)
WHERE f.end >= datetime('2015-01-01T00:00:00Z') AND f.end <= datetime('2015-12-31T23:59:59Z')
RETURN f
ORDER BY f.end DESC
LIMIT 5",Verbose query,fincen,False,False,False,
Which 3 entities have filed the most filings that benefit entities in Germany?,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:BENEFITS]->(beneficiary:Entity)-[:COUNTRY]->(c:Country {name: ""Germany""})
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e.name AS EntityName, filingsCount",Verbose query,fincen,False,False,True,
Identify the top 3 filings in terms of amount that concern entities in Singapore.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country {name: ""Singapore""})
RETURN f
ORDER BY f.amount DESC
LIMIT 3",Verbose query,fincen,False,False,True,
List the first 3 entities based in countries with a '.uk' top-level domain.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country)
WHERE c.tld = '.uk'
RETURN e
LIMIT 3",Verbose query,fincen,False,False,True,
What are the top 5 filings with the earliest begin dates?,"MATCH (f:Filing)
RETURN f
ORDER BY f.begin
LIMIT 5",Verbose query,fincen,False,False,False,
Which 3 filings involve the most entities either as originators or beneficiaries?,"MATCH (f:Filing)-[r:ORIGINATOR|BENEFITS]->(e:Entity)
WITH f, count(e) AS entityCount
ORDER BY entityCount DESC
LIMIT 3
RETURN f",Verbose query,fincen,False,False,True,
Which 3 countries have entities that have been beneficiaries in the most filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, count(f) AS FilingsCount
ORDER BY FilingsCount DESC
LIMIT 3",Verbose query,fincen,False,False,True,
List the first 3 filings that originated from an entity in China.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: ""China""})
MATCH (e)-[:FILED]->(f:Filing)
RETURN f
ORDER BY f.begin
LIMIT 3",Verbose query,fincen,False,False,True,
Which 3 filings have the longest duration from begin to end date?,"MATCH (f:Filing)
WHERE f.begin IS NOT NULL AND f.end IS NOT NULL
RETURN f, duration.between(f.begin, f.end) AS Duration
ORDER BY Duration DESC
LIMIT 3",Verbose query,fincen,False,False,True,
List the first 3 entities that have filed the most concerning filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, count{(f)-[:CONCERNS]->(:Entity)} AS concernsCount
ORDER BY concernsCount DESC
LIMIT 3
RETURN e",Verbose query,fincen,False,False,False,
Find the top 5 filings based on the number of different countries involved as either originator or beneficiary.,"MATCH (f:Filing)
OPTIONAL MATCH (f)-[:ORIGINATOR]->(originator:Entity)-[:COUNTRY]->(originatorCountry:Country)
OPTIONAL MATCH (f)-[:BENEFITS]->(beneficiary:Entity)-[:COUNTRY]->(beneficiaryCountry:Country)
WITH f, collect(DISTINCT originatorCountry) + collect(DISTINCT beneficiaryCountry) AS countries
WITH f, size(apoc.coll.toSet(countries)) AS numCountries
ORDER BY numCountries DESC
LIMIT 5
RETURN f, numCountries",Verbose query,fincen,False,False,False,
Which 3 countries have the least number of filings ending in them?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c, count(f) AS filingsCount
ORDER BY filingsCount ASC
LIMIT 3
RETURN c.name AS CountryName, filingsCount",Verbose query,fincen,False,False,True,
Identify the top 3 filings with the smallest amounts that were filed in 2015.,"MATCH (f:Filing)-[:FILED]->(e:Entity)
WHERE f.begin_date_format >= '2015-01-01T00:00:00Z' AND f.end_date_format <= '2015-12-31T23:59:59Z'
RETURN f
ORDER BY f.amount ASC
LIMIT 3",Verbose query,fincen,False,False,False,
List the first 3 entities based in 'United Kingdom' that have filed something concerning a beneficiary in 'United States'.,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:CONCERNS]->(beneficiary:Entity)
WHERE e.country = 'United Kingdom' AND beneficiary.country = 'United States'
RETURN e
LIMIT 3",Verbose query,fincen,False,False,True,
What are the top 5 filings concerning entities that are located at a latitude higher than 40 degrees?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE c.location.latitude > 40
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Verbose query,fincen,False,False,True,
Which 3 entities have the most filings where they are both the originator and the beneficiary?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)-[:BENEFITS]->(e)
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e.name, filingsCount",Verbose query,fincen,False,False,False,
List the first 3 countries that have entities which have filed more than 10 filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, count(f) AS filingsCount
WHERE filingsCount > 10
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS CountryName, count(DISTINCT e) AS EntitiesCount
ORDER BY EntitiesCount DESC
LIMIT 3",Verbose query,fincen,False,False,True,
Identify the top 5 countries by the total amount of filings originating from them.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS CountryName, SUM(f.amount) AS TotalAmount
RETURN CountryName, TotalAmount
ORDER BY TotalAmount DESC
LIMIT 5",Verbose query,fincen,False,False,True,
Which filings involve an entity with the id 'the-bank-of-new-york-mellon-corp' as both originator and beneficiary?,"MATCH (f:Filing)-[:ORIGINATOR]->(e1:Entity {id: 'the-bank-of-new-york-mellon-corp'}),
      (f)-[:BENEFITS]->(e2:Entity {id: 'the-bank-of-new-york-mellon-corp'})
RETURN f",Pathfinding Queries,fincen,False,False,True,
Which 3 countries are most frequently listed as the beneficiary bank country in filings?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country IS NOT NULL
RETURN f.beneficiary_bank_country AS Country, count(f) AS Count
ORDER BY Count DESC
LIMIT 3",Verbose query,fincen,False,False,True,
What are the top 5 filings with the largest amounts where the originator bank country is 'United Kingdom'?,"MATCH (f:Filing)
WHERE f.originator_bank_country = 'United Kingdom'
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Pathfinding Queries,fincen,False,False,False,
"Which filings have an end date in 'Sep 25, 2015'?","MATCH (f:Filing)
WHERE f.end_date = 'Sep 25, 2015'
RETURN f",Simple Aggregation Queries,fincen,False,False,False,
List the filings that have an originator bank country as 'Singapore' and an amount over 1000000.,"MATCH (f:Filing)
WHERE f.originator_bank_country = 'Singapore' AND f.amount > 1000000
RETURN f",Simple Aggregation Queries,fincen,False,False,True,
What are the entities that have both originated and been a beneficiary in filings?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WHERE exists {
  MATCH (e)-[:BENEFITS]->(f)
}
RETURN DISTINCT e",Simple Aggregation Queries,fincen,False,False,True,
Which country hosts the most entities that are originators in filings?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 1
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, filingsCount",Simple Aggregation Queries,fincen,False,False,True,
List the top 5 filings by the number of concerned entities.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WITH f, count(e) AS concernedEntities
ORDER BY concernedEntities DESC
LIMIT 5
RETURN f, concernedEntities",Simple Aggregation Queries,fincen,False,False,True,
How many entities are there in 'United Kingdom'?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: 'United Kingdom'})
RETURN count(e) AS NumberOfEntities",Simple Aggregation Queries,fincen,False,False,True,
Which filings have a beneficiary bank with an ISO code of 'GBR' and an amount greater than 250000?,"MATCH (f:Filing)
WHERE f.beneficiary_iso = 'GBR' AND f.amount > 250000
RETURN f",Simple Aggregation Queries,fincen,False,False,True,
What is the total amount filed by entities in 'China'?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: 'China'})
MATCH (e)-[:FILED]->(f:Filing)
RETURN sum(f.amount) AS TotalAmountFiled",Simple Aggregation Queries,fincen,False,False,True,
List the 3 oldest filings based on the begin date.,"MATCH (f:Filing)
RETURN f
ORDER BY f.begin
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
List the 3 most recent filings involving 'Barclays Bank Plc' as the beneficiary bank.,"MATCH (f:Filing {beneficiary_bank: 'Barclays Bank Plc'})
RETURN f
ORDER BY f.end DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
What are the filings where the amount is the minimum in the database?,"MATCH (f:Filing)
WITH MIN(f.amount) AS minAmount
MATCH (f2:Filing)
WHERE f2.amount = minAmount
RETURN f2",Simple Aggregation Queries,fincen,False,False,False,
How many countries have at least one entity that has filed a filing?,"MATCH (e:Entity)-[:FILED]->(:Filing)
WITH DISTINCT e
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN count(DISTINCT c) AS num_countries",Simple Aggregation Queries,fincen,False,False,True,
List the top 5 entities by the number of filings they have filed.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
RETURN e.name, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5",Simple Aggregation Queries,fincen,False,False,True,
Which country's entities have filed the most filings with an amount over 1000000?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.amount > 1000000
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 1
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, filingsCount",Simple Aggregation Queries,fincen,False,False,True,
Find all filings where the beneficiary bank country is 'United States'.,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United States'
RETURN f",Simple Aggregation Queries,fincen,False,False,True,
What are the entities that have filed the most filings with a begin date in 2015?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.begin_date_format STARTS WITH '2015'
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
RETURN e, filingsCount",Simple Aggregation Queries,fincen,False,False,True,
How many filings have a beneficiary bank in 'United Kingdom'?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom'
RETURN count(f) AS NumberOfFilings",Simple Aggregation Queries,fincen,False,False,True,
List the filings with the highest number of originators.,"MATCH (f:Filing)
WITH f, count{(f)-[:ORIGINATOR]->(:Entity)} AS originatorCount
ORDER BY originatorCount DESC
RETURN f, originatorCount
LIMIT 1",Simple Aggregation Queries,fincen,False,False,False,
Which entities are concerned in filings with an amount greater than 750000?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WHERE f.amount > 750000
RETURN e",Simple Aggregation Queries,fincen,False,False,True,
List entities that have filed more than 20 filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, count(f) AS filingsCount
WHERE filingsCount > 20
RETURN e",Simple Aggregation Queries,fincen,False,False,True,
Which entities are originators in the filings involving the highest amounts?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
RETURN e, f.amount
ORDER BY f.amount DESC
LIMIT 1",Simple Aggregation Queries,fincen,False,False,True,
Which filings have the longest duration from begin to end date?,"MATCH (f:Filing)
WHERE f.begin IS NOT NULL AND f.end IS NOT NULL
RETURN f, duration.between(f.begin, f.end) AS Duration
ORDER BY Duration DESC",Simple Aggregation Queries,fincen,False,False,True,
Which entities have been concerned by filings with an amount over 1500000?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WHERE f.amount > 1500000
RETURN e",Simple Aggregation Queries,fincen,False,False,True,
List the filings where the beneficiary ISO is 'GBR'.,"MATCH (f:Filing)
WHERE f.beneficiary_iso = 'GBR'
RETURN f",Simple Aggregation Queries,fincen,False,False,True,
List the three entities with the most filings where the originator and beneficiary banks are the same.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.originator_bank = f.beneficiary_bank
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e, filingsCount",Pathfinding Queries,fincen,False,False,True,
How many filings were made by 'The Bank of New York Mellon Corp.'?,"MATCH (e:Entity {name: 'The Bank of New York Mellon Corp.'})-[:FILED]->(f:Filing)
RETURN count(f) AS NumberOfFilings",Simple Aggregation Queries,fincen,False,False,True,
What are the top 3 filings by amount?,"MATCH (f:Filing)
RETURN f
ORDER BY f.amount DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
List the 3 countries with the lowest number of filings.,"MATCH (c:Country)<-[:COUNTRY]-(:Entity)-[:FILED]->(f:Filing)
WITH c, count(f) AS filingsCount
ORDER BY filingsCount ASC
LIMIT 3
RETURN c.name AS CountryName, filingsCount",Simple Aggregation Queries,fincen,False,False,True,
Which entity has filed the most filings with the originator country as 'United Kingdom'?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.originator_bank_country = 'United Kingdom'
WITH e, count(f) AS filingsCount
RETURN e
ORDER BY filingsCount DESC
LIMIT 1",Simple Aggregation Queries,fincen,False,False,True,
Find all filings that began and ended in the same month of 2015.,"MATCH (f:Filing)
WHERE f.begin_date_format STARTS WITH '2015' AND f.end_date_format STARTS WITH '2015'
AND substring(f.begin_date_format, 5, 2) = substring(f.end_date_format, 5, 2)
RETURN f",Simple Aggregation Queries,fincen,False,False,True,
What are the most common beneficiary bank countries in the filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, count(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC",Simple Aggregation Queries,fincen,False,False,True,
How many entities are there in each country?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, count(e) AS NumberOfEntities",Simple Aggregation Queries,fincen,False,False,True,
Which filings have an originator ISO of 'SGP'?,"MATCH (f:Filing {originator_iso: 'SGP'})
RETURN f",Simple Aggregation Queries,fincen,False,False,True,
What are the top 3 countries by the average amount of filings?,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)-[:FILED]->(f:Filing)
WITH c.name AS country, AVG(f.amount) AS avg_amount
RETURN country, avg_amount
ORDER BY avg_amount DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
List all entities that have filed more than 10 filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, count(f) AS filingsCount
WHERE filingsCount > 10
RETURN e",Simple Aggregation Queries,fincen,False,False,True,
What are the top 5 largest amounts filed by 'Barclays Bank Plc' as the beneficiary bank?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity {name: 'Barclays Bank Plc'})
RETURN f.id AS FilingID, f.amount AS Amount
ORDER BY f.amount DESC
LIMIT 5",Simple Aggregation Queries,fincen,False,False,True,
Which filings involve a beneficiary bank and originator bank from the same country?,"MATCH (f:Filing)
WHERE f.originator_bank_country = f.beneficiary_bank_country AND f.originator_bank_country IS NOT NULL
RETURN f",Simple Aggregation Queries,fincen,False,False,False,
List the top 5 filings based on the number of entities concerned.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WITH f, count(e) AS entitiesConcerned
ORDER BY entitiesConcerned DESC
LIMIT 5
RETURN f, entitiesConcerned",Simple Aggregation Queries,fincen,False,False,True,
How many filings have a beneficiary bank in 'United Kingdom' and an amount greater than 200000?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.amount > 200000
RETURN count(f) AS NumberOfFilings",Simple Aggregation Queries,fincen,False,False,True,
Which entities act as originators in the most number of filings?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
RETURN e, count(f) AS filings_count
ORDER BY filings_count DESC",Simple Aggregation Queries,fincen,False,False,True,
List the filings where the originator bank is 'CIMB Bank Berhad' and the amount is over 500000.,"MATCH (f:Filing)
WHERE f.originator_bank = 'CIMB Bank Berhad' AND f.amount > 500000
RETURN f",Simple Aggregation Queries,fincen,False,False,True,
How many entities have filed filings where the amount was under 10000?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.amount < 10000
RETURN count(DISTINCT e) AS NumberOfEntities",Simple Aggregation Queries,fincen,False,False,False,
What are the top 3 beneficiary ISO codes in the filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
RETURN f.beneficiary_iso AS BeneficiaryISO, count(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
Which entity has benefited from the highest amount in a single filing?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
RETURN e, f.amount AS amount
ORDER BY amount DESC
LIMIT 1",Simple Aggregation Queries,fincen,False,False,True,
Which filings concern entities with a location in 'CHN'?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country {country: 'CHN'})
RETURN f",Simple Aggregation Queries,fincen,False,False,True,Country.country
What are the top 5 filings by the shortest duration from begin to end date?,"MATCH (f:Filing)
WHERE f.begin IS NOT NULL AND f.end IS NOT NULL
RETURN f
ORDER BY duration.between(f.begin, f.end) ASC
LIMIT 5",Simple Aggregation Queries,fincen,False,False,True,
What is the average number of filings per originator bank?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WITH e, count(f) AS filingsCount
RETURN avg(filingsCount) AS averageFilingsPerOriginatorBank",Simple Aggregation Queries,fincen,False,False,True,
Which filings concern entities located at a latitude greater than 50?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE c.location.latitude > 50
RETURN f",Pathfinding Queries,fincen,False,False,True,
How many filings are there with an originator bank from 'Singapore' and a beneficiary bank from 'United Kingdom'?,"MATCH (f:Filing)
WHERE f.originator_bank_country = 'Singapore' AND f.beneficiary_bank_country = 'United Kingdom'
RETURN count(f) AS NumberOfFilings",Simple Aggregation Queries,fincen,False,False,True,
Which entities have filings that originated from Singapore?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank_country = 'Singapore'
RETURN e",Pathfinding Queries,fincen,False,False,True,
List the top 5 countries by the number of entities associated via the FILED relationship.,"MATCH (e:Entity)-[:FILED]->(:Filing)
WITH e, count(e) AS filings
ORDER BY filings DESC
LIMIT 5
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, filings AS NumberOfEntities",Pathfinding Queries,fincen,False,False,True,
What are the three entities that benefitted the most in terms of the amount from filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
RETURN e, SUM(f.amount) AS total_amount
ORDER BY total_amount DESC
LIMIT 3",Pathfinding Queries,fincen,False,False,True,
Find the first 3 countries connected to entities that have a filing with a beneficiary bank in the United Kingdom.,"MATCH (f:Filing {beneficiary_bank_country: ""United Kingdom""})-[:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN DISTINCT c
LIMIT 3",Pathfinding Queries,fincen,False,False,True,
Who are the originators in filings where the beneficiary bank country is 'United Kingdom' and the amount is over 1000000?,"MATCH (f:Filing)-[:ORIGINATOR]->(originator:Entity)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.amount > 1000000
RETURN originator",Pathfinding Queries,fincen,False,False,True,
List the top 5 filings by amount where the originator bank is 'CIMB Bank Berhad'.,"MATCH (f:Filing {originator_bank: 'CIMB Bank Berhad'})
RETURN f
ORDER BY f.amount DESC
LIMIT 5",Pathfinding Queries,fincen,False,False,False,
List the three entities with the most filings during 2015.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.begin_date_format >= '2015-01-01T00:00:00Z' AND f.end_date_format <= '2015-12-31T23:59:59Z'
RETURN e, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3",Pathfinding Queries,fincen,False,False,True,
What are the top 5 filings with the shortest duration between begin and end dates?,"MATCH (f:Filing)
WHERE f.begin IS NOT NULL AND f.end IS NOT NULL
RETURN f, duration.between(f.begin, f.end) AS duration
ORDER BY duration
LIMIT 5",Pathfinding Queries,fincen,False,False,True,
Which countries have entities that are both originators and beneficiaries in filings with an amount over 1000000?,"MATCH (originator:Entity)-[:ORIGINATOR]->(f:Filing)-[:BENEFITS]->(beneficiary:Entity)
WHERE f.amount > 1000000 AND originator.id = beneficiary.id
WITH DISTINCT originator
MATCH (originator)-[:COUNTRY]->(c:Country)
RETURN c.name AS CountryName",Simple Aggregation Queries,fincen,False,False,True,
Find the three countries with the most originator banks in the filings.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c, count(DISTINCT e) AS originator_count
ORDER BY originator_count DESC
LIMIT 3
RETURN c.name AS country_name, originator_count",Pathfinding Queries,fincen,False,False,True,
List the first 3 countries where the beneficiary bank of the filing is located.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN DISTINCT c.name
LIMIT 3",Pathfinding Queries,fincen,False,False,True,
What are the top 5 countries by the total amount of filings concerning their entities?,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)<-[:CONCERNS]-(f:Filing)
RETURN c.name AS Country, sum(f.amount) AS TotalAmount
ORDER BY TotalAmount DESC
LIMIT 5",Pathfinding Queries,fincen,False,False,True,
Identify the top 3 filings with the largest number of transactions.,"MATCH (f:Filing)
RETURN f
ORDER BY f.number DESC
LIMIT 3",Pathfinding Queries,fincen,False,False,True,
Who are the beneficiaries in the top 5 largest filings by amount?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
RETURN e.name AS Beneficiary, f.amount AS Amount
ORDER BY f.amount DESC
LIMIT 5",Pathfinding Queries,fincen,False,False,True,
Find the top 3 entities that have the most filings where the originator bank country is 'Singapore'.,"MATCH (e:Entity)-[:FILED]->(f:Filing {originator_bank_country: 'Singapore'})
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e, filingsCount",Pathfinding Queries,fincen,False,False,False,
Which are the three entities with filings originating from banks in 'Singapore' and concerned with banks in 'United Kingdom'?,"MATCH (f:Filing)-[:ORIGINATOR]->(originator:Entity),
      (f)-[:CONCERNS]->(concerned:Entity)
WHERE f.originator_bank_country = 'Singapore' AND f.beneficiary_bank_country = 'United Kingdom'
RETURN originator, concerned
LIMIT 3",Pathfinding Queries,fincen,False,False,True,
List the top 5 countries based on the total number of entities that have filed something.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, count(f) AS filings
ORDER BY filings DESC
LIMIT 5
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, count(e) AS NumberOfEntities
ORDER BY NumberOfEntities DESC",Pathfinding Queries,fincen,False,False,True,
Which country has the least number of entities that are originators?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WITH e.country AS country, COUNT(e) AS num_entities
ORDER BY num_entities ASC
LIMIT 1
RETURN country",Simple Aggregation Queries,fincen,False,False,True,
Which three entities have the most filings with a beneficiary bank located in 'United Kingdom'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.beneficiary_bank_country = 'United Kingdom'
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN e.name, filingsCount",Pathfinding Queries,fincen,False,False,True,
Which entities filed a report in March 2015 with an amount exceeding 500000?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.begin_date_format >= '2015-03-01T00:00:00Z' AND f.begin_date_format <= '2015-03-31T23:59:59Z'
  AND f.amount > 500000
RETURN e",Pathfinding Queries,fincen,False,False,True,
What are the filings with a beneficiary bank from 'China' and an amount over 150000?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'China'})
WHERE f.amount > 150000
RETURN f",Simple Aggregation Queries,fincen,False,False,True,
List the top 3 filings by amount where the beneficiary bank is from 'China'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'China'})
RETURN f
ORDER BY f.amount DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
Which filings have an originator and beneficiary bank from different countries?,"MATCH (f:Filing)-[:ORIGINATOR]->(originator:Entity)-[:COUNTRY]->(originatorCountry:Country),
      (f)-[:BENEFITS]->(beneficiary:Entity)-[:COUNTRY]->(beneficiaryCountry:Country)
WHERE originatorCountry.code <> beneficiaryCountry.code
RETURN f",Simple Aggregation Queries,fincen,False,False,False,
List all entities that are concerned in filings where the amount is over 2000000.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WHERE f.amount > 2000000
RETURN e",Simple Aggregation Queries,fincen,False,False,True,
What are the filings with a beneficiary bank from 'Singapore' and an amount over 300000?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'Singapore' AND f.amount > 300000
RETURN f",Simple Aggregation Queries,fincen,False,False,True,
Which countries have entities that are both originators and beneficiaries in filings?,"MATCH (originator:Entity)-[:ORIGINATOR]->(f:Filing)-[:BENEFITS]->(beneficiary:Entity)
WHERE originator.id = beneficiary.id
WITH DISTINCT originator
MATCH (originator)-[:COUNTRY]->(c:Country)
RETURN c.name AS CountryName",Simple Aggregation Queries,fincen,False,False,True,
How many filings are there with an originator bank from 'United Kingdom'?,"MATCH (f:Filing)
WHERE f.originator_bank_country = 'United Kingdom'
RETURN count(f) AS NumberOfFilings",Simple Aggregation Queries,fincen,False,False,False,
List the top 3 filings by amount where the beneficiary bank is from 'United Kingdom'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'United Kingdom'})
RETURN f
ORDER BY f.amount DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,True,
How many entities are there that have not been a beneficiary in any filings?,"MATCH (e:Entity)
WHERE NOT EXISTS {
  MATCH (e)<-[:BENEFITS]-(:Filing)
}
RETURN count(e) AS NumberOfEntitiesWithoutBeneficiaryFilings",Simple Aggregation Queries,fincen,False,False,True,
What are the top 3 originator banks in terms of the total amount of filings they initiated?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
RETURN e.name AS OriginatorBank, sum(f.amount) AS TotalAmount
ORDER BY TotalAmount DESC
LIMIT 3",Simple Aggregation Queries,fincen,False,False,False,
List all filings where the beneficiary bank is 'Barclays Bank Plc' and the amount is greater than 500000.,"MATCH (f:Filing)
WHERE f.beneficiary_bank = 'Barclays Bank Plc' AND f.amount > 500000
RETURN f",Simple Aggregation Queries,fincen,False,False,True,
List all entities that are concerned in filings where the amount is over 500000.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WHERE f.amount > 500000
RETURN e",Simple Aggregation Queries,fincen,False,False,True,
List the top 5 entities by the total amount they have been concerned in filings.,"MATCH (e:Entity)-[:CONCERNS]->(f:Filing)
WITH e, sum(f.amount) AS totalAmount
ORDER BY totalAmount DESC
LIMIT 5
RETURN e.name AS EntityName, totalAmount",Simple Aggregation Queries,fincen,False,False,True,
How many filings have a beneficiary bank from 'United States' and an amount less than 500000?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'United States'})
WHERE f.amount < 500000
RETURN count(f) AS NumberOfFilings",Simple Aggregation Queries,fincen,False,False,True,
Which entities are originators in the most number of filings involving a beneficiary bank from 'United Kingdom'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.beneficiary_bank_country = 'United Kingdom'
WITH e, count(f) AS filingsCount
RETURN e, filingsCount
ORDER BY filingsCount DESC",Simple Aggregation Queries,fincen,False,False,True,
"List the filings where the originator bank country is 'Singapore' and the end_date is 'Sep 25, 2015'.","MATCH (f:Filing)
WHERE f.originator_bank_country = 'Singapore' AND f.end_date = 'Sep 25, 2015'
RETURN f",Simple Aggregation Queries,fincen,False,False,True,
What are the entities that have filed the most filings with a beneficiary bank from 'United States'?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.beneficiary_bank_country = 'United States'
WITH e, count(f) AS filingsCount
ORDER BY filingsCount DESC
RETURN e, filingsCount",Simple Aggregation Queries,fincen,False,False,True,
How many filings have a beneficiary bank in 'Singapore'?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'Singapore'
RETURN count(f) AS NumberOfFilings",Simple Aggregation Queries,fincen,False,False,True,
List the top 5 filings by the number of originators.,"MATCH (f:Filing)
WITH f, count{(f)-[:ORIGINATOR]->(:Entity)} AS originatorCount
ORDER BY originatorCount DESC
RETURN f, originatorCount
LIMIT 5",Simple Aggregation Queries,fincen,False,False,True,
Which entities are concerned in filings with an amount greater than 1000000?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WHERE f.amount > 1000000
RETURN e",Simple Aggregation Queries,fincen,False,False,True,
List entities that have filed more than 30 filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, count(f) AS filingsCount
WHERE filingsCount > 30
RETURN e",Simple Aggregation Queries,fincen,False,False,False,
Which filings have the shortest duration from begin to end date involving a beneficiary bank from 'United Kingdom'?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom'
RETURN f, duration.between(f.begin, f.end) AS Duration
ORDER BY Duration ASC
LIMIT 1",Simple Aggregation Queries,fincen,False,False,True,
What are the top 5 filings by the longest duration from begin to end date?,"MATCH (f:Filing)
WHERE f.begin IS NOT NULL AND f.end IS NOT NULL
RETURN f, duration.between(f.begin, f.end) AS Duration
ORDER BY Duration DESC
LIMIT 5",Simple Aggregation Queries,fincen,False,False,True,
Which country has the least number of entities that are beneficiaries?,"MATCH (e:Entity)-[:BENEFITS]->(f:Filing)
WITH e, count(f) AS filingsCount
ORDER BY filingsCount ASC
LIMIT 1
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS Country, filingsCount",Simple Aggregation Queries,fincen,False,False,True,
Who are the top 5 characters with the highest degree?,"MATCH (c:Character)
RETURN c.name, c.degree
ORDER BY c.degree DESC
LIMIT 5",Complex Aggregation Queries,gameofthrones,False,False,False,
List characters with a pagerank less than 1 but more than 0.5.,"MATCH (c:Character)
WHERE c.pagerank < 1 AND c.pagerank > 0.5
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Find characters with a louvain value of 0 and a community above 750.,"MATCH (c:Character)
WHERE c.louvain = 0 AND c.community > 750
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Which characters have a book1PageRank exactly 0.15?,"MATCH (c:Character)
WHERE c.book1PageRank = 0.15
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Which characters belong to louvain community 1 and have a pagerank above 1?,"MATCH (c:Character)
WHERE c.louvain = 1 AND c.pagerank > 1
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Find characters in community 578 with a degree of 0.,"MATCH (c:Character)
WHERE c.community = 578 AND c.degree = 0
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Who are the top 3 characters with the lowest book1BetweennessCentrality?,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality IS NOT NULL
RETURN c.name, c.book1BetweennessCentrality
ORDER BY c.book1BetweennessCentrality ASC
LIMIT 3",Complex Aggregation Queries,gameofthrones,False,False,True,
Which characters have the least centrality but more than 30 degree?,"MATCH (c:Character)
WHERE c.centrality IS NOT NULL AND c.degree > 30
RETURN c
ORDER BY c.centrality ASC
LIMIT 1",Complex Aggregation Queries,gameofthrones,False,False,True,
List all characters with a book45PageRank above 10.,"MATCH (c:Character)
WHERE c.book45PageRank > 10
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Find characters that interact with a weight of exactly 92 in book 2.,"MATCH (c1:Character)-[r:INTERACTS2 {weight: 92, book: 2}]->(c2:Character)
RETURN c1.name AS Character1, c2.name AS Character2",Complex Aggregation Queries,gameofthrones,False,False,True,
Who are the top 3 characters with the lowest degree?,"MATCH (c:Character)
RETURN c.name, c.degree
ORDER BY c.degree ASC
LIMIT 3",Complex Aggregation Queries,gameofthrones,False,False,True,
List characters with INTERACTS3 relationships in book 3 with weights greater than 50.,"MATCH (c:Character)-[r:INTERACTS3 {book: 3}]->(:Character)
WHERE r.weight > 50
RETURN c.name, r.weight",Complex Aggregation Queries,gameofthrones,False,False,True,
Which characters have an INTERACTS2 relationship in book 2?,"MATCH (c:Character)-[r:INTERACTS2]->(:Character)
WHERE r.book = 2
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Find characters with an INTERACTS relationship having a weight over 100.,"MATCH (c:Character)-[r:INTERACTS]->(:Character)
WHERE r.weight > 100
RETURN c, r",Complex Aggregation Queries,gameofthrones,False,False,True,
Who interacts in book 45 with a weight greater than 90?,"MATCH (c1:Character)-[r:INTERACTS45]->(c2:Character)
WHERE r.weight > 90
RETURN c1.name AS Character1, c2.name AS Character2, r.weight AS InteractionWeight",Complex Aggregation Queries,gameofthrones,False,False,True,
List the top 3 characters by book1BetweennessCentrality.,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality IS NOT NULL
RETURN c.name, c.book1BetweennessCentrality
ORDER BY c.book1BetweennessCentrality DESC
LIMIT 3",Complex Aggregation Queries,gameofthrones,False,False,True,
Which characters belong to the louvain community 3?,"MATCH (c:Character)
WHERE c.louvain = 3
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
List characters with a centrality greater than 0.5.,"MATCH (c:Character)
WHERE c.centrality > 0.5
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Who has the highest book1BetweennessCentrality?,"MATCH (c:Character)
RETURN c.name AS Name, c.book1BetweennessCentrality AS BetweennessCentrality
ORDER BY c.book1BetweennessCentrality DESC
LIMIT 1",Complex Aggregation Queries,gameofthrones,False,False,True,
List characters with an INTERACTS relationship having a weight below 10.,"MATCH (c:Character)-[r:INTERACTS]->(:Character)
WHERE r.weight < 10
RETURN c.name, r.weight",Complex Aggregation Queries,gameofthrones,False,False,True,
Which characters are part of community 584?,"MATCH (c:Character)
WHERE c.community = 584
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,False,
Who has the highest weight in an INTERACTS1 relationship?,"MATCH (c1:Character)-[r:INTERACTS1]->(c2:Character)
RETURN c1.name, c2.name, r.weight
ORDER BY r.weight DESC
LIMIT 1",Complex Aggregation Queries,gameofthrones,False,False,True,
Find characters with INTERACTS2 relationships in book 2 with a weight less than 20.,"MATCH (c:Character)-[r:INTERACTS2 {book: 2}]->(:Character)
WHERE r.weight < 20
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Find characters with a book1PageRank of exactly 8.,"MATCH (c:Character)
WHERE c.book1PageRank = 8
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
List characters with a louvain value of 1 and a degree above 50.,"MATCH (c:Character)
WHERE c.louvain = 1 AND c.degree > 50
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Identify characters that have a centrality of 0.,"MATCH (c:Character)
WHERE c.centrality = 0
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
List characters with a louvain value of 2 and a degree above 20.,"MATCH (c:Character)
WHERE c.louvain = 2 AND c.degree > 20
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,False,
Who are the top 5 characters with the highest centrality?,"MATCH (c:Character)
WHERE c.centrality IS NOT NULL
RETURN c.name, c.centrality
ORDER BY c.centrality DESC
LIMIT 5",Complex Aggregation Queries,gameofthrones,False,False,True,
Find characters with a centrality above 0.2 and a book1BetweennessCentrality above 1000.,"MATCH (c:Character)
WHERE c.centrality > 0.2 AND c.book1BetweennessCentrality > 1000
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
List characters with a pagerank of exactly 0.15.,"MATCH (c:Character)
WHERE c.pagerank = 0.15
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Which characters have a degree less than 10?,"MATCH (c:Character)
WHERE c.degree < 10
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Who are the top 3 characters by book45PageRank?,"MATCH (c:Character)
WHERE c.book45PageRank IS NOT NULL
RETURN c.name, c.book45PageRank
ORDER BY c.book45PageRank DESC
LIMIT 3",Complex Aggregation Queries,gameofthrones,False,False,True,
Find characters in community 584 with a pagerank above 9.,"MATCH (c:Character)
WHERE c.community = 584 AND c.pagerank > 9
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
List characters with a centrality above 0.5 and a book1PageRank below 1.,"MATCH (c:Character)
WHERE c.centrality > 0.5 AND c.book1PageRank < 1
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Who are the top 5 characters with the lowest book45PageRank?,"MATCH (c:Character)
WHERE c.book45PageRank IS NOT NULL
RETURN c.name, c.book45PageRank
ORDER BY c.book45PageRank ASC
LIMIT 5",Complex Aggregation Queries,gameofthrones,False,False,True,
Find characters with a degree between 50 and 100.,"MATCH (c:Character)
WHERE c.degree >= 50 AND c.degree <= 100
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,False,
List characters with a louvain value of 0 and a community below 600.,"MATCH (c:Character)
WHERE c.louvain = 0 AND c.community < 600
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Who are the top 5 characters with the lowest pagerank?,"MATCH (c:Character)
WHERE c.pagerank IS NOT NULL
RETURN c.name, c.pagerank
ORDER BY c.pagerank ASC
LIMIT 5",Complex Aggregation Queries,gameofthrones,False,False,True,
Find characters with a centrality less than 0.1 and a book1PageRank above 5.,"MATCH (c:Character)
WHERE c.centrality < 0.1 AND c.book1PageRank > 5
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
List characters with a pagerank greater than 8.,"MATCH (c:Character)
WHERE c.pagerank > 8
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Which characters have a degree exactly 300?,"MATCH (c:Character)
WHERE c.degree = 300
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,False,
Who are the top 3 characters by centrality?,"MATCH (c:Character)
WHERE c.centrality IS NOT NULL
RETURN c.name, c.centrality
ORDER BY c.centrality DESC
LIMIT 3",Complex Aggregation Queries,gameofthrones,False,False,True,
Find characters in community 759 with a pagerank less than 1.,"MATCH (c:Character)
WHERE c.community = 759 AND c.pagerank < 1
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
List characters with a book45PageRank of exactly 2.,"MATCH (c:Character)
WHERE c.book45PageRank = 2
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Who are the top 5 characters with the highest book1PageRank?,"MATCH (c:Character)
WHERE c.book1PageRank IS NOT NULL
RETURN c.name, c.book1PageRank
ORDER BY c.book1PageRank DESC
LIMIT 5",Complex Aggregation Queries,gameofthrones,False,False,True,
Find characters with a book1PageRank between 2 and 4.,"MATCH (c:Character)
WHERE c.book1PageRank >= 2 AND c.book1PageRank <= 4
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Who has the lowest weight in an INTERACTS3 relationship?,"MATCH (c1:Character)-[r:INTERACTS3]->(c2:Character)
RETURN c1.name, c2.name, r.weight
ORDER BY r.weight ASC
LIMIT 1",Complex Aggregation Queries,gameofthrones,False,False,True,
Who are the top 5 characters by pagerank?,"MATCH (c:Character)
RETURN c.name, c.pagerank
ORDER BY c.pagerank DESC
LIMIT 5",Complex Aggregation Queries,gameofthrones,False,False,True,
Which characters have a centrality less than 0.1?,"MATCH (c:Character)
WHERE c.centrality < 0.1
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
List all characters with a degree higher than 100.,"MATCH (c:Character)
WHERE c.degree > 100
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Identify characters with a degree greater than 20 and a pagerank less than 0.3.,"MATCH (c:Character)
WHERE c.degree > 20 AND c.pagerank < 0.3
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
Which characters have a book1BetweennessCentrality of exactly 2604.7556467555924?,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality = 2604.7556467555924
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
List the characters with a centrality between 0.5 and 0.8.,"MATCH (c:Character)
WHERE c.centrality >= 0.5 AND c.centrality <= 0.8
RETURN c.name, c.centrality",Pathfinding Queries,gameofthrones,False,False,False,
Who has the lowest book1PageRank in community 579?,"MATCH (c:Character)
WHERE c.community = 579
RETURN c.name AS CharacterName, c.book1PageRank AS LowestBook1PageRank
ORDER BY c.book1PageRank ASC
LIMIT 1",Pathfinding Queries,gameofthrones,False,False,True,
Find characters in the top 3 louvain communities by centrality.,"MATCH (c:Character)
WHERE c.centrality IS NOT NULL
WITH c
ORDER BY c.centrality DESC
WITH c.louvain AS community, collect(c) AS members
ORDER BY size(members) DESC
LIMIT 3
UNWIND members AS top_member
RETURN top_member.name, top_member.centrality, top_member.louvain",Pathfinding Queries,gameofthrones,False,False,True,
List characters with a pagerank greater than 7 and a degree less than 50.,"MATCH (c:Character)
WHERE c.pagerank > 7 AND c.degree < 50
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
Identify characters with a centrality greater than 0.5 and a book1BetweennessCentrality less than 100.,"MATCH (c:Character)
WHERE c.centrality > 0.5 AND c.book1BetweennessCentrality < 100
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
Which characters have an INTERACTS relationship in book 1 with a weight over 150?,"MATCH (c:Character)-[r:INTERACTS1]->(:Character)
WHERE r.weight > 150
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
Who are the characters with an INTERACTS2 relationship with a weight exactly 92?,"MATCH (c1:Character)-[r:INTERACTS2 {weight: 92}]->(c2:Character)
RETURN c1.name AS Character1, c2.name AS Character2",Pathfinding Queries,gameofthrones,False,False,True,
Find the characters involved in the heaviest INTERACTS3 relationship.,"MATCH (c1:Character)-[r:INTERACTS3]->(c2:Character)
RETURN c1, c2, r.weight AS weight
ORDER BY r.weight DESC
LIMIT 1",Pathfinding Queries,gameofthrones,False,False,True,
List characters who interact in book 45 with a weight greater than 90.,"MATCH (c1:Character)-[r:INTERACTS45]->(c2:Character)
WHERE r.weight > 90
RETURN c1.name AS Character1, c2.name AS Character2, r.weight AS InteractionWeight",Pathfinding Queries,gameofthrones,False,False,True,
Identify the top 3 most frequent communities in INTERACTS relationships.,"MATCH (c:Character)-[:INTERACTS]->(:Character)
RETURN c.community, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3",Pathfinding Queries,gameofthrones,False,False,True,
Which characters are connected by INTERACTS1 with a weight less than 10?,"MATCH (c1:Character)-[r:INTERACTS1]->(c2:Character)
WHERE r.weight < 10
RETURN c1.name, c2.name, r.weight",Pathfinding Queries,gameofthrones,False,False,True,
Find characters with a book1PageRank less than 1 and a degree greater than 10.,"MATCH (c:Character)
WHERE c.book1PageRank < 1 AND c.degree > 10
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
Who are the characters with a louvain value of 1 and a pagerank above 0.5?,"MATCH (c:Character)
WHERE c.louvain = 1 AND c.pagerank > 0.5
RETURN c.name, c.pagerank",Pathfinding Queries,gameofthrones,False,False,True,
List all characters with a centrality of 1.,"MATCH (c:Character)
WHERE c.centrality = 1.0
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
What are the names of characters with a degree between 50 and 100?,"MATCH (c:Character)
WHERE c.degree >= 50 AND c.degree <= 100
RETURN c.name",Pathfinding Queries,gameofthrones,False,False,True,
Identify characters in community 578 with a pagerank above 0.3.,"MATCH (c:Character)
WHERE c.community = 578 AND c.pagerank > 0.3
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
List characters with the highest 5 book1PageRanks in community 795.,"MATCH (c:Character)
WHERE c.community = 795
RETURN c.name, c.book1PageRank
ORDER BY c.book1PageRank DESC
LIMIT 5",Pathfinding Queries,gameofthrones,False,False,True,
Find characters with a book45PageRank in the top 5 highest values.,"MATCH (c:Character)
WHERE c.book45PageRank IS NOT NULL
RETURN c
ORDER BY c.book45PageRank DESC
LIMIT 5",Pathfinding Queries,gameofthrones,False,False,True,
List characters with a centrality below 0.1 and a pagerank above 2.,"MATCH (c:Character)
WHERE c.centrality < 0.1 AND c.pagerank > 2
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
What are the names of characters with a degree of 300?,"MATCH (c:Character)
WHERE c.degree = 300
RETURN c.name",Pathfinding Queries,gameofthrones,False,False,True,
Find characters with a book45PageRank below 1.,"MATCH (c:Character)
WHERE c.book45PageRank < 1
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
List characters within louvain community 1 with a pagerank greater than 0.4.,"MATCH (c:Character)
WHERE c.louvain = 1 AND c.pagerank > 0.4
RETURN c.name, c.pagerank",Pathfinding Queries,gameofthrones,False,False,True,
Who are the characters with a louvain value less than 1?,"MATCH (c:Character)
WHERE c.louvain < 1
RETURN c.name",Pathfinding Queries,gameofthrones,False,False,True,
Which characters have a book1PageRank greater than 3?,"MATCH (c:Character)
WHERE c.book1PageRank > 3
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Which characters have an INTERACTS relationship in book 1 with a weight over 250?,"MATCH (c:Character)-[r:INTERACTS1]->(:Character)
WHERE r.weight > 250
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
Who are the characters with an INTERACTS3 relationship with a weight exactly 95?,"MATCH (c:Character)-[r:INTERACTS3 {weight: 95}]->(other:Character)
RETURN c.name, other.name",Pathfinding Queries,gameofthrones,False,False,True,
Find the characters involved in the heaviest INTERACTS2 relationship.,"MATCH (c1:Character)-[r:INTERACTS2]->(c2:Character)
RETURN c1, c2, r.weight AS weight
ORDER BY r.weight DESC
LIMIT 1",Pathfinding Queries,gameofthrones,False,False,True,
List characters who interact in book 45 with a weight greater than 95.,"MATCH (c:Character)-[r:INTERACTS45]->(:Character)
WHERE r.weight > 95
RETURN c.name, r.weight",Pathfinding Queries,gameofthrones,False,False,True,
Identify the top 5 most frequent communities in INTERACTS1 relationships.,"MATCH (c1:Character)-[:INTERACTS1]->(c2:Character)
RETURN c1.community AS Community, count(*) AS Frequency
ORDER BY Frequency DESC
LIMIT 5",Pathfinding Queries,gameofthrones,False,False,True,
Which characters are connected by INTERACTS1 with a weight greater than 200?,"MATCH (c1:Character)-[r:INTERACTS1]->(c2:Character)
WHERE r.weight > 200
RETURN c1.name, c2.name, r.weight",Pathfinding Queries,gameofthrones,False,False,True,
Find characters with a book1PageRank less than 0.5 and a degree greater than 5.,"MATCH (c:Character)
WHERE c.book1PageRank < 0.5 AND c.degree > 5
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
Who are the characters with a louvain value of 3 and a pagerank above 0.6?,"MATCH (c:Character)
WHERE c.louvain = 3 AND c.pagerank > 0.6
RETURN c.name, c.pagerank",Pathfinding Queries,gameofthrones,False,False,True,
List all characters with a centrality of 0.5.,"MATCH (c:Character)
WHERE c.centrality = 0.5
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
What are the names of characters with a degree between 10 and 20?,"MATCH (c:Character)
WHERE c.degree >= 10 AND c.degree <= 20
RETURN c.name",Pathfinding Queries,gameofthrones,False,False,True,
Identify characters in community 759 with a pagerank above 0.4.,"MATCH (c:Character)
WHERE c.community = 759 AND c.pagerank > 0.4
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
List characters with the highest 3 book1PageRanks in community 504.,"MATCH (c:Character)
WHERE c.community = 504
RETURN c.name, c.book1PageRank
ORDER BY c.book1PageRank DESC
LIMIT 3",Pathfinding Queries,gameofthrones,False,False,True,
Which characters have a centrality less than 0.05?,"MATCH (c:Character)
WHERE c.centrality < 0.05
RETURN c",Pathfinding Queries,gameofthrones,False,False,False,
Find characters with a book45PageRank in the top 10 highest values.,"MATCH (c:Character)
WHERE c.book45PageRank IS NOT NULL
RETURN c
ORDER BY c.book45PageRank DESC
LIMIT 10",Pathfinding Queries,gameofthrones,False,False,False,
Who are the characters in community 795 with a pagerank above 0.5?,"MATCH (c:Character)
WHERE c.community = 795 AND c.pagerank > 0.5
RETURN c.name, c.pagerank",Pathfinding Queries,gameofthrones,False,False,True,
List all characters with a book1BetweennessCentrality higher than 2000 and a book1PageRank lower than 3.,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality > 2000 AND c.book1PageRank < 3
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
What are the names of characters who have a pagerank and a centrality of 1?,"MATCH (c:Character)
WHERE c.pagerank = 1 AND c.centrality = 1
RETURN c.name",Pathfinding Queries,gameofthrones,False,False,False,
Identify characters with a centrality greater than 0.9 and a pagerank less than 0.5.,"MATCH (c:Character)
WHERE c.centrality > 0.9 AND c.pagerank < 0.5
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
Which characters belong to the community with the lowest number of relationships?,"MATCH (c:Character)
WITH c.community AS community, count{(c)-[:INTERACTS|:INTERACTS1|:INTERACTS2|:INTERACTS3|:INTERACTS45]->()} AS relationshipCount
ORDER BY relationshipCount ASC
LIMIT 1
MATCH (char:Character {community: community})
RETURN char",Pathfinding Queries,gameofthrones,False,False,True,
List the characters with a pagerank less than 0.15.,"MATCH (c:Character)
WHERE c.pagerank < 0.15
RETURN c",Pathfinding Queries,gameofthrones,True,False,False,
Find characters with a book1PageRank and book45PageRank both under 2.,"MATCH (c:Character)
WHERE c.book1PageRank < 2 AND c.book45PageRank < 2
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
Find characters in community 759 with a book45PageRank less than 4.,"MATCH (c:Character)
WHERE c.community = 759 AND c.book45PageRank < 4
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Which characters are in the top 5 for the sum of their INTERACTS1 and INTERACTS2 weights?,"MATCH (c:Character)-[r1:INTERACTS1]->()
WITH c, sum(r1.weight) AS sumInteracts1
MATCH (c)-[r2:INTERACTS2]->()
WITH c, sumInteracts1 + sum(r2.weight) AS totalWeight
RETURN c.name, totalWeight
ORDER BY totalWeight DESC
LIMIT 5",Verbose query,gameofthrones,False,False,True,
List characters with a book45PageRank above 5 and a community of 584.,"MATCH (c:Character)
WHERE c.book45PageRank > 5 AND c.community = 584
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
What are the names of characters who have an INTERACTS1 book value of 1 and a weight greater than 50?,"MATCH (c:Character)-[r:INTERACTS1]->(:Character)
WHERE r.book = 1 AND r.weight > 50
RETURN c.name",Verbose query,gameofthrones,False,False,True,
Name the top 5 characters with the highest degree in the entire dataset.,"MATCH (c:Character)
WHERE c.degree IS NOT NULL
RETURN c.name, c.degree
ORDER BY c.degree DESC
LIMIT 5",Verbose query,gameofthrones,False,False,True,
Find the characters with a community number less than 600 and a centrality of 1.,"MATCH (c:Character)
WHERE c.community < 600 AND c.centrality = 1
RETURN c",Verbose query,gameofthrones,False,False,True,
Who are the top 3 characters based on the combination of book1PageRank and book45PageRank?,"MATCH (c:Character)
WHERE c.book1PageRank IS NOT NULL AND c.book45PageRank IS NOT NULL
RETURN c.name, c.book1PageRank + c.book45PageRank AS combinedPageRank
ORDER BY combinedPageRank DESC
LIMIT 3",Verbose query,gameofthrones,False,False,True,
List the characters with the highest sum of INTERACTS weights across all books. Limit to top 5.,"MATCH (c:Character)-[r:INTERACTS|INTERACTS1|INTERACTS2|INTERACTS3|INTERACTS45]->(:Character)
WITH c, sum(r.weight) AS totalWeight
ORDER BY totalWeight DESC
LIMIT 5
RETURN c.name, totalWeight",Verbose query,gameofthrones,False,False,True,
Identify the top 3 characters based on the sum of their centrality values across all books.,"MATCH (c:Character)
WHERE c.centrality IS NOT NULL
RETURN c.name, c.centrality
ORDER BY c.centrality DESC
LIMIT 3",Verbose query,gameofthrones,False,False,False,
Which characters have the lowest degree but are part of community 795? Limit to top 5.,"MATCH (c:Character)
WHERE c.community = 795 AND c.degree IS NOT NULL
RETURN c
ORDER BY c.degree ASC
LIMIT 5",Verbose query,gameofthrones,False,False,True,
Find the characters who have a louvain community number of 10 and a pagerank greater than 0.5.,"MATCH (c:Character)
WHERE c.louvain = 10 AND c.pagerank > 0.5
RETURN c",Verbose query,gameofthrones,False,False,False,
List 3 characters with a book1PageRank less than 1 but an INTERACTS weight greater than 150.,"MATCH (c:Character)-[r:INTERACTS]->()
WHERE c.book1PageRank < 1 AND r.weight > 150
RETURN c.name, c.book1PageRank, r.weight
LIMIT 3",Verbose query,gameofthrones,False,False,False,
Who are the top 5 characters in terms of INTERACTS45 weight?,"MATCH (c:Character)-[r:INTERACTS45]->(:Character)
RETURN c.name, sum(r.weight) AS totalWeight
ORDER BY totalWeight DESC
LIMIT 5",Verbose query,gameofthrones,False,False,True,
Name the characters with a degree of zero and a centrality greater than 0.5.,"MATCH (c:Character)
WHERE c.degree = 0 AND c.centrality > 0.5
RETURN c.name",Verbose query,gameofthrones,False,False,True,
List the characters who are part of both community 578 and 579. Limit to 5 characters.,"MATCH (c1:Character {community: 578}), (c2:Character {community: 579})
WHERE c1.name = c2.name
RETURN c1.name AS CharacterName
LIMIT 5",Verbose query,gameofthrones,False,False,True,
Identify the top 3 characters with the lowest pagerank but who interact in book 45.,"MATCH (c:Character)-[:INTERACTS45]->(:Character)
WHERE c.pagerank IS NOT NULL
RETURN c
ORDER BY c.pagerank ASC
LIMIT 3",Verbose query,gameofthrones,False,False,True,
What are the names of characters with a louvain value of 1 and degree greater than 10?,"MATCH (c:Character)
WHERE c.louvain = 1 AND c.degree > 10
RETURN c.name",Verbose query,gameofthrones,False,False,True,
Who has the highest book1BetweennessCentrality and is from community 759?,"MATCH (c:Character)
WHERE c.community = 759
RETURN c.name, c.book1BetweennessCentrality
ORDER BY c.book1BetweennessCentrality DESC
LIMIT 1",Verbose query,gameofthrones,False,False,True,
Find 3 characters with the most diverse fastrf_embedding values (considering range between max and min in the list).,"MATCH (c:Character)
WHERE c.fastrf_embedding IS NOT NULL
RETURN c.name, c.fastrf_embedding, 
       max(c.fastrf_embedding) - min(c.fastrf_embedding) AS diversity
ORDER BY diversity DESC
LIMIT 3",Verbose query,gameofthrones,False,False,True,
List the top 5 characters based on the sum weight of their INTERACTS1 and INTERACTS2 relationships.,"MATCH (c:Character)-[r:INTERACTS1|INTERACTS2]->()
WITH c, sum(r.weight) AS totalWeight
ORDER BY totalWeight DESC
LIMIT 5
RETURN c.name, totalWeight",Verbose query,gameofthrones,False,False,True,
Name the 3 characters with the highest INTERACTS3 relationship weight.,"MATCH (c:Character)-[r:INTERACTS3]->(:Character)
RETURN c.name, r.weight
ORDER BY r.weight DESC
LIMIT 3",Verbose query,gameofthrones,False,False,True,
Which characters have a book45PageRank less than 1 but a book1PageRank greater than 2?,"MATCH (c:Character)
WHERE c.book45PageRank < 1 AND c.book1PageRank > 2
RETURN c",Verbose query,gameofthrones,False,False,True,
Identify characters who have both high pagerank and high degree of centrality. Limit to top 5.,"MATCH (c:Character)
WHERE c.pagerank > 5 AND c.centrality > 0.5
RETURN c
ORDER BY c.pagerank DESC, c.centrality DESC
LIMIT 5",Verbose query,gameofthrones,False,False,True,
What are the top 3 characters with a community number exactly 579?,"MATCH (c:Character)
WHERE c.community = 579
RETURN c
ORDER BY c.pagerank DESC
LIMIT 3",Verbose query,gameofthrones,False,False,True,
List the top 3 characters with the highest book1BetweennessCentrality.,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality IS NOT NULL
RETURN c.name, c.book1BetweennessCentrality
ORDER BY c.book1BetweennessCentrality DESC
LIMIT 3",Verbose query,gameofthrones,False,False,True,
Find 3 characters with fastrf_embedding values where the first element is greater than 0.5.,"MATCH (c:Character)
WHERE c.fastrf_embedding[0] > 0.5
RETURN c
LIMIT 3",Verbose query,gameofthrones,False,False,True,
Identify characters with a pagerank less than 0.2 but a degree greater than 10.,"MATCH (c:Character)
WHERE c.pagerank < 0.2 AND c.degree > 10
RETURN c",Verbose query,gameofthrones,False,False,True,
Who are the characters with a fastrf_embedding value at the last position less than -0.5? Limit to 3 characters.,"MATCH (c:Character)
WHERE c.fastrf_embedding[-1] < -0.5
RETURN c.name
LIMIT 3",Verbose query,gameofthrones,False,False,True,
Find the characters with a book1PageRank less than 2 and a community number greater than 750.,"MATCH (c:Character)
WHERE c.book1PageRank < 2 AND c.community > 750
RETURN c",Verbose query,gameofthrones,False,False,True,
Who are the top 5 characters based on the combination of centrality and degree?,"MATCH (c:Character)
WHERE c.centrality IS NOT NULL AND c.degree IS NOT NULL
RETURN c.name, c.centrality, c.degree
ORDER BY c.centrality + c.degree DESC
LIMIT 5",Verbose query,gameofthrones,False,False,True,
List the characters with a community number less than 600 and a pagerank greater than 0.4.,"MATCH (c:Character)
WHERE c.community < 600 AND c.pagerank > 0.4
RETURN c.name, c.community, c.pagerank",Verbose query,gameofthrones,False,False,True,
Name the top 3 characters based on the sum of their book1PageRank and book45PageRank.,"MATCH (c:Character)
WHERE c.book1PageRank IS NOT NULL AND c.book45PageRank IS NOT NULL
RETURN c.name AS CharacterName, (c.book1PageRank + c.book45PageRank) AS TotalPageRank
ORDER BY TotalPageRank DESC
LIMIT 3",Verbose query,gameofthrones,False,False,True,
Who are the characters in community 504?,"MATCH (c:Character)
WHERE c.community = 504
RETURN c.name",Pathfinding Queries,gameofthrones,False,False,True,
Identify the top 3 characters with the highest book1BetweennessCentrality and a community number of 759.,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality IS NOT NULL AND c.community = 759
RETURN c.name, c.book1BetweennessCentrality
ORDER BY c.book1BetweennessCentrality DESC
LIMIT 3",Verbose query,gameofthrones,False,False,True,
What are the names of characters who have an INTERACTS2 book value of 2 and a weight greater than 50?,"MATCH (c:Character)-[r:INTERACTS2]->(:Character)
WHERE r.book = 2 AND r.weight > 50
RETURN c.name",Verbose query,gameofthrones,False,False,True,
List the characters with a pagerank above 0.5 and an INTERACTS weight over 200.,"MATCH (c:Character)-[r:INTERACTS]->()
WHERE c.pagerank > 0.5 AND r.weight > 200
RETURN c.name, c.pagerank, r.weight",Verbose query,gameofthrones,False,False,True,
Who are the top 5 characters with the lowest book45PageRank but a book1PageRank greater than 4?,"MATCH (c:Character)
WHERE c.book1PageRank > 4
RETURN c.name, c.book45PageRank
ORDER BY c.book45PageRank ASC
LIMIT 5",Verbose query,gameofthrones,False,False,True,
Find the characters who have a degree of zero and a book1PageRank greater than 0.5.,"MATCH (c:Character)
WHERE c.degree = 0 AND c.book1PageRank > 0.5
RETURN c",Verbose query,gameofthrones,False,False,True,
List the top 5 characters with a community number exactly 795.,"MATCH (c:Character)
WHERE c.community = 795
RETURN c
ORDER BY c.pagerank DESC
LIMIT 5",Verbose query,gameofthrones,False,False,False,
Name the characters with a louvain value of 6 and a pagerank greater than 0.3.,"MATCH (c:Character)
WHERE c.louvain = 6 AND c.pagerank > 0.3
RETURN c.name",Verbose query,gameofthrones,False,False,True,
Which characters have the highest sum of pagerank values across all books? Limit to top 5.,"MATCH (c:Character)
WITH c, c.book1PageRank + c.book45PageRank AS totalPageRank
ORDER BY totalPageRank DESC
LIMIT 5
RETURN c.name, totalPageRank",Verbose query,gameofthrones,False,False,True,
Identify the top 5 characters based on the average of their centrality values across all books.,"MATCH (c:Character)
WHERE c.centrality IS NOT NULL
RETURN c.name, c.centrality
ORDER BY c.centrality DESC
LIMIT 5",Verbose query,gameofthrones,False,False,True,
List the characters who are part of community 504 and have a degree greater than 20.,"MATCH (c:Character)
WHERE c.community = 504 AND c.degree > 20
RETURN c.name, c.degree",Verbose query,gameofthrones,False,False,True,
Who are the top 3 characters based on the sum of weights in their INTERACTS and INTERACTS3 relationships?,"MATCH (c:Character)-[r:INTERACTS|INTERACTS3]->()
WITH c, sum(r.weight) AS totalWeight
ORDER BY totalWeight DESC
LIMIT 3
RETURN c.name AS CharacterName, totalWeight",Verbose query,gameofthrones,False,False,True,
Find the characters with a book1PageRank greater than 3 and a book45PageRank less than 2.,"MATCH (c:Character)
WHERE c.book1PageRank > 3 AND c.book45PageRank < 2
RETURN c",Verbose query,gameofthrones,False,False,True,
What are the names of the top 5 characters by degree who are also in louvain community 2?,"MATCH (c:Character)
WHERE c.louvain = 2
RETURN c.name
ORDER BY c.degree DESC
LIMIT 5",Verbose query,gameofthrones,False,False,True,
Name the 3 characters with the highest pagerank in book 45.,"MATCH (c:Character)-[:INTERACTS45]->(:Character)
RETURN c.name AS CharacterName, c.book45PageRank AS PageRank
ORDER BY c.book45PageRank DESC
LIMIT 3",Verbose query,gameofthrones,False,False,True,
List the characters who have a centrality value of exactly 0.8. Limit to top 5.,"MATCH (c:Character)
WHERE c.centrality = 0.8
RETURN c
LIMIT 5",Verbose query,gameofthrones,False,False,True,
Identify the top 5 characters with the most interactions in book 3.,"MATCH (c:Character)-[r:INTERACTS3]->(:Character)
RETURN c.name, count(r) AS interactions
ORDER BY interactions DESC
LIMIT 5",Verbose query,gameofthrones,False,False,True,
Which characters are in the top 5 for louvain community size?,"MATCH (c:Character)
RETURN c.louvain AS community, count(c) AS communitySize
ORDER BY communitySize DESC
LIMIT 5",Verbose query,gameofthrones,False,False,True,
Who are the top 5 characters by book1BetweennessCentrality?,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality IS NOT NULL
RETURN c.name, c.book1BetweennessCentrality
ORDER BY c.book1BetweennessCentrality DESC
LIMIT 5",Complex Aggregation Queries,gameofthrones,False,False,True,
Who are the top 5 characters with the lowest book1PageRank but more than zero degree?,"MATCH (c:Character)
WHERE c.book1PageRank IS NOT NULL AND c.degree > 0
RETURN c.name, c.book1PageRank
ORDER BY c.book1PageRank ASC
LIMIT 5",Verbose query,gameofthrones,False,False,True,
Name the characters involved in the INTERACTS2 relationship with the highest weights. Limit to 3 characters.,"MATCH (c1:Character)-[r:INTERACTS2]->(c2:Character)
RETURN c1.name, c2.name, r.weight
ORDER BY r.weight DESC
LIMIT 3",Verbose query,gameofthrones,False,False,True,
List characters with a centrality above 0.6 and a pagerank below 1.,"MATCH (c:Character)
WHERE c.centrality > 0.6 AND c.pagerank < 1
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Who are the top 3 characters with the highest book1BetweennessCentrality?,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality IS NOT NULL
RETURN c.name, c.book1BetweennessCentrality
ORDER BY c.book1BetweennessCentrality DESC
LIMIT 3",Complex Aggregation Queries,gameofthrones,False,False,True,
Find characters in community 759 with a degree above 30.,"MATCH (c:Character)
WHERE c.community = 759 AND c.degree > 30
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
List characters with a book45PageRank below 1.5.,"MATCH (c:Character)
WHERE c.book45PageRank < 1.5
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Who are the top 5 characters with the lowest centrality?,"MATCH (c:Character)
WHERE c.centrality IS NOT NULL
RETURN c.name, c.centrality
ORDER BY c.centrality ASC
LIMIT 5",Complex Aggregation Queries,gameofthrones,False,False,True,
Find characters with a centrality below 0.1 and a louvain value above 5.,"MATCH (c:Character)
WHERE c.centrality < 0.1 AND c.louvain > 5
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
List characters with a book1BetweennessCentrality above 2000.,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality > 2000
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Who are the top 3 characters with the highest weight in INTERACTS1 relationships?,"MATCH (c:Character)-[r:INTERACTS1]->(:Character)
RETURN c.name, sum(r.weight) AS totalWeight
ORDER BY totalWeight DESC
LIMIT 3",Complex Aggregation Queries,gameofthrones,False,False,True,
Find characters with a centrality above 0.4 and a book1PageRank below 0.3.,"MATCH (c:Character)
WHERE c.centrality > 0.4 AND c.book1PageRank < 0.3
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
List characters with a pagerank above 9.,"MATCH (c:Character)
WHERE c.pagerank > 9
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Who are the top 5 characters by degree?,"MATCH (c:Character)
RETURN c.name, c.degree
ORDER BY c.degree DESC
LIMIT 5",Complex Aggregation Queries,gameofthrones,False,False,False,
Find characters with a centrality below 0.2 and a book45PageRank above 3.,"MATCH (c:Character)
WHERE c.centrality < 0.2 AND c.book45PageRank > 3
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
List characters with a louvain value of 3 and a degree below 5.,"MATCH (c:Character)
WHERE c.louvain = 3 AND c.degree < 5
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Who are the top 3 characters with the lowest pagerank?,"MATCH (c:Character)
WHERE c.pagerank IS NOT NULL
RETURN c.name, c.pagerank
ORDER BY c.pagerank ASC
LIMIT 3",Complex Aggregation Queries,gameofthrones,False,False,True,
Find characters in community 578 with a book1BetweennessCentrality above 500.,"MATCH (c:Character)
WHERE c.community = 578 AND c.book1BetweennessCentrality > 500
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
List characters with a pagerank below 0.5.,"MATCH (c:Character)
WHERE c.pagerank < 0.5
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Who are the top 5 characters with the lowest book1PageRank?,"MATCH (c:Character)
WHERE c.book1PageRank IS NOT NULL
RETURN c.name, c.book1PageRank
ORDER BY c.book1PageRank ASC
LIMIT 5",Complex Aggregation Queries,gameofthrones,False,False,True,
Find characters with a centrality above 0.3 and a louvain value of 1.,"MATCH (c:Character)
WHERE c.centrality > 0.3 AND c.louvain = 1
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,False,
List characters with a book1PageRank below 0.2 and a degree above 10.,"MATCH (c:Character)
WHERE c.book1PageRank < 0.2 AND c.degree > 10
RETURN c",Complex Aggregation Queries,gameofthrones,True,False,False,
Who are the top 3 characters with the highest weight in INTERACTS relationships?,"MATCH (c:Character)-[r:INTERACTS]->(:Character)
RETURN c.name, r.weight
ORDER BY r.weight DESC
LIMIT 3",Complex Aggregation Queries,gameofthrones,False,False,True,
Find characters with a pagerank above 7 and a degree above 150.,"MATCH (c:Character)
WHERE c.pagerank > 7 AND c.degree > 150
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Find characters with a book1PageRank above 5 and a community of 578.,"MATCH (c:Character)
WHERE c.book1PageRank > 5 AND c.community = 578
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
List the characters who have more than one type of INTERACTS relationship. Limit to 5 characters.,"MATCH (c:Character)
WHERE exists {
    MATCH (c)-[:INTERACTS]->(:Character)
} AND exists {
    MATCH (c)-[:INTERACTS1]->(:Character)
} OR exists {
    MATCH (c)-[:INTERACTS2]->(:Character)
} OR exists {
    MATCH (c)-[:INTERACTS3]->(:Character)
} OR exists {
    MATCH (c)-[:INTERACTS45]->(:Character)
}
WITH c, count(DISTINCT type(r)) AS relationshipTypes
WHERE relationshipTypes > 1
RETURN c
LIMIT 5",Verbose query,gameofthrones,False,False,True,
Who are the top 5 characters with the highest weight in INTERACTS2 relationships?,"MATCH (c:Character)-[r:INTERACTS2]->(:Character)
RETURN c.name, sum(r.weight) AS totalWeight
ORDER BY totalWeight DESC
LIMIT 5",Complex Aggregation Queries,gameofthrones,False,False,True,
Find characters with a pagerank below 0.6 and a degree above 20.,"MATCH (c:Character)
WHERE c.pagerank < 0.6 AND c.degree > 20
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Which characters interact in book 1 with a weight greater than 100?,"MATCH (c1:Character)-[r:INTERACTS1]->(c2:Character)
WHERE r.weight > 100 AND r.book = 1
RETURN c1.name, c2.name, r.weight",Verbose query,gameofthrones,False,False,True,
Find the top 5 characters with the highest weight in INTERACTS relationship.,"MATCH (c:Character)-[r:INTERACTS]->(:Character)
RETURN c.name, r.weight
ORDER BY r.weight DESC
LIMIT 5",Verbose query,gameofthrones,False,False,True,
Who are the characters with a louvain value of 0? Limit to top 5.,"MATCH (c:Character)
WHERE c.louvain = 0
RETURN c
ORDER BY c.name
LIMIT 5",Verbose query,gameofthrones,False,False,True,
List the top 3 characters with the least betweenness centrality in book 1.,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality IS NOT NULL
RETURN c.name, c.book1BetweennessCentrality
ORDER BY c.book1BetweennessCentrality ASC
LIMIT 3",Verbose query,gameofthrones,False,False,True,
Name 3 characters from the community with the highest number of members.,"MATCH (c:Character)
WITH c.community AS community, count(c) AS members
ORDER BY members DESC
LIMIT 1
WITH community AS largestCommunity
MATCH (c:Character)
WHERE c.community = largestCommunity
RETURN c.name
LIMIT 3",Verbose query,gameofthrones,False,False,True,
What are the names of the characters who have a degree greater than 50?,"MATCH (c:Character)
WHERE c.degree > 50
RETURN c.name",Verbose query,gameofthrones,False,False,True,
Who are the top 5 characters by pagerank in the entire dataset?,"MATCH (c:Character)
RETURN c.name, c.pagerank
ORDER BY c.pagerank DESC
LIMIT 5",Verbose query,gameofthrones,False,False,True,
Identify 3 characters with a book45PageRank greater than 5.,"MATCH (c:Character)
WHERE c.book45PageRank > 5
RETURN c
LIMIT 3",Verbose query,gameofthrones,False,False,True,
Which characters have a louvain community number less than 5? Limit to 5 characters.,"MATCH (c:Character)
WHERE c.louvain < 5
RETURN c
LIMIT 5",Verbose query,gameofthrones,False,False,False,
List the top 3 characters with the highest degree of centrality.,"MATCH (c:Character)
WHERE c.centrality IS NOT NULL
RETURN c.name, c.centrality
ORDER BY c.centrality DESC
LIMIT 3",Verbose query,gameofthrones,False,False,True,
What are the names of the top 5 characters with the highest book1PageRank?,"MATCH (c:Character)
WHERE c.book1PageRank IS NOT NULL
RETURN c.name AS Name, c.book1PageRank AS Book1PageRank
ORDER BY c.book1PageRank DESC
LIMIT 5",Verbose query,gameofthrones,False,False,True,
Who are the top 5 characters with the highest weight in INTERACTS45 relationships?,"MATCH (c1:Character)-[r:INTERACTS45]->(c2:Character)
RETURN c1.name, SUM(r.weight) AS totalWeight
ORDER BY totalWeight DESC
LIMIT 5",Complex Aggregation Queries,gameofthrones,False,False,True,
Find characters with a centrality above 0.8 and a book1BetweennessCentrality above 4000.,"MATCH (c:Character)
WHERE c.centrality > 0.8 AND c.book1BetweennessCentrality > 4000
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
List characters with a community of 795 and a pagerank below 0.2.,"MATCH (c:Character)
WHERE c.community = 795 AND c.pagerank < 0.2
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Who are the top 3 characters with the highest centrality?,"MATCH (c:Character)
WHERE c.centrality IS NOT NULL
RETURN c.name, c.centrality
ORDER BY c.centrality DESC
LIMIT 3",Complex Aggregation Queries,gameofthrones,False,False,True,
Find characters with a book1PageRank below 0.25 and a degree above 5.,"MATCH (c:Character)
WHERE c.book1PageRank < 0.25 AND c.degree > 5
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
List characters with a louvain value of 0 and a pagerank above 8.,"MATCH (c:Character)
WHERE c.louvain = 0 AND c.pagerank > 8
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
Who are the top 5 characters with the lowest weight in INTERACTS3 relationships?,"MATCH (c:Character)-[r:INTERACTS3]->(:Character)
RETURN c.name, r.weight
ORDER BY r.weight ASC
LIMIT 5",Complex Aggregation Queries,gameofthrones,False,False,True,
Find characters with a centrality above 0.5 and a book1BetweennessCentrality above 3000.,"MATCH (c:Character)
WHERE c.centrality > 0.5 AND c.book1BetweennessCentrality > 3000
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,False,
List characters with a community above 750 and a pagerank below 1.,"MATCH (c:Character)
WHERE c.community > 750 AND c.pagerank < 1
RETURN c.name, c.community, c.pagerank",Complex Aggregation Queries,gameofthrones,False,False,True,
Who are the top 3 characters with the lowest book45PageRank?,"MATCH (c:Character)
WHERE c.book45PageRank IS NOT NULL
RETURN c.name, c.book45PageRank
ORDER BY c.book45PageRank ASC
LIMIT 3",Complex Aggregation Queries,gameofthrones,False,False,True,
List characters with a centrality below 0.4 and a book45PageRank above 2.,"MATCH (c:Character)
WHERE c.centrality < 0.4 AND c.book45PageRank > 2
RETURN c",Complex Aggregation Queries,gameofthrones,False,False,True,
List all characters with a book1BetweennessCentrality lower than 50 and a book1PageRank higher than 2.,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality < 50 AND c.book1PageRank > 2
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
Which characters interact in book 1 with a weight greater than 50?,"MATCH (c1:Character)-[r:INTERACTS1]->(c2:Character)
WHERE r.weight > 50
RETURN c1.name, c2.name, r.weight",Simple Aggregation Queries,gameofthrones,False,False,True,
Identify characters with a centrality greater than 0.8 and a pagerank less than 0.4.,"MATCH (c:Character)
WHERE c.centrality > 0.8 AND c.pagerank < 0.4
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
Which characters from community 642 have 'pagerank' above 1?,"MATCH (c:Character)
WHERE c.community = 642 AND c.pagerank > 1
RETURN c.name, c.pagerank",Complex Retrieval Queries,gameofthrones,False,False,True,
Who interacted with 'Walder-Rivers' in 'book 45'? List first 3 characters.,"MATCH (c:Character)-[:INTERACTS45]->(target:Character {name: 'Walder-Rivers'})
RETURN c.name
LIMIT 3",Complex Retrieval Queries,gameofthrones,False,False,True,
Find all characters that have interacted in 'book 2' and have a 'louvain' value greater than 5.,"MATCH (c:Character)-[:INTERACTS2]->(:Character)
WHERE c.louvain > 5
RETURN c",Complex Retrieval Queries,gameofthrones,False,False,True,
Display characters with a 'community' of 504 and list top 3.,"MATCH (c:Character)
WHERE c.community = 504
RETURN c
ORDER BY c.pagerank DESC
LIMIT 3",Complex Retrieval Queries,gameofthrones,False,False,True,
Find characters that have 'INTERACTS1' relationship with a weight above 200.,"MATCH (c:Character)-[r:INTERACTS1]->(:Character)
WHERE r.weight > 200
RETURN c",Complex Retrieval Queries,gameofthrones,False,False,True,
Who has the highest 'book1BetweennessCentrality' among all characters? Show top 3.,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality IS NOT NULL
RETURN c.name, c.book1BetweennessCentrality
ORDER BY c.book1BetweennessCentrality DESC
LIMIT 3",Complex Retrieval Queries,gameofthrones,False,False,True,
Identify the characters with 'fastrf_embedding' values that start with a positive number. List the first 5.,"MATCH (c:Character)
WHERE c.fastrf_embedding[0] > 0
RETURN c.name, c.fastrf_embedding
LIMIT 5",Complex Retrieval Queries,gameofthrones,False,False,True,
Which characters have a 'community' number higher than 700 and a 'pagerank' above 1? List top 3.,"MATCH (c:Character)
WHERE c.community > 700 AND c.pagerank > 1
RETURN c
ORDER BY c.pagerank DESC
LIMIT 3",Complex Retrieval Queries,gameofthrones,False,False,True,
List the characters who have a 'book45PageRank' over 10.,"MATCH (c:Character)
WHERE c.book45PageRank > 10
RETURN c.name, c.book45PageRank",Complex Retrieval Queries,gameofthrones,False,False,True,
Who are the characters with a 'louvain' value of 10? Provide first 3 names.,"MATCH (c:Character)
WHERE c.louvain = 10
RETURN c.name
LIMIT 3",Complex Retrieval Queries,gameofthrones,False,False,True,
Which characters have interacted in 'book 1' with a weight less than 5?,"MATCH (c:Character)-[r:INTERACTS1]->(other:Character)
WHERE r.weight < 5
RETURN c.name AS Character, other.name AS InteractedWith, r.weight AS InteractionWeight",Complex Retrieval Queries,gameofthrones,False,False,True,
Identify characters with a 'degree' over 100. List the first 5.,"MATCH (c:Character)
WHERE c.degree > 100
RETURN c
LIMIT 5",Complex Retrieval Queries,gameofthrones,False,False,True,
Who are the top 3 characters with the highest 'book1BetweennessCentrality' in community 795?,"MATCH (c:Character)
WHERE c.community = 795 AND c.book1BetweennessCentrality IS NOT NULL
RETURN c.name, c.book1BetweennessCentrality
ORDER BY c.book1BetweennessCentrality DESC
LIMIT 3",Complex Retrieval Queries,gameofthrones,False,False,True,
Find all characters that have 'INTERACTS3' relationship with a weight above 90.,"MATCH (c:Character)-[r:INTERACTS3]->(:Character)
WHERE r.weight > 90
RETURN c",Complex Retrieval Queries,gameofthrones,False,False,True,
List the top 5 characters by 'centrality' who have a 'book45PageRank' above 1.,"MATCH (c:Character)
WHERE c.book45PageRank > 1
RETURN c.name, c.centrality
ORDER BY c.centrality DESC
LIMIT 5",Complex Retrieval Queries,gameofthrones,False,False,True,
Which characters interacted in 'book 45' with a weight of exactly 96?,"MATCH (c1:Character)-[r:INTERACTS45]->(c2:Character)
WHERE r.weight = 96
RETURN c1.name AS Character1, c2.name AS Character2, r.weight AS InteractionWeight",Complex Retrieval Queries,gameofthrones,False,False,True,
Identify all characters with a 'pagerank' below 0.2 and list top 3.,"MATCH (c:Character)
WHERE c.pagerank < 0.2
RETURN c
ORDER BY c.pagerank ASC
LIMIT 3",Complex Retrieval Queries,gameofthrones,False,False,True,
Which characters have the lowest 'book1BetweennessCentrality' and are part of community 579? Provide first 3 results.,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality IS NOT NULL AND c.community = 579
RETURN c
ORDER BY c.book1BetweennessCentrality ASC
LIMIT 3",Complex Retrieval Queries,gameofthrones,False,False,True,
List the top 3 characters by 'degree' who also have a 'book1PageRank' higher than 0.5.,"MATCH (c:Character)
WHERE c.book1PageRank > 0.5
RETURN c.name, c.degree
ORDER BY c.degree DESC
LIMIT 3",Complex Retrieval Queries,gameofthrones,False,False,True,
Who are the characters in the louvain community 5 with a 'book45PageRank' greater than 5?,"MATCH (c:Character)
WHERE c.louvain = 5 AND c.book45PageRank > 5
RETURN c.name",Complex Retrieval Queries,gameofthrones,False,False,True,
Find the characters who have interacted with 'Roose-Bolton' in 'book 1'. List the top 5.,"MATCH (c:Character)-[r:INTERACTS1]->(target:Character {name: 'Roose-Bolton'})
RETURN c.name, r.weight
ORDER BY r.weight DESC
LIMIT 5",Complex Retrieval Queries,gameofthrones,False,False,True,
Identify the top 5 characters by 'book1PageRank' who are in the same community as 'Ryman-Frey'.,"MATCH (c1:Character {name: 'Ryman-Frey'})
MATCH (c2:Character)
WHERE c2.community = c1.community
RETURN c2.name, c2.book1PageRank
ORDER BY c2.book1PageRank DESC
LIMIT 5",Complex Retrieval Queries,gameofthrones,False,False,True,
Which characters have a 'book1BetweennessCentrality' of exactly 0 and are part of community 642?,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality = 0 AND c.community = 642
RETURN c",Complex Retrieval Queries,gameofthrones,False,False,False,
Who are the top 3 characters in terms of 'pagerank' who also have a 'louvain' value of 1?,"MATCH (c:Character)
WHERE c.louvain = 1 AND c.pagerank IS NOT NULL
RETURN c
ORDER BY c.pagerank DESC
LIMIT 3",Complex Retrieval Queries,gameofthrones,False,False,True,
Which characters have a 'book1BetweennessCentrality' of exactly 168.75234023581112 and are part of community 642?,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality = 168.75234023581112 AND c.community = 642
RETURN c",Complex Retrieval Queries,gameofthrones,False,False,True,
Which characters from community 795 have 'pagerank' above 0.2?,"MATCH (c:Character)
WHERE c.community = 795 AND c.pagerank > 0.2
RETURN c.name, c.pagerank",Complex Retrieval Queries,gameofthrones,False,False,True,
Who interacted with 'Aeron-Greyjoy' in 'book 45'? List first 3 characters.,"MATCH (c:Character)-[:INTERACTS45]->(target:Character {name: 'Aeron-Greyjoy'})
RETURN c.name
LIMIT 3",Complex Retrieval Queries,gameofthrones,False,False,True,
Find all characters that have interacted in 'book 2' and have a 'louvain' value greater than 3.,"MATCH (c:Character)-[:INTERACTS2]->(:Character)
WHERE c.louvain > 3
RETURN c",Complex Retrieval Queries,gameofthrones,False,False,True,
Display characters with a 'community' of 735 and list top 3.,"MATCH (c:Character)
WHERE c.community = 735
RETURN c
ORDER BY c.pagerank DESC
LIMIT 3",Complex Retrieval Queries,gameofthrones,False,False,True,
Find characters that have 'INTERACTS1' relationship with a weight above 250.,"MATCH (c:Character)-[r:INTERACTS1]->(:Character)
WHERE r.weight > 250
RETURN c",Complex Retrieval Queries,gameofthrones,False,False,True,
Who has the highest 'book1PageRank' among all characters? Show top 3.,"MATCH (c:Character)
WHERE c.book1PageRank IS NOT NULL
RETURN c.name, c.book1PageRank
ORDER BY c.book1PageRank DESC
LIMIT 3",Complex Retrieval Queries,gameofthrones,False,False,True,
Identify the characters with 'fastrf_embedding' values that start with a negative number. List the first 5.,"MATCH (c:Character)
WHERE c.fastrf_embedding[0] < 0
RETURN c.name, c.fastrf_embedding
LIMIT 5",Complex Retrieval Queries,gameofthrones,False,False,True,
Which characters have a 'community' number higher than 600 and a 'pagerank' above 0.5? List top 3.,"MATCH (c:Character)
WHERE c.community > 600 AND c.pagerank > 0.5
RETURN c
ORDER BY c.pagerank DESC
LIMIT 3",Complex Retrieval Queries,gameofthrones,False,False,True,
List the characters who have a 'book45PageRank' over 11.,"MATCH (c:Character)
WHERE c.book45PageRank > 11
RETURN c.name, c.book45PageRank",Complex Retrieval Queries,gameofthrones,False,False,True,
Who are the characters with a 'louvain' value of 0? Provide first 3 names.,"MATCH (c:Character)
WHERE c.louvain = 0
RETURN c.name
LIMIT 3",Complex Retrieval Queries,gameofthrones,False,False,True,
Which characters have interacted in 'book 1' with a weight less than 10?,"MATCH (c:Character)-[r:INTERACTS1]->(other:Character)
WHERE r.weight < 10
RETURN c.name AS Character, other.name AS InteractedWith, r.weight AS InteractionWeight",Complex Retrieval Queries,gameofthrones,False,False,True,
Identify characters with a 'degree' over 150. List the first 5.,"MATCH (c:Character)
WHERE c.degree > 150
RETURN c
LIMIT 5",Complex Retrieval Queries,gameofthrones,False,False,True,
Who are the top 3 characters with the highest 'book1BetweennessCentrality' in community 504?,"MATCH (c:Character)
WHERE c.community = 504 AND c.book1BetweennessCentrality IS NOT NULL
RETURN c.name, c.book1BetweennessCentrality
ORDER BY c.book1BetweennessCentrality DESC
LIMIT 3",Complex Retrieval Queries,gameofthrones,False,False,True,
Find all characters that have 'INTERACTS2' relationship with a weight above 50.,"MATCH (c:Character)-[r:INTERACTS2]->(:Character)
WHERE r.weight > 50
RETURN c",Complex Retrieval Queries,gameofthrones,False,False,True,
List the top 5 characters by 'centrality' who have a 'book45PageRank' above 2.,"MATCH (c:Character)
WHERE c.book45PageRank > 2
RETURN c.name, c.centrality
ORDER BY c.centrality DESC
LIMIT 5",Complex Retrieval Queries,gameofthrones,False,False,True,
Which characters interacted in 'book 45' with a weight of exactly 50?,"MATCH (c1:Character)-[r:INTERACTS45]->(c2:Character)
WHERE r.weight = 50
RETURN c1.name AS Character1, c2.name AS Character2, r.weight AS InteractionWeight",Complex Retrieval Queries,gameofthrones,False,False,True,
Identify all characters with a 'pagerank' below 0.3 and list top 3.,"MATCH (c:Character)
WHERE c.pagerank < 0.3
RETURN c
ORDER BY c.pagerank ASC
LIMIT 3",Complex Retrieval Queries,gameofthrones,False,False,True,
Which characters have the lowest 'book1BetweennessCentrality' and are part of community 642? Provide first 3 results.,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality IS NOT NULL AND c.community = 642
RETURN c
ORDER BY c.book1BetweennessCentrality ASC
LIMIT 3",Complex Retrieval Queries,gameofthrones,False,False,True,
List the top 3 characters by 'degree' who also have a 'book1PageRank' higher than 1.,"MATCH (c:Character)
WHERE c.degree IS NOT NULL AND c.book1PageRank > 1
RETURN c
ORDER BY c.degree DESC
LIMIT 3",Complex Retrieval Queries,gameofthrones,False,False,True,
Who are the characters in the louvain community 6 with a 'book45PageRank' greater than 3?,"MATCH (c:Character)
WHERE c.louvain = 6 AND c.book45PageRank > 3
RETURN c.name",Complex Retrieval Queries,gameofthrones,False,False,True,
Find the characters who have interacted with 'Murenmure' in 'book 45'. List the top 5.,"MATCH (c:Character)-[r:INTERACTS45]->(m:Character {name: 'Murenmure'})
RETURN c.name, r.weight
ORDER BY r.weight DESC
LIMIT 5",Complex Retrieval Queries,gameofthrones,False,False,True,
List characters that have interacted in 'book 3' with a relationship weight of exactly 95.,"MATCH (c:Character)-[r:INTERACTS3 {weight: 95}]->(:Character)
RETURN c.name",Complex Retrieval Queries,gameofthrones,False,False,True,
Which characters have a book1PageRank greater than 5?,"MATCH (c:Character)
WHERE c.book1PageRank > 5
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
List characters that have interacted in 'book 3' with a relationship weight less than 10.,"MATCH (c:Character)-[r:INTERACTS3 {book: 3}]->(:Character)
WHERE r.weight < 10
RETURN c.name, r.weight",Complex Retrieval Queries,gameofthrones,False,False,True,
Identify the top 5 characters by 'book45PageRank' who are in the same community as 'Murenmure'.,"MATCH (m:Character {name: 'Murenmure'})
MATCH (c:Character)
WHERE c.community = m.community
RETURN c.name, c.book45PageRank
ORDER BY c.book45PageRank DESC
LIMIT 5",Complex Retrieval Queries,gameofthrones,False,False,True,
Identify the characters with an INTERACTS relationship with a weight over 300.,"MATCH (c:Character)-[r:INTERACTS]->(:Character)
WHERE r.weight > 300
RETURN c",Simple Retrieval Queries,gameofthrones,False,False,True,
Find three characters whose degree is exactly 0.,"MATCH (c:Character)
WHERE c.degree = 0
RETURN c
LIMIT 3",Simple Retrieval Queries,gameofthrones,False,False,True,
Retrieve the names of the characters who have a louvain community number of 6.,"MATCH (c:Character)
WHERE c.louvain = 6
RETURN c.name",Simple Retrieval Queries,gameofthrones,False,False,True,
List the names of three characters who have a book1BetweennessCentrality of 0.,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality = 0
RETURN c.name
LIMIT 3",Simple Retrieval Queries,gameofthrones,False,False,True,
Which characters have a fastrf_embedding first element below 0?,"MATCH (c:Character)
WHERE c.fastrf_embedding[0] < 0
RETURN c.name, c.fastrf_embedding",Simple Retrieval Queries,gameofthrones,False,False,True,
Find characters who have a book45PageRank less than 0.7 and limit the results to three.,"MATCH (c:Character)
WHERE c.book45PageRank < 0.7
RETURN c
LIMIT 3",Simple Retrieval Queries,gameofthrones,False,False,True,
Who are the characters connected by an INTERACTS3 relationship with a weight above 80?,"MATCH (c1:Character)-[r:INTERACTS3]->(c2:Character)
WHERE r.weight > 80
RETURN c1.name AS Character1, c2.name AS Character2, r.weight AS RelationshipWeight",Simple Retrieval Queries,gameofthrones,False,False,True,
List the characters with an INTERACTS2 relationship of weight less than 20.,"MATCH (c:Character)-[r:INTERACTS2]->(:Character)
WHERE r.weight < 20
RETURN c",Simple Retrieval Queries,gameofthrones,False,False,True,
Retrieve the first 3 characters who interact in book 1 with a weight of exactly 291.,"MATCH (c:Character)-[r:INTERACTS1 {weight: 291, book: 1}]->(:Character)
RETURN c
LIMIT 3",Simple Retrieval Queries,gameofthrones,False,False,True,
Who are the characters with a community number between 600 and 700?,"MATCH (c:Character)
WHERE c.community >= 600 AND c.community <= 700
RETURN c.name, c.community",Simple Retrieval Queries,gameofthrones,False,False,True,
"Find all characters involved in an INTERACTS relationship with a weight below 10, limit to 5 results.","MATCH (c1:Character)-[r:INTERACTS]->(c2:Character)
WHERE r.weight < 10
RETURN c1, r, c2
LIMIT 5",Simple Retrieval Queries,gameofthrones,False,False,True,
Fetch the top 5 characters based on the book1PageRank.,"MATCH (c:Character)
WHERE c.book1PageRank IS NOT NULL
RETURN c
ORDER BY c.book1PageRank DESC
LIMIT 5",Simple Retrieval Queries,gameofthrones,False,False,True,
What are the names of the characters that have an INTERACTS45 relationship with a weight greater than 50?,"MATCH (c1:Character)-[r:INTERACTS45]->(c2:Character)
WHERE r.weight > 50
RETURN c1.name, c2.name",Simple Retrieval Queries,gameofthrones,False,False,True,
Identify three characters whose fastrf_embedding includes a value greater than 1.,"MATCH (c:Character)
WHERE any(x IN c.fastrf_embedding WHERE x > 1)
RETURN c
LIMIT 3",Simple Retrieval Queries,gameofthrones,False,False,True,
List three characters with a pagerank less than 1.,"MATCH (c:Character)
WHERE c.pagerank < 1
RETURN c
LIMIT 3",Simple Retrieval Queries,gameofthrones,False,False,True,
Which characters are part of a community number greater than 750?,"MATCH (c:Character)
WHERE c.community > 750
RETURN c",Simple Retrieval Queries,gameofthrones,False,False,True,
Retrieve the names of 3 characters who have a louvain community number of 1.,"MATCH (c:Character)
WHERE c.louvain = 1
RETURN c.name
LIMIT 3",Simple Retrieval Queries,gameofthrones,False,False,True,
Who are the top 5 characters by degree in the database?,"MATCH (c:Character)
RETURN c.name, c.degree
ORDER BY c.degree DESC
LIMIT 5",Simple Retrieval Queries,gameofthrones,False,False,True,
Find all characters with a centrality of 0 and limit the results to 5.,"MATCH (c:Character)
WHERE c.centrality = 0
RETURN c
LIMIT 5",Simple Retrieval Queries,gameofthrones,False,False,True,
List the top 3 characters with the highest book45PageRank.,"MATCH (c:Character)
WHERE c.book45PageRank IS NOT NULL
RETURN c.name, c.book45PageRank
ORDER BY c.book45PageRank DESC
LIMIT 3",Simple Retrieval Queries,gameofthrones,False,False,True,
Which characters have a book1BetweennessCentrality greater than 2000?,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality > 2000
RETURN c.name, c.book1BetweennessCentrality",Simple Retrieval Queries,gameofthrones,False,False,True,
What are the top 5 characters by centrality in the database?,"MATCH (c:Character)
WHERE c.centrality IS NOT NULL
RETURN c.name, c.centrality
ORDER BY c.centrality DESC
LIMIT 5",Simple Retrieval Queries,gameofthrones,False,False,True,
Who are the top 3 characters in terms of 'pagerank' who also have a 'louvain' value of 6?,"MATCH (c:Character)
WHERE c.louvain = 6 AND c.pagerank IS NOT NULL
RETURN c.name, c.pagerank
ORDER BY c.pagerank DESC
LIMIT 3",Complex Retrieval Queries,gameofthrones,False,False,False,
List three characters with the highest pagerank in the database.,"MATCH (c:Character)
RETURN c.name, c.pagerank
ORDER BY c.pagerank DESC
LIMIT 3",Simple Retrieval Queries,gameofthrones,False,False,True,
Who are three characters connected by an INTERACTS45 relationship in book 45?,"MATCH (c1:Character)-[r:INTERACTS45]->(c2:Character)
WHERE r.book = 45
RETURN c1.name, c2.name
LIMIT 3",Simple Retrieval Queries,gameofthrones,False,False,True,
Which characters from community 795 have 'pagerank' above 0.15?,"MATCH (c:Character)
WHERE c.community = 795 AND c.pagerank > 0.15
RETURN c.name, c.pagerank",Complex Retrieval Queries,gameofthrones,False,False,True,
Who interacted with 'Aegon-Frey-(son-of-Stevron)'? List first 3 characters.,"MATCH (c:Character)-[:INTERACTS|:INTERACTS1|:INTERACTS2|:INTERACTS3|:INTERACTS45]->(target:Character {name: 'Aegon-Frey-(son-of-Stevron)'})
RETURN c.name
LIMIT 3",Complex Retrieval Queries,gameofthrones,False,False,True,
Find all characters that have interacted in 'book 2'.,"MATCH (c:Character)-[:INTERACTS2]->(other:Character)
RETURN c, other",Complex Retrieval Queries,gameofthrones,False,False,True,
Display characters with a 'community' of 642 and list top 3.,"MATCH (c:Character)
WHERE c.community = 642
RETURN c
ORDER BY c.pagerank DESC
LIMIT 3",Complex Retrieval Queries,gameofthrones,False,False,True,
Which characters have an 'INTERACTS45' relationship with a weight above 50?,"MATCH (c1:Character)-[r:INTERACTS45]->(c2:Character)
WHERE r.weight > 50
RETURN c1.name AS Character1, c2.name AS Character2, r.weight AS InteractionWeight",Complex Retrieval Queries,gameofthrones,False,False,True,
Who are the top 5 characters by 'book1PageRank' in descending order?,"MATCH (c:Character)
WHERE c.book1PageRank IS NOT NULL
RETURN c.name, c.book1PageRank
ORDER BY c.book1PageRank DESC
LIMIT 5",Complex Retrieval Queries,gameofthrones,False,False,True,
List the characters who have a 'degree' of zero.,"MATCH (c:Character)
WHERE c.degree = 0
RETURN c",Complex Retrieval Queries,gameofthrones,False,False,True,
Find characters that have 'book1BetweennessCentrality' greater than 100.,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality > 100
RETURN c",Complex Retrieval Queries,gameofthrones,False,False,True,
Who has the highest 'pagerank' among all characters? Show top 3.,"MATCH (c:Character)
RETURN c.name, c.pagerank
ORDER BY c.pagerank DESC
LIMIT 3",Complex Retrieval Queries,gameofthrones,False,False,True,
What are the names of characters who interact with 'Theon-Greyjoy' in any book? List up to 5.,"MATCH (c:Character)-[:INTERACTS|INTERACTS1|INTERACTS2|INTERACTS3|INTERACTS45]->(theon:Character {name: 'Theon-Greyjoy'})
RETURN c.name
LIMIT 5",Complex Retrieval Queries,gameofthrones,False,False,True,
Identify characters with a 'louvain' value of 1 and show the first 5.,"MATCH (c:Character)
WHERE c.louvain = 1
RETURN c
LIMIT 5",Complex Retrieval Queries,gameofthrones,False,False,True,
Which characters are part of community 579? Provide top 5 results.,"MATCH (c:Character)
WHERE c.community = 579
RETURN c
ORDER BY c.pagerank DESC
LIMIT 5",Complex Retrieval Queries,gameofthrones,False,False,True,
List all characters who have a 'book45PageRank' less than 1.,"MATCH (c:Character)
WHERE c.book45PageRank < 1
RETURN c",Complex Retrieval Queries,gameofthrones,False,False,True,
Who are the top 3 characters by 'degree' in the graph?,"MATCH (c:Character)
RETURN c.name, c.degree
ORDER BY c.degree DESC
LIMIT 3",Complex Retrieval Queries,gameofthrones,False,False,True,
Find all characters with a 'centrality' exactly at 0.5.,"MATCH (c:Character)
WHERE c.centrality = 0.5
RETURN c",Complex Retrieval Queries,gameofthrones,False,False,True,
Which characters have a 'book1PageRank' higher than 1? List the first 5.,"MATCH (c:Character)
WHERE c.book1PageRank > 1
RETURN c
ORDER BY c.book1PageRank DESC
LIMIT 5",Complex Retrieval Queries,gameofthrones,False,False,True,
Who are three characters with a centrality exactly 0.8333333333333334?,"MATCH (c:Character)
WHERE c.centrality = 0.8333333333333334
RETURN c.name
LIMIT 3",Simple Retrieval Queries,gameofthrones,False,False,True,
Find characters with a pagerank between 2 and 3.,"MATCH (c:Character)
WHERE c.pagerank >= 2 AND c.pagerank <= 3
RETURN c",Simple Retrieval Queries,gameofthrones,False,False,False,
List three characters whose degree is greater than 100.,"MATCH (c:Character)
WHERE c.degree > 100
RETURN c.name, c.degree
LIMIT 3",Simple Retrieval Queries,gameofthrones,False,False,False,
Who are the characters with a community number less than 580?,"MATCH (c:Character)
WHERE c.community < 580
RETURN c.name, c.community",Simple Retrieval Queries,gameofthrones,False,False,True,
Retrieve characters with a book1PageRank greater than 5 and limit to 5 results.,"MATCH (c:Character)
WHERE c.book1PageRank > 5
RETURN c
LIMIT 5",Simple Retrieval Queries,gameofthrones,False,False,True,
"Find characters involved in an INTERACTS1 relationship with a weight of 150, limit to 3 results.","MATCH (c1:Character)-[r:INTERACTS1 {weight: 150}]->(c2:Character)
RETURN c1, r, c2
LIMIT 3",Simple Retrieval Queries,gameofthrones,False,False,True,
What are the names of characters who have a pagerank and a centrality of 0?,"MATCH (c:Character)
WHERE c.pagerank = 0 AND c.centrality = 0
RETURN c.name",Pathfinding Queries,gameofthrones,False,False,True,
List all characters with a degree greater than 100.,"MATCH (c:Character)
WHERE c.degree > 100
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
Identify characters who belong to community 579.,"MATCH (c:Character)
WHERE c.community = 579
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
Which characters have a centrality of exactly 0?,"MATCH (c:Character)
WHERE c.centrality = 0
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
What are the names of characters who have a pagerank above 8?,"MATCH (c:Character)
WHERE c.pagerank > 8
RETURN c.name",Pathfinding Queries,gameofthrones,False,False,True,
Identify characters with a louvain value of 2.,"MATCH (c:Character)
WHERE c.louvain = 2
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
Which characters belong to community 579?,"MATCH (c:Character)
WHERE c.community = 579
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
Find characters with a book45PageRank less than 1.,"MATCH (c:Character)
WHERE c.book45PageRank < 1
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
Who are the top 5 characters by centrality metric?,"MATCH (c:Character)
WHERE c.centrality IS NOT NULL
RETURN c.name, c.centrality
ORDER BY c.centrality DESC
LIMIT 5",Pathfinding Queries,gameofthrones,False,False,True,
List all characters with a book1PageRank higher than 5.,"MATCH (c:Character)
WHERE c.book1PageRank > 5
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
Which characters have a degree greater than 100?,"MATCH (c:Character)
WHERE c.degree > 100
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
Who are the characters with a community number above 750?,"MATCH (c:Character)
WHERE c.community > 750
RETURN c.name, c.community",Simple Aggregation Queries,gameofthrones,False,False,True,
Identify characters with a degree exactly 125.,"MATCH (c:Character)
WHERE c.degree = 125
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
Which characters have a louvain value exactly 5 and a pagerank less than 2?,"MATCH (c:Character)
WHERE c.louvain = 5 AND c.pagerank < 2
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
List the characters whose name contains 'Greyjoy'.,"MATCH (c:Character)
WHERE c.name CONTAINS 'Greyjoy'
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
Who are the characters with an INTERACTS1 relationship and a weight under 30?,"MATCH (c:Character)-[r:INTERACTS1]->(:Character)
WHERE r.weight < 30
RETURN c.name, r.weight",Simple Aggregation Queries,gameofthrones,False,False,True,
List all characters with a book1BetweennessCentrality above 1500.,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality > 1500
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
Identify characters with a community number exactly 642.,"MATCH (c:Character)
WHERE c.community = 642
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
Which characters have a book1PageRank less than 0.4?,"MATCH (c:Character)
WHERE c.book1PageRank < 0.4
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
List characters with a pagerank between 0.2 and 1.0.,"MATCH (c:Character)
WHERE c.pagerank >= 0.2 AND c.pagerank <= 1.0
RETURN c.name, c.pagerank",Simple Aggregation Queries,gameofthrones,False,False,True,
Who are the top 3 characters by book45PageRank?,"MATCH (c:Character)
WHERE c.book45PageRank IS NOT NULL
RETURN c.name, c.book45PageRank
ORDER BY c.book45PageRank DESC
LIMIT 3",Simple Aggregation Queries,gameofthrones,False,False,True,
List the characters whose fastrf_embedding fifth element is greater than 0.5.,"MATCH (c:Character)
WHERE c.fastrf_embedding[4] > 0.5
RETURN c.name",Simple Aggregation Queries,gameofthrones,False,False,True,
Identify characters with a centrality exactly 0.0 and a degree over 20.,"MATCH (c:Character)
WHERE c.centrality = 0.0 AND c.degree > 20
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
Which characters have an INTERACTS relationship with a weight exactly 334?,"MATCH (c:Character)-[r:INTERACTS]->(:Character)
WHERE r.weight = 334
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
List all characters who have a book1BetweennessCentrality greater than 1000.,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality > 1000
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
List characters with a community number below 550.,"MATCH (c:Character)
WHERE c.community < 550
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
Who are the characters with a degree under 10?,"MATCH (c:Character)
WHERE c.degree < 10
RETURN c.name, c.degree",Pathfinding Queries,gameofthrones,False,False,True,
Who has the highest book45PageRank in community 759?,"MATCH (c:Character)
WHERE c.community = 759
RETURN c.name AS CharacterName, c.book45PageRank AS HighestBook45PageRank
ORDER BY c.book45PageRank DESC
LIMIT 1",Pathfinding Queries,gameofthrones,False,False,True,
Which characters belong to the community with the highest number of relationships?,"MATCH (c:Character)
WITH c.community AS community, count{(c)-[:INTERACTS|:INTERACTS1|:INTERACTS2|:INTERACTS3|:INTERACTS45]->()} AS totalRelationships
ORDER BY totalRelationships DESC
LIMIT 1
WITH community AS maxCommunity
MATCH (c2:Character)
WHERE c2.community = maxCommunity
RETURN c2.name AS CharacterName, c2.community AS Community",Pathfinding Queries,gameofthrones,False,False,True,
List the characters with a pagerank less than 0.2.,"MATCH (c:Character)
WHERE c.pagerank < 0.2
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
Who are the characters with a louvain value higher than 5?,"MATCH (c:Character)
WHERE c.louvain > 5
RETURN c.name, c.louvain",Pathfinding Queries,gameofthrones,False,False,True,
Find characters with a book1PageRank and book45PageRank both above 3.,"MATCH (c:Character)
WHERE c.book1PageRank > 3 AND c.book45PageRank > 3
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
List characters within louvain communities 0 to 5 with a pagerank greater than 0.5.,"MATCH (c:Character)
WHERE c.louvain >= 0 AND c.louvain <= 5 AND c.pagerank > 0.5
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
What are the names of characters with a degree of exactly 0?,"MATCH (c:Character)
WHERE c.degree = 0
RETURN c.name",Pathfinding Queries,gameofthrones,False,False,True,
Identify the characters in the top 10% of pagerank values.,"MATCH (c:Character)
WHERE c.pagerank >= 0.9 * 9.473142454730429
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
Which characters have a book1BetweennessCentrality of zero?,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality = 0
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
List the characters with a centrality between 0.2 and 0.5.,"MATCH (c:Character)
WHERE c.centrality >= 0.2 AND c.centrality <= 0.5
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
Who are the top 3 characters with the highest degree in community 795?,"MATCH (c:Character)
WHERE c.community = 795 AND c.degree IS NOT NULL
RETURN c.name, c.degree
ORDER BY c.degree DESC
LIMIT 3",Pathfinding Queries,gameofthrones,False,False,True,
Find characters connected by any INTERACTS relationship with a weight over 200.,"MATCH (c1:Character)-[r:INTERACTS]->(c2:Character)
WHERE r.weight > 200
RETURN c1.name, c2.name, r.weight",Pathfinding Queries,gameofthrones,False,False,True,
List characters who share the same community and have INTERACTS relationships.,"MATCH (c1:Character)-[:INTERACTS]->(c2:Character)
WHERE c1.community = c2.community AND c1.community IS NOT NULL
RETURN c1.name AS Character1, c2.name AS Character2",Pathfinding Queries,gameofthrones,False,False,True,
Identify all pairs of characters connected by INTERACTS where the weight is between 50 and 100.,"MATCH (c1:Character)-[r:INTERACTS]->(c2:Character)
WHERE r.weight >= 50 AND r.weight <= 100
RETURN c1.name, c2.name, r.weight",Pathfinding Queries,gameofthrones,False,False,True,
Which characters have an INTERACTS2 relationship with a book value of 2?,"MATCH (c:Character)-[r:INTERACTS2 {book: 2}]->(:Character)
RETURN c",Pathfinding Queries,gameofthrones,False,False,True,
Find all characters connected by INTERACTS3 with a weight less than 20.,"MATCH (c1:Character)-[r:INTERACTS3]->(c2:Character)
WHERE r.weight < 20
RETURN c1, r, c2",Pathfinding Queries,gameofthrones,False,False,True,
Who are the characters with an INTERACTS relationship of exact weight 45?,"MATCH (c:Character)-[r:INTERACTS {weight: 45}]->(:Character)
RETURN c.name",Pathfinding Queries,gameofthrones,False,False,True,
List all characters who interact in book 2.,"MATCH (c:Character)-[:INTERACTS2]->(:Character)
RETURN DISTINCT c",Pathfinding Queries,gameofthrones,False,False,True,
What are the characters involved in the top 3 heaviest INTERACTS45 relationships?,"MATCH (c1:Character)-[r:INTERACTS45]->(c2:Character)
RETURN c1.name, c2.name, r.weight
ORDER BY r.weight DESC
LIMIT 3",Pathfinding Queries,gameofthrones,False,False,True,
Identify the top 5 strongest INTERACTS relationships by weight.,"MATCH (c1:Character)-[r:INTERACTS]->(c2:Character)
RETURN c1.name, c2.name, r.weight
ORDER BY r.weight DESC
LIMIT 5",Pathfinding Queries,gameofthrones,False,False,True,
Which characters interact in book 1 with a weight greater than 100?,"MATCH (c1:Character)-[r:INTERACTS1]->(c2:Character)
WHERE r.weight > 100 AND r.book = 1
RETURN c1.name, c2.name, r.weight",Pathfinding Queries,gameofthrones,False,False,True,
List characters with the lowest 5 book1PageRanks.,"MATCH (c:Character)
WHERE c.book1PageRank IS NOT NULL
RETURN c
ORDER BY c.book1PageRank ASC
LIMIT 5",Pathfinding Queries,gameofthrones,False,False,True,
Find characters in the top 3 communities by number of members.,"MATCH (c:Character)
WITH c.community AS community, count(c) AS members
ORDER BY members DESC
LIMIT 3
WITH collect(community) AS topCommunities
MATCH (ch:Character)
WHERE ch.community IN topCommunities
RETURN ch.name, ch.community",Pathfinding Queries,gameofthrones,False,False,True,
What are the names of characters who have a centrality of 1.0?,"MATCH (c:Character)
WHERE c.centrality = 1.0
RETURN c.name",Simple Aggregation Queries,gameofthrones,False,False,True,
Identify the characters with a louvain value of exactly 2.,"MATCH (c:Character)
WHERE c.louvain = 2
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
List all characters whose name ends in 'Targaryen'.,"MATCH (c:Character)
WHERE c.name ENDS WITH 'Targaryen'
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,False,
List all characters with a louvain value of 10.,"MATCH (c:Character)
WHERE c.louvain = 10
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
Identify characters with a pagerank higher than 4.,"MATCH (c:Character)
WHERE c.pagerank > 4
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
Who are the top 5 characters with the lowest book1BetweennessCentrality?,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality IS NOT NULL
RETURN c.name, c.book1BetweennessCentrality
ORDER BY c.book1BetweennessCentrality ASC
LIMIT 5",Simple Aggregation Queries,gameofthrones,False,False,True,
Which characters are in the same community as Daenerys Targaryen?,"MATCH (c1:Character {name: ""Daenerys Targaryen""})
MATCH (c2:Character)
WHERE c1.community = c2.community AND c1 <> c2
RETURN c2.name AS CharacterName",Simple Aggregation Queries,gameofthrones,False,False,True,
List the characters who interact in book 3 with a weight over 50.,"MATCH (c:Character)-[r:INTERACTS3]->(:Character)
WHERE r.weight > 50
RETURN c.name, r.weight",Simple Aggregation Queries,gameofthrones,False,False,True,
Identify characters who have interacted in book 2 with any weight.,"MATCH (c:Character)-[r:INTERACTS2]->(:Character)
RETURN c.name, r.weight",Simple Aggregation Queries,gameofthrones,False,False,True,
Who has the highest centrality score in the graph?,"MATCH (c:Character)
RETURN c.name AS CharacterName, c.centrality AS CentralityScore
ORDER BY c.centrality DESC
LIMIT 1",Simple Aggregation Queries,gameofthrones,False,False,True,
List all characters with a book45PageRank above 8.,"MATCH (c:Character)
WHERE c.book45PageRank > 8
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
What are the top 5 characters by book1PageRank in descending order?,"MATCH (c:Character)
WHERE c.book1PageRank IS NOT NULL
RETURN c.name, c.book1PageRank
ORDER BY c.book1PageRank DESC
LIMIT 5",Simple Aggregation Queries,gameofthrones,False,False,True,
Which characters have an INTERACTS relationship with a weight under 10?,"MATCH (c:Character)-[r:INTERACTS]->(:Character)
WHERE r.weight < 10
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
Identify the top 3 characters by degree in the graph.,"MATCH (c:Character)
WHERE c.degree IS NOT NULL
RETURN c.name, c.degree
ORDER BY c.degree DESC
LIMIT 3",Simple Aggregation Queries,gameofthrones,False,False,True,
Which characters have a community number between 600 and 700?,"MATCH (c:Character)
WHERE c.community >= 600 AND c.community <= 700
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
List characters whose louvain community index is less than 5.,"MATCH (c:Character)
WHERE c.louvain < 5
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
What are the names of characters with a degree of zero?,"MATCH (c:Character)
WHERE c.degree = 0
RETURN c.name",Simple Aggregation Queries,gameofthrones,False,False,True,
Find all characters with fastrf_embedding values that include more than 0.5 in any dimension.,"MATCH (c:Character)
WHERE ANY(x IN c.fastrf_embedding WHERE x > 0.5)
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
Who are characters that interact in book 45 with a weight of exactly 96?,"MATCH (c1:Character)-[r:INTERACTS45]->(c2:Character)
WHERE r.weight = 96
RETURN c1.name AS Character1, c2.name AS Character2",Simple Aggregation Queries,gameofthrones,False,False,True,
What are the names of the top 5 characters by pagerank who also have a centrality greater than 0.5?,"MATCH (c:Character)
WHERE c.centrality > 0.5
RETURN c.name, c.pagerank
ORDER BY c.pagerank DESC
LIMIT 5",Verbose query,gameofthrones,False,False,True,
Who are the top 3 characters based on their book1BetweennessCentrality?,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality IS NOT NULL
RETURN c.name, c.book1BetweennessCentrality
ORDER BY c.book1BetweennessCentrality DESC
LIMIT 3",Simple Aggregation Queries,gameofthrones,False,False,True,
List characters with a louvain community value of 6.,"MATCH (c:Character)
WHERE c.louvain = 6
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
Which characters have a book45PageRank less than 1?,"MATCH (c:Character)
WHERE c.book45PageRank < 1
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
Who are the top 5 characters with the highest pagerank?,"MATCH (c:Character)
RETURN c.name, c.pagerank
ORDER BY c.pagerank DESC
LIMIT 5",Simple Aggregation Queries,gameofthrones,False,False,True,
Which characters have an INTERACTS1 relationship with a weight less than 100?,"MATCH (c:Character)-[r:INTERACTS1]->(:Character)
WHERE r.weight < 100
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
Which characters have a pagerank less than 0.5?,"MATCH (c:Character)
WHERE c.pagerank < 0.5
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
Who are the characters with a degree greater than 50 and less than 150?,"MATCH (c:Character)
WHERE c.degree > 50 AND c.degree < 150
RETURN c.name, c.degree",Simple Aggregation Queries,gameofthrones,False,False,True,
Which characters have a community number exactly 795?,"MATCH (c:Character)
WHERE c.community = 795
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
Identify characters with an INTERACTS45 relationship and a weight between 10 and 50.,"MATCH (c1:Character)-[r:INTERACTS45]->(c2:Character)
WHERE r.weight >= 10 AND r.weight <= 50
RETURN c1, r, c2",Simple Aggregation Queries,gameofthrones,False,False,False,
Who are the characters with a book1PageRank less than 1 and a degree over 10?,"MATCH (c:Character)
WHERE c.book1PageRank < 1 AND c.degree > 10
RETURN c.name, c.book1PageRank, c.degree",Simple Aggregation Queries,gameofthrones,False,False,True,
List the characters who interact in book 1 with a weight exactly 291.,"MATCH (c1:Character)-[r:INTERACTS1 {weight: 291}]->(c2:Character)
RETURN c1.name AS Character1, c2.name AS Character2",Simple Aggregation Queries,gameofthrones,False,False,True,
Identify characters with a book1BetweennessCentrality over 1000.,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality > 1000
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
Which characters have a community number and a louvain value both above 600?,"MATCH (c:Character)
WHERE c.community > 600 AND c.louvain > 600
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,False,
List characters whose fastrf_embedding tenth element is less than -0.5.,"MATCH (c:Character)
WHERE c.fastrf_embedding[9] < -0.5
RETURN c.name, c.fastrf_embedding",Simple Aggregation Queries,gameofthrones,False,False,True,
Who are the top 5 characters by degree in ascending order?,"MATCH (c:Character)
RETURN c.name, c.degree
ORDER BY c.degree ASC
LIMIT 5",Simple Aggregation Queries,gameofthrones,False,False,True,
Identify the characters who interact with 'Theon-Greyjoy' in any book.,"MATCH (c:Character)-[:INTERACTS|INTERACTS1|INTERACTS2|INTERACTS3|INTERACTS45]->(theon:Character {name: 'Theon-Greyjoy'})
RETURN DISTINCT c.name AS CharacterName",Simple Aggregation Queries,gameofthrones,False,False,True,
Which characters have a louvain community value of 3 and a pagerank over 2?,"MATCH (c:Character)
WHERE c.louvain = 3 AND c.pagerank > 2
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,False,
List all characters with a degree less than 5 but greater than 0.,"MATCH (c:Character)
WHERE c.degree < 5 AND c.degree > 0
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
Identify characters whose pagerank is exactly 0.15000000000000002.,"MATCH (c:Character)
WHERE c.pagerank = 0.15000000000000002
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
Who are the characters with a book1PageRank and a book45PageRank over 3?,"MATCH (c:Character)
WHERE c.book1PageRank > 3 AND c.book45PageRank > 3
RETURN c.name",Simple Aggregation Queries,gameofthrones,False,False,True,
List the characters that interact in book 45 with any character named 'Aegon-I-Targaryen'.,"MATCH (c:Character)-[:INTERACTS45]->(target:Character {name: 'Aegon-I-Targaryen'})
RETURN c.name AS CharacterName",Simple Aggregation Queries,gameofthrones,False,False,True,
Who are the characters with a book45PageRank between 2 and 5?,"MATCH (c:Character)
WHERE c.book45PageRank >= 2 AND c.book45PageRank <= 5
RETURN c.name, c.book45PageRank",Simple Aggregation Queries,gameofthrones,False,False,True,
Which characters have an INTERACTS3 relationship with a weight over 90?,"MATCH (c:Character)-[r:INTERACTS3]->(:Character)
WHERE r.weight > 90
RETURN c.name, r.weight",Simple Aggregation Queries,gameofthrones,False,False,True,
List characters in community 504.,"MATCH (c:Character)
WHERE c.community = 504
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
Identify characters with a centrality less than 0.5.,"MATCH (c:Character)
WHERE c.centrality < 0.5
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
Which characters have a book1PageRank exactly 0.15000000000000002?,"MATCH (c:Character)
WHERE c.book1PageRank = 0.15000000000000002
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
List the characters with an INTERACTS2 relationship and a weight of 92.,"MATCH (c:Character)-[r:INTERACTS2 {weight: 92}]->(:Character)
RETURN c.name, r.weight",Simple Aggregation Queries,gameofthrones,False,False,True,
Who are the characters with the lowest book45PageRank?,"MATCH (c:Character)
WHERE c.book45PageRank IS NOT NULL
RETURN c.name, c.book45PageRank
ORDER BY c.book45PageRank ASC
LIMIT 1",Simple Aggregation Queries,gameofthrones,False,False,True,
Identify characters with a fastrf_embedding first element greater than 0.5.,"MATCH (c:Character)
WHERE c.fastrf_embedding[0] > 0.5
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
List the characters whose name starts with 'A'.,"MATCH (c:Character)
WHERE c.name STARTS WITH 'A'
RETURN c",Simple Aggregation Queries,gameofthrones,False,False,True,
List the top 3 characters with the highest INTERACTS3 relationship weight.,"MATCH (c:Character)-[r:INTERACTS3]->(:Character)
RETURN c.name, r.weight
ORDER BY r.weight DESC
LIMIT 3",Verbose query,gameofthrones,False,False,True,
Who are the characters with a degree of 300?,"MATCH (c:Character)
WHERE c.degree = 300
RETURN c.name",Simple Aggregation Queries,gameofthrones,False,False,True,
What are the names of businesses located in Missoula?,"MATCH (b:Business {city: 'Missoula'})
RETURN b.name",Complex Aggregation Queries,grandstack,False,False,True,
How many businesses in 'San Mateo' have been reviewed in September of any year?,"MATCH (b:Business {city: 'San Mateo'})-[:REVIEWS]-(r:Review)
WHERE r.date.month = 9
RETURN count(DISTINCT b) AS NumberOfBusinessesReviewedInSeptember",Pathfinding Queries,grandstack,False,False,True,
Which user has the highest average star rating for their reviews and what businesses have they reviewed?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WITH u, avg(r.stars) AS avgStars, collect(b.name) AS businessesReviewed
ORDER BY avgStars DESC
LIMIT 1
RETURN u.name AS userName, avgStars, businessesReviewed",Pathfinding Queries,grandstack,False,False,True,
"List the reviews, including text and stars, for businesses owned by 'Neo4j'.","MATCH (b:Business {name: 'Neo4j'})-[:REVIEWS]-(r:Review)
RETURN r.text AS ReviewText, r.stars AS Stars",Pathfinding Queries,grandstack,False,False,True,
Which businesses in 'Missoula' have received reviews with less than 4 stars?,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]-(r:Review)
WHERE r.stars < 4
RETURN b.name, b.address, r.stars",Pathfinding Queries,grandstack,False,False,False,
What are the business names and categories for locations on 'Broadway St'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address CONTAINS 'Broadway St'
RETURN b.name AS BusinessName, c.name AS Category",Pathfinding Queries,grandstack,False,False,True,
Identify all users who have reviewed businesses on 'E Front St' and the names of those businesses.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.address CONTAINS 'E Front St'
RETURN u.name AS UserName, b.name AS BusinessName",Pathfinding Queries,grandstack,True,False,False,
Which categories include businesses that have been reviewed by 'Angie'?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(:Review)-[:REVIEWS]->(b:Business)-[:IN_CATEGORY]->(c:Category)
RETURN DISTINCT c.name",Pathfinding Queries,grandstack,True,False,False,
List all businesses with a review dated before 2016 and their corresponding review text.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.date < date('2016-01-01')
RETURN b.name, r.text",Pathfinding Queries,grandstack,False,False,True,
How many different users have reviewed 'KettleHouse Brewing Co.'?,"MATCH (b:Business {name: 'KettleHouse Brewing Co.'})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN count(DISTINCT u) AS NumberOfUsers",Pathfinding Queries,grandstack,False,False,True,
What are the names of businesses with locations within a 1km radius of POINT(-113.995057 46.874029)?,"MATCH (b:Business)
WHERE distance(b.location, point({longitude: -113.995057, latitude: 46.874029})) <= 1000
RETURN b.name",Pathfinding Queries,grandstack,False,False,True,
Find the top 5 longest reviews based on text length for businesses in 'Burlingame'.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.city = 'Burlingame'
RETURN b.name, r.text, length(r.text) AS reviewLength
ORDER BY reviewLength DESC
LIMIT 5",Pathfinding Queries,grandstack,False,False,False,
Which business located in 'Missoula' has the newest review?,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]-(r:Review)
RETURN b.name, b.businessId, r.date
ORDER BY r.date DESC
LIMIT 1",Pathfinding Queries,grandstack,False,False,True,
List the businesses that have received at least one review with a text mentioning 'great selection'.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'great selection'
RETURN DISTINCT b",Pathfinding Queries,grandstack,False,False,True,
What businesses are located at '200 W Pine St' and what categories are they in?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address = '200 W Pine St'
RETURN b.name AS BusinessName, c.name AS Category",Pathfinding Queries,grandstack,False,False,True,
Identify businesses that have been reviewed by both 'Jenny' and 'Bob'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
WHERE u.name IN ['Jenny', 'Bob']
WITH b, count(DISTINCT u) AS reviewersCount
WHERE reviewersCount = 2
RETURN b",Pathfinding Queries,grandstack,False,False,True,
Which user has written the most reviews for businesses in 'Missoula'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Missoula'})
WITH u, count(r) AS reviewsCount
RETURN u.name AS UserName, reviewsCount
ORDER BY reviewsCount DESC
LIMIT 1",Pathfinding Queries,grandstack,False,False,True,
What are the addresses of businesses that have reviews with 4 stars or more and are located in 'Burlingame'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.city = 'Burlingame' AND r.stars >= 4.0
RETURN b.address",Pathfinding Queries,grandstack,False,False,True,
List all categories associated with businesses in 'San Mateo'.,"MATCH (b:Business {city: 'San Mateo'})-[:IN_CATEGORY]->(c:Category)
RETURN DISTINCT c.name",Pathfinding Queries,grandstack,False,False,True,
Which business has received the most reviews in 2018?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2018-01-01') AND r.date <= date('2018-12-31')
RETURN b.name, count(r) AS reviews_count
ORDER BY reviews_count DESC
LIMIT 1",Pathfinding Queries,grandstack,False,False,True,
What are the names of all users who have reviewed 'Neo4j'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {name: 'Neo4j'})
RETURN u.name",Pathfinding Queries,grandstack,False,False,False,
Find the top 3 highest-rated businesses in Missoula.,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]-(r:Review)
RETURN b.name, avg(r.stars) AS average_rating
ORDER BY average_rating DESC
LIMIT 3",Pathfinding Queries,grandstack,False,False,False,
How many users have written reviews for businesses located at '301 E Main St'?,"MATCH (b:Business {address: '301 E Main St'})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN count(DISTINCT u) AS NumberOfUsers",Pathfinding Queries,grandstack,False,False,False,
List the names and addresses of businesses in San Mateo that have 'Car Wash' in their category.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'San Mateo' AND c.name CONTAINS 'Car Wash'
RETURN b.name, b.address",Pathfinding Queries,grandstack,False,False,True,
Identify the businesses that have been reviewed exactly three times and list the review dates.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, count(r) AS reviewsCount
WHERE reviewsCount = 3
MATCH (b)<-[:REVIEWS]-(r:Review)
RETURN b.name, collect(r.date) AS reviewDates",Pathfinding Queries,grandstack,False,False,True,
What are the names of businesses in 'Burlingame' that are categorized as libraries?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Burlingame' AND c.name = 'Library'
RETURN b.name",Pathfinding Queries,grandstack,False,False,False,
Which business has the oldest review and what is the text of that review?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
RETURN b.name AS BusinessName, r.text AS ReviewText
ORDER BY r.date ASC
LIMIT 1",Pathfinding Queries,grandstack,False,False,True,
List all businesses that have been reviewed by 'Will' and the corresponding categories of these businesses.,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)-[:IN_CATEGORY]->(c:Category)
RETURN b.name AS BusinessName, c.name AS CategoryName",Pathfinding Queries,grandstack,False,False,True,
Which user has reviewed the most categories of businesses and what are those categories?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)-[:IN_CATEGORY]->(c:Category)
WITH u, collect(DISTINCT c.name) AS categories
ORDER BY size(categories) DESC
LIMIT 1
RETURN u.name AS UserName, categories AS CategoriesReviewed",Pathfinding Queries,grandstack,False,False,False,
List the businesses in 'San Mateo' that have received reviews with exactly 4 stars.,"MATCH (b:Business {city: 'San Mateo'})-[:REVIEWS]-(r:Review {stars: 4.0})
RETURN b",Pathfinding Queries,grandstack,False,False,True,
What are the names of businesses in 'Missoula' with reviews dated on or after '2017-01-01'?,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2017-01-01')
RETURN DISTINCT b.name",Pathfinding Queries,grandstack,False,False,False,
Identify all businesses reviewed by 'Jenny' in '2016' and list the review stars and texts.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date.year = 2016
RETURN b.name AS BusinessName, r.stars AS Stars, r.text AS ReviewText",Pathfinding Queries,grandstack,False,False,True,
Which businesses on 'Broadway St' have been reviewed in 2017 and what are the reviewers' names?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)-[:WROTE]->(u:User)
WHERE b.address CONTAINS 'Broadway St' AND r.date >= date('2017-01-01') AND r.date <= date('2017-12-31')
RETURN b.name AS BusinessName, u.name AS ReviewerName",Pathfinding Queries,grandstack,False,False,True,
List the names of businesses in 'San Mateo' that are categorized as 'Car Wash' along with their reviews.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Car Wash'})
WHERE b.city = 'San Mateo'
MATCH (r:Review)-[:REVIEWS]->(b)
RETURN b.name, r.text",Pathfinding Queries,grandstack,False,False,True,
What are the review texts for the highest rated business in 'Burlingame'?,"MATCH (b:Business {city: 'Burlingame'})-[:REVIEWS]->(r:Review)
WITH b, r ORDER BY r.stars DESC LIMIT 1
MATCH (r)-[:REVIEWS]->(b)
RETURN r.text",Pathfinding Queries,grandstack,False,False,True,
Find the top 3 businesses in 'MT' based on the number of reviews they have received.,"MATCH (b:Business {state: 'MT'})-[:REVIEWS]-(r:Review)
WITH b, count(r) AS reviewsCount
ORDER BY reviewsCount DESC
LIMIT 3
RETURN b.name, b.address, reviewsCount",Pathfinding Queries,grandstack,False,False,True,
Which businesses have been reviewed by users named 'Angie' and 'Will' and what are the review texts?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE u.name IN ['Angie', 'Will']
RETURN b.name AS BusinessName, r.text AS ReviewText",Pathfinding Queries,grandstack,False,False,False,
List all users who have reviewed 'Zootown Brew' and the text of their reviews.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {name: 'Zootown Brew'})
RETURN u.name AS UserName, r.text AS ReviewText",Pathfinding Queries,grandstack,False,False,True,
Which business in 'San Mateo' has the highest average review star rating and what are its reviews?,"MATCH (b:Business {city: 'San Mateo'})-[:REVIEWS]-(r:Review)
WITH b, avg(r.stars) AS avgRating
ORDER BY avgRating DESC
LIMIT 1
MATCH (b)-[:REVIEWS]-(r:Review)
RETURN b.name, b.address, r AS reviews, avgRating",Pathfinding Queries,grandstack,False,False,False,
Which businesses in Burlingame have received a 5-star review?,"MATCH (b:Business {city: 'Burlingame'})-[:REVIEWS]-(r:Review {stars: 5})
RETURN b.name, b.address",Pathfinding Queries,grandstack,False,False,True,
Identify businesses in 'Burlingame' with reviews mentioning 'love' and list the reviewers.,"MATCH (b:Business {city: 'Burlingame'})-[:REVIEWS]-(r:Review)-[:WROTE]-(u:User)
WHERE r.text CONTAINS 'love'
RETURN b.name AS BusinessName, u.name AS ReviewerName",Pathfinding Queries,grandstack,False,False,False,
List the names of users who have reviewed businesses in both 'Missoula' and 'San Mateo'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.city IN ['Missoula', 'San Mateo']
WITH u, collect(DISTINCT b.city) AS cities
WHERE ALL(city IN ['Missoula', 'San Mateo'] WHERE city IN cities)
RETURN u.name",Pathfinding Queries,grandstack,False,False,True,
Find businesses that have been reviewed on 'Pine St' and list their categories and review dates.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)-[:IN_CATEGORY]->(c:Category)
WHERE b.address CONTAINS 'Pine St'
RETURN b.name, c.name AS category, r.date AS review_date",Pathfinding Queries,grandstack,False,False,True,
Which businesses in 'Missoula' have received reviews only from 'Jenny'?,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]-(r:Review)-[:WROTE]-(u:User {name: 'Jenny'})
WITH b, collect(u) AS reviewers
WHERE all(u IN reviewers WHERE u.name = 'Jenny')
RETURN b",Pathfinding Queries,grandstack,False,False,True,
List all businesses that have been reviewed on 'E Front St' and their review stars.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.address ENDS WITH 'E Front St'
RETURN b.name, r.stars",Pathfinding Queries,grandstack,False,False,False,
Which users have reviewed more than one business in 'San Mateo' and what are those businesses?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'San Mateo'})
WITH u, count(DISTINCT b) AS businesses_count, collect(DISTINCT b.name) AS business_names
WHERE businesses_count > 1
RETURN u.name AS user_name, business_names",Pathfinding Queries,grandstack,False,False,False,
What are the names of businesses on 'California Dr' and their corresponding categories?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address CONTAINS 'California Dr'
RETURN b.name AS BusinessName, c.name AS Category",Pathfinding Queries,grandstack,False,False,True,
Identify the business with the most reviews in 'Burlingame' and list its reviews.,"MATCH (b:Business {city: 'Burlingame'})-[:REVIEWS]-(r:Review)
WITH b, count(r) AS reviewsCount
ORDER BY reviewsCount DESC
LIMIT 1
MATCH (b)-[:REVIEWS]-(r:Review)
RETURN b, collect(r) AS Reviews",Pathfinding Queries,grandstack,False,False,True,
List the reviews with a star rating of 5 for businesses on 'Main St' and the name of the reviewers.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars = 5 AND b.address CONTAINS 'Main St'
RETURN r as Review, u.name as ReviewerName",Pathfinding Queries,grandstack,False,False,True,
Which businesses have a 'Library' category and are located in 'CA'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
WHERE b.state = 'CA'
RETURN b",Pathfinding Queries,grandstack,False,False,True,
What are the top 3 most frequent categories of businesses in 'San Mateo'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'San Mateo'
WITH c, count(b) AS businessCount
ORDER BY businessCount DESC
LIMIT 3
RETURN c.name, businessCount",Pathfinding Queries,grandstack,False,False,True,
Find businesses in 'Missoula' that have received exactly two reviews and list the names of the reviewers.,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]-(r:Review)-[:WROTE]-(u:User)
WITH b, count(r) AS reviewsCount, collect(u.name) AS reviewerNames
WHERE reviewsCount = 2
RETURN b.name AS BusinessName, reviewerNames",Pathfinding Queries,grandstack,False,False,False,
"What are the names, addresses, and categories of businesses that have been reviewed by 'Bob'?","MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)-[:IN_CATEGORY]->(c:Category)
RETURN b.name AS BusinessName, b.address AS Address, c.name AS Category",Pathfinding Queries,grandstack,False,False,True,
What are the names of businesses in Missoula that are categorized as breweries?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Missoula' AND c.name = 'Brewery'
RETURN b.name",Pathfinding Queries,grandstack,False,False,False,
Which businesses have been reviewed on '2018-09-10'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date = date('2018-09-10')
RETURN b.name AS BusinessName",Simple Aggregation Queries,grandstack,False,False,True,
What are the review texts for businesses on 'N San Mateo Dr'?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.address CONTAINS 'N San Mateo Dr'
RETURN r.text",Simple Aggregation Queries,grandstack,False,False,True,
Which user has the lowest average review stars? Display top 3 users.,"MATCH (u:User)-[:WROTE]->(r:Review)
WITH u, AVG(r.stars) AS avg_stars
ORDER BY avg_stars ASC
LIMIT 3
RETURN u.name AS user, avg_stars",Simple Aggregation Queries,grandstack,False,False,True,
What are the names of businesses that have been reviewed at least three times?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, count(r) AS reviewsCount
WHERE reviewsCount >= 3
RETURN b.name",Simple Aggregation Queries,grandstack,False,False,True,
Which categories does the business 'Missoula Public Library' belong to?,"MATCH (b:Business {name: 'Missoula Public Library'})-[:IN_CATEGORY]->(c:Category)
RETURN c.name",Simple Aggregation Queries,grandstack,False,False,True,
What is the average number of stars given by each user? Limit the results to top 5 users.,"MATCH (u:User)-[:WROTE]->(r:Review)
WITH u, avg(r.stars) AS averageStars
RETURN u.name AS UserName, averageStars
ORDER BY averageStars DESC
LIMIT 5",Simple Aggregation Queries,grandstack,False,False,True,
List all reviews that have 5 stars and were written in 2018.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars = 5.0 AND r.date.year = 2018
RETURN r, u.name AS reviewer, b.name AS business",Simple Aggregation Queries,grandstack,False,False,True,
Which business has the highest average review rating? Limit the results to top 3 businesses.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WITH b, AVG(r.stars) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN b.name, avgRating",Simple Aggregation Queries,grandstack,False,False,True,
What are the names of businesses that are reviewed by user 'Will'?,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name",Simple Aggregation Queries,grandstack,False,False,True,
Which business has the most reviews written in 2017?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2017-01-01') AND r.date <= date('2017-12-31')
WITH b, count(r) AS reviewsCount
RETURN b.name, reviewsCount
ORDER BY reviewsCount DESC
LIMIT 1",Simple Aggregation Queries,grandstack,False,False,True,
What is the average star rating for businesses in the 'Car Wash' category?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Car Wash'})
MATCH (r:Review)-[:REVIEWS]->(b)
RETURN AVG(r.stars) AS average_star_rating",Simple Aggregation Queries,grandstack,False,False,True,
Which users have written more than one review? List their names and the number of reviews they've written.,"MATCH (u:User)-[:WROTE]->(r:Review)
WITH u, count(r) AS reviewsCount
WHERE reviewsCount > 1
RETURN u.name AS UserName, reviewsCount",Simple Aggregation Queries,grandstack,False,False,True,
What are the addresses of 'Brewing Co.' businesses in Missoula?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.name CONTAINS 'Brewing Co.' AND b.city = 'Missoula'
RETURN b.address",Simple Aggregation Queries,grandstack,False,False,True,
What is the relationship between the business 'Hanabi' and its reviewers?,"MATCH (b:Business {name: 'Hanabi'})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN b.name AS Business, u.name AS Reviewer, r.text AS ReviewText, r.stars AS ReviewStars",Simple Aggregation Queries,grandstack,False,False,True,
What are the businesses with the highest review stars in Burlingame?,"MATCH (b:Business {city: 'Burlingame'})-[:IN_CATEGORY]->(c:Category),
      (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b)
WITH b, MAX(r.stars) AS highestStars
RETURN b.name, b.address, highestStars
ORDER BY highestStars DESC",Simple Aggregation Queries,grandstack,False,False,True,
Which businesses are in the category 'Library'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
RETURN b",Simple Aggregation Queries,grandstack,False,False,True,
What are the recent three reviews for the business named 'Neo4j'?,"MATCH (b:Business {name: 'Neo4j'})-[:REVIEWS]-(r:Review)
RETURN r
ORDER BY r.date DESC
LIMIT 3",Simple Aggregation Queries,grandstack,False,False,False,
Which users have written reviews for businesses located on 'W Broadway St'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.address IN ['1151 W Broadway St', '121 W Broadway St']
RETURN DISTINCT u.name AS UserName",Simple Aggregation Queries,grandstack,False,False,True,
How many reviews does each business in San Mateo have? Limit the results to top 3 businesses.,"MATCH (b:Business {city: 'San Mateo'})-[:REVIEWS]-(r:Review)
RETURN b.name, count(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3",Simple Aggregation Queries,grandstack,False,False,True,
What are the names and addresses of businesses that have a rating of 4.0 or higher?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.stars >= 4.0
RETURN b.name, b.address",Simple Aggregation Queries,grandstack,False,False,True,
List the top 5 businesses in California based on the number of reviews.,"MATCH (b:Business {state: 'CA'})-[:REVIEWS]->(r:Review)
WITH b, count(r) AS reviewsCount
ORDER BY reviewsCount DESC
LIMIT 5
RETURN b.name, b.address, reviewsCount",Simple Aggregation Queries,grandstack,False,False,True,
Which businesses are located in Missoula?,"MATCH (b:Business {city: 'Missoula'})
RETURN b",Simple Aggregation Queries,grandstack,False,False,False,
List the top 3 recent reviews and the corresponding businesses that received them.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r.date AS ReviewDate, r.text AS ReviewText, b.name AS BusinessName
ORDER BY r.date DESC
LIMIT 3",Complex Retrieval Queries,grandstack,False,False,True,
Identify the businesses with reviews on or after '2018-01-01' and their corresponding users.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date('2018-01-01')
RETURN b, u",Complex Retrieval Queries,grandstack,False,False,False,
Name the businesses with the highest number of reviews in 'Missoula'.,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]-(r:Review)
WITH b, count(r) AS reviewsCount
ORDER BY reviewsCount DESC
RETURN b.name, reviewsCount
LIMIT 1",Complex Retrieval Queries,grandstack,False,False,True,
List the businesses that have reviews with text mentioning 'IPA selection'.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.text CONTAINS 'IPA selection'
RETURN b",Complex Retrieval Queries,grandstack,True,False,False,
How many businesses are there in each city? Display only for cities with at least two businesses.,"MATCH (b:Business)
WITH b.city AS city, count(b) AS businessCount
WHERE businessCount >= 2
RETURN city, businessCount",Simple Aggregation Queries,grandstack,True,False,False,
Identify businesses on '1st St W' with reviews mentioning 'selection' and list the review stars.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.address CONTAINS '1st St W' AND r.text CONTAINS 'selection'
RETURN b.name, r.stars",Pathfinding Queries,grandstack,False,False,True,
How many businesses are there in Missoula with a 5-star review?,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]->(r:Review {stars: 5.0})
RETURN count(DISTINCT b) AS FiveStarBusinessesInMissoula",Simple Aggregation Queries,grandstack,False,False,True,
List the businesses that are located within 2 miles of '301 E Main St'.,"MATCH (b:Business)
WHERE distance(b.location, point({address: '301 E Main St'})) <= 3218.69
RETURN b",Simple Aggregation Queries,grandstack,False,False,False,
How many businesses have a point location within 1 mile of POINT(-113.995057 46.874029)?,"MATCH (b:Business)
WHERE distance(b.location, point({longitude: -113.995057, latitude: 46.874029})) <= 1609.34
RETURN count(b) AS NumberOfBusinessesWithin1Mile",Simple Aggregation Queries,grandstack,False,False,True,
Which category has the fewest businesses?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WITH c, count(b) AS numBusinesses
ORDER BY numBusinesses ASC
LIMIT 1
RETURN c.name AS Category, numBusinesses",Simple Aggregation Queries,grandstack,False,False,True,
What are the cities with the highest number of reviews? Limit to top 3 cities.,"MATCH (b:Business)<-[:REVIEWS]-(:Review)
WITH b.city AS city, count(*) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3
RETURN city, reviewCount",Simple Aggregation Queries,grandstack,False,False,True,
Which businesses have a user review that includes the word 'great'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)-[:WROTE]->(u:User)
WHERE r.text CONTAINS 'great'
RETURN b.name, b.address, b.city, b.state",Simple Aggregation Queries,grandstack,False,False,True,
How many reviews mention 'breakfast'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'breakfast'
RETURN count(r) AS NumberOfReviewsMentioningBreakfast",Simple Aggregation Queries,grandstack,False,False,True,
What are the names of users who have reviewed the 'Missoula Public Library'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.name = 'Missoula Public Library'
RETURN u.name",Simple Aggregation Queries,grandstack,False,False,True,
What are the names of businesses with a review text containing 'IPA'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'IPA'
RETURN b.name",Simple Aggregation Queries,grandstack,False,False,True,
List the businesses that have been reviewed in September 2018.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2018-09-01') AND r.date <= date('2018-09-30')
RETURN b",Simple Aggregation Queries,grandstack,False,False,True,
Which business has the newest review in 'San Mateo'?,"MATCH (b:Business {city: 'San Mateo'})-[:REVIEWS]-(r:Review)
RETURN b.name AS BusinessName, r.date AS ReviewDate
ORDER BY r.date DESC
LIMIT 1",Simple Aggregation Queries,grandstack,False,False,True,
What is the average star rating of businesses in 'Missoula'?,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]->(r:Review)
RETURN AVG(r.stars) AS averageStarRating",Simple Aggregation Queries,grandstack,False,False,False,
How many reviews does the 'Neo4j' business have?,"MATCH (b:Business {name: 'Neo4j'})-[:REVIEWS]-(r:Review)
RETURN count(r) AS NumberOfReviews",Simple Aggregation Queries,grandstack,False,False,True,
What is the text of the most recent review for 'KettleHouse Brewing Co.'?,"MATCH (b:Business {name: 'KettleHouse Brewing Co.'})<-[:REVIEWS]-(r:Review)
RETURN r.text AS reviewText
ORDER BY r.date DESC
LIMIT 1",Simple Aggregation Queries,grandstack,False,False,False,
What are the names and review dates of reviews written by 'Angie'?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS BusinessName, r.date AS ReviewDate",Simple Aggregation Queries,grandstack,False,False,True,
Which businesses have been reviewed both by 'Jenny' and 'Bob'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
WHERE u.name IN ['Jenny', 'Bob']
WITH b, count(DISTINCT u) AS userCount
WHERE userCount = 2
RETURN b",Simple Aggregation Queries,grandstack,False,False,True,
What is the text of the review with the lowest stars for the business named 'Market on Front'?,"MATCH (b:Business {name: 'Market on Front'})<-[:REVIEWS]-(r:Review)
RETURN r.text AS review_text
ORDER BY r.stars ASC
LIMIT 1",Simple Aggregation Queries,grandstack,False,False,True,
Which business located on 'E Front St' has the highest average star rating?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.address CONTAINS 'E Front St'
WITH b, AVG(r.stars) AS avg_stars
RETURN b.name AS BusinessName, avg_stars
ORDER BY avg_stars DESC
LIMIT 1",Simple Aggregation Queries,grandstack,False,False,True,
How many reviews were written in the year 2016?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date('2016-01-01') AND r.date <= date('2016-12-31')
RETURN count(r) AS NumberOfReviewsIn2016",Simple Aggregation Queries,grandstack,False,False,True,
Which user has reviewed the most distinct businesses?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WITH u, count(DISTINCT b) AS numBusinesses
RETURN u.name AS userName, numBusinesses
ORDER BY numBusinesses DESC
LIMIT 1",Simple Aggregation Queries,grandstack,False,False,True,
What is the distribution of businesses by state?,"MATCH (b:Business)
RETURN b.state AS State, count(b) AS NumberOfBusinesses
ORDER BY b.state",Simple Aggregation Queries,grandstack,False,False,False,
Which businesses have reviews with a star rating below 4? List the top 3.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.stars < 4
RETURN b.name, b.businessId, b.address, b.city, b.state
ORDER BY r.stars ASC
LIMIT 3",Simple Aggregation Queries,grandstack,False,False,False,
What is the name and address of the business with the oldest review date?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
RETURN b.name AS BusinessName, b.address AS Address
ORDER BY r.date ASC
LIMIT 1",Simple Aggregation Queries,grandstack,False,False,True,
How many categories are there for each business? Limit the results to businesses with more than one category.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WITH b, count(c) AS numCategories
WHERE numCategories > 1
RETURN b.name, numCategories",Simple Aggregation Queries,grandstack,False,False,False,
What are the names of businesses that have a review with exactly 4.5 stars?,"MATCH (b:Business)-[:REVIEWS]->(r:Review {stars: 4.5})
RETURN b.name",Simple Aggregation Queries,grandstack,False,False,True,
Which users have never written a review?,"MATCH (u:User)
WHERE NOT exists{ (u)-[:WROTE]->(:Review) }
RETURN u",Simple Aggregation Queries,grandstack,True,False,False,
How many businesses are there in each category? Limit the results to top 5 categories.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WITH c.name AS CategoryName, count(b) AS NumberOfBusinesses
ORDER BY NumberOfBusinesses DESC
LIMIT 5
RETURN CategoryName, NumberOfBusinesses",Simple Aggregation Queries,grandstack,False,False,True,
List the names of businesses in 'Burlingame' that have received a review from 'Angie' and the review dates.,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Burlingame'})
RETURN b.name AS BusinessName, r.date AS ReviewDate",Pathfinding Queries,grandstack,False,False,True,
Which business in 'Missoula' has the most reviews from 'Will' and what are the review texts?,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Missoula'})
WITH b, collect(r.text) AS reviewTexts, count(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 1
RETURN b.name AS BusinessName, reviewTexts",Pathfinding Queries,grandstack,False,False,True,
Find the top 5 businesses with reviews mentioning 'IPA' and the names of the reviewers.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)-[:WROTE]->(u:User)
WHERE r.text CONTAINS 'IPA'
RETURN b.name AS BusinessName, collect(u.name) AS ReviewerNames
ORDER BY size(collect(r.reviewId)) DESC
LIMIT 5",Pathfinding Queries,grandstack,False,False,False,
List the top 5 reviews that mention 'breakfast' in their text.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'breakfast'
RETURN r, u, b
ORDER BY r.stars DESC
LIMIT 5",Verbose query,grandstack,False,False,True,
Identify the first 3 businesses that have been reviewed by the user named 'Bob'.,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b
LIMIT 3",Verbose query,grandstack,False,False,False,
List the business names and review texts for the top 3 highest-rated reviews in 'Burlingame'.,"MATCH (b:Business {city: 'Burlingame'})-[:IN_CATEGORY]->(c:Category),
      (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b)
WITH b, r
ORDER BY r.stars DESC
LIMIT 3
RETURN b.name AS BusinessName, r.text AS ReviewText",Verbose query,grandstack,False,False,True,
Which reviews have a star rating exactly 3.0 and mention 'wifi'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars = 3.0 AND r.text CONTAINS 'wifi'
RETURN u, r, b",Verbose query,grandstack,True,False,False,
What are the business names and addresses for businesses that have received a review on '2018-09-10'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.date = date('2018-09-10')
RETURN b.name AS BusinessName, b.address AS Address",Verbose query,grandstack,False,False,True,
List the first 5 categories that have been associated with more than three businesses.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WITH c, count(b) AS numBusinesses
WHERE numBusinesses > 3
RETURN c.name
LIMIT 5",Verbose query,grandstack,False,False,True,
Which users have written more than one review?,"MATCH (u:User)-[:WROTE]->(r:Review)
WITH u, count(r) AS reviewsCount
WHERE reviewsCount > 1
RETURN u.name AS UserName, reviewsCount",Verbose query,grandstack,False,False,True,
Retrieve the names of the first 3 businesses that are located within a 5-mile radius of POINT(-113.995297 46.877981).,"MATCH (b:Business)
WHERE distance(b.location, point({longitude: -113.995297, latitude: 46.877981})) <= 8046.72
RETURN b.name
LIMIT 3",Verbose query,grandstack,False,False,False,
Which business located in 'Missoula' has the highest rating based on reviews?,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]-(r:Review)
RETURN b.name, avg(r.stars) AS average_rating
ORDER BY average_rating DESC
LIMIT 1",Verbose query,grandstack,False,False,True,
List all the reviews with a text containing 'car wash'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'car wash'
RETURN u, r, b",Verbose query,grandstack,False,False,True,
Find the first 5 businesses that have a category of 'Brewery'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Brewery'})
RETURN b
LIMIT 5",Verbose query,grandstack,False,False,True,
Which businesses in 'San Mateo' have been reviewed in August 2016?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.city = 'San Mateo' AND date(r.date) >= date('2016-08-01') AND date(r.date) <= date('2016-08-31')
RETURN b.name, b.address, r.reviewId, r.stars",Verbose query,grandstack,False,False,True,
Which users wrote reviews for businesses located at '111 E 5th Ave'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {address: '111 E 5th Ave'})
RETURN u.name AS UserName",Verbose query,grandstack,False,False,True,
What are the addresses of the first 3 businesses named 'Neo4j'?,"MATCH (b:Business {name: 'Neo4j'})
RETURN b.address
LIMIT 3",Verbose query,grandstack,False,False,True,
Retrieve the top 5 reviews with a rating of 4 stars or higher.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars >= 4
RETURN r, u.name AS reviewer, b.name AS business
ORDER BY r.stars DESC, r.date DESC
LIMIT 5",Verbose query,grandstack,False,False,True,
Which businesses have received a review that mentioned 'great selection'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'great selection'
RETURN b.name, b.address, b.city, b.state",Verbose query,grandstack,False,False,True,
List all reviews written by the user named 'Angie'.,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)
RETURN r",Verbose query,grandstack,False,False,True,
Which users have written a review for 'KettleHouse Brewing Co.'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {name: 'KettleHouse Brewing Co.'})
RETURN u.name AS UserName",Verbose query,grandstack,False,False,True,
What are the names of the first 3 businesses categorized as a 'Library'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
RETURN b.name
LIMIT 3",Verbose query,grandstack,False,False,True,
Find the first 5 users who wrote a review with a rating of 5 stars.,"MATCH (u:User)-[:WROTE]->(r:Review {stars: 5})
RETURN u
LIMIT 5",Verbose query,grandstack,False,False,True,
Identify the top 3 businesses by name that are in the city of San Mateo.,"MATCH (b:Business {city: 'San Mateo'})
RETURN b.name
ORDER BY b.businessId
LIMIT 3",Verbose query,grandstack,False,False,True,
Which businesses in Burlingame have an address on California Dr?,"MATCH (b:Business {city: 'Burlingame', address: '723 California Dr'})
RETURN b",Verbose query,grandstack,False,False,True,
List all businesses located in Missoula.,"MATCH (b:Business {city: 'Missoula'})
RETURN b",Verbose query,grandstack,False,False,False,
Find the top 5 businesses with the highest average ratings and their addresses.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WITH b, avg(r.stars) AS averageRating
ORDER BY averageRating DESC
LIMIT 5
RETURN b.name AS BusinessName, b.address AS Address, averageRating",Complex Aggregation Queries,grandstack,False,False,True,
List the cities and states for the businesses that have a name starting with 'Z'.,"MATCH (b:Business)
WHERE b.name STARTS WITH 'Z'
RETURN b.city, b.state",Verbose query,grandstack,False,False,True,
List the users who have reviewed 'Ducky's Car Wash'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {name: ""Ducky's Car Wash""})
RETURN u.name AS UserName",Complex Aggregation Queries,grandstack,False,False,True,
Retrieve the names of businesses that have been categorized under both 'Brewery' and 'Restaurant'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE c.name = 'Brewery'
WITH b
MATCH (b)-[:IN_CATEGORY]->(c2:Category)
WHERE c2.name = 'Restaurant'
RETURN b.name",Verbose query,grandstack,False,False,False,
Which businesses have received reviews with a text mentioning 'books'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'books'
RETURN b",Verbose query,grandstack,False,False,False,
Which businesses in 'Burlingame' have received reviews with a star rating of 3.5 or higher?,"MATCH (b:Business {city: 'Burlingame'})-[:REVIEWS]-(r:Review)
WHERE r.stars >= 3.5
RETURN b.name, b.address, r.stars",Verbose query,grandstack,False,False,True,
List the first 5 businesses that have received a review mentioning 'service'.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'service'
RETURN b
LIMIT 5",Verbose query,grandstack,False,False,False,
Retrieve the names of the first 3 businesses that have been reviewed in December 2017.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2017-12-01') AND r.date <= date('2017-12-31')
RETURN b.name
LIMIT 3",Verbose query,grandstack,False,False,False,
Which businesses located on '1st St' have received a review with a star rating of 4.0 or higher?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.address CONTAINS '1st St' AND r.stars >= 4.0
RETURN b.name, b.address, r.reviewId, r.stars",Verbose query,grandstack,False,False,True,
List the first 5 reviews with a text mentioning 'sandwich'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'sandwich'
RETURN r, u, b
LIMIT 5",Verbose query,grandstack,False,False,True,
Find the first 3 businesses that have been reviewed with a mention of 'library'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: ""Library""})
WHERE EXISTS {
    (b)<-[:REVIEWS]-(:Review)-[:WROTE]->(:User)
}
RETURN b
LIMIT 3",Verbose query,grandstack,False,False,True,
Which businesses have been reviewed by all users?,"MATCH (u:User)
WITH collect(u) AS allUsers
MATCH (b:Business)
WHERE all(allUser IN allUsers WHERE exists {
    (allUser)-[:WROTE]->(:Review)-[:REVIEWS]->(b)
})
RETURN b",Verbose query,grandstack,False,False,False,
List the user names and review texts for reviews written in January 2016.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date('2016-01-01') AND r.date <= date('2016-01-31')
RETURN u.name AS UserName, r.text AS ReviewText",Verbose query,grandstack,False,False,False,
Which business in 'San Mateo' has been reviewed most frequently?,"MATCH (b:Business {city: 'San Mateo'})-[:REVIEWS]-(r:Review)
RETURN b.name, count(r) AS reviews_count
ORDER BY reviews_count DESC
LIMIT 1",Verbose query,grandstack,True,False,False,
What are the names of the first 3 businesses located in 'MT'?,"MATCH (b:Business {state: 'MT'})
RETURN b.name
LIMIT 3",Verbose query,grandstack,False,False,True,
List the first 5 businesses that have not been reviewed yet.,"MATCH (b:Business)
WHERE NOT exists{(b)<-[:REVIEWS]-(:Review)}
RETURN b
LIMIT 5",Verbose query,grandstack,False,False,True,
List all reviews written in 2017 for businesses located on 'Broadway St'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.address CONTAINS 'Broadway St' AND r.date >= date('2017-01-01') AND r.date <= date('2017-12-31')
RETURN u, r, b",Verbose query,grandstack,False,False,False,
Which businesses have a location point closest to POINT(-113.990976 46.870035)?,"MATCH (b:Business)
RETURN b, distance(b.location, point({longitude: -113.990976, latitude: 46.870035})) AS dist
ORDER BY dist ASC
LIMIT 1",Verbose query,grandstack,False,False,True,
Retrieve the top 5 businesses that have been reviewed by users named 'Jenny'.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b
ORDER BY r.date DESC
LIMIT 5",Verbose query,grandstack,False,False,False,
Which users wrote reviews for businesses located on 'Main St'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.address CONTAINS 'Main St'
RETURN DISTINCT u.name",Verbose query,grandstack,False,False,True,
List the business names and address for the top 3 businesses with the most reviews.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WITH b, count(r) AS reviewsCount
ORDER BY reviewsCount DESC
LIMIT 3
RETURN b.name AS BusinessName, b.address AS Address",Verbose query,grandstack,False,False,True,
Find the first 3 reviews with the lowest star ratings.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r, u, b
ORDER BY r.stars ASC
LIMIT 3",Verbose query,grandstack,False,False,True,
Which businesses have received reviews with texts containing the word 'IPA'?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.text CONTAINS 'IPA'
RETURN b",Verbose query,grandstack,False,False,True,
What are the names of the businesses that are located at '200 W Pine St'?,"MATCH (b:Business {address: '200 W Pine St'})
RETURN b.name",Verbose query,grandstack,False,False,True,
List the first 5 users who have written a review for a business in the category 'Car Wash'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Car Wash'})
RETURN u.name AS UserName
LIMIT 5",Verbose query,grandstack,False,False,True,
Retrieve the names and locations of the first 3 businesses that have received at least one review with a star rating of 5.0.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.stars = 5.0
RETURN b.name, b.location
LIMIT 3",Verbose query,grandstack,False,False,True,
Which users have written a review for businesses located in 'CA'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.state = 'CA'
RETURN DISTINCT u.name",Verbose query,grandstack,False,False,True,
List the business names and user names for reviews written in September 2015.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date('2015-09-01') AND r.date <= date('2015-09-30')
RETURN b.name AS BusinessName, u.name AS UserName",Verbose query,grandstack,False,False,True,
Find the first 5 businesses located on 'Pine St' in any city.,"MATCH (b:Business)
WHERE b.address CONTAINS 'Pine St'
RETURN b
LIMIT 5",Verbose query,grandstack,False,False,True,
List all reviews with a star rating above 4.5.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars > 4.5
RETURN u.name AS UserName, r.text AS ReviewText, r.stars AS StarRating, b.name AS BusinessName",Verbose query,grandstack,False,False,True,
Which users have written reviews for businesses in 'Burlingame'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Burlingame'})
RETURN DISTINCT u.name AS UserName",Complex Retrieval Queries,grandstack,False,False,False,
Which business has the most reviews in 'Missoula'?,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]-(r:Review)
RETURN b.name, count(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 1",Complex Aggregation Queries,grandstack,False,False,False,
Find all businesses and their categories in the state of 'CA'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.state = 'CA'
RETURN b, c",Complex Aggregation Queries,grandstack,False,False,False,
Which businesses on '1st St W' have been reviewed by 'Will' and what are the review texts?,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.address CONTAINS '1st St W'
RETURN b.name AS BusinessName, r.text AS ReviewText",Pathfinding Queries,grandstack,False,False,False,
List all businesses in 'CA' that have been reviewed in '2017' and their corresponding categories.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.state = 'CA' AND 
      EXISTS {
        (b)<-[:REVIEWS]-(r:Review)
        WHERE r.date >= date('2017-01-01') AND r.date <= date('2017-12-31')
      }
RETURN b, c",Pathfinding Queries,grandstack,False,False,True,
What are the names of businesses in 'Missoula' that are categorized as 'Breweries' and their review texts?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Breweries'})
WHERE b.city = 'Missoula'
MATCH (r:Review)-[:REVIEWS]->(b)
RETURN b.name AS BusinessName, r.text AS ReviewText",Pathfinding Queries,grandstack,False,False,True,
Find the businesses in 'San Mateo' that have been reviewed by 'Angie' and list the review dates.,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'San Mateo'})
RETURN b.name AS BusinessName, r.date AS ReviewDate",Pathfinding Queries,grandstack,False,False,False,
Which businesses in 'Burlingame' have been reviewed in '2015' and what are the review texts?,"MATCH (b:Business {city: 'Burlingame'})-[:REVIEWS]-(r:Review)-[:WROTE]-(u:User)
WHERE r.date.year = 2015
RETURN b.name AS BusinessName, r.text AS ReviewText",Pathfinding Queries,grandstack,True,False,False,
List the names and categories of businesses on 'Broadway St' that have received a 5-star review.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address CONTAINS 'Broadway St'
AND exists {
  (b)<-[:REVIEWS]-(r:Review)
  WHERE r.stars = 5.0
}
RETURN b.name, c.name",Pathfinding Queries,grandstack,False,False,False,
What are the names of businesses in 'Missoula' that have been reviewed by users named 'Jenny' and 'Bob'?,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]-(r:Review)-[:WROTE]-(u:User)
WHERE u.name IN ['Jenny', 'Bob']
RETURN DISTINCT b.name",Pathfinding Queries,grandstack,False,False,False,
Identify the businesses on 'Pine St' that have been reviewed in '2017' and list the reviewers' names.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)-[:WROTE]->(u:User)
WHERE b.address CONTAINS 'Pine St' AND r.date.year = 2017
RETURN b.name AS BusinessName, u.name AS ReviewerName",Pathfinding Queries,grandstack,False,False,False,
Which businesses in 'San Mateo' have been reviewed more than twice and what are the review stars?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.city = 'San Mateo'
WITH b, count(r) AS reviewsCount
WHERE reviewsCount > 2
RETURN b.name, b.businessId, collect(r.stars) AS reviewStars",Pathfinding Queries,grandstack,True,False,False,
List the businesses on 'Main St' that have been reviewed by 'Angie' and the corresponding review texts.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category), (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b)
WHERE b.address CONTAINS 'Main St'
RETURN b.name, r.text",Pathfinding Queries,grandstack,False,False,False,
What are the names of businesses in 'Burlingame' with reviews dated in '2016' and the names of the reviewers?,"MATCH (b:Business {city: 'Burlingame'})-[:REVIEWS]->(r:Review)-[:WROTE]->(u:User)
WHERE r.date.year = 2016
RETURN b.name AS BusinessName, u.name AS ReviewerName",Pathfinding Queries,grandstack,False,False,True,
Identify businesses in 'Burlingame' with reviews mentioning 'awesome' and list the reviewers.,"MATCH (b:Business {city: 'Burlingame'})-[:REVIEWS]-(r:Review)-[:WROTE]-(u:User)
WHERE toLower(r.text) CONTAINS 'awesome'
RETURN b.name AS BusinessName, u.name AS ReviewerName",Pathfinding Queries,grandstack,False,False,True,
Find the top 3 longest reviews for businesses in 'Missoula' and the corresponding businesses names.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Missoula'})
WITH r, b, length(r.text) AS reviewLength
ORDER BY reviewLength DESC
LIMIT 3
RETURN b.name AS BusinessName, r.text AS ReviewText, reviewLength",Pathfinding Queries,grandstack,False,False,True,
List all businesses that have been reviewed by 'Bob' in 'CA' and the corresponding stars of those reviews.,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {state: 'CA'})
RETURN b.name AS BusinessName, r.stars AS Stars",Pathfinding Queries,grandstack,True,False,False,
Identify the businesses in 'San Mateo' that have been reviewed by 'Will' and list the review texts.,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'San Mateo'})
RETURN b.name AS BusinessName, r.text AS ReviewText",Pathfinding Queries,grandstack,False,False,False,
What are the names of businesses on '5th Ave' and their corresponding reviewers?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)-[:WROTE]-(u:User)
WHERE b.address CONTAINS '5th Ave'
RETURN b.name AS BusinessName, u.name AS ReviewerName",Pathfinding Queries,grandstack,False,False,False,
Find businesses in 'Burlingame' that have been reviewed by 'Jenny' and list the categories of these businesses.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Burlingame'})
MATCH (b)-[:IN_CATEGORY]->(c:Category)
RETURN b.name, collect(c.name) AS categories",Pathfinding Queries,grandstack,False,False,False,
Which businesses in 'Missoula' have been reviewed by all listed users and what are the review texts?,"MATCH (b:Business {city: 'Missoula'})
WHERE exists {
  MATCH (u:User)
  WHERE all(u IN collect(u) WHERE exists {
    MATCH (u)-[:WROTE]->(r:Review)-[:REVIEWS]->(b)
  })
}
RETURN b.name, collect(r.text) AS reviewTexts",Pathfinding Queries,grandstack,False,False,False,
List the names and categories of businesses on 'California Dr' that have received a 3-star review.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address CONTAINS 'California Dr'
AND exists {
  (b)<-[:REVIEWS]-(r:Review)
  WHERE r.stars = 3.0
}
RETURN b.name, c.name",Pathfinding Queries,grandstack,False,False,False,
Which business has reviews with the text mentioning 'car wash' and what are the review dates?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.text CONTAINS 'car wash'
RETURN b.name, r.date",Pathfinding Queries,grandstack,False,False,False,
List the names of businesses in 'San Mateo' that have been reviewed in '2018' and their review texts.,"MATCH (b:Business {city: 'San Mateo'})-[:REVIEWS]->(r:Review)
WHERE r.date.year = 2018
RETURN b.name AS BusinessName, r.text AS ReviewText",Pathfinding Queries,grandstack,False,False,False,
Identify all businesses on 'Front St' with reviews from 'Jenny' and list the review dates.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)-[:WROTE]-(u:User {name: 'Jenny'})
WHERE b.address CONTAINS 'Front St'
RETURN b.name, b.address, r.date AS review_date",Pathfinding Queries,grandstack,False,False,True,
Which businesses in 'CA' have been reviewed by 'Bob' and list the review stars.,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {state: 'CA'})
RETURN b.name AS BusinessName, r.stars AS ReviewStars",Pathfinding Queries,grandstack,False,False,True,
What are the names of businesses with reviews mentioning 'breakfast' and their corresponding categories?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)-[:WROTE]->(u:User), (b)-[:IN_CATEGORY]->(c:Category)
WHERE r.text CONTAINS 'breakfast'
RETURN b.name AS BusinessName, c.name AS CategoryName",Pathfinding Queries,grandstack,False,False,False,
Which business on 'Broadway St' has the lowest average review star rating and what are the review texts?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.address CONTAINS 'Broadway St'
WITH b, avg(r.stars) AS avgStars, collect(r.text) AS reviewTexts
ORDER BY avgStars ASC
RETURN b.name, b.address, avgStars, reviewTexts
LIMIT 1",Pathfinding Queries,grandstack,False,False,True,
What are the recent 3 reviews for 'Neo4j'?,"MATCH (b:Business {name: 'Neo4j'})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN r.date, r.text, r.stars, u.name
ORDER BY r.date DESC
LIMIT 3",Complex Aggregation Queries,grandstack,False,False,True,
What are the names of businesses on 'California Dr' that have been reviewed in '2016' and their review texts?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.address CONTAINS 'California Dr' AND r.date.year = 2016
RETURN b.name, r.text",Pathfinding Queries,grandstack,False,False,True,
Which business in 'Missoula' has the most diverse range of review stars and what are the review texts?,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]->(r:Review)
WITH b, collect(DISTINCT r.stars) AS uniqueStars, collect(r.text) AS reviewTexts
ORDER BY size(uniqueStars) DESC
RETURN b.name AS BusinessName, uniqueStars, reviewTexts
LIMIT 1",Pathfinding Queries,grandstack,False,False,True,
What are the names of businesses that have been reviewed with a rating less than 4.0?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars < 4.0
RETURN DISTINCT b.name",Complex Aggregation Queries,grandstack,False,False,False,
List the top 3 businesses by the number of reviews they received.,"MATCH (b:Business)<-[:REVIEWS]-(:Review)
WITH b, count(*) AS reviewsCount
ORDER BY reviewsCount DESC
LIMIT 3
RETURN b.name, reviewsCount",Complex Aggregation Queries,grandstack,False,False,True,
Which users have reviewed businesses in 'Burlingame'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Burlingame'})
RETURN DISTINCT u.name AS UserName",Complex Aggregation Queries,grandstack,False,False,True,
What are the business names that have been reviewed by 'Jenny'?,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS BusinessName",Complex Aggregation Queries,grandstack,False,False,True,
Which businesses are located in California and have more than one review?,"MATCH (b:Business {state: 'CA'})
WHERE exists {
  (b)<-[:REVIEWS]-(:Review)
}
WITH b, count{(b)<-[:REVIEWS]-(:Review)} AS reviewCount
WHERE reviewCount > 1
RETURN b",Complex Aggregation Queries,grandstack,False,False,True,
What is the name of the business reviewed on '2018-09-10'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date = date('2018-09-10')
RETURN b.name",Complex Aggregation Queries,grandstack,False,False,True,
List all the reviews written by the user 'Bob'.,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)
RETURN r",Complex Aggregation Queries,grandstack,False,False,True,
What are the names of businesses located at '200 W Pine St' and '313 N 1st St W'?,"MATCH (b:Business)
WHERE b.address IN ['200 W Pine St', '313 N 1st St W']
RETURN b.name",Complex Aggregation Queries,grandstack,False,False,True,
Which businesses have the highest average review stars? Only list the top 5.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WITH b, AVG(r.stars) AS avg_stars
ORDER BY avg_stars DESC
LIMIT 5
RETURN b.name, avg_stars",Complex Aggregation Queries,grandstack,False,False,True,
Find the top 3 users who have written the most reviews.,"MATCH (u:User)-[:WROTE]->(r:Review)
RETURN u.name, count(r) AS reviews_count
ORDER BY reviews_count DESC
LIMIT 3",Complex Aggregation Queries,grandstack,False,False,True,
What are the addresses of the businesses categorized as 'Coffee'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Coffee'})
RETURN b.address",Complex Aggregation Queries,grandstack,False,False,True,
List the businesses in 'San Mateo' that have received reviews mentioning 'graph database' and the reviewers' names.,"MATCH (b:Business {city: 'San Mateo'})-[:REVIEWS]-(r:Review)-[:WROTE]-(u:User)
WHERE r.text CONTAINS 'graph database'
RETURN b.name AS BusinessName, u.name AS ReviewerName",Pathfinding Queries,grandstack,False,False,False,
Show the top 3 business names in San Mateo along with their categories.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'San Mateo'
RETURN b.name AS BusinessName, c.name AS Category
ORDER BY b.name
LIMIT 3",Complex Aggregation Queries,grandstack,False,False,False,
List the names of the businesses that have a review with 5 stars.,"MATCH (b:Business)-[:REVIEWS]-(r:Review {stars: 5})
RETURN b.name",Complex Aggregation Queries,grandstack,False,False,False,
What are the names of the top 5 businesses located in Missoula?,"MATCH (b:Business {city: 'Missoula'})
RETURN b.name
ORDER BY b.name
LIMIT 5",Complex Aggregation Queries,grandstack,False,False,False,
Find the businesses in 'San Mateo' that have been reviewed by 'Jenny' and list the categories of these businesses.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'San Mateo'})
MATCH (b)-[:IN_CATEGORY]->(c:Category)
RETURN b.name, collect(c.name) AS categories",Pathfinding Queries,grandstack,False,False,True,
Which businesses in 'Burlingame' have reviews mentioning 'love' and list the review dates.,"MATCH (b:Business {city: 'Burlingame'})-[:IN_CATEGORY]->(c:Category)
MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b)
WHERE r.text CONTAINS 'love'
RETURN b.name, r.date AS ReviewDate",Pathfinding Queries,grandstack,False,False,False,
What are the names of businesses on '5th Ave' and their corresponding review stars?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.address CONTAINS '5th Ave'
RETURN b.name AS BusinessName, r.stars AS ReviewStars",Pathfinding Queries,grandstack,False,False,True,
List the businesses in 'CA' that have been reviewed in '2018' and their corresponding categories.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.state = 'CA' AND EXISTS {
    MATCH (b)<-[:REVIEWS]-(r:Review)
    WHERE r.date.year = 2018
}
RETURN b, c",Pathfinding Queries,grandstack,False,False,False,
Identify the business in 'Missoula' with the highest number of 5-star reviews and list the review texts.,"MATCH (b:Business {city: 'Missoula'})-[:IN_CATEGORY]->(:Category)
MATCH (r:Review {stars: 5.0})-[:REVIEWS]->(b)
WITH b, count(r) AS FiveStarReviews, collect(r.text) AS ReviewTexts
ORDER BY FiveStarReviews DESC
LIMIT 1
RETURN b.name AS BusinessName, FiveStarReviews, ReviewTexts",Pathfinding Queries,grandstack,False,False,True,
Which businesses in 'San Mateo' have been reviewed by more than one user and what are the review texts?,"MATCH (b:Business {city: 'San Mateo'})-[:REVIEWS]-(r:Review)-[:WROTE]-(u:User)
WITH b, r.text AS reviewText, COUNT(DISTINCT u) AS userCount
WHERE userCount > 1
RETURN b.name, COLLECT(reviewText) AS reviews",Pathfinding Queries,grandstack,False,False,True,
List the businesses on 'Broadway St' that have been reviewed by 'Angie' and the review dates.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category), (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b)
WHERE b.address CONTAINS 'Broadway St'
RETURN b.name AS BusinessName, b.address AS Address, r.date AS ReviewDate",Pathfinding Queries,grandstack,False,False,True,
What are the names of businesses in 'Burlingame' that have been reviewed by 'Will' and the corresponding review texts.,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Burlingame'})
RETURN b.name AS BusinessName, r.text AS ReviewText",Pathfinding Queries,grandstack,False,False,True,
Find the top 5 businesses in 'CA' based on the number of reviews they have received.,"MATCH (b:Business {state: 'CA'})-[:REVIEWS]-(r:Review)
WITH b, count(r) AS reviewsCount
ORDER BY reviewsCount DESC
LIMIT 5
RETURN b.name, b.address, reviewsCount",Pathfinding Queries,grandstack,False,False,True,
Which users have written a review for 'KettleHouse Brewing Co.'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {name: 'KettleHouse Brewing Co.'})
RETURN u.name AS UserName",Complex Aggregation Queries,grandstack,False,False,True,
Find the businesses with addresses starting with '301' and list their categories.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address STARTS WITH '301'
RETURN b.name, b.address, c.name",Complex Retrieval Queries,grandstack,False,False,False,
Which businesses located in 'MT' are categorized under 'Brewery'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Brewery'})
WHERE b.state = 'MT'
RETURN b",Complex Retrieval Queries,grandstack,False,False,False,
List the review dates for businesses named 'Neo4j'.,"MATCH (b:Business {name: 'Neo4j'})-[:REVIEWS]-(r:Review)
RETURN r.date AS ReviewDate",Complex Retrieval Queries,grandstack,False,False,False,
Which 3 businesses have reviews that mention both 'world' and 'leading'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'world' AND r.text CONTAINS 'leading'
RETURN b.name, collect(r.reviewId) AS reviewIds
LIMIT 3",Verbose query,grandstack,False,False,False,
List the top 3 businesses with reviews from the latest three different users.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WITH b, collect(DISTINCT u.userId) AS uniqueUserIds
WHERE size(uniqueUserIds) >= 3
RETURN b.name, b.businessId, b.address, b.city, b.state
ORDER BY size(uniqueUserIds) DESC
LIMIT 3",Verbose query,grandstack,False,False,False,
What are the top 3 businesses with reviews that have a star rating of exactly 4.5?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.stars = 4.5
RETURN b.name, count(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3",Verbose query,grandstack,False,False,True,
Can you display the top 5 businesses that have reviews with 'awesome' in their text?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'awesome'
RETURN b.name, count(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 5",Verbose query,grandstack,False,False,True,
Show the first 3 businesses that have reviews mentioning 'Ninja Mike's'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)-[:WROTE]->(u:User)
WHERE r.text CONTAINS ""Ninja Mike's""
RETURN b
LIMIT 3",Verbose query,grandstack,False,False,True,
Find the top 3 businesses with reviews mentioning 'IPA' and having a star rating greater than 4.5.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'IPA' AND r.stars > 4.5
RETURN b.name, b.address, b.city, b.state, count(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3",Verbose query,grandstack,False,False,False,
Which 3 businesses have reviews mentioning 'full-service'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'full-service'
RETURN b.name, b.businessId
LIMIT 3",Verbose query,grandstack,False,False,False,
List the top 3 businesses that have been reviewed by users from California.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.state = 'CA'
RETURN b.name, count(r) AS reviews_count
ORDER BY reviews_count DESC
LIMIT 3",Verbose query,grandstack,False,False,False,
What are the top 3 businesses with reviews mentioning 'breakfast' and located in 'Missoula'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.city = 'Missoula' AND r.text CONTAINS 'breakfast'
RETURN b.name, count(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3",Verbose query,grandstack,False,False,True,
Can you find the top 3 businesses with reviews mentioning 'beer'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'beer'
RETURN b.name, count(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3",Verbose query,grandstack,False,False,False,
Show the top 5 reviews that mention 'best'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'best'
RETURN u.name AS UserName, r.text AS ReviewText, r.stars AS Stars, b.name AS BusinessName
ORDER BY r.stars DESC
LIMIT 5",Verbose query,grandstack,False,False,False,
Find the top 3 businesses that have reviews from the earliest three different dates.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, r.date AS review_date
ORDER BY review_date
WITH b, collect(DISTINCT review_date)[..3] AS first_three_dates
WHERE size(first_three_dates) = 3
RETURN b.name, first_three_dates
ORDER BY first_three_dates[0]
LIMIT 3",Verbose query,grandstack,False,False,False,
Find the top 3 reviews for businesses located at '313 N 1st St W'.,"MATCH (b:Business {address: '313 N 1st St W'})-[:REVIEWS]-(r:Review)
RETURN r
ORDER BY r.stars DESC
LIMIT 3",Verbose query,grandstack,False,False,False,
List the top 3 businesses with reviews mentioning 'farmer's market'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS ""farmer's market""
RETURN b.name, count(r) AS reviewsCount
ORDER BY reviewsCount DESC
LIMIT 3",Verbose query,grandstack,False,False,True,
What are the top 3 businesses with reviews mentioning 'car'?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.text CONTAINS 'car'
RETURN b.name, count(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3",Verbose query,grandstack,False,False,True,
Can you display the top 5 businesses with reviews that mention 'love'?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.text CONTAINS 'love'
RETURN b.name, count(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 5",Verbose query,grandstack,False,False,False,
Show the first 3 businesses that have reviews mentioning 'sandwich'.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.text CONTAINS 'sandwich'
RETURN b
LIMIT 3",Verbose query,grandstack,True,False,False,
Find the top 3 businesses that have received reviews only from users named 'Will'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User {name: 'Will'})
WITH b, count(r) AS reviewsCount
WHERE NOT exists {
    MATCH (b)<-[:REVIEWS]-(r2:Review)<-[:WROTE]-(u2:User)
    WHERE u2.name <> 'Will'
}
RETURN b.name, reviewsCount
ORDER BY reviewsCount DESC
LIMIT 3",Verbose query,grandstack,False,False,True,
Which 3 reviews mention both 'great' and 'selection' in their text?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'great' AND r.text CONTAINS 'selection'
RETURN r, u.name, b.name
LIMIT 3",Verbose query,grandstack,False,False,True,
List the top 3 businesses with reviews that have a star rating of 5 and mention 'awesome'.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.stars = 5 AND r.text CONTAINS 'awesome'
RETURN b.name, b.address, b.city, b.state, count(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3",Verbose query,grandstack,False,False,True,
What are the first 3 businesses with reviews that have a text length greater than 50 characters?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE length(r.text) > 50
RETURN b
LIMIT 3",Verbose query,grandstack,False,False,True,
Can you find the top 3 businesses that have been reviewed by 'Jenny' and 'Bob'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE u.name IN ['Jenny', 'Bob']
WITH b, COUNT(r) AS reviewsCount
ORDER BY reviewsCount DESC
LIMIT 3
RETURN b.name, reviewsCount",Verbose query,grandstack,False,False,True,
Show the top 5 reviews for businesses with addresses on '1st St'.,"MATCH (r:Review)-[:REVIEWS]->(b:Business)
WHERE b.address CONTAINS '1st St'
RETURN r
ORDER BY r.stars DESC
LIMIT 5",Verbose query,grandstack,False,False,False,
Find the top 3 businesses with the most reviews in 'Missoula'.,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]-(r:Review)
WITH b, count(r) AS reviewsCount
ORDER BY reviewsCount DESC
LIMIT 3
RETURN b.name, reviewsCount",Verbose query,grandstack,False,False,False,
Which 3 businesses have reviews that mention 'books'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'books'
RETURN b.name, b.businessId
LIMIT 3",Verbose query,grandstack,False,False,True,
Which 3 businesses have reviews that mention 'Ducky's'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS ""Ducky's""
RETURN b.name, b.businessId
LIMIT 3",Verbose query,grandstack,False,False,True,
Show the first 3 businesses that have reviews mentioning 'sandwich' and 'farmer's market'.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'sandwich' AND r.text CONTAINS ""farmer's market""
RETURN b
LIMIT 3",Verbose query,grandstack,False,False,True,
What are the top 3 businesses with the most recent reviews mentioning 'car wash'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE c.name CONTAINS 'car wash'
MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b)
WITH b, r
ORDER BY r.date DESC
RETURN b.name, collect(r)[..3] AS recent_reviews
LIMIT 3",Verbose query,grandstack,False,False,True,
List the top 5 reviews with a star rating above 4.5.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars > 4.5
RETURN r.reviewId, r.text, r.stars, b.name, b.businessId
ORDER BY r.stars DESC
LIMIT 5",Simple Retrieval Queries,grandstack,False,False,True,
What are the names of 3 businesses located on 'E Main St' or 'W Broadway St'?,"MATCH (b:Business)
WHERE b.address IN ['301 E Main St', '1151 W Broadway St', '121 W Broadway St']
RETURN b.name",Simple Retrieval Queries,grandstack,False,False,False,
Show the first 3 reviews with text containing 'great selection'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'great selection'
RETURN u, r, b
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
List the names of 5 businesses that have a review with at least 4.0 stars.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.stars >= 4.0
RETURN b.name
LIMIT 5",Simple Retrieval Queries,grandstack,False,False,False,
Which 3 users have written a review on 'Neo4j'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {name: 'Neo4j'})
RETURN u.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
Show the first 3 review texts for businesses in 'Missoula'.,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]->(r:Review)
RETURN r.text AS ReviewText
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
What are the top 3 categories available for businesses?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
RETURN c.name, count(b) AS num_businesses
ORDER BY num_businesses DESC
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
List the addresses of 5 businesses that have reviews.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
RETURN DISTINCT b.address
LIMIT 5",Simple Retrieval Queries,grandstack,False,False,True,
Which 3 businesses are located in the state 'CA'?,"MATCH (b:Business {state: 'CA'})
RETURN b
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
Show the first 3 reviews written by 'Jenny'.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r, b
ORDER BY r.date ASC
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
What are the names of 3 businesses categorized as 'Beer'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Beer'})
RETURN b.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
Can you show the top 5 businesses with reviews mentioning 'book'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'book'
RETURN b.name, count(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 5",Verbose query,grandstack,False,False,True,
List the top 5 business names in 'Burlingame'.,"MATCH (b:Business {city: 'Burlingame'})
RETURN b.name
ORDER BY b.name
LIMIT 5",Simple Retrieval Queries,grandstack,False,False,False,
Which 3 users wrote reviews?,"MATCH (u:User)-[:WROTE]->(:Review)
RETURN DISTINCT u.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
Show the names of 3 businesses located on '200 W Pine St'.,"MATCH (b:Business {address: '200 W Pine St'})
RETURN b.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
List the first 5 businesses in 'San Mateo'.,"MATCH (b:Business {city: 'San Mateo'})
RETURN b
LIMIT 5",Simple Retrieval Queries,grandstack,False,False,True,
What are the top 3 businesses in 'Missoula'?,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]->(r:Review)
RETURN b.name, avg(r.stars) AS average_rating
ORDER BY average_rating DESC
LIMIT 3",Simple Retrieval Queries,grandstack,True,False,False,
List the first 3 businesses that have reviews from 'Burlingame' with a star rating above 4.5.,"MATCH (b:Business {city: 'Burlingame'})-[:REVIEWS]-(r:Review)
WHERE r.stars > 4.5
RETURN b
LIMIT 3",Verbose query,grandstack,False,False,False,
What are the top 3 businesses that have been reviewed on '2017-11-13'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date = date('2017-11-13')
RETURN b.name, count(r) AS reviewsCount
ORDER BY reviewsCount DESC
LIMIT 3",Verbose query,grandstack,False,False,False,
Can you find the top 3 businesses with reviews from users named 'Jenny' and 'Will'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE u.name IN ['Jenny', 'Will']
WITH b, count(r) AS reviewsCount
ORDER BY reviewsCount DESC
LIMIT 3
RETURN b.name, reviewsCount",Verbose query,grandstack,False,False,True,
Show the top 5 businesses with reviews that have a star rating greater than 4 and mention 'awesome'.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.stars > 4 AND r.text CONTAINS 'awesome'
RETURN b.name, b.address, b.city, b.state, collect(r.reviewId) AS reviewIds
ORDER BY r.stars DESC
LIMIT 5",Verbose query,grandstack,False,False,True,
Find the top 3 businesses that have reviews mentioning 'library'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: ""Library""})
WHERE exists {
  (b)<-[:REVIEWS]-(:Review)-[:WROTE]->(:User)
}
RETURN b
ORDER BY b.name
LIMIT 3",Verbose query,grandstack,False,False,True,
Which 3 businesses have reviews written by users named 'Angie' in 2017?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date.year = 2017
RETURN b.name, b.businessId
LIMIT 3",Verbose query,grandstack,False,False,False,
List the top 3 businesses with reviews having the exact text 'Great IPA selection!'.,"MATCH (b:Business)-[:REVIEWS]-(r:Review {text: 'Great IPA selection!'})
RETURN b.name, b.address, b.city, b.state, b.businessId
ORDER BY b.businessId
LIMIT 3",Verbose query,grandstack,True,False,False,
Name the 3 businesses that have been reviewed with 5 stars.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars = 5
RETURN b.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
Which 3 businesses have the most reviews in 'Missoula'?,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]-(r:Review)
RETURN b.name, count(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
List the first 3 businesses that have reviews with text mentioning 'world's leading'.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.text CONTAINS ""world's leading""
RETURN b
LIMIT 3",Verbose query,grandstack,False,False,True,
Can you find the top 5 businesses that are the furthest from POINT(-113.995057 46.874029)?,"MATCH (b:Business)
RETURN b, distance(b.location, point({longitude: -113.995057, latitude: 46.874029})) AS dist
ORDER BY dist DESC
LIMIT 5",Verbose query,grandstack,False,False,True,
Can you display the top 5 businesses that have reviews with a text mentioning 'IPA'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'IPA'
RETURN b.name, count(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 5",Verbose query,grandstack,False,False,True,
Show the first 3 businesses with names starting with 'Z'.,"MATCH (b:Business)
WHERE b.name STARTS WITH 'Z'
RETURN b
LIMIT 3",Verbose query,grandstack,False,False,True,
What are the top 5 reviews written in the year 2016?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date.year = 2016
RETURN r.reviewId, r.text, r.stars, b.name, b.businessId
ORDER BY r.stars DESC
LIMIT 5",Verbose query,grandstack,False,False,True,
List the first 3 businesses that have a review with exactly 5 stars.,"MATCH (b:Business)-[:REVIEWS]-(r:Review {stars: 5.0})
RETURN b
LIMIT 3",Verbose query,grandstack,False,False,True,
What are the top 3 businesses by the number of categories they belong to?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WITH b, count(c) AS num_categories
ORDER BY num_categories DESC
LIMIT 3
RETURN b.name, num_categories",Verbose query,grandstack,False,False,True,
Which 3 businesses have the oldest reviews?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
RETURN b.name AS BusinessName, r.date AS ReviewDate
ORDER BY r.date ASC
LIMIT 3",Verbose query,grandstack,False,False,True,
Can you find the top 5 most recent reviews?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r, u, b
ORDER BY r.date DESC
LIMIT 5",Verbose query,grandstack,False,False,True,
Show the first 3 businesses with addresses on 'Broadway St'.,"MATCH (b:Business)
WHERE b.address CONTAINS 'Broadway St'
RETURN b
LIMIT 3",Verbose query,grandstack,False,False,True,
What are the top 3 businesses located in the state of MT?,"MATCH (b:Business {state: 'MT'})
RETURN b.name, b.businessId
ORDER BY b.businessId
LIMIT 3",Verbose query,grandstack,False,False,True,
List the top 5 businesses located in the state of CA.,"MATCH (b:Business {state: 'CA'})
RETURN b
ORDER BY b.name
LIMIT 5",Verbose query,grandstack,False,False,True,
Find the first 3 reviews that contain the text 'great selection'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'great selection'
RETURN u, r, b
LIMIT 3",Verbose query,grandstack,False,False,True,
Find the top 3 users who have written reviews for 'Imagine Nation Brewing'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {name: 'Imagine Nation Brewing'})
WITH u, count(r) AS reviewsCount
ORDER BY reviewsCount DESC
LIMIT 3
RETURN u.name, reviewsCount",Verbose query,grandstack,False,False,True,
Which 3 businesses have reviews dated after 2017?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date > date('2017-12-31')
RETURN b.name, b.businessId
ORDER BY r.date DESC
LIMIT 3",Verbose query,grandstack,False,False,True,
What are the first 3 reviews with a star rating above 4.5?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars > 4.5
RETURN r, u, b
ORDER BY r.date ASC
LIMIT 3",Verbose query,grandstack,False,False,True,
Can you display the top 5 businesses based on their addresses alphabetically?,"MATCH (b:Business)
RETURN b
ORDER BY b.address ASC
LIMIT 5",Verbose query,grandstack,False,False,True,
Show the first 3 reviews written by the user named 'Jenny'.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r, b
ORDER BY r.date ASC
LIMIT 3",Verbose query,grandstack,False,False,True,
Which 3 businesses have the most reviews written about them?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
RETURN b.name, count(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3",Verbose query,grandstack,False,False,True,
List the top 3 highest scoring reviews for 'Ninja Mike's'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {name: ""Ninja Mike's""})
RETURN r.reviewId, r.stars, r.text, u.name
ORDER BY r.stars DESC
LIMIT 3",Verbose query,grandstack,False,False,True,
What are the top 5 businesses in the 'Beer' category?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Beer'})
RETURN b.name, b.address, b.city, b.state
ORDER BY b.businessId
LIMIT 5",Verbose query,grandstack,False,False,True,
Identify the first 3 businesses in the 'Library' category.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
RETURN b
LIMIT 3",Verbose query,grandstack,False,False,True,
Which 3 users have written the most reviews?,"MATCH (u:User)-[:WROTE]->(r:Review)
RETURN u.name, count(r) AS reviews_count
ORDER BY reviews_count DESC
LIMIT 3",Verbose query,grandstack,False,False,True,
Can you retrieve the top 5 highest-rated reviews?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r.reviewId, r.stars, r.text, b.name, u.name
ORDER BY r.stars DESC
LIMIT 5",Verbose query,grandstack,True,False,False,
Find the first 3 businesses located in San Mateo.,"MATCH (b:Business {city: 'San Mateo'})
RETURN b
LIMIT 3",Verbose query,grandstack,False,False,True,
What are the top 3 businesses located in Burlingame?,"MATCH (b:Business {city: 'Burlingame'})
RETURN b
ORDER BY b.name
LIMIT 3",Verbose query,grandstack,False,False,True,
List the top 3 users by the number of reviews they have written.,"MATCH (u:User)-[:WROTE]->(r:Review)
RETURN u.name, count(r) AS reviews_count
ORDER BY reviews_count DESC
LIMIT 3",Verbose query,grandstack,False,False,False,
What are the top 3 businesses that have been reviewed in both 2016 and 2017?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date.year = 2016 OR r.date.year = 2017
WITH b, collect(DISTINCT r.date.year) AS yearsReviewed
WHERE ALL(year IN [2016, 2017] WHERE year IN yearsReviewed)
RETURN b
ORDER BY count(r) DESC
LIMIT 3",Verbose query,grandstack,False,False,True,
List the top 3 users who have written reviews for businesses in 'Missoula'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Missoula'})
WITH u, COUNT(r) AS reviewsCount
ORDER BY reviewsCount DESC
LIMIT 3
RETURN u.name AS UserName, reviewsCount",Verbose query,grandstack,False,False,False,
Show the first 3 reviews for businesses located at '301 E Main St'.,"MATCH (b:Business {address: '301 E Main St'})-[:REVIEWS]-(r:Review)
RETURN r
ORDER BY r.date ASC
LIMIT 3",Verbose query,grandstack,False,False,False,
Show the first 3 businesses that have reviews mentioning both 'great' and 'IPA'.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'great' AND r.text CONTAINS 'IPA'
RETURN b
LIMIT 3",Verbose query,grandstack,False,False,False,
Find the top 3 reviews for businesses located at '200 W Pine St'.,"MATCH (b:Business {address: '200 W Pine St'})-[:REVIEWS]-(r:Review)
RETURN r
ORDER BY r.stars DESC
LIMIT 3",Verbose query,grandstack,False,False,True,
Which 3 businesses have reviews that mention 'Ninja'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'Ninja'
RETURN b.name, b.businessId
LIMIT 3",Verbose query,grandstack,False,False,True,
List the top 3 businesses that are categorized under both 'Library' and 'Beer'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c1:Category {name: 'Library'}),
      (b)-[:IN_CATEGORY]->(c2:Category {name: 'Beer'})
RETURN b
LIMIT 3",Verbose query,grandstack,False,False,True,
What are the top 3 reviews that mention 'awesome'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'awesome'
RETURN r, u, b
ORDER BY r.stars DESC
LIMIT 3",Verbose query,grandstack,False,False,True,
Can you display the top 5 reviews that mention 'selection'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'selection'
RETURN r, u, b
ORDER BY r.stars DESC
LIMIT 5",Verbose query,grandstack,False,False,True,
Show the first 3 businesses with reviews from users whose name starts with 'W'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE u.name STARTS WITH 'W'
RETURN b
LIMIT 3",Verbose query,grandstack,False,False,True,
Find the top 3 businesses with reviews on or after '2017-01-01'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2017-01-01')
RETURN b.name, count(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3",Verbose query,grandstack,False,False,True,
Which 3 businesses have reviews that give them a star rating below 3.5?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars < 3.5
RETURN b.name, b.businessId, collect(r.reviewId) AS reviewIds
ORDER BY b.name
LIMIT 3",Verbose query,grandstack,True,False,False,
List the first 3 businesses with reviews from users named 'Angie'.,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b
LIMIT 3",Verbose query,grandstack,False,False,True,
What are the top 3 businesses with the most recent review dates?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WITH b, MAX(r.date) AS LatestReviewDate
ORDER BY LatestReviewDate DESC
LIMIT 3
RETURN b.name AS BusinessName, LatestReviewDate",Verbose query,grandstack,False,False,True,
Which 3 users have written reviews for businesses in 'San Mateo'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'San Mateo'})
RETURN DISTINCT u.name
LIMIT 3",Verbose query,grandstack,False,False,True,
Can you find the top 5 businesses located closest to the provided POINT(-114.009628 46.876672)?,"MATCH (b:Business)
RETURN b
ORDER BY distance(b.location, point({longitude: -114.009628, latitude: 46.876672}))
LIMIT 5",Verbose query,grandstack,False,False,True,
Find the top 5 users who have written reviews for businesses in 'CA'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {state: 'CA'})
WITH u, COUNT(r) AS reviewsCount
ORDER BY reviewsCount DESC
LIMIT 5
RETURN u.name, reviewsCount",Verbose query,grandstack,False,False,True,
Which 3 businesses have the lowest average review score?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WITH b, AVG(r.stars) AS avg_rating
ORDER BY avg_rating ASC
LIMIT 3
RETURN b.name, avg_rating",Verbose query,grandstack,False,False,True,
List the top 3 businesses with the highest average review score.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WITH b, AVG(r.stars) AS avg_stars
ORDER BY avg_stars DESC
LIMIT 3
RETURN b.name, avg_stars",Verbose query,grandstack,False,False,True,
What are the first 3 businesses that have been reviewed by more than one user?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
WITH b, count(DISTINCT u) AS userCount
WHERE userCount > 1
RETURN b
LIMIT 3",Verbose query,grandstack,False,False,True,
Can you list the top 3 businesses that have a user named 'Bob' writing a review for them?,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name, count(r) AS reviewsCount
ORDER BY reviewsCount DESC
LIMIT 3",Verbose query,grandstack,False,False,True,
Show the top 5 businesses with reviews written in September.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2018-09-01') AND r.date <= date('2018-09-30')
RETURN b.name, count(r) AS reviews_count
ORDER BY reviews_count DESC
LIMIT 5",Verbose query,grandstack,True,False,False,
Find the top 3 reviews that mention 'car wash'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'car wash'
RETURN r, u, b
ORDER BY r.stars DESC
LIMIT 3",Verbose query,grandstack,True,False,False,
Which 3 businesses have reviews mentioning 'breakfast'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'breakfast'
RETURN b.name, b.businessId
LIMIT 3",Verbose query,grandstack,False,False,True,
List the first 3 reviews for businesses in 'Burlingame'.,"MATCH (b:Business {city: 'Burlingame'})-[:REVIEWS]-(r:Review)
RETURN r
ORDER BY r.date ASC
LIMIT 3",Verbose query,grandstack,False,False,True,
What are the top 5 businesses with the shortest review texts?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
RETURN b.name, b.businessId, length(r.text) AS reviewLength
ORDER BY reviewLength ASC
LIMIT 5",Verbose query,grandstack,False,False,True,
Can you find the top 3 businesses with the longest reviews?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
RETURN b.name, b.businessId, length(r.text) AS reviewLength
ORDER BY reviewLength DESC
LIMIT 3",Verbose query,grandstack,False,False,True,
Show the first 3 reviews that resulted in an exact star rating of 4.0.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars = 4.0
RETURN u, r, b
ORDER BY r.date
LIMIT 3",Verbose query,grandstack,False,False,True,
List all the users who have written at least one review.,"MATCH (u:User)-[:WROTE]->(:Review)
RETURN DISTINCT u",Complex Aggregation Queries,grandstack,False,False,False,
Name the top 3 users based on the number of reviews written.,"MATCH (u:User)-[:WROTE]->(r:Review)
RETURN u.name, count(r) AS reviews_count
ORDER BY reviews_count DESC
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
What are the top 3 most recent reviews for businesses in 'CA'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.state = 'CA'
RETURN r, b.name, b.address, u.name
ORDER BY r.date DESC
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
Which 3 businesses have been reviewed by 'Will' in 'San Mateo'?,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'San Mateo'})
RETURN b.name AS BusinessName
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
List the names of 3 businesses with reviews on 'W Pine St'.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.address = '200 W Pine St'
RETURN b.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
Show the first 3 businesses in 'Burlingame' with reviews mentioning 'awesome'.,"MATCH (b:Business {city: 'Burlingame'})-[:REVIEWS]->(r:Review)
WHERE r.text CONTAINS 'awesome'
RETURN b
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
What are the names of the top 3 businesses in 'Missoula' based on the number of reviews?,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]->(r:Review)
WITH b, count(r) AS reviewsCount
ORDER BY reviewsCount DESC
LIMIT 3
RETURN b.name AS BusinessName, reviewsCount",Simple Retrieval Queries,grandstack,False,False,True,
List the names of 3 businesses reviewed by 'Angie' in 'CA'.,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {state: 'CA'})
RETURN b.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
Show the first 3 businesses with reviews mentioning 'IPA selection'.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.text CONTAINS 'IPA selection'
RETURN b
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
Which 3 businesses have reviews from 'Jenny' with a star rating above 4.5?,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars > 4.5
RETURN b.name, b.businessId, r.stars
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
List the first 3 businesses in 'Missoula' with a review date in 2018.,"MATCH (b:Business {city: 'Missoula'})-[:IN_CATEGORY]->(c:Category)
WHERE EXISTS {
    (b)<-[:REVIEWS]-(r:Review)
    WHERE r.date.year = 2018
}
RETURN b, c
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
What are the names of 3 businesses with the most reviews in 2017?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2017-01-01') AND r.date <= date('2017-12-31')
WITH b, count(r) AS reviewsCount
ORDER BY reviewsCount DESC
LIMIT 3
RETURN b.name AS BusinessName",Simple Retrieval Queries,grandstack,False,False,False,
Show the first 5 businesses in 'San Mateo' that have been reviewed.,"MATCH (b:Business {city: 'San Mateo'})-[:REVIEWS]-(r:Review)
WITH b, count(r) AS reviewsCount
WHERE reviewsCount > 0
RETURN b
LIMIT 5",Simple Retrieval Queries,grandstack,False,False,True,
List the names of 3 businesses in 'CA' with the highest star ratings in reviews.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.state = 'CA'
RETURN b.name, avg(r.stars) AS average_stars
ORDER BY average_stars DESC
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
Show the names of 3 businesses with reviews from 'Bob' with a star rating below 4.5.,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars < 4.5
RETURN b.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
Which 3 businesses have reviews mentioning 'sandwich' at 'Farmer's Market'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'sandwich' AND b.name CONTAINS ""Farmer's Market""
RETURN b
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
What are the names of 3 businesses in 'Missoula' with reviews mentioning 'selection'?,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'selection'
RETURN b.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
List the first 5 businesses that have been reviewed and are located in 'Burlingame'.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.city = 'Burlingame'
RETURN b
LIMIT 5",Simple Retrieval Queries,grandstack,False,False,True,
Show the first 3 businesses in 'CA' reviewed by 'Will'.,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {state: 'CA'})
RETURN b
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
List the names of 3 businesses with reviews mentioning 'not great'.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'not great'
RETURN b.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
Which 3 businesses have been reviewed by 'Bob' and are located in 'San Mateo'?,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'San Mateo'})
RETURN b.name, b.address
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
Show the first 3 reviews for businesses with a review date in 2016.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date('2016-01-01') AND r.date <= date('2016-12-31')
RETURN r, b
ORDER BY r.date ASC
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
What are the names of 3 businesses in 'CA' that have been reviewed by 'Jenny'?,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {state: 'CA'})
RETURN DISTINCT b.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
List the first 5 reviews for businesses on 'Broadway St'.,"MATCH (r:Review)-[:REVIEWS]->(b:Business)
WHERE b.address CONTAINS 'Broadway St'
RETURN r
ORDER BY r.date ASC
LIMIT 5",Simple Retrieval Queries,grandstack,False,False,False,
Show the names of 3 businesses with reviews containing the word 'world's leading'.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.text CONTAINS ""world's leading""
RETURN b.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
Which 3 businesses have reviews from 'Will' with a star rating of 5.0?,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review {stars: 5.0})-[:REVIEWS]->(b:Business)
RETURN b
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
List the first 5 businesses that have been categorized under 'Car Wash'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Car Wash'})
RETURN b
LIMIT 5",Simple Retrieval Queries,grandstack,False,False,False,
Show the first 3 reviews for businesses with addresses on 'E Main St'.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.address ENDS WITH 'E Main St'
RETURN r
ORDER BY r.date ASC
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
Show the first 3 businesses in 'Missoula' that have been reviewed by 'Angie'.,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Missoula'})
RETURN b
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
List the first 5 businesses with reviews mentioning 'car wash' in 'Burlingame'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category), (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'Burlingame' AND r.text CONTAINS 'car wash'
RETURN b.name, b.address, c.name, r.text, r.date
ORDER BY r.date DESC
LIMIT 5",Simple Retrieval Queries,grandstack,False,False,False,
Show the names of the first 3 businesses reviewed by 'Jenny' with texts mentioning 'great selection'.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'great selection'
RETURN b.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
Which businesses have a state code 'CA' and have received a review rating below 4 stars?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category), (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b)
WHERE b.state = 'CA' AND r.stars < 4
RETURN b.name, b.address, b.city, b.state, r.date, r.stars, r.text",Complex Retrieval Queries,grandstack,False,False,True,
Identify the business categories in 'San Mateo' with reviews written by Bob.,"MATCH (b:Business {city: 'San Mateo'})-[:IN_CATEGORY]->(c:Category)
WHERE exists {
  (b)<-[:REVIEWS]-(:Review)<-[:WROTE]-(u:User {name: 'Bob'})
}
RETURN DISTINCT c.name",Complex Retrieval Queries,grandstack,False,False,True,
List the businesses with addresses on 'Broadway St' and their corresponding review texts.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.address CONTAINS 'Broadway St'
RETURN b.name, b.address, r.text",Complex Retrieval Queries,grandstack,False,False,True,
Which businesses have reviews written in August 2016?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2016-08-01') AND r.date <= date('2016-08-31')
RETURN b",Complex Retrieval Queries,grandstack,False,False,True,
What are the names of businesses that have a point location latitude greater than 46.87?,"MATCH (b:Business)
WHERE b.location.latitude > 46.87
RETURN b.name",Complex Retrieval Queries,grandstack,False,False,True,
List all businesses reviewed by users with a userId 'u2'.,"MATCH (u:User {userId: 'u2'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b",Complex Retrieval Queries,grandstack,False,False,True,
Name the categories of businesses that are located on 'E Main St'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address = '301 E Main St'
RETURN DISTINCT c.name",Complex Retrieval Queries,grandstack,False,False,False,
Which businesses in 'Missoula' have a review with a rating of at least 4 stars?,"MATCH (b:Business {city: 'Missoula'})-[:IN_CATEGORY]->(c:Category)
MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b)
WHERE r.stars >= 4
RETURN b.name, b.address, c.name, r.stars",Complex Retrieval Queries,grandstack,False,False,False,
Find the businesses in 'CA' that have reviews with text containing 'graph database'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category), (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b)
WHERE b.state = 'CA' AND r.text CONTAINS 'graph database'
RETURN b, c, r, u",Complex Retrieval Queries,grandstack,False,False,False,
Name the businesses that have been reviewed on '2017-11-13'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date = date('2017-11-13')
RETURN b.name AS BusinessName",Complex Retrieval Queries,grandstack,False,False,False,
What are the categories of businesses that have a review with exactly 4.5 stars?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE exists {
    (b)<-[:REVIEWS]-(:Review {stars: 4.5})
}
RETURN DISTINCT c.name",Complex Retrieval Queries,grandstack,False,False,True,
What are the names of 3 businesses in 'CA' reviewed by 'Angie' with a star rating of 5.0?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review {stars: 5.0})-[:REVIEWS]->(b:Business {state: 'CA'})
RETURN b.name AS BusinessName
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
Which businesses are categorized under 'Library' and are located in 'CA'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
WHERE b.state = 'CA'
RETURN b",Complex Retrieval Queries,grandstack,False,False,True,
Identify businesses in 'Burlingame' that have a review text mentioning 'car wash'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Burlingame'
MATCH (r:Review)-[:REVIEWS]->(b)
WHERE r.text CONTAINS 'car wash'
RETURN b, c, r",Complex Retrieval Queries,grandstack,False,False,True,
Display the names of businesses with at least two reviews.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, count(r) AS reviewsCount
WHERE reviewsCount >= 2
RETURN b.name",Complex Retrieval Queries,grandstack,False,False,True,
Which users have written reviews for businesses located at '200 W Pine St'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {address: '200 W Pine St'})
RETURN u.name AS UserName",Complex Retrieval Queries,grandstack,False,False,True,
Name the businesses that have been reviewed in September 2018.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2018-09-01') AND r.date <= date('2018-09-30')
RETURN b.name AS BusinessName",Complex Retrieval Queries,grandstack,False,False,False,
What are the top 3 highest-rated reviews and which businesses do they correspond to?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r.reviewId, r.stars, b.name, b.businessId
ORDER BY r.stars DESC
LIMIT 3",Complex Retrieval Queries,grandstack,False,False,True,
List the businesses reviewed by Jenny.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b",Complex Retrieval Queries,grandstack,False,False,False,
Find the names of all users who wrote a review with 5 stars.,"MATCH (u:User)-[:WROTE]->(r:Review {stars: 5})
RETURN u.name",Complex Retrieval Queries,grandstack,False,False,True,
What are the names of businesses in San Mateo that are categorized as 'Coffee'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'San Mateo' AND c.name = 'Coffee'
RETURN b.name",Complex Retrieval Queries,grandstack,False,False,True,
Which businesses are located in Missoula and have a businessId starting with 'b3'?,"MATCH (b:Business)
WHERE b.city = 'Missoula' AND b.businessId STARTS WITH 'b3'
RETURN b",Complex Retrieval Queries,grandstack,False,False,True,
Which 3 businesses have reviews mentioning 'love'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'love'
RETURN b.name, collect(r.text) AS reviews
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
List the first 5 businesses in 'Missoula' that have been reviewed by 'Will'.,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Missoula'})
RETURN b
LIMIT 5",Simple Retrieval Queries,grandstack,False,False,False,
List the business names and locations that have been reviewed by users named Angie.,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS BusinessName, b.location AS Location",Complex Retrieval Queries,grandstack,False,False,True,
Show the business addresses for 'KettleHouse Brewing Co.' and 'Imagine Nation Brewing'.,"MATCH (b:Business)
WHERE b.name IN ['KettleHouse Brewing Co.', 'Imagine Nation Brewing']
RETURN b.address",Simple Retrieval Queries,grandstack,False,False,True,
What are the names of 3 businesses with reviews written on '2018-09-10'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.date = date('2018-09-10')
RETURN b.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
Show the first 5 businesses with reviews mentioning 'awesome'.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.text CONTAINS 'awesome'
RETURN b
LIMIT 5",Simple Retrieval Queries,grandstack,False,False,True,
List the first 5 reviews for businesses in 'Missoula' with a star rating of 5.0.,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]-(r:Review {stars: 5.0})
RETURN r
ORDER BY r.date ASC
LIMIT 5",Simple Retrieval Queries,grandstack,False,False,False,
Show the names of 3 businesses where 'Bob' wrote a review.,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS BusinessName
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
Which 3 businesses are categorized under 'Car Wash' in 'Missoula'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Car Wash'})
WHERE b.city = 'Missoula'
RETURN b
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
List the first 3 categories for businesses in 'San Mateo'.,"MATCH (b:Business {city: 'San Mateo'})-[:IN_CATEGORY]->(c:Category)
RETURN DISTINCT c.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
What are the names of businesses with addresses in 'Burlingame' and have been reviewed?,"MATCH (b:Business {city: 'Burlingame'})-[:REVIEWS]->(r:Review)
RETURN DISTINCT b.name",Simple Retrieval Queries,grandstack,False,False,True,
Show the first 3 reviews that mention 'IPA'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'IPA'
RETURN u, r, b
ORDER BY r.date ASC
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
List the first 5 businesses that Jenny reviewed.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b
ORDER BY r.date ASC
LIMIT 5",Simple Retrieval Queries,grandstack,False,False,True,
Which 3 users wrote the most recent reviews?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN u.name, r.date
ORDER BY r.date DESC
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
Show the first 3 reviews for businesses categorized under 'Beer'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Beer'})
MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b)
RETURN r, u, b
ORDER BY r.date ASC
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
What are the names of 3 businesses in 'Burlingame' with reviews?,"MATCH (b:Business {city: 'Burlingame'})-[:REVIEWS]->(r:Review)
RETURN DISTINCT b.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
List the first 5 business names with a review containing the word 'Love'.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'Love'
RETURN b.name
LIMIT 5",Simple Retrieval Queries,grandstack,False,False,True,
What are the names of 3 businesses in 'CA' with reviews mentioning 'great'?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.state = 'CA' AND r.text CONTAINS 'great'
RETURN DISTINCT b.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
Show the names of 3 businesses that have been reviewed in September 2018.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2018-09-01') AND r.date <= date('2018-09-30')
RETURN b.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
List the names of 3 businesses located at '313 N 1st St W' or '111 E 5th Ave'.,"MATCH (b:Business)
WHERE b.address IN ['313 N 1st St W', '111 E 5th Ave']
RETURN b.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
What are the first 3 business names that have been reviewed with a text mentioning 'breakfast'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'breakfast'
RETURN b.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
Show the top 5 reviews with the earliest review dates.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r.reviewId, r.date, r.text, r.stars, b.name, u.name
ORDER BY r.date ASC
LIMIT 5",Simple Retrieval Queries,grandstack,False,False,True,
List the first 3 businesses with a state property of 'MT'.,"MATCH (b:Business {state: 'MT'})
RETURN b
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
Which 3 businesses have been reviewed by 'Angie'?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS BusinessName
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
Show the names of businesses that have a 'Library' category in 'Missoula'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
WHERE b.city = 'Missoula'
RETURN b.name",Simple Retrieval Queries,grandstack,False,False,True,
What are the names of 3 businesses that have an address in 'San Mateo'?,"MATCH (b:Business {city: 'San Mateo'})
RETURN b.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
List the first 5 business names along 'California Dr'.,"MATCH (b:Business)
WHERE b.address CONTAINS 'California Dr'
RETURN b.name
LIMIT 5",Simple Retrieval Queries,grandstack,False,False,True,
Show the first 3 users who have written a review on 'Ducky's Car Wash'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {name: ""Ducky's Car Wash""})
RETURN u
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
Which 3 businesses have been reviewed on '2018-09-10'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date = date('2018-09-10')
RETURN b.name, b.businessId
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
List the names of businesses reviewed by 'Will' with more than 4 stars.,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars > 4
RETURN b.name",Simple Retrieval Queries,grandstack,False,False,True,
Which 3 users have reviewed businesses on 'E Front St'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.address = '201 E Front St'
RETURN DISTINCT u.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
List the first 3 reviews for businesses on 'California Dr'.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.address CONTAINS 'California Dr'
RETURN r
ORDER BY r.date ASC
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
Show the top 3 reviews for 'Zootown Brew'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {name: 'Zootown Brew'})
RETURN r.reviewId, r.date, r.stars, r.text, u.name
ORDER BY r.stars DESC, r.date DESC
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
List the names of 3 users who wrote a review in 2016.,"MATCH (u:User)-[:WROTE]->(r:Review)
WHERE r.date >= date('2016-01-01') AND r.date <= date('2016-12-31')
RETURN u.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
Which 3 businesses have been reviewed by users from 'MT'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.state = 'MT'
RETURN b.name, count(r) as reviewsCount
ORDER BY reviewsCount DESC
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
List the first 3 businesses in 'Missoula' with reviews mentioning 'great IPA'.,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'great IPA'
RETURN b
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
What are the names of 3 businesses in 'Burlingame' that have been reviewed by 'Bob'?,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Burlingame'})
RETURN b.name AS BusinessName
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
Show the first 3 businesses that have been reviewed and are located on 'W Broadway St'.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.address CONTAINS 'W Broadway St'
RETURN b
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
List the names of 3 businesses in 'CA' that have been reviewed.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.state = 'CA'
RETURN DISTINCT b.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
Which 3 businesses have the most recent reviews?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
RETURN b.name, b.businessId, MAX(r.date) AS MostRecentReviewDate
ORDER BY MostRecentReviewDate DESC
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
Show the first 3 businesses in 'San Mateo' categorized under 'Brewery'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Brewery'})
WHERE b.city = 'San Mateo'
RETURN b
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
What are the names of 3 businesses with reviews written by 'Angie'?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS BusinessName
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
List the first 5 reviews for businesses located on 'E Front St'.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.address = '201 E Front St'
RETURN r
ORDER BY r.date ASC
LIMIT 5",Simple Retrieval Queries,grandstack,False,False,True,
Show the names of 3 businesses in 'Missoula' reviewed by 'Will'.,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Missoula'})
RETURN b.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
Which 3 businesses have been reviewed by 'Bob' in 'Burlingame'?,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Burlingame'})
RETURN b.name AS BusinessName
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
Which 3 businesses have the address '723 California Dr'?,"MATCH (b:Business {address: '723 California Dr'})
RETURN b
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
List the names of 3 businesses located at '716 N San Mateo Dr'.,"MATCH (b:Business {address: '716 N San Mateo Dr'})
RETURN b.name",Simple Retrieval Queries,grandstack,False,False,True,
Show the first 3 businesses categorized under 'Public Library'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Public Library'})
RETURN b
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
List the first 5 reviews mentioning 'car wash'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'car wash'
RETURN r, u, b
LIMIT 5",Simple Retrieval Queries,grandstack,False,False,True,
Which 3 businesses have a review mentioning 'selection of books'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'selection of books'
RETURN b.name, b.address, b.city, b.state
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
Show the first 3 businesses reviewed by 'Jenny' in 2017.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date.year = 2017
RETURN b
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
What are the names of 3 businesses with reviews from 'Angie' with at least 4 stars?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars >= 4
RETURN b.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
List the top 5 businesses by the number of reviews they received in 2017.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2017-01-01') AND r.date <= date('2017-12-31')
WITH b, count(r) AS reviewsCount
ORDER BY reviewsCount DESC
LIMIT 5
RETURN b.name, reviewsCount",Simple Retrieval Queries,grandstack,False,False,True,
Show the names of 3 businesses where reviews mention 'sandwich'.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'sandwich'
RETURN b.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
Which 3 businesses have reviews mentioning 'Awesome service'?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.text CONTAINS 'Awesome service'
RETURN b.name, b.businessId
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
List the first 3 businesses in 'San Mateo' that have been reviewed.,"MATCH (b:Business {city: 'San Mateo'})-[:REVIEWS]->(r:Review)
WITH b, count(r) AS reviewsCount
WHERE reviewsCount > 0
RETURN b
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
What are the names of 3 businesses with reviews written in August 2015?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2015-08-01') AND r.date <= date('2015-08-31')
RETURN b.name
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
Show the first 5 reviews with a star rating below 4.0.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars < 4.0
RETURN r, u, b
ORDER BY r.date
LIMIT 5",Simple Retrieval Queries,grandstack,False,False,True,
What are the first 3 reviews mentioning 'Farmer's Market'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS ""Farmer's Market""
RETURN r, u, b
ORDER BY r.date ASC
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,False,
Which businesses have reviews written in September of any year?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date.month = 9
RETURN DISTINCT b",Complex Aggregation Queries,grandstack,False,False,True,
List the top 5 businesses located in Missoula.,"MATCH (b:Business {city: 'Missoula'})
RETURN b
ORDER BY b.name
LIMIT 5",Verbose query,grandstack,False,False,True,
List all business names and their categories located in 'CA'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.state = 'CA'
RETURN b.name AS BusinessName, c.name AS Category",Simple Retrieval Queries,grandstack,False,False,True,
What are the exact addresses of businesses categorized as 'Coffee' in 'Burlingame'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Coffee'})
WHERE b.city = 'Burlingame'
RETURN b.address",Simple Retrieval Queries,grandstack,False,False,False,
Which businesses have reviews from more than one user?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
WITH b, count(DISTINCT u) AS userCount
WHERE userCount > 1
RETURN b",Simple Retrieval Queries,grandstack,False,False,True,
List the reviews mentioning 'selection' and their corresponding businesses.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'selection'
RETURN r, b",Simple Retrieval Queries,grandstack,False,False,True,
What are the names of businesses in 'San Mateo' and their addresses?,"MATCH (b:Business {city: 'San Mateo'})
RETURN b.name, b.address",Simple Retrieval Queries,grandstack,False,False,False,
Give the review texts for businesses reviewed on '2017-05-03'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date = date('2017-05-03')
RETURN r.text AS ReviewText",Simple Retrieval Queries,grandstack,False,False,False,
Which businesses in 'CA' have been reviewed by 'Jenny'?,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {state: 'CA'})
RETURN b.name AS BusinessName, b.address AS Address",Simple Retrieval Queries,grandstack,False,False,True,
What are the names of businesses and their states for those located on '1st St W'?,"MATCH (b:Business)
WHERE b.address CONTAINS '1st St W'
RETURN b.name, b.state",Simple Retrieval Queries,grandstack,False,False,True,
List all the business names and review dates for businesses in 'Burlingame'.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.city = 'Burlingame'
RETURN b.name AS BusinessName, r.date AS ReviewDate",Simple Retrieval Queries,grandstack,False,False,False,
Which businesses have reviews mentioning 'sandwich'?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.text CONTAINS 'sandwich'
RETURN b.name, b.address, b.city, b.state",Simple Retrieval Queries,grandstack,False,False,False,
What are the categories of businesses at '200 W Pine St'?,"MATCH (b:Business {address: '200 W Pine St'})-[:IN_CATEGORY]->(c:Category)
RETURN c.name",Simple Retrieval Queries,grandstack,False,False,True,
Who wrote the review for 'Hanabi' and what was the star rating?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {name: 'Hanabi'})
RETURN u.name AS reviewerName, r.stars AS starRating",Simple Retrieval Queries,grandstack,False,False,True,
Which businesses in 'MT' have reviews written in 2016?,"MATCH (b:Business {state: 'MT'})-[:REVIEWS]->(r:Review)
WHERE r.date.year = 2016
RETURN b.name, b.address, collect(r.reviewId) AS reviewIds",Simple Retrieval Queries,grandstack,False,False,True,
List the businesses on 'E 5th Ave' and their review texts.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.address = '111 E 5th Ave'
RETURN b.name, r.text",Simple Retrieval Queries,grandstack,False,False,True,
What are the business names in 'Missoula' categorized under 'Brewery'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Brewery'})
WHERE b.city = 'Missoula'
RETURN b.name",Simple Retrieval Queries,grandstack,False,False,True,
Which business on 'California Dr' has the highest number of reviews?,"MATCH (b:Business {address: '723 California Dr'})-[:REVIEWS]-(r:Review)
RETURN b.name, count(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 1",Simple Retrieval Queries,grandstack,False,False,True,
List the businesses located at '716 N San Mateo Dr' and their categories.,"MATCH (b:Business {address: '716 N San Mateo Dr'})-[:IN_CATEGORY]->(c:Category)
RETURN b, c",Simple Retrieval Queries,grandstack,False,False,False,
What are the review texts for businesses rated exactly 3 stars?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars = 3.0
RETURN r.text AS ReviewText",Simple Retrieval Queries,grandstack,False,False,True,
Which reviews were written by 'Will'?,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r, b",Simple Retrieval Queries,grandstack,False,False,False,
What are the businesses reviewed on '2018-09-10' and who wrote the reviews?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date = date('2018-09-10')
RETURN b.name AS BusinessName, u.name AS UserName",Simple Retrieval Queries,grandstack,False,False,False,
List the businesses in 'San Mateo' along with their review stars.,"MATCH (b:Business {city: 'San Mateo'})-[:REVIEWS]->(r:Review)
RETURN b.name, r.stars",Simple Retrieval Queries,grandstack,False,False,True,
What are the names of users who wrote reviews in '2016'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date.year = 2016
RETURN DISTINCT u.name",Simple Retrieval Queries,grandstack,False,False,True,
Which businesses have a library category and are located in 'CA'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: ""Library""})
WHERE b.state = 'CA'
RETURN b",Simple Retrieval Queries,grandstack,False,False,True,
List the business addresses and their user reviews in 'Burlingame'.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)<-[:WROTE]-(u:User)
WHERE b.city = 'Burlingame'
RETURN b.address, r.text",Simple Retrieval Queries,grandstack,False,False,True,
What categories does 'Zootown Brew' belong to and what are the reviews?,"MATCH (b:Business {name: 'Zootown Brew'})-[:IN_CATEGORY]->(c:Category)
MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b)
RETURN c.name AS Category, r.text AS ReviewText, r.stars AS ReviewStars",Simple Retrieval Queries,grandstack,False,False,False,
Which businesses have a POINT location with a latitude greater than 37 degrees?,"MATCH (b:Business)
WHERE b.location.latitude > 37
RETURN b",Simple Retrieval Queries,grandstack,False,False,True,
Who are the users that have reviewed 'Imagine Nation Brewing'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {name: 'Imagine Nation Brewing'})
RETURN u.name AS UserName",Simple Retrieval Queries,grandstack,False,False,True,
Which businesses in 'Missoula' have reviews mentioning 'IPA'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Missoula'
MATCH (r:Review)-[:REVIEWS]->(b)
WHERE r.text CONTAINS 'IPA'
RETURN b.name, b.address, c.name",Simple Retrieval Queries,grandstack,False,False,True,
List the business names and their review stars for businesses on 'Main St'.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.address CONTAINS 'Main St'
RETURN b.name AS BusinessName, r.stars AS ReviewStars",Simple Retrieval Queries,grandstack,False,False,True,
What is the category of the business located at '1151 W Broadway St'?,"MATCH (b:Business {address: '1151 W Broadway St'})-[:IN_CATEGORY]->(c:Category)
RETURN c.name AS CategoryName",Simple Retrieval Queries,grandstack,False,False,True,
How many reviews have been written for businesses in 'San Mateo'?,"MATCH (b:Business {city: 'San Mateo'})-[:REVIEWS]-(r:Review)
RETURN count(r) AS NumberOfReviews",Simple Retrieval Queries,grandstack,False,False,True,
Which business located at '723 California Dr' has been reviewed?,"MATCH (b:Business {address: '723 California Dr'})-[:REVIEWS]-(r:Review)
RETURN b.name, b.businessId",Simple Retrieval Queries,grandstack,False,False,True,
What are the names and addresses of businesses located in 'MT'?,"MATCH (b:Business {state: 'MT'})
RETURN b.name, b.address",Simple Retrieval Queries,grandstack,False,False,False,
List all users who have written a review in September 2018.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(:Business)
WHERE r.date >= date('2018-09-01') AND r.date <= date('2018-09-30')
RETURN u",Simple Retrieval Queries,grandstack,False,False,True,
What are the business names and categories for businesses on 'Pine St'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address CONTAINS 'Pine St'
RETURN b.name AS BusinessName, c.name AS Category",Simple Retrieval Queries,grandstack,False,False,True,
Which reviews were written before 2017?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date < date('2017-01-01')
RETURN r, u.name AS reviewer, b.name AS business",Simple Retrieval Queries,grandstack,False,False,True,
What are the names of businesses with a review that mentions 'breakfast'?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.text CONTAINS 'breakfast'
RETURN b.name",Simple Retrieval Queries,grandstack,False,False,True,
What is the state of the business named 'Market on Front'?,"MATCH (b:Business {name: 'Market on Front'})
RETURN b.state",Simple Retrieval Queries,grandstack,False,False,True,
How many businesses are there in each city listed in the schema?,"MATCH (b:Business)
RETURN b.city, count(b) AS NumberOfBusinesses",Simple Retrieval Queries,grandstack,False,False,True,
Which user wrote a review for 'Missoula Public Library'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {name: 'Missoula Public Library'})
RETURN u.name AS UserName",Simple Retrieval Queries,grandstack,False,False,True,
Name all businesses that have a review mentioning 'IPA'.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'IPA'
RETURN b.name",Simple Retrieval Queries,grandstack,False,False,True,
Which businesses have been reviewed by users named 'Angie'?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b",Simple Retrieval Queries,grandstack,False,False,True,
Which businesses are located at '716 N San Mateo Dr'?,"MATCH (b:Business {address: '716 N San Mateo Dr'})
RETURN b",Simple Retrieval Queries,grandstack,False,False,True,
List the businesses and their review text for reviews with more than 4.5 stars.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.stars > 4.5
RETURN b.name AS BusinessName, r.text AS ReviewText",Simple Retrieval Queries,grandstack,False,False,True,
What is the location point of 'Ninja Mike's'?,"MATCH (b:Business {name: ""Ninja Mike's""})
RETURN b.location AS LocationPoint",Simple Retrieval Queries,grandstack,False,False,False,
Who wrote the review with the highest star rating?,"MATCH (u:User)-[:WROTE]->(r:Review)
RETURN u.name AS reviewer_name
ORDER BY r.stars DESC
LIMIT 1",Simple Retrieval Queries,grandstack,False,False,True,
List the reviews written by 'Bob'.,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r, b",Simple Retrieval Queries,grandstack,False,False,True,
What are the names of businesses located on 'Broadway St' and their categories?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address CONTAINS 'Broadway St'
RETURN b.name AS BusinessName, c.name AS Category",Simple Retrieval Queries,grandstack,False,False,True,
Which businesses in 'Missoula' have a review with exactly 5 stars?,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]->(r:Review {stars: 5.0})
RETURN b.name, b.address",Simple Retrieval Queries,grandstack,False,False,False,
Which reviews discuss 'car wash'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'car wash'
RETURN r, u.name AS reviewer, b.name AS business",Simple Retrieval Queries,grandstack,False,False,True,
How many different categories are there for businesses in 'CA'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.state = 'CA'
RETURN COUNT(DISTINCT c) AS NumberOfCategories",Simple Retrieval Queries,grandstack,False,False,False,
What are the names of businesses with reviews written in August 2018?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2018-08-01') AND r.date <= date('2018-08-31')
RETURN DISTINCT b.name",Simple Retrieval Queries,grandstack,False,False,True,
What are the names of businesses located at '301 E Main St' and their review dates?,"MATCH (b:Business {address: '301 E Main St'})-[:REVIEWS]->(r:Review)
RETURN b.name AS BusinessName, r.date AS ReviewDate",Simple Retrieval Queries,grandstack,False,False,False,
Which user has reviewed businesses in both 'Missoula' and 'San Mateo'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.city IN ['Missoula', 'San Mateo']
WITH u, collect(DISTINCT b.city) AS cities
WHERE ALL(city IN ['Missoula', 'San Mateo'] WHERE city IN cities)
RETURN u.name AS UserName",Simple Retrieval Queries,grandstack,False,False,True,
List the reviews mentioning 'world leading' and the businesses they review.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'world leading'
RETURN r, b",Simple Retrieval Queries,grandstack,False,False,True,
Which categories have more than one business in Missoula?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Missoula'
WITH c, count(b) AS businessCount
WHERE businessCount > 1
RETURN c.name, businessCount",Simple Retrieval Queries,grandstack,False,False,True,
List the names of businesses and their cities with reviews rating exactly 4.0.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.stars = 4.0
RETURN b.name AS BusinessName, b.city AS City",Simple Retrieval Queries,grandstack,False,False,True,
List the reviews and their business names for businesses on 'Pine St'.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.address CONTAINS 'Pine St'
RETURN r.text AS ReviewText, b.name AS BusinessName",Simple Retrieval Queries,grandstack,False,False,True,
Who wrote the most recent review and for which business?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN u.name AS UserName, b.name AS BusinessName, r.date AS ReviewDate
ORDER BY r.date DESC
LIMIT 1",Simple Retrieval Queries,grandstack,False,False,True,
List the users who have written reviews for businesses in 'San Mateo'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'San Mateo'})
RETURN DISTINCT u.name AS UserName",Complex Retrieval Queries,grandstack,False,False,True,
Find all reviews for 'Imagine Nation Brewing' and their corresponding stars.,"MATCH (b:Business {name: 'Imagine Nation Brewing'})<-[:REVIEWS]-(r:Review)
RETURN r.text AS ReviewText, r.stars AS Stars",Complex Retrieval Queries,grandstack,False,False,False,
Which user has reviewed 'Zootown Brew' and what was the star rating?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {name: 'Zootown Brew'})
RETURN u.name AS UserName, r.stars AS StarRating",Complex Retrieval Queries,grandstack,False,False,True,
Display all businesses reviewed by 'Will' and their locations.,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS BusinessName, b.location AS Location",Complex Retrieval Queries,grandstack,False,False,True,
List all categories available for businesses in 'Burlingame'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Burlingame'
RETURN DISTINCT c.name",Complex Retrieval Queries,grandstack,False,False,True,
Show the reviews and their dates for businesses located on 'W Broadway St'.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.address IN ['1151 W Broadway St', '121 W Broadway St']
RETURN r.text AS ReviewText, r.date AS ReviewDate",Complex Retrieval Queries,grandstack,False,False,True,
What are the business names and addresses for all businesses in 'CA'?,"MATCH (b:Business {state: 'CA'})
RETURN b.name AS BusinessName, b.address AS Address",Complex Retrieval Queries,grandstack,False,False,True,
Find the names and review texts of businesses with a rating less than 4.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.stars < 4
RETURN b.name AS BusinessName, r.text AS ReviewText",Complex Retrieval Queries,grandstack,False,False,False,
Which businesses have reviews written in 2016 and are located in 'CA'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.state = 'CA' AND r.date.year = 2016
RETURN b",Complex Retrieval Queries,grandstack,False,False,False,
List the businesses named 'Neo4j' and their reviews.,"MATCH (b:Business {name: 'Neo4j'})-[:REVIEWS]-(r:Review)
RETURN b, r",Complex Retrieval Queries,grandstack,False,False,True,
Display the names of users who have written reviews for 'Coffee' category businesses.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Coffee'})
RETURN DISTINCT u.name",Complex Retrieval Queries,grandstack,False,False,True,
Which businesses in 'Burlingame' have been reviewed by users with names starting with 'A'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.city = 'Burlingame' AND u.name STARTS WITH 'A'
RETURN b.name, b.address",Complex Retrieval Queries,grandstack,False,False,True,
Show the reviews and stars for businesses located on 'E Front St'.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.address CONTAINS 'E Front St'
RETURN b.name, r.text, r.stars",Complex Retrieval Queries,grandstack,False,False,True,
Find businesses with names containing 'Brew' and their review texts.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category)
WHERE b.name CONTAINS 'Brew'
MATCH (b)<-[:REVIEWS]-(r:Review)
RETURN b.name AS BusinessName, r.text AS ReviewText",Complex Retrieval Queries,grandstack,False,False,True,
List all the reviews with a date in 2017 for businesses in 'Missoula'.,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2017-01-01') AND r.date <= date('2017-12-31')
RETURN r",Complex Retrieval Queries,grandstack,False,False,True,
Which businesses are located at '716 N San Mateo Dr' and what are their categories?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address = '716 N San Mateo Dr'
RETURN b.name, c.name",Complex Retrieval Queries,grandstack,False,False,True,
Display all businesses in 'CA' that have been reviewed by 'Jenny' and show their review texts.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {state: 'CA'})
RETURN b.name AS BusinessName, r.text AS ReviewText",Complex Retrieval Queries,grandstack,False,False,True,
What are the names of all businesses that have been reviewed and are located in 'MT'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.state = 'MT'
RETURN DISTINCT b.name",Complex Retrieval Queries,grandstack,False,False,False,
Find businesses with the name 'KettleHouse Brewing Co.' and their categories.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.name = 'KettleHouse Brewing Co.'
RETURN b, c",Complex Retrieval Queries,grandstack,False,False,True,
List all categories for 'Ducky's Car Wash' and its reviews.,"MATCH (b:Business {name: ""Ducky's Car Wash""})-[:IN_CATEGORY]->(c:Category)
MATCH (b)<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN c.name AS Category, r AS Review, u.name AS User",Complex Retrieval Queries,grandstack,False,False,True,
Which users have written reviews for businesses in the 'Library' category?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
RETURN DISTINCT u.name AS UserName",Complex Retrieval Queries,grandstack,False,False,False,
Find the businesses in 'San Mateo' with reviews mentioning 'car wash'.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.city = 'San Mateo' AND r.text CONTAINS 'car wash'
RETURN b",Complex Retrieval Queries,grandstack,False,False,True,
List all businesses in 'Missoula' and their categories.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Missoula'
RETURN b.name, c.name",Complex Retrieval Queries,grandstack,False,False,True,
Which businesses have been reviewed by 'Will' and are located in 'CA'?,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {state: 'CA'})
RETURN b.name, b.address, b.city",Complex Retrieval Queries,grandstack,False,False,False,
Display the reviews and their texts for businesses on '1st St W'.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.address CONTAINS '1st St W'
RETURN r.text AS ReviewText",Complex Retrieval Queries,grandstack,False,False,True,
Which businesses in 'Missoula' have an address starting with '2'?,"MATCH (b:Business)
WHERE b.city = 'Missoula' AND b.address STARTS WITH '2'
RETURN b",Complex Retrieval Queries,grandstack,False,False,False,
What are the business names and their locations for businesses reviewed by 'Angie'?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS BusinessName, b.location AS Location",Simple Retrieval Queries,grandstack,False,False,True,
Show businesses that are both in 'Beer' and 'Coffee' categories.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE c.name = 'Beer'
WITH b
MATCH (b)-[:IN_CATEGORY]->(c2:Category)
WHERE c2.name = 'Coffee'
RETURN b",Complex Retrieval Queries,grandstack,False,False,True,
Display the top 5 businesses with the highest average review rating.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WITH b, AVG(r.stars) AS avgRating
ORDER BY avgRating DESC
LIMIT 5
RETURN b.name, avgRating",Complex Retrieval Queries,grandstack,False,False,False,
What are the review texts and dates for businesses on 'Broadway St'?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.address CONTAINS 'Broadway St'
RETURN r.text AS ReviewText, r.date AS ReviewDate",Simple Retrieval Queries,grandstack,False,False,False,
Who wrote reviews for businesses with addresses on 'Main St'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.address ENDS WITH 'Main St'
RETURN u.name AS ReviewerName",Simple Retrieval Queries,grandstack,False,False,True,
What are the businesses in 'MT' reviewed by users named 'Bob'?,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {state: 'MT'})
RETURN b",Simple Retrieval Queries,grandstack,False,False,True,
What are the names of businesses and their review stars located on '1st St W'?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.address CONTAINS '1st St W'
RETURN b.name AS BusinessName, r.stars AS ReviewStars",Simple Retrieval Queries,grandstack,False,False,True,
Which businesses in 'CA' have reviews mentioning 'great'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category), (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b)
WHERE b.state = 'CA' AND r.text CONTAINS 'great'
RETURN b.name, b.address, b.city, collect(r.text) AS reviews",Simple Retrieval Queries,grandstack,False,False,True,
What are the names and categories of businesses at '313 N 1st St W'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address = '313 N 1st St W'
RETURN b.name AS BusinessName, c.name AS Category",Simple Retrieval Queries,grandstack,False,False,False,
Who wrote the review for 'Neo4j' and what was the star rating?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {name: 'Neo4j'})
RETURN u.name AS reviewerName, r.stars AS starRating",Simple Retrieval Queries,grandstack,False,False,True,
What are the review texts for the businesses with the lowest star ratings?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WITH b, MIN(r.stars) AS lowestRating
MATCH (u2:User)-[:WROTE]->(r2:Review {stars: lowestRating})-[:REVIEWS]->(b)
RETURN b.name AS BusinessName, r2.text AS ReviewText",Simple Retrieval Queries,grandstack,False,False,True,
List the businesses on 'Front St' and their categories.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address CONTAINS 'Front St'
RETURN b.name AS BusinessName, b.address AS Address, c.name AS Category",Simple Retrieval Queries,grandstack,False,False,True,
Which businesses in 'San Mateo' have been reviewed in 2017?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.city = 'San Mateo' AND r.date.year = 2017
RETURN b",Simple Retrieval Queries,grandstack,False,False,True,
List the names of all businesses located in 'Missoula'.,"MATCH (b:Business {city: 'Missoula'})
RETURN b.name",Complex Retrieval Queries,grandstack,False,False,True,
Which businesses have a 'Beer' category in their classification?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Beer'})
RETURN b",Complex Retrieval Queries,grandstack,False,False,True,
Find all users who have written a review with a 5-star rating.,"MATCH (u:User)-[:WROTE]->(r:Review {stars: 5.0})
RETURN u",Complex Retrieval Queries,grandstack,False,False,False,
Show all businesses located at '301 E Main St'.,"MATCH (b:Business {address: '301 E Main St'})
RETURN b",Complex Retrieval Queries,grandstack,False,False,True,
What are the names of businesses that have received reviews with a rating of 4 or higher?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars >= 4
RETURN DISTINCT b.name",Complex Retrieval Queries,grandstack,False,False,False,
Display the names and cities of businesses that are in the 'Library' category.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
RETURN b.name AS BusinessName, b.city AS City",Complex Retrieval Queries,grandstack,False,False,True,
Which businesses in 'San Mateo' are reviewed by 'Jenny'?,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'San Mateo'})
RETURN b.name AS BusinessName, b.address AS Address",Complex Retrieval Queries,grandstack,False,False,True,
Identify all reviews written by 'Bob'.,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)
RETURN r",Complex Retrieval Queries,grandstack,False,False,True,
Find the names of businesses that are located in 'CA' and have been reviewed.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.state = 'CA' AND EXISTS { MATCH (b)-[:REVIEWS]->(:Review) }
RETURN DISTINCT b.name",Complex Retrieval Queries,grandstack,False,False,False,
List the names of businesses along with their categories located in 'Burlingame'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Burlingame'
RETURN b.name AS BusinessName, c.name AS Category",Complex Retrieval Queries,grandstack,False,False,False,
Which users have reviewed businesses located at '1151 W Broadway St'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {address: '1151 W Broadway St'})
RETURN u.name AS UserName",Complex Retrieval Queries,grandstack,False,False,False,
Show the businesses that have the highest number of reviews.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
RETURN b.name, count(r) AS NumberOfReviews
ORDER BY NumberOfReviews DESC",Complex Retrieval Queries,grandstack,False,False,True,
Find businesses in 'Missoula' with reviews dated after 2017-01-01.,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]->(r:Review)
WHERE r.date > date('2017-01-01')
RETURN b",Complex Retrieval Queries,grandstack,False,False,True,
List the names of businesses along with their reviews and ratings.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
RETURN b.name AS BusinessName, r.text AS ReviewText, r.stars AS Rating",Complex Retrieval Queries,grandstack,False,False,True,
Which businesses are categorized under 'Coffee' and have reviews with text mentioning 'best'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Coffee'})
WHERE EXISTS {
  (b)<-[:REVIEWS]-(r:Review)
  WHERE r.text CONTAINS 'best'
}
RETURN b",Complex Retrieval Queries,grandstack,False,False,True,
Identify the businesses reviewed by 'Angie' and list the corresponding review texts.,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS BusinessName, r.text AS ReviewText",Complex Retrieval Queries,grandstack,False,False,True,
What are the business names and categories for all businesses in 'Missoula' that are located on 'Broadway St'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Missoula' AND b.address CONTAINS 'Broadway St'
RETURN b.name AS BusinessName, c.name AS Category",Complex Retrieval Queries,grandstack,False,False,True,
Which reviews mention 'great selection'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'great selection'
RETURN r, u.name AS reviewer, b.name AS business",Simple Retrieval Queries,grandstack,False,False,True,
Which businesses have reviews written on '2016-11-21'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.date = date('2016-11-21')
RETURN b.name, b.address, b.city, b.state",Simple Retrieval Queries,grandstack,False,False,True,
List businesses that have been reviewed in the last quarter of 2017.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2017-10-01') AND r.date <= date('2017-12-31')
RETURN b",Complex Aggregation Queries,grandstack,False,False,True,
What is the average number of reviews per user?,"MATCH (u:User)
WITH u, count{(u)-[:WROTE]->(:Review)} AS reviewsCount
RETURN avg(reviewsCount) AS averageReviewsPerUser",Complex Aggregation Queries,grandstack,False,False,True,
Which reviews contain the word 'selection' in their text?,"MATCH (r:Review)
WHERE r.text CONTAINS 'selection'
RETURN r",Complex Aggregation Queries,grandstack,False,False,True,
Find the business with the highest number of categories in 'San Mateo'.,"MATCH (b:Business {city: 'San Mateo'})-[:IN_CATEGORY]->(c:Category)
WITH b, count(c) AS numCategories
ORDER BY numCategories DESC
LIMIT 1
RETURN b.name, b.address, numCategories",Complex Aggregation Queries,grandstack,False,False,True,
List the businesses along with their review dates that have been reviewed by 'Will'.,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS BusinessName, r.date AS ReviewDate",Complex Aggregation Queries,grandstack,False,False,True,
What are the different categories of businesses that 'Angie' has reviewed?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(:Review)-[:REVIEWS]->(b:Business)-[:IN_CATEGORY]->(c:Category)
RETURN DISTINCT c.name",Complex Aggregation Queries,grandstack,False,False,True,
How many users have reviewed businesses in 'Burlingame'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Burlingame'})
RETURN count(DISTINCT u) AS NumberOfUsers",Complex Aggregation Queries,grandstack,False,False,False,
Which business in 'Missoula' has received the most 5-star reviews?,"MATCH (b:Business {city: 'Missoula'})-[:IN_CATEGORY]->(c:Category)
MATCH (r:Review {stars: 5.0})-[:REVIEWS]->(b)
RETURN b.name, count(r) AS FiveStarReviews
ORDER BY FiveStarReviews DESC
LIMIT 1",Complex Aggregation Queries,grandstack,False,False,True,
List the businesses that have been reviewed by exactly two different users.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
WITH b, count(DISTINCT u) AS userCount
WHERE userCount = 2
RETURN b",Complex Aggregation Queries,grandstack,False,False,True,
Which users have reviewed the business located at '301 E Main St'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {address: '301 E Main St'})
RETURN u.name AS UserName",Complex Aggregation Queries,grandstack,False,False,False,
What are the review texts for 'Zootown Brew' and who wrote them?,"MATCH (b:Business {name: 'Zootown Brew'})<-[:REVIEWS]-(r:Review)-[:WROTE]->(u:User)
RETURN r.text AS ReviewText, u.name AS UserName",Complex Aggregation Queries,grandstack,False,False,False,
Which business has the earliest review date in the database?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
RETURN b.name AS BusinessName, r.date AS ReviewDate
ORDER BY r.date ASC
LIMIT 1",Complex Aggregation Queries,grandstack,False,False,True,
List the businesses reviewed by 'Bob' and the corresponding categories of these businesses.,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)-[:IN_CATEGORY]->(c:Category)
RETURN b.name AS BusinessName, c.name AS CategoryName",Complex Aggregation Queries,grandstack,False,False,False,
Which businesses have a review with stars greater than the average stars of all reviews?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WITH AVG(r.stars) AS avgStars
MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.stars > avgStars
RETURN b",Complex Aggregation Queries,grandstack,False,False,False,
Show businesses that have been reviewed only once and the reviewers' names.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)-[:WROTE]->(u:User)
WITH b, count(r) AS reviewsCount, collect(u.name) AS reviewerNames
WHERE reviewsCount = 1
RETURN b.name AS BusinessName, reviewerNames",Complex Aggregation Queries,grandstack,False,False,True,
Who reviewed 'Imagine Nation Brewing' and what was the star rating?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {name: 'Imagine Nation Brewing'})
RETURN u.name AS reviewer, r.stars AS star_rating",Complex Aggregation Queries,grandstack,False,False,False,
List the top 3 businesses in 'Missoula' based on the number of reviews.,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]->(r:Review)
WITH b, count(r) AS reviewsCount
ORDER BY reviewsCount DESC
LIMIT 3
RETURN b.name, b.address, reviewsCount",Complex Aggregation Queries,grandstack,False,False,True,
List the businesses and their review counts in descending order of reviews.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
RETURN b.name, count(r) AS reviewCount
ORDER BY reviewCount DESC",Complex Aggregation Queries,grandstack,False,False,True,
Which businesses have reviews that mention 'breakfast'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'breakfast'
RETURN b.name, b.address, b.city, b.state",Complex Aggregation Queries,grandstack,False,False,True,
Can you find reviews that were written on '2017-05-21'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date = date('2017-05-21')
RETURN u, r, b",Complex Aggregation Queries,grandstack,False,False,False,
Which user has given the highest average rating in their reviews?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(:Business)
WITH u, AVG(r.stars) AS avgRating
ORDER BY avgRating DESC
LIMIT 1
RETURN u.name AS userName, avgRating",Complex Aggregation Queries,grandstack,False,False,True,
List all businesses that have at least two different categories.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WITH b, count(DISTINCT c) AS numCategories
WHERE numCategories >= 2
RETURN b",Complex Aggregation Queries,grandstack,False,False,False,
Which businesses have the most categories associated with them?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WITH b, count(c) AS num_categories
ORDER BY num_categories DESC
RETURN b.name, num_categories",Complex Aggregation Queries,grandstack,False,False,False,
Show the locations and names of businesses in 'Burlingame' with reviews rating exactly 4 stars.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category), (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'Burlingame' AND r.stars = 4.0
RETURN b.location, b.name",Complex Aggregation Queries,grandstack,False,False,True,
Find businesses that have been reviewed by users whose name starts with 'J'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE u.name STARTS WITH 'J'
RETURN DISTINCT b",Complex Aggregation Queries,grandstack,False,False,False,
Which business in 'Burlingame' has reviews mentioning 'great'?,"MATCH (b:Business {city: 'Burlingame'})-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'great'
RETURN b.name, b.address",Complex Aggregation Queries,grandstack,False,False,True,
Which categories have businesses in both 'Missoula' and 'San Mateo'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Missoula' OR b.city = 'San Mateo'
WITH c, collect(b.city) AS cities
WHERE ALL(city IN ['Missoula', 'San Mateo'] WHERE city IN cities)
RETURN DISTINCT c.name",Complex Aggregation Queries,grandstack,False,False,True,
How many reviews have been written for businesses categorized under 'Library'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
WITH b
MATCH (r:Review)-[:REVIEWS]->(b)
RETURN count(r) AS NumberOfReviews",Complex Aggregation Queries,grandstack,False,False,False,
List the names of businesses that have only 4-star reviews.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.stars = 4.0
WITH b, count(r) AS reviewsCount
WHERE NOT exists {
    MATCH (b)-[:REVIEWS]->(r2:Review)
    WHERE r2.stars <> 4.0
}
RETURN b.name",Complex Aggregation Queries,grandstack,False,False,False,
Which businesses have categories associated with more than one location?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WITH c, count(DISTINCT b.location) AS locations
WHERE locations > 1
RETURN c.name AS Category, locations",Complex Aggregation Queries,grandstack,False,False,True,
What are the names of businesses that have received reviews from 'Bob' and 'Angie'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE u.name IN ['Bob', 'Angie']
WITH b, count(DISTINCT u) AS reviewers
WHERE reviewers = 2
RETURN b.name",Complex Aggregation Queries,grandstack,False,False,False,
List all businesses and their review stars where the review text includes 'love'.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'love'
RETURN b.name, r.stars",Complex Aggregation Queries,grandstack,False,False,False,
Which businesses in 'Missoula' have reviews mentioning 'library'?,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]->(r:Review)-[:WROTE]->(u:User)
WHERE r.text CONTAINS 'library'
RETURN b.name, b.address, r.text, u.name",Complex Aggregation Queries,grandstack,True,False,False,
What is the highest number of reviews a single business has received and which business is it?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, count(r) AS reviewsCount
ORDER BY reviewsCount DESC
LIMIT 1
RETURN b.name AS BusinessName, reviewsCount AS NumberOfReviews",Complex Aggregation Queries,grandstack,False,False,False,
List the businesses that have only received 5-star reviews.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.stars = 5
WITH b, count(r) AS reviewsCount
WHERE NOT exists {
    MATCH (b)-[:REVIEWS]->(r2:Review)
    WHERE r2.stars <> 5
}
RETURN b",Complex Aggregation Queries,grandstack,False,False,False,
Which businesses in 'San Mateo' have reviews with text mentioning 'world'?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.city = 'San Mateo' AND r.text CONTAINS 'world'
RETURN b",Complex Aggregation Queries,grandstack,False,False,False,
"List businesses within 5 km of the location point (-113.995297, 46.877981).","MATCH (b:Business)
WHERE distance(b.location, point({longitude: -113.995297, latitude: 46.877981})) <= 5000
RETURN b",Complex Aggregation Queries,grandstack,False,False,True,
What are the names of businesses in 'CA' that have not received any reviews?,"MATCH (b:Business {state: 'CA'})
WHERE NOT EXISTS {
  (b)<-[:REVIEWS]-(:Review)
}
RETURN b.name",Complex Aggregation Queries,grandstack,False,False,True,
Which businesses have been reviewed more than once by the same user?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WITH u, b, COUNT(r) AS reviews_count
WHERE reviews_count > 1
RETURN u.name AS UserName, b.name AS BusinessName, reviews_count",Complex Aggregation Queries,grandstack,False,False,True,
List the categories of businesses that have the most reviews.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WITH b, count(r) AS reviewsCount
ORDER BY reviewsCount DESC
LIMIT 1
MATCH (b)-[:IN_CATEGORY]->(c:Category)
RETURN c.name AS Category, reviewsCount",Complex Aggregation Queries,grandstack,False,False,False,
Show all businesses that have been reviewed in January of any year.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE date(r.date).month = 1
RETURN b",Complex Aggregation Queries,grandstack,False,False,True,
Which businesses have reviews with star ratings between 3 and 4?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.stars >= 3 AND r.stars <= 4
RETURN b.name, b.address, b.city, b.state, r.stars",Complex Aggregation Queries,grandstack,True,False,False,
List all the businesses in 'Burlingame' and the reviews written for them.,"MATCH (b:Business {city: 'Burlingame'})-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN b.name AS BusinessName, b.address AS Address, r.text AS ReviewText, r.stars AS Stars, u.name AS UserName",Complex Aggregation Queries,grandstack,False,False,False,
Which businesses have reviews mentioning 'ipa' in their text?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE toLower(r.text) CONTAINS 'ipa'
RETURN b",Complex Aggregation Queries,grandstack,False,False,True,
List the review texts and their corresponding business names for reviews with exactly 3 stars.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars = 3.0
RETURN r.text AS ReviewText, b.name AS BusinessName",Complex Aggregation Queries,grandstack,False,False,True,
Which businesses in 'Missoula' are located within 1 km of 'Missoula Public Library'?,"MATCH (library:Business {name: 'Missoula Public Library'})
WITH library
MATCH (business:Business {city: 'Missoula'})
WHERE distance(library.location, business.location) <= 1000
RETURN business",Complex Aggregation Queries,grandstack,False,False,False,
What are the names of businesses that have been reviewed by all users listed in the schema?,"MATCH (u:User)
WITH collect(u) AS users
MATCH (b:Business)
WHERE all(u IN users WHERE exists {
    (u)-[:WROTE]->(:Review)-[:REVIEWS]->(b)
})
RETURN b.name AS BusinessName",Complex Aggregation Queries,grandstack,False,False,True,
Which businesses have a review written on '2018-09-10'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.date = date('2018-09-10')
RETURN b",Complex Aggregation Queries,grandstack,False,False,True,
Find the business with the most reviews in 'San Mateo' and list its reviews.,"MATCH (b:Business {city: 'San Mateo'})-[:REVIEWS]-(r:Review)
WITH b, count(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 1
MATCH (b)-[:REVIEWS]-(r:Review)
RETURN b, collect(r) AS Reviews",Complex Aggregation Queries,grandstack,False,False,False,
List the businesses that have been reviewed by each user more than once.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WITH u, b, COUNT(r) AS reviews_count
WHERE reviews_count > 1
RETURN u.name AS UserName, b.name AS BusinessName, reviews_count
ORDER BY u.name, b.name",Complex Aggregation Queries,grandstack,False,False,True,
Which business categories do not have any reviews mentioning 'awesome'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE NOT EXISTS {
    MATCH (b)<-[:REVIEWS]-(r:Review)
    WHERE r.text CONTAINS 'awesome'
}
RETURN DISTINCT c.name",Complex Aggregation Queries,grandstack,False,False,True,
What are the review texts for reviews written in 2016 and who wrote them?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date('2016-01-01') AND r.date <= date('2016-12-31')
RETURN r.text AS ReviewText, u.name AS UserName",Complex Aggregation Queries,grandstack,False,False,True,
Show the names of businesses located at '313 N 1st St W' and their review texts.,"MATCH (b:Business {address: '313 N 1st St W'})-[:REVIEWS]->(r:Review)
RETURN b.name AS BusinessName, r.text AS ReviewText",Complex Aggregation Queries,grandstack,False,False,True,
Which businesses have the most number of reviews in 'Missoula'?,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]-(r:Review)
RETURN b.name, count(r) AS NumberOfReviews
ORDER BY NumberOfReviews DESC",Complex Aggregation Queries,grandstack,True,False,False,
Which reviews are written by users from 'CA' state businesses?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.state = 'CA'
RETURN r",Complex Aggregation Queries,grandstack,False,False,True,
What are the business names and their categories on 'E Front St'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address CONTAINS 'E Front St'
RETURN b.name AS BusinessName, c.name AS Category",Simple Retrieval Queries,grandstack,False,False,True,
List the user names and their corresponding review texts.,"MATCH (u:User)-[:WROTE]->(r:Review)
RETURN u.name AS UserName, r.text AS ReviewText",Complex Aggregation Queries,grandstack,False,False,True,
"Find all businesses located within 2 km of the point (-113.990976, 46.870035).","MATCH (b:Business)
WHERE distance(b.location, point({longitude: -113.990976, latitude: 46.870035})) <= 2000
RETURN b",Complex Aggregation Queries,grandstack,False,False,True,
Which business has the review with the lowest star rating?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
RETURN b.name AS BusinessName, r.stars AS StarRating
ORDER BY r.stars ASC
LIMIT 1",Complex Aggregation Queries,grandstack,False,False,True,
List all reviews written by the user named 'Jenny'.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)
RETURN r",Complex Aggregation Queries,grandstack,False,False,True,
What are the names of businesses located in 'CA' state?,"MATCH (b:Business)
WHERE b.state = 'CA'
RETURN b.name",Complex Aggregation Queries,grandstack,False,False,True,
Who wrote the review with the text 'Great IPA selection!'?,"MATCH (u:User)-[:WROTE]->(r:Review {text: 'Great IPA selection!'})
RETURN u.name",Complex Aggregation Queries,grandstack,False,False,True,
Find all reviews that have a star rating of 5.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars = 5
RETURN u, r, b",Complex Aggregation Queries,grandstack,False,False,True,
Which businesses are categorized under 'Library'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
RETURN b",Complex Aggregation Queries,grandstack,False,False,True,
What are the addresses of the first 3 businesses in Missoula?,"MATCH (b:Business {city: 'Missoula'})
RETURN b.address
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
Which users wrote reviews with a rating of 5 stars?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(:Business)
WHERE r.stars = 5
RETURN u",Simple Retrieval Queries,grandstack,False,False,True,
List the names of businesses located in 'San Mateo'.,"MATCH (b:Business {city: 'San Mateo'})
RETURN b.name",Simple Retrieval Queries,grandstack,False,False,True,
Which business has the address '301 E Main St'?,"MATCH (b:Business {address: '301 E Main St'})
RETURN b",Simple Retrieval Queries,grandstack,False,False,True,
How many businesses are located in Burlingame?,"MATCH (b:Business {city: 'Burlingame'})
RETURN count(b) AS NumberOfBusinessesInBurlingame",Simple Retrieval Queries,grandstack,False,False,True,
Find the top 5 most recent reviews.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r, u, b
ORDER BY r.date DESC
LIMIT 5",Simple Retrieval Queries,grandstack,False,False,True,
Who wrote the earliest review in the dataset?,"MATCH (u:User)-[:WROTE]->(r:Review)
RETURN u.name AS reviewer_name, r.date AS review_date
ORDER BY r.date ASC
LIMIT 1",Simple Retrieval Queries,grandstack,False,False,True,
What is the name of the business reviewed by user with userId 'u1'?,"MATCH (u:User {userId: 'u1'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name",Simple Retrieval Queries,grandstack,False,False,True,
What are the categories of the businesses on 'W Broadway St'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address CONTAINS 'W Broadway St'
RETURN DISTINCT c.name",Simple Retrieval Queries,grandstack,False,False,True,
Which businesses have a rating of 3.5 or higher?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars >= 3.5
RETURN DISTINCT b.name, b.address, b.city, b.state",Simple Retrieval Queries,grandstack,False,False,True,
List all businesses that have been reviewed by 'Jenny'.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b",Simple Retrieval Queries,grandstack,False,False,True,
What are the names of the businesses that serve as libraries?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: ""Library""})
RETURN b.name",Simple Retrieval Queries,grandstack,False,False,True,
Which businesses are categorized under 'Coffee'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Coffee'})
RETURN b",Simple Retrieval Queries,grandstack,False,False,True,
What are the first 3 businesses reviewed in 2018?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date('2018-01-01') AND r.date < date('2019-01-01')
RETURN b
ORDER BY r.date ASC
LIMIT 3",Simple Retrieval Queries,grandstack,False,False,True,
What are the names of users who reviewed businesses in 'CA'?,"MATCH (u:User)-[:WROTE]->(:Review)-[:REVIEWS]->(b:Business)
WHERE b.state = 'CA'
RETURN DISTINCT u.name",Simple Retrieval Queries,grandstack,False,False,True,
Which user has reviewed 'Zootown Brew'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {name: 'Zootown Brew'})
RETURN u.name AS UserName",Simple Retrieval Queries,grandstack,False,False,False,
What are the addresses of businesses in state 'MT'?,"MATCH (b:Business {state: 'MT'})
RETURN b.address",Simple Retrieval Queries,grandstack,False,False,False,
List the businesses that have been reviewed more than once.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, count(r) AS reviewsCount
WHERE reviewsCount > 1
RETURN b",Simple Retrieval Queries,grandstack,False,False,True,
What are the names of all categories associated with 'Neo4j'?,"MATCH (b:Business {name: 'Neo4j'})-[:IN_CATEGORY]->(c:Category)
RETURN c.name",Simple Retrieval Queries,grandstack,False,False,True,
What are the names of businesses that have reviews with a star rating above 4.5?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.stars > 4.5
RETURN DISTINCT b.name",Complex Aggregation Queries,grandstack,False,False,True,
What are the names of businesses that have reviews with text mentioning 'car wash'?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.text CONTAINS 'car wash'
RETURN DISTINCT b.name",Complex Aggregation Queries,grandstack,False,False,False,
How many categories are associated with the business named 'Neo4j'?,"MATCH (b:Business {name: 'Neo4j'})-[:IN_CATEGORY]->(c:Category)
RETURN count(c) AS NumberOfCategories",Complex Aggregation Queries,grandstack,False,False,True,
What are the names of the users who have written a review for 'KettleHouse Brewing Co.'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {name: 'KettleHouse Brewing Co.'})
RETURN u.name",Complex Aggregation Queries,grandstack,False,False,True,
Which business has the most reviews in 'Burlingame'?,"MATCH (b:Business {city: 'Burlingame'})-[:REVIEWS]-(r:Review)
RETURN b.name, count(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 1",Complex Aggregation Queries,grandstack,False,False,True,
List all businesses that have not been reviewed.,"MATCH (b:Business)
WHERE NOT exists{ (:User)-[:WROTE]->(:Review)-[:REVIEWS]->(b) }
RETURN b",Complex Aggregation Queries,grandstack,False,False,False,
What are the business names and their corresponding city that have been reviewed by 'Jenny'?,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS BusinessName, b.city AS City",Complex Aggregation Queries,grandstack,False,False,True,
How many reviews have been written for each category of business?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WITH c, count{(b)-[:REVIEWS]->(:Review)} AS reviewCount
RETURN c.name AS Category, reviewCount AS NumberOfReviews",Complex Aggregation Queries,grandstack,False,False,False,
Which user has reviewed the most number of unique businesses?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WITH u, count(DISTINCT b) AS uniqueBusinesses
RETURN u.name AS userName, uniqueBusinesses
ORDER BY uniqueBusinesses DESC
LIMIT 1",Complex Aggregation Queries,grandstack,False,False,True,
List the categories of businesses that have been reviewed in 2018.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)-[:IN_CATEGORY]->(c:Category)
WHERE r.date.year = 2018
RETURN DISTINCT c.name",Complex Aggregation Queries,grandstack,False,False,True,
What are the names of the businesses that 'Will' has reviewed?,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name",Complex Aggregation Queries,grandstack,False,False,True,
Find businesses that have reviews both above and below 4 stars.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, collect(r.stars) AS stars
WHERE any(star IN stars WHERE star > 4) AND any(star IN stars WHERE star < 4)
RETURN b",Complex Aggregation Queries,grandstack,False,False,True,
Which business in 'San Mateo' has the highest average star rating based on reviews?,"MATCH (b:Business {city: 'San Mateo'})-[:REVIEWS]-(r:Review)
WITH b, AVG(r.stars) AS avg_stars
RETURN b.name AS BusinessName, avg_stars
ORDER BY avg_stars DESC
LIMIT 1",Complex Aggregation Queries,grandstack,False,False,True,
List all the reviews with a star rating below 3.5.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars < 3.5
RETURN u.name AS UserName, r.text AS ReviewText, r.stars AS StarRating, b.name AS BusinessName",Complex Aggregation Queries,grandstack,False,False,True,
What are the complete addresses of businesses named 'Zootown Brew'?,"MATCH (b:Business {name: 'Zootown Brew'})
RETURN b.address AS Address",Complex Aggregation Queries,grandstack,False,False,True,
How many businesses are there in each state listed in the database?,"MATCH (b:Business)
RETURN b.state, count(b) AS NumberOfBusinesses",Complex Aggregation Queries,grandstack,True,False,False,
What are the names of businesses that have received a review from 'Angie'?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN DISTINCT b.name",Complex Aggregation Queries,grandstack,False,False,True,
Which businesses have a review dated earlier than 2016?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date < date('2016-01-01')
RETURN b.name, b.address, b.city, b.state",Complex Aggregation Queries,grandstack,False,False,True,
List the top 5 highest-rated businesses based on average review stars.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, AVG(r.stars) AS avg_stars
ORDER BY avg_stars DESC
LIMIT 5
RETURN b.name, avg_stars",Complex Aggregation Queries,grandstack,False,False,True,
Identify businesses that have received exactly three reviews.,"MATCH (b:Business)
WHERE size{(b)<-[:REVIEWS]-(:Review)} = 3
RETURN b",Complex Aggregation Queries,grandstack,False,False,True,
What categories are available for businesses in 'Missoula'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Missoula'
RETURN DISTINCT c.name",Complex Aggregation Queries,grandstack,False,False,True,
How many businesses are there in each city within the database?,"MATCH (b:Business)
RETURN b.city, count(b) AS NumberOfBusinesses",Complex Aggregation Queries,grandstack,False,False,True,
Which reviews mention 'sandwich' in their text?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'sandwich'
RETURN r, u.name AS reviewer, b.name AS business",Complex Aggregation Queries,grandstack,False,False,True,
List the businesses reviewed by 'Bob'.,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b",Complex Aggregation Queries,grandstack,False,False,True,
Which user has written the most reviews?,"MATCH (u:User)-[:WROTE]->(r:Review)
RETURN u.name, count(r) AS reviews_count
ORDER BY reviews_count DESC
LIMIT 1",Complex Aggregation Queries,grandstack,False,False,True,
Find the top 3 most recent reviews.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r, u, b
ORDER BY r.date DESC
LIMIT 3",Complex Aggregation Queries,grandstack,False,False,True,
What is the average star rating of reviews for 'Missoula Public Library'?,"MATCH (b:Business {name: 'Missoula Public Library'})-[:REVIEWS]-(r:Review)
RETURN AVG(r.stars) AS average_rating",Complex Aggregation Queries,grandstack,False,False,True,
How many reviews does each user have?,"MATCH (u:User)-[:WROTE]->(r:Review)
RETURN u.name AS UserName, count(r) AS ReviewCount",Complex Aggregation Queries,grandstack,False,False,True,
List the names and addresses of all businesses in 'San Mateo'.,"MATCH (b:Business {city: 'San Mateo'})
RETURN b.name, b.address",Complex Aggregation Queries,grandstack,False,False,False,
List all businesses along with their categories in the city of 'Burlingame'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Burlingame'
RETURN b, c",Complex Aggregation Queries,grandstack,False,False,True,
Find the categories and addresses of businesses that have been reviewed by 'Bob'.,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)-[:IN_CATEGORY]->(c:Category)
RETURN c.name AS Category, b.address AS Address",Complex Retrieval Queries,grandstack,False,False,True,
Show the reviews for 'Market on Front' along with the review dates and stars.,"MATCH (b:Business {name: 'Market on Front'})-[:REVIEWS]-(r:Review)
RETURN r.text AS ReviewText, r.date AS ReviewDate, r.stars AS Stars",Complex Retrieval Queries,grandstack,False,False,True,
Which businesses in 'San Mateo' have been reviewed by 'Angie' and what were the ratings?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'San Mateo'})
RETURN b.name AS BusinessName, r.stars AS Rating",Complex Retrieval Queries,grandstack,False,False,True,
Which business in 'CA' has the most reviews?,"MATCH (b:Business {state: 'CA'})-[:REVIEWS]-(r:Review)
RETURN b.name, count(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 1",Pathfinding Queries,grandstack,False,False,True,
Find the reviews made for businesses in 'MT'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.state = 'MT'
RETURN r, b",Pathfinding Queries,grandstack,False,False,True,
What are the business names in 'San Mateo'?,"MATCH (b:Business {city: 'San Mateo'})
RETURN b.name",Pathfinding Queries,grandstack,False,False,True,
Which businesses are located on 'E Front St'?,"MATCH (b:Business)
WHERE b.address CONTAINS 'E Front St'
RETURN b",Pathfinding Queries,grandstack,False,False,True,
Show all users who have written a review for a business in 'Missoula'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Missoula'})
RETURN DISTINCT u",Pathfinding Queries,grandstack,False,False,False,
Which businesses have reviews with stars between 4 and 5?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.stars >= 4 AND r.stars <= 5
RETURN b",Pathfinding Queries,grandstack,False,False,True,
List all reviews made by Angie.,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)
RETURN r",Pathfinding Queries,grandstack,False,False,True,
How many businesses have been reviewed by Bob?,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(:Review)-[:REVIEWS]->(b:Business)
RETURN count(DISTINCT b) AS NumberOfBusinessesReviewedByBob",Pathfinding Queries,grandstack,False,False,True,
Find businesses with reviews mentioning 'graph database'.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.text CONTAINS 'graph database'
RETURN b",Pathfinding Queries,grandstack,False,False,True,
What is the state of businesses that have been reviewed by Jenny?,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(:Review)-[:REVIEWS]->(b:Business)
RETURN DISTINCT b.state",Pathfinding Queries,grandstack,False,False,False,
Which category does 'Ducky's Car Wash' belong to?,"MATCH (b:Business {name: ""Ducky's Car Wash""})-[:IN_CATEGORY]->(c:Category)
RETURN c.name",Pathfinding Queries,grandstack,False,False,True,
List top 3 businesses by the number of reviews.,"MATCH (b:Business)<-[:REVIEWS]-(:Review)
WITH b, count(*) AS reviewsCount
ORDER BY reviewsCount DESC
LIMIT 3
RETURN b.name, reviewsCount",Pathfinding Queries,grandstack,True,False,False,
Show businesses that have been reviewed with exactly 5 stars.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars = 5.0
RETURN b",Pathfinding Queries,grandstack,False,False,True,
Which businesses have been reviewed by all users?,"MATCH (u:User)
WITH collect(u) AS allUsers
MATCH (b:Business)
WHERE all(allUser IN allUsers WHERE exists {
    (allUser)-[:WROTE]->(:Review)-[:REVIEWS]->(b)
})
RETURN b",Pathfinding Queries,grandstack,False,False,True,
List the categories of businesses reviewed by Will.,"MATCH (u:User {name: 'Will'})-[:WROTE]->(:Review)-[:REVIEWS]->(b:Business)-[:IN_CATEGORY]->(c:Category)
RETURN DISTINCT c.name",Pathfinding Queries,grandstack,False,False,False,
Which business is closest to '301 E Main St' based on their POINT location?,"MATCH (b:Business)
WHERE b.address = '301 E Main St'
WITH b.location AS referenceLocation
MATCH (other:Business)
WHERE other.location IS NOT NULL
RETURN other.name, distance(referenceLocation, other.location) AS Distance
ORDER BY Distance ASC
LIMIT 1",Pathfinding Queries,grandstack,False,False,True,
Which businesses have been reviewed on '2018-09-10'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date = date('2018-09-10')
RETURN b",Pathfinding Queries,grandstack,False,False,True,
Find the first 3 reviews in the database.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r, u, b
ORDER BY r.date ASC
LIMIT 3",Pathfinding Queries,grandstack,False,False,True,
List the businesses that are in the same category as 'Neo4j'.,"MATCH (b:Business {name: 'Neo4j'})-[:IN_CATEGORY]->(c:Category)<-[:IN_CATEGORY]-(other:Business)
RETURN other",Pathfinding Queries,grandstack,False,False,True,
Find the top 5 earliest reviews.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r, u, b
ORDER BY r.date ASC
LIMIT 5",Pathfinding Queries,grandstack,False,False,True,
Which businesses have reviews written in 2016?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2016-01-01') AND r.date <= date('2016-12-31')
RETURN b.name, b.businessId, collect(r.reviewId) AS reviewIds",Pathfinding Queries,grandstack,False,False,False,
List the businesses that have been reviewed by both Will and Jenny.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
WHERE u.name IN ['Will', 'Jenny']
WITH b, count(DISTINCT u) AS userCount
WHERE userCount = 2
RETURN b",Pathfinding Queries,grandstack,False,False,True,
Which business reviewed by Jenny has the lowest star rating?,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS BusinessName, r.stars AS StarRating
ORDER BY r.stars ASC
LIMIT 1",Pathfinding Queries,grandstack,False,False,True,
Find the reviews for the business with the highest number of stars.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
RETURN b.name AS BusinessName, r.text AS ReviewText, r.stars AS Stars
ORDER BY r.stars DESC
LIMIT 1",Pathfinding Queries,grandstack,False,False,False,
What are the addresses of businesses with reviews mentioning 'selection of books'?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.text CONTAINS 'selection of books'
RETURN b.address",Pathfinding Queries,grandstack,False,False,True,
Show all the businesses reviewed in September 2018.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2018-09-01') AND r.date <= date('2018-09-30')
RETURN b",Pathfinding Queries,grandstack,True,False,False,
Which reviews are for businesses in the same state as 'Zootown Brew'?,"MATCH (b:Business {name: 'Zootown Brew'})
WITH b.state AS zootownState
MATCH (review:Review)-[:REVIEWS]->(business:Business)
WHERE business.state = zootownState
RETURN review",Pathfinding Queries,grandstack,False,False,True,
Show the reviews for businesses with addresses on 'California Dr'.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.address = '723 California Dr'
RETURN r",Pathfinding Queries,grandstack,False,False,True,
List the reviews for businesses on 'N San Mateo Dr'.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.address = '716 N San Mateo Dr'
RETURN r",Pathfinding Queries,grandstack,False,False,True,
Which businesses have reviews with a text length over 100 characters?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE length(r.text) > 100
RETURN b",Pathfinding Queries,grandstack,False,False,True,
How many businesses have a review mentioning 'Wifi'?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.text CONTAINS 'Wifi'
RETURN count(DISTINCT b) AS NumberOfBusinessesWithWifiReviews",Pathfinding Queries,grandstack,False,False,True,
What are the categories for businesses in 'Burlingame'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Burlingame'
RETURN DISTINCT c.name",Pathfinding Queries,grandstack,False,False,False,
List the reviews from the latest to the earliest.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r.reviewId, r.date, r.text, r.stars, b.name AS businessName, u.name AS userName
ORDER BY r.date DESC",Pathfinding Queries,grandstack,False,False,True,
Which users have reviewed more than one business?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WITH u, count(DISTINCT b) AS businessesReviewed
WHERE businessesReviewed > 1
RETURN u.name AS UserName, businessesReviewed",Pathfinding Queries,grandstack,False,False,True,
What are the reviews for 'KettleHouse Brewing Co.'?,"MATCH (b:Business {name: 'KettleHouse Brewing Co.'})<-[:REVIEWS]-(r:Review)
RETURN r",Pathfinding Queries,grandstack,False,False,True,
Which businesses have reviews that mention 'IPA'?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.text CONTAINS 'IPA'
RETURN b",Pathfinding Queries,grandstack,False,False,True,
What categories have businesses with a location in 'Missoula'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Missoula'
RETURN DISTINCT c.name",Pathfinding Queries,grandstack,False,False,True,
Which businesses have reviews that mention 'car wash'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'car wash'
RETURN b.name, b.address",Pathfinding Queries,grandstack,False,False,True,
What are the categories of businesses on 'Broadway St'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address CONTAINS 'Broadway St'
RETURN DISTINCT c.name",Pathfinding Queries,grandstack,False,False,True,
List all reviews for businesses on 'W Pine St'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category), (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b)
WHERE b.address = '200 W Pine St'
RETURN r, b.name, c.name, u.name",Pathfinding Queries,grandstack,False,False,True,
Which users have written a review for 'Ninja Mike's'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {name: ""Ninja Mike's""})
RETURN u.name AS UserName",Pathfinding Queries,grandstack,False,False,True,
Find all reviews with a star rating of 5.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars = 5
RETURN u, r, b",Pathfinding Queries,grandstack,False,False,False,
Which business has the address '301 E Main St'?,"MATCH (b:Business {address: '301 E Main St'})
RETURN b",Pathfinding Queries,grandstack,False,False,True,
What are the names of businesses that have been reviewed by Jenny?,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN DISTINCT b.name",Pathfinding Queries,grandstack,False,False,True,
How many businesses are categorized as 'Library'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
RETURN count(b) AS NumberOfLibraries",Pathfinding Queries,grandstack,False,False,True,
What are the reviews for businesses located on 'W Broadway St'?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.address IN ['1151 W Broadway St', '121 W Broadway St']
RETURN b.name, r.text, r.date, r.stars",Pathfinding Queries,grandstack,False,False,True,
Which businesses have more than one review?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, count(r) AS reviewsCount
WHERE reviewsCount > 1
RETURN b",Pathfinding Queries,grandstack,True,False,False,
List all businesses in the state of California.,"MATCH (b:Business {state: 'CA'})
RETURN b",Pathfinding Queries,grandstack,False,False,True,
List the reviews made by Will.,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r, b",Pathfinding Queries,grandstack,False,False,True,
Which users have written reviews for businesses in San Mateo?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'San Mateo'})
RETURN DISTINCT u.name AS UserName",Pathfinding Queries,grandstack,False,False,True,
Show businesses within 1km of '301 E Main St'.,"MATCH (b:Business)
WHERE distance(b.location, point({address: '301 E Main St'})) <= 1000
RETURN b",Pathfinding Queries,grandstack,False,False,True,
Find users who have rated a business in 'Burlingame'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Burlingame'})
RETURN DISTINCT u",Pathfinding Queries,grandstack,False,False,True,
What categories include businesses from 'Missoula'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Missoula'
RETURN DISTINCT c.name",Pathfinding Queries,grandstack,False,False,True,
How many different categories are represented in businesses in California?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.state = 'CA'
RETURN COUNT(DISTINCT c) AS num_categories",Pathfinding Queries,grandstack,False,False,True,
Which business has the highest average star rating?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
RETURN b.name AS BusinessName, avg(r.stars) AS AverageStars
ORDER BY AverageStars DESC
LIMIT 1",Pathfinding Queries,grandstack,False,False,True,
List the top 3 most recent reviews.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r, u, b
ORDER BY r.date DESC
LIMIT 3",Pathfinding Queries,grandstack,False,False,True,
What is the address of 'Neo4j'?,"MATCH (b:Business {name: 'Neo4j'})
RETURN b.address",Pathfinding Queries,grandstack,False,False,True,
Which businesses are located in Missoula?,"MATCH (b:Business {city: 'Missoula'})
RETURN b",Pathfinding Queries,grandstack,False,False,False,
Find the businesses reviewed by users named Angie.,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b",Pathfinding Queries,grandstack,False,False,False,
Show all business addresses on 'E Front St'.,"MATCH (b:Business)
WHERE b.address CONTAINS 'E Front St'
RETURN b.address",Pathfinding Queries,grandstack,False,False,False,
List the businesses with a 'Library' category and their reviews.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
MATCH (r:Review)-[:REVIEWS]->(b)
RETURN b, r",Complex Retrieval Queries,grandstack,False,False,True,
Which businesses in 'Burlingame' have been reviewed by more than one user?,"MATCH (b:Business {city: 'Burlingame'})-[:REVIEWS]-(r:Review)-[:WROTE]-(u:User)
WITH b, count(DISTINCT u) AS userCount
WHERE userCount > 1
RETURN b.name, b.address",Pathfinding Queries,grandstack,True,False,False,
What are the reviews for businesses that have more than one category?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE exists {
  MATCH (b)-[:IN_CATEGORY]->(c1:Category),
        (b)-[:IN_CATEGORY]->(c2:Category)
  WHERE c1 <> c2
}
RETURN b.name, r.text, r.stars",Pathfinding Queries,grandstack,False,False,True,
List the businesses that have been categorized as 'Library' in California.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
WHERE b.state = 'CA'
RETURN b",Pathfinding Queries,grandstack,False,False,False,
Which reviews were written by users from 'CA'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.state = 'CA'
RETURN r",Pathfinding Queries,grandstack,False,False,True,
What are the businesses that have a POINT location within 1km of '301 E Main St'?,"MATCH (b:Business)
WHERE distance(b.location, point({address: '301 E Main St'})) <= 1000
RETURN b",Pathfinding Queries,grandstack,False,False,True,
Find the first 3 reviews with the highest star ratings.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r, u, b
ORDER BY r.stars DESC
LIMIT 3",Pathfinding Queries,grandstack,False,False,True,
Which business has the lowest number of reviews?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WITH b, count(r) AS reviewsCount
ORDER BY reviewsCount ASC
LIMIT 1
RETURN b.name AS BusinessName, reviewsCount",Pathfinding Queries,grandstack,False,False,True,
What are the names of all businesses reviewed by Bob?,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(:Review)-[:REVIEWS]->(b:Business)
RETURN DISTINCT b.name",Pathfinding Queries,grandstack,False,False,True,
How many categories have businesses in 'San Mateo'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'San Mateo'
RETURN count(DISTINCT c) AS NumberOfCategories",Pathfinding Queries,grandstack,False,False,True,
Which businesses have been reviewed in 2017?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2017-01-01') AND r.date <= date('2017-12-31')
RETURN b",Pathfinding Queries,grandstack,False,False,True,
List all reviews with a rating less than 4 stars.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars < 4
RETURN r, u, b",Pathfinding Queries,grandstack,False,False,True,
Which businesses are in the same city as 'Zootown Brew'?,"MATCH (b1:Business {name: 'Zootown Brew'})
MATCH (b2:Business)
WHERE b1.city = b2.city AND b1.name <> b2.name
RETURN b2",Pathfinding Queries,grandstack,False,False,True,
How many users have written reviews for 'Missoula Public Library'?,"MATCH (b:Business {name: 'Missoula Public Library'})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN count(DISTINCT u) AS NumberOfUsers",Pathfinding Queries,grandstack,False,False,True,
What is the text of the first review written in 2018?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date('2018-01-01') AND r.date < date('2019-01-01')
RETURN r.text
ORDER BY r.date ASC
LIMIT 1",Pathfinding Queries,grandstack,False,False,True,
List the businesses that have a review mentioning 'breakfast'.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'breakfast'
RETURN b",Pathfinding Queries,grandstack,False,False,True,
Which category does 'KettleHouse Brewing Co.' belong to?,"MATCH (b:Business {name: 'KettleHouse Brewing Co.'})-[:IN_CATEGORY]->(c:Category)
RETURN c.name",Pathfinding Queries,grandstack,False,False,True,
What is the address of the business with the most recent review?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
RETURN b.address AS Address
ORDER BY r.date DESC
LIMIT 1",Pathfinding Queries,grandstack,False,False,False,
"What are the business names of 'b1', 'b2', and 'b3'?","MATCH (b:Business)
WHERE b.businessId IN ['b1', 'b2', 'b3']
RETURN b.name",Pathfinding Queries,grandstack,False,False,True,
Show the reviews that mention 'full-service'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'full-service'
RETURN u, r, b",Pathfinding Queries,grandstack,True,False,False,
Which businesses have a review written on '2017-11-13'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE r.date = date('2017-11-13')
RETURN b.name, b.address, b.city, b.state",Pathfinding Queries,grandstack,True,False,False,
What are the names of businesses that have reviews with exactly 5 stars?,"MATCH (b:Business)-[:REVIEWS]->(r:Review {stars: 5.0})
RETURN DISTINCT b.name",Simple Aggregation Queries,grandstack,False,False,True,
Which users have reviewed businesses in 'San Mateo'?,"MATCH (u:User)-[:WROTE]->(:Review)-[:REVIEWS]->(b:Business {city: 'San Mateo'})
RETURN DISTINCT u.name AS UserName",Simple Aggregation Queries,grandstack,False,False,True,
Find the top 3 longest reviews in terms of text length.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r.reviewId, r.text, length(r.text) AS textLength, b.name
ORDER BY textLength DESC
LIMIT 3",Simple Aggregation Queries,grandstack,False,False,True,
Which business has the longest name and what is its location?,"MATCH (b:Business)
WITH b, length(b.name) AS nameLength
ORDER BY nameLength DESC
LIMIT 1
RETURN b.name AS BusinessName, b.location AS Location",Simple Aggregation Queries,grandstack,False,False,True,
How many categories are there for businesses in 'Missoula'?,"MATCH (b:Business {city: 'Missoula'})-[:IN_CATEGORY]->(c:Category)
RETURN count(DISTINCT c) AS NumberOfCategories",Simple Aggregation Queries,grandstack,False,False,True,
List the top 3 most recent reviews.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r, u, b
ORDER BY r.date DESC
LIMIT 3",Simple Aggregation Queries,grandstack,False,False,True,
What is the average number of stars given by each user?,"MATCH (u:User)-[:WROTE]->(r:Review)
RETURN u.name AS UserName, avg(r.stars) AS AverageStars",Simple Aggregation Queries,grandstack,False,False,True,
How many businesses are there in each city?,"MATCH (b:Business)
RETURN b.city, count(b) AS NumberOfBusinesses",Simple Aggregation Queries,grandstack,False,False,True,
Which business has the most diverse range of review star ratings?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WITH b, collect(DISTINCT r.stars) AS uniqueStars
RETURN b.name AS BusinessName, size(uniqueStars) AS Diversity
ORDER BY Diversity DESC
LIMIT 1",Simple Aggregation Queries,grandstack,False,False,True,
How many businesses are reviewed by users named 'Bob'?,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(:Review)-[:REVIEWS]->(b:Business)
RETURN count(DISTINCT b) AS NumberOfBusinessesReviewedByBob",Simple Aggregation Queries,grandstack,False,False,True,
What are the cities of the businesses reviewed by 'Angie'?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(:Review)-[:REVIEWS]->(b:Business)
RETURN DISTINCT b.city",Simple Aggregation Queries,grandstack,False,False,True,
Find the top 5 businesses with the lowest average stars rating.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WITH b, AVG(r.stars) AS avg_stars
ORDER BY avg_stars ASC
LIMIT 5
RETURN b.name, avg_stars",Simple Aggregation Queries,grandstack,False,False,True,
Which categories contain exactly three businesses?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WITH c, count(b) AS businessCount
WHERE businessCount = 3
RETURN c.name",Simple Aggregation Queries,grandstack,False,False,True,
List all businesses and their corresponding reviews from 'Burlingame'.,"MATCH (b:Business {city: 'Burlingame'})-[:REVIEWS]-(r:Review)
RETURN b, r",Simple Aggregation Queries,grandstack,False,False,False,
Which user has reviewed the most businesses in 'Beer' category?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Beer'})
WITH u, count(DISTINCT b) AS businessesReviewed
ORDER BY businessesReviewed DESC
LIMIT 1
RETURN u.name AS userName, businessesReviewed",Simple Aggregation Queries,grandstack,False,False,True,
What are the names of users who have reviewed 'Neo4j'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {name: 'Neo4j'})
RETURN u.name",Simple Aggregation Queries,grandstack,False,False,True,
List all reviews written in 2017.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date('2017-01-01') AND r.date <= date('2017-12-31')
RETURN r, u.name AS reviewer, b.name AS business",Simple Aggregation Queries,grandstack,False,False,False,
List the addresses of businesses that have no reviews.,"MATCH (b:Business)
WHERE NOT exists{ (:Review)-[:REVIEWS]->(b) }
RETURN b.address",Simple Aggregation Queries,grandstack,False,False,True,
List the names of all businesses in the 'Library' category.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
RETURN b.name",Simple Aggregation Queries,grandstack,False,False,True,
Which business in 'Missoula' has the highest star rating based on reviews?,"MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]-(r:Review)
RETURN b.name, avg(r.stars) AS average_rating
ORDER BY average_rating DESC
LIMIT 1",Simple Aggregation Queries,grandstack,False,False,False,
Show all reviews written by 'Jenny' for businesses in 'Coffee' category.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Coffee'})
RETURN r, b",Complex Retrieval Queries,grandstack,False,False,True,
Find the businesses in 'Burlingame' that are located on 'California Dr' and their categories.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Burlingame' AND b.address CONTAINS 'California Dr'
RETURN b.name, b.address, c.name",Complex Retrieval Queries,grandstack,False,False,False,
List all reviews for businesses in 'San Mateo' with a review text containing 'leading'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category), (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'San Mateo' AND r.text CONTAINS 'leading'
RETURN r, b, c, u",Complex Retrieval Queries,grandstack,False,False,True,
Display the names and addresses of businesses in 'MT' with reviews dated before 2017.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.state = 'MT' AND r.date < date('2017-01-01')
RETURN b.name, b.address",Complex Retrieval Queries,grandstack,False,False,True,
What are the businesses located at '200 W Pine St' and their reviews?,"MATCH (b:Business {address: '200 W Pine St'})-[:REVIEWS]-(r:Review)
RETURN b, r",Complex Retrieval Queries,grandstack,False,False,True,
Which businesses in 'CA' have a 'Coffee' category and what are their review ratings?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Coffee'})
WHERE b.state = 'CA'
MATCH (r:Review)-[:REVIEWS]->(b)
RETURN b.name, b.address, r.stars",Complex Retrieval Queries,grandstack,False,False,True,
Which businesses are located in Missoula and in the 'Beer' category?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Missoula' AND c.name = 'Beer'
RETURN b",Simple Aggregation Queries,grandstack,False,False,True,
What is the text of the review with the lowest stars rating?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r.text AS review_text
ORDER BY r.stars ASC
LIMIT 1",Simple Aggregation Queries,grandstack,False,False,True,
List the top 5 reviews with the highest stars rating.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r.reviewId, r.text, r.stars, b.name, u.name
ORDER BY r.stars DESC
LIMIT 5",Simple Aggregation Queries,grandstack,False,False,True,
What are the addresses of businesses reviewed by user 'Will'?,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.address AS BusinessAddress",Simple Aggregation Queries,grandstack,False,False,True,
Find the top 3 businesses with the highest number of reviews.,"MATCH (b:Business)<-[:REVIEWS]-(:Review)
WITH b, count(*) AS reviewsCount
ORDER BY reviewsCount DESC
LIMIT 3
RETURN b.name, b.businessId, reviewsCount",Simple Aggregation Queries,grandstack,False,False,True,
Which business has the most reviews in San Mateo?,"MATCH (b:Business {city: 'San Mateo'})-[:REVIEWS]-(r:Review)
RETURN b.name, count(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 1",Simple Aggregation Queries,grandstack,False,False,True,
List all the businesses along 'W Broadway St' and their categories.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address CONTAINS 'W Broadway St'
RETURN b.name, b.address, c.name",Simple Aggregation Queries,grandstack,False,False,True,
What is the average stars rating for businesses in Burlingame?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.city = 'Burlingame'
RETURN AVG(r.stars) AS average_stars_rating",Simple Aggregation Queries,grandstack,False,False,True,
How many reviews have been written for 'KettleHouse Brewing Co.'?,"MATCH (b:Business {name: 'KettleHouse Brewing Co.'})<-[:REVIEWS]-(r:Review)
RETURN count(r) AS NumberOfReviews",Simple Aggregation Queries,grandstack,False,False,True,
List the top 3 users by the number of reviews they have written.,"MATCH (u:User)-[:WROTE]->(r:Review)
WITH u, count(r) AS reviewsCount
ORDER BY reviewsCount DESC
LIMIT 3
RETURN u.name, reviewsCount",Simple Aggregation Queries,grandstack,False,False,True,
Which users have written more than one review?,"MATCH (u:User)-[:WROTE]->(r:Review)
WITH u, count(r) AS reviewsCount
WHERE reviewsCount > 1
RETURN u",Simple Aggregation Queries,grandstack,False,False,False,
List all the categories represented by businesses in 'San Mateo'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'San Mateo'
RETURN DISTINCT c.name",Pathfinding Queries,grandstack,True,False,False,
Which business in 'San Mateo' has reviews with an average star rating above 4.5?,"MATCH (b:Business {city: 'San Mateo'})-[:REVIEWS]-(r:Review)
WITH b, AVG(r.stars) AS avgRating
WHERE avgRating > 4.5
RETURN b.name, avgRating",Simple Aggregation Queries,grandstack,False,False,True,
What is the total number of reviews written in 2016?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date('2016-01-01') AND r.date <= date('2016-12-31')
RETURN count(r) AS TotalReviewsIn2016",Simple Aggregation Queries,grandstack,False,False,True,
What are the reviews mentioning 'farmer's market'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS ""farmer's market""
RETURN r, u.name AS reviewer, b.name AS business",Pathfinding Queries,grandstack,False,False,False,
Find all businesses within 2km of '716 N San Mateo Dr'.,"MATCH (b:Business {address: '716 N San Mateo Dr'})
WITH b.location AS referenceLocation
MATCH (nearby:Business)
WHERE distance(nearby.location, referenceLocation) <= 2000
RETURN nearby",Pathfinding Queries,grandstack,False,False,True,
Which business has the most categories associated with it?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WITH b, count(c) AS num_categories
ORDER BY num_categories DESC
LIMIT 1
RETURN b.name AS business_name, num_categories",Pathfinding Queries,grandstack,False,False,False,
List the reviews written by users in 'MT'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.state = 'MT'
RETURN r",Pathfinding Queries,grandstack,False,False,True,
Show the businesses that have been reviewed by users named Bob and have a star rating above 4.,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars > 4
RETURN b",Pathfinding Queries,grandstack,False,False,False,
List the reviews for businesses that have been reviewed exactly twice.,"MATCH (b:Business)
WITH b, count{(b)<-[:REVIEWS]-(:Review)} AS reviewCount
WHERE reviewCount = 2
MATCH (b)<-[:REVIEWS]-(r:Review)
RETURN b.name, r.text, r.date, r.stars",Pathfinding Queries,grandstack,False,False,True,
Which businesses have reviews mentioning 'world leading'?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.text CONTAINS 'world leading'
RETURN b",Pathfinding Queries,grandstack,False,False,True,
What is the city of the business named 'Zootown Brew'?,"MATCH (b:Business {name: 'Zootown Brew'})
RETURN b.city AS City",Pathfinding Queries,grandstack,False,False,True,
Which businesses have a user review mentioning 'comfortable places'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)-[:WROTE]->(u:User)
WHERE r.text CONTAINS 'comfortable places'
RETURN b.name, b.address, b.city, b.state",Pathfinding Queries,grandstack,False,False,True,
How many businesses in 'MT' have been reviewed more than once?,"MATCH (b:Business {state: 'MT'})-[:REVIEWS]->(r:Review)
WITH b, count(r) AS reviewsCount
WHERE reviewsCount > 1
RETURN count(b) AS businessesReviewedMoreThanOnce",Simple Aggregation Queries,grandstack,False,False,True,
What are the cities with businesses that have been reviewed exactly twice?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WITH b.city AS city, count(r) AS reviewsCount
WHERE reviewsCount = 2
RETURN DISTINCT city",Simple Aggregation Queries,grandstack,False,False,True,
Which user's reviews have the highest average stars rating?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WITH u, AVG(r.stars) AS avg_stars
ORDER BY avg_stars DESC
LIMIT 1
RETURN u.name AS user, avg_stars",Simple Aggregation Queries,grandstack,False,False,False,
How many reviews are there with a stars rating exactly 3.5?,"MATCH (r:Review)
WHERE r.stars = 3.5
RETURN count(r) AS NumberOfReviews",Simple Aggregation Queries,grandstack,True,False,False,
Which reviews mention 'great selection'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'great selection'
RETURN r, u.name AS reviewer, b.name AS business",Pathfinding Queries,grandstack,False,False,False,
List all businesses with more than one category.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WITH b, count(c) AS numCategories
WHERE numCategories > 1
RETURN b",Simple Aggregation Queries,grandstack,False,False,True,
Which users have not written any reviews?,"MATCH (u:User)
WHERE NOT exists{ (u)-[:WROTE]->(:Review) }
RETURN u",Simple Aggregation Queries,grandstack,False,False,True,
Find the top 3 shortest reviews in terms of text length.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r.reviewId, r.text, b.name
ORDER BY length(r.text) ASC
LIMIT 3",Simple Aggregation Queries,grandstack,False,False,False,
Find the top 3 businesses with the most diverse range of star ratings in their reviews.,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WITH b, collect(DISTINCT r.stars) AS uniqueStars
ORDER BY size(uniqueStars) DESC
RETURN b.name, uniqueStars
LIMIT 3",Simple Aggregation Queries,grandstack,False,False,True,
Which user has given the lowest average star rating?,"MATCH (u:User)-[:WROTE]->(r:Review)
WITH u, AVG(r.stars) AS avg_stars
ORDER BY avg_stars ASC
LIMIT 1
RETURN u.name AS user, avg_stars",Simple Aggregation Queries,grandstack,False,False,True,
List all reviews that have exactly 4.0 stars.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars = 4.0
RETURN u, r, b",Simple Aggregation Queries,grandstack,False,False,True,
Which business located on 'E Front St' has the highest number of reviews?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE b.address CONTAINS 'E Front St'
WITH b, count(r) AS reviewsCount
RETURN b.name, b.address, reviewsCount
ORDER BY reviewsCount DESC
LIMIT 1",Simple Aggregation Queries,grandstack,False,False,True,
How many businesses are there in 'CA' with a perfect 5-star review?,"MATCH (b:Business {state: 'CA'})-[:REVIEWS]-(r:Review {stars: 5.0})
RETURN count(DISTINCT b) AS NumberOfBusinessesWithPerfectReviews",Simple Aggregation Queries,grandstack,False,False,True,
What are the categories of businesses located on 'Main St'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address CONTAINS 'Main St'
RETURN DISTINCT c.name",Simple Aggregation Queries,grandstack,False,False,True,
Which reviews mention 'selection' in their text?,"MATCH (r:Review)
WHERE r.text CONTAINS 'selection'
RETURN r",Simple Aggregation Queries,grandstack,False,False,True,
What are the names of all categories a business in '200 W Pine St' belongs to?,"MATCH (b:Business {address: '200 W Pine St'})-[:IN_CATEGORY]->(c:Category)
RETURN c.name",Simple Aggregation Queries,grandstack,False,False,True,
What is the city with the least number of businesses?,"MATCH (b:Business)
WITH b.city AS city, count(b) AS numBusinesses
ORDER BY numBusinesses ASC
LIMIT 1
RETURN city",Simple Aggregation Queries,grandstack,False,False,True,
How many businesses have reviews with stars rating less than 4.0?,"MATCH (b:Business)-[:REVIEWS]->(r:Review)
WHERE r.stars < 4.0
RETURN count(DISTINCT b) AS businesses_with_low_ratings",Simple Aggregation Queries,grandstack,True,False,False,
Name the first 3 people born before 1970 who produced a movie released after 2000.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.born < 1970 AND m.released > 2000
RETURN p.name
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
Which movies released between 2005 and 2010 have the tagline 'Speed has no limits'?,"MATCH (m:Movie)
WHERE m.released >= 2005 AND m.released <= 2010 AND m.tagline = 'Speed has no limits'
RETURN m.title, m.released",Simple Retrieval Queries,movies,False,False,False,
Who are the top 3 people born after 1960 who have directed a movie titled 'V for Vendetta'?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie {title: 'V for Vendetta'})
WHERE p.born > 1960
RETURN p
ORDER BY p.born
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
Which top 3 movies have been both produced and reviewed by the same person?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:REVIEWED]-(p)
RETURN m.title AS Movie, m.released AS ReleaseYear, collect(p.name) AS ProducersReviewers
ORDER BY m.votes DESC
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
"Name the first 3 people who have reviewed a movie with a summary stating 'Silly, but fun'.","MATCH (p:Person)-[:REVIEWED {summary: 'Silly, but fun'}]->(:Movie)
RETURN p.name
LIMIT 3",Simple Retrieval Queries,movies,False,False,False,
List the top 5 movies with a tagline mentioning 'compelling' and having more than 50 votes.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'compelling' AND m.votes > 50
RETURN m
ORDER BY m.votes DESC
LIMIT 5",Simple Retrieval Queries,movies,False,False,False,
Who are the top 3 persons who have both directed and produced the same movie?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:PRODUCED]-(p)
RETURN p.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3",Simple Retrieval Queries,movies,False,False,False,
List the first 3 movies directed by persons who were born after 1950 and before 1960.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born > 1950 AND p.born < 1960
RETURN m.title, m.released
ORDER BY m.released
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
What are the names of the top 5 people who acted in and also reviewed the same movie?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:REVIEWED]-(p)
RETURN p.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 5",Simple Retrieval Queries,movies,True,False,False,
Which top 5 movies received the highest ratings in reviews written by someone born in 1965?,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)
WHERE p.born = 1965
RETURN m.title AS Movie, max(p.rating) AS Rating
ORDER BY Rating DESC
LIMIT 5",Simple Retrieval Queries,movies,False,False,False,Person.rating
List the first 5 movies that have been acted in by someone with the role 'Captain' and reviewed with a rating below 60.,"MATCH (p:Person)-[a:ACTED_IN]->(m:Movie), (r:Person)-[rev:REVIEWED]->(m)
WHERE 'Captain' IN a.roles AND rev.rating < 60
RETURN m.title AS MovieTitle, m.released AS ReleaseYear, rev.summary AS ReviewSummary, rev.rating AS ReviewRating
LIMIT 5",Simple Retrieval Queries,movies,False,False,True,
List the first 3 movies with a tagline containing the word 'real' and released before 2000.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'real' AND m.released < 2000
RETURN m
ORDER BY m.released
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
Who has the longest name among all actors?,"MATCH (p:Person)-[:ACTED_IN]->(:Movie)
RETURN p.name AS ActorName
ORDER BY length(p.name) DESC
LIMIT 1",Complex Retrieval Queries,movies,False,False,False,
List the movies with exactly two roles in their ACTED_IN relationships.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE size(r.roles) = 2
RETURN m.title AS Movie, collect(p.name) AS Actors",Complex Retrieval Queries,movies,False,False,False,
What are the highest-rated reviews and which movies do they belong to?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
RETURN m.title AS Movie, r.summary AS Review, r.rating AS Rating
ORDER BY r.rating DESC",Complex Retrieval Queries,movies,False,False,True,
List all the movies reviewed with a rating above 80.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating > 80
RETURN m.title, r.summary, r.rating",Complex Retrieval Queries,movies,False,False,True,
Who has reviewed 'Speed Racer' and what was their rating?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie {title: 'Speed Racer'})
RETURN p.name AS reviewer, r.rating AS rating",Complex Retrieval Queries,movies,False,False,True,
Find all the people who follow Keanu Reeves.,"MATCH (p:Person)-[:FOLLOWS]->(:Person {name: ""Keanu Reeves""})
RETURN p",Complex Retrieval Queries,movies,False,False,True,
Who are the top 5 oldest actors in the database?,"MATCH (p:Person)-[:ACTED_IN]->(:Movie)
RETURN p.name, p.born
ORDER BY p.born ASC
LIMIT 5",Complex Retrieval Queries,movies,False,False,True,
List all the movies reviewed with the summary 'An amazing journey'.,"MATCH (m:Movie)<-[:REVIEWED {summary: 'An amazing journey'}]-(:Person)
RETURN m",Complex Retrieval Queries,movies,False,False,True,
Which person wrote the most movies?,"MATCH (p:Person)-[:WROTE]->(m:Movie)
WITH p, count(m) AS movies_written
ORDER BY movies_written DESC
LIMIT 1
RETURN p.name AS writer, movies_written",Complex Retrieval Queries,movies,False,False,True,
Who produced the most movies released after 2000?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE m.released > 2000
RETURN p.name, count(m) AS movies_produced
ORDER BY movies_produced DESC
LIMIT 1",Complex Retrieval Queries,movies,False,False,True,
List all movies with a release year in the 1980s.,"MATCH (m:Movie)
WHERE m.released >= 1980 AND m.released <= 1989
RETURN m",Complex Retrieval Queries,movies,False,False,True,
Who directed 'Speed Racer'?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie {title: 'Speed Racer'})
RETURN p.name",Complex Retrieval Queries,movies,False,False,False,
Find all actors born in the 1960s.,"MATCH (p:Person)-[:ACTED_IN]->(:Movie)
WHERE p.born >= 1960 AND p.born <= 1969
RETURN p",Complex Retrieval Queries,movies,True,False,False,
Who reviewed the most movies?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
RETURN p.name, count(m) AS movies_reviewed
ORDER BY movies_reviewed DESC
LIMIT 1",Complex Retrieval Queries,movies,False,False,True,
What are the different roles played by Laurence Fishburne in his career?,"MATCH (p:Person {name: ""Laurence Fishburne""})-[:ACTED_IN]->(m:Movie)
RETURN m.title AS Movie, p.roles AS Roles",Complex Retrieval Queries,movies,False,False,True,Person.roles
"List top 3 people who have directed, produced, and acted in the same movie.","MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:PRODUCED]-(p)-[:ACTED_IN]->(m)
RETURN p.name, collect(m.title) AS movies
ORDER BY size(movies) DESC
LIMIT 3",Complex Retrieval Queries,movies,False,False,True,
Which movies have taglines longer than 30 characters?,"MATCH (m:Movie)
WHERE length(m.tagline) > 30
RETURN m.title, m.tagline",Complex Retrieval Queries,movies,False,False,True,
List all relationships of Lana Wachowski.,"MATCH (p:Person {name: ""Lana Wachowski""})-[r]->(m)
RETURN p, r, m",Complex Retrieval Queries,movies,False,False,True,
Find movies with fewer than 50 votes.,"MATCH (m:Movie)
WHERE m.votes < 50
RETURN m",Complex Retrieval Queries,movies,True,False,False,
Which movies were produced by Joel Silver?,"MATCH (p:Person {name: ""Joel Silver""})-[:PRODUCED]->(m:Movie)
RETURN m.title AS MovieTitle, m.released AS ReleaseYear",Complex Retrieval Queries,movies,False,False,False,
Who has the highest number of follows among persons?,"MATCH (p:Person)
RETURN p.name AS PersonName, count{(p)-[:FOLLOWS]->(:Person)} AS FollowsCount
ORDER BY FollowsCount DESC
LIMIT 1",Complex Retrieval Queries,movies,False,False,True,
List movies with a tagline that includes the word 'world'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'world'
RETURN m",Complex Retrieval Queries,movies,False,False,False,
What are the roles of Keanu Reeves in 'The Matrix'?,"MATCH (p:Person {name: ""Keanu Reeves""})-[:ACTED_IN {roles: roles}]->(m:Movie {title: ""The Matrix""})
RETURN roles",Complex Retrieval Queries,movies,False,False,True,
List the first 5 people who wrote a movie with a rating of at least 80 in a review.,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:REVIEWED]-(reviewer:Person)
WHERE reviewer.rating >= 80
RETURN p.name AS Writer, m.title AS Movie
LIMIT 5",Simple Retrieval Queries,movies,False,False,True,Person.rating
List the first 3 movies with a tagline containing 'limits' and released after 2005.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'limits' AND m.released > 2005
RETURN m
ORDER BY m.released
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
What are the names of the top 5 people who have followed more than three other persons?,"MATCH (p:Person)-[:FOLLOWS]->(other:Person)
WITH p, count(other) AS followsCount
WHERE followsCount > 3
RETURN p.name
ORDER BY followsCount DESC
LIMIT 5",Simple Retrieval Queries,movies,False,False,False,
List the top 5 persons who reviewed movies with a summary stating 'An amazing journey' and a rating above 80.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.summary = 'An amazing journey' AND r.rating > 80
RETURN p.name, r.summary, r.rating
ORDER BY r.rating DESC
LIMIT 5",Simple Retrieval Queries,movies,False,False,False,
Who are the top 3 people who have acted in at least two movies with more than 100 votes each?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.votes > 100
WITH p, count(m) AS moviesCount
WHERE moviesCount >= 2
RETURN p.name
ORDER BY moviesCount DESC
LIMIT 3",Simple Retrieval Queries,movies,False,False,False,
List the first 5 movies where the tagline includes the word 'Houston' and the released year is before 2000.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'Houston' AND m.released < 2000
RETURN m
LIMIT 5",Simple Retrieval Queries,movies,False,False,False,
Name the first 3 people born before 1950 who have written a movie with a tagline mentioning 'journey'.,"MATCH (p:Person)-[:WROTE]->(m:Movie)
WHERE p.born < 1950 AND m.tagline CONTAINS 'journey'
RETURN p.name
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
Which top 5 movies released between 1980 and 1990 have been reviewed with a summary mentioning 'compelling'?,"MATCH (m:Movie)<-[:REVIEWED {summary: 'Dark, but compelling'}]-(p:Person)
WHERE m.released >= 1980 AND m.released <= 1990
RETURN m.title, m.released
ORDER BY m.votes DESC
LIMIT 5",Simple Retrieval Queries,movies,False,False,False,
List the first 3 persons who have produced a movie with a tagline including 'real world' and released after 1995.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE m.tagline CONTAINS 'real world' AND m.released > 1995
RETURN p
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
Who are the top 3 directors of movies that have been reviewed with a summary stating 'Pretty funny at times'?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)<-[:REVIEWED]-(p:Person)
WHERE m.released IS NOT NULL AND p.summary = 'Pretty funny at times'
RETURN d.name AS Director, count(m) AS MoviesDirected
ORDER BY MoviesDirected DESC
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,Person.summary
List the top 5 movies that have been directed by someone born in 1967.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born = 1967
RETURN m
ORDER BY m.released DESC
LIMIT 5",Simple Retrieval Queries,movies,False,False,True,
Name the first 3 people who have reviewed a movie with a tagline stating 'Welcome to the Real World'.,"MATCH (p:Person)-[:REVIEWED]->(m:Movie {tagline: 'Welcome to the Real World'})
RETURN p.name
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
Which movies have more than 1000 votes?,"MATCH (m:Movie)
WHERE m.votes > 1000
RETURN m.title, m.votes",Complex Retrieval Queries,movies,False,False,True,
List all movies released after 2000.,"MATCH (m:Movie)
WHERE m.released > 2000
RETURN m",Complex Retrieval Queries,movies,False,False,True,
Who acted in 'The Matrix'?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie {title: 'The Matrix'})
RETURN p.name",Complex Retrieval Queries,movies,False,False,True,
Find all directors of movies released before 1990.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.released < 1990
RETURN p.name, m.title, m.released",Complex Retrieval Queries,movies,False,False,True,
Which persons have a birth year after 1950?,"MATCH (p:Person)
WHERE p.born > 1950
RETURN p",Complex Retrieval Queries,movies,False,False,True,
How many movies has Keanu Reeves acted in?,"MATCH (p:Person {name: ""Keanu Reeves""})-[:ACTED_IN]->(m:Movie)
RETURN count(m) AS NumberOfMovies",Complex Retrieval Queries,movies,False,False,True,
List all movies that were both acted in and directed by the same person.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS MovieTitle, p.name AS PersonName",Complex Retrieval Queries,movies,False,False,True,
"Which movies have been reviewed with the summary 'Dark, but compelling'?","MATCH (m:Movie)<-[:REVIEWED {summary: 'Dark, but compelling'}]-(:Person)
RETURN m.title AS MovieTitle",Complex Retrieval Queries,movies,False,False,True,
Who was born in 1965 and has directed a movie?,"MATCH (p:Person {born: 1965})-[:DIRECTED]->(m:Movie)
RETURN p.name, m.title",Complex Retrieval Queries,movies,False,False,False,
Which directors have also acted in the movies they directed?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE exists{ (p)-[:ACTED_IN]->(m) }
RETURN p.name AS Director, m.title AS Movie",Complex Retrieval Queries,movies,False,False,True,
List the top 5 movies with the lowest votes.,"MATCH (m:Movie)
WHERE m.votes IS NOT NULL
RETURN m
ORDER BY m.votes ASC
LIMIT 5",Complex Retrieval Queries,movies,False,False,True,
Who has produced and written the same movie?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:WROTE]-(p)
RETURN p.name, m.title",Complex Retrieval Queries,movies,False,False,False,
Find the youngest person who has reviewed a movie released before 1990.,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)
WHERE m.released < 1990
RETURN p
ORDER BY p.born DESC
LIMIT 1",Complex Retrieval Queries,movies,False,False,True,
Who has acted in the most movies released in the 1990s?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.released >= 1990 AND m.released < 2000
WITH p, count(m) AS movies_count
RETURN p.name AS actor, movies_count
ORDER BY movies_count DESC
LIMIT 1",Complex Retrieval Queries,movies,False,False,True,
List all movies where the producer and director are the same person.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS MovieTitle, p.name AS ProducerDirector",Complex Retrieval Queries,movies,False,False,True,
Which person reviewed 'The Matrix Revolutions' and what was their summary?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie {title: 'The Matrix Revolutions'})
RETURN p.name, r.summary",Complex Retrieval Queries,movies,False,False,True,
Who are the people who have not acted in any movie?,"MATCH (p:Person)
WHERE NOT exists{ (p)-[:ACTED_IN]->(:Movie) }
RETURN p",Complex Retrieval Queries,movies,False,False,True,
List the movies that have been reviewed with a rating less than 50.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating < 50
RETURN m.title, r.summary, r.rating",Complex Retrieval Queries,movies,False,False,False,
Who directed the oldest movie in the database?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
RETURN p.name AS Director, m.title AS Movie, m.released AS Year
ORDER BY m.released ASC
LIMIT 1",Complex Retrieval Queries,movies,False,False,True,
List all movies with taglines that start with 'The'.,"MATCH (m:Movie)
WHERE m.tagline STARTS WITH 'The'
RETURN m.title, m.tagline, m.released",Complex Retrieval Queries,movies,False,False,False,
Who has the most followers?,"MATCH (p:Person)
RETURN p.name AS person_name, count{(p)<-[:FOLLOWS]-(:Person)} AS followers_count
ORDER BY followers_count DESC
LIMIT 1",Complex Retrieval Queries,movies,False,False,False,
List top 5 movies reviewed by persons born before 1970.,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)
WHERE p.born < 1970
RETURN m.title, m.released, m.tagline, m.votes
ORDER BY m.votes DESC
LIMIT 5",Complex Retrieval Queries,movies,False,False,False,
Who has written the most movies released after 2000?,"MATCH (p:Person)-[:WROTE]->(m:Movie)
WHERE m.released > 2000
WITH p, count(m) AS movies_written
ORDER BY movies_written DESC
LIMIT 1
RETURN p.name, movies_written",Complex Retrieval Queries,movies,False,False,True,
List all movies where the same person has acted and produced.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie), (p)-[:PRODUCED]->(m)
RETURN m.title AS MovieTitle, m.released AS ReleaseYear",Complex Retrieval Queries,movies,False,False,True,
Which movies have been reviewed by persons following Keanu Reeves?,"MATCH (follower:Person)-[:FOLLOWS]->(:Person {name: ""Keanu Reeves""})
MATCH (follower)-[:REVIEWED]->(movie:Movie)
RETURN movie.title AS MovieTitle, movie.released AS ReleaseYear",Complex Retrieval Queries,movies,False,False,True,
Who has directed and reviewed the same movie?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:REVIEWED]-(p)
RETURN p.name, m.title",Complex Retrieval Queries,movies,False,False,False,
List all movies with a 'Pretty funny at times' review summary.,"MATCH (m:Movie)<-[:REVIEWED {summary: 'Pretty funny at times'}]-(p:Person)
RETURN m.title AS MovieTitle, m.released AS ReleaseYear",Complex Retrieval Queries,movies,False,False,True,
Who has the most diverse roles across different movies?,"MATCH (p:Person)-[a:ACTED_IN]->(m:Movie)
WITH p, count(DISTINCT a.roles) AS diversity
ORDER BY diversity DESC
LIMIT 1
RETURN p.name AS Actor, diversity AS RoleDiversity",Complex Retrieval Queries,movies,False,False,False,
Find all persons born in 1996.,"MATCH (p:Person)
WHERE p.born = 1996
RETURN p",Complex Retrieval Queries,movies,False,False,False,
List all persons who have directed and reviewed the same movie.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:REVIEWED]-(p)
RETURN p.name, m.title",Complex Retrieval Queries,movies,False,False,True,
List all movies with a released year divisible by 10.,"MATCH (m:Movie)
WHERE m.released % 10 = 0
RETURN m",Complex Retrieval Queries,movies,False,False,True,
What are the summaries of reviews for movies released before 1985?,"MATCH (m:Movie)<-[:REVIEWED]-(p:Person)
WHERE m.released < 1985
RETURN m.title AS Movie, p.name AS Reviewer, m.released AS ReleaseYear, collect(p.summary) AS ReviewSummaries",Complex Retrieval Queries,movies,True,False,False,Person.summary
"Who has acted in, directed, and produced the same movie?","MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
MATCH (p)-[:DIRECTED]->(m)
MATCH (p)-[:PRODUCED]->(m)
RETURN p.name, m.title",Complex Retrieval Queries,movies,False,False,True,
List all movies with more than 3 roles listed in their ACTED_IN relationships.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE size(r.roles) > 3
RETURN m.title, collect(p.name) AS actors, r.roles",Complex Retrieval Queries,movies,False,False,True,
Who has produced movies but never acted in any?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE NOT exists{ (p)-[:ACTED_IN]->(:Movie) }
RETURN p.name",Complex Retrieval Queries,movies,False,False,True,
What roles did Laurence Fishburne play in 'The Matrix Revolutions'?,"MATCH (p:Person {name: ""Laurence Fishburne""})-[:ACTED_IN {roles: roles}]->(m:Movie {title: ""The Matrix Revolutions""})
RETURN roles",Complex Retrieval Queries,movies,False,False,True,
List the movies where the actors were born before 1950.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born < 1950
RETURN m.title, m.released",Complex Retrieval Queries,movies,False,False,True,
Who are the top 5 youngest producers?,"MATCH (p:Person)-[:PRODUCED]->(:Movie)
RETURN p.name, p.born
ORDER BY p.born DESC
LIMIT 5",Complex Retrieval Queries,movies,False,False,True,
"Who has the most movies with a 'Silly, but fun' review summary?","MATCH (p:Person)-[:REVIEWED {summary: 'Silly, but fun'}]->(m:Movie)
WITH p, count(m) AS moviesCount
RETURN p.name AS reviewer, moviesCount
ORDER BY moviesCount DESC
LIMIT 1",Complex Retrieval Queries,movies,True,False,False,
"List all movies that have a 'Fun, but a little far fetched' review summary.","MATCH (p:Person)-[r:REVIEWED {summary: 'Fun, but a little far fetched'}]->(m:Movie)
RETURN m",Complex Retrieval Queries,movies,False,False,False,
List the movies directed by persons born after 1960.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born > 1960
RETURN m.title, m.released",Complex Retrieval Queries,movies,False,False,True,
Who has the most roles in a single movie?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
RETURN p.name, m.title, size(r.roles) AS num_roles
ORDER BY num_roles DESC
LIMIT 1",Complex Retrieval Queries,movies,False,False,True,
List all movie titles with exactly one word in the title.,"MATCH (m:Movie)
WHERE m.title IS NOT NULL AND NOT CONTAINS(m.title, ' ')
RETURN m.title",Complex Retrieval Queries,movies,True,False,False,
Find all movies where Joel Silver acted.,"MATCH (p:Person {name: ""Joel Silver""})-[:ACTED_IN]->(m:Movie)
RETURN m",Complex Retrieval Queries,movies,False,False,True,
Who are the top 3 youngest directors?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
RETURN p.name, p.born
ORDER BY p.born DESC
LIMIT 3",Complex Retrieval Queries,movies,False,False,False,
List all persons who have not reviewed any movies.,"MATCH (p:Person)
WHERE NOT exists{ (p)-[:REVIEWED]->(:Movie) }
RETURN p",Complex Retrieval Queries,movies,False,False,True,
Who has produced the highest-rated reviewed movie?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:REVIEWED]-(reviewer)
RETURN p.name AS Producer, m.title AS Movie, MAX(review.rating) AS HighestRating
ORDER BY HighestRating DESC
LIMIT 1",Complex Retrieval Queries,movies,False,False,True,
What are the top 5 most frequently appearing review summaries?,"MATCH (:Person)-[r:REVIEWED]->(:Movie)
RETURN r.summary AS ReviewSummary, count(r) AS Count
ORDER BY Count DESC
LIMIT 5",Complex Retrieval Queries,movies,False,False,True,
Which people have reviewed the movie with the highest votes?,"MATCH (m:Movie)
WITH m ORDER BY m.votes DESC LIMIT 1
MATCH (p:Person)-[:REVIEWED]->(m)
RETURN p.name",Complex Retrieval Queries,movies,False,False,True,
Who are the top 3 producers of movies with a tagline including 'Speed'?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE m.tagline CONTAINS 'Speed'
RETURN p.name, count(m) AS movies_produced
ORDER BY movies_produced DESC
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
Who has directed the most movies with a tagline containing 'limit'?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.tagline CONTAINS 'limit'
WITH p, count(m) AS moviesDirected
ORDER BY moviesDirected DESC
LIMIT 1
RETURN p.name, moviesDirected",Complex Retrieval Queries,movies,False,False,True,
List the first 3 people who acted in a movie released in 2012.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie {released: 2012})
RETURN p.name
LIMIT 3",Simple Retrieval Queries,movies,False,False,False,
Who are the first 3 actors in the movie titled 'Speed Racer'?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie {title: 'Speed Racer'})
RETURN p.name, r.roles
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
List all the relationships a person named 'Keanu Reeves' has with movies.,"MATCH (p:Person {name: 'Keanu Reeves'})-[r]->(m:Movie)
RETURN p, r, m",Simple Retrieval Queries,movies,False,False,True,
Show the top 5 movies by the number of reviews they received.,"MATCH (m:Movie)<-[:REVIEWED]-(:Person)
RETURN m.title, count(*) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 5",Simple Retrieval Queries,movies,False,False,True,
Which people have produced and also reviewed the same movie?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:REVIEWED]-(p)
RETURN p.name, m.title",Simple Retrieval Queries,movies,False,False,True,
List the first 3 people who have directed and written the same movie.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:WROTE]-(p)
RETURN p.name, m.title
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
What are the birth years of people who have acted in movies released before 1980?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.released < 1980
RETURN DISTINCT p.born AS BirthYear",Simple Retrieval Queries,movies,False,False,True,
Which movie has the lowest number of votes and was released after 2000?,"MATCH (m:Movie)
WHERE m.released > 2000
RETURN m
ORDER BY m.votes ASC
LIMIT 1",Simple Retrieval Queries,movies,False,False,True,
Find all movies that have been produced by persons born after 1960 limited to top 5.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.born > 1960
RETURN m
ORDER BY m.released DESC
LIMIT 5",Simple Retrieval Queries,movies,False,False,True,
"Who are the first 3 people to have reviewed a movie with the summary 'Silly, but fun'?","MATCH (p:Person)-[:REVIEWED {summary: 'Silly, but fun'}]->(:Movie)
RETURN p.name
LIMIT 3",Simple Retrieval Queries,movies,False,False,False,
What are the first 3 movies with a tagline containing the word 'limits'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'limits'
RETURN m
ORDER BY m.released
LIMIT 3",Simple Retrieval Queries,movies,False,False,False,
List all movies with a tagline that includes the phrase 'Real World'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'Real World'
RETURN m",Simple Retrieval Queries,movies,False,False,True,
Show the top 5 movies with the most roles in their cast.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WITH m, count(r.roles) AS totalRoles
ORDER BY totalRoles DESC
LIMIT 5
RETURN m.title, totalRoles",Simple Retrieval Queries,movies,False,False,False,
"Which person has acted in, directed, and produced the same movie?","MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
MATCH (p)-[:DIRECTED]->(m)
MATCH (p)-[:PRODUCED]->(m)
RETURN p.name, m.title",Simple Retrieval Queries,movies,False,False,True,
List the first 3 movies with a tagline containing the word 'football'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'football'
RETURN m
LIMIT 3",Simple Retrieval Queries,movies,False,False,False,
Who are the persons that have written and also acted in the same movie?,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:ACTED_IN]-(p)
RETURN p.name, m.title",Simple Retrieval Queries,movies,False,False,False,
Find all movies where a person named 'Nancy Meyers' acted.,"MATCH (p:Person {name: 'Nancy Meyers'})-[:ACTED_IN]->(m:Movie)
RETURN m",Simple Retrieval Queries,movies,False,False,True,
Show the top 5 people by the number of movies they have produced.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WITH p, count(m) AS moviesProduced
ORDER BY moviesProduced DESC
LIMIT 5
RETURN p.name, moviesProduced",Simple Retrieval Queries,movies,False,False,False,
Which movies have been reviewed with a rating exactly 75?,"MATCH (p:Person)-[r:REVIEWED {rating: 75}]->(m:Movie)
RETURN m.title AS MovieTitle, p.name AS ReviewerName",Simple Retrieval Queries,movies,False,False,True,
List the first 3 movies that have been both produced and reviewed by people born before 1960.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.born < 1960 AND exists {
  (p)-[:REVIEWED]->(m)
}
RETURN m.title, m.released
ORDER BY m.released
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
What are the roles of actors in the movie with the highest number of votes?,"MATCH (m:Movie)
WHERE m.votes IS NOT NULL
WITH m ORDER BY m.votes DESC LIMIT 1
MATCH (p:Person)-[r:ACTED_IN]->(m)
RETURN p.name, r.roles",Simple Retrieval Queries,movies,False,False,True,
What are the first 3 movies reviewed by a person born in 1967?,"MATCH (p:Person {born: 1967})-[:REVIEWED]->(m:Movie)
RETURN m
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
"Find all movies where Nancy Meyers was involved either by acting, directing, producing, or writing.","MATCH (p:Person {name: ""Nancy Meyers""})-[:ACTED_IN|DIRECTED|PRODUCED|WROTE]->(m:Movie)
RETURN m",Simple Retrieval Queries,movies,False,False,True,
List top 5 oldest people in the database.,"MATCH (p:Person)
RETURN p.name, p.born
ORDER BY p.born
LIMIT 5",Simple Retrieval Queries,movies,False,False,True,
Which person reviewed the most movies?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
RETURN p.name, count(m) AS movies_reviewed
ORDER BY movies_reviewed DESC
LIMIT 1",Simple Retrieval Queries,movies,False,False,True,
Which movies were released in 2003?,"MATCH (m:Movie)
WHERE m.released = 2003
RETURN m",Simple Retrieval Queries,movies,False,False,True,
List all movies with more than 1000 votes.,"MATCH (m:Movie)
WHERE m.votes > 1000
RETURN m",Simple Retrieval Queries,movies,False,False,True,
What are the top 5 highest rated movies based on votes?,"MATCH (m:Movie)
WHERE m.votes IS NOT NULL
RETURN m.title, m.votes
ORDER BY m.votes DESC
LIMIT 5",Simple Retrieval Queries,movies,True,False,False,
Find the first 3 people born after 1960.,"MATCH (p:Person)
WHERE p.born > 1960
RETURN p
ORDER BY p.born ASC
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
Who reviewed movies with a rating higher than 90?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating > 90
RETURN p.name, m.title, r.rating",Simple Retrieval Queries,movies,False,False,True,
List all movies directed by people born before 1950 limited to top 5.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born < 1950
RETURN m
ORDER BY m.released DESC
LIMIT 5",Simple Retrieval Queries,movies,False,False,True,
What are the roles of Keanu Reeves in the movies he acted in?,"MATCH (p:Person {name: ""Keanu Reeves""})-[:ACTED_IN]->(m:Movie)
RETURN m.title AS Movie, m.released AS Year, m.tagline AS Tagline, m.votes AS Votes, relationships(p-[:ACTED_IN]->m)[0].roles AS Roles",Simple Retrieval Queries,movies,False,False,True,
Find the first 3 movies produced by someone born in 1952.,"MATCH (p:Person {born: 1952})-[:PRODUCED]->(m:Movie)
RETURN m
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
Who acted in the movie with the tagline 'Welcome to the Real World'?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie {tagline: 'Welcome to the Real World'})
RETURN p.name",Simple Retrieval Queries,movies,False,False,False,
"Display the top 5 movies that have been reviewed with the summary 'Dark, but compelling'.","MATCH (m:Movie)<-[r:REVIEWED {summary: 'Dark, but compelling'}]-(p:Person)
RETURN m.title, m.released, count(p) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 5",Simple Retrieval Queries,movies,False,False,False,
Which people have directed more than one movie?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WITH p, count(m) AS moviesDirected
WHERE moviesDirected > 1
RETURN p.name, moviesDirected",Simple Retrieval Queries,movies,False,False,True,
Show the top 3 movies with the lowest number of votes.,"MATCH (m:Movie)
WHERE m.votes IS NOT NULL
RETURN m
ORDER BY m.votes ASC
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
Who are the first 3 people to follow Keanu Reeves?,"MATCH (p:Person)-[:FOLLOWS]->(:Person {name: ""Keanu Reeves""})
RETURN p.name
LIMIT 3",Simple Retrieval Queries,movies,False,False,False,
List all people who have produced a movie and acted in another.,"MATCH (p:Person)-[:PRODUCED]->(:Movie)
WHERE exists {
    MATCH (p)-[:ACTED_IN]->(:Movie)
}
RETURN p",Simple Retrieval Queries,movies,False,False,True,
What are the top 5 most recent movies in the database?,"MATCH (m:Movie)
RETURN m
ORDER BY m.released DESC
LIMIT 5",Simple Retrieval Queries,movies,False,False,True,
Find all movies with a released year in the 1990s.,"MATCH (m:Movie)
WHERE m.released >= 1990 AND m.released <= 1999
RETURN m",Simple Retrieval Queries,movies,False,False,True,
Who wrote the movie titled 'The Matrix'?,"MATCH (p:Person)-[:WROTE]->(m:Movie {title: 'The Matrix'})
RETURN p.name AS WriterName",Simple Retrieval Queries,movies,True,False,False,
List the first 3 people born in 1964.,"MATCH (p:Person)
WHERE p.born = 1964
RETURN p
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
Which movies have been reviewed with a rating less than 50?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating < 50
RETURN m.title, r.summary, r.rating",Simple Retrieval Queries,movies,False,False,False,
Show the first 3 movies produced by Joel Silver.,"MATCH (p:Person {name: ""Joel Silver""})-[:PRODUCED]->(m:Movie)
RETURN m
ORDER BY m.released
LIMIT 3",Simple Retrieval Queries,movies,False,False,False,
What are the roles of Carrie-Anne Moss in 'The Matrix Revolutions'?,"MATCH (p:Person {name: ""Carrie-Anne Moss""})-[:ACTED_IN {roles: roles}]->(m:Movie {title: ""The Matrix Revolutions""})
RETURN roles",Simple Retrieval Queries,movies,True,False,False,
Who are the first 3 directors of movies released in the 2000s?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.released >= 2000 AND m.released < 2010
RETURN p.name
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
List all movies directed by a person with the name 'Joel Silver'.,"MATCH (p:Person {name: 'Joel Silver'})-[:DIRECTED]->(m:Movie)
RETURN m",Simple Retrieval Queries,movies,False,False,True,
Find all people who have followed and been followed by the same person.,"MATCH (p1:Person)-[:FOLLOWS]->(p2:Person)<-[:FOLLOWS]-(p1)
RETURN p1, p2",Simple Retrieval Queries,movies,False,False,True,
Show the top 5 movies that have been acted in by the oldest person in the database.,"MATCH (oldest:Person)
WHERE oldest.born = (SELECT min(p.born) FROM Person p)
MATCH (oldest)-[:ACTED_IN]->(m:Movie)
RETURN m
ORDER BY m.released DESC
LIMIT 5",Simple Retrieval Queries,movies,False,False,True,
Who are the top 5 oldest directors in the database?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
RETURN p.name, p.born
ORDER BY p.born ASC
LIMIT 5",Simple Retrieval Queries,movies,False,False,False,
List all movies with a rating of exactly 85 in the 'REVIEWED' relationship.,"MATCH (p:Person)-[r:REVIEWED {rating: 85}]->(m:Movie)
RETURN m.title AS MovieTitle, p.name AS ReviewerName, r.summary AS ReviewSummary",Simple Retrieval Queries,movies,False,False,False,
Find the first 3 people who have written and directed the same movie.,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:DIRECTED]-(p)
RETURN p.name, collect(m.title) AS Movies
LIMIT 3",Simple Retrieval Queries,movies,False,False,False,
Who are the first 3 actors in the movie with the tagline 'Speed has no limits'?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie {tagline: 'Speed has no limits'})
RETURN p.name
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
Show the top 5 movies reviewed by a person named 'Joel Silver'.,"MATCH (p:Person {name: 'Joel Silver'})-[:REVIEWED]->(m:Movie)
RETURN m.title, m.released, m.tagline, m.votes
ORDER BY m.votes DESC
LIMIT 5",Simple Retrieval Queries,movies,False,False,True,
Which movies have been directed by persons born after 1970?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born > 1970
RETURN m.title AS MovieTitle, m.released AS ReleaseYear",Simple Retrieval Queries,movies,False,False,True,
List the first 3 movies that have been both acted in and reviewed by the same person.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE exists {
  (p)-[:REVIEWED]->(m)
}
RETURN m.title AS MovieTitle, m.released AS ReleaseYear
LIMIT 3",Simple Retrieval Queries,movies,False,False,False,
What are the roles of actors in the movie titled 'Speed Racer'?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie {title: 'Speed Racer'})
RETURN p.name, r.roles",Simple Retrieval Queries,movies,False,False,True,
List all persons who have produced at least three movies.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WITH p, count(m) AS moviesProduced
WHERE moviesProduced >= 3
RETURN p.name, moviesProduced",Complex Retrieval Queries,movies,False,False,True,
What are the titles of the top 5 movies released in 1999?,"MATCH (m:Movie)
WHERE m.released = 1999
RETURN m.title
ORDER BY m.votes DESC
LIMIT 5",Simple Retrieval Queries,movies,False,False,False,
List the first 3 movies reviewed by a person born in 1960.,"MATCH (p:Person {born: 1960})-[:REVIEWED]->(m:Movie)
RETURN m
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
Which movies have a tagline containing the word 'freedom'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'freedom'
RETURN m.title, m.tagline",Simple Retrieval Queries,movies,False,False,True,
Find the top 5 movies with the highest votes released after 2000.,"MATCH (m:Movie)
WHERE m.released > 2000
RETURN m
ORDER BY m.votes DESC
LIMIT 5",Simple Retrieval Queries,movies,True,False,False,
Who are the top 3 people born after 1970 who directed a movie?,"MATCH (p:Person)-[:DIRECTED]->(:Movie)
WHERE p.born > 1970
RETURN p
ORDER BY p.born ASC
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
List all movies released between 1990 and 2000 that have more than 100 votes.,"MATCH (m:Movie)
WHERE m.released >= 1990 AND m.released <= 2000 AND m.votes > 100
RETURN m",Simple Retrieval Queries,movies,False,False,True,
What are the names of the first 5 people who acted in a movie with the tagline 'Everything is connected'?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie {tagline: 'Everything is connected'})
RETURN p.name
LIMIT 5",Simple Retrieval Queries,movies,False,False,False,
Which top 3 movies released before 1985 were reviewed with a rating above 90?,"MATCH (m:Movie)<-[:REVIEWED {rating: r}]-(p:Person)
WHERE m.released < 1985 AND r > 90
RETURN m.title, m.released, r
ORDER BY r DESC
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
List the first 5 movies produced by a person born in 1967.,"MATCH (p:Person {born: 1967})-[:PRODUCED]->(m:Movie)
RETURN m.title AS MovieTitle, m.released AS ReleaseYear
ORDER BY m.released
LIMIT 5",Simple Retrieval Queries,movies,False,False,True,
Name the top 3 directors of movies that had a tagline mentioning 'Houston'.,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE m.tagline CONTAINS 'Houston'
RETURN d.name, count(m) AS movies_directed
ORDER BY movies_directed DESC
LIMIT 3",Simple Retrieval Queries,movies,False,False,False,
What are the names of the first 3 people who reviewed a movie titled 'Apollo 13'?,"MATCH (p:Person)-[:REVIEWED]->(m:Movie {title: 'Apollo 13'})
RETURN p.name
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
Which top 5 people have directed movies with more than 200 votes?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.votes > 200
RETURN p.name, count(m) AS moviesDirected
ORDER BY moviesDirected DESC
LIMIT 5",Simple Retrieval Queries,movies,False,False,True,
What are the first 3 movies with a released year of 1996?,"MATCH (m:Movie {released: 1996})
RETURN m
ORDER BY m.title
LIMIT 3",Simple Retrieval Queries,movies,False,False,False,
What are the names of the top 5 people who followed someone born in 1956?,"MATCH (p:Person)-[:FOLLOWS]->(followed:Person {born: 1956})
RETURN p.name AS Name
ORDER BY p.name
LIMIT 5",Simple Retrieval Queries,movies,False,False,True,
List the first 3 movies where someone named 'Carrie-Anne Moss' acted.,"MATCH (p:Person {name: 'Carrie-Anne Moss'})-[:ACTED_IN]->(m:Movie)
RETURN m.title
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
Show the top 5 people who have reviewed the most movies.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
RETURN p.name, count(m) AS movies_reviewed
ORDER BY movies_reviewed DESC
LIMIT 5",Simple Retrieval Queries,movies,False,False,True,
Which people have reviewed and also produced the movie titled 'The Matrix Revolutions'?,"MATCH (p:Person)-[:REVIEWED]->(m:Movie {title: 'The Matrix Revolutions'})
WHERE exists{ (p)-[:PRODUCED]->(m) }
RETURN p.name",Simple Retrieval Queries,movies,False,False,True,
List the first 3 movies that have been acted in and directed by the same person.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS MovieTitle, m.released AS ReleaseYear
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
What are the first 3 movies with a released year of 2008?,"MATCH (m:Movie)
WHERE m.released = 2008
RETURN m
ORDER BY m.title
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
Show the top 5 people who have the most followers.,"MATCH (p:Person)
RETURN p, count{(p)<-[:FOLLOWS]-(:Person)} AS followers
ORDER BY followers DESC
LIMIT 5",Simple Retrieval Queries,movies,False,False,True,
Which person reviewed the movie with the lowest rating?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
RETURN p, m
ORDER BY r.rating ASC
LIMIT 1",Simple Retrieval Queries,movies,False,False,True,
List all movies with more than one role listed in the 'ACTED_IN' relationship.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE size(r.roles) > 1
RETURN m.title, collect(p.name) AS actors, r.roles",Simple Retrieval Queries,movies,False,False,True,
Find the first 3 people who acted in a movie released in the 1990s.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.released >= 1990 AND m.released < 2000
RETURN p
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
Who are the first 3 people to have produced a movie with more than 500 votes?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE m.votes > 500
RETURN p.name
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
List the top 5 movies with a released year before 1985.,"MATCH (m:Movie)
WHERE m.released < 1985
RETURN m
ORDER BY m.released DESC
LIMIT 5",Simple Retrieval Queries,movies,False,False,True,
What are the first 3 movies that have a tagline containing the word 'journey'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'journey'
RETURN m
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
Show the top 5 people by the number of movies they have directed.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WITH p, count(m) AS moviesDirected
ORDER BY moviesDirected DESC
LIMIT 5
RETURN p.name, moviesDirected",Simple Retrieval Queries,movies,False,False,True,
Which person has the most roles in a single movie?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
RETURN p.name, m.title, size(r.roles) AS num_roles
ORDER BY num_roles DESC
LIMIT 1",Simple Retrieval Queries,movies,False,False,False,
"List the first 3 movies with a review summary of 'Fun, but a little far fetched'.","MATCH (m:Movie)<-[:REVIEWED {summary: 'Fun, but a little far fetched'}]-(p:Person)
RETURN m.title, m.released, m.tagline
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
Find all people born in 1949 who have directed a movie.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born = 1949
RETURN p, collect(m) AS DirectedMovies",Simple Retrieval Queries,movies,False,False,False,
Who are the first 3 people who acted in a movie titled 'Something's Gotta Give'?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie {title: ""Something's Gotta Give""})
RETURN p.name
LIMIT 3",Simple Retrieval Queries,movies,False,False,False,
List all movies that were released in the year 2001.,"MATCH (m:Movie)
WHERE m.released = 2001
RETURN m",Simple Retrieval Queries,movies,False,False,False,
What are the top 5 movies with the most roles listed in their 'ACTED_IN' relationship?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
RETURN m.title, count(r.roles) AS total_roles
ORDER BY total_roles DESC
LIMIT 5",Simple Retrieval Queries,movies,False,False,False,
Show the first 3 people born in 1980 who have reviewed a movie.,"MATCH (p:Person)-[:REVIEWED]->(:Movie)
WHERE p.born = 1980
RETURN p
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
Which movies have been reviewed and also acted in by the same person?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE exists {
  (p)-[:REVIEWED]->(m)
}
RETURN m.title AS MovieTitle, collect(p.name) AS ReviewingActors",Simple Retrieval Queries,movies,False,False,True,
List the first 3 people who have directed a movie and also followed someone.,"MATCH (p:Person)-[:DIRECTED]->(:Movie)
WHERE exists{ (p)-[:FOLLOWS]->(:Person) }
RETURN p
LIMIT 3",Simple Retrieval Queries,movies,False,False,True,
Find all movies with a tagline including the word 'compelling'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'compelling'
RETURN m",Simple Retrieval Queries,movies,False,False,False,
Which person has produced the most movies?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
RETURN p.name, count(m) AS movies_produced
ORDER BY movies_produced DESC
LIMIT 1",Simple Retrieval Queries,movies,False,False,True,
Which movie has the highest number of votes and was released in the 1990s?,"MATCH (m:Movie)
WHERE m.released >= 1990 AND m.released < 2000
RETURN m
ORDER BY m.votes DESC
LIMIT 1",Complex Retrieval Queries,movies,False,False,False,
What are the first 3 movies directed by persons with the most followers?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WITH d, count{(d)-[:FOLLOWS]->(:Person)} AS followers
ORDER BY followers DESC
LIMIT 1
MATCH (d)-[:DIRECTED]->(movie:Movie)
RETURN movie
LIMIT 3",Pathfinding Queries,movies,False,False,False,
List all movies that have been reviewed and produced by the same person.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:REVIEWED]-(p)
RETURN m.title AS MovieTitle, p.name AS ProducerReviewer",Complex Retrieval Queries,movies,False,False,False,
Who are the first 3 people to review a movie with a summary 'Pretty funny at times'?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.summary = 'Pretty funny at times'
RETURN p.name
LIMIT 3",Complex Retrieval Queries,movies,False,False,True,
Find the first 3 actors who acted in a movie with a tagline containing 'Robin Williams'.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.tagline CONTAINS 'Robin Williams'
RETURN p.name
LIMIT 3",Complex Retrieval Queries,movies,False,False,False,
List the first 5 movies with a tagline containing 'end' that were reviewed with a rating above 75.,"MATCH (m:Movie)-[r:REVIEWED]->()
WHERE m.tagline CONTAINS 'end' AND r.rating > 75
RETURN m.title, m.tagline, r.rating
ORDER BY m.released
LIMIT 5",Complex Retrieval Queries,movies,False,False,True,
"Which 3 movies reviewed with a summary 'Dark, but compelling' were produced by someone born before 1960?","MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:REVIEWED]-(reviewer:Person)
WHERE p.born < 1960 AND EXISTS {
  (reviewer)-[:REVIEWED]->(m {summary: 'Dark, but compelling'})
}
RETURN m.title AS MovieTitle
LIMIT 3",Complex Retrieval Queries,movies,False,False,False,
Name the top 5 directors of movies that have a tagline mentioning 'Real World'.,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE m.tagline CONTAINS 'Real World'
RETURN d.name, count(m) AS movies_directed
ORDER BY movies_directed DESC
LIMIT 5",Complex Retrieval Queries,movies,False,False,True,
What are the first 3 movies with a tagline containing 'fun' that were directed by someone born after 1970?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE d.born > 1970 AND m.tagline CONTAINS 'fun'
RETURN m.title, m.tagline, m.released
ORDER BY m.released
LIMIT 3",Complex Retrieval Queries,movies,False,False,False,
List the top 5 movies where the director and the main actor were born in the same decade.,"MATCH (director:Person)-[:DIRECTED]->(movie:Movie)<-[:ACTED_IN]-(actor:Person)
WHERE (director.born - director.born % 10) = (actor.born - actor.born % 10)
RETURN movie.title AS Movie, director.name AS Director, actor.name AS Actor
ORDER BY movie.votes DESC
LIMIT 5",Complex Retrieval Queries,movies,False,False,True,
Who are the first 3 actors born after 1980 who acted in a movie produced by someone born before 1950?,"MATCH (actor:Person)-[:ACTED_IN]->(m:Movie)<-[:PRODUCED]-(producer:Person)
WHERE actor.born > 1980 AND producer.born < 1950
RETURN actor.name, m.title
LIMIT 3",Complex Retrieval Queries,movies,False,False,False,
Find the first 3 movies produced by 'Lana Wachowski'.,"MATCH (p:Person {name: 'Lana Wachowski'})-[:PRODUCED]->(m:Movie)
RETURN m
LIMIT 3",Complex Retrieval Queries,movies,False,False,False,
List the first 5 people who followed someone with the same birth year.,"MATCH (p1:Person)-[:FOLLOWS]->(p2:Person)
WHERE p1.born = p2.born
RETURN p1
LIMIT 5",Complex Retrieval Queries,movies,False,False,False,
Which 3 people born before 1950 acted in a movie with a tagline containing 'limits'?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born < 1950 AND m.tagline CONTAINS 'limits'
RETURN p.name
LIMIT 3",Complex Retrieval Queries,movies,False,False,False,
Name the top 5 directors who also reviewed the movies they directed.,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)<-[:REVIEWED]-(d)
RETURN d.name AS Director, count(m) AS MoviesReviewedAndDirected
ORDER BY MoviesReviewedAndDirected DESC
LIMIT 5",Complex Retrieval Queries,movies,False,False,True,
What are the first 3 movies where someone named 'Keanu Reeves' was the producer?,"MATCH (p:Person {name: 'Keanu Reeves'})-[:PRODUCED]->(m:Movie)
RETURN m
LIMIT 3",Complex Retrieval Queries,movies,False,False,False,
List the top 5 actors who acted in movies reviewed with a summary 'Slapstick redeemed only by the Robin Williams and '.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:REVIEWED {summary: 'Slapstick redeemed only by the Robin Williams and '}]-(reviewer:Person)
RETURN p.name AS Actor, count(m) AS MoviesReviewed
ORDER BY MoviesReviewed DESC
LIMIT 5",Complex Retrieval Queries,movies,False,False,True,
Who are the first 3 people born after 1975 who wrote a movie released after 2005?,"MATCH (p:Person)-[:WROTE]->(m:Movie)
WHERE p.born > 1975 AND m.released > 2005
RETURN p.name
ORDER BY p.born
LIMIT 3",Complex Retrieval Queries,movies,False,False,False,
List the top 5 movies directed by someone who also acted in them.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE exists{(p)-[:ACTED_IN]->(m)}
RETURN m.title AS Movie, m.released AS ReleaseYear
ORDER BY m.released DESC
LIMIT 5",Complex Retrieval Queries,movies,False,False,False,
What are the first 3 movies where 'Joel Silver' acted?,"MATCH (p:Person {name: 'Joel Silver'})-[:ACTED_IN]->(m:Movie)
RETURN m
ORDER BY m.released
LIMIT 3",Complex Retrieval Queries,movies,False,False,True,
Name the first 5 people who directed a movie with votes less than 50.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.votes < 50
RETURN p.name
LIMIT 5",Complex Retrieval Queries,movies,False,False,False,
Which 3 people born after 1970 reviewed a movie with a summary 'An amazing journey'?,"MATCH (p:Person)-[:REVIEWED {summary: 'An amazing journey'}]->(:Movie)
WHERE p.born > 1970
RETURN p
LIMIT 3",Complex Retrieval Queries,movies,False,False,True,
List the first 3 people who wrote and also reviewed the same movie.,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:REVIEWED]-(p)
RETURN p.name, m.title
LIMIT 3",Complex Retrieval Queries,movies,False,False,False,
What are the top 5 movies with the most roles for actors born after 1970?,"MATCH (p:Person)-[a:ACTED_IN]->(m:Movie)
WHERE p.born > 1970
WITH m, count(a.roles) AS totalRoles
ORDER BY totalRoles DESC
LIMIT 5
RETURN m.title, totalRoles",Complex Retrieval Queries,movies,False,False,True,
Which 3 people born before 1950 reviewed a movie with a rating less than 50?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE p.born < 1950 AND r.rating < 50
RETURN p.name, p.born, m.title, r.rating
LIMIT 3",Complex Retrieval Queries,movies,False,False,False,
Name the first 5 people who acted in a movie with a tagline mentioning 'Real World'.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.tagline CONTAINS 'Real World'
RETURN p.name
LIMIT 5",Complex Retrieval Queries,movies,False,False,True,
What are the first 3 movies directed by someone who also reviewed them?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE exists {
  (p)-[:REVIEWED]->(m)
}
RETURN m.title AS MovieTitle
LIMIT 3",Complex Retrieval Queries,movies,False,False,False,
List the top 5 movies with the tagline 'Welcome to the Real World' that were released after 1995.,"MATCH (m:Movie)
WHERE m.tagline = 'Welcome to the Real World' AND m.released > 1995
RETURN m
ORDER BY m.released DESC
LIMIT 5",Complex Retrieval Queries,movies,False,False,False,
Who reviewed the movie titled 'Speed Racer' and what was their summary?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie {title: 'Speed Racer'})
RETURN p.name, r.summary",Complex Retrieval Queries,movies,False,False,False,
What are the titles of the top 5 movies with the highest votes?,"MATCH (m:Movie)
WHERE m.votes IS NOT NULL
RETURN m.title
ORDER BY m.votes DESC
LIMIT 5",Simple Aggregation Queries,movies,False,False,False,
Find the first 3 actors who acted in more than one movie with a tagline containing 'beginning'.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.tagline CONTAINS 'beginning'
WITH p, count(m) AS moviesCount
WHERE moviesCount > 1
RETURN p
LIMIT 3",Complex Retrieval Queries,movies,False,False,True,
Which 3 movies with a tagline containing 'journey' were reviewed with a rating above 85?,"MATCH (m:Movie)-[r:REVIEWED]->()
WHERE m.tagline CONTAINS 'journey' AND r.rating > 85
RETURN m.title, m.tagline, r.rating
ORDER BY r.rating DESC
LIMIT 3",Complex Retrieval Queries,movies,False,False,True,
Name the top 5 people who followed and were followed by 'Laurence Fishburne'.,"MATCH (p:Person)-[:FOLLOWS]->(lf:Person {name: 'Laurence Fishburne'})
MATCH (lf)-[:FOLLOWS]->(p)
RETURN p.name
LIMIT 5",Complex Retrieval Queries,movies,False,False,False,
What are the first 3 movies where someone born in 1965 directed a person born in 1952?,"MATCH (director:Person {born: 1965})-[:DIRECTED]->(movie:Movie)<-[:ACTED_IN]-(actor:Person {born: 1952})
RETURN movie
LIMIT 3",Complex Retrieval Queries,movies,False,False,False,
List the first 5 people born before 1980 who wrote a movie with a tagline mentioning 'speed'.,"MATCH (p:Person)-[:WROTE]->(m:Movie)
WHERE p.born < 1980 AND m.tagline CONTAINS 'speed'
RETURN p
LIMIT 5",Complex Retrieval Queries,movies,False,False,True,
Who are the top 3 actors with the most roles in movies released before 1990?,"MATCH (p:Person)-[a:ACTED_IN]->(m:Movie)
WHERE m.released < 1990
WITH p, count(a.roles) AS total_roles
ORDER BY total_roles DESC
LIMIT 3
RETURN p.name AS actor, total_roles",Complex Retrieval Queries,movies,False,False,True,
List the first 3 people who produced and acted in the same movie.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:ACTED_IN]-(p)
RETURN p.name, m.title
LIMIT 3",Complex Retrieval Queries,movies,True,False,False,
What are the top 5 movies with a tagline containing 'football' that were produced by someone born after 1960?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.born > 1960 AND m.tagline CONTAINS 'football'
RETURN m.title, m.tagline, m.released
ORDER BY m.votes DESC
LIMIT 5",Complex Retrieval Queries,movies,False,False,True,
List the top 5 people who produced movies that received more than 2000 votes.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE m.votes > 2000
RETURN p.name, count(m) AS movies_produced
ORDER BY movies_produced DESC
LIMIT 5",Complex Retrieval Queries,movies,False,False,False,
List the names of 3 people who were born after 1970.,"MATCH (p:Person)
WHERE p.born > 1970
RETURN p.name
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Which movies released after 2000 have been reviewed with a rating above 80?,"MATCH (m:Movie)<-[:REVIEWED {rating: r}]-(p:Person)
WHERE m.released > 2000 AND r > 80
RETURN m.title, m.released, p.name, r",Simple Aggregation Queries,movies,False,False,True,
Find the top 5 movies with the most number of reviews.,"MATCH (m:Movie)<-[:REVIEWED]-(:Person)
RETURN m.title, count{(m)<-[:REVIEWED]-(:Person)} AS reviewCount
ORDER BY reviewCount DESC
LIMIT 5",Simple Aggregation Queries,movies,False,False,True,
Which people follow Keanu Reeves and have also acted in a movie with him?,"MATCH (follower:Person)-[:FOLLOWS]->(keanu:Person {name: ""Keanu Reeves""})
WHERE exists {
    (follower)-[:ACTED_IN]->(m:Movie)<-[:ACTED_IN]-(keanu)
}
RETURN follower",Simple Aggregation Queries,movies,False,False,True,
"What are the names of the first 3 people who have produced, directed, and written the same movie?","MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE exists {
  (p)-[:DIRECTED]->(m)
} AND exists {
  (p)-[:WROTE]->(m)
}
RETURN p.name
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
What is the average rating of movies reviewed by people born after 1980?,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)
WHERE p.born > 1980
RETURN AVG(m.rating) AS average_rating",Simple Aggregation Queries,movies,False,False,True,Movie.rating
List the roles of actors in the top 5 movies with the most votes.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
RETURN m.title AS Movie, p.name AS Actor, r.roles AS Roles
ORDER BY m.votes DESC
LIMIT 5",Simple Aggregation Queries,movies,False,False,True,
Who are the first 3 people to have directed a movie with a tagline including the word 'beginning'?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.tagline CONTAINS 'beginning'
RETURN p.name
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
What are the top 5 movies with the least votes and their release years?,"MATCH (m:Movie)
WHERE m.votes IS NOT NULL
RETURN m.title, m.released
ORDER BY m.votes ASC
LIMIT 5",Simple Aggregation Queries,movies,False,False,True,
Which people have reviewed the same movie and what were their review summaries?,"MATCH (p1:Person)-[r1:REVIEWED]->(m:Movie)<-[r2:REVIEWED]-(p2:Person)
WHERE p1 <> p2
RETURN p1.name AS Reviewer1, p2.name AS Reviewer2, m.title AS Movie, r1.summary AS Review1, r2.summary AS Review2",Simple Aggregation Queries,movies,False,False,True,
List the top 5 oldest actors and the movies they have acted in.,"MATCH (p:Person)-[a:ACTED_IN]->(m:Movie)
WHERE p.born IS NOT NULL
RETURN p.name, p.born, collect(m.title) AS movies
ORDER BY p.born ASC
LIMIT 5",Simple Aggregation Queries,movies,False,False,True,
List the first 3 movies that Keanu Reeves has acted in with their release years.,"MATCH (p:Person {name: ""Keanu Reeves""})-[:ACTED_IN]->(m:Movie)
RETURN m.title, m.released
ORDER BY m.released
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
What are the taglines of the top 3 movies released in 1996?,"MATCH (m:Movie)
WHERE m.released = 1996
RETURN m.tagline
ORDER BY m.votes DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,False,
List the top 5 people who have produced the most number of movies with their birth years.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
RETURN p.name, p.born, count(m) AS movies_produced
ORDER BY movies_produced DESC
LIMIT 5",Simple Aggregation Queries,movies,False,False,True,
"Which movies have been reviewed with a summary 'Fun, but a little far fetched' and what were their ratings?","MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.summary = 'Fun, but a little far fetched'
RETURN m.title, r.rating",Simple Aggregation Queries,movies,False,False,True,
What is the average number of votes for movies released in the 1980s?,"MATCH (m:Movie)
WHERE m.released >= 1980 AND m.released <= 1989
RETURN avg(m.votes) AS average_votes",Simple Aggregation Queries,movies,False,False,True,
Who are the first 3 people born in the 1960s that Keanu Reeves follows?,"MATCH (p:Person {name: ""Keanu Reeves""})-[:FOLLOWS]->(followed:Person)
WHERE followed.born >= 1960 AND followed.born < 1970
RETURN followed
ORDER BY followed.born
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
List the roles played by actors in the first 3 movies directed by Nancy Meyers.,"MATCH (d:Person {name: ""Nancy Meyers""})-[:DIRECTED]->(m:Movie)
WITH m
ORDER BY m.released
LIMIT 3
MATCH (a:Person)-[r:ACTED_IN]->(m)
RETURN m.title AS Movie, a.name AS Actor, r.roles AS Roles",Simple Aggregation Queries,movies,True,False,False,
What are the first 3 movies produced by Joel Silver and their respective release years?,"MATCH (p:Person {name: ""Joel Silver""})-[:PRODUCED]->(m:Movie)
RETURN m.title AS MovieTitle, m.released AS ReleaseYear
ORDER BY m.released
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Who has directed the most movies released after 2000 and what are those movies?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.released > 2000
WITH p, count(m) AS moviesDirected, collect(m.title) AS movieTitles
ORDER BY moviesDirected DESC
LIMIT 1
RETURN p.name AS Director, moviesDirected, movieTitles",Simple Aggregation Queries,movies,False,False,False,
Who are the top 5 producers of the movie with the title 'Speed Racer'?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie {title: 'Speed Racer'})
RETURN p.name
ORDER BY p.born DESC
LIMIT 5",Complex Retrieval Queries,movies,True,False,False,
What are the first 3 movies that received a review with a rating less than 50?,"MATCH (m:Movie)<-[:REVIEWED {rating: r}]-(p:Person)
WHERE r < 50
RETURN m.title AS MovieTitle, m.released AS ReleaseYear
ORDER BY m.released
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Who are the top 5 youngest producers in the database?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
RETURN p.name, p.born
ORDER BY p.born DESC
LIMIT 5",Simple Aggregation Queries,movies,False,False,True,
Who are the first 3 people that Keanu Reeves follows?,"MATCH (p:Person {name: ""Keanu Reeves""})-[:FOLLOWS]->(followed:Person)
RETURN followed.name
LIMIT 3",Simple Aggregation Queries,movies,False,False,False,
What are the roles played by Laurence Fishburne in movies released before 2010?,"MATCH (p:Person {name: ""Laurence Fishburne""})-[:ACTED_IN]->(m:Movie)
WHERE m.released < 2010
RETURN m.title, m.released, relationships(p-[:ACTED_IN]->m)[0].roles AS roles",Simple Aggregation Queries,movies,False,False,True,
Which movie has the lowest number of votes and what is its tagline?,"MATCH (m:Movie)
WHERE m.votes IS NOT NULL
RETURN m.title, m.tagline, m.votes
ORDER BY m.votes ASC
LIMIT 1",Simple Aggregation Queries,movies,False,False,True,
List the top 3 directors by the number of movies they have directed.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
RETURN p.name, count(m) AS directedMovies
ORDER BY directedMovies DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,False,
What are the names of the people who reviewed 'The Matrix' and what were their ratings?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie {title: ""The Matrix""})
RETURN p.name AS reviewer_name, r.rating AS rating",Simple Aggregation Queries,movies,False,False,True,
Which person has produced the most movies and what are those movies?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WITH p, count(m) AS moviesProduced
ORDER BY moviesProduced DESC
LIMIT 1
MATCH (p)-[:PRODUCED]->(movie:Movie)
RETURN p.name, collect(movie.title) AS movies",Simple Aggregation Queries,movies,True,False,False,
How many people have acted in 'Something's Gotta Give'?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie {title: ""Something's Gotta Give""})
RETURN count(p) AS NumberOfActors",Simple Aggregation Queries,movies,False,False,True,
Which movies have a tagline containing the word 'real' and were released in the 2000s?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'real' AND m.released >= 2000 AND m.released < 2010
RETURN m.title, m.released, m.tagline",Simple Aggregation Queries,movies,False,False,True,
What are the top 5 movies with the highest average review rating?,"MATCH (m:Movie)<-[r:REVIEWED]-(:Person)
WITH m, AVG(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 5
RETURN m.title, avgRating",Simple Aggregation Queries,movies,False,False,True,
Who are the first 3 people born before 1950 and what movies have they directed?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born < 1950
RETURN p.name, collect(m.title) AS DirectedMovies
ORDER BY p.born
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
"What are the names of the movies that received a review summary 'Dark, but compelling'?","MATCH (m:Movie)<-[:REVIEWED {summary: 'Dark, but compelling'}]-(:Person)
RETURN m.title",Simple Aggregation Queries,movies,False,False,True,
Which movies have been both written and directed by the same person and what are their titles?,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS MovieTitle",Simple Aggregation Queries,movies,False,False,False,
How many different people have reviewed movies released before 1990?,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)
WHERE m.released < 1990
RETURN count(DISTINCT p) AS reviewers_count",Simple Aggregation Queries,movies,False,False,True,
What are the first 3 most recent movies that have a tagline?,"MATCH (m:Movie)
WHERE m.tagline IS NOT NULL
RETURN m
ORDER BY m.released DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Which person has acted in the most movies and what are those movies titles?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WITH p, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 1
MATCH (p)-[:ACTED_IN]->(movie:Movie)
RETURN p.name, collect(movie.title) AS movie_titles",Simple Aggregation Queries,movies,False,False,False,
List 3 movies Laurence Fishburne has reviewed and their corresponding ratings.,"MATCH (p:Person {name: ""Laurence Fishburne""})-[:REVIEWED]->(m:Movie)
RETURN m.title AS Movie, m.rating AS Rating
LIMIT 3",Simple Aggregation Queries,movies,False,False,False,Movie.rating
List the top 3 movies by Laurence Fishburne as an actor.,"MATCH (p:Person {name: ""Laurence Fishburne""})-[:ACTED_IN]->(m:Movie)
RETURN m
ORDER BY m.votes DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
What are the first 3 movies where someone born in 1996 acted?,"MATCH (p:Person {born: 1996})-[:ACTED_IN]->(m:Movie)
RETURN m.title AS MovieTitle, m.released AS ReleaseYear
ORDER BY m.released
LIMIT 3",Complex Retrieval Queries,movies,False,False,False,
"List the first 3 movies reviewed with a summary 'Silly, but fun' and a tagline containing 'world'.","MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.summary = 'Silly, but fun' AND m.tagline CONTAINS 'world'
RETURN m.title, m.tagline, r.summary
LIMIT 3",Complex Retrieval Queries,movies,False,False,True,
Find the first 5 people born after 1980 who directed a movie released before 2000.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born > 1980 AND m.released < 2000
RETURN p
LIMIT 5",Complex Retrieval Queries,movies,False,False,True,
Who reviewed the movie with the highest rating?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
RETURN p.name AS reviewer, m.title AS movie, r.rating AS rating
ORDER BY r.rating DESC
LIMIT 1",Complex Aggregation Queries,movies,False,False,True,
Name the first 3 people who have produced and acted in the same movie.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:ACTED_IN]-(p)
RETURN p.name
LIMIT 3",Complex Aggregation Queries,movies,False,False,True,
What is the average number of roles per actor in 'The Matrix'?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie {title: 'The Matrix'})
WITH p, r.roles AS roles
RETURN avg(size(roles)) AS average_roles_per_actor",Complex Aggregation Queries,movies,False,False,False,
List the movies produced by a person born in the 1950s.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.born >= 1950 AND p.born < 1960
RETURN m.title, m.released",Complex Aggregation Queries,movies,False,False,True,
Who are the top 3 actors by number of followers?,"MATCH (p:Person)-[:FOLLOWS]->(actor:Person)
WITH actor, count(p) AS followers
ORDER BY followers DESC
LIMIT 3
RETURN actor.name, followers",Complex Aggregation Queries,movies,False,False,True,
"Name the movies that have a review summary 'Silly, but fun'.","MATCH (m:Movie)<-[:REVIEWED {summary: 'Silly, but fun'}]-(:Person)
RETURN m.title",Complex Aggregation Queries,movies,True,False,False,
Which movies have been reviewed by more than 3 different people?,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)
WITH m, count(DISTINCT p) AS reviewers_count
WHERE reviewers_count > 3
RETURN m.title AS Movie, reviewers_count",Complex Aggregation Queries,movies,False,False,True,
List the actors who have roles in movies released after 2000.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE m.released > 2000
RETURN p.name, r.roles, m.title, m.released",Complex Aggregation Queries,movies,False,False,False,
List the first 3 directors born after 1960.,"MATCH (p:Person)-[:DIRECTED]->(:Movie)
WHERE p.born > 1960
RETURN p.name, p.born
ORDER BY p.born
LIMIT 3",Complex Aggregation Queries,movies,False,False,True,
Name the movies acted in by the oldest actor in the database.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born = (SELECT min(p2.born) FROM (MATCH (p2:Person) RETURN p2))
RETURN m.title AS MovieTitle",Complex Aggregation Queries,movies,False,False,True,
What are the first 3 movies with the most diverse taglines?,"MATCH (m:Movie)
WHERE m.tagline IS NOT NULL
RETURN m
ORDER BY m.tagline DESC
LIMIT 3",Complex Aggregation Queries,movies,False,False,True,
List the people who have directed and reviewed the same movie.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:REVIEWED]-(p)
RETURN p.name, m.title",Complex Aggregation Queries,movies,False,False,True,
Who are the top 3 actors in terms of movies acted in from 1990 to 2000?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.released >= 1990 AND m.released <= 2000
RETURN p.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3",Complex Aggregation Queries,movies,False,False,True,
Name the first 3 movies with a released year divisible by 10.,"MATCH (m:Movie)
WHERE m.released % 10 = 0
RETURN m.title
ORDER BY m.released
LIMIT 3",Complex Aggregation Queries,movies,False,False,True,
Who are the first three actors born after 1970 who acted in a movie released before 1990?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born > 1970 AND m.released < 1990
RETURN p.name
ORDER BY p.born ASC
LIMIT 3",Verbose query,movies,False,False,True,
What are the top five movies with a vote count greater than 500?,"MATCH (m:Movie)
WHERE m.votes > 500
RETURN m
ORDER BY m.votes DESC
LIMIT 5",Verbose query,movies,False,False,True,
Who has the highest average review rating?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WITH p, AVG(r.rating) AS avgRating
RETURN p.name AS reviewer, avgRating
ORDER BY avgRating DESC
LIMIT 1",Complex Aggregation Queries,movies,False,False,True,
List the first three people who directed a movie with a tagline containing the word 'real'.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.tagline CONTAINS 'real'
RETURN p.name
LIMIT 3",Verbose query,movies,False,False,False,
Which movies have been directed by someone who has also acted in them?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE exists {
    (p)-[:ACTED_IN]->(m)
}
RETURN m.title AS MovieTitle",Complex Aggregation Queries,movies,False,False,True,
Name the people who have the role of both actor and director in the most movies.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WITH p, count(m) AS actedInMovies
MATCH (p)-[:DIRECTED]->(m:Movie)
WITH p, actedInMovies, count(m) AS directedMovies
WHERE actedInMovies > 0 AND directedMovies > 0
RETURN p.name, actedInMovies, directedMovies
ORDER BY actedInMovies + directedMovies DESC
LIMIT 1",Complex Aggregation Queries,movies,False,False,True,
Who has acted in movies directed by Lana Wachowski?,"MATCH (director:Person {name: ""Lana Wachowski""})-[:DIRECTED]->(movie:Movie)<-[:ACTED_IN]-(actor:Person)
RETURN actor.name AS ActorName",Complex Retrieval Queries,movies,False,False,True,
Name the movies that have been both reviewed and produced by the same person.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE exists {
  (p)-[:REVIEWED]->(m)
}
RETURN m.title AS MovieTitle",Complex Aggregation Queries,movies,True,False,False,
List the first 3 persons who were born after 1950 and have directed a movie.,"MATCH (p:Person)-[:DIRECTED]->(:Movie)
WHERE p.born > 1950
RETURN p
LIMIT 3",Complex Aggregation Queries,movies,False,False,True,
What are the top 5 movies with ratings between 70 and 85?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating >= 70 AND r.rating <= 85
RETURN m.title, m.released, avg(r.rating) AS averageRating
ORDER BY averageRating DESC
LIMIT 5",Complex Aggregation Queries,movies,False,False,True,
Which movies have more than 3 actors listed?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WITH m, count(p) AS num_actors
WHERE num_actors > 3
RETURN m.title AS Movie, num_actors",Complex Aggregation Queries,movies,False,False,True,
Name the people who have followed more than 5 persons.,"MATCH (p:Person)
WHERE size((p)-[:FOLLOWS]->(:Person)) > 5
RETURN p.name",Complex Aggregation Queries,movies,False,False,True,
What is the average number of followers for people born in the 1980s?,"MATCH (p:Person)
WHERE p.born >= 1980 AND p.born <= 1989
WITH p, count{(p)<-[:FOLLOWS]-(:Person)} AS followers
RETURN avg(followers) AS average_followers",Complex Aggregation Queries,movies,False,False,True,
What are the top 5 movies with the least votes?,"MATCH (m:Movie)
WHERE m.votes IS NOT NULL
RETURN m
ORDER BY m.votes ASC
LIMIT 5",Complex Aggregation Queries,movies,False,False,False,
List the movies directed by people born before 1970.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born < 1970
RETURN m.title, m.released",Complex Aggregation Queries,movies,False,False,True,
"Name the first 3 movies reviewed with a summary 'Fun, but a little far fetched'.","MATCH (p:Person)-[r:REVIEWED {summary: 'Fun, but a little far fetched'}]->(m:Movie)
RETURN m.title
LIMIT 3",Complex Aggregation Queries,movies,False,False,True,
Which movies have been acted in by persons born after 1980?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born > 1980
RETURN m.title, m.released",Complex Aggregation Queries,movies,False,False,True,
List the people who have written and reviewed the same movie.,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:REVIEWED]-(p)
RETURN p.name, m.title",Complex Aggregation Queries,movies,False,False,True,
Who are the first 3 actors by the number of different movies acted in?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WITH p, count(DISTINCT m) AS movies_count
ORDER BY movies_count DESC
RETURN p.name, movies_count
LIMIT 3",Complex Aggregation Queries,movies,False,False,True,
What are the distinct summaries of reviews for movies released after 2000?,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)
WHERE m.released > 2000
RETURN DISTINCT m.title, p.summary",Complex Aggregation Queries,movies,False,False,True,Person.summary
List the first 3 movies with a tagline containing the word 'journey'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'journey'
RETURN m
LIMIT 3",Complex Aggregation Queries,movies,False,False,True,
Who has the most production credits in movies released in the 1990s?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE m.released >= 1990 AND m.released < 2000
WITH p, count(m) AS productions
RETURN p.name AS Producer, productions
ORDER BY productions DESC
LIMIT 1",Complex Aggregation Queries,movies,False,False,False,
Who are the top 3 producers by number of movies produced?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
RETURN p.name, count(m) AS movies_produced
ORDER BY movies_produced DESC
LIMIT 3",Complex Aggregation Queries,movies,False,False,False,
Which movies have the tagline 'Speed has no limits' and who are the producers?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie {tagline: 'Speed has no limits'})
RETURN m.title AS MovieTitle, collect(p.name) AS Producers",Simple Aggregation Queries,movies,False,False,False,
Find the first three movies reviewed with a rating above 90.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating > 90
RETURN m.title, r.rating
ORDER BY r.rating DESC
LIMIT 3",Verbose query,movies,True,False,False,
Which three people have reviewed a movie and also acted in a movie with a tagline containing 'no limits'?,"MATCH (p:Person)-[:REVIEWED]->(:Movie), (p)-[:ACTED_IN]->(m:Movie)
WHERE m.tagline CONTAINS 'no limits'
RETURN p.name
LIMIT 3",Verbose query,movies,True,False,False,
Find the first three movies with a tagline including 'speed' and a vote count over 500.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'speed' AND m.votes > 500
RETURN m
ORDER BY m.votes DESC
LIMIT 3",Verbose query,movies,False,False,True,
List the first three people who followed someone at least 20 years their junior.,"MATCH (p1:Person)-[:FOLLOWS]->(p2:Person)
WHERE p1.born - p2.born >= 20
RETURN p1
LIMIT 3",Verbose query,movies,False,False,False,
Retrieve the top five movies released before 1985 that were reviewed with a rating above 85.,"MATCH (m:Movie)<-[:REVIEWED {rating: r}]-(p:Person)
WHERE m.released < 1985 AND r > 85
RETURN m.title, m.released, m.tagline, collect(p.name) AS reviewers
ORDER BY m.released DESC
LIMIT 5",Verbose query,movies,True,False,False,
Who are the first three people who have produced a movie and followed more than two other people?,"MATCH (p:Person)-[:PRODUCED]->(:Movie)
WHERE size((p)-[:FOLLOWS]->()) > 2
RETURN p.name
LIMIT 3",Verbose query,movies,True,False,False,
What are the titles of the top 5 movies released after 2000 with more than 1000 votes?,"MATCH (m:Movie)
WHERE m.released > 2000 AND m.votes > 1000
RETURN m.title
ORDER BY m.votes DESC
LIMIT 5",Complex Retrieval Queries,movies,False,False,True,
List the names of the first 3 people born after 1970 who acted in a movie released before 1980.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born > 1970 AND m.released < 1980
RETURN p.name
ORDER BY p.born ASC
LIMIT 3",Complex Retrieval Queries,movies,False,False,True,
"Which 3 movies reviewed with a rating above 90 have the tagline 'Dark, but compelling'?","MATCH (m:Movie)<-[:REVIEWED {rating: r}]-(p:Person)
WHERE m.tagline = 'Dark, but compelling' AND r > 90
RETURN m.title AS MovieTitle, m.released AS ReleaseYear
ORDER BY m.released DESC
LIMIT 3",Complex Retrieval Queries,movies,False,False,False,
What are the top five movies that have been both written and reviewed by the same person?,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:REVIEWED]-(p)
RETURN m.title AS Movie, collect(p.name) AS WritersReviewers
ORDER BY m.votes DESC
LIMIT 5",Verbose query,movies,False,False,True,
Name the first 5 people who directed a movie with a tagline containing the word 'limits'.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.tagline CONTAINS 'limits'
RETURN p.name
LIMIT 5",Complex Retrieval Queries,movies,False,False,True,
List the top 5 movies with the highest votes that were released in the 1990s.,"MATCH (m:Movie)
WHERE m.released >= 1990 AND m.released < 2000
RETURN m
ORDER BY m.votes DESC
LIMIT 5",Complex Retrieval Queries,movies,False,False,False,
"Who are the first 3 people to review a movie with the tagline 'Fun, but a little far fetched'?","MATCH (p:Person)-[:REVIEWED]->(m:Movie {tagline: 'Fun, but a little far fetched'})
RETURN p.name
LIMIT 3",Complex Retrieval Queries,movies,False,False,False,
Name the top 5 actors who acted in a movie released in 1999.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie {released: 1999})
RETURN p.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 5",Complex Retrieval Queries,movies,False,False,False,
Find the first 3 movies where 'Keanu Reeves' acted.,"MATCH (p:Person {name: ""Keanu Reeves""})-[:ACTED_IN]->(m:Movie)
RETURN m
ORDER BY m.released
LIMIT 3",Complex Retrieval Queries,movies,False,False,True,
Who are the top 3 people that follow someone born in 1961?,"MATCH (p:Person)-[:FOLLOWS]->(followed:Person {born: 1961})
RETURN p.name, count(p) AS follows_count
ORDER BY follows_count DESC
LIMIT 3",Complex Retrieval Queries,movies,False,False,True,
List the top 3 movies with the lowest votes that a person born in 1952 acted in.,"MATCH (p:Person {born: 1952})-[:ACTED_IN]->(m:Movie)
WHERE m.votes IS NOT NULL
RETURN m
ORDER BY m.votes ASC
LIMIT 3",Complex Retrieval Queries,movies,False,False,False,
Which 3 people reviewed the movie titled 'The Matrix Revolutions'?,"MATCH (p:Person)-[:REVIEWED]->(m:Movie {title: 'The Matrix Revolutions'})
RETURN p.name
LIMIT 3",Complex Retrieval Queries,movies,False,False,False,
What are the first 3 movies produced by someone born before 1960?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.born < 1960
RETURN m
ORDER BY m.released
LIMIT 3",Complex Retrieval Queries,movies,False,False,True,
Who are the top five people born before 1960 who produced more than one movie?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.born < 1960
WITH p, count(m) AS moviesProduced
WHERE moviesProduced > 1
RETURN p.name, moviesProduced
ORDER BY moviesProduced DESC
LIMIT 5",Verbose query,movies,True,False,False,
Who are the first three actors who acted in more than three movies with a tagline containing the word 'limit'?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.tagline CONTAINS 'limit'
WITH p, count(m) AS movies_count
WHERE movies_count > 3
RETURN p.name
LIMIT 3",Verbose query,movies,False,False,True,
List the first three people who wrote a movie and also acted in a different movie.,"MATCH (p:Person)-[:WROTE]->(m1:Movie)
WHERE exists {
    (p)-[:ACTED_IN]->(m2:Movie)
    WHERE m1 <> m2
}
RETURN p
LIMIT 3",Verbose query,movies,False,False,True,
Retrieve the top five movies released in the 2000s that were either directed or produced by the same person.,"MATCH (p:Person)-[r:DIRECTED|PRODUCED]->(m:Movie)
WHERE m.released >= 2000 AND m.released < 2010
WITH m, COUNT(r) AS involvementCount
ORDER BY involvementCount DESC, m.released DESC
RETURN m.title, m.released, involvementCount
LIMIT 5",Verbose query,movies,False,False,True,
List the first three people who follow more than three other people.,"MATCH (p:Person)
WHERE size((p)-[:FOLLOWS]->(:Person)) > 3
RETURN p
LIMIT 3",Verbose query,movies,False,False,True,
What are the top five movies that received the highest number of votes and were released after 2000?,"MATCH (m:Movie)
WHERE m.released > 2000
RETURN m.title, m.votes
ORDER BY m.votes DESC
LIMIT 5",Verbose query,movies,False,False,False,
Who are the first three people who wrote a movie and were born in the 1950s?,"MATCH (p:Person)-[:WROTE]->(:Movie)
WHERE p.born >= 1950 AND p.born <= 1959
RETURN p
LIMIT 3",Verbose query,movies,False,False,True,
Find the first three movies with a tagline that includes the word 'journey' and were released before the year 2000.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'journey' AND m.released < 2000
RETURN m
ORDER BY m.released
LIMIT 3",Verbose query,movies,False,False,True,
Which top five movies have been both produced and directed by the same person?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS Movie, p.name AS ProducerDirector
ORDER BY m.votes DESC
LIMIT 5",Verbose query,movies,False,False,True,
List the first three actors who acted in a movie released after 2010 and have a born year after 1980.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.released > 2010 AND p.born > 1980
RETURN p.name, p.born, m.title, m.released
ORDER BY m.released ASC
LIMIT 3",Verbose query,movies,False,False,True,
Retrieve the top five oldest directors of movies released after 1990.,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE m.released > 1990
RETURN d.name, d.born, m.title, m.released
ORDER BY d.born ASC
LIMIT 5",Verbose query,movies,False,False,False,
"Retrieve the first three movies that were reviewed with the summary 'Dark, but compelling'.","MATCH (p:Person)-[r:REVIEWED {summary: 'Dark, but compelling'}]->(m:Movie)
RETURN m
LIMIT 3",Verbose query,movies,False,False,True,
Find the first three people who produced a movie and have a name starting with 'J'.,"MATCH (p:Person)-[:PRODUCED]->(:Movie)
WHERE p.name STARTS WITH 'J'
RETURN p
LIMIT 3",Verbose query,movies,False,False,False,
What are the top five movies that were directed by someone born before 1960 and have a vote count less than 100?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born < 1960 AND m.votes < 100
RETURN m
ORDER BY m.votes DESC
LIMIT 5",Verbose query,movies,False,False,True,
List the first three movies that were produced by someone with a name ending in 'son' and released after 2000.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.name ENDS WITH 'son' AND m.released > 2000
RETURN m.title, m.released
ORDER BY m.released ASC
LIMIT 3",Verbose query,movies,False,False,False,
Retrieve the top five people who have reviewed a movie with a rating less than 50.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating < 50
RETURN p.name, COUNT(m) AS movies_reviewed
ORDER BY movies_reviewed DESC
LIMIT 5",Verbose query,movies,False,False,True,
Who are the first three people who have directed and reviewed the same movie?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:REVIEWED]-(p)
RETURN p.name
LIMIT 3",Verbose query,movies,False,False,True,
What are the top five movies where the person who directed the movie was born in the 1940s?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born >= 1940 AND p.born < 1950
RETURN m
ORDER BY m.released DESC
LIMIT 5",Verbose query,movies,False,False,True,
"Find the first three movies that have been reviewed with the summary 'Silly, but fun' and were released in the 1990s.","MATCH (m:Movie)<-[:REVIEWED {summary: 'Silly, but fun'}]-(p:Person)
WHERE m.released >= 1990 AND m.released < 2000
RETURN m
LIMIT 3",Verbose query,movies,False,False,True,
"Who are the top five actors with the most diverse range of roles, having acted in at least five different movies?","MATCH (p:Person)-[a:ACTED_IN]->(m:Movie)
WITH p, count(DISTINCT m) AS moviesCount, collect(a.roles) AS roles
WHERE moviesCount >= 5
UNWIND roles AS roleList
WITH p, moviesCount, reduce(totalRoles = 0, r IN roleList | totalRoles + size(r)) AS totalRoles
RETURN p.name AS Actor, moviesCount AS MoviesCount, totalRoles AS TotalRoles
ORDER BY totalRoles DESC
LIMIT 5",Verbose query,movies,False,False,True,
List the movies where Joel Silver has a production role.,"MATCH (p:Person {name: ""Joel Silver""})-[:PRODUCED]->(m:Movie)
RETURN m.title AS MovieTitle, m.released AS ReleaseYear",Complex Aggregation Queries,movies,False,False,True,
What are the names of the people who wrote and also acted in the same movie?,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:ACTED_IN]-(p)
RETURN p.name AS PersonName",Simple Aggregation Queries,movies,False,False,True,
Which person has the most followers and who are they?,"MATCH (p:Person)
WITH p, count{(p)<-[:FOLLOWS]-(:Person)} AS followersCount
ORDER BY followersCount DESC
LIMIT 1
MATCH (follower:Person)-[:FOLLOWS]->(p)
RETURN p.name AS MostFollowedPerson, collect(follower.name) AS Followers",Simple Aggregation Queries,movies,False,False,True,
Who are the top 5 persons with the most reviews written?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
RETURN p.name, count(r) AS reviews_count
ORDER BY reviews_count DESC
LIMIT 5",Complex Aggregation Queries,movies,False,False,False,
What are the most common roles played by actors in movies from the 1990s?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE m.released >= 1990 AND m.released < 2000
UNWIND r.roles AS role
RETURN role, COUNT(role) AS role_count
ORDER BY role_count DESC",Complex Aggregation Queries,movies,False,False,True,
Which people were born in the 1960s and have acted in movies?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born >= 1960 AND p.born < 1970
RETURN p, collect(m) AS movies",Complex Aggregation Queries,movies,False,False,True,
List the movies with exactly 3 roles in the ACTED_IN relationship.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE size(r.roles) = 3
RETURN m.title AS MovieTitle, collect(p.name) AS Actors",Complex Aggregation Queries,movies,False,False,True,
Which movies have a tagline ending with 'world'?,"MATCH (m:Movie)
WHERE m.tagline ENDS WITH 'world'
RETURN m.title, m.tagline",Complex Aggregation Queries,movies,True,False,False,
Find the top 5 movies with the lowest ratings in REVIEWS.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
RETURN m.title AS Movie, r.rating AS Rating
ORDER BY r.rating ASC
LIMIT 5",Complex Aggregation Queries,movies,False,False,True,
Who are the actors in the movie with the highest number of votes?,"MATCH (m:Movie)
WHERE m.votes IS NOT NULL
WITH m ORDER BY m.votes DESC LIMIT 1
MATCH (p:Person)-[:ACTED_IN]->(m)
RETURN p.name AS ActorName",Complex Aggregation Queries,movies,False,False,False,
List all persons who have produced more than 3 movies.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WITH p, count(m) AS moviesProduced
WHERE moviesProduced > 3
RETURN p.name, moviesProduced",Complex Aggregation Queries,movies,False,False,True,
What are the roles played by Laurence Fishburne in 'The Matrix Revolutions'?,"MATCH (p:Person {name: ""Laurence Fishburne""})-[:ACTED_IN {roles: roles}]->(m:Movie {title: ""The Matrix Revolutions""})
RETURN roles",Complex Aggregation Queries,movies,False,False,True,
Which movies have been acted in by persons born before 1950?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born < 1950
RETURN m.title, m.released",Complex Aggregation Queries,movies,False,False,False,
List the top 3 movies reviewed by the youngest reviewers.,"MATCH (reviewer:Person)-[r:REVIEWED]->(movie:Movie)
WHERE reviewer.born IS NOT NULL
WITH movie, r, reviewer
ORDER BY reviewer.born DESC
LIMIT 3
RETURN movie.title AS MovieTitle, movie.released AS ReleaseYear, r.rating AS Rating, r.summary AS Summary, reviewer.name AS ReviewerName, reviewer.born AS ReviewerBirthYear",Complex Aggregation Queries,movies,False,False,True,
Who has directed the most movies released after 2000?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.released > 2000
WITH p, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 1
RETURN p.name AS director, movies_count",Complex Aggregation Queries,movies,False,False,True,
List all movies that have multiple reviews.,"MATCH (m:Movie)
WHERE exists {
    (p:Person)-[:REVIEWED]->(m)
}
WITH m, count{(p:Person)-[:REVIEWED]->(m)} AS reviewsCount
WHERE reviewsCount > 1
RETURN m",Complex Aggregation Queries,movies,False,False,True,
What are the common roles for Keanu Reeves across all his movies?,"MATCH (p:Person {name: ""Keanu Reeves""})-[:ACTED_IN]->(m:Movie)
UNWIND m.roles AS role
RETURN role, count(*) AS frequency
ORDER BY frequency DESC",Complex Aggregation Queries,movies,False,False,False,Movie.roles
List the top 5 movies with the most diverse cast in terms of birth years.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WITH m, count(DISTINCT p.born) AS diversity
ORDER BY diversity DESC
LIMIT 5
RETURN m.title, diversity",Complex Aggregation Queries,movies,False,False,True,
"List the persons who have written, directed, and produced the same movie.","MATCH (p:Person)-[:WROTE]->(m:Movie)
MATCH (p)-[:DIRECTED]->(m)
MATCH (p)-[:PRODUCED]->(m)
RETURN p.name, m.title",Complex Aggregation Queries,movies,False,False,True,
Which movies have been reviewed with a rating of 100?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating = 100
RETURN m.title AS MovieTitle, p.name AS ReviewerName",Complex Aggregation Queries,movies,False,False,False,
List all movies where the same person has acted and produced.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie), (p)-[:PRODUCED]->(m)
RETURN m.title AS MovieTitle, m.released AS ReleaseYear",Complex Aggregation Queries,movies,False,False,True,
Who has the most roles in a single movie?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
RETURN p.name, m.title, size(r.roles) AS num_roles
ORDER BY num_roles DESC
LIMIT 1",Complex Aggregation Queries,movies,False,False,False,
List the top 5 movies with the most roles listed in ACTED_IN relationship.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
RETURN m.title, count(r.roles) AS total_roles
ORDER BY total_roles DESC
LIMIT 5",Complex Aggregation Queries,movies,False,False,True,
Who are the people that Keanu Reeves follows?,"MATCH (p:Person {name: ""Keanu Reeves""})-[:FOLLOWS]->(followed:Person)
RETURN followed",Complex Aggregation Queries,movies,False,False,True,
List all persons who have reviewed a movie with a rating less than 50.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating < 50
RETURN p",Complex Aggregation Queries,movies,False,False,True,
"Who has produced, directed, and acted in the same movie?","MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:DIRECTED]-(p)-[:ACTED_IN]->(m)
RETURN p.name, m.title",Complex Aggregation Queries,movies,False,False,True,
"Find all movies with a summary 'Dark, but compelling'.","MATCH (m:Movie)<-[:REVIEWED {summary: 'Dark, but compelling'}]-(:Person)
RETURN m",Complex Aggregation Queries,movies,False,False,True,
Which person has the highest number of followers?,"MATCH (p:Person)
RETURN p, count{(p)<-[:FOLLOWS]-(:Person)} AS followers
ORDER BY followers DESC
LIMIT 1",Complex Aggregation Queries,movies,False,False,True,
List all movies with a vote count between 100 and 500.,"MATCH (m:Movie)
WHERE m.votes >= 100 AND m.votes <= 500
RETURN m",Complex Aggregation Queries,movies,False,False,True,
Who has reviewed movies directed by Lana Wachowski?,"MATCH (reviewer:Person)-[:REVIEWED]->(movie:Movie)<-[:DIRECTED]-(director:Person {name: ""Lana Wachowski""})
RETURN DISTINCT reviewer.name",Complex Aggregation Queries,movies,False,False,True,
Who are the top 3 youngest directors in the database?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
RETURN p.name, p.born
ORDER BY p.born DESC
LIMIT 3",Complex Aggregation Queries,movies,False,False,True,
Which movies have been produced by more than one person?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WITH m, count(p) AS producers_count
WHERE producers_count > 1
RETURN m.title AS Movie, producers_count",Complex Aggregation Queries,movies,False,False,True,
List the top 5 movies with the highest release year.,"MATCH (m:Movie)
RETURN m
ORDER BY m.released DESC
LIMIT 5",Complex Aggregation Queries,movies,False,False,False,
Who has acted in movies directed by Lana Wachowski?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(director:Person {name: ""Lana Wachowski""})
RETURN p.name AS Actor",Complex Aggregation Queries,movies,False,False,False,
List the top 3 oldest actors in the database.,"MATCH (p:Person)-[:ACTED_IN]->(:Movie)
RETURN p.name, p.born
ORDER BY p.born ASC
LIMIT 3",Complex Aggregation Queries,movies,False,False,True,
What roles are available in the ACTED_IN relationship for movies released before 2000?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE m.released < 2000
RETURN m.title, r.roles",Complex Aggregation Queries,movies,False,False,True,
Which people have both acted in and reviewed the same movie?,"MATCH (p:Person)-[a:ACTED_IN]->(m:Movie)<-[r:REVIEWED]-(p)
RETURN p.name, m.title, a.roles, r.summary, r.rating",Complex Aggregation Queries,movies,False,False,True,
List all persons who have directed a movie and also follow someone.,"MATCH (p:Person)-[:DIRECTED]->(:Movie)
WHERE exists{ (p)-[:FOLLOWS]->(:Person) }
RETURN p.name",Complex Aggregation Queries,movies,False,False,True,
What are the distinct summaries available for movie reviews?,"MATCH (:Person)-[r:REVIEWED]->(:Movie)
RETURN DISTINCT r.summary",Complex Aggregation Queries,movies,False,False,False,
List the top 3 actors with roles in movies released before 1980.,"MATCH (p:Person)-[a:ACTED_IN]->(m:Movie)
WHERE m.released < 1980
RETURN p.name, collect(m.title) AS movies, count(a) AS roles_count
ORDER BY roles_count DESC
LIMIT 3",Complex Aggregation Queries,movies,False,False,True,
Which movies have been produced and directed by the same person?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS Movie, p.name AS ProducerDirector",Complex Aggregation Queries,movies,False,False,True,
"Find all movies with a summary 'Fun, but a little far fetched'.","MATCH (m:Movie)<-[:REVIEWED {summary: 'Fun, but a little far fetched'}]-(:Person)
RETURN m",Complex Aggregation Queries,movies,False,False,False,
Name 3 people who were born after 1980 and have directed a movie.,"MATCH (p:Person)-[:DIRECTED]->(:Movie)
WHERE p.born > 1980
RETURN p.name
LIMIT 3",Verbose query,movies,False,False,True,
Who wrote 'Something's Gotta Give' and what is the movie's release year?,"MATCH (p:Person)-[:WROTE]->(m:Movie {title: ""Something's Gotta Give""})
RETURN p.name AS writer, m.released AS releaseYear",Verbose query,movies,False,False,True,
What are the top 3 least voted for movies in the database?,"MATCH (m:Movie)
WHERE m.votes IS NOT NULL
RETURN m
ORDER BY m.votes ASC
LIMIT 3",Verbose query,movies,False,False,True,
List 3 actors who also have roles as producers.,"MATCH (p:Person)-[:ACTED_IN]->(:Movie), (p)-[:PRODUCED]->(:Movie)
RETURN DISTINCT p.name
LIMIT 3",Verbose query,movies,False,False,True,
Which movies have a tagline containing the word 'limit'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'limit'
RETURN m.title, m.tagline",Verbose query,movies,False,False,True,
Who reviewed the movie with the highest rating and what was the summary?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
RETURN p.name AS reviewer, r.summary AS review_summary, r.rating AS rating
ORDER BY r.rating DESC
LIMIT 1",Verbose query,movies,False,False,True,
List movies that have been both acted in and directed by the same person.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS MovieTitle, p.name AS PersonName",Verbose query,movies,False,False,False,
List the top 3 highest-rated movies by reviews.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
RETURN m.title, avg(r.rating) AS average_rating
ORDER BY average_rating DESC
LIMIT 3",Verbose query,movies,False,False,True,
Who are the top 3 youngest producers in the database?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
RETURN p.name, p.born
ORDER BY p.born DESC
LIMIT 3",Verbose query,movies,False,False,True,
What are the roles played by actors in 'Speed Racer'?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie {title: 'Speed Racer'})
RETURN p.name, r.roles",Verbose query,movies,False,False,True,
Name 3 persons who have reviewed a movie and also acted in a different movie.,"MATCH (p:Person)-[:REVIEWED]->(m1:Movie)
WHERE exists {
    (p)-[:ACTED_IN]->(m2:Movie)
    WHERE m1 <> m2
}
RETURN p.name
LIMIT 3",Verbose query,movies,False,False,True,
How many people have directed more than two movies?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WITH p, count(m) AS moviesDirected
WHERE moviesDirected > 2
RETURN count(p) AS directorsCount",Verbose query,movies,False,False,True,
List the movies that have been produced and directed by the same person.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS MovieTitle, p.name AS ProducerDirector",Verbose query,movies,False,False,True,
Which person has the most relationships of any type in the database?,"MATCH (p:Person)
RETURN p, count{(p)--()} AS totalRelationships
ORDER BY totalRelationships DESC
LIMIT 1",Verbose query,movies,False,False,True,
Name 3 movies that Keanu Reeves has acted in.,"MATCH (p:Person {name: ""Keanu Reeves""})-[:ACTED_IN]->(m:Movie)
RETURN m.title
LIMIT 3",Verbose query,movies,False,False,True,
What are the top 3 oldest movies in the database by release year?,"MATCH (m:Movie)
RETURN m
ORDER BY m.released ASC
LIMIT 3",Verbose query,movies,True,False,False,
List 3 movies with the tagline including the word 'real'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'real'
RETURN m.title, m.tagline
LIMIT 3",Verbose query,movies,False,False,False,
Which movies have been both acted in and directed by the same person?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS Movie, p.name AS Person",Complex Aggregation Queries,movies,False,False,False,
Which movies did Lana Wachowski direct?,"MATCH (p:Person {name: ""Lana Wachowski""})-[:DIRECTED]->(m:Movie)
RETURN m.title AS MovieTitle",Verbose query,movies,False,False,True,
What are the roles of Keanu Reeves in 'The Matrix'?,"MATCH (p:Person {name: ""Keanu Reeves""})-[:ACTED_IN {roles: roles}]->(m:Movie {title: ""The Matrix""})
RETURN roles",Verbose query,movies,False,False,True,
Which actors have acted in both 'The Matrix' and 'Speed Racer'?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.title IN ['The Matrix', 'Speed Racer']
WITH p, count(m) AS movies_count
WHERE movies_count = 2
RETURN p.name",Complex Aggregation Queries,movies,False,False,True,
List all movies that Joel Silver has both produced and reviewed.,"MATCH (p:Person {name: ""Joel Silver""})-[:PRODUCED]->(m:Movie)
WHERE exists {
  (p)-[:REVIEWED]->(m)
}
RETURN m.title AS MovieTitle, m.released AS ReleaseYear",Complex Aggregation Queries,movies,False,False,True,
Who are the directors of movies with more than 1000 votes?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.votes > 1000
RETURN p.name AS Director, m.title AS Movie",Complex Aggregation Queries,movies,False,False,True,
List the top 5 oldest movies in the database.,"MATCH (m:Movie)
RETURN m
ORDER BY m.released ASC
LIMIT 5",Complex Aggregation Queries,movies,False,False,True,
What are the roles played by actors in the movie 'Speed Racer'?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie {title: 'Speed Racer'})
RETURN p.name, r.roles",Complex Aggregation Queries,movies,False,False,True,
Which movies have been reviewed by more than two persons?,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)
WITH m, count(p) AS reviewers_count
WHERE reviewers_count > 2
RETURN m.title AS Movie, reviewers_count",Complex Aggregation Queries,movies,False,False,True,
What are the top 5 movies released between 2000 and 2010?,"MATCH (m:Movie)
WHERE m.released >= 2000 AND m.released <= 2010
RETURN m
ORDER BY m.released DESC
LIMIT 5",Verbose query,movies,False,False,True,
Who produced 'Speed Racer' and what year was it released?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie {title: 'Speed Racer'})
RETURN p.name AS Producer, m.released AS ReleaseYear",Verbose query,movies,False,False,True,
List 3 people born before 1960.,"MATCH (p:Person)
WHERE p.born < 1960
RETURN p
LIMIT 3",Verbose query,movies,False,False,True,
Name 3 persons who acted in a movie released before 1980.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.released < 1980
RETURN p.name
LIMIT 3",Verbose query,movies,False,False,True,
Who are the top 5 directors of movies released after 1995?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE m.released > 1995
RETURN d.name, count(m) AS movies_directed
ORDER BY movies_directed DESC
LIMIT 5",Verbose query,movies,False,False,False,
What are the top 3 movies with the highest number of votes?,"MATCH (m:Movie)
WHERE m.votes IS NOT NULL
RETURN m.title, m.votes
ORDER BY m.votes DESC
LIMIT 3",Verbose query,movies,False,False,True,
List 3 actors who have acted in more than one movie.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WITH p, count(m) AS movie_count
WHERE movie_count > 1
RETURN p.name, movie_count
LIMIT 3",Verbose query,movies,False,False,True,
Which person has directed the most films? Limit to top 3.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WITH p, count(m) AS films_directed
ORDER BY films_directed DESC
LIMIT 3
RETURN p.name, films_directed",Verbose query,movies,False,False,True,
Who are the people that Keanu Reeves follows?,"MATCH (p:Person {name: ""Keanu Reeves""})-[:FOLLOWS]->(followed:Person)
RETURN followed",Verbose query,movies,True,False,False,
List three movies reviewed with a rating above 90.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating > 90
RETURN m.title AS MovieTitle, r.rating AS Rating
LIMIT 3",Verbose query,movies,False,False,True,
Which movies have more than 5000 votes?,"MATCH (m:Movie)
WHERE m.votes > 5000
RETURN m.title, m.votes",Verbose query,movies,False,False,True,
List all movies with a tagline that includes 'Welcome'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'Welcome'
RETURN m",Complex Aggregation Queries,movies,False,False,True,
What are the roles played by Keanu Reeves in 'The Matrix'?,"MATCH (p:Person {name: ""Keanu Reeves""})-[:ACTED_IN {roles: roles}]->(m:Movie {title: ""The Matrix""})
RETURN roles",Complex Aggregation Queries,movies,False,False,True,
Who has directed more than one movie?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WITH p, count(m) AS movies_directed
WHERE movies_directed > 1
RETURN p.name, movies_directed",Complex Aggregation Queries,movies,False,False,True,
What are the first 3 movies reviewed by people with a review summary 'Pretty funny at times' and their ratings?,"MATCH (p:Person)-[r:REVIEWED {summary: 'Pretty funny at times'}]->(m:Movie)
RETURN m.title, r.rating
ORDER BY m.released
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Who directed the first 3 movies reviewed with a rating of 100 and what are their titles?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:REVIEWED {rating: 100}]-(reviewer:Person)
RETURN p.name AS Director, m.title AS MovieTitle
ORDER BY m.released ASC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
What are the names of the top 3 oldest actors and the movies they have produced?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
RETURN p.name, m.title
ORDER BY p.born ASC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
List the first 3 movies with a tagline including the word 'world' and their release years.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'world'
RETURN m.title, m.released
ORDER BY m.released
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Which movies released before 2000 have a person who both acted and directed in them?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
WHERE m.released < 2000
RETURN m.title, m.released",Simple Aggregation Queries,movies,False,False,False,
What are the first 3 movies where Nancy Meyers was involved as a writer and their release years?,"MATCH (p:Person {name: ""Nancy Meyers""})-[:WROTE]->(m:Movie)
RETURN m.title AS MovieTitle, m.released AS ReleaseYear
ORDER BY m.released
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Who are the top 5 people who have acted in the most number of movies with a tagline?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.tagline IS NOT NULL
WITH p, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 5
RETURN p.name, movies_count",Simple Aggregation Queries,movies,False,False,True,
List the roles of actors in the 3 movies with the highest number of actors involved.,"MATCH (m:Movie)<-[:ACTED_IN]-(p:Person)
WITH m, count(p) AS num_actors
ORDER BY num_actors DESC
LIMIT 3
MATCH (p:Person)-[r:ACTED_IN]->(m)
RETURN m.title, collect(p.name) AS actors, collect(r.roles) AS roles",Simple Aggregation Queries,movies,False,False,True,
List the first 3 movies with at least one role listed as 'Villain' and their actors.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE 'Villain' IN r.roles
RETURN m.title AS Movie, collect(p.name) AS Actors
LIMIT 3",Simple Aggregation Queries,movies,True,False,False,
Which movies have been reviewed with a summary 'The coolest football movie ever' and who reviewed them?,"MATCH (p:Person)-[r:REVIEWED {summary: 'The coolest football movie ever'}]->(m:Movie)
RETURN m.title AS MovieTitle, p.name AS ReviewerName",Simple Aggregation Queries,movies,False,False,False,
What is the average number of votes for movies directed by people born before 1950?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born < 1950
RETURN AVG(m.votes) AS average_votes",Simple Aggregation Queries,movies,False,False,True,
Who are the first 3 people to have written and directed the same movie and what are those movies?,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:DIRECTED]-(p)
RETURN p.name, m.title
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
List the top 5 movies with roles including 'Doctor' and the actors who played them.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE any(role IN r.roles WHERE role CONTAINS 'Doctor')
RETURN m.title AS Movie, collect(p.name) AS Actors
ORDER BY m.votes DESC
LIMIT 5",Simple Aggregation Queries,movies,False,False,True,
Which movies have a person who both produced and reviewed them and what are their titles?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:REVIEWED]-(p)
RETURN m.title AS MovieTitle",Simple Aggregation Queries,movies,False,False,True,
What are the first 3 movies where the directors were also actors and their titles?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(p)
RETURN m.title AS MovieTitle
LIMIT 3",Simple Aggregation Queries,movies,False,False,False,
List the top 5 movies with the highest number of different actors involved.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WITH m, count(DISTINCT p) AS num_actors
ORDER BY num_actors DESC
LIMIT 5
RETURN m.title, num_actors",Simple Aggregation Queries,movies,False,False,True,
What are the first 3 movies produced by people born in the 1950s?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.born >= 1950 AND p.born < 1960
RETURN m
ORDER BY m.released
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Who are the first 3 oldest directors and the movies they have directed?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
RETURN p.name, m.title, p.born
ORDER BY p.born ASC
LIMIT 3",Simple Aggregation Queries,movies,True,False,False,
Which movies have been directed by a person born in 1970 and what are their titles?,"MATCH (p:Person {born: 1970})-[:DIRECTED]->(m:Movie)
RETURN m.title AS MovieTitle",Simple Aggregation Queries,movies,False,False,True,
Who are the first 3 youngest actors to have directed a movie?,"MATCH (p:Person)-[:ACTED_IN]->(:Movie), (p)-[:DIRECTED]->(:Movie)
RETURN p.name, p.born
ORDER BY p.born DESC
LIMIT 3",Simple Aggregation Queries,movies,True,False,False,
What are the top 5 movies with the most actors involved and their release years?,"MATCH (a:Person)-[:ACTED_IN]->(m:Movie)
WITH m, count(a) AS num_actors
ORDER BY num_actors DESC
LIMIT 5
RETURN m.title AS Movie, m.released AS ReleaseYear, num_actors AS NumberOfActors",Simple Aggregation Queries,movies,False,False,False,
Who reviewed the movie with the highest votes and what was the summary?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE m.votes = (SELECT max(m2.votes) FROM Movie m2)
RETURN p.name AS reviewer, r.summary AS review_summary",Simple Aggregation Queries,movies,False,False,False,
List the first 3 movies that have been produced and directed by the same person.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS MovieTitle, m.released AS ReleaseYear
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
What are the roles of Keanu Reeves in movies he reviewed with a rating above 90?,"MATCH (p:Person {name: ""Keanu Reeves""})-[:ACTED_IN]->(m:Movie)<-[:REVIEWED {rating: r}]-(p)
WHERE r > 90
RETURN m.title AS Movie, r.roles AS Roles",Simple Aggregation Queries,movies,False,False,True,
Who are the first 3 directors born after 1970 and the movies they directed?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born > 1970
RETURN p.name, m.title
ORDER BY p.born ASC
LIMIT 3",Simple Aggregation Queries,movies,False,False,False,
List the movies that have been reviewed and also have a tagline including the word 'journey'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'journey' AND exists{(m)<-[:REVIEWED]-(:Person)}
RETURN m.title, m.tagline",Simple Aggregation Queries,movies,False,False,True,
Which movies released in the 1990s have been acted in by more than 5 people?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.released >= 1990 AND m.released < 2000
WITH m, count(p) AS actorCount
WHERE actorCount > 5
RETURN m.title, m.released, actorCount",Simple Aggregation Queries,movies,False,False,False,
What are the first 3 movies where Keanu Reeves and Laurence Fishburne acted together?,"MATCH (kr:Person {name: ""Keanu Reeves""})-[:ACTED_IN]->(m:Movie)<-[:ACTED_IN]-(lf:Person {name: ""Laurence Fishburne""})
RETURN m.title AS MovieTitle
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
What are the top 5 reviewed movies by people born in the 1980s and their ratings?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE p.born >= 1980 AND p.born < 1990
RETURN m.title, r.rating
ORDER BY r.rating DESC
LIMIT 5",Simple Aggregation Queries,movies,False,False,True,
What are the names of the first 3 movies directed by a person born in 1949?,"MATCH (p:Person {born: 1949})-[:DIRECTED]->(m:Movie)
RETURN m.title AS MovieTitle
ORDER BY m.released
LIMIT 3",Simple Aggregation Queries,movies,False,False,False,
Who are the first 3 people to have reviewed and also produced the same movie?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:REVIEWED]-(p)
RETURN p.name AS PersonName
LIMIT 3",Simple Aggregation Queries,movies,False,False,False,
What is the average age of directors of the top 5 voted movies?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WITH m, d, m.votes AS votes
ORDER BY votes DESC
LIMIT 5
RETURN avg(2023 - d.born) AS average_age_of_directors",Simple Aggregation Queries,movies,True,False,False,
List the top 3 actors who have acted in movies with a tagline including the word 'limits'.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.tagline CONTAINS 'limits'
WITH p, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3
RETURN p.name, movies_count",Simple Aggregation Queries,movies,False,False,True,
Which movies have a role listed as 'Hero' and who are the actors?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE 'Hero' IN r.roles
RETURN m.title AS Movie, p.name AS Actor",Simple Aggregation Queries,movies,False,False,False,
What are the first 3 movies with the highest ratings reviewed by people born after 1980?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE p.born > 1980
RETURN m.title, r.rating
ORDER BY r.rating DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
List the top 5 movies by the number of roles and their respective actors.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WITH m, collect({actor: p.name, roles: r.roles}) AS actors_roles
ORDER BY size(r.roles) DESC
RETURN m.title AS Movie, actors_roles
LIMIT 5",Simple Aggregation Queries,movies,False,False,True,
List the first 3 movies with roles that include 'Captain' and their actors.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE any(role IN r.roles WHERE role CONTAINS 'Captain')
RETURN m.title, p.name, r.roles
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
List the first 3 movies reviewed by a person born before 1950 and their review summaries.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE p.born < 1950
RETURN m.title, r.summary
LIMIT 3",Simple Aggregation Queries,movies,False,False,False,
What are the first 3 movies with a review summary 'An amazing journey' and their ratings?,"MATCH (m:Movie)<-[r:REVIEWED {summary: 'An amazing journey'}]-(p:Person)
RETURN m.title, r.rating
ORDER BY m.released
LIMIT 3",Simple Aggregation Queries,movies,False,False,False,
Which movies released in the 2000s have been acted in by more than 3 people?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.released >= 2000 AND m.released < 2010
WITH m, count(p) AS actorCount
WHERE actorCount > 3
RETURN m.title, m.released, actorCount",Simple Aggregation Queries,movies,False,False,True,
Who are the top 3 actors with roles in the most diverse genres (based on taglines)?,"MATCH (p:Person)-[a:ACTED_IN]->(m:Movie)
WITH p, count(DISTINCT m.tagline) AS diversity
ORDER BY diversity DESC
LIMIT 3
RETURN p.name AS Actor, diversity AS GenreDiversity",Pathfinding Queries,movies,False,False,True,
Which movies have been reviewed with a summary containing 'amazing journey' and have a rating less than 80?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.summary CONTAINS 'amazing journey' AND r.rating < 80
RETURN m",Pathfinding Queries,movies,False,False,True,
Name the first 3 people who produced a movie that they also acted in.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE exists{(p)-[:ACTED_IN]->(m)}
RETURN p.name
LIMIT 3",Pathfinding Queries,movies,False,False,True,
Which movies released between 1990 and 2000 have more than 5000 votes?,"MATCH (m:Movie)
WHERE m.released >= 1990 AND m.released <= 2000 AND m.votes > 5000
RETURN m.title, m.released, m.votes",Complex Aggregation Queries,movies,False,False,True,
List all movies directed by Lana Wachowski.,"MATCH (p:Person {name: ""Lana Wachowski""})-[:DIRECTED]->(m:Movie)
RETURN m",Complex Aggregation Queries,movies,False,False,True,
Find the top 3 actors by number of movies acted in from 1990 to 2000.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.released >= 1990 AND m.released <= 2000
RETURN p.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3",Complex Aggregation Queries,movies,False,False,True,
What are the top 5 most voted movies?,"MATCH (m:Movie)
WHERE m.votes IS NOT NULL
RETURN m.title, m.votes
ORDER BY m.votes DESC
LIMIT 5",Complex Aggregation Queries,movies,False,False,True,
List the first 3 people who have written and directed the same movie released after 2000.,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:DIRECTED]-(p)
WHERE m.released > 2000
RETURN p.name, m.title, m.released
LIMIT 3",Pathfinding Queries,movies,False,False,True,
Who are the actors that acted in 'The Matrix'?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie {title: 'The Matrix'})
RETURN p.name",Complex Aggregation Queries,movies,False,False,True,
List all movies produced by Joel Silver.,"MATCH (p:Person {name: ""Joel Silver""})-[:PRODUCED]->(m:Movie)
RETURN m",Complex Aggregation Queries,movies,False,False,True,
Which movies were released in 1999?,"MATCH (m:Movie)
WHERE m.released = 1999
RETURN m.title, m.tagline, m.votes",Complex Aggregation Queries,movies,False,False,True,
Who wrote the movie 'Speed Racer'?,"MATCH (p:Person)-[:WROTE]->(m:Movie)
WHERE m.title = 'Speed Racer'
RETURN p.name",Complex Aggregation Queries,movies,False,False,False,
Find all movies with a rating above 90.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating > 90
RETURN m.title, m.released, r.rating, r.summary",Complex Aggregation Queries,movies,False,False,True,
Show the top 3 movies with the lowest number of votes.,"MATCH (m:Movie)
WHERE m.votes IS NOT NULL
RETURN m
ORDER BY m.votes ASC
LIMIT 3",Complex Aggregation Queries,movies,False,False,True,
Which people were born between 1940 and 1960?,"MATCH (p:Person)
WHERE p.born >= 1940 AND p.born <= 1960
RETURN p",Complex Aggregation Queries,movies,False,False,True,
List all movies reviewed by people born after 1960.,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)
WHERE p.born > 1960
RETURN m",Complex Aggregation Queries,movies,False,False,True,
Which movies have a tagline containing the word 'limit'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'limit'
RETURN m.title, m.tagline",Complex Aggregation Queries,movies,False,False,False,
List the roles of actors in the first 3 movies produced by a person born after 1980.,"MATCH (p:Person {born: $born})-[:PRODUCED]->(m:Movie)
WITH m
ORDER BY m.released
LIMIT 3
MATCH (actor:Person)-[r:ACTED_IN]->(m)
RETURN m.title, actor.name, r.roles",Simple Aggregation Queries,movies,False,False,False,
What are the top 5 movies with a tagline containing the word 'Houston'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'Houston'
RETURN m
ORDER BY m.votes DESC
LIMIT 5",Pathfinding Queries,movies,False,False,True,
Name the first 3 movies with a tagline that includes the word 'real' and were released before 2000.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'real' AND m.released < 2000
RETURN m.title
ORDER BY m.released
LIMIT 3",Pathfinding Queries,movies,False,False,True,
What are the top 5 movies directed by people born in the 1960s and their release years?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born >= 1960 AND p.born < 1970
RETURN m.title AS Movie, m.released AS ReleaseYear
ORDER BY m.released DESC
LIMIT 5",Simple Aggregation Queries,movies,False,False,True,
List the first 3 movies reviewed by a person named 'Nancy Meyers' and their review summaries.,"MATCH (p:Person {name: 'Nancy Meyers'})-[:REVIEWED]->(m:Movie)
RETURN m.title, m.released, m.tagline, m.votes, [(p)-[:REVIEWED]->(m) | m.summary][0] AS summary
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
What are the first 3 movies with a tagline including the word 'fun' and their release years?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'fun'
RETURN m.title, m.released
ORDER BY m.released
LIMIT 3",Simple Aggregation Queries,movies,False,False,False,
Who are the top 3 actors born after 1970 who acted in movies released before 2000?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born > 1970 AND m.released < 2000
RETURN p.name, p.born, collect(m.title) AS movies
ORDER BY p.born
LIMIT 3",Pathfinding Queries,movies,True,False,False,
What are the top 5 movies with the most votes released after 2000?,"MATCH (m:Movie)
WHERE m.released > 2000
RETURN m.title, m.votes
ORDER BY m.votes DESC
LIMIT 5",Pathfinding Queries,movies,False,False,True,
List the first 3 people who directed and also acted in the same movie.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(p)
RETURN p.name, m.title
LIMIT 3",Pathfinding Queries,movies,False,False,False,
Who are the top 3 youngest directors of movies released in the 1990s?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.released >= 1990 AND m.released < 2000
RETURN p.name, p.born, m.title, m.released
ORDER BY p.born DESC
LIMIT 3",Pathfinding Queries,movies,False,False,False,
Which people have acted in and also reviewed the same movie? List the first 3.,"MATCH (p:Person)-[a:ACTED_IN]->(m:Movie)<-[r:REVIEWED]-(p)
RETURN p.name, m.title, a.roles, r.summary, r.rating
LIMIT 3",Pathfinding Queries,movies,True,False,False,
Which movies released between 1980 and 1990 have been reviewed with a rating higher than 80?,"MATCH (m:Movie)<-[:REVIEWED {rating: r}]-(p:Person)
WHERE m.released >= 1980 AND m.released <= 1990 AND r > 80
RETURN m.title, m.released, r AS rating",Pathfinding Queries,movies,False,False,False,
What are the top 3 movies with the lowest votes released before 1980?,"MATCH (m:Movie)
WHERE m.released < 1980 AND m.votes IS NOT NULL
RETURN m
ORDER BY m.votes ASC
LIMIT 3",Pathfinding Queries,movies,False,False,True,
List the first 3 actors born before 1950 who reviewed a movie with a summary containing the word 'funny'.,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)
WHERE p.born < 1950 AND m.summary CONTAINS 'funny'
WITH p
MATCH (p)-[:ACTED_IN]->(m:Movie)
RETURN p.name, p.born, collect(m.title) AS movies
LIMIT 3",Pathfinding Queries,movies,True,False,False,Movie.summary
Which directors were born after 1960 and directed a movie with a tagline containing the word 'speed'?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born > 1960 AND m.tagline CONTAINS 'speed'
RETURN p.name, m.title, m.tagline",Pathfinding Queries,movies,False,False,False,
Name the first 3 people who follow more than 5 other people.,"MATCH (p:Person)
WHERE size{(p)-[:FOLLOWS]->(:Person)} > 5
RETURN p.name
LIMIT 3",Pathfinding Queries,movies,False,False,True,
List the first 3 movies that were both written and reviewed by the same person.,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:REVIEWED]-(p)
RETURN m.title AS MovieTitle, m.released AS ReleaseYear, p.name AS PersonName
LIMIT 3",Pathfinding Queries,movies,False,False,True,
"Who are the top 5 actors by number of movies acted in, with each movie having at least 100 votes?","MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.votes >= 100
WITH p, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 5
RETURN p.name, movies_count",Pathfinding Queries,movies,False,False,True,
What are the first 3 movies produced by persons born before 1960 with a rating over 90?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.born < 1960 AND exists {
  (p)-[:REVIEWED {rating: r}]->(m)
  WHERE r > 90
}
RETURN m.title AS MovieTitle, m.released AS ReleaseYear
ORDER BY m.released
LIMIT 3",Pathfinding Queries,movies,False,False,True,
Name the first 3 actors who have acted in more than one movie with a tagline containing the word 'freedom'.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.tagline CONTAINS 'freedom'
WITH p, count(m) AS moviesCount
WHERE moviesCount > 1
RETURN p.name
LIMIT 3",Pathfinding Queries,movies,False,False,True,
What are the roles of actors in 'Speed Racer'?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie {title: 'Speed Racer'})
RETURN p.name, r.roles",Complex Aggregation Queries,movies,False,False,True,
Who are the top 3 reviewers by average rating given?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WITH p, AVG(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN p.name AS Reviewer, avgRating",Complex Aggregation Queries,movies,False,False,True,
Which person has the most followers?,"MATCH (p:Person)
RETURN p, count{(p)<-[:FOLLOWS]-(:Person)} AS followers
ORDER BY followers DESC
LIMIT 1",Complex Aggregation Queries,movies,False,False,True,
What are the titles of the top 5 movies with the highest number of votes?,"MATCH (m:Movie)
WHERE m.votes IS NOT NULL
RETURN m.title
ORDER BY m.votes DESC
LIMIT 5",Simple Aggregation Queries,movies,False,False,True,
List the names of 3 persons who were born after 1980.,"MATCH (p:Person)
WHERE p.born > 1980
RETURN p.name
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Which movies were released between 1990 and 2000?,"MATCH (m:Movie)
WHERE m.released >= 1990 AND m.released <= 2000
RETURN m.title, m.released",Simple Aggregation Queries,movies,False,False,True,
Name 3 movies that have the tagline 'Welcome to the Real World'.,"MATCH (m:Movie {tagline: 'Welcome to the Real World'})
RETURN m.title
LIMIT 3",Simple Aggregation Queries,movies,True,False,False,
Who are the top 5 actors by the number of movies they acted in?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
RETURN p.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 5",Simple Aggregation Queries,movies,False,False,True,
Find 3 directors who directed movies released after 2000.,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE m.released > 2000
RETURN d.name, m.title, m.released
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
What are the names of 3 persons who reviewed movies with a rating above 80?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating > 80
RETURN p.name
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Identify 3 movies that were both produced and directed by the same person.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS Movie, p.name AS ProducerDirector
LIMIT 3",Simple Aggregation Queries,movies,False,False,False,
List the names of 3 persons who follow more than 5 other persons.,"MATCH (p:Person)
WHERE size((p)-[:FOLLOWS]->(:Person)) > 5
RETURN p.name
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
What are the top 3 movies by release year with a tagline containing 'freedom'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'freedom'
RETURN m.title, m.released
ORDER BY m.released DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Which 3 people have the smallest age difference between them?,"MATCH (p1:Person), (p2:Person), (p3:Person)
WHERE p1 <> p2 AND p1 <> p3 AND p2 <> p3
WITH p1, p2, p3, abs(p1.born - p2.born) AS diff1, abs(p2.born - p3.born) AS diff2, abs(p3.born - p1.born) AS diff3
ORDER BY diff1 + diff2 + diff3 ASC
RETURN p1.name, p2.name, p3.name, diff1, diff2, diff3
LIMIT 3",Simple Aggregation Queries,movies,True,False,False,
List 3 movies with the most roles listed in the ACTED_IN relationship.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
RETURN m.title, count(r.roles) AS total_roles
ORDER BY total_roles DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,False,
"Name 3 actors who have acted in a movie with the tagline 'Dark, but compelling'.","MATCH (actor:Person)-[:ACTED_IN]->(m:Movie {tagline: 'Dark, but compelling'})
RETURN actor.name
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
What are the top 3 highest rated reviews and which movies they are associated with?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
RETURN m.title, r.rating, r.summary
ORDER BY r.rating DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Find 3 directors who have directed movies with fewer than 50 votes.,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE m.votes < 50
RETURN d.name, collect(m.title) AS Movies
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Which 3 movies have the longest taglines?,"MATCH (m:Movie)
WHERE m.tagline IS NOT NULL
RETURN m.title, m.tagline
ORDER BY length(m.tagline) DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
"List 3 persons who have acted in, directed, and produced at least one movie each.","MATCH (p:Person)-[:ACTED_IN]->(m1:Movie)
WHERE exists {
  (p)-[:DIRECTED]->(:Movie)
} AND exists {
  (p)-[:PRODUCED]->(:Movie)
}
RETURN p.name
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
What are the common movies acted in by people who were born in the same decade?,"MATCH (p1:Person)-[:ACTED_IN]->(m:Movie)<-[:ACTED_IN]-(p2:Person)
WHERE p1.born - p1.born % 10 = p2.born - p2.born % 10 AND p1 <> p2
RETURN m.title AS Movie, collect(p1.name) AS Actors, p1.born - p1.born % 10 AS Decade
ORDER BY Decade",Simple Aggregation Queries,movies,False,False,False,
Name 3 movies with taglines that contain the word 'Speed'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'Speed'
RETURN m.title
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
List the top 5 most reviewed movies by the number of reviews.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WITH m, count(r) AS reviews
ORDER BY reviews DESC
LIMIT 5
RETURN m.title, reviews",Simple Aggregation Queries,movies,False,False,True,
Who are 3 actors who have acted in movies released before 1980?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.released < 1980
RETURN p.name
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
What are the top 3 movies with the most diverse roles in the ACTED_IN relationship?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WITH m, count(DISTINCT r.roles) AS diversity
ORDER BY diversity DESC
LIMIT 3
RETURN m.title, diversity",Simple Aggregation Queries,movies,False,False,True,
Who are the first 3 people to act in and review the same movie?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:REVIEWED]-(p)
RETURN p.name
LIMIT 3",Simple Aggregation Queries,movies,False,False,False,
List 3 movies reviewed with the summary 'An amazing journey'.,"MATCH (p:Person)-[r:REVIEWED {summary: 'An amazing journey'}]->(m:Movie)
RETURN m.title AS MovieTitle, m.released AS ReleaseYear
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Which 3 directors have the highest average movie rating for movies they directed?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)<-[:REVIEWED]-(p:Person)
WITH d, avg(p.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN d.name, avgRating",Simple Aggregation Queries,movies,False,False,True,Person.rating
Name 3 persons who have produced movies but have not directed any.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE NOT EXISTS { (p)-[:DIRECTED]->(:Movie) }
RETURN p.name
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
List the names of 3 persons who have the name starting with 'L'.,"MATCH (p:Person)
WHERE p.name STARTS WITH 'L'
RETURN p.name
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
List all persons born in 1970 and what movies they have produced.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.born = 1970
RETURN p.name, m.title",Complex Retrieval Queries,movies,False,False,False,
Who has the most directed movies without acting in any of them?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE NOT exists{ (p)-[:ACTED_IN]->(:Movie) }
RETURN p.name, count(m) AS directedMovies
ORDER BY directedMovies DESC
LIMIT 1",Complex Retrieval Queries,movies,False,False,True,
Name the top 5 movies with the most diverse cast in terms of roles.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WITH m, count(DISTINCT r.roles) AS diversity
ORDER BY diversity DESC
LIMIT 5
RETURN m.title AS Movie, diversity AS CastDiversity",Complex Aggregation Queries,movies,False,False,True,
List all movies with a tagline containing 'end'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'end'
RETURN m",Complex Retrieval Queries,movies,True,False,False,
Find the top 3 longest relationships in terms of roles between a person and a movie.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
RETURN p, m, r.roles AS roles
ORDER BY size(r.roles) DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
"Show top 3 persons who directed, produced, and acted in the same movie.","MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:PRODUCED]-(p)-[:ACTED_IN]->(m)
RETURN p.name, collect(m.title) AS movies
ORDER BY size(movies) DESC
LIMIT 3",Pathfinding Queries,movies,False,False,True,
Which movie has the tagline 'Welcome to the Real World'?,"MATCH (m:Movie {tagline: 'Welcome to the Real World'})
RETURN m.title",Pathfinding Queries,movies,False,False,True,
List all movies produced by Joel Silver.,"MATCH (p:Person {name: ""Joel Silver""})-[:PRODUCED]->(m:Movie)
RETURN m",Pathfinding Queries,movies,False,False,True,
What are the roles of Laurence Fishburne in 'The Matrix Revolutions'?,"MATCH (p:Person {name: ""Laurence Fishburne""})-[:ACTED_IN {roles: roles}]->(m:Movie {title: ""The Matrix Revolutions""})
RETURN roles",Pathfinding Queries,movies,False,False,True,
Which actors were born after 1970 and acted in movies released before 2000?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born > 1970 AND m.released < 2000
RETURN p.name, m.title, m.released",Pathfinding Queries,movies,False,False,True,
Find the top 5 movies with the most votes.,"MATCH (m:Movie)
WHERE m.votes IS NOT NULL
RETURN m
ORDER BY m.votes DESC
LIMIT 5",Pathfinding Queries,movies,False,False,True,
List the directors of the movie 'The Matrix'.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie {title: 'The Matrix'})
RETURN p.name AS DirectorName",Pathfinding Queries,movies,False,False,False,
Which movies has Keanu Reeves acted in?,"MATCH (p:Person {name: ""Keanu Reeves""})-[:ACTED_IN]->(m:Movie)
RETURN m.title AS MovieTitle",Pathfinding Queries,movies,False,False,True,
Name 3 persons who have reviewed the most movies released before 2000.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE m.released < 2000
WITH p, count(r) AS reviews
ORDER BY reviews DESC
LIMIT 3
RETURN p.name AS PersonName, reviews AS NumberOfReviews",Simple Aggregation Queries,movies,False,False,True,
What are the 3 oldest movies produced by someone born after 1960?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.born > 1960
RETURN m.title, m.released
ORDER BY m.released ASC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Who are the top 3 producers by the number of movies with different taglines?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE m.tagline IS NOT NULL
WITH p, count(DISTINCT m.tagline) AS distinctTaglines
ORDER BY distinctTaglines DESC
LIMIT 3
RETURN p.name, distinctTaglines",Simple Aggregation Queries,movies,False,False,True,
List the first 3 movies to have been reviewed with a summary containing 'slapstick'.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.summary CONTAINS 'slapstick'
RETURN m.title, m.released, r.summary, r.rating
ORDER BY m.released
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
What are the top 3 movies by the number of roles available in the ACTED_IN relationship?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
RETURN m.title, count(r.roles) AS total_roles
ORDER BY total_roles DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Who are the top 3 actors with the most diverse roles?,"MATCH (p:Person)-[a:ACTED_IN]->(m:Movie)
WITH p, count(DISTINCT a.roles) AS diversity
ORDER BY diversity DESC
LIMIT 3
RETURN p.name AS Actor, diversity AS RolesDiversity",Complex Retrieval Queries,movies,False,False,True,
Which persons have directed the most movies with a tagline containing 'world'?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.tagline CONTAINS 'world'
WITH p, count(m) AS moviesDirected
ORDER BY moviesDirected DESC
RETURN p.name, moviesDirected",Complex Retrieval Queries,movies,False,False,False,
List the movies that have been acted in by the oldest actor in the database.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WITH p, max(p.born) AS oldest
MATCH (oldestActor:Person {born: oldest})-[:ACTED_IN]->(movie:Movie)
RETURN movie.title AS MovieTitle, movie.released AS ReleaseYear",Complex Retrieval Queries,movies,True,False,False,
Who has the most roles in movies released before 1985?,"MATCH (p:Person)-[a:ACTED_IN]->(m:Movie)
WHERE m.released < 1985
RETURN p.name, count(a.roles) AS total_roles
ORDER BY total_roles DESC
LIMIT 1",Complex Retrieval Queries,movies,False,False,False,
List all movies reviewed with a summary containing 'journey'.,"MATCH (m:Movie)<-[:REVIEWED {summary: 'An amazing journey'}]-(p:Person)
RETURN m.title AS MovieTitle, p.name AS ReviewerName",Complex Retrieval Queries,movies,False,False,True,
Who has reviewed the most movies with a rating above 90?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating > 90
WITH p, count(m) AS moviesReviewed
ORDER BY moviesReviewed DESC
LIMIT 1
RETURN p.name AS reviewer, moviesReviewed",Complex Retrieval Queries,movies,False,False,True,
List all movies where the producer has also acted.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE exists{ (p)-[:ACTED_IN]->(m) }
RETURN m.title AS MovieTitle, m.released AS ReleaseYear",Complex Retrieval Queries,movies,False,False,False,
Who has directed the most movies with at least three different actors?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WITH m, count(DISTINCT (a:Person)-[:ACTED_IN]->(m)) AS actorCount
WHERE actorCount >= 3
RETURN d.name, count(m) AS moviesDirected
ORDER BY moviesDirected DESC
LIMIT 1",Complex Retrieval Queries,movies,False,False,True,
Who reviewed 'The Matrix' and what was their rating?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie {title: ""The Matrix""})
RETURN p.name, r.rating",Complex Retrieval Queries,movies,False,False,False,
List the top 5 youngest people who have written a movie.,"MATCH (p:Person)-[:WROTE]->(:Movie)
RETURN p.name, p.born
ORDER BY p.born DESC
LIMIT 5",Complex Retrieval Queries,movies,False,False,True,
Who has the most productions in movies released in the 2000s?,"MATCH (p:Person)-[r:PRODUCED]->(m:Movie)
WHERE m.released >= 2000 AND m.released < 2010
WITH p, count(m) AS moviesProduced
RETURN p.name AS Producer, moviesProduced
ORDER BY moviesProduced DESC
LIMIT 1",Complex Retrieval Queries,movies,False,False,True,
List all persons who have followed more than five other persons.,"MATCH (p:Person)
WHERE count{(p)-[:FOLLOWS]->(:Person)} > 5
RETURN p",Complex Retrieval Queries,movies,False,False,True,
Which movies have been produced by persons born in the 1950s?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.born >= 1950 AND p.born < 1960
RETURN m.title, m.released",Complex Retrieval Queries,movies,False,False,True,
Who are the top 5 actors with the most reviews for movies they acted in?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE exists{(p)-[:REVIEWED]->(m)}
WITH p, count{(p)-[:REVIEWED]->(m)} AS reviewsCount
ORDER BY reviewsCount DESC
LIMIT 5
RETURN p.name, reviewsCount",Complex Retrieval Queries,movies,False,False,True,
List all movies with more than one person who has reviewed them.,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)
WITH m, count(p) AS reviewers_count
WHERE reviewers_count > 1
RETURN m.title, reviewers_count",Complex Retrieval Queries,movies,False,False,False,
Which 3 persons have reviewed the most movies?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
RETURN p.name, count(m) AS movies_reviewed
ORDER BY movies_reviewed DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Find 3 persons who have directed movies released in the 1990s.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.released >= 1990 AND m.released < 2000
RETURN p
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
List 3 movies that have been reviewed with a summary mentioning 'funny'.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.summary CONTAINS 'funny'
RETURN m.title AS MovieTitle, r.summary AS ReviewSummary
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Name 3 movies that have been reviewed with a summary containing 'romp'.,"MATCH (m:Movie)<-[:REVIEWED {summary: 'A solid romp'}]-(p:Person)
RETURN m.title
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Which 3 persons have reviewed and produced the same movie?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:REVIEWED]-(p)
RETURN p.name, collect(m.title) AS movies
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Which 3 directors have directed the most movies released after 2005?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE m.released > 2005
RETURN d.name, count(m) AS movies_directed
ORDER BY movies_directed DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
List the 3 movies with the highest average review ratings.,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WITH m, avg(r.rating) AS averageRating
ORDER BY averageRating DESC
LIMIT 3
RETURN m.title, averageRating",Simple Aggregation Queries,movies,False,False,True,
Find 3 actors who have acted in movies with a tagline mentioning 'freedom'.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.tagline CONTAINS 'freedom'
RETURN p.name, m.title
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Who are the 3 persons with the most directed movies that have a tagline?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.tagline IS NOT NULL
WITH p, count(m) AS directedMovies
ORDER BY directedMovies DESC
LIMIT 3
RETURN p.name, directedMovies",Simple Aggregation Queries,movies,False,False,True,
What are the top 3 movies by the number of followers for its actors?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WITH m, count{(p)-[:FOLLOWS]->(:Person)} AS followersCount
ORDER BY followersCount DESC
LIMIT 3
RETURN m.title, followersCount",Simple Aggregation Queries,movies,False,False,True,
Which 3 movies have been directed by persons born in the 1960s?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born >= 1960 AND p.born < 1970
RETURN m.title AS MovieTitle, m.released AS ReleaseYear
ORDER BY m.released DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
List 3 directors who have never reviewed a movie.,"MATCH (d:Person)-[:DIRECTED]->(:Movie)
WHERE NOT exists{ (d)-[:REVIEWED]->(:Movie) }
RETURN d.name
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Name 3 actors who have acted in the least voted movies.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WITH p, m ORDER BY m.votes ASC
LIMIT 3
RETURN p.name AS Actor",Simple Aggregation Queries,movies,False,False,True,
What are the 3 most common summaries in the REVIEWED relationship?,"MATCH (:Person)-[r:REVIEWED]->(:Movie)
RETURN r.summary AS Summary, count(r) AS Count
ORDER BY Count DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,False,
Which 3 persons have the most distinct roles in the ACTED_IN relationship?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WITH p, count(DISTINCT r.roles) AS distinctRoles
ORDER BY distinctRoles DESC
LIMIT 3
RETURN p.name, distinctRoles",Simple Aggregation Queries,movies,False,False,True,
List the 3 movies with the highest number of distinct reviewers.,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)
WITH m, count(DISTINCT p) AS reviewers_count
ORDER BY reviewers_count DESC
LIMIT 3
RETURN m.title, reviewers_count",Simple Aggregation Queries,movies,False,False,True,
List the 3 movies with the lowest average ratings in the REVIEWED relationship.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WITH m, AVG(r.rating) AS avgRating
ORDER BY avgRating ASC
LIMIT 3
RETURN m.title, avgRating",Simple Aggregation Queries,movies,False,False,True,
Name 3 persons who acted in the most movies with a tagline containing 'journey'.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.tagline CONTAINS 'journey'
WITH p, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3
RETURN p.name AS person_name, movies_count",Simple Aggregation Queries,movies,False,False,True,
List the titles of 3 movies that have been both acted in and reviewed by the same person.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE exists {
  (p)-[:REVIEWED]->(m)
}
RETURN m.title AS MovieTitle
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Who are the 3 youngest directors in the database?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
RETURN p.name, p.born
ORDER BY p.born DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Name 3 movies with a released year divisible by 3.,"MATCH (m:Movie)
WHERE m.released % 3 = 0
RETURN m.title
LIMIT 3",Simple Aggregation Queries,movies,False,False,False,
What are the 3 oldest persons in the database?,"MATCH (p:Person)
RETURN p
ORDER BY p.born ASC
LIMIT 3",Simple Aggregation Queries,movies,False,False,False,
List the top 5 actors by the variety of roles they played in movies.,"MATCH (p:Person)-[a:ACTED_IN]->(m:Movie)
WITH p, count(DISTINCT a.roles) AS variety
ORDER BY variety DESC
LIMIT 5
RETURN p.name, variety",Simple Aggregation Queries,movies,False,False,False,
Name 3 persons who have directed a movie with a tagline containing 'limits'.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.tagline CONTAINS 'limits'
RETURN p.name
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Who are the top 3 producers by the number of movies they produced?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
RETURN p.name, count(m) AS movies_produced
ORDER BY movies_produced DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
List 3 movies with at least 2 reviews with a summary mentioning 'compelling'.,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary CONTAINS 'compelling'
WITH m, count(r) AS reviewsCount
WHERE reviewsCount >= 2
RETURN m.title, m.released
LIMIT 3",Simple Aggregation Queries,movies,False,False,False,
Name the first 3 movies to be reviewed with a rating of exactly 75.,"MATCH (p:Person)-[r:REVIEWED {rating: 75}]->(m:Movie)
RETURN m.title
ORDER BY m.released
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
"Which 3 persons have acted in, directed, and produced the same movie?","MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
MATCH (p)-[:DIRECTED]->(m)
MATCH (p)-[:PRODUCED]->(m)
RETURN p.name, m.title
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
What are the 3 newest movies in the database?,"MATCH (m:Movie)
RETURN m
ORDER BY m.released DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
List the names of 3 persons who follow someone with the same first letter in their name.,"MATCH (p1:Person)-[:FOLLOWS]->(p2:Person)
WHERE p1.name STARTS WITH substring(p2.name, 0, 1)
RETURN p1.name
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Name 3 movies that were produced by persons born after 1970.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.born > 1970
RETURN m.title AS MovieTitle
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
What are the top 3 movies by number of votes that were produced by someone born before 1960?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.born < 1960
RETURN m.title, m.votes
ORDER BY m.votes DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
What is the highest rating given to any movie by any person?,"MATCH (:Person)-[r:REVIEWED]->(:Movie)
RETURN max(r.rating) AS highest_rating",Pathfinding Queries,movies,False,False,True,
Who are the 3 directors with the fewest produced movies?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WITH p, count(m) AS producedMovies
ORDER BY producedMovies ASC
LIMIT 3
RETURN p.name AS Director, producedMovies",Simple Aggregation Queries,movies,False,False,True,
Name the 3 persons who have appeared in the most REVIEWED movies.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE exists{(m)<-[:REVIEWED]-(:Person)}
WITH p, count(m) AS reviewedMoviesCount
ORDER BY reviewedMoviesCount DESC
LIMIT 3
RETURN p.name AS PersonName, reviewedMoviesCount",Simple Aggregation Queries,movies,False,False,True,
Who are the first 3 persons to have directed and acted in the same movie?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(p)
RETURN p.name
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
What are the 3 oldest movies in the database?,"MATCH (m:Movie)
RETURN m
ORDER BY m.released ASC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Name 3 persons who have produced the most movies.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
RETURN p.name, count(m) AS movies_produced
ORDER BY movies_produced DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
List 3 movies with exactly 3 roles in the ACTED_IN relationship.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE size(r.roles) = 3
RETURN m.title AS Movie, collect(p.name) AS Actors
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Which 3 persons have the most followers?,"MATCH (p:Person)
RETURN p, count{(p)<-[:FOLLOWS]-(:Person)} AS followers
ORDER BY followers DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
What are the top 5 movies by vote count that have a tagline mentioning 'real'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'real'
RETURN m
ORDER BY m.votes DESC
LIMIT 5",Simple Aggregation Queries,movies,False,False,True,
Name 3 actors who have acted in movies with at least 1000 votes.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.votes >= 1000
RETURN p.name
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
List the top 3 movies with the least votes.,"MATCH (m:Movie)
WHERE m.votes IS NOT NULL
RETURN m
ORDER BY m.votes ASC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Name 3 directors who have directed movies with the least number of votes.,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
RETURN d.name, m.title, m.votes
ORDER BY m.votes ASC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
What are the 3 most common taglines found in the movies?,"MATCH (m:Movie)
WHERE m.tagline IS NOT NULL
RETURN m.tagline AS Tagline, count(m) AS Frequency
ORDER BY Frequency DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Which 3 persons have the most diverse roles across movies they acted in?,"MATCH (p:Person)-[a:ACTED_IN]->(m:Movie)
WITH p, collect(a.roles) AS allRoles
UNWIND allRoles AS roles
WITH p, collect(DISTINCT roles) AS uniqueRoles
ORDER BY size(uniqueRoles) DESC
RETURN p.name, uniqueRoles
LIMIT 3",Simple Aggregation Queries,movies,True,False,False,
List the 3 movies with the highest number of votes and a tagline mentioning 'limit'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'limit' AND m.votes IS NOT NULL
RETURN m
ORDER BY m.votes DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,False,
Who are the 3 persons with the most PRODUCED relationships?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
RETURN p.name, count(m) AS produced_movies
ORDER BY produced_movies DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
What are the top 3 movies with the most distinct actors in the ACTED_IN relationship?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WITH m, count(DISTINCT p) AS actorCount
ORDER BY actorCount DESC
LIMIT 3
RETURN m.title, actorCount",Simple Aggregation Queries,movies,False,False,False,
What are the top 3 reviewed movies with summaries mentioning 'fun'?,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary CONTAINS 'fun'
RETURN m.title, m.released, r.rating, r.summary
ORDER BY r.rating DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
List the top 3 movies with roles played by persons born in the 1940s.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born >= 1940 AND p.born < 1950
RETURN m.title AS Movie, collect(p.name) AS Actors
ORDER BY m.votes DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Find the 3 oldest movies reviewed by someone born after 1970.,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)
WHERE p.born > 1970
RETURN m
ORDER BY m.released ASC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Which 3 directors have directed movies with the most distinct taglines?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE m.tagline IS NOT NULL
RETURN d.name, count(DISTINCT m.tagline) AS distinctTaglines
ORDER BY distinctTaglines DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
List 3 movies that have been followed by the most persons.,"MATCH (p:Person)-[:FOLLOWS]->(m:Movie)
RETURN m.title AS Movie, count(p) AS Followers
ORDER BY Followers DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,False,
Name 3 persons who have acted in movies released in consecutive years.,"MATCH (p:Person)-[:ACTED_IN]->(m1:Movie), (p)-[:ACTED_IN]->(m2:Movie)
WHERE m1.released = m2.released + 1 OR m1.released = m2.released - 1
RETURN p.name, collect(m1.title) AS Movie1, collect(m2.title) AS Movie2
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
What are the top 3 movies with the most distinct taglines?,"MATCH (m:Movie)
WHERE m.tagline IS NOT NULL
RETURN m.title, m.tagline
ORDER BY m.tagline DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Who are the 3 persons with the highest total ratings for movies they reviewed?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WITH p, sum(r.rating) AS total_rating
ORDER BY total_rating DESC
LIMIT 3
RETURN p.name AS person_name, total_rating",Simple Aggregation Queries,movies,False,False,False,
List 3 actors who have acted in movies with a tagline containing 'beginning'.,"MATCH (a:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.tagline CONTAINS 'beginning'
RETURN a.name
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Find 3 movies that were both directed and reviewed by the same person.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:REVIEWED]-(p)
RETURN m.title AS Movie, p.name AS Director_Reviewer
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Name 3 people who have the most combined roles across all their ACTED_IN movies.,"MATCH (p:Person)-[a:ACTED_IN]->(m:Movie)
WITH p, sum(size(a.roles)) AS totalRoles
ORDER BY totalRoles DESC
LIMIT 3
RETURN p.name AS PersonName, totalRoles",Simple Aggregation Queries,movies,False,False,True,
What are the 3 newest relationships formed in the graph (any type)?,"MATCH (a)-[r]->(b)
RETURN a, r, b
ORDER BY r.creationDate DESC
LIMIT 3",Simple Aggregation Queries,movies,False,False,False,
Which 3 persons follow the most directors?,"MATCH (p:Person)-[:FOLLOWS]->(d:Person)-[:DIRECTED]->(:Movie)
WITH p, count(d) AS directorsFollowed
ORDER BY directorsFollowed DESC
LIMIT 3
RETURN p.name, directorsFollowed",Simple Aggregation Queries,movies,False,False,True,
List the first 3 movies where someone both acted in and directed.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie), (p)-[:DIRECTED]->(m)
RETURN m.title AS MovieTitle, m.released AS ReleaseYear
LIMIT 3",Simple Aggregation Queries,movies,False,False,True,
Name 3 persons who have acted in movies with the most distinct titles.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WITH p, count(DISTINCT m.title) AS distinctTitles
ORDER BY distinctTitles DESC
LIMIT 3
RETURN p.name AS PersonName, distinctTitles",Simple Aggregation Queries,movies,False,False,True,
"Which movies have been reviewed with a summary 'Dark, but compelling'?","MATCH (m:Movie)<-[:REVIEWED {summary: 'Dark, but compelling'}]-(:Person)
RETURN m.title AS MovieTitle",Pathfinding Queries,movies,False,False,True,
List all reviewers of 'Speed Racer' and the ratings they gave.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie {title: 'Speed Racer'})
RETURN p.name AS Reviewer, r.rating AS Rating",Pathfinding Queries,movies,False,False,True,
What are the top 3 oldest persons in the graph?,"MATCH (p:Person)
RETURN p
ORDER BY p.born ASC
LIMIT 3",Pathfinding Queries,movies,False,False,False,
What are the most common roles in the movie 'The Matrix Revolutions'?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie {title: 'The Matrix Revolutions'})
UNWIND r.roles as role
RETURN role, count(role) AS frequency
ORDER BY frequency DESC",Complex Aggregation Queries,movies,False,False,True,
List all persons born before 1950.,"MATCH (p:Person)
WHERE p.born < 1950
RETURN p",Complex Aggregation Queries,movies,True,False,False,
Which movies have been both produced and directed by the same person?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS MovieTitle, p.name AS ProducerDirector",Complex Aggregation Queries,movies,False,False,True,
Show the first 3 people who have reviewed more than one movie.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WITH p, count(m) AS movies_reviewed
WHERE movies_reviewed > 1
RETURN p
LIMIT 3",Complex Aggregation Queries,movies,False,False,True,
Who are the actors that have acted in both 'The Matrix' and 'Speed Racer'?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.title IN ['The Matrix', 'Speed Racer']
WITH p, count(m) AS movies_count
WHERE movies_count = 2
RETURN p.name",Complex Aggregation Queries,movies,False,False,True,
Top 5 movies by number of votes.,"MATCH (m:Movie)
WHERE m.votes IS NOT NULL
RETURN m.title, m.votes
ORDER BY m.votes DESC
LIMIT 5",Complex Aggregation Queries,movies,False,False,True,
What are the roles played by Keanu Reeves in 'The Matrix'?,"MATCH (p:Person {name: ""Keanu Reeves""})-[:ACTED_IN {roles: roles}]->(m:Movie {title: ""The Matrix""})
RETURN roles",Complex Aggregation Queries,movies,False,False,True,
List all the movies produced by Joel Silver.,"MATCH (p:Person {name: ""Joel Silver""})-[:PRODUCED]->(m:Movie)
RETURN m",Complex Aggregation Queries,movies,False,False,True,
Who directed the movie 'The Matrix'?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie {title: 'The Matrix'})
RETURN p.name",Complex Aggregation Queries,movies,False,False,True,
Find movies with the tagline 'Welcome to the Real World'.,"MATCH (m:Movie {tagline: 'Welcome to the Real World'})
RETURN m",Complex Aggregation Queries,movies,False,False,True,
Which person has both acted in and directed the same movie?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN p.name, m.title",Complex Aggregation Queries,movies,False,False,True,
Name 3 movies reviewed with a rating over 90.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating > 90
RETURN m.title AS MovieTitle
LIMIT 3",Complex Aggregation Queries,movies,False,False,True,
What are the titles of movies that have more than 1000 votes?,"MATCH (m:Movie)
WHERE m.votes > 1000
RETURN m.title",Complex Aggregation Queries,movies,True,False,False,
Find movies that were released between 1990 and 2000.,"MATCH (m:Movie)
WHERE m.released >= 1990 AND m.released <= 2000
RETURN m",Complex Aggregation Queries,movies,False,False,True,
List top 3 movies released before 1980.,"MATCH (m:Movie)
WHERE m.released < 1980
RETURN m
ORDER BY m.released DESC
LIMIT 3",Complex Aggregation Queries,movies,False,False,True,
Who are the top 3 persons with the most roles in movies they have acted in?,"MATCH (p:Person)-[a:ACTED_IN]->(m:Movie)
WITH p, sum(size(a.roles)) AS total_roles
ORDER BY total_roles DESC
LIMIT 3
RETURN p.name, total_roles",Pathfinding Queries,movies,False,False,False,
List all movies that have been reviewed with a summary including 'amazing journey'.,"MATCH (m:Movie)<-[:REVIEWED {summary: 'An amazing journey'}]-(p:Person)
RETURN m.title AS MovieTitle, p.name AS ReviewerName",Pathfinding Queries,movies,False,False,True,
Which persons have directed a movie and followed more than 5 persons?,"MATCH (p:Person)-[:DIRECTED]->(:Movie)
WHERE size((p)-[:FOLLOWS]->(:Person)) > 5
RETURN p.name",Pathfinding Queries,movies,True,False,False,
List the movies that have been both directed and produced by the same person.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:PRODUCED]-(p)
RETURN m.title AS MovieTitle",Pathfinding Queries,movies,False,False,True,
Which movie has the most roles in the 'ACTED_IN' relationship and what are those roles?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
RETURN m.title AS Movie, r.roles AS Roles
ORDER BY size(r.roles) DESC
LIMIT 1",Pathfinding Queries,movies,False,False,True,
What are the top 3 shortest role lists in movies reviewed by persons born before 1960?,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)<-[:ACTED_IN]-(a:Person)
WHERE p.born < 1960
RETURN m.title, m.released, a.name, a.roles
ORDER BY size(a.roles)
LIMIT 3",Pathfinding Queries,movies,False,False,True,Person.roles
List all movies produced by persons who have also directed a movie with the same title.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE EXISTS {
    MATCH (p)-[:DIRECTED]->(m2:Movie)
    WHERE m.title = m2.title
}
RETURN m.title AS MovieTitle",Pathfinding Queries,movies,False,False,True,
What are the roles of Keanu Reeves in movies with a released year divisible by 5?,"MATCH (p:Person {name: ""Keanu Reeves""})-[:ACTED_IN]->(m:Movie)
WHERE m.released % 5 = 0
RETURN m.title AS MovieTitle, m.released AS ReleaseYear, relationships(p-[:ACTED_IN]->m)[0].roles AS Roles",Pathfinding Queries,movies,False,False,False,
Who are the top 3 oldest persons who have reviewed a movie?,"MATCH (p:Person)-[:REVIEWED]->(:Movie)
RETURN p.name, p.born
ORDER BY p.born ASC
LIMIT 3",Pathfinding Queries,movies,False,False,True,
List movies where the reviewer gave a rating less than 50.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating < 50
RETURN m.title, r.summary, r.rating",Pathfinding Queries,movies,False,False,False,
Who has the most directed movies in the database?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
RETURN p.name, count(m) AS directedMovies
ORDER BY directedMovies DESC
LIMIT 1",Pathfinding Queries,movies,True,False,False,
List the roles of any person in movies released after 2010.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE m.released > 2010
RETURN p.name, m.title, r.roles",Pathfinding Queries,movies,False,False,True,
Which movies have taglines that include the word 'compelling'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'compelling'
RETURN m.title, m.tagline",Pathfinding Queries,movies,False,False,True,
Which actors were born after 1970?,"MATCH (p:Person)
WHERE p.born > 1970 AND exists{(p)-[:ACTED_IN]->(:Movie)}
RETURN p.name, p.born",Complex Aggregation Queries,movies,False,False,True,
Who followed the most people born after 1980?,"MATCH (p:Person)-[:FOLLOWS]->(followed:Person)
WHERE followed.born > 1980
WITH p, count(followed) AS followsCount
ORDER BY followsCount DESC
LIMIT 1
RETURN p.name AS person, followsCount",Complex Aggregation Queries,movies,False,False,True,
What are the summaries of reviews for 'Speed Racer'?,"MATCH (m:Movie {title: ""Speed Racer""})<-[:REVIEWED]-(p:Person)
RETURN p.name AS reviewer, m.title AS movie, r.summary AS review_summary",Complex Aggregation Queries,movies,False,False,False,
List top 5 actors by number of movies acted in.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
RETURN p.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 5",Complex Aggregation Queries,movies,False,False,True,
List the people born in the 1960s who have directed a movie.,"MATCH (p:Person)-[:DIRECTED]->(:Movie)
WHERE p.born >= 1960 AND p.born <= 1969
RETURN p.name, p.born",Complex Aggregation Queries,movies,False,False,True,
What are the first 3 movies with the most roles listed?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
RETURN m.title, m.released, size(r.roles) AS num_roles
ORDER BY num_roles DESC
LIMIT 3",Complex Aggregation Queries,movies,False,False,True,
Who has acted in the highest number of unique movies?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WITH p, count(DISTINCT m) AS movies_count
RETURN p.name AS actor, movies_count
ORDER BY movies_count DESC
LIMIT 1",Complex Aggregation Queries,movies,True,False,False,
List the movies that have been followed by someone born in 1990.,"MATCH (p:Person {born: 1990})-[:FOLLOWS]->(followed:Person)-[:ACTED_IN|DIRECTED|PRODUCED|WROTE]->(m:Movie)
RETURN DISTINCT m.title AS MovieTitle",Complex Aggregation Queries,movies,False,False,False,
What is the average release year of movies reviewed with a rating above 80?,"MATCH (:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating > 80
RETURN AVG(m.released) AS averageReleaseYear",Complex Aggregation Queries,movies,False,False,True,
Name the people who have produced movies with less than 100 votes.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE m.votes < 100
RETURN p.name",Complex Aggregation Queries,movies,False,False,False,
What are the movies released in 1999?,"MATCH (m:Movie)
WHERE m.released = 1999
RETURN m",Complex Aggregation Queries,movies,False,False,True,
"List movies that have exactly one person who acted, directed, and wrote the movie.","MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE exists {
  (p)-[:DIRECTED]->(m) AND (p)-[:WROTE]->(m)
}
WITH m, count(p) AS involvementCount
WHERE involvementCount = 1
RETURN m.title, m.released",Complex Aggregation Queries,movies,False,False,True,
Find the people who have followed someone with the same birth year.,"MATCH (p1:Person)-[:FOLLOWS]->(p2:Person)
WHERE p1.born = p2.born
RETURN p1, p2",Complex Aggregation Queries,movies,False,False,True,
Who are the top 3 actors in terms of the diversity of roles played?,"MATCH (p:Person)-[a:ACTED_IN]->(m:Movie)
WITH p, count(DISTINCT a.roles) AS diversity
ORDER BY diversity DESC
LIMIT 3
RETURN p.name AS Actor, diversity",Complex Aggregation Queries,movies,False,False,True,
List the movies that were both acted in and produced by the same person.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:PRODUCED]-(p)
RETURN m.title AS MovieTitle, p.name AS PersonName",Complex Aggregation Queries,movies,False,False,True,
"Which movies have been reviewed with a summary stating 'Dark, but compelling'?","MATCH (m:Movie)<-[:REVIEWED {summary: 'Dark, but compelling'}]-(:Person)
RETURN m.title AS MovieTitle",Complex Aggregation Queries,movies,False,False,True,
What are the top 5 reviewed movies by summary 'An amazing journey'?,"MATCH (p:Person)-[r:REVIEWED {summary: 'An amazing journey'}]->(m:Movie)
RETURN m.title, r.rating
ORDER BY r.rating DESC
LIMIT 5",Complex Aggregation Queries,movies,False,False,True,
Name the people who have directed more than two movies.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WITH p, count(m) AS moviesDirected
WHERE moviesDirected > 2
RETURN p.name",Complex Aggregation Queries,movies,False,False,True,
Who are the people that have both written and produced the same movie?,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:PRODUCED]-(p)
RETURN p.name, m.title",Complex Aggregation Queries,movies,False,False,True,
List the movies where the tagline contains the word 'limits'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'limits'
RETURN m.title, m.tagline, m.released",Complex Aggregation Queries,movies,False,False,True,
What is the average number of votes for movies released in the 2000s?,"MATCH (m:Movie)
WHERE m.released >= 2000 AND m.released < 2010
RETURN avg(m.votes) AS average_votes",Complex Aggregation Queries,movies,False,False,True,
Name 3 movies with the lowest ratings in reviews.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
RETURN m.title AS Movie, r.rating AS Rating
ORDER BY r.rating ASC
LIMIT 3",Complex Aggregation Queries,movies,False,False,True,
Which person has reviewed the most movies?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
RETURN p.name, count(m) AS movies_reviewed
ORDER BY movies_reviewed DESC
LIMIT 1",Complex Aggregation Queries,movies,False,False,True,
List the actors born after 1980 who have acted in more than one movie.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born > 1980
WITH p, count(m) AS movies_count
WHERE movies_count > 1
RETURN p.name, movies_count",Complex Aggregation Queries,movies,False,False,False,
What are the movies directed by Lana Wachowski?,"MATCH (p:Person {name: ""Lana Wachowski""})-[:DIRECTED]->(m:Movie)
RETURN m.title AS MovieTitle",Complex Aggregation Queries,movies,False,False,True,
Who has the most roles in a single movie?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
RETURN p.name, m.title, size(r.roles) AS num_roles
ORDER BY num_roles DESC
LIMIT 1",Complex Aggregation Queries,movies,False,False,True,
List the movies with taglines that start with 'Everything'.,"MATCH (m:Movie)
WHERE m.tagline STARTS WITH 'Everything'
RETURN m.title, m.tagline, m.released",Complex Aggregation Queries,movies,False,False,True,
Who are the top 3 followers by number of people they follow?,"MATCH (p:Person)-[:FOLLOWS]->(other:Person)
WITH p, count(other) AS follows_count
ORDER BY follows_count DESC
LIMIT 3
RETURN p.name, follows_count",Complex Aggregation Queries,movies,False,False,True,
What are the distinct roles played by Laurence Fishburne across all movies?,"MATCH (p:Person {name: ""Laurence Fishburne""})-[:ACTED_IN]->(m:Movie)
UNWIND p.roles AS role
RETURN DISTINCT role",Complex Aggregation Queries,movies,False,False,True,Person.roles
List the people who have produced more than three movies.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WITH p, count(m) AS moviesProduced
WHERE moviesProduced > 3
RETURN p.name, moviesProduced",Complex Aggregation Queries,movies,False,False,True,
Which movies have a vote count less than 50?,"MATCH (m:Movie)
WHERE m.votes < 50
RETURN m.title, m.votes",Complex Aggregation Queries,movies,False,False,False,
What is the average rating of movies reviewed by people born before 1970?,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)
WHERE p.born < 1970
RETURN avg(m.rating) AS average_rating",Complex Aggregation Queries,movies,False,False,False,Movie.rating
Who wrote and acted in the same movie?,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:ACTED_IN]-(p)
RETURN p.name, m.title",Complex Aggregation Queries,movies,False,False,True,
List all persons who have directed a movie with a released year divisible by 20.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.released % 20 = 0
RETURN p",Pathfinding Queries,movies,False,False,True,
Find the top 5 movies with the least votes.,"MATCH (m:Movie)
WHERE m.votes IS NOT NULL
RETURN m
ORDER BY m.votes ASC
LIMIT 5",Pathfinding Queries,movies,False,False,False,
"Who has produced, directed, and acted in the most movies?","MATCH (p:Person)
WHERE exists{(p)-[:PRODUCED]->(:Movie)} AND 
      exists{(p)-[:DIRECTED]->(:Movie)} AND 
      exists{(p)-[:ACTED_IN]->(:Movie)}
WITH p, count{(p)-[:PRODUCED]->(:Movie)} AS producedCount, 
          count{(p)-[:DIRECTED]->(:Movie)} AS directedCount, 
          count{(p)-[:ACTED_IN]->(:Movie)} AS actedInCount
RETURN p.name, producedCount, directedCount, actedInCount
ORDER BY producedCount + directedCount + actedInCount DESC
LIMIT 1",Pathfinding Queries,movies,False,False,True,
List the first 3 movies released in the 21st century that Laurence Fishburne produced.,"MATCH (p:Person {name: ""Laurence Fishburne""})-[:PRODUCED]->(m:Movie)
WHERE m.released >= 2001
RETURN m
ORDER BY m.released ASC
LIMIT 3",Pathfinding Queries,movies,False,False,True,
Which persons have reviewed movies with a rating of 100?,"MATCH (p:Person)-[:REVIEWED {rating: 100}]->(m:Movie)
RETURN p.name, m.title",Pathfinding Queries,movies,False,False,True,
What are the first 3 movies with the longest role lists in 'ACTED_IN' relationships?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
RETURN m.title, r.roles
ORDER BY size(r.roles) DESC
LIMIT 3",Pathfinding Queries,movies,False,False,True,
Which persons have the name 'Joel' and have produced a movie with more than 100 votes?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.name = 'Joel' AND m.votes > 100
RETURN p, m",Pathfinding Queries,movies,False,False,True,
List the top 5 movies by release year in the 1980s.,"MATCH (m:Movie)
WHERE m.released >= 1980 AND m.released <= 1989
RETURN m
ORDER BY m.released DESC
LIMIT 5",Pathfinding Queries,movies,True,False,False,
What are the first 3 movies with a vote count less than 100?,"MATCH (m:Movie)
WHERE m.votes < 100
RETURN m
ORDER BY m.votes ASC
LIMIT 3",Pathfinding Queries,movies,False,False,True,
How many movies has Lana Wachowski directed?,"MATCH (p:Person {name: ""Lana Wachowski""})-[:DIRECTED]->(m:Movie)
RETURN count(m) AS NumberOfMoviesDirected",Pathfinding Queries,movies,False,False,True,
Which movies have been acted in by persons born after 1970?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born > 1970
RETURN m.title, m.released",Pathfinding Queries,movies,False,False,True,
List the first 3 people born before 1950 who acted in movies.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born < 1950
RETURN p.name, p.born, collect(m.title) AS movies
ORDER BY p.born
LIMIT 3",Pathfinding Queries,movies,True,False,False,
What are the roles of Keanu Reeves in movies released in the 1990s?,"MATCH (p:Person {name: ""Keanu Reeves""})-[:ACTED_IN]->(m:Movie)
WHERE m.released >= 1990 AND m.released < 2000
RETURN m.title AS Movie, m.released AS Year, relationships(p-[:ACTED_IN]->m)[0].roles AS Roles",Pathfinding Queries,movies,False,False,True,
How many different persons have reviewed 'Speed Racer'?,"MATCH (p:Person)-[:REVIEWED]->(m:Movie {title: 'Speed Racer'})
RETURN count(DISTINCT p) AS reviewer_count",Pathfinding Queries,movies,False,False,True,
List all movies with a tagline that includes the word 'Real'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'Real'
RETURN m",Pathfinding Queries,movies,False,False,True,
Which persons born in the 1960s have directed movies?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born >= 1960 AND p.born < 1970
RETURN p.name, collect(m.title) AS DirectedMovies",Pathfinding Queries,movies,False,False,False,
What are the first 3 movies with a rating greater than 85?,"MATCH (m:Movie)<-[:REVIEWED {rating: r}]-(p:Person)
WHERE r > 85
RETURN m.title AS MovieTitle, m.released AS ReleaseYear
ORDER BY m.released
LIMIT 3",Pathfinding Queries,movies,False,False,True,
Who has reviewed the most number of movies?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
RETURN p.name, count(m) AS movies_reviewed
ORDER BY movies_reviewed DESC
LIMIT 1",Pathfinding Queries,movies,False,False,False,
List all movies with a release year divisible by 5.,"MATCH (m:Movie)
WHERE m.released % 5 = 0
RETURN m",Pathfinding Queries,movies,False,False,True,
Which person has the highest number of followers?,"MATCH (p:Person)
RETURN p, count{(p)<-[:FOLLOWS]-(:Person)} AS followers
ORDER BY followers DESC
LIMIT 1",Pathfinding Queries,movies,False,False,False,
"Find persons who have acted in, directed, and produced different movies.","MATCH (p:Person)-[:ACTED_IN]->(m1:Movie), 
      (p)-[:DIRECTED]->(m2:Movie), 
      (p)-[:PRODUCED]->(m3:Movie)
WHERE m1 <> m2 AND m2 <> m3 AND m1 <> m3
RETURN p.name, m1.title AS ActedIn, m2.title AS Directed, m3.title AS Produced",Pathfinding Queries,movies,False,False,True,
What are the combined total votes of all movies Joel Silver produced?,"MATCH (p:Person {name: ""Joel Silver""})-[:PRODUCED]->(m:Movie)
RETURN sum(m.votes) AS TotalVotes",Pathfinding Queries,movies,False,False,True,
Who reviewed 'The Matrix' and what summary did they provide?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie {title: 'The Matrix'})
RETURN p.name, r.summary",Pathfinding Queries,movies,False,False,True,
List the top 5 most recent movies in the graph.,"MATCH (m:Movie)
RETURN m
ORDER BY m.released DESC
LIMIT 5",Pathfinding Queries,movies,False,False,True,
Which movies released between 1990 and 2000 have been reviewed?,"MATCH (m:Movie)-[:REVIEWED]->()
WHERE m.released >= 1990 AND m.released <= 2000
RETURN m",Pathfinding Queries,movies,False,False,False,
Who are the producers of movies with a tagline containing 'limits'?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE m.tagline CONTAINS 'limits'
RETURN p.name AS ProducerName, m.title AS MovieTitle",Pathfinding Queries,movies,False,False,True,
List all the movies where the roles list contains more than 4 characters.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE size(r.roles) > 4
RETURN m.title, r.roles",Pathfinding Queries,movies,False,False,True,
Which persons have only directed movies and never acted in any?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE NOT exists{ (p)-[:ACTED_IN]->(:Movie) }
RETURN DISTINCT p",Pathfinding Queries,movies,False,False,False,
What are the first 3 movies released after 2000 that Laurence Fishburne acted in?,"MATCH (p:Person {name: ""Laurence Fishburne""})-[:ACTED_IN]->(m:Movie)
WHERE m.released > 2000
RETURN m
ORDER BY m.released ASC
LIMIT 3",Pathfinding Queries,movies,False,False,True,
Who are the top 3 followers of Keanu Reeves?,"MATCH (p:Person)-[:FOLLOWS]->(keanu:Person {name: ""Keanu Reeves""})
RETURN p.name, count{(p)-[:FOLLOWS]->(keanu)} AS follows_count
ORDER BY follows_count DESC
LIMIT 3",Pathfinding Queries,movies,False,False,True,
List the movies that were written and directed by the same person.,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS MovieTitle, p.name AS WriterDirector",Pathfinding Queries,movies,False,False,False,
What are the roles of persons acting in movies with a tagline mentioning 'end'?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE m.tagline CONTAINS 'end'
RETURN p.name, r.roles",Pathfinding Queries,movies,False,False,True,
Who are the top 5 followers of Lana Wachowski?,"MATCH (p:Person)-[:FOLLOWS]->(lw:Person {name: ""Lana Wachowski""})
RETURN p.name AS FollowerName
ORDER BY p.born DESC
LIMIT 5",Pathfinding Queries,movies,False,False,False,
List the roles of Laurence Fishburne in movies with a release year after 2000.,"MATCH (p:Person {name: ""Laurence Fishburne""})-[:ACTED_IN]->(m:Movie)
WHERE m.released > 2000
RETURN m.title, m.released, [(p)-[r:ACTED_IN]->(m) | r.roles] AS roles",Pathfinding Queries,movies,False,False,True,
Which persons have acted in and directed the same movie?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN p.name, m.title",Pathfinding Queries,movies,False,False,True,
Which movies have been reviewed with a rating exactly at 75?,"MATCH (m:Movie)<-[:REVIEWED {rating: 75}]-(p:Person)
RETURN m.title AS MovieTitle, p.name AS ReviewerName",Pathfinding Queries,movies,False,False,True,
List the top 5 movies by number of roles in the 'ACTED_IN' relationship.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
RETURN m.title, count(r.roles) AS total_roles
ORDER BY total_roles DESC
LIMIT 5",Pathfinding Queries,movies,False,False,True,
Who are the followers of persons who have directed more than 3 movies?,"MATCH (director:Person)-[:DIRECTED]->(m:Movie)
WITH director, count(m) AS moviesDirected
WHERE moviesDirected > 3
MATCH (follower:Person)-[:FOLLOWS]->(director)
RETURN follower",Pathfinding Queries,movies,False,False,False,
Show the first 3 movies with the most complex role lists in the 'ACTED_IN' relationship.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
RETURN m.title, r.roles
ORDER BY size(r.roles) DESC
LIMIT 3",Pathfinding Queries,movies,False,False,True,
What is the average rating of movies reviewed by persons born after 1970?,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)
WHERE p.born > 1970
RETURN AVG(m.rating) AS average_rating",Pathfinding Queries,movies,False,False,True,Movie.rating
List the roles of any person in movies with a title containing 'Matrix'.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE m.title CONTAINS 'Matrix'
RETURN p.name, r.roles",Pathfinding Queries,movies,False,False,True,
Which persons have reviewed the most movies with a rating over 75?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating > 75
WITH p, count(m) AS moviesReviewed
ORDER BY moviesReviewed DESC
RETURN p.name, moviesReviewed",Pathfinding Queries,movies,False,False,False,
List the top 5 movies with a tagline containing 'football'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'football'
RETURN m
ORDER BY m.released DESC
LIMIT 5",Pathfinding Queries,movies,False,False,True,
Who reviewed movies with a summary mentioning 'funny'?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.summary CONTAINS 'funny'
RETURN p.name, m.title, r.summary",Pathfinding Queries,movies,False,False,True,
List all movies with more than 2000 votes.,"MATCH (m:Movie)
WHERE m.votes > 2000
RETURN m",Pathfinding Queries,movies,False,False,True,
Which movies have been produced by persons born before 1960?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.born < 1960
RETURN m.title AS MovieTitle, m.released AS ReleaseYear",Pathfinding Queries,movies,False,False,True,
What are the first 3 movies with a released year divisible by 10 and votes over 500?,"MATCH (m:Movie)
WHERE m.released % 10 = 0 AND m.votes > 500
RETURN m
ORDER BY m.released ASC
LIMIT 3",Pathfinding Queries,movies,True,False,False,
What are the most common roles in movies released before 1980?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE m.released < 1980
UNWIND r.roles AS role
RETURN role, COUNT(role) AS role_count
ORDER BY role_count DESC",Pathfinding Queries,movies,False,False,True,
Who are the top 3 youngest directors in the graph?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
RETURN p.name, p.born
ORDER BY p.born DESC
LIMIT 3",Pathfinding Queries,movies,False,False,True,
What are the names of 3 persons who reviewed movies with a rating lower than 60?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating < 60
RETURN p.name
LIMIT 3",Simple Aggregation Queries,movies,False,False,False,
List the top 5 movies that have not been reviewed.,"MATCH (m:Movie)
WHERE NOT exists{ (:Person)-[:REVIEWED]->(m) }
RETURN m
ORDER BY m.votes DESC
LIMIT 5",Pathfinding Queries,movies,False,False,True,
List the roles of Keanu Reeves in 'The Matrix'.,"MATCH (p:Person {name: ""Keanu Reeves""})-[:ACTED_IN {roles: roles}]->(m:Movie {title: ""The Matrix""})
RETURN roles",Pathfinding Queries,movies,False,False,True,
Which movies have 'Robin Williams' mentioned in the review summary?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.summary CONTAINS 'Robin Williams'
RETURN m.title AS MovieTitle, r.summary AS ReviewSummary",Pathfinding Queries,movies,False,False,True,
Who has directed the most movies with a release after 1995?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.released > 1995
WITH p, count(m) AS moviesDirected
ORDER BY moviesDirected DESC
LIMIT 1
RETURN p.name AS Director, moviesDirected",Pathfinding Queries,movies,False,False,False,
List the top 3 pairs of persons who follow each other.,"MATCH (p1:Person)-[:FOLLOWS]->(p2:Person)
WHERE exists{ (p2)-[:FOLLOWS]->(p1) }
RETURN p1.name, p2.name
LIMIT 3",Pathfinding Queries,movies,False,False,False,
What are the roles list sizes for each movie Keanu Reeves has acted in?,"MATCH (p:Person {name: ""Keanu Reeves""})-[:ACTED_IN]->(m:Movie)
RETURN m.title AS Movie, size(m.roles) AS RolesListSize",Pathfinding Queries,movies,True,False,False,Movie.roles
"Which persons born after 1980 have acted in, directed, or produced any movies?","MATCH (p:Person)-[r:ACTED_IN|DIRECTED|PRODUCED]->(m:Movie)
WHERE p.born > 1980
RETURN p.name, collect(m.title) AS movies",Pathfinding Queries,movies,False,False,False,
Find the movies with a tagline containing 'beginning'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'beginning'
RETURN m",Pathfinding Queries,movies,False,False,True,
What is the summary of the lowest-rated review of 'Speed Racer'?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie {title: 'Speed Racer'})
RETURN r.summary AS Summary
ORDER BY r.rating ASC
LIMIT 1",Pathfinding Queries,movies,False,False,True,
Who are the top 3 producers of movies released before 1990?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE m.released < 1990
RETURN p.name, count(m) AS movies_produced
ORDER BY movies_produced DESC
LIMIT 3",Pathfinding Queries,movies,False,False,True,
Which movies released in the 2000s have been reviewed with a rating below 60?,"MATCH (m:Movie)<-[:REVIEWED {rating: r}]-(p:Person)
WHERE m.released >= 2000 AND m.released < 2010 AND r < 60
RETURN m.title, m.released, r AS rating, p.name AS reviewer",Pathfinding Queries,movies,False,False,True,
List all movies with exactly 5 roles in the 'ACTED_IN' relationship.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE size(r.roles) = 5
RETURN m.title, collect(p.name) AS actors",Pathfinding Queries,movies,False,False,True,
Who has produced the most movies?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
RETURN p.name, count(m) AS movies_produced
ORDER BY movies_produced DESC
LIMIT 1",Pathfinding Queries,movies,False,False,True,
Which 3 movies have the longest runtime and were released before 2000?,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01') AND m.runtime IS NOT NULL
RETURN m
ORDER BY m.runtime DESC
LIMIT 3",Verbose query,neoflix,False,False,True,
What are the top 3 genres associated with videos that have a runtime over 100 minutes?,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WHERE v.runtime > 100
RETURN g, count(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 3",Verbose query,neoflix,False,False,True,
What are the first 3 languages spoken in the most popular movies (popularity > 20)?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.popularity > 20
RETURN l.name AS Language
ORDER BY m.popularity DESC
LIMIT 3",Verbose query,neoflix,False,True,False,
List the top 5 actors by the number of movies they have cast in with a budget over 50 million USD.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WHERE m.budget > 50000000
RETURN p.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
"Name the top 5 movies that have been produced in a specific genre, e.g., 'Animation'.","MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN m.title AS MovieTitle, m.average_vote AS AverageVote
ORDER BY m.average_vote DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
List the first 3 languages spoken in movies released after 2010.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.release_date > date('2010-12-31')
RETURN DISTINCT l.name
LIMIT 3",Verbose query,neoflix,False,False,True,
Which 5 countries have produced the most adult films?,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name, count(a) AS NumberOfAdultFilms
ORDER BY NumberOfAdultFilms DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
Which 5 users have rated the highest number of movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN u.id, count(r) AS ratings_count
ORDER BY ratings_count DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
What are the first 3 collections that include movies with a budget over 50 million USD?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE m.budget > 50000000
RETURN c
LIMIT 3",Verbose query,neoflix,False,False,True,
List the top 5 actors by the number of movies they have cast in.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
RETURN p.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
Which 3 movies have the most keywords associated with them?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
RETURN m.title, count(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 3",Verbose query,neoflix,False,False,True,
List the 5 countries where movies with a revenue greater than 500 million USD were produced.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.revenue > 500000000
RETURN DISTINCT c.name
LIMIT 5",Verbose query,neoflix,False,False,True,
What are the first 3 genres associated with movies that have a popularity greater than 20?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.popularity > 20
RETURN g
LIMIT 3",Verbose query,neoflix,False,False,True,
Name the top 3 production companies by the number of movies produced with a budget over 100 million USD.,"MATCH (pc:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
WHERE m.budget > 100000000
RETURN pc.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3",Verbose query,neoflix,False,False,True,
Which 5 movies have the highest average vote and were released before 2000?,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01') AND m.average_vote IS NOT NULL
RETURN m
ORDER BY m.average_vote DESC
LIMIT 5",Verbose query,neoflix,True,False,False,
What are the top 5 movies by revenue that have a runtime greater than 120 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 120 AND m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
Which 3 directors have the most films with a status of 'Released'?,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE m.status = 'Released' AND r.job = 'Director'
RETURN p.name, count(m) AS num_films
ORDER BY num_films DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 5 movies with the most spoken languages and released after 2015?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.release_date > date('2015-01-01')
WITH m, count(l) AS languages_spoken
ORDER BY languages_spoken DESC
RETURN m.title, languages_spoken
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
List the first 3 genres with the most movies featuring a runtime over 200 minutes.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.runtime > 200
WITH g, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3
RETURN g.name, movieCount",Complex Aggregation Queries,neoflix,False,False,False,
Who are the first 3 actors to have appeared in movies from more than five different countries?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WITH p, count(DISTINCT (m)-[:PRODUCED_IN_COUNTRY]->(:Country)) AS countries_count
WHERE countries_count > 5
RETURN p.name
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Name the top 3 genres in videos that have a runtime less than 30 minutes.,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WHERE v.runtime < 30
RETURN g.name, count(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 3",Verbose query,neoflix,True,False,False,
What are the top 3 countries producing the most videos with a budget over $1 million?,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE v.budget > 1000000
RETURN c.name, count(v) AS num_videos
ORDER BY num_videos DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 languages are most common in movies with a revenue over $200 million?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.revenue > 200000000
RETURN l.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Who are the first 3 directors to have made both adult films and videos?,"MATCH (p:Person)-[:CREW_FOR]->(a:Adult), (p)-[:CREW_FOR]->(v:Video)
WHERE a.job = 'Director' AND v.job = 'Director'
RETURN p.name AS Director
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,"Adult.job, Video.job"
What are the top 5 genres with the most movies having a poster path that starts with '/rh'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.poster_path STARTS WITH '/rh'
WITH g, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 5
RETURN g.name AS Genre, movieCount",Complex Aggregation Queries,neoflix,False,False,True,
List the first 3 actors who have appeared in at least three movies with different original languages.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WITH p, count(DISTINCT (m)-[:ORIGINAL_LANGUAGE]->()) AS num_languages
WHERE num_languages >= 3
RETURN p.name
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 production companies have the most movies with a runtime under 80 minutes?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WHERE m.runtime < 80
WITH pc, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3
RETURN pc.name, movies_count",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 5 countries producing the most movies with a tagline that includes the word 'love'?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.tagline CONTAINS 'love'
RETURN c.name AS Country, count(m) AS MoviesProduced
ORDER BY MoviesProduced DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,False,
Who are the first 3 directors who have worked on movies with an average vote below 5?,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = 'Director' AND m.average_vote < 5
RETURN p.name
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 5 production companies with the most movies featuring a runtime over 150 minutes?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WHERE m.runtime > 150
WITH pc, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 5
RETURN pc.name, movies_count",Complex Aggregation Queries,neoflix,False,False,True,
List the first 3 movies with the highest number of directors.,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = 'Director'
WITH m, count(p) AS directorCount
ORDER BY directorCount DESC
RETURN m.title AS MovieTitle, directorCount
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 languages are most commonly spoken in movies with an average vote below 4?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.average_vote < 4
RETURN l.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Who are the first 3 actors who starred in movies that won at least one Oscar?,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
WHERE exists {
    (m)-[:HAS_KEYWORD]->(k:Keyword)
    WHERE k.name = 'Oscar'
}
RETURN p.name
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 5 genres with the least number of movies made?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WITH g, count(m) AS movieCount
ORDER BY movieCount ASC
LIMIT 5
RETURN g.name AS Genre, movieCount AS MoviesCount",Complex Aggregation Queries,neoflix,False,False,True,
List the top 3 movies with a budget over 100 million USD and an average vote above 7.,"MATCH (m:Movie)
WHERE m.budget > 100000000 AND m.average_vote > 7
RETURN m
ORDER BY m.average_vote DESC
LIMIT 3",Verbose query,neoflix,False,False,True,
List the top 5 movies with the most production companies involved.,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WITH m, count(pc) AS num_companies
ORDER BY num_companies DESC
LIMIT 5
RETURN m.title, num_companies",Complex Aggregation Queries,neoflix,False,False,True,
List the first 5 production companies that produced videos with zero revenue.,"MATCH (v:Video)-[:PRODUCED_BY]->(pc:ProductionCompany)
WHERE v.revenue = 0
RETURN DISTINCT pc
LIMIT 5",Verbose query,neoflix,False,False,True,
What are the top 3 countries where adult films are produced the most?,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS Country, count(a) AS NumberOfAdultFilms
ORDER BY NumberOfAdultFilms DESC
LIMIT 3",Verbose query,neoflix,False,False,False,
"Which 5 keywords are most common in adult films with a budget less than 500,000 USD?","MATCH (a:Adult)-[:HAS_KEYWORD]->(k:Keyword)
WHERE a.budget < 500000
RETURN k.name, count(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
"List the first 3 adult films with a specific tagline, e.g., 'Trust Will Get You Killed'.","MATCH (a:Adult {tagline: 'Trust Will Get You Killed'})
RETURN a
LIMIT 3",Verbose query,neoflix,False,False,True,
Name the top 5 movies with the most detailed overviews (measured by word count).,"MATCH (m:Movie)
WHERE m.overview IS NOT NULL
RETURN m.title, size(split(m.overview, ' ')) AS word_count
ORDER BY word_count DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
What are the first 3 collections that include videos?,"MATCH (v:Video)-[:IN_COLLECTION]->(c:Collection)
RETURN DISTINCT c
LIMIT 3",Verbose query,neoflix,False,False,True,
"List the top 5 movies with the most diverse cast, measured by the number of different countries actors come from.","MATCH (m:Movie)<-[:CAST_FOR]-(p:Person)-[:FROM_COUNTRY]->(c:Country)
WITH m, count(DISTINCT c) AS num_countries
ORDER BY num_countries DESC
LIMIT 5
RETURN m.title, num_countries",Verbose query,neoflix,True,False,False,FROM_COUNTRY
Which 3 movies have the highest budget to revenue ratio?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL AND m.revenue > 0
RETURN m.title, m.budget, m.revenue, (toFloat(m.budget) / m.revenue) AS budgetToRevenueRatio
ORDER BY budgetToRevenueRatio DESC
LIMIT 3",Verbose query,neoflix,False,False,True,
List the first 5 languages used in the original language of adult films.,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN DISTINCT l.name
LIMIT 5",Verbose query,neoflix,False,False,True,
What are the top 3 movies based on popularity that were released in the 1990s?,"MATCH (m:Movie)
WHERE m.release_date >= date('1990-01-01') AND m.release_date <= date('1999-12-31')
RETURN m
ORDER BY m.popularity DESC
LIMIT 3",Verbose query,neoflix,False,False,True,
Name the first 5 movies that have a homepage listed.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title
LIMIT 5",Verbose query,neoflix,False,False,True,
List the top 3 actors who have appeared in both movies and videos.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WITH p, count(m) AS moviesCount
WHERE moviesCount > 0
MATCH (p)-[:CAST_FOR]->(v:Video)
WITH p, count(v) AS videosCount
WHERE videosCount > 0
RETURN p.name, moviesCount, videosCount
ORDER BY moviesCount DESC, videosCount DESC
LIMIT 3",Verbose query,neoflix,False,False,True,
Which 5 genres are most common among movies with a budget over 200 million USD?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget > 200000000
RETURN g.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5",Verbose query,neoflix,False,True,False,
List the first 3 keywords associated with movies that have a poster path ending in '.jpg'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.poster_path ENDS WITH '.jpg'
RETURN k.name
LIMIT 3",Verbose query,neoflix,False,False,True,
Name the top 5 production companies that have produced movies with a runtime longer than 150 minutes.,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WHERE m.runtime > 150
RETURN pc.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
What are the first 3 movies that were produced in the United States and have a vote count greater than 5000?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: ""United States of America""})
WHERE m.vote_count > 5000
RETURN m
ORDER BY m.release_date
LIMIT 3",Verbose query,neoflix,False,False,True,
List the top 5 actors based on the number of leading roles they have had in movies.,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
WHERE r.order = 0
RETURN p.name, count(m) AS leading_roles
ORDER BY leading_roles DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
Which 3 users have given the highest ratings to movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN u.id AS UserID, avg(r.rating) AS AverageRating
ORDER BY AverageRating DESC
LIMIT 3",Verbose query,neoflix,False,False,True,
List the first 5 adult films released after 2010.,"MATCH (a:Adult)
WHERE a.release_date > date('2010-01-01')
RETURN a
ORDER BY a.release_date ASC
LIMIT 5",Verbose query,neoflix,False,False,True,
What are the top 3 adult films with the highest average vote?,"MATCH (a:Adult)
WHERE a.average_vote IS NOT NULL
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 3",Verbose query,neoflix,False,False,True,
Name the first 5 genres that videos with a popularity rating above 5 belong to.,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WHERE v.popularity > 5
RETURN DISTINCT g.name
LIMIT 5",Verbose query,neoflix,False,False,True,
List the top 3 countries by the number of videos produced.,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS Country, count(v) AS NumberOfVideos
ORDER BY NumberOfVideos DESC
LIMIT 3",Verbose query,neoflix,False,False,True,
Which 5 movies have the most cast members?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WITH m, count(p) AS cast_count
ORDER BY cast_count DESC
LIMIT 5
RETURN m.title, cast_count",Verbose query,neoflix,False,False,True,
List the first 3 movies that have the tagline 'Roll the dice and unleash the excitement!'.,"MATCH (m:Movie {tagline: 'Roll the dice and unleash the excitement!'})
RETURN m
LIMIT 3",Verbose query,neoflix,False,False,True,
Name the top 5 directors who have worked on the most films.,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = 'Director'
WITH p, count(m) AS films_directed
ORDER BY films_directed DESC
LIMIT 5
RETURN p.name AS Director, films_directed",Verbose query,neoflix,False,False,True,
What are the first 3 genres associated with the highest-grossing movies?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.revenue IS NOT NULL
RETURN g.name, sum(m.revenue) as totalRevenue
ORDER BY totalRevenue DESC
LIMIT 3",Verbose query,neoflix,False,False,False,
"List the top 5 movies that have been produced by a specific company, e.g., 'Pixar Animation Studios'.","MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN m
ORDER BY m.popularity DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
Which 3 languages are most frequently listed as the original language in videos?,"MATCH (v:Video)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS Language, count(v) AS Count
ORDER BY Count DESC
LIMIT 3",Verbose query,neoflix,False,False,True,
"List the first 5 movies that have been tagged with a specific keyword, e.g., 'adventure'.","MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'adventure'})
RETURN m
LIMIT 5",Verbose query,neoflix,False,False,True,
What are the top 3 actors who have played in the most number of adult films?,"MATCH (p:Person)-[r:CAST_FOR]->(a:Adult)
WITH p, count(a) AS num_adult_films
ORDER BY num_adult_films DESC
LIMIT 3
RETURN p.name, num_adult_films",Verbose query,neoflix,False,False,True,
"Name the first 5 movies that were rated by users on a specific date, e.g., '2020-01-01'.","MATCH (m:Movie)<-[:RATED]-(u:User)-[r:RATED]->(m)
WHERE r.timestamp = date('2020-01-01')
RETURN m.title AS MovieTitle
LIMIT 5",Verbose query,neoflix,False,False,True,
List the top 3 movies with the highest revenue that are part of a collection.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue, c.name
ORDER BY m.revenue DESC
LIMIT 3",Verbose query,neoflix,False,False,True,
"Name the first 5 movies that were produced by a specific country, e.g., 'France'.","MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'France'})
RETURN m.title AS MovieTitle
LIMIT 5",Verbose query,neoflix,False,False,True,
List the first 5 production companies that have produced the most adult films.,"MATCH (p:ProductionCompany)-[:PRODUCED_BY]-(a:Adult)
WITH p, count(a) AS numAdultFilms
ORDER BY numAdultFilms DESC
RETURN p.name, numAdultFilms
LIMIT 5",Verbose query,neoflix,False,False,True,
Which movies have a title that starts with 'The'?,"MATCH (m:Movie)
WHERE m.title STARTS WITH 'The'
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Which 3 movies have the highest average vote above 8.0?,"MATCH (m:Movie)
WHERE m.average_vote > 8.0
RETURN m
ORDER BY m.average_vote DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
"What are the first 3 adult videos with a budget over $500,000?","MATCH (a:Adult)
WHERE a.budget > 500000
RETURN a
ORDER BY a.id
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,False,
Name the top 5 adult videos with the highest average vote.,"MATCH (a:Adult)
WHERE a.average_vote IS NOT NULL
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 adult videos have the longest runtime?,"MATCH (a:Adult)
RETURN a.title, a.runtime
ORDER BY a.runtime DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
List the top 5 adult videos by vote count.,"MATCH (a:Adult)
RETURN a.title, a.vote_count
ORDER BY a.vote_count DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
What are the first 3 adult videos by revenue?,"MATCH (a:Adult)
WHERE a.revenue IS NOT NULL
RETURN a
ORDER BY a.revenue DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Name the top 5 movies with 'Animated' as a keyword.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'Animated'})
RETURN m.title AS MovieTitle
ORDER BY m.popularity DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 countries have the least number of movies produced in them?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH c, count(m) AS movie_count
ORDER BY movie_count ASC
LIMIT 3
RETURN c.name AS Country, movie_count AS Movies_Produced",Complex Aggregation Queries,neoflix,False,False,True,
List 5 movies where the original and spoken languages are different.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(ol:Language),
      (m)-[:SPOKEN_IN_LANGUAGE]->(sl:Language)
WHERE ol.id <> sl.id
RETURN m.title, ol.name AS original_language, sl.name AS spoken_language
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,False,
What are the first 3 languages spoken in movies with a budget over $50 million?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.budget > 50000000
RETURN DISTINCT l.name
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Name the top 5 genres by the average votes of the movies in them.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.average_vote IS NOT NULL
RETURN g.name AS Genre, avg(m.average_vote) AS AverageVote
ORDER BY AverageVote DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 movies have the highest popularity but the least revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL AND m.popularity IS NOT NULL
RETURN m
ORDER BY m.popularity DESC, m.revenue ASC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
List the top 5 movies that have a homepage URL.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m
ORDER BY m.popularity DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
What are the first 3 movies with a release date on a Monday?,"MATCH (m:Movie)
WHERE m.release_date.dayOfWeek = 'MONDAY'
RETURN m
ORDER BY m.release_date
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Name the top 5 movies with a tagline containing the word 'love'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'love'
RETURN m.title, m.tagline
ORDER BY m.popularity DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 movies have the most revenue among those released in the 1990s?,"MATCH (m:Movie)
WHERE m.release_date >= date('1990-01-01') AND m.release_date <= date('1999-12-31')
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
List 5 movies that have a poster path containing '/rh'.,"MATCH (m:Movie)
WHERE m.poster_path CONTAINS '/rh'
RETURN m
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
What are the first 3 movies that are not part of any collection?,"MATCH (m:Movie)
WHERE NOT EXISTS { (m)-[:IN_COLLECTION]->(:Collection) }
RETURN m
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Name the top 5 movies that are part of a collection.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
RETURN m.title AS MovieTitle, c.name AS CollectionName
ORDER BY m.popularity DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 production companies have the smallest number of movies?,"MATCH (pc:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
WITH pc, count(m) AS numMovies
ORDER BY numMovies ASC
LIMIT 3
RETURN pc.name, numMovies",Complex Aggregation Queries,neoflix,False,False,True,
List the top 5 languages based on the number of movies originally in that language.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.id AS LanguageID, l.name AS LanguageName, count(m) AS MovieCount
ORDER BY MovieCount DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
What are the first 3 genres with the least number of associated movies?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WITH g, count(m) AS movieCount
ORDER BY movieCount ASC
LIMIT 3
RETURN g.name AS Genre, movieCount",Complex Aggregation Queries,neoflix,False,False,True,
Name the top 5 movies with the most budget to revenue ratio.,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL AND m.revenue > 0
RETURN m.title, m.budget, m.revenue, (toFloat(m.budget) / m.revenue) AS budgetToRevenueRatio
ORDER BY budgetToRevenueRatio DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 movies have the least number of votes?,"MATCH (m:Movie)
WHERE m.vote_count IS NOT NULL
RETURN m
ORDER BY m.vote_count ASC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
List the 5 oldest adult videos based on release date.,"MATCH (a:Adult)
WHERE a.release_date IS NOT NULL
RETURN a.title, a.release_date
ORDER BY a.release_date ASC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
List the top 5 movies based on popularity.,"MATCH (m:Movie)
RETURN m
ORDER BY m.popularity DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 adult videos have the most keywords associated with them?,"MATCH (a:Adult)-[:HAS_KEYWORD]->(k:Keyword)
WITH a, count(k) AS keyword_count
RETURN a.title, keyword_count
ORDER BY keyword_count DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
What are the first 3 adult videos not produced in any country listed?,"MATCH (a:Adult)
WHERE NOT exists {
  (a)-[:PRODUCED_IN_COUNTRY]->(:Country)
}
RETURN a
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Name the top 5 videos with the most associated genres.,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WITH v, count(g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN v.title AS VideoTitle, genreCount",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 videos have the highest number of associated production companies?,"MATCH (v:Video)-[:PRODUCED_BY]->(pc:ProductionCompany)
WITH v, count(pc) AS num_companies
ORDER BY num_companies DESC
LIMIT 3
RETURN v.title AS VideoTitle, num_companies AS NumberOfProductionCompanies",Complex Aggregation Queries,neoflix,False,False,True,
List the top 5 videos by the number of countries they were produced in.,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH v, count(DISTINCT c) AS countries_count
ORDER BY countries_count DESC
RETURN v.title, countries_count
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
What are the first 3 videos with the most associated keywords?,"MATCH (v:Video)-[:HAS_KEYWORD]->(k:Keyword)
WITH v, count(k) AS keywordCount
ORDER BY keywordCount DESC
RETURN v.title, keywordCount
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Name the top 5 movies with the most associated collections.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WITH m, count(c) AS num_collections
ORDER BY num_collections DESC
LIMIT 5
RETURN m.title AS MovieTitle, num_collections AS NumberOfCollections",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 movies have the most associated genres?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(g) AS genreCount
ORDER BY genreCount DESC
LIMIT 3
RETURN m.title, genreCount",Complex Aggregation Queries,neoflix,False,False,True,
List the top 5 movies that are rated by the most users.,"MATCH (m:Movie)<-[:RATED]-(u:User)
WITH m, count(u) AS userCount
ORDER BY userCount DESC
LIMIT 5
RETURN m.title, userCount",Complex Aggregation Queries,neoflix,True,False,False,
What are the first 3 movies with the highest number of associated production companies?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WITH m, count(pc) AS num_companies
ORDER BY num_companies DESC
RETURN m.title, num_companies
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Name the top 5 countries based on the number of languages spoken in their produced movies.,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH c, COUNT(DISTINCT l) AS languages_spoken
RETURN c.name AS country, languages_spoken
ORDER BY languages_spoken DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 movies have the highest number of associated languages?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN m.title, count(l) AS num_languages
ORDER BY num_languages DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
List the top 5 movies with the most crew members in the 'Production' department.,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.department = 'Production'
WITH m, count(p) AS crew_count
ORDER BY crew_count DESC
LIMIT 5
RETURN m.title, crew_count",Complex Aggregation Queries,neoflix,False,False,True,
What are the first 3 movies with the most associated cast members?,"MATCH (m:Movie)
WITH m, size((m)<-[:CAST_FOR]-(:Person)) AS cast_count
ORDER BY cast_count DESC
RETURN m.title, cast_count
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Name the top 5 packages that provide access to the 'Animation' genre.,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre {name: 'Animation'})
RETURN p.name AS PackageName
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 genres are provided access to by the 'Gold' package?,"MATCH (p:Package {name: 'Gold'})-[:PROVIDES_ACCESS_TO]->(g:Genre)
RETURN g.name AS GenreName
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
List the top 5 packages by the number of subscriptions associated with them.,"MATCH (p:Package)<-[:FOR_PACKAGE]-(s:Subscription)
RETURN p.name AS PackageName, count(s) AS SubscriptionsCount
ORDER BY SubscriptionsCount DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
What are the first 3 packages with the highest price?,"MATCH (p:Package)
RETURN p
ORDER BY p.price DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Name the top 5 subscriptions by the duration of the package they are for.,"MATCH (s:Subscription)-[:FOR_PACKAGE]->(p:Package)
RETURN s.id AS SubscriptionID, p.name AS PackageName, p.duration AS PackageDuration
ORDER BY p.duration DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 packages provide access to the most genres?,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre)
WITH p, count(g) AS genres_count
RETURN p.name, genres_count
ORDER BY genres_count DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
List the top 5 adult videos based on popularity.,"MATCH (a:Adult)
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
What are the first 3 adult videos with exactly one keyword?,"MATCH (a:Adult)-[:HAS_KEYWORD]->(k:Keyword)
WITH a, count(k) AS keywordCount
WHERE keywordCount = 1
RETURN a
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Name the top 5 adult videos with the least revenue.,"MATCH (a:Adult)
WHERE a.revenue IS NOT NULL
RETURN a.title, a.revenue
ORDER BY a.revenue ASC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 adult videos have the most provocative poster paths?,"MATCH (a:Adult)
WHERE a.poster_path IS NOT NULL
RETURN a.title, a.poster_path
ORDER BY a.popularity DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
List 5 adult videos with a tagline containing the word 'sex'.,"MATCH (a:Adult)
WHERE a.tagline CONTAINS 'sex'
RETURN a
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Name the top 5 adult videos that were produced in Italy.,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country {id: ""IT""})
RETURN a.title AS Title, a.id AS ID
ORDER BY a.popularity DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
What are the first 3 videos with the highest popularity?,"MATCH (v:Video)
RETURN v
ORDER BY v.popularity DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
What are the first 3 movies with the shortest runtime?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m
ORDER BY m.runtime ASC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 collections contain the most movies?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WITH c, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3
RETURN c.name, movieCount",Complex Aggregation Queries,neoflix,False,False,True,
Show the top 5 oldest movies in the collection with the highest revenue.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.release_date, m.revenue
ORDER BY m.release_date ASC, m.revenue DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
Which 3 movies have the most extensive cast list?,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
RETURN m.title, count(p) AS cast_count
ORDER BY cast_count DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
What are the first 5 movies that have a character played by a person with gender 1?,"MATCH (p:Person {gender: 1})-[:CAST_FOR]->(m:Movie)
RETURN m
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
List the top 3 highest grossing movies in the genre 'Action'.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Action'})
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Show the first 5 movies where the original language is not English but have English as a spoken language.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(ol:Language), (m)-[:SPOKEN_IN_LANGUAGE]->(sl:Language {id: 'en'})
WHERE ol.id <> 'en'
RETURN m
LIMIT 5",Pathfinding Queries,neoflix,False,False,False,
Which 3 movies have the highest discrepancy between budget and revenue?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.budget, m.revenue, abs(m.revenue - m.budget) AS discrepancy
ORDER BY discrepancy DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,False,
What are the top 5 movies that have undergone a title change after release?,"MATCH (m:Movie)
WHERE m.title <> m.original_title AND m.status = ""Released""
RETURN m.title AS CurrentTitle, m.original_title AS OriginalTitle, m.release_date AS ReleaseDate
ORDER BY m.release_date DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
List the first 3 movies with a backdrop path that includes '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE c.backdrop_path = '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'
RETURN m
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Show the top 5 movies with a poster path ending in '.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH '.jpg'
RETURN m
ORDER BY m.id DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
Which 3 movies have changed their status from 'In Production' to 'Released'?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND exists {
    MATCH (m2:Movie {id: m.id})
    WHERE m2.status = 'In Production'
}
RETURN m
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
What are the first 5 movies that have a genre change from their original genre in a collection?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre), (m)-[:IN_COLLECTION]->(c:Collection)
WHERE NOT EXISTS {
    MATCH (m)-[:IN_GENRE]->(og:Genre)
    WHERE g.id = og.id
}
RETURN m.title, g.name, c.name
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
List the top 3 people with the most crew roles in movies.,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WITH p, count(r) AS roles
ORDER BY roles DESC
LIMIT 3
RETURN p.name, roles",Pathfinding Queries,neoflix,False,False,True,
Show the first 5 movies that have a character named 'Charlie Wilson' in their cast.,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
WHERE r.character = 'Charlie Wilson'
RETURN m
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
Which 3 countries have produced the most movies in the genre 'Drama'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Drama'})
MATCH (m)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH c, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3
RETURN c.name, movies_count",Pathfinding Queries,neoflix,False,False,True,
What are the top 5 languages spoken in movies that have a budget over $50 million?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.budget > 50000000
RETURN l.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
List the first 3 people who have both acted in and produced a movie.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WHERE exists {
    MATCH (p)-[:CREW_FOR {job: 'Producer'}]->(m)
}
RETURN p
LIMIT 3",Pathfinding Queries,neoflix,False,False,False,
Show the top 5 movies with the lowest average vote but highest revenue.,"MATCH (m:Movie)
WHERE m.average_vote IS NOT NULL AND m.revenue IS NOT NULL
RETURN m
ORDER BY m.average_vote ASC, m.revenue DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
Which 3 production companies have produced the most movies?,"MATCH (pc:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
RETURN pc.name, count(m) AS movies_produced
ORDER BY movies_produced DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
What are the first 5 movies with a release date on a weekend?,"MATCH (m:Movie)
WHERE date(m.release_date).dayOfWeek IN [6, 7]
RETURN m
ORDER BY m.release_date
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
List the top 3 collections with the most movies included.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WITH c, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3
RETURN c.name, movieCount",Pathfinding Queries,neoflix,False,False,True,
Show the first 5 videos produced by the company with ID 10.,"MATCH (v:Video)-[:PRODUCED_BY]->(pc:ProductionCompany {id: 10})
RETURN v
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
Which 3 videos have the most keywords associated with them?,"MATCH (v:Video)-[:HAS_KEYWORD]->(k:Keyword)
WITH v, count(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 3
RETURN v.title AS VideoTitle, keyword_count",Pathfinding Queries,neoflix,False,False,True,
What are the top 5 videos that have been rated by the most users?,"MATCH (v:Video)<-[:RATED]-(u:User)
WITH v, count(u) AS userCount
ORDER BY userCount DESC
LIMIT 5
RETURN v.title, userCount",Pathfinding Queries,neoflix,False,False,True,
List the first 3 movies that have a link to their homepage that includes 'disney'.,"MATCH (m:Movie)
WHERE m.homepage CONTAINS 'disney'
RETURN m
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Name the top 5 movies with the longest runtime.,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 5 movies with the most significant number of languages spoken?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(l) AS languages_spoken
ORDER BY languages_spoken DESC
RETURN m.title, languages_spoken
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
Show the first 5 movies where the production company's name includes 'Studios'.,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WHERE pc.name CONTAINS 'Studios'
RETURN m
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
List 5 countries where the most movies were produced.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS Country, count(m) AS NumberOfMovies
ORDER BY NumberOfMovies DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
What are the first 3 genres that have the most movies?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS Genre, count(m) AS MovieCount
ORDER BY MovieCount DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Name the top 5 production companies by the number of movies produced.,"MATCH (pc:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
RETURN pc.name, count(m) AS movies_produced
ORDER BY movies_produced DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 languages are spoken in the most number of movies?,"MATCH (l:Language)<-[:SPOKEN_IN_LANGUAGE]-(m:Movie)
RETURN l.name AS Language, count(m) AS MoviesCount
ORDER BY MoviesCount DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
List the top 5 movies that made the least revenue.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue ASC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
What are the first 3 movies with the most characters in their overview?,"MATCH (m:Movie)
WHERE m.overview IS NOT NULL
RETURN m
ORDER BY size(m.overview) DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Name the top 5 movies by vote count.,"MATCH (m:Movie)
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 movies have the most keywords associated with them?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
RETURN m.title, count(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
List 5 movies that have a runtime longer than 120 minutes.,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
What are the first 3 highest budget movies that were released?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.budget IS NOT NULL
RETURN m
ORDER BY m.budget DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Name the top 5 oldest movies in the database.,"MATCH (m:Movie)
WHERE m.release_date IS NOT NULL
RETURN m.title, m.release_date
ORDER BY m.release_date ASC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 movies have the highest average vote?,"MATCH (m:Movie)
WHERE m.average_vote IS NOT NULL
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
List the first 3 movies released after 2010.,"MATCH (m:Movie)
WHERE m.release_date > date('2010-01-01')
RETURN m
ORDER BY m.release_date ASC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 5 movies sorted by revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,False,
"List the top 3 adult films with a budget under $10,000.","MATCH (a:Adult)
WHERE a.budget < 10000
RETURN a
ORDER BY a.budget DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Show the first 5 adult films based on their IMDB ID starting with 'tt007'.,"MATCH (a:Adult)
WHERE a.imdb_id STARTS WITH 'tt007'
RETURN a
ORDER BY a.imdb_id
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
Which 3 adult films have the lowest average votes but were produced in 'United States of America'?,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'United States of America'})
WHERE a.average_vote IS NOT NULL
RETURN a.title, a.average_vote
ORDER BY a.average_vote ASC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
What are the top 5 adult films with the highest number of votes?,"MATCH (a:Adult)
WHERE a.vote_count IS NOT NULL
RETURN a.title, a.vote_count
ORDER BY a.vote_count DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
List the first 3 adult films with a tagline mentioning 'love'.,"MATCH (a:Adult)
WHERE a.tagline CONTAINS 'love'
RETURN a
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Show the top 5 adult films with a poster path containing '/tzVK7nTnzUiVeFSZhOAIHmrgXUS.jpg'.,"MATCH (a:Adult)
WHERE a.poster_path = '/tzVK7nTnzUiVeFSZhOAIHmrgXUS.jpg'
RETURN a
ORDER BY a.average_vote DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
Which 3 adult films have been released during a leap year?,"MATCH (a:Adult)
WHERE a.release_date.year % 4 = 0 AND NOT (a.release_date.year % 100 = 0 AND a.release_date.year % 400 <> 0)
RETURN a.title, a.release_date
ORDER BY a.release_date
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
What are the first 5 adult films that have a runtime over 100 minutes?,"MATCH (a:Adult)
WHERE a.runtime > 100
RETURN a
ORDER BY a.release_date
LIMIT 5",Pathfinding Queries,neoflix,False,False,False,
List the top 3 videos that have a revenue of zero.,"MATCH (v:Video)
WHERE v.revenue = 0
RETURN v
ORDER BY v.popularity DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Which 3 movies have been rated exactly 5 times?,"MATCH (m:Movie)
WHERE count{(u:User)-[:RATED]->(m)} = 5
RETURN m
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
List the first 3 adult films with the largest budget.,"MATCH (a:Adult)
WHERE a.budget IS NOT NULL
RETURN a
ORDER BY a.budget DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
List the top 5 videos with the least revenue.,"MATCH (v:Video)
WHERE v.revenue IS NOT NULL
RETURN v
ORDER BY v.revenue ASC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Name the top 5 videos with the most crew members in the 'Production' department.,"MATCH (v:Video)-[cf:CREW_FOR]->(p:Person)
WHERE cf.department = 'Production'
WITH v, count(p) AS crewCount
ORDER BY crewCount DESC
LIMIT 5
RETURN v.title AS VideoTitle, crewCount",Complex Aggregation Queries,neoflix,False,False,True,
What are the first 3 movies that have a poster path containing '/vzmL6fP7aPKNKPRTFnZmiUfciyV.jpg'?,"MATCH (m:Movie)
WHERE m.poster_path = '/vzmL6fP7aPKNKPRTFnZmiUfciyV.jpg'
RETURN m
LIMIT 3",Verbose query,neoflix,False,False,True,
Name the top 5 videos that were released in the year 2010 or later.,"MATCH (v:Video)
WHERE v.release_date >= date('2010-01-01')
RETURN v.title, v.release_date
ORDER BY v.release_date ASC
LIMIT 5",Verbose query,neoflix,False,False,True,
List the top 5 movies that have a runtime exactly 90 minutes.,"MATCH (m:Movie)
WHERE m.runtime = 90
RETURN m
ORDER BY m.popularity DESC
LIMIT 5",Verbose query,neoflix,False,False,False,
Which 3 movies have an average vote greater than 8 and have been produced in 'France'?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'France'})
WHERE m.average_vote > 8
RETURN m
ORDER BY m.average_vote DESC
LIMIT 3",Verbose query,neoflix,True,False,False,
List the top 5 countries where the most adult films have been produced.,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS Country, count(a) AS NumberOfAdultFilms
ORDER BY NumberOfAdultFilms DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
What are the first 3 movies that have a budget exactly 50 million USD?,"MATCH (m:Movie)
WHERE m.budget = 50000000
RETURN m
LIMIT 3",Verbose query,neoflix,False,False,True,
Name the top 5 production companies that have produced the highest grossing movies.,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
RETURN pc.name AS ProductionCompanyName, SUM(m.revenue) AS TotalRevenue
ORDER BY TotalRevenue DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
List the top 5 videos that have a tagline including the word 'comedy'.,"MATCH (v:Video)
WHERE v.tagline CONTAINS 'comedy'
RETURN v
ORDER BY v.average_vote DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
Which 3 movies have the most extensive cast list as determined by the number of cast credits?,"MATCH (m:Movie)
WITH m, size((:Person)-[:CAST_FOR]->(m)) AS castSize
ORDER BY castSize DESC
LIMIT 3
RETURN m.title, castSize",Verbose query,neoflix,False,False,True,
"List the top 5 movies with a release date on or before December 31, 1990.","MATCH (m:Movie)
WHERE m.release_date <= date('1990-12-31')
RETURN m
ORDER BY m.release_date DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
What are the first 3 movies that have been rated by the user with ID '1'?,"MATCH (u:User {id: 1})-[:RATED]->(m:Movie)
RETURN m
LIMIT 3",Verbose query,neoflix,False,False,True,
Name the top 5 movies that have an IMDb ID starting with 'tt'.,"MATCH (m:Movie)
WHERE m.imdb_id STARTS WITH 'tt'
RETURN m.title, m.imdb_id
ORDER BY m.imdb_id
LIMIT 5",Verbose query,neoflix,False,False,True,
List the first 3 adult films that were released in the year 2000 or later.,"MATCH (a:Adult)
WHERE a.release_date >= date('2000-01-01')
RETURN a
ORDER BY a.release_date ASC
LIMIT 3",Verbose query,neoflix,False,False,True,
Which 3 movies have the most languages spoken in them?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(l) AS languages_spoken
ORDER BY languages_spoken DESC
LIMIT 3
RETURN m.title, languages_spoken",Verbose query,neoflix,False,False,True,
List the top 5 movies that have been produced by 'Universal Pictures'.,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Universal Pictures'})
RETURN m
ORDER BY m.average_vote DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
What are the first 3 movies that have a homepage URL containing 'disney'?,"MATCH (m:Movie)
WHERE m.homepage CONTAINS 'disney'
RETURN m
LIMIT 3",Verbose query,neoflix,False,False,True,
Name the top 5 most popular movies according to the vote count.,"MATCH (m:Movie)
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
List the first 3 persons who have worked as producers in more than 5 movies.,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = 'Producer'
WITH p, count(m) AS moviesProduced
WHERE moviesProduced > 5
RETURN p
LIMIT 3",Verbose query,neoflix,False,False,True,
Which 3 movies have a production company named 'Lucasfilm' associated with them?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Lucasfilm'})
RETURN m.title AS MovieTitle
LIMIT 3",Verbose query,neoflix,False,False,True,
List the top 5 movies where the revenue exceeded the budget by over 100 million USD.,"MATCH (m:Movie)
WHERE m.revenue > m.budget + 100000000
RETURN m
ORDER BY m.revenue DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
What are the first 3 movies with the genre 'Drama' that have a budget less than 10 million USD?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Drama'})
WHERE m.budget < 10000000
RETURN m
ORDER BY m.release_date
LIMIT 3",Verbose query,neoflix,False,False,True,
Name the top 5 movies where the main language spoken is not the original language.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language),
      (m)-[:ORIGINAL_LANGUAGE]->(ol:Language)
WHERE l.id <> ol.id
RETURN m.title AS MovieTitle, l.name AS SpokenLanguage, ol.name AS OriginalLanguage
ORDER BY m.popularity DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
List the first 3 genres where the most movies have been produced.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS Genre, count(m) AS MovieCount
ORDER BY MovieCount DESC
LIMIT 3",Verbose query,neoflix,False,False,True,
List the top 5 movies that were part of the 'Toy Story Collection' and have a runtime over 80 minutes.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
WHERE m.runtime > 80
RETURN m
ORDER BY m.runtime DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
Which 3 persons have the most crew credits in movies released after 2010?,"MATCH (p:Person)-[cf:CREW_FOR]->(m:Movie)
WHERE m.release_date > date('2010-01-01')
WITH p, count(cf) AS crew_credits
ORDER BY crew_credits DESC
LIMIT 3
RETURN p.name, crew_credits",Verbose query,neoflix,False,False,True,
Which 3 movies have been produced by 'Pixar Animation Studios' and have a runtime under 100 minutes?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Pixar Animation Studios'})
WHERE m.runtime < 100
RETURN m
LIMIT 3",Verbose query,neoflix,False,False,True,
Name the top 5 movies that have the keyword 'jealousy' associated with them.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title AS MovieTitle
ORDER BY m.popularity DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
Who are the first 3 actors with the most roles in videos released after 2010?,"MATCH (p:Person)-[r:CAST_FOR]->(v:Video)
WHERE v.release_date > date('2010-01-01')
WITH p, count(r) AS roles
ORDER BY roles DESC
LIMIT 3
RETURN p.name, roles",Complex Aggregation Queries,neoflix,False,False,True,
List the first 3 genres with the most movies released in the 21st century.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.release_date >= date('2000-01-01')
WITH g, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3
RETURN g.name, movieCount",Complex Aggregation Queries,neoflix,True,False,False,
What are the top 5 movies with the most keywords?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WITH m, count(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 5
RETURN m.title, keyword_count",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 directors have the highest average vote for their movies?,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = 'Director' AND m.average_vote IS NOT NULL
WITH p, avg(m.average_vote) AS avg_vote
RETURN p.name AS Director, avg_vote
ORDER BY avg_vote DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
List the first 3 movies with the most unique spoken languages.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(DISTINCT l) AS num_languages
ORDER BY num_languages DESC
RETURN m.title, num_languages
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 5 countries with the most movies featuring an average vote over 7.5?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.average_vote > 7.5
RETURN c.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Who are the first 3 actors to have roles in movies with at least five different production companies?,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
WITH p, m
WHERE size((m)-[:PRODUCED_BY]->(:ProductionCompany)) >= 5
RETURN p.name, collect(m.title) AS movies
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 languages are most commonly found in movies with a status of 'In Production'?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.status = 'In Production'
RETURN l.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
List the top 5 adult films based on the number of different languages spoken.,"MATCH (a:Adult)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH a, count(DISTINCT l) AS languages_spoken
ORDER BY languages_spoken DESC
RETURN a.title, languages_spoken
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 3 countries producing the most movies with an average vote below 5?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.average_vote < 5
RETURN c.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Who are the first 3 directors with movies in at least three different genres?,"MATCH (p:Person)-[:CREW_FOR {job: ""Director""}]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH p, count(DISTINCT g) AS genreCount
WHERE genreCount >= 3
RETURN p.name
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 production companies have produced the most movies with a popularity over 20?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WHERE m.popularity > 20
WITH pc, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3
RETURN pc.name, movies_count",Complex Aggregation Queries,neoflix,False,False,True,
List the first 3 movies that have a homepage and were released after 2010.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL AND m.release_date > date('2010-01-01')
RETURN m
ORDER BY m.release_date
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Name the top 5 most popular movies in the 'Science Fiction' genre.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Science Fiction'})
RETURN m.title AS MovieTitle, m.popularity AS Popularity
ORDER BY m.popularity DESC
LIMIT 5",Verbose query,neoflix,False,True,False,
List the first 3 movies that have a revenue over 500 million USD.,"MATCH (m:Movie)
WHERE m.revenue > 500000000
RETURN m
ORDER BY m.revenue DESC
LIMIT 3",Verbose query,neoflix,False,False,True,
Which 3 movies have a vote count over 2000 and a budget under 50 million USD?,"MATCH (m:Movie)
WHERE m.vote_count > 2000 AND m.budget < 50000000
RETURN m
ORDER BY m.vote_count DESC
LIMIT 3",Verbose query,neoflix,False,False,False,
List the top 5 movies released in the 1990s.,"MATCH (m:Movie)
WHERE m.release_date >= date('1990-01-01') AND m.release_date <= date('1999-12-31')
RETURN m
ORDER BY m.release_date ASC
LIMIT 5",Verbose query,neoflix,False,False,True,
What are the first 3 movies that have been rated 5 or higher by more than one user?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.rating >= 5
WITH m, count(u) AS userCount
WHERE userCount > 1
RETURN m
LIMIT 3",Verbose query,neoflix,False,False,True,
Name the top 5 users who have given the lowest average ratings to movies.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avg_rating
ORDER BY avg_rating ASC
LIMIT 5
RETURN u.id AS user_id, avg_rating",Verbose query,neoflix,False,False,True,
List the top 5 languages in which the most adult films have been originally made.,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS Language, count(a) AS AdultFilmsCount
ORDER BY AdultFilmsCount DESC
LIMIT 5",Verbose query,neoflix,True,False,False,
Which 3 videos have a homepage URL containing 'youtube'?,"MATCH (v:Video)
WHERE v.homepage CONTAINS 'youtube'
RETURN v
LIMIT 3",Verbose query,neoflix,False,False,True,
List the top 5 movies with the most extensive production crew.,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WITH m, count(r) AS crew_count
ORDER BY crew_count DESC
LIMIT 5
RETURN m.title AS MovieTitle, crew_count AS NumberOfCrewMembers",Verbose query,neoflix,False,False,True,
"What are the first 3 adult films with a budget over 500,000 USD?","MATCH (a:Adult)
WHERE a.budget > 500000
RETURN a
ORDER BY a.release_date
LIMIT 3",Verbose query,neoflix,False,False,True,
List the top 5 highest budget movies in the 'Animation' genre.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
Which 3 videos have the most associated cast members?,"MATCH (v:Video)
WITH v, size((v)<-[:CAST_FOR]-(:Person)) AS cast_count
RETURN v.title, cast_count
ORDER BY cast_count DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
List the top 5 movies with a poster path ending in '.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH '.jpg'
RETURN m
ORDER BY m.id
LIMIT 5",Verbose query,neoflix,False,False,True,
Name the top 5 movies that have been produced in more than 3 countries.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH m, count(c) AS countries_count
WHERE countries_count > 3
RETURN m.title AS MovieTitle
ORDER BY m.popularity DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
Name the top 5 countries where the original language of the movie is Spanish.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language {id: ""es""})
MATCH (m)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
List the first 3 movies in the 'Toy Story Collection'.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m
LIMIT 3",Verbose query,neoflix,False,True,False,
Which 3 movies have Tom Hanks as a cast member and have been released after 1995?,"MATCH (p:Person {name: ""Tom Hanks""})-[:CAST_FOR]->(m:Movie)
WHERE m.release_date > date(""1995-01-01"")
RETURN m
ORDER BY m.release_date
LIMIT 3",Verbose query,neoflix,False,False,True,
Can you list the top 5 adult films with the highest popularity?,"MATCH (a:Adult)
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
What are the first 3 movies that have a revenue greater than 100 million USD and are in the genre 'Action'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Action'})
WHERE m.revenue > 100000000
RETURN m
ORDER BY m.revenue DESC
LIMIT 3",Verbose query,neoflix,False,False,False,
List the top 5 genres that have been accessed by the package named 'Platinum'.,"MATCH (p:Package {name: 'Platinum'})-[:PROVIDES_ACCESS_TO]->(g:Genre)
RETURN g.name AS GenreName, count(g) AS AccessCount
ORDER BY AccessCount DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
Which 3 users have rated the most number of movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN u.id, count(r) AS ratings_count
ORDER BY ratings_count DESC
LIMIT 3",Verbose query,neoflix,False,False,True,
Name the top 5 persons who have played the character 'Woody' in any movie.,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
WHERE r.character = 'Woody'
RETURN p.name, COUNT(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 5",Verbose query,neoflix,False,False,False,
What are the first 3 collections that include movies with a poster path containing '/rhIRbceoE9lR4veEXuwCC2wARtG.jpg'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE m.poster_path = '/rhIRbceoE9lR4veEXuwCC2wARtG.jpg'
RETURN c
LIMIT 3",Verbose query,neoflix,False,False,True,
List the top 5 keywords associated with the video titled 'Jonah: A VeggieTales Movie'.,"MATCH (v:Video {title: 'Jonah: A VeggieTales Movie'})-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name
ORDER BY k.id ASC
LIMIT 5",Verbose query,neoflix,False,False,True,
Which 3 countries have produced the most number of videos?,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS Country, count(v) AS NumberOfVideos
ORDER BY NumberOfVideos DESC
LIMIT 3",Verbose query,neoflix,False,False,True,
List the first 3 languages spoken in the movie titled 'Jumanji'.,"MATCH (m:Movie {title: 'Jumanji'})-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name
LIMIT 3",Verbose query,neoflix,False,False,False,
What are the top 5 production companies that have produced the most number of movies?,"MATCH (pc:ProductionCompany)-[:PRODUCED_BY]->(m:Movie)
RETURN pc.name, count(m) AS NumberOfMovies
ORDER BY NumberOfMovies DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
Can you list the first 3 genres associated with the movie titled 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g
LIMIT 3",Verbose query,neoflix,False,False,True,
Which 3 movies have more than 5000 vote counts?,"MATCH (m:Movie)
WHERE m.vote_count > 5000
RETURN m
ORDER BY m.vote_count DESC
LIMIT 3",Verbose query,neoflix,False,False,True,
Name the top 5 movies that were released after 2010 and have a budget over 100 million USD.,"MATCH (m:Movie)
WHERE m.release_date > date('2010-01-01') AND m.budget > 100000000
RETURN m.title, m.release_date, m.budget
ORDER BY m.release_date ASC
LIMIT 5",Verbose query,neoflix,False,False,True,
What are the first 3 movies directed by a person named 'John Doe'?,"MATCH (p:Person {name: 'John Doe'})-[:CREW_FOR {job: 'Director'}]->(m:Movie)
RETURN m
LIMIT 3",Verbose query,neoflix,False,False,True,
Identify the top 5 most popular videos as per the popularity metric.,"MATCH (v:Video)
RETURN v.title, v.popularity
ORDER BY v.popularity DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
Which 3 movies have a runtime longer than 120 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m
ORDER BY m.runtime DESC
LIMIT 3",Verbose query,neoflix,False,False,True,
List the first 3 movies produced in the United States.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {id: ""US""})
RETURN m
LIMIT 3",Verbose query,neoflix,False,False,True,
What are the top 5 movies with the highest average vote?,"MATCH (m:Movie)
WHERE m.average_vote IS NOT NULL
RETURN m
ORDER BY m.average_vote DESC
LIMIT 5",Verbose query,neoflix,False,True,False,
List the top 5 videos by the number of countries they were produced in.,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH v, count(c) AS countriesProducedIn
ORDER BY countriesProducedIn DESC
LIMIT 5
RETURN v.title, countriesProducedIn",Complex Aggregation Queries,neoflix,False,False,True,
What are the first 3 videos with the highest number of associated languages?,"MATCH (v:Video)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH v, count(l) AS num_languages
ORDER BY num_languages DESC
RETURN v.title, num_languages
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
What are the first 3 movies with the status 'In Production'?,"MATCH (m:Movie)
WHERE m.status = 'In Production'
RETURN m
LIMIT 3",Verbose query,neoflix,False,False,False,
What are the first 3 adult films that have a runtime longer than 90 minutes?,"MATCH (a:Adult)
WHERE a.runtime > 90
RETURN a
ORDER BY a.release_date
LIMIT 3",Verbose query,neoflix,False,True,False,
List the top 5 movies that have been rated 10 by any user.,"MATCH (m:Movie)<-[:RATED {rating: 10}]-(u:User)
RETURN m.title AS MovieTitle, m.id AS MovieID
ORDER BY m.popularity DESC
LIMIT 5",Verbose query,neoflix,False,False,False,
List the first 3 movies that have the keyword 'space' associated with them.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'space'})
RETURN m
LIMIT 3",Verbose query,neoflix,False,False,True,
List the first 3 languages used in movies with an original title 'Toy Story'.,"MATCH (m:Movie {original_title: 'Toy Story'})-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name
LIMIT 3",Verbose query,neoflix,False,False,True,
Which 3 movies have been produced by a company named 'Warner Bros' and have a revenue over 200 million USD?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Warner Bros'})
WHERE m.revenue > 200000000
RETURN m
ORDER BY m.revenue DESC
LIMIT 3",Verbose query,neoflix,False,False,True,
List the top 5 highest-rated movies by users.,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN m.title, avg(r.rating) AS average_rating
ORDER BY average_rating DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
What are the first 3 genres associated with the video titled 'Electrical Girl'?,"MATCH (v:Video {title: 'Electrical Girl'})-[:IN_GENRE]->(g:Genre)
RETURN g
LIMIT 3",Verbose query,neoflix,False,False,True,
Name the top 5 most frequently used keywords in videos.,"MATCH (k:Keyword)<-[:HAS_KEYWORD]-(v:Video)
RETURN k.name AS Keyword, count(v) AS Frequency
ORDER BY Frequency DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
List the first 3 persons who have directed a movie with a budget over 150 million USD.,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = 'Director' AND m.budget > 150000000
RETURN p
LIMIT 3",Verbose query,neoflix,False,False,True,
Which 3 movies have an average vote less than 5 and have been produced in the country with ID 'US'?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {id: 'US'})
WHERE m.average_vote < 5
RETURN m
LIMIT 3",Verbose query,neoflix,False,False,True,
"List the top 5 highest grossing movies that have been released on or after January 1, 2000.","MATCH (m:Movie)
WHERE m.release_date >= date('2000-01-01') AND m.revenue IS NOT NULL
RETURN m.title, m.release_date, m.revenue
ORDER BY m.revenue DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
What are the first 3 videos that have a runtime shorter than 30 minutes?,"MATCH (v:Video)
WHERE v.runtime < 30
RETURN v
ORDER BY v.runtime ASC
LIMIT 3",Verbose query,neoflix,False,False,True,
Name the top 5 languages in which the most movies have been originally made.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS Language, count(m) AS MoviesCount
ORDER BY MoviesCount DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
List the first 3 movies that have been produced by 'Pixar Animation Studios' and have a budget over 50 million USD.,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Pixar Animation Studios'})
WHERE m.budget > 50000000
RETURN m
LIMIT 3",Verbose query,neoflix,False,False,True,
Which 3 adult films have the tagline 'Humiliation. Rape. Murder. You know the drill.'?,"MATCH (a:Adult {tagline: 'Humiliation. Rape. Murder. You know the drill.'})
RETURN a
LIMIT 3",Verbose query,neoflix,False,False,True,
List the top 5 countries that have produced the most movies in the 'Comedy' genre.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Comedy'})
MATCH (m)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS Country, count(m) AS MoviesProduced
ORDER BY MoviesProduced DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
What are the first 3 movies that have a tagline containing the word 'adventure'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'adventure'
RETURN m
LIMIT 3",Verbose query,neoflix,False,False,True,
Name the top 5 most popular movies released before 2000.,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01') AND m.popularity IS NOT NULL
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
List the first 3 videos that have a budget less than 5000 USD.,"MATCH (v:Video)
WHERE v.budget < 5000
RETURN v
LIMIT 3",Verbose query,neoflix,False,False,True,
Which 3 movies have the highest revenue and are part of the 'Toy Story Collection'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3",Verbose query,neoflix,False,False,True,
List the first 5 movies with a budget over 20 million dollars.,"MATCH (m:Movie)
WHERE m.budget > 20000000
RETURN m
ORDER BY m.release_date
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
What are the first 3 production companies that produced videos with zero revenue?,"MATCH (v:Video)-[:PRODUCED_BY]->(pc:ProductionCompany)
WHERE v.revenue = 0
RETURN pc
LIMIT 3",Verbose query,neoflix,False,False,True,
List the top 5 users who have rated videos the most.,"MATCH (u:User)-[r:RATED]->(v:Video)
RETURN u.id, count(r) AS ratings_count
ORDER BY ratings_count DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
Which 3 movies have the lowest average vote and more than 100 vote counts?,"MATCH (m:Movie)
WHERE m.vote_count > 100
RETURN m
ORDER BY m.average_vote ASC
LIMIT 3",Verbose query,neoflix,False,False,True,
Name the top 5 movies with the longest runtime.,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
What are the top 5 languages spoken in the adult films?,"MATCH (a:Adult)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name, count(a) AS num_adult_films
ORDER BY num_adult_films DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
Which 3 genres do the most movies belong to?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3",Verbose query,neoflix,False,False,True,
Show the top 5 most popular adult films based on their popularity score.,"MATCH (a:Adult)
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
Which 3 languages are most common in adult films?,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS Language, count(a) AS NumberOfAdultFilms
ORDER BY NumberOfAdultFilms DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
What are the first 5 countries where most adult films are produced?,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name, count(a) AS num_adult_films
ORDER BY num_adult_films DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
Which movies have Tom Hanks credited as a producer?,"MATCH (p:Person {name: ""Tom Hanks""})-[:CREW_FOR {job: ""Producer""}]->(m:Movie)
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Find all movies that have a runtime of exactly 90 minutes.,"MATCH (m:Movie)
WHERE m.runtime = 90.0
RETURN m",Complex Retrieval Queries,neoflix,False,True,False,
Display the top 5 movies that were most recently released.,"MATCH (m:Movie)
RETURN m
ORDER BY m.release_date DESC
LIMIT 5",Complex Retrieval Queries,neoflix,False,False,True,
Which movies are associated with the keyword 'space'?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'space'})
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
List the top 3 movies with the shortest runtime.,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m
ORDER BY m.runtime ASC
LIMIT 3",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have the most keywords associated with them?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
RETURN m.title, count(k) AS keyword_count
ORDER BY keyword_count DESC",Complex Retrieval Queries,neoflix,False,False,True,
"Display movies that have been rated after January 1, 2015.","MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.timestamp >= date('2015-01-01')
RETURN m.title, m.id, r.rating, r.timestamp",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have a budget less than 10 million but a revenue greater than 100 million?,"MATCH (m:Movie)
WHERE m.budget < 10000000 AND m.revenue > 100000000
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
List all movies that have been rated by user with ID 1.,"MATCH (u:User {id: 1})-[:RATED]->(m:Movie)
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Identify all movies that were produced in a country other than the United States.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE c.name <> ""United States of America""
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have a status of 'Released' and a vote count of over 1000?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.vote_count > 1000
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
List all movies where the overview mentions 'adventure'.,"MATCH (m:Movie)
WHERE m.overview CONTAINS 'adventure'
RETURN m",Complex Retrieval Queries,neoflix,True,False,False,
Display the top 5 movies with the highest budget to revenue ratio.,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL AND m.revenue > 0
RETURN m.title, m.budget, m.revenue, (toFloat(m.budget) / m.revenue) AS budgetToRevenueRatio
ORDER BY budgetToRevenueRatio DESC
LIMIT 5",Complex Retrieval Queries,neoflix,False,False,True,
Which movies are associated with more than one production company?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WITH m, count(pc) AS num_companies
WHERE num_companies > 1
RETURN m.title AS MovieTitle, num_companies AS NumberOfProductionCompanies",Complex Retrieval Queries,neoflix,False,False,True,
Find all movies where Tom Hanks is listed first in the cast.,"MATCH (p:Person {name: ""Tom Hanks""})-[:CAST_FOR {order: 0}]->(m:Movie)
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
List the genres associated with the movie 'Toy Story'.,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name AS GenreName",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have been translated into more than three languages?,"MATCH (m:Movie)
WHERE size{(m)-[:SPOKEN_IN_LANGUAGE]->(:Language)} > 3
RETURN m.title, count{(m)-[:SPOKEN_IN_LANGUAGE]->(:Language)} AS languages_count",Complex Retrieval Queries,neoflix,False,True,False,
Find all movies where the original language is 'en' and have a tagline included.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language {id: 'en'})
WHERE m.tagline IS NOT NULL
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have a homepage listed in their properties?,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
List the top 3 movies with the most revenue that were released before the year 2000.,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01') AND m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 3",Complex Retrieval Queries,neoflix,False,False,True,
Display all movies that were released in the 1990s.,"MATCH (m:Movie)
WHERE m.release_date >= date('1990-01-01') AND m.release_date <= date('1999-12-31')
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have been rated exactly 5.0 by any user?,"MATCH (m:Movie)<-[:RATED {rating: 5.0}]-(u:User)
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
What are the movies directed by a person who has also acted in a movie?,"MATCH (p:Person)-[:CREW_FOR {job: ""Director""}]->(m:Movie)
WHERE exists {
    MATCH (p)-[:CAST_FOR]->(:Movie)
}
RETURN m.title AS MovieDirected, p.name AS Director",Complex Retrieval Queries,neoflix,False,False,True,
List all genres that have been accessed by the 'Ultimate' package.,"MATCH (p:Package {name: 'Ultimate'})-[:PROVIDES_ACCESS_TO]->(g:Genre)
RETURN g",Complex Retrieval Queries,neoflix,False,False,True,
Which movies feature 'Tom Hanks' as a cast member?,"MATCH (p:Person {name: 'Tom Hanks'})-[:CAST_FOR]->(m:Movie)
RETURN m.title AS MovieTitle, m.id AS MovieID",Complex Retrieval Queries,neoflix,False,False,True,
Display the top 3 movies with the least popularity.,"MATCH (m:Movie)
RETURN m
ORDER BY m.popularity ASC
LIMIT 3",Complex Retrieval Queries,neoflix,False,False,True,
Find all movies where the original and spoken languages are different.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(ol:Language),
      (m)-[:SPOKEN_IN_LANGUAGE]->(sl:Language)
WHERE ol.id <> sl.id
RETURN m.title, ol.name AS original_language, sl.name AS spoken_language",Complex Retrieval Queries,neoflix,False,False,True,
What are the languages available for the movie 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'})-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.id, l.name",Simple Aggregation Queries,neoflix,False,False,True,
Which production companies have produced movies with a budget over 50 million?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WHERE m.budget > 50000000
RETURN DISTINCT pc.name",Simple Aggregation Queries,neoflix,False,False,True,
List all the genres associated with the movie 'Toy Story'.,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name AS GenreName",Simple Aggregation Queries,neoflix,False,False,True,
Which movies have 'Tom Hanks' as a cast member?,"MATCH (p:Person {name: 'Tom Hanks'})-[:CAST_FOR]->(m:Movie)
RETURN m",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 5 most popular movies?,"MATCH (m:Movie)
RETURN m
ORDER BY m.popularity DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
Can you find movies that are part of the 'Toy Story Collection'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m",Simple Aggregation Queries,neoflix,False,False,True,
Which movies are associated with the genre 'Animation'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN m",Simple Aggregation Queries,neoflix,False,False,True,
How many movies have a budget greater than 100 million?,"MATCH (m:Movie)
WHERE m.budget > 100000000
RETURN count(m) AS NumberOfMovies",Simple Aggregation Queries,neoflix,False,False,True,
Which movies were released after the year 2000?,"MATCH (m:Movie)
WHERE m.release_date >= date('2001-01-01')
RETURN m",Simple Aggregation Queries,neoflix,False,False,True,
What are the first 3 highest voted movies?,"MATCH (m:Movie)
WHERE m.vote_count IS NOT NULL
RETURN m
ORDER BY m.vote_count DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
List all the languages spoken in the movie 'Jumanji'.,"MATCH (m:Movie {title: 'Jumanji'})-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS SpokenLanguages",Simple Aggregation Queries,neoflix,False,False,True,
Which movies have a runtime longer than 120 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 5 movies by revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
"Which adult movies have a budget greater than 500,000 dollars?","MATCH (a:Adult)
WHERE a.budget > 500000
RETURN a.title, a.budget",Complex Retrieval Queries,neoflix,False,False,True,
List the top 3 adult movies by average vote.,"MATCH (a:Adult)
WHERE a.average_vote IS NOT NULL
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 3",Complex Retrieval Queries,neoflix,False,False,True,
Find all adult movies that have been released.,"MATCH (a:Adult {status: 'Released'})
RETURN a",Complex Retrieval Queries,neoflix,False,False,True,
Display movies that have a revenue of zero.,"MATCH (m:Movie)
WHERE m.revenue = 0
RETURN m",Complex Retrieval Queries,neoflix,True,False,False,
Which movies have the highest number of associated keywords?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
RETURN m.title, count(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 1",Complex Retrieval Queries,neoflix,False,False,False,
List all movies produced in countries where the primary language is not English.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE NOT EXISTS {
    MATCH (c)-[:SPEAKS_LANGUAGE]->(l:Language {name: 'English'})
}
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,SPEAKS_LANGUAGE
Which movies are associated with a collection that has a poster path?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE c.poster_path IS NOT NULL
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Display the top 5 movies with the lowest average vote.,"MATCH (m:Movie)
WHERE m.average_vote IS NOT NULL
RETURN m
ORDER BY m.average_vote ASC
LIMIT 5",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have more than three genres associated with them?,"MATCH (m:Movie)
WHERE size((m)-[:IN_GENRE]->(:Genre)) > 3
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
List all movies that have a backdrop path available.,"MATCH (m:Movie)
WHERE m.backdrop_path IS NOT NULL
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,Movie.backdrop_path
Which movies have a cast member who has also worked in the crew of the same movie?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WHERE exists {
  MATCH (p)-[:CREW_FOR]->(m)
}
RETURN m.title AS MovieTitle, p.name AS PersonName",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have a homepage listed?,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title, m.homepage",Simple Aggregation Queries,neoflix,False,False,True,
List the top 5 movies that have a poster path available.,"MATCH (m:Movie)
WHERE m.poster_path IS NOT NULL
RETURN m
ORDER BY m.id ASC
LIMIT 5",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have a runtime longer than 120 minutes and are categorized under the 'Drama' genre?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Drama'})
WHERE m.runtime > 120
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Which movies are associated with the production company 'Pixar Animation Studios'?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN m",Simple Retrieval Queries,neoflix,False,False,True,
List the first 3 movies that have a poster path ending in '.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH '.jpg'
RETURN m
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Which movies have a homepage URL specified?,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m",Simple Retrieval Queries,neoflix,False,False,True,
Name 3 movies with a release date after 2000.,"MATCH (m:Movie)
WHERE m.release_date > date('2000-01-01')
RETURN m.title
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
What are the top 5 movies with the most votes?,"MATCH (m:Movie)
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
Which movies are part of a collection with a backdrop path containing '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE c.backdrop_path = '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'
RETURN m.title AS MovieTitle, m.id AS MovieID",Simple Retrieval Queries,neoflix,False,False,True,
List the first 3 movies where Tom Hanks acted as a cast member.,"MATCH (p:Person {name: ""Tom Hanks""})-[:CAST_FOR]->(m:Movie)
RETURN m
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Which movies feature the original language as 'en'?,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language {id: 'en'})
RETURN m",Simple Retrieval Queries,neoflix,False,False,True,
Name 3 movies that have been translated into Kiswahili.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Kiswahili'})
RETURN m.title AS MovieTitle
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
What are the top 5 movies with the highest average vote?,"MATCH (m:Movie)
WHERE m.average_vote IS NOT NULL
RETURN m
ORDER BY m.average_vote DESC
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
Which movies have been produced in the United States of America?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: ""United States of America""})
RETURN m",Simple Retrieval Queries,neoflix,False,False,True,
List the first 3 movies with a tagline containing the word 'excitement'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'excitement'
RETURN m
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
What are the latest 3 movies added to the database?,"MATCH (m:Movie)
RETURN m
ORDER BY m.id DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Which movies are categorized under the genre 'Animation'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN m",Simple Retrieval Queries,neoflix,False,False,True,
Name 3 movies that have the keyword 'jealousy'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title AS MovieTitle
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Which movies have been rated by user with ID 1?,"MATCH (u:User {id: 1})-[:RATED]->(m:Movie)
RETURN m",Simple Retrieval Queries,neoflix,False,False,True,
What are the top 5 highest revenue-generating movies?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
List the first 3 movies in the Toy Story Collection.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: ""Toy Story Collection""})
RETURN m
ORDER BY m.release_date
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Which movies have a runtime longer than 100 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 100
RETURN m",Simple Retrieval Queries,neoflix,False,False,True,
Name 3 movies directed by Pixar Animation Studios.,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: ""Pixar Animation Studios""})
RETURN m.title AS MovieTitle
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
What are the top 5 most popular movies according to their popularity score?,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
List the first 3 movies with a budget over 50 million.,"MATCH (m:Movie)
WHERE m.budget > 50000000
RETURN m
ORDER BY m.release_date
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Which movies were released in 1995?,"MATCH (m:Movie)
WHERE m.release_date >= date('1995-01-01') AND m.release_date <= date('1995-12-31')
RETURN m",Simple Retrieval Queries,neoflix,False,False,True,
What are the 3 most recent movies with a status of 'Released'?,"MATCH (m:Movie {status: 'Released'})
RETURN m
ORDER BY m.release_date DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Display movies that have been released in the 'United States of America'.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'United States of America'})
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Name 3 movies that Tom Hanks has a credit in as a crew member.,"MATCH (p:Person {name: ""Tom Hanks""})-[:CREW_FOR]->(m:Movie)
RETURN m.title
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
List the first 3 movies with an average vote less than 5.,"MATCH (m:Movie)
WHERE m.average_vote < 5
RETURN m
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Which movies are released in the 'Animation' genre?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
WHERE m.status = 'Released'
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
What are the top 3 highest voted movies in terms of average vote?,"MATCH (m:Movie)
WHERE m.average_vote IS NOT NULL
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 3",Complex Retrieval Queries,neoflix,False,False,True,
List all movies that have the keyword 'jealousy'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Which movies are part of the Toy Story Collection?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: ""Toy Story Collection""})
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Display the top 5 longest movies by runtime.,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have been rated by more than 5000 users?,"MATCH (m:Movie)
WHERE count{(u:User)-[:RATED]->(m)} > 5000
RETURN m",Complex Retrieval Queries,neoflix,False,False,False,
What are the top 3 most popular movies according to their popularity score?,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3",Complex Retrieval Queries,neoflix,False,False,True,
Find all movies produced by Pixar Animation Studios.,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: ""Pixar Animation Studios""})
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have a budget greater than 50 million dollars?,"MATCH (m:Movie)
WHERE m.budget > 50000000
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
List the top 5 movies by revenue.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 5",Complex Retrieval Queries,neoflix,False,False,True,
Which movies feature music by a person named 'John Williams' as a crew member?,"MATCH (p:Person {name: 'John Williams'})-[:CREW_FOR {job: 'Composer'}]->(m:Movie)
RETURN m.title AS MovieTitle, m.release_date AS ReleaseDate",Simple Retrieval Queries,neoflix,False,False,True,
Name 3 movies with a budget of exactly 30 million.,"MATCH (m:Movie)
WHERE m.budget = 30000000
RETURN m.title
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
What are the top 5 movies with the lowest revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue ASC
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
List the first 3 movies that have a vote count greater than 500.,"MATCH (m:Movie)
WHERE m.vote_count > 500
RETURN m
ORDER BY m.vote_count DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Which movies have a tagline that includes the word 'love'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'love'
RETURN m",Simple Retrieval Queries,neoflix,True,False,False,
Name 3 movies that have been keyword-tagged with 'based on novel'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'based on novel'})
RETURN m.title AS MovieTitle
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
What are the top 5 movies with the shortest runtime?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m
ORDER BY m.runtime ASC
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
Which movies have been produced in more than one country?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH m, count(c) AS num_countries
WHERE num_countries > 1
RETURN m.title AS MovieTitle, num_countries",Simple Retrieval Queries,neoflix,False,False,True,
List the first 3 movies with an IMDb ID starting with 'tt'.,"MATCH (m:Movie)
WHERE m.imdb_id STARTS WITH 'tt'
RETURN m
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Which movies have been rated by at least 100 users?,"MATCH (m:Movie)
WHERE size((:User)-[:RATED]->(m)) >= 100
RETURN m",Simple Retrieval Queries,neoflix,False,False,True,
Name 3 movies spoken in more than one language.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(l) AS num_languages
WHERE num_languages > 1
RETURN m.title AS MovieTitle
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,False,
What are the top 5 movies by budget size?,"MATCH (m:Movie)
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
Which movies have a runtime less than 85 minutes?,"MATCH (m:Movie)
WHERE m.runtime < 85
RETURN m",Simple Retrieval Queries,neoflix,False,False,True,
Which movies have a revenue greater than 300 million?,"MATCH (m:Movie)
WHERE m.revenue > 300000000
RETURN m",Simple Retrieval Queries,neoflix,False,False,True,
List the first 5 movies sorted by popularity in descending order.,"MATCH (m:Movie)
RETURN m
ORDER BY m.popularity DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
What are the original titles of movies that have been translated to Spanish?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Spanish'})
RETURN m.original_title AS OriginalTitle",Simple Aggregation Queries,neoflix,False,False,True,
Who are the top 5 most frequent directors in the movies dataset?,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = 'Director'
RETURN p.name, count(m) AS directed_movies
ORDER BY directed_movies DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
Which 5 movies have Tom Hanks in the cast?,"MATCH (p:Person {name: ""Tom Hanks""})-[:CAST_FOR]->(m:Movie)
RETURN m
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
What are the top 3 movies spoken in Kiswahili?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Kiswahili'})
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Which 3 highest budget movies were released after 2000?,"MATCH (m:Movie)
WHERE m.release_date > date(""2000-01-01"")
RETURN m
ORDER BY m.budget DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
List the top 5 highest voted movies on IMDb.,"MATCH (m:Movie)
WHERE m.vote_count IS NOT NULL
RETURN m.title, m.imdb_id, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
What are the first 5 movies rated by user with ID 1?,"MATCH (u:User {id: 1})-[:RATED]->(m:Movie)
RETURN m
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
Which 3 movies have the keyword 'jealousy'?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title AS MovieTitle
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Find the first 3 movies in the Toy Story Collection.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: ""Toy Story Collection""})
RETURN m
LIMIT 3",Pathfinding Queries,neoflix,False,False,False,
Which 5 movies were produced by Pixar Animation Studios?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: ""Pixar Animation Studios""})
RETURN m
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
List the top 3 movies released in the United States of America.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: ""United States of America""})
WHERE m.status = ""Released""
RETURN m.title, m.release_date, m.revenue
ORDER BY m.release_date DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
What are the top 5 movies with the highest revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,False,
Which adult films have been released with the status 'In Production'?,"MATCH (a:Adult {status: 'In Production'})
RETURN a.title, a.release_date, a.status",Simple Aggregation Queries,neoflix,False,False,False,
What are the top 3 most budget-efficient adult films (highest revenue to budget ratio)?,"MATCH (a:Adult)
WHERE a.budget > 0 AND a.revenue > 0
RETURN a.title, a.revenue, a.budget, (a.revenue / a.budget) AS efficiency
ORDER BY efficiency DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which adult films have a homepage listed?,"MATCH (a:Adult)
WHERE a.homepage IS NOT NULL
RETURN a.title, a.homepage",Simple Aggregation Queries,neoflix,False,False,True,
List the top 5 longest running adult films.,"MATCH (a:Adult)
RETURN a.title, a.runtime
ORDER BY a.runtime DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,False,
What are the first 3 videos that have been rated higher than 8.0?,"MATCH (v:Video)-[r:RATED]->(u:User)
WHERE r.rating > 8.0
RETURN v.title, v.release_date, r.rating
ORDER BY r.rating DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which adult films feature the keyword 'murder'?,"MATCH (a:Adult)-[:HAS_KEYWORD]->(k:Keyword {name: 'murder'})
RETURN a.title AS Title, a.id AS ID",Simple Aggregation Queries,neoflix,False,False,True,
What are the first 5 adult films with the highest average vote?,"MATCH (a:Adult)
WHERE a.average_vote IS NOT NULL
RETURN a
ORDER BY a.average_vote DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 adult films sorted by runtime in descending order.,"MATCH (a:Adult)
WHERE a.runtime IS NOT NULL
RETURN a
ORDER BY a.runtime DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which adult films have been produced by companies not based in the USA?,"MATCH (a:Adult)-[:PRODUCED_BY]->(pc:ProductionCompany)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE c.name <> ""United States of America""
RETURN a.title AS AdultFilmTitle, pc.name AS ProductionCompanyName, c.name AS CountryName",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 5 most popular genres in adult films?,"MATCH (a:Adult)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS Genre, avg(a.popularity) AS AveragePopularity
ORDER BY AveragePopularity DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 videos with no revenue reported.,"MATCH (v:Video)
WHERE v.revenue = 0.0
RETURN v
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which videos have a budget less than 100000?,"MATCH (v:Video)
WHERE v.budget < 100000
RETURN v",Simple Aggregation Queries,neoflix,False,False,True,
What are the first 3 countries with the most movies produced in the genre 'Drama'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Drama'})
MATCH (m)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH c, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3
RETURN c.name AS Country, movies_count",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 movies directed by a person with gender 2.,"MATCH (p:Person {gender: 2})-[:CREW_FOR {job: ""Director""}]->(m:Movie)
RETURN m
LIMIT 3",Pathfinding Queries,neoflix,False,False,False,
Which movies have a tagline containing the word 'excitement'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'excitement'
RETURN m",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 5 movies with a runtime longer than 120 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m
ORDER BY m.runtime DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,False,
Which 3 movies are part of genres with an ID between 15 and 50?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.id >= 15 AND g.id <= 50
RETURN m
LIMIT 3",Pathfinding Queries,neoflix,False,False,False,
List the top 3 genres most frequently associated with videos.,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS Genre, count(v) AS VideoCount
ORDER BY VideoCount DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Which 5 subscriptions are linked to the 'Ultimate' package?,"MATCH (s:Subscription)-[:FOR_PACKAGE]->(p:Package {name: 'Ultimate'})
RETURN s
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
What are the first 3 packages that provide access to the genre 'Animation'?,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre {name: 'Animation'})
RETURN p
LIMIT 3",Pathfinding Queries,neoflix,False,True,False,
List the top 5 adult films with a tagline containing 'murder'.,"MATCH (a:Adult)
WHERE a.tagline CONTAINS 'murder'
RETURN a.title, a.tagline, a.imdb_id
ORDER BY a.popularity DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
Show the first 3 adult films that are spoken in Italian.,"MATCH (a:Adult)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Italian'})
RETURN a
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Which 5 videos have a runtime under 60 minutes?,"MATCH (v:Video)
WHERE v.runtime < 60
RETURN v
ORDER BY v.runtime ASC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
List the first 3 videos with the highest average vote.,"MATCH (v:Video)
WHERE v.average_vote IS NOT NULL
RETURN v
ORDER BY v.average_vote DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Show the top 3 movies that have been reviewed most recently by any user.,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN m.title, m.id, r.timestamp
ORDER BY r.timestamp DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Which 5 movies have the most poster path variations?,"MATCH (m:Movie)
WHERE m.poster_path IS NOT NULL
RETURN m.title, count(m.poster_path) AS posterVariations
ORDER BY posterVariations DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
What are the first 5 movies that have no revenue recorded?,"MATCH (m:Movie)
WHERE m.revenue = 0
RETURN m
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
List the top 3 movies that have a homepage listed.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m
ORDER BY m.popularity DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Show the first 5 movies that were originally titled differently from their English title.,"MATCH (m:Movie)
WHERE m.title <> m.original_title AND m.original_language = 'en'
RETURN m
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
Which 3 movies have the shortest runtime?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m
ORDER BY m.runtime ASC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
What are the top 5 movies with a tagline containing the word 'adventure'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'adventure'
RETURN m
ORDER BY m.average_vote DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
List the top 3 oldest movies in the database.,"MATCH (m:Movie)
WHERE m.release_date IS NOT NULL
RETURN m
ORDER BY m.release_date ASC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Which 5 movies were produced by companies with an ID over 1000?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WHERE pc.id > 1000
RETURN m
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
Find the first 3 movies that feature both English and Spanish languages.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l1:Language {id: 'en'}),
      (m)-[:SPOKEN_IN_LANGUAGE]->(l2:Language {id: 'es'})
RETURN m
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
What are the top 5 movies that premiered in the last quarter of any year?,"MATCH (m:Movie)
WHERE m.release_date.month >= 10 AND m.release_date.month <= 12
RETURN m
ORDER BY m.release_date.year DESC, m.release_date.month DESC, m.release_date.day DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,False,
Which 3 movies have the most diverse cast in terms of gender?,"MATCH (p:Person)-[cf:CAST_FOR]->(m:Movie)
WITH m, count(DISTINCT p.gender) AS genderDiversity
ORDER BY genderDiversity DESC
RETURN m.title, m.id, genderDiversity
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
List the first 5 movies that have been tagged with 'based on novel'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'based on novel'})
RETURN m
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
Show the top 3 movies that were produced in multiple countries.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH m, count(c) AS countries_count
WHERE countries_count > 1
RETURN m
ORDER BY m.popularity DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Which 3 movies have the most keywords associated?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
RETURN m.title, count(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 3",Pathfinding Queries,neoflix,True,False,False,
List the top 5 movies that have been rated over 8.0.,"MATCH (m:Movie)-[r:RATED]->(u:User)
WHERE r.rating > 8.0
RETURN m.title, m.id, r.rating
ORDER BY r.rating DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
Show the first 5 movies that have a popularity score over 15.,"MATCH (m:Movie)
WHERE m.popularity > 15
RETURN m
ORDER BY m.popularity DESC
LIMIT 5",Pathfinding Queries,neoflix,True,False,False,
What are the first 5 movies with the lowest average vote?,"MATCH (m:Movie)
WHERE m.average_vote IS NOT NULL
RETURN m
ORDER BY m.average_vote ASC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 movies sorted by release date in ascending order.,"MATCH (m:Movie)
WHERE m.release_date IS NOT NULL
RETURN m
ORDER BY m.release_date ASC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which movies have been rated by more than 5000 users?,"MATCH (m:Movie)
WHERE size((:User)-[:RATED]->(m)) > 5000
RETURN m",Simple Aggregation Queries,neoflix,False,False,True,
Which adult films have been released after 2010?,"MATCH (a:Adult)
WHERE a.release_date > date(""2010-01-01"") AND a.status = 'Released'
RETURN a.title, a.release_date, a.status",Simple Aggregation Queries,neoflix,False,False,False,
What are the original languages of the top 5 highest rated adult films?,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(lang:Language)
WHERE exists {
    (u:User)-[:RATED]->(a)
}
RETURN lang.name AS Language, avg(r.rating) AS AverageRating
ORDER BY AverageRating DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,False,
List the top 3 most controversial adult films based on their overview.,"MATCH (a:Adult)
WHERE a.overview IS NOT NULL
RETURN a.title, a.overview
ORDER BY a.vote_count DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which adult films have a runtime longer than 90 minutes?,"MATCH (a:Adult)
WHERE a.runtime > 90
RETURN a.title, a.runtime",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 3 countries by the number of adult films produced?,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS Country, count(a) AS NumberOfAdultFilms
ORDER BY NumberOfAdultFilms DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
List all the keywords associated with the video 'Jonah: A VeggieTales Movie'.,"MATCH (v:Video {title: 'Jonah: A VeggieTales Movie'})-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name AS Keyword",Simple Aggregation Queries,neoflix,False,False,True,
Which videos have been produced by 'Pixar Animation Studios'?,"MATCH (v:Video)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN v",Simple Aggregation Queries,neoflix,False,False,False,
What are the top 5 most popular videos?,"MATCH (v:Video)
RETURN v
ORDER BY v.popularity DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
Which videos have a runtime less than 30 minutes?,"MATCH (v:Video)
WHERE v.runtime < 30
RETURN v",Simple Aggregation Queries,neoflix,True,False,False,
List the first 3 genres most commonly found in videos.,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
RETURN g.name, count(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which languages have more than 5 movies spoken in them?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH l, count(m) AS movieCount
WHERE movieCount > 5
RETURN l.name, movieCount",Simple Aggregation Queries,neoflix,False,False,True,
What are the different jobs listed in the crew for the movie 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'})-[:CREW_FOR]->(p:Person)
RETURN DISTINCT p.job AS Jobs",Simple Aggregation Queries,neoflix,False,False,True,Person.job
List the first 5 movies that have been associated with more than one genre.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(g) AS genreCount
WHERE genreCount > 1
RETURN m
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
Which movies have exactly 3 keywords associated with them?,"MATCH (m:Movie)
WHERE size((m)-[:HAS_KEYWORD]->(:Keyword)) = 3
RETURN m",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 5 longest movies by runtime?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
Which movies have the tagline 'Roll the dice and unleash the excitement!'?,"MATCH (m:Movie {tagline: 'Roll the dice and unleash the excitement!'})
RETURN m",Simple Aggregation Queries,neoflix,False,False,True,
What are the first 3 oldest movies in the database?,"MATCH (m:Movie)
WHERE m.release_date IS NOT NULL
RETURN m
ORDER BY m.release_date ASC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
List all movies that have been produced in 'United States of America'.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'United States of America'})
RETURN m",Simple Aggregation Queries,neoflix,False,False,True,
Which movies have been rated by user '1'?,"MATCH (u:User {id: 1})-[:RATED]->(m:Movie)
RETURN m",Simple Aggregation Queries,neoflix,False,False,False,
What are the top 5 movies with the most user ratings?,"MATCH (m:Movie)
WHERE EXISTS { (u:User)-[:RATED]->(m) }
RETURN m.title, count{(u)-[:RATED]->(m)} AS ratingsCount
ORDER BY ratingsCount DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
Which movies feature the keyword 'jealousy'?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 production companies by the number of movies produced.,"MATCH (pc:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
RETURN pc.name, count(m) AS movies_produced
ORDER BY movies_produced DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which countries have produced movies with a revenue exceeding 200 million?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.revenue > 200000000
RETURN DISTINCT c.name",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 production companies that have produced the most adult films.,"MATCH (p:ProductionCompany)-[:PRODUCED_BY]->(a:Adult)
WITH p, count(a) AS adultFilmCount
ORDER BY adultFilmCount DESC
RETURN p.name, adultFilmCount
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which adult films are associated with the genre 'Horror'?,"MATCH (a:Adult)-[:IN_GENRE]->(g:Genre {name: 'Horror'})
RETURN a.title AS Title, a.id AS ID",Simple Aggregation Queries,neoflix,False,True,False,
What are the first 3 most popular adult films based on popularity?,"MATCH (a:Adult)
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which packages provide access to the genre 'Animation'?,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre {name: 'Animation'})
RETURN p",Simple Aggregation Queries,neoflix,False,False,True,
What are the first 3 genres associated with the most popular movies?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.popularity IS NOT NULL
RETURN g.name, m.popularity
ORDER BY m.popularity DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 movies with a revenue of zero.,"MATCH (m:Movie)
WHERE m.revenue = 0
RETURN m
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which movies have a cast member with the profile path ending in 'jpg'?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WHERE p.profile_path ENDS WITH 'jpg'
RETURN m",Simple Aggregation Queries,neoflix,False,False,True,
What are the first 3 movies in the 'Toy Story Collection' based on release date?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m
ORDER BY m.release_date
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which production companies have produced movies that are part of a collection?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WHERE EXISTS { (m)-[:IN_COLLECTION]->(:Collection) }
RETURN DISTINCT pc.name",Simple Aggregation Queries,neoflix,False,False,True,
List the first 5 countries that have produced movies with an average vote above 7.0.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.average_vote > 7.0
RETURN DISTINCT c.name
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
What are the first 3 movies with the highest budget to revenue ratio?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL AND m.revenue > 0
RETURN m.title, m.budget, m.revenue, (toFloat(m.budget) / m.revenue) AS budgetToRevenueRatio
ORDER BY budgetToRevenueRatio DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which movies have the most number of keywords associated with them?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
RETURN m.title, count(k) AS keyword_count
ORDER BY keyword_count DESC",Simple Aggregation Queries,neoflix,False,False,True,
Which movies have been translated into more than three languages?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(l) AS num_languages
WHERE num_languages > 3
RETURN m.title, num_languages",Simple Aggregation Queries,neoflix,False,False,True,
What are the jobs of the first 3 crew members for the movie with the highest budget?,"MATCH (m:Movie)
WITH m ORDER BY m.budget DESC LIMIT 1
MATCH (p:Person)-[r:CREW_FOR]->(m)
RETURN p.name, r.job
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
List the first 5 movies with a poster path ending in '.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH '.jpg'
RETURN m
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
"What are the top 3 countries where the most videos with a budget over $500,000 are produced?","MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE v.budget > 500000
RETURN c.name, count(v) AS num_videos
ORDER BY num_videos DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Which movies have been produced in more than one country?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH m, count(c) AS num_countries
WHERE num_countries > 1
RETURN m.title AS MovieTitle, num_countries",Simple Aggregation Queries,neoflix,False,False,True,
Which countries have produced more than 10 movies in the database?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH c, count(m) AS movie_count
WHERE movie_count > 10
RETURN c.name AS Country, movie_count",Simple Aggregation Queries,neoflix,False,False,True,
Which movies are tagged with 'adventure' and have a popularity above 15?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'adventure'})
WHERE m.popularity > 15
RETURN m",Simple Aggregation Queries,neoflix,False,False,True,
What are the original languages for the top 5 movies based on average vote?,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN m.title, l.name AS original_language
ORDER BY m.average_vote DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
List all the movies that have a status of 'In Production'.,"MATCH (m:Movie)
WHERE m.status = 'In Production'
RETURN m",Simple Aggregation Queries,neoflix,False,False,True,
Which movies have a revenue greater than their budget?,"MATCH (m:Movie)
WHERE m.revenue > m.budget
RETURN m.title, m.revenue, m.budget",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 3 movies by vote count that were released in the 1990s?,"MATCH (m:Movie)
WHERE m.release_date >= date('1990-01-01') AND m.release_date <= date('1999-12-31')
RETURN m
ORDER BY m.vote_count DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which movies have Tom Hanks listed both in cast and crew?,"MATCH (p:Person {name: ""Tom Hanks""})
MATCH (m:Movie)<-[:CAST_FOR]-(p)
WHERE exists {
  MATCH (p)-[:CREW_FOR]->(m)
}
RETURN m",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 3 videos rated by users?,"MATCH (u:User)-[r:RATED]->(v:Video)
RETURN v.title, AVG(r.rating) AS average_rating
ORDER BY average_rating DESC
LIMIT 3",Simple Aggregation Queries,neoflix,True,False,False,
Which genres are accessible through the 'Ultimate' package?,"MATCH (p:Package {name: 'Ultimate'})-[:PROVIDES_ACCESS_TO]->(g:Genre)
RETURN g.name AS GenreName",Simple Aggregation Queries,neoflix,False,False,False,
What are the prices of the packages named 'Gold' and 'Platinum'?,"MATCH (p:Package)
WHERE p.name IN ['Gold', 'Platinum']
RETURN p.name AS PackageName, p.price AS Price",Simple Aggregation Queries,neoflix,False,False,True,
List the first 5 subscriptions that expire in 2020.,"MATCH (s:Subscription)
WHERE s.expiresAt.year = 2020
RETURN s
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
What are the first 5 production companies by the number of genres they produce movies in?,"MATCH (pc:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH pc, count(DISTINCT g) AS genres_count
RETURN pc.name, genres_count
ORDER BY genres_count DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
List the top 5 movies with the longest taglines.,"MATCH (m:Movie)
WHERE m.tagline IS NOT NULL
RETURN m.title, m.tagline
ORDER BY length(m.tagline) DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Can you list the top 5 movies that are part of more than one collection?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WITH m, count(c) AS num_collections
WHERE num_collections > 1
RETURN m.title AS MovieTitle, num_collections
ORDER BY num_collections DESC
LIMIT 5",Verbose query,neoflix,False,False,True,
Who are the first 3 directors of movies with a budget less than $5 million?,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE m.budget < 5000000 AND r.job = 'Director'
RETURN p.name
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
List the movies that have a revenue greater than their budget.,"MATCH (m:Movie)
WHERE m.revenue > m.budget
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have been spoken in 'Kiswahili'?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Kiswahili'})
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
What are the movies where 'Brad Pitt' has acted?,"MATCH (p:Person {name: 'Brad Pitt'})-[:CAST_FOR]->(m:Movie)
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have an overview that includes the word 'adventure'?,"MATCH (m:Movie)
WHERE m.overview CONTAINS 'adventure'
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Which 3 production companies have produced the most films with a release date before 1980?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WHERE m.release_date < date('1980-01-01')
WITH pc, count(m) AS movies_produced
ORDER BY movies_produced DESC
LIMIT 3
RETURN pc.name, movies_produced",Complex Aggregation Queries,neoflix,False,False,True,
What are the movies with a vote count less than 50?,"MATCH (m:Movie)
WHERE m.vote_count < 50
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
List the movies where the original language is not English.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
WHERE l.id <> 'en'
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have a popularity score above 15?,"MATCH (m:Movie)
WHERE m.popularity > 15
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
What are the top 5 movies with the smallest budget?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL
RETURN m
ORDER BY m.budget ASC
LIMIT 5",Complex Retrieval Queries,neoflix,False,False,True,
List all movies that have a runtime greater than 150 minutes.,"MATCH (m:Movie)
WHERE m.runtime > 150
RETURN m",Complex Retrieval Queries,neoflix,False,False,False,
Which movies have been tagged with the keyword 'romance'?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'romance'})
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
What are the movies that have been produced in 'China'?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE c.name = 'China'
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
List the movies with a revenue exceeding 100 million USD and a popularity below 10.,"MATCH (m:Movie)
WHERE m.revenue > 100000000 AND m.popularity < 10
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have a status of 'Released' and an average vote less than 4?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.average_vote < 4
RETURN m",Complex Retrieval Queries,neoflix,False,False,False,
List the movies that have been rated 10 by any user.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE r.rating = 10
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
What are the movies with a revenue exactly 76578911.0 USD?,"MATCH (m:Movie)
WHERE m.revenue = 76578911.0
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
List the movies that have an average vote of 7.1.,"MATCH (m:Movie)
WHERE m.average_vote = 7.1
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have a tagline that includes 'surprise'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'surprise'
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
What are the movies directed by a female from the 'Production' department?,"MATCH (p:Person)-[cf:CREW_FOR]->(m:Movie)
WHERE p.gender = 2 AND cf.department = 'Production' AND cf.job = 'Director'
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
List all directors for the movie with an ID of 862.,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie {id: 862})
WHERE r.job = 'Director'
RETURN p.name AS DirectorName",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have a runtime less than 80 minutes and a budget over 20 million USD?,"MATCH (m:Movie)
WHERE m.runtime < 80 AND m.budget > 20000000
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
What are the top 3 movies by average vote in the database?,"MATCH (m:Movie)
RETURN m
ORDER BY m.average_vote DESC
LIMIT 3",Complex Retrieval Queries,neoflix,False,False,True,
List the movies that have a release date in January 1995.,"MATCH (m:Movie)
WHERE m.release_date >= date('1995-01-01') AND m.release_date <= date('1995-01-31')
RETURN m",Complex Retrieval Queries,neoflix,False,True,False,
Which movies have been involved in a collection with a backdrop path containing '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE c.backdrop_path = '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have a poster path containing '/eoWvKD60lT95Ss1MYNgVExpo5iU.jpg'?,"MATCH (m:Movie)
WHERE m.poster_path = '/eoWvKD60lT95Ss1MYNgVExpo5iU.jpg'
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
List all movies that have an average_vote less than 3.,"MATCH (m:Movie)
WHERE m.average_vote < 3
RETURN m",Complex Retrieval Queries,neoflix,False,False,False,
Which movies have been produced by 'Warner Bros.' and have a revenue over 500 million USD?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Warner Bros.'})
WHERE m.revenue > 500000000
RETURN m",Complex Retrieval Queries,neoflix,False,False,False,
Which movies have been most frequently rated by users?,"MATCH (m:Movie)
RETURN m.title AS MovieTitle, count{(u:User)-[:RATED]->(m)} AS RatingsCount
ORDER BY RatingsCount DESC",Complex Retrieval Queries,neoflix,False,False,True,
List the top 3 highest-grossing movies of 1995.,"MATCH (m:Movie)
WHERE m.release_date >= date('1995-01-01') AND m.release_date <= date('1995-12-31')
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3",Complex Retrieval Queries,neoflix,False,False,True,
What are the movies with a vote count greater than 5000?,"MATCH (m:Movie)
WHERE m.vote_count > 5000
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Which movies are associated with the keyword 'family' and have a release date in the last 5 years?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'family'})
WHERE m.release_date >= date({year: date().year - 5, month: date().month, day: date().day})
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
List the production companies that have produced movies with an original language of Spanish.,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WHERE exists {
  (m)-[:ORIGINAL_LANGUAGE]->(:Language {name: 'Spanish'})
}
RETURN DISTINCT pc.name",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have a popularity less than 5 and more than 2?,"MATCH (m:Movie)
WHERE m.popularity < 5 AND m.popularity > 2
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
List the movies where the spoken language is 'Gaeilge'.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Gaeilge'})
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have a backdrop path of '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE c.backdrop_path = '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'
RETURN m",Complex Retrieval Queries,neoflix,False,False,False,
What are the three oldest movies in the database?,"MATCH (m:Movie)
RETURN m
ORDER BY m.release_date ASC
LIMIT 3",Complex Retrieval Queries,neoflix,False,False,False,
List movies that are part of a genre with ID 10770.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {id: 10770})
RETURN m",Complex Retrieval Queries,neoflix,False,True,False,
Which movies have a status of 'Released' and a budget greater than 25 million USD?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.budget > 25000000
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
List all movies that have an average vote of exactly 7.7.,"MATCH (m:Movie)
WHERE m.average_vote = 7.7
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
What are the movies with a poster path that ends with 'T4B.jpg'?,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH 'T4B.jpg'
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have been produced by companies based in 'France'?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)-[:LOCATED_IN]->(c:Country {name: 'France'})
RETURN m.title AS MovieTitle, pc.name AS ProductionCompanyName",Complex Retrieval Queries,neoflix,False,False,False,LOCATED_IN
List the movies that have been rated exactly 5.0.,"MATCH (m:Movie)<-[:RATED {rating: 5.0}]-(u:User)
RETURN m",Complex Retrieval Queries,neoflix,False,False,False,
What are the movies directed by 'Christopher Nolan'?,"MATCH (p:Person {name: 'Christopher Nolan'})-[:CREW_FOR {job: 'Director'}]->(m:Movie)
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have a runtime longer than the average runtime of all movies?,"MATCH (m:Movie)
WITH avg(m.runtime) AS avgRuntime
MATCH (movie:Movie)
WHERE movie.runtime > avgRuntime
RETURN movie",Complex Retrieval Queries,neoflix,False,False,True,
List the movies that have been produced in more than three countries.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH m, count(c) AS countries_count
WHERE countries_count > 3
RETURN m.title AS MovieTitle, countries_count",Complex Retrieval Queries,neoflix,False,False,False,
Which movies have a budget less than 1 million USD and have won an award?,"MATCH (m:Movie)
WHERE m.budget < 1000000 AND exists{
  MATCH (m)-[:WON]->(:Award)
}
RETURN m.title, m.budget",Complex Retrieval Queries,neoflix,False,False,True,Award
Which movies have a budget less than 1 million USD and have won an award?,"MATCH (m:Movie)
WHERE m.budget < 1000000 AND exists{
  MATCH (m)-[:WON]->(:Award)
}
RETURN m.title, m.budget",Complex Retrieval Queries,neoflix,False,False,True,WON
List all movies that have a revenue of zero but have been highly rated.,"MATCH (m:Movie)-[r:RATED]->(u:User)
WHERE m.revenue = 0 AND r.rating >= 8
RETURN m.title, m.id, r.rating, u.id",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have been associated with the keyword 'high school' and have an average vote above 6?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'high school'})
WHERE m.average_vote > 6
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
What are the top 5 longest movies in the database?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5",Complex Retrieval Queries,neoflix,False,False,True,
List all movies where the spoken language includes both English and Spanish.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l1:Language {name: 'English'})
MATCH (m)-[:SPOKEN_IN_LANGUAGE]->(l2:Language {name: 'Spanish'})
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
What are the three most recent movies that have a tagline?,"MATCH (m:Movie)
WHERE m.tagline IS NOT NULL
RETURN m
ORDER BY m.release_date DESC
LIMIT 3",Complex Retrieval Queries,neoflix,False,False,True,
List the movies that have a budget of zero.,"MATCH (m:Movie)
WHERE m.budget = 0
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
List all movies that have a budget greater than 100 million USD and were released after 2000.,"MATCH (m:Movie)
WHERE m.budget > 100000000 AND m.release_date > date('2000-01-01')
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
What are the movies with a runtime exactly equal to the runtime of 'Toy Story'?,"MATCH (m1:Movie {title: 'Toy Story'})
MATCH (m2:Movie)
WHERE m1.runtime = m2.runtime AND m1 <> m2
RETURN m2",Complex Retrieval Queries,neoflix,False,False,True,
List the top 5 adult films by average vote.,"MATCH (a:Adult)
WHERE a.average_vote IS NOT NULL
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 adult films have the highest budget?,"MATCH (a:Adult)
RETURN a.title, a.budget
ORDER BY a.budget DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,False,
What are the top 5 countries where adult films have been produced?,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS Country, count(a) AS NumberOfAdultFilms
ORDER BY NumberOfAdultFilms DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 users who rated the adult film titled 'Standoff'.,"MATCH (u:User)-[r:RATED]->(a:Adult {title: 'Standoff'})
RETURN u
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 genres are most common in adult films?,"MATCH (a:Adult)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS Genre, count(a) AS NumberOfAdultFilms
ORDER BY NumberOfAdultFilms DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 5 keywords found in videos?,"MATCH (v:Video)-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name, count(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,False,
List the first 3 video titles that have been produced by 'Pixar Animation Studios'.,"MATCH (v:Video)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN v.title
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 videos have the highest popularity score?,"MATCH (v:Video)
RETURN v.title, v.popularity
ORDER BY v.popularity DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
What are the 3 longest videos in terms of runtime?,"MATCH (v:Video)
RETURN v.title, v.runtime
ORDER BY v.runtime DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
List the top 5 genres associated with the highest-grossing videos.,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS Genre, sum(v.revenue) AS TotalRevenue
ORDER BY TotalRevenue DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 collections include videos with an average vote above 7?,"MATCH (v:Video)-[:IN_COLLECTION]->(c:Collection)
WHERE v.average_vote > 7
RETURN c
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 5 languages in which the most adult films are originally made?,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS Language, count(a) AS NumberOfAdultFilms
ORDER BY NumberOfAdultFilms DESC
LIMIT 5",Simple Aggregation Queries,neoflix,True,False,False,
List the first 3 packages that offer access to the 'Animation' genre.,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre {name: 'Animation'})
RETURN p
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 subscriptions will expire the soonest?,"MATCH (s:Subscription)
RETURN s
ORDER BY s.expiresAt ASC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 5 most expensive packages by price?,"MATCH (p:Package)
RETURN p
ORDER BY p.price DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 genres that are accessed by the 'Ultimate' package.,"MATCH (p:Package {name: 'Ultimate'})-[:PROVIDES_ACCESS_TO]->(g:Genre)
RETURN g
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
"Which 3 production companies are associated with the most number of genres across movies, videos, and adult films?","MATCH (pc:ProductionCompany)-[:PRODUCED_BY]-(m)
WITH pc, count(DISTINCT (m)-[:IN_GENRE]->(:Genre)) AS genreCount
RETURN pc.name, genreCount
ORDER BY genreCount DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 5 countries by the number of genres produced there?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH c, count(DISTINCT g) AS genres_count
ORDER BY genres_count DESC
RETURN c.name AS country, genres_count
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 movies that have no revenue reported.,"MATCH (m:Movie)
WHERE m.revenue = 0
RETURN m
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 videos have a poster path ending with 'jpg'?,"MATCH (v:Video)
WHERE v.poster_path ENDS WITH 'jpg'
RETURN v
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 5 movies with the most extended release dates range within a collection?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WITH c, max(m.release_date) AS maxDate, min(m.release_date) AS minDate
ORDER BY maxDate - minDate DESC
LIMIT 5
RETURN c.name AS CollectionName, minDate, maxDate, maxDate - minDate AS DateRange",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 adult films with a tagline containing the word 'sex'.,"MATCH (a:Adult)
WHERE a.tagline CONTAINS 'sex'
RETURN a
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 genres have the least movies associated with them?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WITH g, count(m) AS movieCount
ORDER BY movieCount ASC
LIMIT 3
RETURN g.name AS Genre, movieCount",Simple Aggregation Queries,neoflix,False,False,True,
What are the first 3 collections that contain more than 5 movies?,"MATCH (c:Collection)<-[:IN_COLLECTION]-(m:Movie)
WITH c, count(m) AS movieCount
WHERE movieCount > 5
RETURN c
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,False,
Which movies have an IMDb ID that starts with 'tt00'?,"MATCH (m:Movie)
WHERE m.imdb_id STARTS WITH 'tt00'
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Which 3 languages are most frequently spoken in videos?,"MATCH (v:Video)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name, count(v) AS num_videos
ORDER BY num_videos DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 genres are most frequently found in movies with a revenue greater than $100 million?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.revenue > 100000000
RETURN g.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
List the movies that have been tagged with the keyword 'explosive'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'explosive'})
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have a release date on a leap year?,"MATCH (m:Movie)
WHERE m.release_date.year % 4 = 0 AND (m.release_date.year % 100 <> 0 OR m.release_date.year % 400 = 0)
RETURN m.title, m.release_date",Complex Retrieval Queries,neoflix,False,False,True,
List the movies that have a backdrop path of '/iWahPsY3hsKOizZHgzQcAxv4O3B.jpg'.,"MATCH (m:Movie)
WHERE m.backdrop_path = '/iWahPsY3hsKOizZHgzQcAxv4O3B.jpg'
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,Movie.backdrop_path
What are the three highest budget movies produced by 'Disney'?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Disney'})
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3",Complex Retrieval Queries,neoflix,False,False,True,
What are the top 5 movies by revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
List 3 movies that have a runtime greater than 120 minutes.,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which 5 movies were released after 2010 and have a vote count over 1000?,"MATCH (m:Movie)
WHERE m.release_date > date('2010-01-01') AND m.vote_count > 1000
RETURN m
ORDER BY m.release_date
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
Find 3 movies that have 'Toy Story' in their title.,"MATCH (m:Movie)
WHERE m.title CONTAINS 'Toy Story'
RETURN m
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 5 highest budget movies?,"MATCH (m:Movie)
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 languages that have been used as original languages in more than 10 movies.,"MATCH (l:Language)<-[:ORIGINAL_LANGUAGE]-(m:Movie)
WITH l, count(m) AS movieCount
WHERE movieCount > 10
RETURN l.id, l.name
ORDER BY movieCount DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 countries have produced more than 50 movies?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH c, count(m) AS movie_count
WHERE movie_count > 50
RETURN c.name AS country, movie_count
ORDER BY movie_count DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,True,False,
What are the top 5 genres by the number of movies associated with them?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS Genre, count(m) AS NumberOfMovies
ORDER BY NumberOfMovies DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 production companies have produced the most movies with a budget over $50 million?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WHERE m.budget > 50000000
WITH pc, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3
RETURN pc.name, movies_count",Simple Aggregation Queries,neoflix,False,False,True,
List the 3 most recent movies in the 'Toy Story Collection'.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m
ORDER BY m.release_date DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Who are the top 5 actors by the number of movies they have appeared in?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
RETURN p.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
What are the first 3 keywords associated with the movie 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'})-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 users have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN u.id, count(r) AS ratings_count
ORDER BY ratings_count DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
List the top 5 most popular movies according to their popularity score.,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,False,
What are the 3 longest movies in terms of runtime?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 movies have the highest average vote and more than 1000 votes?,"MATCH (m:Movie)
WHERE m.vote_count > 1000
RETURN m
ORDER BY m.average_vote DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 movies that have a poster path starting with '/r'.,"MATCH (m:Movie)
WHERE m.poster_path STARTS WITH '/r'
RETURN m
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which 5 movies have been tagged with the keyword 'jealousy'?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title AS MovieTitle
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
What are the 3 latest movies rated by user with id 1?,"MATCH (u:User {id: 1})-[:RATED]->(m:Movie)
RETURN m
ORDER BY m.release_date DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
List the top 5 production companies by the number of videos they have produced.,"MATCH (pc:ProductionCompany)-[:PRODUCED_BY]->(v:Video)
RETURN pc.name, count(v) AS NumberOfVideos
ORDER BY NumberOfVideos DESC
LIMIT 5",Simple Aggregation Queries,neoflix,True,False,False,
Find all actors who have appeared in more than 10 movies.,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
WITH p, count(m) AS movieCount
WHERE movieCount > 10
RETURN p, movieCount",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have a runtime that is exactly 90 minutes?,"MATCH (m:Movie)
WHERE m.runtime = 90.0
RETURN m",Complex Retrieval Queries,neoflix,False,True,False,
Which movies have been released with a status of 'In Production'?,"MATCH (m:Movie)
WHERE m.status = 'In Production'
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Which 3 keywords are most commonly associated with movies that have a budget less than 1 million dollars?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.budget < 1000000
RETURN k.name, count(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
List the top 5 movies that have been rated by users more than 1000 times.,"MATCH (m:Movie)
WHERE m.vote_count > 1000
RETURN m
ORDER BY m.vote_count DESC
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
What are the first 3 production companies that have produced movies in more than one language?,"MATCH (pc:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
WITH pc, count(DISTINCT (m)-[:SPOKEN_IN_LANGUAGE]->(:Language)) AS num_languages
WHERE num_languages > 1
RETURN pc
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Which 3 movies have the longest runtime and were released after 2000?,"MATCH (m:Movie)
WHERE m.release_date > date('2000-01-01') AND m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
List the top 5 highest rated movies by users.,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN m.title, AVG(r.rating) AS average_rating
ORDER BY average_rating DESC
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
Name the first 5 genres associated with the movie 'Toy Story'.,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
What are the 3 most popular movies in the genre 'Animation'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Which 3 production companies have produced films with a budget over 100 million dollars?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WHERE m.budget > 100000000
RETURN pc.name, count(m) AS NumberOfMovies
ORDER BY NumberOfMovies DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
List the first 5 movies that were produced in the country 'United States of America' and have a revenue over 50 million dollars.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'United States of America'})
WHERE m.revenue > 50000000
RETURN m
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
"What are the top 3 languages spoken in the videos with a budget greater than 500,000 dollars?","MATCH (v:Video)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE v.budget > 500000
RETURN l.name, count(v) AS num_videos
ORDER BY num_videos DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Name the first 3 movies that were produced by 'Pixar Animation Studios' and have a budget above 50 million dollars.,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Pixar Animation Studios'})
WHERE m.budget > 50000000
RETURN m.title
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Which 3 keywords are most common in movies with an average vote below 5?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.average_vote < 5
RETURN k.name, count(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
List the top 5 movies that have a runtime longer than 150 minutes and were released before 2010.,"MATCH (m:Movie)
WHERE m.runtime > 150 AND m.release_date < date('2010-01-01')
RETURN m
ORDER BY m.release_date DESC
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
What are the first 3 genres associated with the movie 'Father of the Bride Part II'?,"MATCH (m:Movie {title: 'Father of the Bride Part II'})-[:IN_GENRE]->(g:Genre)
RETURN g
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Which 3 movies have the highest popularity and were released in the last 5 years?,"MATCH (m:Movie)
WHERE m.release_date >= date({year: date().year - 5, month: date().month, day: date().day}) AND m.popularity IS NOT NULL
RETURN m
ORDER BY m.popularity DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
List the top 5 adult films with the most keywords associated.,"MATCH (a:Adult)-[:HAS_KEYWORD]->(k:Keyword)
WITH a, count(k) AS num_keywords
ORDER BY num_keywords DESC
LIMIT 5
RETURN a.title, num_keywords",Simple Retrieval Queries,neoflix,False,False,True,
Name the first 5 movies that have a homepage URL associated.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,False,
What are the 3 most popular movies in the genre 'Comedy'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Comedy'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Which 3 production companies have produced the most movies in the genre 'Drama'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Drama'})
MATCH (m)-[:PRODUCED_BY]->(pc:ProductionCompany)
WITH pc, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3
RETURN pc.name, movies_count",Simple Retrieval Queries,neoflix,False,False,True,
List the first 5 movies that have a tagline and were released after 2010.,"MATCH (m:Movie)
WHERE m.tagline IS NOT NULL AND m.release_date > date('2010-01-01')
RETURN m
ORDER BY m.release_date
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
What are the top 3 languages spoken in movies that have a status of 'Released'?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.status = 'Released'
RETURN l.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Name the first 3 adult films that were produced in the country 'Italy'.,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country {id: ""IT""})
RETURN a.title AS Title
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Which 3 keywords are most commonly associated with videos that have a budget over 1 million dollars?,"MATCH (v:Video)-[:HAS_KEYWORD]->(k:Keyword)
WHERE v.budget > 1000000
RETURN k.name, count(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Name the first 3 adult films with the highest average vote.,"MATCH (a:Adult)
WHERE a.average_vote IS NOT NULL
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
List the top 5 highest revenue generating movies of all time.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
What are the top 3 languages for movies produced by 'Pixar Animation Studios'?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Pixar Animation Studios'})
MATCH (m)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Which 3 movies have the highest revenue and were released in the 'United States of America'?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'United States of America'})
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Find the top 5 genres by the number of movies associated.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS Genre, count(m) AS NumberOfMovies
ORDER BY NumberOfMovies DESC
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
What are the names of the top 3 most popular movies released before 2000?,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01') AND m.popularity IS NOT NULL
RETURN m.title AS MovieTitle, m.popularity AS Popularity
ORDER BY m.popularity DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Who are the first 3 actors cast in the movie 'Toy Story'?,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie {title: 'Toy Story'})
RETURN p.name, r.character
ORDER BY r.order
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
What are the first 5 production companies producing films in the 'Animation' genre?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
MATCH (m)-[:PRODUCED_BY]->(pc:ProductionCompany)
RETURN DISTINCT pc
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
List the first 3 countries where movies with a revenue greater than 100 million dollars were produced.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.revenue > 100000000
RETURN DISTINCT c.name
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Which 3 languages are most common among movies with a popularity score above 10?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.popularity > 10
RETURN l.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,True,False,
What are the top 5 keywords associated with the movie 'Waiting to Exhale'?,"MATCH (m:Movie {title: 'Waiting to Exhale'})-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name
ORDER BY k.id
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
Which 3 collections contain the most movies with a budget over 50 million dollars?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE m.budget > 50000000
WITH c, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3
RETURN c.name, movies_count",Simple Retrieval Queries,neoflix,False,False,True,
Name the top 3 directors who have worked on movies with an average vote greater than 7.5.,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = 'Director' AND m.average_vote > 7.5
RETURN p.name, count(m) AS movies_directed
ORDER BY movies_directed DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
List the 5 most recent movies that have been added to the 'Toy Story Collection'.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m
ORDER BY m.release_date DESC
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
What are the top 3 highest-grossing movies directed by a person named 'Tom Hanks'?,"MATCH (p:Person {name: 'Tom Hanks'})-[:CREW_FOR {job: 'Director'}]->(m:Movie)
RETURN m.title AS MovieTitle, m.revenue AS Revenue
ORDER BY m.revenue DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Which 3 users have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN u.id, count(r) AS ratings_count
ORDER BY ratings_count DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
List the top 5 movies that have been tagged with the keyword 'jealousy'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title AS MovieTitle, m.id AS MovieID
ORDER BY m.popularity DESC
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
What are the first 3 genres associated with the movie 'Jonah: A VeggieTales Movie'?,"MATCH (m:Movie {title: 'Jonah: A VeggieTales Movie'})-[:IN_GENRE]->(g:Genre)
RETURN g
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Name the top 5 movies with the most keywords associated.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WITH m, count(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 5
RETURN m.title AS MovieTitle, keyword_count",Simple Retrieval Queries,neoflix,False,False,True,
Which 3 countries have produced the most movies with a runtime longer than 120 minutes?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.runtime > 120
RETURN c.name, count(m) AS NumberOfMovies
ORDER BY NumberOfMovies DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Find the first 5 movies with a tagline containing the word 'love'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'love'
RETURN m
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
List the top 3 languages spoken in the highest-grossing movies.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.revenue IS NOT NULL
RETURN l.id, l.name, sum(m.revenue) as total_revenue
ORDER BY total_revenue DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
What are the first 5 actors who have starred in both a movie and an adult film?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie), (p)-[:CAST_FOR]->(a:Adult)
WITH p, count(DISTINCT m) AS moviesCount, count(DISTINCT a) AS adultCount
WHERE moviesCount > 0 AND adultCount > 0
RETURN p.name
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
Which 3 production companies have the highest total revenues from their movies?,"MATCH (pc:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
WHERE m.revenue IS NOT NULL
RETURN pc.name, sum(m.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
List the top 3 most popular videos with a runtime under 90 minutes.,"MATCH (v:Video)
WHERE v.runtime < 90
RETURN v
ORDER BY v.popularity DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Name the first 5 movies that have a poster path ending in '.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH '.jpg'
RETURN m.title
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
What are the top 3 genres in which 'Pixar Animation Studios' has produced movies?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Pixar Animation Studios'})
MATCH (m)-[:IN_GENRE]->(g:Genre)
RETURN g.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
List the first 5 movies that are part of a collection and have a revenue greater than 100 million dollars.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE m.revenue > 100000000
RETURN m.title, m.revenue, c.name
ORDER BY m.revenue DESC
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
What are the first 3 genres associated with the video 'Jonah: A VeggieTales Movie'?,"MATCH (v:Video {title: 'Jonah: A VeggieTales Movie'})-[:IN_GENRE]->(g:Genre)
RETURN g
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Which 3 movies have the lowest average vote and were released before 2000?,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01') AND m.average_vote IS NOT NULL
RETURN m
ORDER BY m.average_vote ASC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
List the top 5 movies with the longest runtime.,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m
ORDER BY m.runtime DESC
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,False,
What are the most recent three movies added to the database?,"MATCH (m:Movie)
RETURN m
ORDER BY m.release_date DESC
LIMIT 3",Complex Retrieval Queries,neoflix,False,False,True,
List the movies that have a runtime longer than 120 minutes.,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have been tagged with the keyword 'jealousy'?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Find all movies released before 2000 with an average vote greater than 8.,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01') AND m.average_vote > 8
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
List all languages spoken in the movie 'Toy Story'.,"MATCH (m:Movie {title: 'Toy Story'})-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS LanguageSpoken",Complex Retrieval Queries,neoflix,False,False,True,
What are the original titles of movies that have been translated into Spanish?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Spanish'})
RETURN m.original_title AS OriginalTitle",Complex Retrieval Queries,neoflix,False,False,True,
Which countries have produced movies with a budget exceeding 10 million USD?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.budget > 10000000
RETURN DISTINCT c.name",Complex Retrieval Queries,neoflix,False,False,True,
List the names of all production companies involved with movies that grossed over 200 million USD.,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WHERE m.revenue > 200000000
RETURN DISTINCT pc.name",Complex Retrieval Queries,neoflix,False,False,False,
Which genres are associated with movies directed by 'Steven Spielberg'?,"MATCH (p:Person {name: 'Steven Spielberg'})-[:CREW_FOR {job: 'Director'}]->(m:Movie)
MATCH (m)-[:IN_GENRE]->(g:Genre)
RETURN DISTINCT g.name AS Genre",Complex Retrieval Queries,neoflix,False,False,True,
List all the movies where the character 'Woody' appears.,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
WHERE r.character = 'Woody'
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
What are the top 3 most voted movies in the database?,"MATCH (m:Movie)
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 3",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have a poster path containing '/rhIRbceoE9lR4veEXuwCC2wARtG.jpg'?,"MATCH (m:Movie)
WHERE m.poster_path = '/rhIRbceoE9lR4veEXuwCC2wARtG.jpg'
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
What are the names of people who have directed movies with a budget over 50 million USD?,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = 'Director' AND m.budget > 50000000
RETURN DISTINCT p.name",Complex Retrieval Queries,neoflix,False,False,True,
List the movies that have won awards and have an original language of Italian.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language {id: ""it""})
WHERE exists{(m)-[:WON_AWARD]->()}
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,WON_AWARD
Which movies feature a runtime less than 85 minutes and have been released after 2010?,"MATCH (m:Movie)
WHERE m.runtime < 85 AND m.release_date > date('2010-01-01')
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
What are the movies in which 'Pixar Animation Studios' served as a production company and have a popularity score above 20?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Pixar Animation Studios'})
WHERE m.popularity > 20
RETURN m",Complex Retrieval Queries,neoflix,False,False,False,
List all movies that are part of any collection and have a revenue less than 1 million USD.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE m.revenue < 1000000
RETURN m.title, m.revenue, c.name",Complex Retrieval Queries,neoflix,False,False,True,
What are the names of all genres represented in the 'Toy Story Collection'?,"MATCH (c:Collection {name: 'Toy Story Collection'})<-[:IN_COLLECTION]-(m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN DISTINCT g.name",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have an IMDb ID of 'tt0114709'?,"MATCH (m:Movie {imdb_id: 'tt0114709'})
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
What are the top 5 movies by revenue in descending order?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 5",Complex Retrieval Queries,neoflix,False,False,True,
List the movies with a tagline that includes 'excitement'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'excitement'
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have been produced in the 'United States of America' and have an adult rating?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'United States of America'})
WHERE exists{ (m)-[:IN_GENRE]->(:Genre {name: 'Adult'}) }
RETURN m",Complex Retrieval Queries,neoflix,True,False,False,
List all movies that have a homepage URL defined.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Which movies have been rated by user with ID 1?,"MATCH (u:User {id: 1})-[:RATED]->(m:Movie)
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
What are the names of genres associated with movies having a budget over 100 million USD?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget > 100000000
RETURN DISTINCT g.name",Complex Retrieval Queries,neoflix,False,False,True,
List all movies produced by 'Pixar Animation Studios'.,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
Which movies are part of the 'Toy Story Collection'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m",Complex Retrieval Queries,neoflix,False,False,False,
Name the first 5 movies that have been rated by at least 50 users.,"MATCH (m:Movie)
WHERE size{(m)<-[:RATED]-(:User)} >= 50
RETURN m.title AS MovieTitle
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
What are the 3 most popular movies that have been released since 2015?,"MATCH (m:Movie)
WHERE m.release_date >= date('2015-01-01') AND m.status = 'Released'
RETURN m
ORDER BY m.popularity DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Which 3 production companies have produced films with a runtime longer than 180 minutes?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WHERE m.runtime > 180
RETURN pc.name, count(m) AS NumberOfMovies
ORDER BY NumberOfMovies DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
List the first 5 videos that have a runtime under 60 minutes.,"MATCH (v:Video)
WHERE v.runtime < 60
RETURN v
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
"What are the top 3 languages spoken in the adult films with a budget greater than 100,000 dollars?","MATCH (a:Adult)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE a.budget > 100000
RETURN l.name, count(a) AS num_films
ORDER BY num_films DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Name the first 3 movies that have a poster path ending in '/pQFoyx7rp09CJTAb932F2g8Nlho.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH '/pQFoyx7rp09CJTAb932F2g8Nlho.jpg'
RETURN m.title
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Which 3 keywords are most commonly associated with movies that have a revenue over 200 million dollars?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.revenue > 200000000
RETURN k.name, count(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
List the top 5 movies that have been part of at least one collection.,"MATCH (m:Movie)-[:IN_COLLECTION]->(:Collection)
RETURN m
ORDER BY m.popularity DESC
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
What are the first 3 genres associated with the movie 'Alex & Emma'?,"MATCH (m:Movie {title: 'Alex & Emma'})-[:IN_GENRE]->(g:Genre)
RETURN g
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,False,
Which 3 movies have the highest vote count?,"MATCH (m:Movie)
RETURN m
ORDER BY m.vote_count DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
List the top 5 adult films with the highest popularity.,"MATCH (a:Adult)
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
What are the top 5 languages spoken in the highest-grossing movies?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.revenue IS NOT NULL
RETURN l.name, sum(m.revenue) as total_revenue
ORDER BY total_revenue DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
Name the first 5 movies that have a release date before 1990.,"MATCH (m:Movie)
WHERE m.release_date < date('1990-01-01')
RETURN m.title
ORDER BY m.release_date
LIMIT 5",Simple Retrieval Queries,neoflix,False,True,False,
Which 3 production companies have the highest total budgets for their movies?,"MATCH (pc:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
RETURN pc.name AS ProductionCompanyName, sum(m.budget) AS TotalBudget
ORDER BY TotalBudget DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
List the first 5 videos that were produced by 'Pixar Animation Studios'.,"MATCH (v:Video)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN v
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
What are the top 3 languages spoken in adult films with a vote count over 10?,"MATCH (a:Adult)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE a.vote_count > 10
RETURN l.name, count(a) AS num_films
ORDER BY num_films DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Name the first 3 adult films that have a runtime longer than 90 minutes.,"MATCH (a:Adult)
WHERE a.runtime > 90
RETURN a.title
ORDER BY a.release_date
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Which 3 keywords are most commonly associated with movies that have an original language of 'en'?,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language {id: 'en'})
MATCH (m)-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name, count(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
List the top 5 movies that have been rated by users with an average rating below 4.0.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH m, AVG(r.rating) AS avgRating
WHERE avgRating < 4.0
RETURN m.title, avgRating
ORDER BY avgRating ASC
LIMIT 5",Simple Retrieval Queries,neoflix,False,False,True,
What are the first 3 genres associated with the movie 'Nil Battey Sannata'?,"MATCH (m:Movie {title: 'Nil Battey Sannata'})-[:IN_GENRE]->(g:Genre)
RETURN g
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Which 3 movies have the highest revenue and were released in the 'United Kingdom'?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'United Kingdom'})
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
Which movies have a revenue greater than 50 million USD?,"MATCH (m:Movie)
WHERE m.revenue > 50000000
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
List all movies where Tom Hanks acted in.,"MATCH (p:Person {name: ""Tom Hanks""})-[:CAST_FOR]->(m:Movie)
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
What are the top 5 most popular movies?,"MATCH (m:Movie)
RETURN m
ORDER BY m.popularity DESC
LIMIT 5",Complex Retrieval Queries,neoflix,False,False,True,
What are the 3 most popular movies in the genre 'Thriller'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Thriller'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3",Simple Retrieval Queries,neoflix,False,False,True,
List the first 3 people who have a profile path starting with '/p'.,"MATCH (p:Person)
WHERE p.profile_path STARTS WITH '/p'
RETURN p
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
List the movies with a release date on '1995-10-30'.,"MATCH (m:Movie)
WHERE m.release_date = DATE('1995-10-30')
RETURN m",Complex Retrieval Queries,neoflix,False,False,True,
What are the top 5 original titles of movies with an original language of 'en'?,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language {id: 'en'})
RETURN m.original_title AS OriginalTitle
ORDER BY m.popularity DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
List the top 3 people who have the most credits as a producer.,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = 'Producer'
RETURN p.name, count(r) AS credits
ORDER BY credits DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Which 3 movies have the most distinct languages spoken?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(DISTINCT l) AS num_languages
ORDER BY num_languages DESC
LIMIT 3
RETURN m.title, num_languages",Pathfinding Queries,neoflix,False,False,True,
List the first 3 movies that have been rated exactly 10 times and have a budget greater than 100000 USD.,"MATCH (m:Movie)
WHERE m.budget > 100000 AND m.vote_count = 10
RETURN m
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
What are the top 5 movies with a specific keyword 'space' and have been released?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'space'})
WHERE m.status = 'Released'
RETURN m
ORDER BY m.popularity DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
"List the first 3 movies that have a release date on a specific day, say '1995-12-22'.","MATCH (m:Movie)
WHERE m.release_date = DATE('1995-12-22')
RETURN m
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
What are the top 5 movies with the highest revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
List the first 3 genres most commonly associated with movies that have a budget over $50 million.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget > 50000000
RETURN g.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 movies have the most number of keywords associated with them?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
RETURN m.title, count(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Who are the top 5 directors with the most films produced in the United States?,"MATCH (p:Person)-[cf:CREW_FOR]->(m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: ""United States of America""})
WHERE cf.job = ""Director""
RETURN p.name, count(m) AS films_directed
ORDER BY films_directed DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,True,False,
What are the top 3 languages spoken in movies that have a revenue greater than $100 million?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.revenue > 100000000
RETURN l.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
List the first 3 countries where movies with an average vote above 8 were produced.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.average_vote > 8
RETURN DISTINCT c.name
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 production companies have produced the most movies with a runtime longer than 120 minutes?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WHERE m.runtime > 120
WITH pc, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3
RETURN pc.name, movies_count",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 5 most popular movies released before 2000?,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01') AND m.popularity IS NOT NULL
RETURN m
ORDER BY m.popularity DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Who are the first 3 actors by number of roles in movies with a status of 'Released'?,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
WHERE m.status = 'Released'
WITH p, count(r) AS roles
ORDER BY roles DESC
RETURN p.name, roles
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 users have rated the most number of movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN u.id, count(r) AS ratings_count
ORDER BY ratings_count DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 5 countries with the most movies produced?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS Country, count(m) AS NumberOfMovies
ORDER BY NumberOfMovies DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
List the first 3 genres associated with the highest average movie budget.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, avg(m.budget) AS avgBudget
ORDER BY avgBudget DESC
LIMIT 3
RETURN g.name AS Genre, avgBudget",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 3 collections with the most movies included?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WITH c, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3
RETURN c.name, num_movies",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 directors have worked on the highest-grossing movies?,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = 'Director' AND m.revenue IS NOT NULL
RETURN p.name, sum(m.revenue) as total_revenue
ORDER BY total_revenue DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
List the first 3 actors who have starred in the most movies within a single genre.,"MATCH (p:Person)-[cf:CAST_FOR]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH p, g, count(m) AS movies_count
ORDER BY movies_count DESC
RETURN p.name, g.name, movies_count
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 5 languages in which the most highly rated movies were originally made?,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
WHERE EXISTS {
  (u:User)-[:RATED]->(m)
  WHERE m.average_vote IS NOT NULL
}
RETURN l.name AS Language, AVG(m.average_vote) AS AverageRating
ORDER BY AverageRating DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 production companies have the highest average revenue per movie?,"MATCH (pc:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
WHERE m.revenue IS NOT NULL
RETURN pc.name, avg(m.revenue) AS average_revenue
ORDER BY average_revenue DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
List the first 3 movies that have been rated by the highest number of users.,"MATCH (m:Movie)<-[:RATED]-(u:User)
WITH m, count(u) AS userCount
ORDER BY userCount DESC
RETURN m.title, userCount
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
What are the first 5 movies that have a poster path ending in '.jpg'?,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH '.jpg'
RETURN m
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
What are the top 5 genres with the most movies having a runtime of less than 90 minutes?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.runtime < 90
RETURN g.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5",Complex Aggregation Queries,neoflix,True,False,False,
List the first 3 packages that provide the longest duration of access to movies.,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN p.name, p.duration
ORDER BY p.duration DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
List the first 3 adult films with a tagline 'Humiliation. Rape. Murder. You know the drill.',"MATCH (a:Adult {tagline: 'Humiliation. Rape. Murder. You know the drill.'})
RETURN a
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Which 3 genres are most commonly associated with videos that have a budget over 100000 USD?,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WHERE v.budget > 100000
RETURN g.name, count(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 3",Pathfinding Queries,neoflix,False,True,False,
List the top 3 countries where the most videos have been produced.,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS Country, count(v) AS NumberOfVideos
ORDER BY NumberOfVideos DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
What are the first 5 keywords most associated with movies that have a revenue above 1 million USD?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.revenue > 1000000
RETURN k.name, count(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
List the first 3 genres that have the highest average rating across all movies.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WITH g, avg((m)<-[:RATED]-(:User).rating) AS avgRating
ORDER BY avgRating DESC
RETURN g.name AS Genre, avgRating
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Which 3 production companies have produced the most adult films?,"MATCH (pc:ProductionCompany)-[:PRODUCED_BY]-(a:Adult)
RETURN pc.name, count(a) AS adultFilmCount
ORDER BY adultFilmCount DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
List the top 3 people who have acted the most in released movies.,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
WHERE m.status = 'Released'
RETURN p.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
What are the top 5 users who have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN u.id, count(r) AS ratings_count
ORDER BY ratings_count DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
List the first 3 movies with the highest number of associated keywords and a budget above 50000 USD.,"MATCH (m:Movie)
WHERE m.budget > 50000
WITH m, count{(m)-[:HAS_KEYWORD]->(:Keyword)} AS keywordCount
ORDER BY keywordCount DESC
RETURN m.title, m.budget, keywordCount
LIMIT 3",Pathfinding Queries,neoflix,False,False,False,
Which 3 movies have the longest gap between their release date and the current date?,"MATCH (m:Movie)
WHERE m.release_date IS NOT NULL
RETURN m.title, m.release_date, duration.between(m.release_date, date()).years AS years_since_release
ORDER BY years_since_release DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
List the first 3 movies that have a specific keyword 'adventure' and are in the 'Released' status.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'adventure'})
WHERE m.status = 'Released'
RETURN m
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
What are the top 5 movies with the most complex taglines?,"MATCH (m:Movie)
WHERE m.tagline IS NOT NULL
RETURN m.title, m.tagline, size(split(m.tagline, ' ')) AS word_count
ORDER BY word_count DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
List the first 3 movies that are part of a collection and have a runtime less than 90 minutes.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE m.runtime < 90
RETURN m.title, m.runtime, c.name
LIMIT 3",Pathfinding Queries,neoflix,False,False,False,
Which 3 adult films have the most provocative taglines?,"MATCH (a:Adult)
WHERE a.tagline IS NOT NULL
RETURN a.title, a.tagline
ORDER BY a.popularity DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
List the first 3 videos that have a specific keyword 'action' and are in the 'Released' status.,"MATCH (v:Video)-[:HAS_KEYWORD]->(k:Keyword {name: 'action'})
WHERE v.status = 'Released'
RETURN v
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
What are the top 5 adult films with the lowest vote count and are still in the 'Released' status?,"MATCH (a:Adult)
WHERE a.status = 'Released' AND a.vote_count IS NOT NULL
RETURN a
ORDER BY a.vote_count ASC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
List the first 3 movies that have an original language of 'es' and are in the 'Released' status.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language {id: 'es'})
WHERE m.status = 'Released'
RETURN m
LIMIT 3",Pathfinding Queries,neoflix,False,False,False,
Which 3 videos have the most detailed overviews?,"MATCH (v:Video)
WHERE v.overview IS NOT NULL
RETURN v.title, v.overview
ORDER BY size(v.overview) DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
List the top 3 adult films that have been rated exactly 3 times.,"MATCH (a:Adult)
WHERE count{(u:User)-[:RATED]->(a)} = 3
RETURN a
ORDER BY a.average_vote DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
What are the first 5 packages that provide access to the genre 'Drama'?,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre {name: 'Drama'})
RETURN p
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
List the first 3 subscriptions that were initiated in 2020.,"MATCH (s:Subscription)
WHERE s.expiresAt.year = 2020
RETURN s
LIMIT 3",Pathfinding Queries,neoflix,True,False,False,
Which 3 movies have the most cast members named 'Tom Hanks'?,"MATCH (p:Person {name: 'Tom Hanks'})-[:CAST_FOR]->(m:Movie)
RETURN m.title, count(p) AS num_cast_members
ORDER BY num_cast_members DESC
LIMIT 3",Pathfinding Queries,neoflix,True,False,False,
List the top 3 videos that have been produced by 'Pixar Animation Studios' and have a runtime shorter than 50 minutes.,"MATCH (v:Video)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Pixar Animation Studios'})
WHERE v.runtime < 50
RETURN v.title, v.runtime
ORDER BY v.runtime ASC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
What are the top 5 movies with an original title different from their title?,"MATCH (m:Movie)
WHERE m.title <> m.original_title
RETURN m
ORDER BY m.popularity DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
Which 3 languages are most frequently used in videos with a runtime over 100 minutes?,"MATCH (v:Video)-[:ORIGINAL_LANGUAGE]->(lang:Language)
WHERE v.runtime > 100
RETURN lang.name, count(v) AS num_videos
ORDER BY num_videos DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,False,
List the first 3 languages that have been spoken in the most adult films.,"MATCH (l:Language)<-[:SPOKEN_IN_LANGUAGE]-(a:Adult)
WITH l, count(a) AS adultFilmCount
ORDER BY adultFilmCount DESC
RETURN l.id, l.name, adultFilmCount
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Who are the first 3 actors to appear in movies from at least two different genres?,"MATCH (p:Person)-[c:CAST_FOR]->(m:Movie)
WITH p, collect(DISTINCT (m)-[:IN_GENRE]->(:Genre)) AS genres
WHERE size(genres) >= 2
RETURN p.name
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
List the top 5 movies with the most extensive taglines.,"MATCH (m:Movie)
WHERE m.tagline IS NOT NULL
RETURN m.title, m.tagline
ORDER BY length(m.tagline) DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 production companies have the most movies with a vote count over 1000?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WHERE m.vote_count > 1000
RETURN pc.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
List the top 5 adult films with the highest average votes.,"MATCH (a:Adult)
WHERE a.average_vote IS NOT NULL
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 3 languages spoken in videos that have a revenue greater than $0?,"MATCH (v:Video)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE v.revenue > 0
RETURN l.name, count(v) AS num_videos
ORDER BY num_videos DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Who are the first 3 actors by number of roles in videos with a status of 'Released'?,"MATCH (p:Person)-[c:CAST_FOR]->(v:Video)
WHERE v.status = 'Released'
WITH p, count(c) AS roles
ORDER BY roles DESC
RETURN p.name, roles
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
List the first 3 genres with the most adult films associated.,"MATCH (g:Genre)<-[:IN_GENRE]-(a:Adult)
WITH g, count(a) AS adultCount
ORDER BY adultCount DESC
LIMIT 3
RETURN g.name AS Genre, adultCount",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 5 movies with the most number of spoken languages?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(l) AS num_languages
ORDER BY num_languages DESC
LIMIT 5
RETURN m.title, num_languages",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 directors have worked on movies with the longest total runtime?,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = 'Director'
WITH p, sum(m.runtime) AS total_runtime
ORDER BY total_runtime DESC
LIMIT 3
RETURN p.name AS Director, total_runtime",Complex Aggregation Queries,neoflix,False,False,True,
List the first 3 countries where the most non-English language movies are produced.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE EXISTS { (m)-[:ORIGINAL_LANGUAGE]->(l:Language) WHERE l.id <> 'en' }
RETURN c.name, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3",Complex Aggregation Queries,neoflix,True,False,False,
What are the top 5 most popular videos based on their popularity score?,"MATCH (v:Video)
RETURN v.title, v.popularity
ORDER BY v.popularity DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Who are the first 3 actors to have starred in at least 3 movies from the 'Toy Story Collection'?,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
WITH p, count(m) AS movies_count
WHERE movies_count >= 3
RETURN p.name
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 languages are spoken most commonly in movies with a runtime longer than 120 minutes?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.runtime > 120
RETURN l.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
List the first 3 genres that have the most movies featuring Tom Hanks.,"MATCH (p:Person {name: ""Tom Hanks""})-[:CAST_FOR]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, count(m) AS movieCount
ORDER BY movieCount DESC
RETURN g.name, movieCount
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 5 production companies by the number of comedy films produced?,"MATCH (pc:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)-[:IN_GENRE]->(g:Genre {name: ""Comedy""})
RETURN pc.name, count(m) AS NumberOfComedyFilms
ORDER BY NumberOfComedyFilms DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
List the first 3 movies with the most extensive homepages.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m
ORDER BY length(m.homepage) DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 3 highest revenue adult films?,"MATCH (a:Adult)
WHERE a.revenue IS NOT NULL
RETURN a.title, a.revenue
ORDER BY a.revenue DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Who are the first 3 directors who have worked on both movies and adult films?,"MATCH (p:Person)-[r1:CREW_FOR]->(m:Movie)
WHERE r1.job = 'Director'
WITH p
MATCH (p)-[r2:CREW_FOR]->(a:Adult)
WHERE r2.job = 'Director'
RETURN p.name
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 production companies have the most films with an original language of 'en'?,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language {id: 'en'})
MATCH (m)-[:PRODUCED_BY]->(pc:ProductionCompany)
WITH pc, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 3
RETURN pc.name, numMovies",Complex Aggregation Queries,neoflix,False,False,True,
List the top 5 keywords associated with the most commercially successful movies.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.revenue IS NOT NULL
RETURN k.name, SUM(m.revenue) AS totalRevenue
ORDER BY totalRevenue DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 3 countries producing the most comedies?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: ""Comedy""})
MATCH (m)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name, count(m) AS comedy_count
ORDER BY comedy_count DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Who are the first 3 actors who have starred in both comedies and dramas?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name = 'Comedy'
WITH p, count(DISTINCT m) AS comedies
WHERE comedies > 0
MATCH (p)-[:CAST_FOR]->(m2:Movie)-[:IN_GENRE]->(g2:Genre)
WHERE g2.name = 'Drama'
WITH p, count(DISTINCT m2) AS dramas
WHERE dramas > 0
RETURN p.name
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 languages are spoken in the most films with a poster featuring '/rh'?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.poster_path CONTAINS '/rh'
WITH l, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3
RETURN l.id, l.name, movies_count",Complex Aggregation Queries,neoflix,False,False,True,
List the first 3 genres of movies with the lowest average revenue.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.revenue IS NOT NULL
WITH g, avg(m.revenue) AS avgRevenue
ORDER BY avgRevenue ASC
RETURN g.name AS Genre, avgRevenue
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 5 movies with a tagline that includes the word 'adventure'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'adventure'
RETURN m
ORDER BY m.average_vote DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Who are the first 3 directors with movies that have a runtime of over 180 minutes?,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = 'Director' AND m.runtime > 180
RETURN p.name
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 languages are most commonly found in movies with a poster path featuring '/9'?,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE|:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.poster_path CONTAINS '/9'
RETURN l.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 5 movies with the highest budget that were released in the 1990s?,"MATCH (m:Movie)
WHERE m.release_date >= date('1990-01-01') AND m.release_date <= date('1999-12-31')
RETURN m
ORDER BY m.budget DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 languages are most common in movies with a budget over $30 million?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.budget > 30000000
RETURN l.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 3 highest budget movies that have a poster path ending in 'jpg'?,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH 'jpg'
RETURN m
ORDER BY m.budget DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 directors have the most movies with an average vote higher than 7?,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = 'Director' AND m.average_vote > 7
WITH p, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3
RETURN p.name, movies_count",Complex Aggregation Queries,neoflix,False,False,True,
List the first 3 countries where the most English language movies are produced.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE exists{(m)-[:ORIGINAL_LANGUAGE]->(:Language {id: ""en""})}
RETURN c.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 5 production companies by the number of movies with a runtime longer than 100 minutes?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WHERE m.runtime > 100
WITH pc, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 5
RETURN pc.name, movies_count",Complex Aggregation Queries,neoflix,False,False,True,
List the first 3 actors who have played in movies with at least three different taglines.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WITH p, count(DISTINCT m.tagline) AS distinctTaglines
WHERE distinctTaglines >= 3
RETURN p.name
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 genres have the most videos associated with them?,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS Genre, count(v) AS VideoCount
ORDER BY VideoCount DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
List the first 3 countries with the most videos produced.,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS Country, count(v) AS NumberOfVideos
ORDER BY NumberOfVideos DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 5 movies with the longest runtime and released after 2010?,"MATCH (m:Movie)
WHERE m.release_date > date('2010-01-01') AND m.runtime IS NOT NULL
RETURN m
ORDER BY m.runtime DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Who are the first 3 actors by number of roles in adult films?,"MATCH (p:Person)-[r:CAST_FOR]->(a:Adult)
WITH p, count(r) AS roles
ORDER BY roles DESC
LIMIT 3
RETURN p.name, roles",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 5 genres of movies produced by Pixar Animation Studios?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: ""Pixar Animation Studios""})
MATCH (m)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS Genre, count(m) AS MoviesCount
ORDER BY MoviesCount DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
List the first 3 movies with the most revenue that were released after the year 2000.,"MATCH (m:Movie)
WHERE m.release_date >= date('2001-01-01') AND m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Who are the first 3 directors to have movies in more than one collection?,"MATCH (p:Person)-[:CREW_FOR {job: ""Director""}]->(m:Movie)-[:IN_COLLECTION]->(c:Collection)
WITH p, count(DISTINCT c) AS num_collections
WHERE num_collections > 1
RETURN p.name
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 5 languages in which the most adult films were originally made?,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS Language, count(a) AS NumberOfAdultFilms
ORDER BY NumberOfAdultFilms DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 production companies have produced the most adult films?,"MATCH (pc:ProductionCompany)-[:PRODUCED_BY]-(a:Adult)
RETURN pc.name, count(a) AS adultFilmCount
ORDER BY adultFilmCount DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
List the top 5 keywords associated with movies that have a runtime over 150 minutes.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.runtime > 150
RETURN k.name, count(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 3 countries producing the most adult films with a runtime over 60 minutes?,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE a.runtime > 60
RETURN c.name, count(a) AS AdultFilmCount
ORDER BY AdultFilmCount DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Who are the first 3 actors with roles in both movies and adult films?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie), (p)-[:CAST_FOR]->(a:Adult)
WITH p, count(DISTINCT m) AS moviesCount, count(DISTINCT a) AS adultCount
WHERE moviesCount > 0 AND adultCount > 0
RETURN p.name
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 keywords are most frequently associated with movies having a budget over $200 million?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.budget > 200000000
RETURN k.name, count(k) AS frequency
ORDER BY frequency DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 5 movies with the most complex taglines?,"MATCH (m:Movie)
WHERE m.tagline IS NOT NULL
RETURN m.title, m.tagline
ORDER BY size(split(m.tagline, ' ')) DESC
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 production companies have produced movies with the highest average popularity?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WITH pc, avg(m.popularity) AS avgPopularity
ORDER BY avgPopularity DESC
LIMIT 3
RETURN pc.name AS ProductionCompanyName, avgPopularity",Complex Aggregation Queries,neoflix,False,False,True,
List the first 3 movies with the lowest revenue and released before 1990.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL AND m.release_date < date('1990-01-01')
RETURN m
ORDER BY m.revenue ASC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
What are the top 5 most popular genres based on average movie popularity?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, avg(m.popularity) AS avgPopularity
ORDER BY avgPopularity DESC
RETURN g.name AS Genre, avgPopularity
LIMIT 5",Complex Aggregation Queries,neoflix,False,False,False,
Who are the first 3 actors to star in movies from both the horror and comedy genres?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WHERE exists {
    (m)-[:IN_GENRE]->(:Genre {name: 'Horror'})
} AND exists {
    (m)-[:IN_GENRE]->(:Genre {name: 'Comedy'})
}
RETURN p.name
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
List the first 3 genres of movies with the highest average vote count.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS Genre, AVG(m.average_vote) AS AverageVote
ORDER BY AverageVote DESC
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
What are the first 3 subscriptions that are about to expire?,"MATCH (s:Subscription)
RETURN s
ORDER BY s.expiresAt ASC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
List the first 3 actors with roles in both movies and videos.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie), (p)-[:CAST_FOR]->(v:Video)
WITH p, count(DISTINCT m) AS movies, count(DISTINCT v) AS videos
WHERE movies > 0 AND videos > 0
RETURN p.name
LIMIT 3",Complex Aggregation Queries,neoflix,False,False,True,
Which 3 packages have the highest price?,"MATCH (p:Package)
RETURN p.name, p.price
ORDER BY p.price DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
List the first 3 movies that were part of more than one collection.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WITH m, count(c) AS num_collections
WHERE num_collections > 1
RETURN m
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 movies have the most significant number of cast members?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WITH m, count(p) AS num_cast
ORDER BY num_cast DESC
LIMIT 3
RETURN m.title, num_cast",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 5 videos by vote count?,"MATCH (v:Video)
RETURN v
ORDER BY v.vote_count DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 movies that have been both highly rated and have high revenue.,"MATCH (m:Movie)
WHERE m.revenue > 100000000 AND m.average_vote > 8.0
RETURN m
ORDER BY m.revenue DESC, m.average_vote DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 people have the highest number of crew credits in movies?,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WITH p, count(r) AS crewCredits
ORDER BY crewCredits DESC
LIMIT 3
RETURN p.name, crewCredits",Simple Aggregation Queries,neoflix,True,False,False,
What are the top 5 adult films by vote count?,"MATCH (a:Adult)
RETURN a.title, a.vote_count
ORDER BY a.vote_count DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 adult films that have been produced in the 'United States of America'.,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'United States of America'})
RETURN a
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 genres are most popular according to the popularity scores in movies?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS Genre, sum(m.popularity) AS TotalPopularity
ORDER BY TotalPopularity DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 5 languages used in the original language of adult films?,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS Language, count(a) AS NumberOfAdultFilms
ORDER BY NumberOfAdultFilms DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 movies that were produced by 'Pixar Animation Studios' and have a budget over $100 million.,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Pixar Animation Studios'})
WHERE m.budget > 100000000
RETURN m
ORDER BY m.release_date
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,False,
Which 3 movies have the smallest difference between their original and final titles?,"MATCH (m:Movie)
WHERE m.title IS NOT NULL AND m.original_title IS NOT NULL
RETURN m.title, m.original_title, abs(length(m.title) - length(m.original_title)) AS title_difference
ORDER BY title_difference ASC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 5 most popular genres based on movie data?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS Genre, avg(m.popularity) AS AveragePopularity
ORDER BY AveragePopularity DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 adult films with a runtime longer than 60 minutes.,"MATCH (a:Adult)
WHERE a.runtime > 60
RETURN a
ORDER BY a.id
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 movies have the highest number of spoken languages?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(l) AS num_languages
ORDER BY num_languages DESC
RETURN m.title, num_languages
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 5 longest running movies in the database?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 videos with no budget reported.,"MATCH (v:Video)
WHERE v.budget IS NULL
RETURN v
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 movies have the highest number of production companies associated?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WITH m, count(pc) AS num_production_companies
ORDER BY num_production_companies DESC
LIMIT 3
RETURN m.title, num_production_companies",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 5 genres associated with the highest average votes in videos?,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WHERE v.average_vote IS NOT NULL
RETURN g.name AS Genre, AVG(v.average_vote) AS AverageVote
ORDER BY AverageVote DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 packages that provide access to the 'Drama' genre.,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre {name: 'Drama'})
RETURN p
LIMIT 3",Simple Aggregation Queries,neoflix,True,False,False,
Which 3 countries have produced the most videos?,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS Country, count(v) AS NumberOfVideos
ORDER BY NumberOfVideos DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 5 most popular packages based on duration?,"MATCH (p:Package)
RETURN p.name, p.duration
ORDER BY p.duration DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 movies that have a homepage listed.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 adult films have been rated by the most users?,"MATCH (a:Adult)<-[:RATED]-(u:User)
RETURN a.title, count(u) AS user_count
ORDER BY user_count DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,False,
What are the top 5 most frequently spoken languages in videos?,"MATCH (v:Video)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS Language, count(v) AS VideoCount
ORDER BY VideoCount DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 movies have the most extensive poster paths?,"MATCH (m:Movie)
WHERE m.poster_path IS NOT NULL
RETURN m
ORDER BY length(m.poster_path) DESC
LIMIT 3",Simple Aggregation Queries,neoflix,True,False,False,
List the first 3 videos that have been produced in more than one country.,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH v, count(c) AS num_countries
WHERE num_countries > 1
RETURN v
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 5 movies with the most keywords associated?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WITH m, count(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 5
RETURN m.title, keyword_count",Simple Aggregation Queries,neoflix,False,False,True,
List the top 5 packages by the duration they provide access.,"MATCH (p:Package)
RETURN p.name, p.duration
ORDER BY p.duration DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
List the first 3 movies directed by a person named 'John Doe'.,"MATCH (p:Person {name: 'John Doe'})-[:CREW_FOR {job: 'Director'}]->(m:Movie)
RETURN m
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 movies have the most significant difference between budget and revenue?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.budget, m.revenue, abs(m.revenue - m.budget) AS difference
ORDER BY difference DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 5 movies with the longest taglines?,"MATCH (m:Movie)
WHERE m.tagline IS NOT NULL
RETURN m.title, m.tagline
ORDER BY length(m.tagline) DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 movies that were rated exactly 5 stars by any user.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE r.rating = 5.0
RETURN m
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 people have acted in the most number of videos?,"MATCH (p:Person)-[:CAST_FOR]->(v:Video)
WITH p, count(v) AS num_videos
ORDER BY num_videos DESC
LIMIT 3
RETURN p.name, num_videos",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 5 movies with the smallest runtime?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m
ORDER BY m.runtime ASC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 genres that have movies with no keywords associated.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE NOT exists{ (m)-[:HAS_KEYWORD]->(:Keyword) }
RETURN g
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 production companies have produced movies in more than 3 different languages?,"MATCH (pc:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH pc, count(DISTINCT l) AS languages_count
WHERE languages_count > 3
RETURN pc.name, languages_count
ORDER BY languages_count DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 5 most frequently used keywords in adult films?,"MATCH (a:Adult)-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name AS Keyword, count(k) AS Frequency
ORDER BY Frequency DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 adult films that have a revenue of 0.,"MATCH (a:Adult)
WHERE a.revenue = 0
RETURN a
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,False,
What are the top 5 movies by revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5",Pathfinding Queries,neoflix,False,True,False,
Which 3 videos have the most keywords associated with them?,"MATCH (v:Video)-[:HAS_KEYWORD]->(k:Keyword)
RETURN v.title, count(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 movies in which 'Tom Hanks' has acted.,"MATCH (p:Person {name: 'Tom Hanks'})-[:CAST_FOR]->(m:Movie)
RETURN m.title AS MovieTitle, m.release_date AS ReleaseDate
ORDER BY m.release_date
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 genres are most common among movies released before 2000?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.release_date < date('2000-01-01')
RETURN g.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 5 most popular adult films?,"MATCH (a:Adult)
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 5",Simple Aggregation Queries,neoflix,True,False,False,
List the first 3 keywords associated with the video titled 'Jonah: A VeggieTales Movie'.,"MATCH (v:Video {title: 'Jonah: A VeggieTales Movie'})-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 movies have been rated highest by users?,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN m.title, avg(r.rating) AS average_rating
ORDER BY average_rating DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 5 oldest movies in the database?,"MATCH (m:Movie)
WHERE m.release_date IS NOT NULL
RETURN m
ORDER BY m.release_date ASC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 movies with taglines containing the word 'adventure'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'adventure'
RETURN m
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 adult films have the lowest average vote?,"MATCH (a:Adult)
WHERE a.average_vote IS NOT NULL
RETURN a.title, a.average_vote
ORDER BY a.average_vote ASC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,False,
What are the top 5 longest taglines in adult films?,"MATCH (a:Adult)
WHERE a.tagline IS NOT NULL
RETURN a.title, a.tagline
ORDER BY length(a.tagline) DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 countries that have produced the most adult films.,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name, count(a) AS adultFilmCount
ORDER BY adultFilmCount DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Which 3 genres have the highest average votes in movies?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.average_vote IS NOT NULL
RETURN g.name AS Genre, AVG(m.average_vote) AS AverageVote
ORDER BY AverageVote DESC
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
What are the top 5 countries by the number of videos produced there?,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS Country, count(v) AS NumberOfVideos
ORDER BY NumberOfVideos DESC
LIMIT 5",Simple Aggregation Queries,neoflix,False,False,True,
List the first 3 movies where the budget was over 50 million USD.,"MATCH (m:Movie)
WHERE m.budget > 50000000
RETURN m
ORDER BY m.id
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Who are the first 3 actors in the cast list of 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'})-[:CAST_FOR]->(p:Person)
RETURN p.name AS ActorName, p.id AS ActorID
ORDER BY p.profile_path IS NOT NULL DESC, p.name
LIMIT 3",Simple Aggregation Queries,neoflix,False,False,True,
Find the top 3 movies that have a runtime longer than 120 minutes.,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m
ORDER BY m.runtime DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
List the first 3 movies that have a 'status' of 'In Production'.,"MATCH (m:Movie)
WHERE m.status = 'In Production'
RETURN m
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
What are the top 5 movies that have a genre of 'Comedy' and are rated above 6?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Comedy'})
WHERE m.average_vote > 6
RETURN m
ORDER BY m.average_vote DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
List the first 3 videos that have a poster path ending in '.jpg'.,"MATCH (v:Video)
WHERE v.poster_path ENDS WITH '.jpg'
RETURN v
LIMIT 3",Pathfinding Queries,neoflix,False,False,False,
Which 5 videos have the highest average vote and are in the 'Released' status?,"MATCH (v:Video)
WHERE v.status = 'Released'
RETURN v
ORDER BY v.average_vote DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,False,
List the first 3 videos with a budget greater than 100000 USD.,"MATCH (v:Video)
WHERE v.budget > 100000
RETURN v
ORDER BY v.id
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
What are the top 5 videos produced in 'United States of America'?,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'United States of America'})
RETURN v.title AS Title, v.release_date AS ReleaseDate
ORDER BY v.popularity DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
List the top 3 videos that have the most votes.,"MATCH (v:Video)
RETURN v.title, v.vote_count
ORDER BY v.vote_count DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Which 3 videos have the longest runtime and are in the 'Released' status?,"MATCH (v:Video)
WHERE v.status = 'Released'
RETURN v.title, v.runtime
ORDER BY v.runtime DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
List the first 5 videos that have been translated into the language 'Azərbaycan'.,"MATCH (v:Video)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Azərbaycan'})
RETURN v
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
What are the first 3 videos with a 'status' of 'In Production'?,"MATCH (v:Video)
WHERE v.status = 'In Production'
RETURN v
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
List the top 5 videos that have a genre of 'Horror' and are rated above 5.,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre {name: 'Horror'})
WHERE v.average_vote > 5
RETURN v.title, v.average_vote
ORDER BY v.average_vote DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
Which 3 adult films have the highest average vote?,"MATCH (a:Adult)
WHERE a.average_vote IS NOT NULL
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
List the first 3 adult films with a budget less than 50000 USD.,"MATCH (a:Adult)
WHERE a.budget < 50000
RETURN a
ORDER BY a.release_date
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
What are the top 5 adult films produced in 'Italy'?,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'Italy'})
RETURN a.title AS Title, a.imdb_id AS IMDb_ID, a.release_date AS Release_Date
ORDER BY a.popularity DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
Which 3 adult films have the longest runtime and are in the 'Released' status?,"MATCH (a:Adult)
WHERE a.status = 'Released'
RETURN a.title, a.runtime
ORDER BY a.runtime DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
List the first 5 adult films that have a homepage URL.,"MATCH (a:Adult)
WHERE a.homepage IS NOT NULL
RETURN a
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
What are the top 3 genres that have the most movies associated with them?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS Genre, count(m) AS MovieCount
ORDER BY MovieCount DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
List the first 3 production companies that have produced the most movies.,"MATCH (p:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
RETURN p.name, count(m) AS movies_produced
ORDER BY movies_produced DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,False,
Which 3 countries have the most movies produced in them?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS Country, count(m) AS NumberOfMovies
ORDER BY NumberOfMovies DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
List the first 5 languages that are most frequently used as the original language in movies.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS Language, count(m) AS MovieCount
ORDER BY MovieCount DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,False,
What are the top 3 collections with the most movies included?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WITH c, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3
RETURN c.name, num_movies",Pathfinding Queries,neoflix,False,False,True,
List the first 3 genres that are most frequently targeted by packages.,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre)
WITH g, count(p) AS packagesCount
ORDER BY packagesCount DESC
RETURN g.name AS Genre, packagesCount
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Which 5 movies have the highest average vote and have been released?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.average_vote IS NOT NULL
RETURN m
ORDER BY m.average_vote DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
Which 3 movies have been rated 5.0 by users and have a 'Released' status?,"MATCH (m:Movie)-[:RATED {rating: 5.0}]->(u:User)
WHERE m.status = 'Released'
RETURN m
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
List the top 3 movies that were produced by 'Pixar Animation Studios' and have a runtime longer than 90 minutes.,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Pixar Animation Studios'})
WHERE m.runtime > 90
RETURN m
ORDER BY m.runtime DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
List the top 3 adult films that have been tagged with the keyword 'jealousy'.,"MATCH (a:Adult)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN a.title AS Title, a.imdb_id AS IMDb_ID, a.release_date AS Release_Date
ORDER BY a.average_vote DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
List the top 3 movies with the tagline 'What price would you put on your health?',"MATCH (m:Movie)
WHERE m.tagline = 'What price would you put on your health?'
RETURN m
ORDER BY m.average_vote DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
List the top 3 movies that were released before the year 2000 and have an 'original_language' of 'en'.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language {id: 'en'})
WHERE m.release_date < date('2000-01-01')
RETURN m
ORDER BY m.release_date DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
What are the first 5 most popular movies with a popularity score above 20?,"MATCH (m:Movie)
WHERE m.popularity > 20
RETURN m
ORDER BY m.popularity DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
What are the first 5 movies that have a main character named 'Charlie Wilson'?,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
WHERE r.character = 'Charlie Wilson'
RETURN m
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
Which 3 movies have the most keywords associated with them?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
RETURN m.title, count(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
List the first 3 movies with the highest number of votes.,"MATCH (m:Movie)
RETURN m
ORDER BY m.vote_count DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,False,
What are the top 5 movies with the lowest revenue and are still in 'Released' status?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL AND m.status = 'Released'
RETURN m
ORDER BY m.revenue ASC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
List the top 3 movies with the largest budgets that have been released.,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.budget IS NOT NULL
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
What are the first 5 movies that are part of a collection and have a budget greater than 10000000?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE m.budget > 10000000
RETURN m.title, m.budget, c.name
ORDER BY m.release_date
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
Which 3 movies have the highest popularity but the lowest revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL AND m.popularity IS NOT NULL
RETURN m
ORDER BY m.popularity DESC, m.revenue ASC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
List the top 3 movies which are in the genre 'Animation' and have been released.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
WHERE m.status = 'Released'
RETURN m
ORDER BY m.popularity DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
What are the first 5 movies directed by a specific director named 'John Doe'?,"MATCH (p:Person {name: 'John Doe'})-[:CREW_FOR {job: 'Director'}]->(m:Movie)
RETURN m
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
List the first 3 movies that have the tagline 'Roll the dice and unleash the excitement!',"MATCH (m:Movie {tagline: 'Roll the dice and unleash the excitement!'})
RETURN m
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Which 3 movies have the longest runtime and are in the 'Released' status?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.runtime IS NOT NULL
RETURN m
ORDER BY m.runtime DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Find the top 3 movies with a specific actor named 'Tom Hanks' in the cast.,"MATCH (p:Person {name: 'Tom Hanks'})-[:CAST_FOR]->(m:Movie)
RETURN m
ORDER BY m.popularity DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Which 5 movies have been rated by the most users?,"MATCH (m:Movie)<-[:RATED]-(u:User)
RETURN m.title, count(u) AS user_count
ORDER BY user_count DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
List the first 3 movies that have an 'average_vote' greater than 8.,"MATCH (m:Movie)
WHERE m.average_vote > 8
RETURN m
ORDER BY m.average_vote DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
List the top 3 movies where the homepage URL includes 'disney'.,"MATCH (m:Movie)
WHERE m.homepage CONTAINS 'disney'
RETURN m
ORDER BY m.popularity DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
What are the first 5 movies in the 'Toy Story Collection'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m
ORDER BY m.release_date
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
Which 5 movies have the shortest runtime and are in the 'Released' status?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.runtime IS NOT NULL
RETURN m
ORDER BY m.runtime ASC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
Which 3 movies have the most expensive poster paths registered?,"MATCH (m:Movie)
WHERE m.poster_path IS NOT NULL
RETURN m.title, m.poster_path
ORDER BY m.budget DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
Which 3 movies are most commonly spoken in 'Gaeilge'?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Gaeilge'})
RETURN m.title AS MovieTitle, m.id AS MovieID
ORDER BY m.popularity DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,False,
List the first 3 movies that have been translated into the language 'Kiswahili'.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Kiswahili'})
RETURN m
LIMIT 3",Pathfinding Queries,neoflix,False,False,True,
What are the top 5 movies that were produced by 'Pixar Animation Studios'?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN m
ORDER BY m.average_vote DESC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
List the top 3 movies that have been produced in the country 'United States of America'.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'United States of America'})
RETURN m
ORDER BY m.popularity DESC
LIMIT 3",Pathfinding Queries,neoflix,False,False,False,
What are the top 5 movies with a release date on or after '2000-01-01'?,"MATCH (m:Movie)
WHERE m.release_date >= date('2000-01-01')
RETURN m
ORDER BY m.release_date ASC
LIMIT 5",Pathfinding Queries,neoflix,False,False,True,
How many different types of software are running on machines in zone 4?,"MATCH (z:Zone {zone: 4})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(m:Machine)-[:RUNS]->(s:Software)
RETURN COUNT(DISTINCT s.name) AS NumberOfSoftwareTypes",Complex Retrieval Queries,network,False,False,True,
What are the previous versions of the software running on 'DC1-RCK-1-1-M-1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine {name: 'DC1-RCK-1-1-M-1'})
MATCH (machine)-[:RUNS]->(:Software)-[:VERSION]->(version:Version)
MATCH (version)-[:PREVIOUS*]->(previousVersion:Version)
RETURN previousVersion.name AS PreviousVersions",Complex Retrieval Queries,network,False,False,False,
Identify the top 3 processes by PID that depend on the 'java' service.,"MATCH (p:Process)-[:DEPENDS_ON]->(s:Service {name: 'java'})
RETURN p.name, p.pid
ORDER BY p.pid DESC
LIMIT 3",Complex Retrieval Queries,network,False,False,True,
Which machines are running services that started after timestamp 1606597376483?,"MATCH (m:Machine)-[:RUNS]->(s:Service)
WHERE s.startTime > 1606597376483
RETURN m",Complex Retrieval Queries,network,False,False,True,
Which interfaces connect networks in zone 2 with those in zone 3?,"MATCH (n1:Network {zone: 2})-[:ROUTES]->(i1:Interface),
      (n2:Network {zone: 3})-[:ROUTES]->(i2:Interface)
WHERE exists{(i1)-[:CONNECTS]-(i2)}
RETURN i1, i2",Complex Retrieval Queries,network,False,False,True,
List all the services and their start times on machines in rack 'DC1-RCK-1-10'.,"MATCH (r:Rack {name: 'DC1-RCK-1-10'})-[:HOLDS]->(m:Machine)-[:RUNS]->(s:Service)
RETURN s.name AS ServiceName, s.startTime AS StartTime",Complex Retrieval Queries,network,False,False,True,
Which applications are listening on ports greater than 1024?,"MATCH (app:Application)-[:LISTENS]->(p:Port)
WHERE p.port > 1024
RETURN app.name AS ApplicationName, p.port AS Port",Complex Retrieval Queries,network,False,False,True,
What are the dependencies for the process named '8966'?,"MATCH (p:Process {name: '8966'})
OPTIONAL MATCH (p)-[:DEPENDS_ON]->(s:Service)
OPTIONAL MATCH (p)-[:DEPENDS_ON]->(proc:Process)
RETURN p.name AS ProcessName, collect(s.name) AS DependentServices, collect(proc.name) AS DependentProcesses",Complex Retrieval Queries,network,False,False,True,
Which DataCenters contain the Router named 'DC1-RE'?,"MATCH (dc:DataCenter)-[:CONTAINS]->(r:Router {name: 'DC1-RE'})
RETURN dc",Simple Aggregation Queries,network,False,False,False,
List the first 3 Routers contained in DataCenter 'DC1'.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Router)
RETURN r
LIMIT 3",Simple Aggregation Queries,network,False,False,True,
What are the names of all Racks in zone 1 of DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack {zone: 1})
RETURN r.name",Simple Aggregation Queries,network,False,False,False,
List all types of machines that have a CPU count of at least 8.,"MATCH (t:Type)
WHERE t.cpu >= 8
RETURN t",Complex Retrieval Queries,network,False,False,True,
Identify the first 3 Interfaces connected by the Router named 'DC1-R-1'.,"MATCH (r:Router {name: 'DC1-R-1'})-[:ROUTES]->(i:Interface)
RETURN i
LIMIT 3",Simple Aggregation Queries,network,False,False,False,
List the software versions installed on machines that have type 'm'.,"MATCH (m:Machine)-[:TYPE]->(t:Type {type: 'm'})
MATCH (m)-[:RUNS]->(:OS)-[:INSTANCE]->(v:Version)
RETURN m.name AS MachineName, v.name AS SoftwareVersion",Complex Retrieval Queries,network,False,False,True,
Which applications are instances of software named 'RHEL' and run on machines in zone 1?,"MATCH (s:Software {name: 'RHEL'})-[:INSTANCE]->(app:Application)
MATCH (m:Machine)-[:RUNS]->(app)
WHERE m.zone = 1
RETURN app.name AS ApplicationName",Complex Retrieval Queries,network,False,False,False,Machine.zone
What is the total number of dependencies for the 'logstash' application?,"MATCH (app:Application {name: 'logstash'})-[:DEPENDS_ON*]->(dependency)
RETURN count(DISTINCT dependency) AS TotalDependencies",Complex Retrieval Queries,network,False,False,True,
Identify all machines with a disk size greater than 256 GB in zone 4.,"MATCH (m:Machine)-[:TYPE]->(t:Type)
WHERE t.disk > 256 AND m.zone = 4
RETURN m",Complex Retrieval Queries,network,False,False,True,Machine.zone
What are the IP addresses of Interfaces routed by Network '10.1'?,"MATCH (n:Network {ip: '10.1'})-[:ROUTES]->(i:Interface)
RETURN i.ip AS InterfaceIP",Simple Aggregation Queries,network,False,False,True,
Which services listen to port 443 and are instances of 'java'?,"MATCH (s:Service {name: 'java'})-[:LISTENS]->(p:Port {port: 443})
RETURN s",Complex Retrieval Queries,network,False,False,True,
How many machines are in the 'DC1' DataCenter's zone 2?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack {zone: 2})-[:HOLDS]->(m:Machine)
RETURN count(m) AS NumberOfMachinesInZone2",Complex Retrieval Queries,network,False,False,True,
What types of machines are in zone 3 and have more than 16 GB RAM?,"MATCH (z:Zone {zone: 3})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(m:Machine)-[:TYPE]->(t:Type)
WHERE t.ram > 16
RETURN DISTINCT t.type AS MachineType",Complex Retrieval Queries,network,False,False,True,
List the first 5 network IPs in zone 1.,"MATCH (n:Network {zone: 1})
RETURN n.ip
ORDER BY n.ip
LIMIT 5",Complex Retrieval Queries,network,False,False,True,
Which racks contain switches with IP starting with '10.1'?,"MATCH (r:Rack)-[:HOLDS]->(s:Switch)
WHERE s.ip STARTS WITH '10.1'
RETURN r.name AS RackName",Complex Retrieval Queries,network,False,False,False,
How many applications depend on the 'crm' service?,"MATCH (app:Application)-[:DEPENDS_ON]->(service:Service {name: 'crm'})
RETURN count(app) AS NumberOfApplications",Complex Retrieval Queries,network,False,False,False,
What are the IP addresses for switches in zone 2's rack 3?,"MATCH (z:Zone {zone: 2})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(s:Switch)
WHERE s.rack = 3
RETURN s.ip AS SwitchIP",Complex Retrieval Queries,network,False,False,False,
Identify machines that run an OS started at or after timestamp 1606165629748.,"MATCH (m:Machine)-[:RUNS]->(os:OS)
WHERE os.startTime >= 1606165629748
RETURN m",Complex Retrieval Queries,network,False,False,False,
List all machines that have a type 'xl' in the 'DC1' DataCenter.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack)-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type {type: 'xl'})
RETURN m.name AS MachineName",Complex Retrieval Queries,network,False,False,False,
Which ports are used by processes on the machine 'DC1-RCK-1-1-M-1'?,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(p:Process)-[:LISTENS]->(port:Port)
RETURN port.port AS UsedPorts",Complex Retrieval Queries,network,False,False,False,
What are the applications that depend on the 'webapp' software?,"MATCH (app:Application)-[:DEPENDS_ON]->(soft:Software {name: 'webapp'})
RETURN app.name AS ApplicationName",Complex Retrieval Queries,network,False,False,True,
Which services are instances of the 'cms' application?,"MATCH (app:Application {name: 'cms'})-[:INSTANCE]->(service:Service)
RETURN service",Complex Retrieval Queries,network,False,False,True,
List all processes that are instances of the 'RHEL' OS.,"MATCH (os:OS {name: 'RHEL'})-[:INSTANCE]->(process:Process)
RETURN process",Complex Retrieval Queries,network,False,False,True,
What are the start times for applications named 'webserver' in zone 3?,"MATCH (z:Zone {zone: 3})-[:ROUTES]->(i:Interface)-[:CONNECTS]->(m:Machine)-[:RUNS]->(a:Application {name: 'webserver'})
RETURN a.startTime AS ApplicationStartTime",Complex Retrieval Queries,network,False,False,False,
Which versions of software are dependencies for the 'webapp' application in zone 2?,"MATCH (app:Application {name: 'webapp'})-[:DEPENDS_ON]->(soft:Software)
WHERE exists {
    (app)-[:RUNS]->(mach:Machine)-[:ROUTES]->(int:Interface)-[:ROUTES]->(zone:Zone {zone: 2})
}
RETURN soft.name AS SoftwareName, soft.versions AS Versions",Complex Retrieval Queries,network,False,False,False,
What are the names of all services started on machines in zone 1?,"MATCH (z:Zone {zone: 1})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(m:Machine)-[:RUNS]->(s:Service)
RETURN s.name AS ServiceName",Complex Retrieval Queries,network,False,False,False,
Name the first 3 Machines held in Rack 'DC1-RCK-1-1'.,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)
RETURN m.name
LIMIT 3",Simple Aggregation Queries,network,False,False,False,
What are the IPs of Switches located in Rack 'DC1-RCK-1-1'?,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(s:Switch)
RETURN s.ip AS SwitchIP",Simple Aggregation Queries,network,False,False,True,
List all Switches in racks with zone 3.,"MATCH (r:Rack {zone: 3})-[:HOLDS]->(s:Switch)
RETURN s",Simple Aggregation Queries,network,False,False,True,
Which Machines are running OS named 'RHEL' in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(m:Machine)-[:RUNS]->(os:OS {name: 'RHEL'})
RETURN m",Simple Aggregation Queries,network,False,False,True,
List the first 3 Services instance of Application 'webapp'.,"MATCH (app:Application {name: 'webapp'})-[:INSTANCE]->(service:Service)
RETURN service
LIMIT 3",Simple Aggregation Queries,network,False,False,True,
Name the top 3 Applications that depend on Process '8966'.,"MATCH (p:Process {name: '8966'})<-[:DEPENDS_ON]-(a:Application)
RETURN a.name
ORDER BY a.startTime DESC
LIMIT 3",Simple Aggregation Queries,network,False,False,False,
What previous versions are linked to version '7.1'?,"MATCH (v:Version {name: '7.1'})-[:PREVIOUS*]->(prev:Version)
RETURN prev.name AS PreviousVersions",Complex Retrieval Queries,network,False,False,True,
List the first 3 Interfaces routed by Egress 'DC1-RE'.,"MATCH (e:Egress {name: 'DC1-RE'})-[:ROUTES]->(i:Interface)
RETURN i
LIMIT 3",Simple Aggregation Queries,network,False,False,True,
Which Racks are in zone 2 of DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack {zone: 2})
RETURN r",Simple Aggregation Queries,network,False,False,True,
Identify the top 3 Types of Machines in terms of RAM capacity in DataCenter 'DC1'.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack)-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN t.type AS MachineType, t.ram AS RAMCapacity
ORDER BY t.ram DESC
LIMIT 3",Simple Aggregation Queries,network,False,False,True,
What are the IP addresses of Interfaces connected by Router 'DC1-R-2'?,"MATCH (r:Router {name: 'DC1-R-2'})-[:ROUTES]->(i:Interface)
RETURN i.ip AS InterfaceIP",Simple Aggregation Queries,network,False,False,True,
Name the first 3 Machines that run version '7.1' of any Software.,"MATCH (m:Machine)-[:RUNS]->(:Software)-[:VERSION]->(v:Version {name: '7.1'})
RETURN m.name
LIMIT 3",Simple Aggregation Queries,network,False,False,True,
"What DataCenters are located in Iceland, Reykjavik?","MATCH (dc:DataCenter)
WHERE dc.location = 'Iceland, Rekjavik'
RETURN dc",Pathfinding Queries,network,False,False,True,
Which Routers are located in zone 1?,"MATCH (r:Router {zone: 1})
RETURN r",Pathfinding Queries,network,False,False,True,
List the first 3 Racks in zone 2.,"MATCH (r:Rack {zone: 2})
RETURN r
ORDER BY r.name
LIMIT 3",Pathfinding Queries,network,False,False,False,
What is the IP of the Interface connected to the Egress 'DC1-RE'?,"MATCH (e:Egress {name: 'DC1-RE'})-[:ROUTES]->(i:Interface)
RETURN i.ip AS InterfaceIP",Pathfinding Queries,network,False,False,False,
Which Network routes through the Interface with IP '10.4.8.254'?,"MATCH (n:Network)-[:ROUTES]->(i:Interface {ip: '10.4.8.254'})
RETURN n",Pathfinding Queries,network,False,False,True,
Name the top 5 Machines held in Rack 'DC1-RCK-1-1'.,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)
RETURN m.name
LIMIT 5",Pathfinding Queries,network,False,False,True,
Identify the first 3 Ports exposed by Interface with IP '10.1.1.1'.,"MATCH (i:Interface {ip: '10.1.1.1'})-[:EXPOSES]->(p:Port)
RETURN p
LIMIT 3",Simple Aggregation Queries,network,False,False,True,
Which type of Machines are located in Rack 'DC1-RCK-1-1'?,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN t.type AS MachineType",Simple Aggregation Queries,network,False,False,True,
What are the IPs of Interfaces connected to each other within zone 4?,"MATCH (i1:Interface)-[:CONNECTS]-(i2:Interface)
WHERE i1.zone = 4 AND i2.zone = 4
RETURN i1.ip AS Interface1_IP, i2.ip AS Interface2_IP",Simple Aggregation Queries,network,False,False,False,Interface.zone
Which Processes in DataCenter 'DC1' depend on the Process named '8966'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(p:Process)
WHERE exists {
    (p)-[:DEPENDS_ON]->(:Process {name: '8966'})
}
RETURN p",Simple Aggregation Queries,network,False,False,True,
What are the IPs of the top 3 Interfaces exposed to Port 80?,"MATCH (p:Port {port: 80})<-[:EXPOSES]-(i:Interface)
RETURN i.ip
ORDER BY i.ip
LIMIT 3",Simple Aggregation Queries,network,False,False,True,
Identify the first 3 Applications running on Machine 'DC1-RCK-1-1-M-1'.,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(app:Application)
RETURN app
LIMIT 3",Simple Aggregation Queries,network,False,False,True,
Which OS instances are running on the Machines in Rack 'DC1-RCK-1-1'?,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)-[:RUNS]->(os:OS)
RETURN os",Simple Aggregation Queries,network,False,False,False,
Name the first 3 Processes run by Machine 'DC1-RCK-1-1-M-1'.,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(p:Process)
RETURN p.name
LIMIT 3",Simple Aggregation Queries,network,False,False,False,
What are the dependencies of the Software 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(dependency)
RETURN s.name AS Software, dependency.name AS Dependency",Simple Aggregation Queries,network,False,False,False,
List the first 3 Services running on Machine 'DC1-RCK-1-1-M-1'.,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(s:Service)
RETURN s
LIMIT 3",Simple Aggregation Queries,network,False,False,True,
Which Applications listen on Port 8080?,"MATCH (p:Port {port: 8080})<-[:LISTENS]-(a:Application)
RETURN a.name AS ApplicationName",Simple Aggregation Queries,network,False,False,False,
Identify the first 3 Applications dependent on the Service 'java'.,"MATCH (s:Service {name: 'java'})<-[:DEPENDS_ON]-(a:Application)
RETURN a
LIMIT 3",Simple Aggregation Queries,network,False,False,True,
Which versions of Software 'RHEL' are currently used in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(m:Machine)-[:RUNS]->(os:OS)-[:INSTANCE]->(v:Version)
WHERE os.name = 'RHEL'
RETURN DISTINCT v.name AS Version",Simple Aggregation Queries,network,False,False,False,
Name the first 3 Software instances that depend on version '7.1'.,"MATCH (s:Software)-[:DEPENDS_ON]->(v:Version {name: '7.1'})
RETURN s.name
LIMIT 3",Simple Aggregation Queries,network,False,False,False,
What are the first 3 previous versions of Version '7.1'?,"MATCH (v:Version {name: '7.1'})-[:PREVIOUS*1..3]->(prev:Version)
RETURN prev.name
ORDER BY prev.name DESC
LIMIT 3",Simple Aggregation Queries,network,False,False,True,
List the top 5 processes dependent on Service 'java'.,"MATCH (s:Service {name: 'java'})<-[:DEPENDS_ON]-(p:Process)
RETURN p
LIMIT 5",Simple Aggregation Queries,network,False,False,True,
Which Machines in DataCenter 'DC1' are running an Application named 'webserver'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(m:Machine)-[:RUNS]->(app:Application {name: 'webserver'})
RETURN m",Simple Aggregation Queries,network,False,False,True,
Identify the first 3 Services listening on Port 443.,"MATCH (s:Service)-[:LISTENS]->(p:Port {port: 443})
RETURN s
LIMIT 3",Simple Aggregation Queries,network,False,False,True,
What are the first 3 Processes that listen on Port 25 and their start times?,"MATCH (p:Process)-[:LISTENS]->(port:Port {port: 25})
RETURN p.name, p.startTime
ORDER BY p.startTime
LIMIT 3",Simple Aggregation Queries,network,True,False,False,
List the top 3 Machines that route Interfaces to Network '10.4'.,"MATCH (m:Machine)-[:ROUTES]->(i:Interface)-[:ROUTES]->(n:Network {ip: '10.4'})
RETURN m.name, count{(m)-[:ROUTES]->(i)} AS routedInterfaces
ORDER BY routedInterfaces DESC
LIMIT 3",Simple Aggregation Queries,network,False,False,False,
List all software that depends on version '7.1'.,"MATCH (v:Version {name: '7.1'})<-[:VERSION]-(s:Software)
RETURN s.name AS SoftwareName",Complex Retrieval Queries,network,False,False,False,
What are the first 3 interfaces that connect to the network with IP '10.4'?,"MATCH (n:Network {ip: '10.4'})-[:ROUTES]->(i:Interface)
RETURN i
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
Which processes are running on machines that run the 'webserver' application?,"MATCH (m:Machine)-[:RUNS]->(:Application {name: 'webserver'}),
      (m)-[:RUNS]->(p:Process)
RETURN p",Complex Retrieval Queries,network,False,False,True,
What are the first 3 ports that the process with PID 8966 listens to?,"MATCH (p:Process {pid: 8966})-[:LISTENS]->(port:Port)
RETURN port.port
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Which 3 interfaces are connected to each other in zone 1?,"MATCH (i1:Interface)-[:CONNECTS]-(i2:Interface)-[:CONNECTS]-(i3:Interface)-[:CONNECTS]-(i1)
WHERE exists {
  (i1)-[:ROUTES]-(:Zone {zone: 1}) AND
  (i2)-[:ROUTES]-(:Zone {zone: 1}) AND
  (i3)-[:ROUTES]-(:Zone {zone: 1})
}
RETURN i1, i2, i3
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
List the first 3 machines that route to the interface with IP '10.1.1'.,"MATCH (m:Machine)-[:ROUTES]->(i:Interface {ip: '10.1.1'})
RETURN m
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
Which 3 applications are instances of the software 'webapp'?,"MATCH (s:Software {name: 'webapp'})-[:INSTANCE]->(a:Application)
RETURN a.name
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
What are the top 3 services that depend on the process named '8966'?,"MATCH (p:Process {name: '8966'})-[:DEPENDS_ON]->(s:Service)
RETURN s
ORDER BY s.startTime DESC
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
Name the first 3 types of machines in Rack 'DC1-RCK-1-1'.,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN t.name
ORDER BY t.id
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Which 3 machines in DataCenter 'DC1' are of type 'm-4/16/25'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack)-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type {name: 'm-4/16/25'})
RETURN m.name
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
What are the top 3 applications that depend on the process '8966'?,"MATCH (p:Process {name: '8966'})-[:DEPENDS_ON]->(app:Application)
RETURN app
ORDER BY app.startTime DESC
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
Which 3 machines run OS named 'RHEL' in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(m:Machine)-[:RUNS]->(os:OS {name: 'RHEL'})
RETURN m.name
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
What are the first 3 services running on machine 'DC1-RCK-1-1-M-1'?,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(s:Service)
RETURN s
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Which 3 racks in DataCenter 'DC1' contain switches of type 's-2/4/5'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(rack:Rack)-[:HOLDS]->(sw:Switch)
WHERE exists {
    (sw)-[:TYPE]->(t:Type {name: 's-2/4/5'})
}
RETURN rack.name
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
Name the first 3 interfaces that connect to the network with IP '10.2'.,"MATCH (n:Network {ip: '10.2'})-[:ROUTES]->(i:Interface)
RETURN i
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
What are the top 3 ports listened to by the process with PID 8966?,"MATCH (p:Process {pid: 8966})-[:LISTENS]->(port:Port)
RETURN port.port AS PortNumber
ORDER BY PortNumber DESC
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
List the first 3 previous versions of version '7.1'.,"MATCH (v:Version {name: '7.1'})-[:PREVIOUS*1..3]->(prev:Version)
RETURN prev.name
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
List the first 3 dependencies of the application 'webserver'.,"MATCH (app:Application {name: 'webserver'})-[:DEPENDS_ON]->(dependency)
RETURN dependency
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
List the first 3 processes dependent on the service named 'java'.,"MATCH (s:Service {name: 'java'})<-[:DEPENDS_ON]-(p:Process)
RETURN p
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
What are the top 3 applications running on machines in zone 4?,"MATCH (z:Zone {zone: 4})-[:ROUTES]->(i:Interface)-[:CONNECTS]->(mi:Interface)<-[:ROUTES]-(m:Machine)-[:RUNS]->(a:Application)
RETURN a.name, count(a) AS frequency
ORDER BY frequency DESC
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Name the first 3 interfaces exposed by Port 80.,"MATCH (p:Port {port: 80})-[:EXPOSES]->(i:Interface)
RETURN i
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
What are the names of the top 3 routers in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Router)
RETURN r.name
ORDER BY r.name
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
List the first 3 software dependencies for the software named 'RHEL'.,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(dep:Software)
RETURN dep.name
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
Which 3 machines are running the application named 'webserver' in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(a:Application {name: 'webserver'})
RETURN m.name
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
Name the first 3 types of machines held in Rack 'DC1-RCK-1-1'.,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN t.type
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
What are the top 5 IP addresses of interfaces connected to the router 'DC1-R-1'?,"MATCH (r:Router {name: 'DC1-R-1'})-[:ROUTES]->(i:Interface)
RETURN i.ip AS IPAddress
ORDER BY i.ip
LIMIT 5",Simple Retrieval Queries,network,False,False,False,
List the first 3 networks connected to the interface with IP '10.0.0.254'.,"MATCH (i:Interface {ip: '10.0.0.254'})-[:ROUTES]->(n:Network)
RETURN n
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Which 3 processes are running on the machine named 'DC1-RCK-1-1-M-1'?,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(p:Process)
RETURN p
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
What are the first 3 previous versions of the software named '7.1'?,"MATCH (v:Version {name: '7.1'})-[:PREVIOUS*1..3]->(prev:Version)
RETURN prev.name
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Which 3 versions of software does the OS named 'RHEL' have instances of?,"MATCH (os:OS {name: 'RHEL'})-[:INSTANCE]->(version:Version)
RETURN version.name
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
What are the top 3 ports listened to by the application 'webserver'?,"MATCH (app:Application {name: 'webserver'})-[:LISTENS]->(port:Port)
RETURN port.port AS PortNumber, count(port) AS Frequency
ORDER BY Frequency DESC
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Which 3 services are instances of the software 'RHEL'?,"MATCH (s:Service)-[:INSTANCE]->(soft:Software {name: 'RHEL'})
RETURN s.name
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
Name the first 3 applications that depend on the service named 'java'.,"MATCH (app:Application)-[:DEPENDS_ON]->(serv:Service {name: 'java'})
RETURN app.name
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
What are the top 3 zones by IP address in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(z:Zone)
RETURN z.ip AS ZoneIP
ORDER BY z.ip DESC
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
List the first 3 racks contained in DataCenter 'DC1'.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(rack:Rack)
RETURN rack
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Which 3 switches are held in Rack 'DC1-RCK-1-1'?,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(s:Switch)
RETURN s
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Which 3 applications are instances of the application 'crm'?,"MATCH (app:Application {name: 'crm'})-[:INSTANCE]->(instance:Application)
RETURN instance.name
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
What are the first 3 services that depend on the version '7.1'?,"MATCH (v:Version {name: '7.1'})<-[:INSTANCE]-(s:Service)
RETURN s
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Name the top 3 processes that are instances of the software 'RHEL'.,"MATCH (s:Software {name: 'RHEL'})-[:INSTANCE]->(p:Process)
RETURN p.name
ORDER BY p.startTime DESC
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
List the first 3 machines that run services in zone 2.,"MATCH (z:Zone {zone: 2})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(m:Machine)-[:RUNS]->(s:Service)
RETURN m.name, s.name
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
How many zones are there in the 'DC1' DataCenter?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(z:Zone)
RETURN count(z) AS NumberOfZones",Complex Retrieval Queries,network,False,False,True,
What are the IP addresses for interfaces connected to 'DC1-R-1' router?,"MATCH (r:Router {name: 'DC1-R-1'})-[:ROUTES]->(i:Interface)
RETURN i.ip AS InterfaceIP",Complex Retrieval Queries,network,False,False,True,
Which ports are exposed by the interface with IP '10.0.0.254'?,"MATCH (i:Interface {ip: '10.0.0.254'})-[:EXPOSES]->(p:Port)
RETURN p.port",Complex Retrieval Queries,network,False,False,False,
Name the routers that are in zone 1 within 'DC1' DataCenter.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Router {zone: 1})
RETURN r.name",Complex Retrieval Queries,network,False,False,True,
Which egress routers are available in the 'DC1' DataCenter?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(e:Egress)
RETURN e.name AS EgressRouterName",Complex Retrieval Queries,network,False,False,True,
List all racks contained within the 'DC1' DataCenter.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(rack:Rack)
RETURN rack",Complex Retrieval Queries,network,False,False,True,
Which type of machines are held in rack 'DC1-RCK-1-1'?,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN t.name AS MachineType",Complex Retrieval Queries,network,False,False,True,
What software versions are available for 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)
RETURN v.name AS Version",Complex Retrieval Queries,network,False,False,True,
What are the dependencies for the software named 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(dependency)
RETURN s.name AS Software, dependency.name AS Dependency",Complex Retrieval Queries,network,False,False,True,
Which applications are running on the machine named 'DC1-RCK-1-1-M-1'?,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(app:Application)
RETURN app.name AS ApplicationName",Complex Retrieval Queries,network,False,False,True,
List the services running on machines in rack 'DC1-RCK-1-10'.,"MATCH (r:Rack {name: 'DC1-RCK-1-10'})-[:HOLDS]->(m:Machine)-[:RUNS]->(s:Service)
RETURN s.name AS ServiceName, s.startTime AS StartTime, s.pid AS PID",Complex Retrieval Queries,network,False,False,False,
Which switches are located in rack with name 'DC1-RCK-2-3'?,"MATCH (r:Rack {name: 'DC1-RCK-2-3'})-[:HOLDS]->(s:Switch)
RETURN s",Complex Retrieval Queries,network,False,False,True,
How many interfaces are connected to the network with IP '10.3'?,"MATCH (n:Network {ip: '10.3'})-[:ROUTES]->(i:Interface)
RETURN count(i) AS NumberOfInterfacesConnectedToNetwork",Complex Retrieval Queries,network,False,False,False,
What are the IP addresses of zones in zone 4?,"MATCH (z:Zone {zone: 4})
RETURN z.ip AS IPAddress",Complex Retrieval Queries,network,False,False,False,
Identify all applications that listen on port 80.,"MATCH (app:Application)-[:LISTENS]->(p:Port {port: 80})
RETURN app",Complex Retrieval Queries,network,False,False,True,
List the routers in 'DC1' DataCenter.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Router)
RETURN r.name",Complex Retrieval Queries,network,False,False,True,
What operating systems are installed on machines in zone 3?,"MATCH (z:Zone {zone: 3})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(m:Machine)-[:RUNS]->(os:OS)
RETURN DISTINCT os.name AS OperatingSystem",Complex Retrieval Queries,network,False,False,False,
"What are the names of all DataCenters located in 'Iceland, Rekjavik'?","MATCH (dc:DataCenter {location: 'Iceland, Rekjavik'})
RETURN dc.name",Complex Retrieval Queries,network,False,False,False,
Which 3 applications are instances of the software 'webapp'?,"MATCH (s:Software {name: 'webapp'})-[:INSTANCE]->(a:Application)
RETURN a.name
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Which 3 ports are exposed by interfaces in zone 3?,"MATCH (z:Zone {zone: 3})-[:ROUTES]->(i:Interface)-[:EXPOSES]->(p:Port)
RETURN p.port
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
What are the first 3 racks that hold machines of type 'xl-16/256/625'?,"MATCH (r:Rack)-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type {name: 'xl-16/256/625'})
RETURN r.name
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Which 3 services listen to port 80 in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(:Machine)-[:RUNS]->(s:Service)-[:LISTENS]->(p:Port {port: 80})
RETURN s.name
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Name the first 3 ports connected to the interface with IP '10.1.0.254'.,"MATCH (i:Interface {ip: '10.1.0.254'})-[:EXPOSES]->(p:Port)
RETURN p.port
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
What are the top 3 types of software required by the application 'logstash'?,"MATCH (app:Application {name: 'logstash'})-[:DEPENDS_ON]->(soft:Software)
RETURN soft.name AS SoftwareName, count(soft) AS DependencyCount
ORDER BY DependencyCount DESC
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
List the first 3 dependencies of the service named 'java'.,"MATCH (s:Service {name: 'java'})-[:INSTANCE]->(dep:Service)
RETURN dep.name
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
Which 3 machines in DataCenter 'DC1' are connected to the interface with IP '10.3'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(m:Machine)-[:ROUTES]->(i:Interface {ip: '10.3'})
RETURN m
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
What are the first 3 applications that depend on the service 'java'?,"MATCH (app:Application)-[:DEPENDS_ON]->(serv:Service {name: 'java'})
RETURN app
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
Name the top 3 processes that depend on the version '7.1'.,"MATCH (v:Version {name: '7.1'})<-[:INSTANCE]-(p:Process)
RETURN p.name, count(p) AS dependency_count
ORDER BY dependency_count DESC
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
List the first 3 previous versions that the version '7.1' depends on.,"MATCH (v:Version {name: '7.1'})-[:PREVIOUS*1..3]->(previous:Version)
RETURN previous
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
Which 3 types of machines are held in the racks of zone 2?,"MATCH (z:Zone {zone: 2})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(r:Rack)-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN DISTINCT t.type
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Which 3 racks in DataCenter 'DC1' contain switches of type 'm-4/16/25'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(rack:Rack)-[:HOLDS]->(sw:Switch)
WHERE exists {
    (sw)-[:TYPE]->(t:Type {name: 'm-4/16/25'})
}
RETURN rack.name
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Name the first 3 processes that are instances of the application 'cms'.,"MATCH (app:Application {name: 'cms'})-[:INSTANCE]->(proc:Process)
RETURN proc.name
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
What are the top 3 services that depend on the application 'webapp'?,"MATCH (app:Application {name: 'webapp'})<-[:DEPENDS_ON]-(service:Service)
RETURN service
ORDER BY service.startTime DESC
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
List the first 3 ports listened to by the service named 'java'.,"MATCH (s:Service {name: 'java'})-[:LISTENS]->(p:Port)
RETURN p.port
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
What are the first 3 processes that are instances of the process '8966'?,"MATCH (p:Process {name: '8966'})-[:INSTANCE*1..3]->(related:Process)
RETURN related
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Name the top 3 egress routes from DataCenter 'DC1'.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(e:Egress)-[:ROUTES]->(i:Interface)
RETURN e.name, i.ip
ORDER BY i.ip
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Which Applications are running on the Machine named 'DC1-RCK-1-1-M-1'?,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(app:Application)
RETURN app",Pathfinding Queries,network,False,False,True,
What Software versions are available for 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)
RETURN v.name AS Version",Pathfinding Queries,network,False,False,True,
List all processes that have a PID greater than 5000.,"MATCH (p:Process)
WHERE p.pid > 5000
RETURN p",Simple Aggregation Queries,network,False,False,False,
Which applications are dependent on the service named java?,"MATCH (app:Application)-[:DEPENDS_ON]->(svc:Service {name: 'java'})
RETURN app.name AS ApplicationName",Simple Aggregation Queries,network,False,False,False,
Identify the top 3 largest disks by capacity in the DataCenter DC1.,"MATCH (dc:DataCenter {name: ""DC1""})-[:CONTAINS]->(r:Rack)-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN t.name AS TypeName, t.disk AS DiskCapacity
ORDER BY t.disk DESC
LIMIT 3",Simple Aggregation Queries,network,False,False,False,
List all network IPs in zone 2.,"MATCH (n:Network {zone: 2})
RETURN n.ip AS NetworkIP",Simple Aggregation Queries,network,False,False,False,
What is the maximum RAM capacity of types available in DataCenter DC1?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN MAX(t.ram) AS maxRAM",Simple Aggregation Queries,network,False,False,True,
Find all services that listen on port 80.,"MATCH (s:Service)-[:LISTENS]->(p:Port {port: 80})
RETURN s",Simple Aggregation Queries,network,False,False,False,
Which version of software is installed on OS named RHEL?,"MATCH (os:OS {name: 'RHEL'})-[:RUNS]->(machine:Machine)-[:RUNS]->(software:Software)
MATCH (software)-[:VERSION]->(version:Version)
RETURN software.name AS SoftwareName, version.name AS VersionName",Simple Aggregation Queries,network,False,False,True,
What are the dependencies of the software named RHEL?,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(dependency)
RETURN s.name AS Software, dependency.name AS Dependency",Simple Aggregation Queries,network,False,False,True,
List all processes run by the application named webserver.,"MATCH (app:Application {name: 'webserver'})-[:RUNS]->(proc:Process)
RETURN proc",Simple Aggregation Queries,network,False,False,True,
Which services are started by machines in the DataCenter named DC1?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(m:Machine)-[:RUNS]->(s:Service)
RETURN s.name AS ServiceName, s.startTime AS StartTime, s.pid AS ProcessID",Simple Aggregation Queries,network,False,False,True,
Identify the applications running on machine named DC1-RCK-1-1-M-1.,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(app:Application)
RETURN app.name AS ApplicationName",Simple Aggregation Queries,network,False,False,True,
Which ports are exposed by the interface with IP 10.0.0.254?,"MATCH (i:Interface {ip: ""10.0.0.254""})-[:EXPOSES]->(p:Port)
RETURN p.port",Simple Aggregation Queries,network,False,False,True,
What are the IP addresses of switches located in rack number 5?,"MATCH (r:Rack {rack: 5})-[:HOLDS]->(s:Switch)
RETURN s.ip AS SwitchIP",Simple Aggregation Queries,network,False,False,True,
How many different software versions are available for the software named RHEL?,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)
RETURN count(DISTINCT v) AS NumberOfVersions",Simple Aggregation Queries,network,False,False,True,
List all switches in rack 1.,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(s:Switch)
RETURN s",Simple Aggregation Queries,network,False,False,True,
Which racks contain machines in zone 2?,"MATCH (r:Rack)-[:HOLDS]->(m:Machine)
WHERE r.zone = 2
RETURN r.name, collect(m.name) AS machines",Simple Aggregation Queries,network,False,False,True,
What are the first 3 egress names in the DataCenter DC1?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(e:Egress)
RETURN e.name
LIMIT 3",Simple Aggregation Queries,network,False,False,True,
Identify the top 5 networks by size within zone 3.,"MATCH (n:Network {zone: 3})
RETURN n.ip, n.size
ORDER BY n.size DESC
LIMIT 5",Simple Aggregation Queries,network,False,False,False,
Which interfaces connect to the router named DC1-R-2?,"MATCH (r:Router {name: 'DC1-R-2'})-[:ROUTES]->(i:Interface)
RETURN i",Simple Aggregation Queries,network,False,False,True,
How many racks are there in zone 4 of the DataCenter named DC1?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack {zone: 4})
RETURN count(r) AS NumberOfRacksInZone4",Simple Aggregation Queries,network,False,False,True,
List all routers in zone 1.,"MATCH (r:Router {zone: 1})
RETURN r",Simple Aggregation Queries,network,False,False,True,
"What are the names of all DataCenters located in Iceland, Rekjavik?","MATCH (dc:DataCenter)
WHERE dc.location = 'Iceland, Rekjavik'
RETURN dc.name",Simple Aggregation Queries,network,False,False,False,
List the first 5 dependencies of the software 'logstash'.,"MATCH (s:Software {name: 'logstash'})-[:DEPENDS_ON]->(dependency)
RETURN dependency
LIMIT 5",Complex Retrieval Queries,network,False,False,True,
Which machines are running applications that depend on the process '8966'?,"MATCH (m:Machine)-[:RUNS]->(app:Application)-[:DEPENDS_ON]->(proc:Process {name: '8966'})
RETURN m",Complex Retrieval Queries,network,False,False,True,
List all racks containing machines of type 'xxl'.,"MATCH (r:Rack)-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type {type: 'xxl'})
RETURN r AS Rack",Complex Retrieval Queries,network,False,False,True,
What are the first 5 routers located in zone 2?,"MATCH (r:Router {zone: 2})
RETURN r
LIMIT 5",Complex Retrieval Queries,network,False,False,True,
What are the different types of machines that can run in a rack located in zone 4?,"MATCH (r:Rack {zone: 4})-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN DISTINCT t.type AS MachineType",Simple Aggregation Queries,network,False,False,True,
Identify the first 3 processes running on machine 'DC1-RCK-1-1-M-1' with a PID less than 5000.,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(p:Process)
WHERE p.pid < 5000
RETURN p
LIMIT 3",Complex Retrieval Queries,network,False,False,True,
Which machines are type 'm' in DataCenter DC1?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack)-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type {type: 'm'})
RETURN m.name AS MachineName",Simple Aggregation Queries,network,False,False,True,
How many routers are there in DataCenter DC1?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Router)
RETURN count(r) AS NumberOfRouters",Simple Aggregation Queries,network,False,False,True,
Identify all software versions available for 'RHEL'.,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)
RETURN v.name AS Version",Pathfinding Queries,network,False,False,False,
Which machines are held in rack 'DC1-RCK-4-9'?,"MATCH (r:Rack {name: 'DC1-RCK-4-9'})-[:HOLDS]->(m:Machine)
RETURN m",Pathfinding Queries,network,False,False,True,
List all racks in zone 4 of DataCenter 'DC1'.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack {zone: 4})
RETURN r",Pathfinding Queries,network,False,False,True,
Which DataCenter contains the router named 'DC1-R-2'?,"MATCH (dc:DataCenter)-[:CONTAINS]->(r:Router {name: 'DC1-R-2'})
RETURN dc.name",Pathfinding Queries,network,False,False,False,
What are the names of routers located in zone 2?,"MATCH (r:Router {zone: 2})
RETURN r.name",Pathfinding Queries,network,False,False,True,
Which ports do the applications named webapp listen to?,"MATCH (app:Application {name: 'webapp'})-[:LISTENS]->(port:Port)
RETURN app.name AS Application, port.port AS Port",Simple Aggregation Queries,network,False,False,True,
List the first 5 applications that depend on the process named 7.1.,"MATCH (p:Process {name: '7.1'})-[:DEPENDS_ON]->(app:Application)
RETURN app
LIMIT 5",Simple Aggregation Queries,network,False,False,True,
Identify all services that started after timestamp 1606165629748.,"MATCH (s:Service)
WHERE s.startTime > 1606165629748
RETURN s",Simple Aggregation Queries,network,False,False,True,
Which processes are instances of the version named 7.1?,"MATCH (v:Version {name: '7.1'})<-[:INSTANCE]-(p:Process)
RETURN p",Simple Aggregation Queries,network,False,False,True,
What are the dependencies of the version named 7.1?,"MATCH (v:Version {name: '7.1'})-[:DEPENDS_ON]->(dependency)
RETURN v.name AS Version, dependency.name AS Dependency",Simple Aggregation Queries,network,False,False,False,
How many applications are dependent on the service named java?,"MATCH (s:Service {name: 'java'})<-[:DEPENDS_ON]-(a:Application)
RETURN count(a) AS NumberOfDependentApplications",Simple Aggregation Queries,network,False,False,False,
Which routers connect to interfaces with IP addresses in the 10.2 range?,"MATCH (r:Router)-[:ROUTES]->(i:Interface)
WHERE i.ip STARTS WITH '10.2'
RETURN r.name AS RouterName, i.ip AS InterfaceIP",Simple Aggregation Queries,network,False,False,True,
What are the names of all applications that run on machine DC1-RCK-4-9-M-103?,"MATCH (m:Machine {name: 'DC1-RCK-4-9-M-103'})-[:RUNS]->(a:Application)
RETURN a.name",Simple Aggregation Queries,network,False,False,True,
List all the types of applications running in zone 3 of DataCenter DC1.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack {zone: 3})-[:HOLDS]->(m:Machine)-[:RUNS]->(app:Application)
RETURN DISTINCT app.name AS ApplicationType",Simple Aggregation Queries,network,False,False,True,
How many machines are there in rack 10 of DataCenter DC1?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack {rack: 10})
RETURN count{(r)-[:HOLDS]->(:Machine)} AS MachineCount",Simple Aggregation Queries,network,False,False,True,
List all the dependencies of the process named 7.1.,"MATCH (p:Process {name: '7.1'})-[:DEPENDS_ON*]->(dependency)
RETURN p.name AS ProcessName, collect(dependency.name) AS Dependencies",Simple Aggregation Queries,network,False,False,True,
Which machines run the OS starting with 'RHE'?,"MATCH (m:Machine)-[:RUNS]->(os:OS)
WHERE os.name STARTS WITH 'RHE'
RETURN m",Simple Aggregation Queries,network,False,False,False,
Identify the racks that hold switches with IP starting with '10.1'.,"MATCH (r:Rack)-[:HOLDS]->(s:Switch)
WHERE s.ip STARTS WITH '10.1'
RETURN r",Simple Aggregation Queries,network,False,False,True,
What are the start times of applications named cms?,"MATCH (a:Application {name: 'cms'})
RETURN a.startTime",Simple Aggregation Queries,network,False,False,False,
How many different versions are there for the application named crm?,"MATCH (app:Application {name: 'crm'})-[:INSTANCE]->(soft:Software)-[:VERSION]->(ver:Version)
RETURN COUNT(DISTINCT ver) AS NumberOfVersions",Simple Aggregation Queries,network,False,False,True,
Which applications listen on port 443?,"MATCH (app:Application)-[:LISTENS]->(p:Port {port: 443})
RETURN app.name",Simple Aggregation Queries,network,False,False,True,
What are the previous versions of version 7.1 in the software dependency chain?,"MATCH path=(v:Version {name: '7.1'})<-[:PREVIOUS*]-(previous:Version)
RETURN previous.name AS PreviousVersions",Simple Aggregation Queries,network,False,False,False,
List all services that depend on the process named 7.1.,"MATCH (p:Process {name: '7.1'})-[:DEPENDS_ON]->(s:Service)
RETURN s",Simple Aggregation Queries,network,False,False,False,
How many types of machines have a CPU greater than 16?,"MATCH (t:Type)
WHERE t.cpu > 16
RETURN count(t) AS NumberOfTypes",Simple Aggregation Queries,network,False,False,False,
Which ports are used by the service named java in DataCenter DC1?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(s:Service {name: 'java'})
MATCH (s)-[:LISTENS]->(p:Port)
RETURN p.port",Simple Aggregation Queries,network,False,False,True,
What are the IP addresses of interfaces connected to the network with IP 10.2?,"MATCH (n:Network {ip: '10.2'})-[:ROUTES]->(i:Interface)
RETURN i.ip AS InterfaceIP",Simple Aggregation Queries,network,False,False,True,
What are the start times of services run by machine DC1-RCK-4-9-M-103?,"MATCH (m:Machine {name: ""DC1-RCK-4-9-M-103""})-[:RUNS]->(s:Service)
RETURN s.startTime AS ServiceStartTime",Simple Aggregation Queries,network,False,False,True,
List the first 3 services that started before timestamp 1606597376483 and are running on a machine in zone 4.,"MATCH (m:Machine)-[:RUNS]->(s:Service)
WHERE s.startTime < 1606597376483
AND exists {
  MATCH (m)-[:HOLDS]->(r:Rack {zone: 4})
}
RETURN s
ORDER BY s.startTime
LIMIT 3",Complex Retrieval Queries,network,False,False,True,
Which routers are connected to networks with IP '10.4'?,"MATCH (r:Router)-[:ROUTES]->(i:Interface)-[:CONNECTS]->(i2:Interface)<-[:ROUTES]-(n:Network {ip: '10.4'})
RETURN r.name AS RouterName",Complex Retrieval Queries,network,False,False,False,
List the first 5 services that depend on the software 'RHEL'.,"MATCH (s:Service)-[:INSTANCE]->(:Software {name: 'RHEL'})
RETURN s
LIMIT 5",Complex Retrieval Queries,network,False,False,False,
List the first 5 applications that were started after timestamp 1606165629748.,"MATCH (a:Application)
WHERE a.startTime > 1606165629748
RETURN a
ORDER BY a.startTime ASC
LIMIT 5",Complex Retrieval Queries,network,False,False,True,
Identify the first 3 networks with a zone of 4 that route through any interface.,"MATCH (n:Network {zone: 4})-[:ROUTES]->(i:Interface)
RETURN n, i
LIMIT 3",Complex Retrieval Queries,network,False,False,False,
How many different types of switches are held in rack 'DC1-RCK-1-1'?,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(s:Switch)
RETURN COUNT(DISTINCT s.ip) AS distinctSwitchTypes",Complex Retrieval Queries,network,False,False,True,
Which applications have dependencies on the service 'java'?,"MATCH (app:Application)-[:DEPENDS_ON]->(serv:Service {name: 'java'})
RETURN app.name AS ApplicationName",Complex Retrieval Queries,network,False,False,True,
List the first 5 machines connected to the network with IP '10.2'.,"MATCH (n:Network {ip: '10.2'})-[:ROUTES]->(i:Interface)-[:CONNECTS]->(m:Machine)
RETURN m
LIMIT 5",Complex Retrieval Queries,network,False,False,True,
What are the first 3 services running on the OS 'RHEL'?,"MATCH (os:OS {name: 'RHEL'})-[:RUNS]->(service:Service)
RETURN service
LIMIT 3",Complex Retrieval Queries,network,False,False,True,
Identify the first 5 racks that hold machines of type 'm'.,"MATCH (r:Rack)-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type {type: 'm'})
RETURN r
LIMIT 5",Complex Retrieval Queries,network,False,False,True,
List the first 3 processes that have a PID greater than 5000 and are running on a machine in zone 1.,"MATCH (m:Machine)-[:RUNS]->(p:Process)
WHERE p.pid > 5000 AND m.zone = 1
RETURN p
LIMIT 3",Complex Retrieval Queries,network,False,False,False,Machine.zone
Which applications are listening on ports higher than 1024?,"MATCH (app:Application)-[:LISTENS]->(p:Port)
WHERE p.port > 1024
RETURN app.name AS ApplicationName, p.port AS Port",Complex Retrieval Queries,network,False,False,False,
What are the first 3 versions of the OS running on machine 'DC1-RCK-1-1-M-1'?,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(os:OS)-[:INSTANCE]->(v:Version)
RETURN v.name
ORDER BY v.startTime
LIMIT 3",Complex Retrieval Queries,network,False,False,False,Version.startTime
How many machines run the service 'java' in the DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(s:Service {name: 'java'})
RETURN count(m) AS NumberOfMachinesRunningJava",Complex Retrieval Queries,network,False,False,True,
List all the software dependencies for the application 'crm'.,"MATCH (app:Application {name: 'crm'})-[:DEPENDS_ON*]->(dependency)
RETURN dependency.name AS SoftwareDependency",Complex Retrieval Queries,network,False,False,True,
Which routers route through interface with IP '10.1.0.254'?,"MATCH (r:Router)-[:ROUTES]->(i:Interface {ip: '10.1.0.254'})
RETURN r.name AS RouterName",Complex Retrieval Queries,network,False,False,False,
What are the first 3 types of machines available in zone 3?,"MATCH (z:Zone {zone: 3})-[:ROUTES]->(i:Interface)-[:CONNECTS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN t.type
LIMIT 3",Complex Retrieval Queries,network,False,False,True,
What are the first 5 services that started before timestamp 1606597376483 and are running on a machine in zone 3?,"MATCH (m:Machine)-[:RUNS]->(s:Service)
WHERE s.startTime < 1606597376483 AND exists {
  MATCH (m)-[:HOLDS]->(r:Rack {zone: 3})
}
RETURN s
LIMIT 5",Complex Retrieval Queries,network,False,False,False,
List the first 5 applications that depend on the process '8966'.,"MATCH (p:Process {name: '8966'})-[:DEPENDS_ON]->(a:Application)
RETURN a
LIMIT 5",Complex Retrieval Queries,network,False,False,True,
How many interfaces are connected to router 'DC1-R-3'?,"MATCH (r:Router {name: 'DC1-R-3'})-[:ROUTES]->(i:Interface)
RETURN count(i) AS NumberOfInterfaces",Complex Retrieval Queries,network,False,False,True,
Identify the first 3 machines that are of type 'xl'.,"MATCH (m:Machine)-[:TYPE]->(t:Type {type: 'xl'})
RETURN m
LIMIT 3",Complex Retrieval Queries,network,False,False,False,
What are the first 5 previous versions of version '7.1'?,"MATCH (v:Version {name: '7.1'})-[:PREVIOUS*1..5]->(prev:Version)
RETURN prev.name
LIMIT 5",Complex Retrieval Queries,network,False,False,True,
List the first 3 services listening on port 80.,"MATCH (s:Service)-[:LISTENS]->(p:Port {port: 80})
RETURN s
LIMIT 3",Complex Retrieval Queries,network,False,False,True,
What are the first 5 applications running on OS 'RHEL'?,"MATCH (os:OS {name: 'RHEL'})-[:RUNS]->(m:Machine)-[:RUNS]->(app:Application)
RETURN app
LIMIT 5",Complex Retrieval Queries,network,False,False,True,
How many switches are connected to interfaces in zone 2?,"MATCH (z:Zone {zone: 2})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(s:Switch)
RETURN count(DISTINCT s) AS NumberOfSwitchesConnectedToZone2",Complex Retrieval Queries,network,False,False,True,
List the first 5 processes that depend on the service 'java'.,"MATCH (s:Service {name: 'java'})<-[:DEPENDS_ON]-(p:Process)
RETURN p
LIMIT 5",Complex Retrieval Queries,network,False,False,False,
What are the top 3 software versions that the software 'RHEL' depends on?,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(v:Version)
RETURN v.name AS VersionName, count(v) AS DependencyCount
ORDER BY DependencyCount DESC
LIMIT 3",Complex Retrieval Queries,network,False,False,True,
Identify the top 3 racks in zone 4.,"MATCH (dc:DataCenter)-[:CONTAINS]->(rack:Rack {zone: 4})
RETURN rack
ORDER BY rack.name
LIMIT 3",Complex Retrieval Queries,network,False,False,False,
List the first 5 dependencies of the application 'webapp'.,"MATCH (app:Application {name: 'webapp'})-[:DEPENDS_ON]->(dependency)
RETURN dependency
LIMIT 5",Complex Retrieval Queries,network,False,False,True,
Identify the first 3 applications with a PID less than 2000.,"MATCH (a:Application)
WHERE a.pid < 2000
RETURN a
ORDER BY a.pid
LIMIT 3",Complex Retrieval Queries,network,False,False,True,
What are the first 3 types of machines located in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack)-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN t.type
LIMIT 3",Complex Retrieval Queries,network,False,False,True,
List all machines that run applications dependent on 'crm'.,"MATCH (m:Machine)-[:RUNS]->(app:Application)-[:DEPENDS_ON]->(depApp:Application {name: 'crm'})
RETURN m",Complex Retrieval Queries,network,False,False,False,
How many applications are running on machines in zone 2?,"MATCH (z:Zone {zone: 2})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(m:Machine)-[:RUNS]->(a:Application)
RETURN count(DISTINCT a) AS NumberOfApplications",Complex Retrieval Queries,network,False,False,True,
Identify the first 3 racks that hold at least two types of switches.,"MATCH (r:Rack)-[:HOLDS]->(s:Switch)
WITH r, count(DISTINCT s.ip) AS switchCount
WHERE switchCount >= 2
RETURN r.name
LIMIT 3",Complex Retrieval Queries,network,False,False,False,
What are the first 5 applications that are instances of the application 'webapp'?,"MATCH (app:Application {name: 'webapp'})-[:INSTANCE]->(instance:Application)
RETURN instance
LIMIT 5",Complex Retrieval Queries,network,False,False,False,
List the first 3 processes that depend on the version '7.1'.,"MATCH (v:Version {name: '7.1'})<-[:INSTANCE]-(p:Process)
RETURN p
LIMIT 3",Complex Retrieval Queries,network,False,False,False,
Which DataCenter has the most types of routers?,"MATCH (dc:DataCenter)-[:CONTAINS]->(r:Router)
WITH dc, count(DISTINCT r.name) AS routerTypes
RETURN dc.name AS DataCenter, routerTypes
ORDER BY routerTypes DESC
LIMIT 1",Complex Retrieval Queries,network,False,False,False,
Identify the first 5 machines that run the OS 'RHEL' and have a type with RAM greater than 256.,"MATCH (m:Machine)-[:RUNS]->(os:OS {name: 'RHEL'}),
      (m)-[:TYPE]->(t:Type)
WHERE t.ram > 256
RETURN m
LIMIT 5",Complex Retrieval Queries,network,False,False,True,
List the first 3 switches that route through interfaces with an IP starting with '10.3'.,"MATCH (s:Switch)-[:ROUTES]->(i:Interface)
WHERE i.ip STARTS WITH '10.3'
RETURN s
LIMIT 3",Complex Retrieval Queries,network,False,False,True,
What are the first 5 applications that depend on the service 'logstash'?,"MATCH (app:Application)-[:DEPENDS_ON]->(service:Service {name: 'logstash'})
RETURN app
LIMIT 5",Complex Retrieval Queries,network,False,False,True,
Identify the top 3 routers that route through interfaces in zone 3.,"MATCH (r:Router)-[:ROUTES]->(i:Interface)<-[:ROUTES]-(z:Zone {zone: 3})
WITH r, count(i) AS interfacesCount
ORDER BY interfacesCount DESC
LIMIT 3
RETURN r.name, interfacesCount",Complex Retrieval Queries,network,False,False,False,
List the first 5 dependencies of the version '7.1'.,"MATCH (v:Version {name: '7.1'})-[:DEPENDS_ON]->(dependency)
RETURN dependency
LIMIT 5",Complex Retrieval Queries,network,False,False,True,
What are the first 3 services that depend on the process '8966'?,"MATCH (p:Process {name: '8966'})-[:DEPENDS_ON]->(s:Service)
RETURN s
LIMIT 3",Complex Retrieval Queries,network,False,False,True,
List all machines that run processes with a PID less than 500.,"MATCH (m:Machine)-[:RUNS]->(p:Process)
WHERE p.pid < 500
RETURN m",Complex Retrieval Queries,network,False,False,True,
Which racks are in zone 1 and hold machines of type 'l'?,"MATCH (r:Rack {zone: 1})-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type {type: 'l'})
RETURN r.name AS RackName",Complex Retrieval Queries,network,False,False,True,
List the first 5 processes that are instances of the version '7.1'.,"MATCH (v:Version {name: '7.1'})<-[:INSTANCE]-(p:Process)
RETURN p
LIMIT 5",Complex Retrieval Queries,network,False,False,False,
Identify the first 3 applications that are instances of the software 'RHEL'.,"MATCH (s:Software {name: 'RHEL'})-[:INSTANCE]->(a:Application)
RETURN a
LIMIT 3",Complex Retrieval Queries,network,False,False,False,
Display the top 5 services that started after timestamp 1606165629748 and are running on machine 'DC1-RCK-1-1-M-1'.,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(s:Service)
WHERE s.startTime > 1606165629748
RETURN s
ORDER BY s.startTime DESC
LIMIT 5",Complex Retrieval Queries,network,False,False,False,
What are the first 3 racks that hold switches with an IP starting with '10.1'?,"MATCH (r:Rack)-[:HOLDS]->(s:Switch)
WHERE s.ip STARTS WITH '10.1'
RETURN r.name
LIMIT 3",Complex Retrieval Queries,network,False,False,True,
List the first 3 ports exposed by machines in rack 'DC1-RCK-1-1'.,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)-[:ROUTES]->(i:Interface)-[:EXPOSES]->(p:Port)
RETURN p.port
LIMIT 3",Complex Retrieval Queries,network,False,False,False,
How many machines in DataCenter 'DC1' are running the application 'webserver'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(a:Application {name: 'webserver'})
RETURN count(m) AS NumberOfMachinesRunningWebserver",Complex Retrieval Queries,network,False,False,False,
Which applications are instances of software 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:INSTANCE]->(a:Application)
RETURN a.name AS ApplicationName",Complex Retrieval Queries,network,False,False,True,
List the first 5 previous versions that the version '7.1' depends on.,"MATCH (v:Version {name: '7.1'})-[:PREVIOUS*1..5]->(prev:Version)
RETURN prev
LIMIT 5",Complex Retrieval Queries,network,False,False,False,
Identify the first 3 services that depend on the version '7.1'.,"MATCH (v:Version {name: '7.1'})<-[:INSTANCE]-(s:Service)
RETURN s
LIMIT 3",Complex Retrieval Queries,network,False,False,False,
What are the first 5 services that a machine in rack 'DC1-RCK-1-1' can run?,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)-[:RUNS]->(s:Service)
RETURN s
LIMIT 5",Complex Retrieval Queries,network,False,False,True,
List the first 3 processes that depend on the application 'webapp'.,"MATCH (app:Application {name: 'webapp'})<-[:DEPENDS_ON]-(proc:Process)
RETURN proc
LIMIT 3",Complex Retrieval Queries,network,False,False,False,
Which machines are running the version '7.1' of any software?,"MATCH (m:Machine)-[:RUNS]->(:Software)-[:VERSION]->(v:Version {name: '7.1'})
RETURN m.name AS MachineName",Complex Retrieval Queries,network,False,False,True,
List the first 5 machines that have a type with CPU greater than 16.,"MATCH (m:Machine)-[:TYPE]->(t:Type)
WHERE t.cpu > 16
RETURN m
LIMIT 5",Complex Retrieval Queries,network,False,False,True,
Identify the first 3 applications run by process '8966'.,"MATCH (p:Process {pid: 8966})-[:RUNS]->(app:Application)
RETURN app
LIMIT 3",Complex Retrieval Queries,network,False,False,False,
What are the first 5 egress routes from routers in zone 4?,"MATCH (r:Router {zone: 4})-[:ROUTES]->(i:Interface)-[:EXPOSES]->(p:Port)
RETURN r.name AS RouterName, i.ip AS InterfaceIP, p.port AS PortNumber
LIMIT 5",Complex Retrieval Queries,network,False,False,True,
What applications are running on the machine named 'DC1-RCK-4-9-M-103'?,"MATCH (m:Machine {name: 'DC1-RCK-4-9-M-103'})-[:RUNS]->(app:Application)
RETURN app.name AS ApplicationName",Pathfinding Queries,network,False,False,False,
Which ports are exposed by the interface with IP '10.0.0.254'?,"MATCH (i:Interface {ip: '10.0.0.254'})-[:EXPOSES]->(p:Port)
RETURN p.port",Pathfinding Queries,network,False,False,False,
Find all networks routing to the interface with IP '10.4.8.254'.,"MATCH (n:Network)-[:ROUTES]->(i:Interface {ip: '10.4.8.254'})
RETURN n",Pathfinding Queries,network,False,False,True,
Which services are running on machines located in rack 'DC1-RCK-4-9'?,"MATCH (r:Rack {name: 'DC1-RCK-4-9'})-[:HOLDS]->(m:Machine)-[:RUNS]->(s:Service)
RETURN s.name AS ServiceName",Pathfinding Queries,network,False,False,True,
List all ports exposed by interface with IP '10.0.0.254'.,"MATCH (i:Interface {ip: '10.0.0.254'})-[:EXPOSES]->(p:Port)
RETURN p.port",Verbose query,network,False,False,True,
Find all interfaces connected to the router 'DC1-R-1'.,"MATCH (r:Router {name: 'DC1-R-1'})-[:ROUTES]->(i:Interface)
RETURN i",Verbose query,network,False,False,True,
Which machines are running the OS named 'RHEL'?,"MATCH (m:Machine)-[:RUNS]->(os:OS {name: 'RHEL'})
RETURN m",Verbose query,network,False,False,True,
What are the top 3 processes running on the application 'webserver'?,"MATCH (app:Application {name: 'webserver'})-[:RUNS]->(proc:Process)
RETURN proc
ORDER BY proc.startTime DESC
LIMIT 3",Verbose query,network,False,False,True,
List all versions that are directly previous to version '7.1'.,"MATCH (v:Version {name: '7.1'})<-[:PREVIOUS]-(prev:Version)
RETURN prev",Verbose query,network,False,False,False,
Provide the names of the top 3 software that depend on the application 'webserver'.,"MATCH (s:Software)-[:DEPENDS_ON]->(a:Application {name: 'webserver'})
RETURN s.name
ORDER BY s.name
LIMIT 3",Verbose query,network,False,False,False,
Which versions of software are installed on 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)
RETURN v.name AS Version",Verbose query,network,False,False,True,
Show the first 3 types of machines by RAM size in descending order.,"MATCH (t:Type)
RETURN t
ORDER BY t.ram DESC
LIMIT 3",Verbose query,network,False,False,True,
What are the names of the first 3 switches located in rack 10?,"MATCH (r:Rack {rack: 10})-[:HOLDS]->(s:Switch)
RETURN s.name
LIMIT 3",Verbose query,network,False,False,True,Switch.name
List all services that are listening on port 80.,"MATCH (s:Service)-[:LISTENS]->(p:Port {port: 80})
RETURN s",Verbose query,network,False,False,True,
What are the top 5 OS instances running on machines in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(m:Machine)-[:RUNS]->(os:OS)
RETURN os
ORDER BY os.startTime DESC
LIMIT 5",Verbose query,network,False,False,True,
Identify all software dependencies for the software named 'RHEL'.,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON*]->(dependency)
RETURN s.name AS Software, collect(dependency.name) AS Dependencies",Verbose query,network,False,False,True,
What are the top 3 applications with the highest PID running in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(app:Application)
RETURN app.name AS ApplicationName, app.pid AS PID
ORDER BY app.pid DESC
LIMIT 3",Verbose query,network,False,False,True,
Which applications are running on the machine named 'DC1-RCK-4-9-M-103'?,"MATCH (m:Machine {name: 'DC1-RCK-4-9-M-103'})-[:RUNS]->(app:Application)
RETURN app.name AS ApplicationName",Verbose query,network,False,False,False,
What are the names of all networks in zone 2?,"MATCH (n:Network {zone: 2})
RETURN n.name",Verbose query,network,False,False,True,Network.name
List the top 5 routers in DataCenter 'DC1' by zone number.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Router)
RETURN r.name, r.zone
ORDER BY r.zone DESC
LIMIT 5",Verbose query,network,False,False,True,
What are the start times of all OS instances on machine 'DC1-RCK-1-1-M-1'?,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(os:OS)
RETURN os.startTime AS StartTime",Complex Aggregation Queries,network,False,False,True,
How many machines have a type with a disk size less than 100?,"MATCH (m:Machine)-[:TYPE]->(t:Type)
WHERE t.disk < 100
RETURN count(m) AS NumberOfMachines",Complex Aggregation Queries,network,False,False,False,
List all applications that have dependencies on other applications.,"MATCH (app:Application)-[:DEPENDS_ON]->(depApp:Application)
RETURN app.name AS Application, depApp.name AS DependentApplication",Complex Aggregation Queries,network,False,False,False,
Which software versions are dependent on version '7.1'?,"MATCH (v:Version {name: '7.1'})<-[:DEPENDS_ON]-(s:Software)
RETURN s.name AS SoftwareName, s.versions AS Versions",Complex Aggregation Queries,network,False,False,False,
Identify all machines running an application that listens on port 443.,"MATCH (m:Machine)-[:RUNS]->(app:Application)-[:LISTENS]->(p:Port {port: 443})
RETURN m, app",Complex Aggregation Queries,network,False,False,True,
How many different types of disks are there for machine types?,"MATCH (t:Type)
RETURN count(DISTINCT t.disk) AS distinctDiskTypes",Complex Aggregation Queries,network,False,False,True,
What are the IP addresses of all networks in zone 3?,"MATCH (n:Network {zone: 3})
RETURN n.ip AS NetworkIP",Complex Aggregation Queries,network,False,False,True,
List all services that are instances of the application 'webapp'.,"MATCH (app:Application {name: 'webapp'})-[:INSTANCE]->(service:Service)
RETURN service",Complex Aggregation Queries,network,False,False,False,
What are the names of all applications that depend on the process named '8966'?,"MATCH (p:Process {name: '8966'})-[:DEPENDS_ON]->(a:Application)
RETURN a.name",Complex Aggregation Queries,network,False,False,False,
Show all ports that are connected to interfaces exposed by the router 'DC1-R-1'.,"MATCH (r:Router {name: 'DC1-R-1'})-[:ROUTES]->(i:Interface)-[:EXPOSES]->(p:Port)
RETURN p",Complex Aggregation Queries,network,False,False,True,
Find the first 3 machines in rack 'DC1-RCK-1-1'.,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)
RETURN m
LIMIT 3",Verbose query,network,False,False,True,
Identify the services running with a start time greater than 1607000000000.,"MATCH (s:Service)
WHERE s.startTime > 1607000000000
RETURN s",Verbose query,network,False,False,True,
Find the first 3 egress nodes in DataCenter 'DC1'.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(e:Egress)
RETURN e
LIMIT 3",Verbose query,network,False,False,True,
List all networks routing through interface with IP '10.2.1.1'.,"MATCH (n:Network)-[:ROUTES]->(i:Interface {ip: '10.2.1.1'})
RETURN n",Verbose query,network,False,False,True,
List all Processes running on Machines within zone 3.,"MATCH (m:Machine)-[:HOLDS]->(r:Rack {zone: 3})
MATCH (m)-[:RUNS]->(p:Process)
RETURN p",Pathfinding Queries,network,False,False,False,
What type of Machines are in Rack 'DC1-RCK-1-1' and have more than 16 GB RAM?,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
WHERE t.ram > 16
RETURN m.name, t.type, t.ram",Pathfinding Queries,network,False,False,False,
Provide the list of all machines that run the application named 'webapp'.,"MATCH (m:Machine)-[:RUNS]->(a:Application {name: 'webapp'})
RETURN m",Verbose query,network,False,False,False,
Which applications in DataCenter 'DC1' listen on port 80?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(app:Application)-[:LISTENS]->(p:Port {port: 80})
RETURN app.name AS ApplicationName",Verbose query,network,False,False,False,
Find the top 3 types of services by start time in ascending order.,"MATCH (s:Service)
WHERE s.startTime IS NOT NULL
RETURN s.name, s.startTime
ORDER BY s.startTime ASC
LIMIT 3",Verbose query,network,False,False,True,
What are the applications that depend on the service named 'java'?,"MATCH (s:Service {name: 'java'})<-[:DEPENDS_ON]-(a:Application)
RETURN a.name AS ApplicationName",Verbose query,network,False,False,True,
List the first 3 previous versions to version named '7.1'.,"MATCH (v:Version {name: '7.1'})-[:PREVIOUS*1..3]->(prev:Version)
RETURN prev.name",Verbose query,network,False,False,True,
Which services are instances of the software 'RHEL'?,"MATCH (s:Service)-[:INSTANCE]->(soft:Software {name: 'RHEL'})
RETURN s",Verbose query,network,False,False,False,
Find the top 3 applications by PID running in zone 4.,"MATCH (z:Zone {zone: 4})-[:ROUTES]->(i:Interface)-[:CONNECTS]->(m:Machine)-[:RUNS]->(a:Application)
RETURN a.name, a.pid
ORDER BY a.pid DESC
LIMIT 3",Verbose query,network,False,False,True,
Identify all ports where the process named '9.4' is listening.,"MATCH (p:Process {name: '9.4'})-[:LISTENS]->(port:Port)
RETURN port",Verbose query,network,False,False,True,
List the versions of software that the service named 'java' depends on.,"MATCH (s:Service {name: 'java'})-[:INSTANCE]->(soft:Software)-[:VERSION]->(v:Version)
RETURN v.name AS VersionName",Verbose query,network,False,False,False,
What are the dependencies of the application named 'webapp'?,"MATCH (app:Application {name: 'webapp'})-[:DEPENDS_ON]->(dependency)
RETURN app.name AS Application, dependency.name AS Dependency",Verbose query,network,False,False,True,
Provide the details of the first 3 machines in rack 'DC1-RCK-4-9' that run a type 'xl' configuration.,"MATCH (r:Rack {name: 'DC1-RCK-4-9'})-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type {type: 'xl'})
RETURN m
LIMIT 3",Verbose query,network,False,False,False,
List the names of all applications that depend on the process named '9.4'.,"MATCH (p:Process {name: '9.4'})-[:DEPENDS_ON]->(a:Application)
RETURN a.name",Verbose query,network,False,False,True,
What are the different types of services running on machines in rack 'DC1-RCK-1-1'?,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)-[:RUNS]->(s:Service)
RETURN DISTINCT s.name AS ServiceType",Verbose query,network,False,False,True,
Identify the first 3 racks in zone 1 that contain more than 5 machines.,"MATCH (r:Rack {zone: 1})-[:HOLDS]->(m:Machine)
WITH r, count(m) AS machineCount
WHERE machineCount > 5
RETURN r
ORDER BY r.name
LIMIT 3",Verbose query,network,False,False,True,
Find the switches that route to interface with IP '10.1.1.1'.,"MATCH (s:Switch)-[:ROUTES]->(i:Interface {ip: '10.1.1.1'})
RETURN s",Verbose query,network,False,False,True,
List the most recent 3 applications started in DataCenter 'DC1'.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(app:Application)
RETURN app.name, app.startTime
ORDER BY app.startTime DESC
LIMIT 3",Verbose query,network,False,False,False,
What software versions are dependencies for the software 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(v:Version)
RETURN v.name AS VersionName",Verbose query,network,False,False,True,
Provide a list of all OS instances with a start time before 1606000000000.,"MATCH (os:OS)
WHERE os.startTime < 1606000000000
RETURN os",Verbose query,network,True,False,False,
Find the top 3 types of applications by PID in descending order.,"MATCH (a:Application)
RETURN a.name AS ApplicationType, a.pid AS PID
ORDER BY a.pid DESC
LIMIT 3",Verbose query,network,False,False,True,
Which interfaces are connected to the egress node 'DC1-RE'?,"MATCH (e:Egress {name: 'DC1-RE'})-[:ROUTES]->(i:Interface)
RETURN i",Verbose query,network,False,False,True,
Display the first 3 machines with type 'm' in their configurations.,"MATCH (m:Machine)-[:TYPE]->(t:Type {type: 'm'})
RETURN m
LIMIT 3",Verbose query,network,False,False,True,
Identify all services that a process named '9.4' depends on.,"MATCH (p:Process {name: '9.4'})-[:DEPENDS_ON]->(s:Service)
RETURN s",Verbose query,network,False,False,True,
List the first 3 processes that depend on the service 'java'.,"MATCH (p:Process)-[:DEPENDS_ON]->(s:Service {name: 'java'})
RETURN p
LIMIT 3",Verbose query,network,False,False,True,
What are the types and quantities of machines held in rack 'DC1-RCK-4-9'?,"MATCH (r:Rack {name: 'DC1-RCK-4-9'})-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN t.type AS MachineType, count(m) AS Quantity
GROUP BY t.type",Verbose query,network,False,False,True,
Show the first 3 racks in zone 4 of DataCenter 'DC1'.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack {zone: 4})
RETURN r
ORDER BY r.name
LIMIT 3",Verbose query,network,False,False,True,
Which racks are in zone 1 and have more than 5 machines?,"MATCH (r:Rack {zone: 1})-[:HOLDS]->(m:Machine)
WITH r, count(m) AS machineCount
WHERE machineCount > 5
RETURN r.name, machineCount",Complex Aggregation Queries,network,False,False,True,
What are the first 5 IP addresses of interfaces connected to network '10.3'?,"MATCH (n:Network {ip: '10.3'})-[:ROUTES]->(i:Interface)
RETURN i.ip
LIMIT 5",Complex Retrieval Queries,network,False,False,True,
List the top 5 most used process names in the database.,"MATCH (p:Process)
RETURN p.name, count(p) AS usage
ORDER BY usage DESC
LIMIT 5",Complex Aggregation Queries,network,False,False,True,
How many types of machines have a RAM capacity of 256 or more?,"MATCH (t:Type)
WHERE t.ram >= 256
RETURN count(t) AS NumberOfTypes",Complex Aggregation Queries,network,False,False,False,
How many types of machines have a RAM greater than 64?,"MATCH (t:Type)
WHERE t.ram > 64
RETURN count(t) AS NumberOfTypes",Pathfinding Queries,network,False,False,False,
What type of machine is 'DC1-RCK-4-9-M-103'?,"MATCH (m:Machine {name: 'DC1-RCK-4-9-M-103'})-[:TYPE]->(t:Type)
RETURN t.type AS MachineType",Pathfinding Queries,network,False,False,False,
Which services are instances of version '9.4'?,"MATCH (s:Service)-[:INSTANCE]->(v:Version {name: '9.4'})
RETURN s",Pathfinding Queries,network,False,False,True,
List all interfaces that connect racks in zone 4.,"MATCH (r:Rack {zone: 4})-[:HOLDS]->(m:Machine)-[:ROUTES]->(i:Interface)
RETURN DISTINCT i",Pathfinding Queries,network,False,False,False,
What are the properties of the network with IP '10.3'?,"MATCH (n:Network {ip: '10.3'})
RETURN n",Pathfinding Queries,network,False,False,False,
Which machines in DataCenter 'DC1' run an OS named 'RHEL'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(m:Machine)-[:RUNS]->(os:OS {name: 'RHEL'})
RETURN m",Pathfinding Queries,network,False,False,True,
Identify all ports that the OS running on 'DC1-RCK-4-9-M-103' listens to.,"MATCH (m:Machine {name: 'DC1-RCK-4-9-M-103'})-[:RUNS]->(os:OS)
MATCH (os)-[:INSTANCE]->(s:Service)-[:LISTENS]->(p:Port)
RETURN p.port AS Port",Pathfinding Queries,network,False,False,True,
Which applications are instances of software 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:INSTANCE]->(a:Application)
RETURN a.name AS ApplicationName",Pathfinding Queries,network,False,False,True,
What are the names of the types with a CPU count greater than 16?,"MATCH (t:Type)
WHERE t.cpu > 16
RETURN t.name",Pathfinding Queries,network,False,False,True,
List the start times of all processes running on machines in zone 2.,"MATCH (z:Zone {zone: 2})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(m:Machine)-[:RUNS]->(p:Process)
RETURN p.startTime AS ProcessStartTime",Pathfinding Queries,network,False,False,True,
Who are the dependencies of version '9.4' in the software ecosystem?,"MATCH (v:Version {name: '9.4'})<-[:VERSION]-(s:Software)
MATCH (s)-[:DEPENDS_ON]->(dependency)
RETURN s.name AS Software, dependency.name AS Dependency",Pathfinding Queries,network,False,False,True,
What are the IPs of all switches in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack)-[:HOLDS]->(s:Switch)
RETURN s.ip AS SwitchIP",Pathfinding Queries,network,False,False,False,
Which DataCenter routers connect to the interface with IP '10.0.0.254'?,"MATCH (dc:DataCenter)-[:CONTAINS]->(r:Router)-[:ROUTES]->(i:Interface {ip: '10.0.0.254'})
RETURN dc.name AS DataCenter, r.name AS Router",Pathfinding Queries,network,False,False,True,
Which interfaces are routed by network '10.2'?,"MATCH (n:Network {ip: '10.2'})-[:ROUTES]->(i:Interface)
RETURN i",Pathfinding Queries,network,False,False,False,
"List all services that a specific application depends on, for example, 'webserver'.","MATCH (app:Application {name: 'webserver'})-[:DEPENDS_ON]->(service:Service)
RETURN service",Pathfinding Queries,network,False,False,True,
How many machines are there in rack 'DC1-RCK-4-9' and what types are they?,"MATCH (r:Rack {name: 'DC1-RCK-4-9'})-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN COUNT(m) AS NumberOfMachines, COLLECT(DISTINCT t.name) AS MachineTypes",Pathfinding Queries,network,False,False,False,
Which racks contain switches with IP starting with '10.1'?,"MATCH (r:Rack)-[:HOLDS]->(s:Switch)
WHERE s.ip STARTS WITH '10.1'
RETURN r.name AS RackName",Pathfinding Queries,network,False,False,True,
What are the names of all applications running on machines in zone 3?,"MATCH (z:Zone {zone: 3})-[:ROUTES]->(i:Interface)-[:CONNECTS]-(m:Machine)-[:RUNS]->(a:Application)
RETURN DISTINCT a.name",Pathfinding Queries,network,False,False,True,
Which racks are located in zone 1 of the DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack {zone: 1})
RETURN r.name AS RackName",Pathfinding Queries,network,False,False,False,
List all ports listened to by the service running on machine 'DC1-RCK-4-9-M-103'.,"MATCH (m:Machine {name: 'DC1-RCK-4-9-M-103'})-[:RUNS]->(s:Service)-[:LISTENS]->(p:Port)
RETURN p.port AS PortListenedTo",Pathfinding Queries,network,False,False,False,
What are the dependencies of the web application named 'webserver'?,"MATCH (app:Application {name: 'webserver'})
OPTIONAL MATCH (app)-[:DEPENDS_ON]->(dep)
RETURN app.name AS Application, collect(dep.name) AS Dependencies",Pathfinding Queries,network,False,False,True,
Find all interfaces connected to '10.0.0.254'.,"MATCH (i:Interface {ip: '10.0.0.254'})-[:CONNECTS]-(connectedInterface:Interface)
RETURN connectedInterface",Pathfinding Queries,network,False,False,False,
Which zones have a size of 16?,"MATCH (z:Zone)
WHERE z.size = 16
RETURN z",Pathfinding Queries,network,False,False,True,
What is the start time of the process running on machine 'DC1-RCK-4-9-M-103'?,"MATCH (m:Machine {name: 'DC1-RCK-4-9-M-103'})-[:RUNS]->(p:Process)
RETURN p.startTime",Pathfinding Queries,network,False,False,False,
List the previous versions of version '9.4'.,"MATCH (v:Version {name: '9.4'})-[:PREVIOUS*]->(prev:Version)
RETURN prev.name AS PreviousVersions",Pathfinding Queries,network,False,False,False,
What types of software depend on the software named 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})<-[:DEPENDS_ON]-(dependent:Software)
RETURN DISTINCT dependent.name AS DependentSoftware",Pathfinding Queries,network,False,False,True,
What is the disk capacity of the type 'm-4/16/25'?,"MATCH (t:Type {name: 'm-4/16/25'})
RETURN t.disk AS DiskCapacity",Pathfinding Queries,network,False,False,True,
What are the names of the services that depend on the process named '8966'?,"MATCH (p:Process {name: '8966'})-[:DEPENDS_ON]->(s:Service)
RETURN s.name",Pathfinding Queries,network,False,False,True,
List the top 3 zones by size.,"MATCH (z:Zone)
RETURN z.zone AS Zone, z.size AS Size
ORDER BY z.size DESC
LIMIT 3",Pathfinding Queries,network,False,False,True,
Identify all machines that run more than one type of application.,"MATCH (m:Machine)-[:RUNS]->(a:Application)
WITH m, count(DISTINCT a) AS numApplications
WHERE numApplications > 1
RETURN m",Pathfinding Queries,network,False,False,True,
Which machines are connected to the interface with IP '10.1.1'?,"MATCH (m:Machine)-[:ROUTES]->(i:Interface {ip: '10.1.1'})
RETURN m.name AS MachineName",Complex Aggregation Queries,network,False,False,True,
Identify all services that started before timestamp 1606200000000.,"MATCH (s:Service)
WHERE s.startTime < 1606200000000
RETURN s",Complex Aggregation Queries,network,False,False,True,
What are the software dependencies for the application 'logstash'?,"MATCH (app:Application {name: 'logstash'})-[:DEPENDS_ON]->(dep)
RETURN app.name AS Application, dep.name AS Dependency",Complex Aggregation Queries,network,False,False,True,
List all versions of software that are previous to version '7.1'.,"MATCH (v:Version {name: '7.1'})<-[:PREVIOUS*]-(previousVersions:Version)
RETURN previousVersions.name AS PreviousVersionNames",Complex Aggregation Queries,network,False,False,True,
Which data center contains the egress named 'DC1-RE'?,"MATCH (dc:DataCenter)-[:CONTAINS]->(e:Egress {name: 'DC1-RE'})
RETURN dc.name",Complex Aggregation Queries,network,False,False,True,
How many different ports are used by applications named 'webserver'?,"MATCH (app:Application {name: 'webserver'})-[:LISTENS]->(port:Port)
RETURN COUNT(DISTINCT port) AS distinctPorts",Complex Aggregation Queries,network,False,False,True,
What are the IP addresses of interfaces connected to the network '10.3'?,"MATCH (n:Network {ip: '10.3'})-[:ROUTES]->(i:Interface)
RETURN i.ip AS InterfaceIP",Complex Aggregation Queries,network,False,False,True,
Find all machines running an OS that started after timestamp 1606000000000.,"MATCH (m:Machine)-[:RUNS]->(os:OS)
WHERE os.startTime > 1606000000000
RETURN m, os",Complex Aggregation Queries,network,False,False,True,
Which zones have a size of 16?,"MATCH (z:Zone)
WHERE z.size = 16
RETURN z",Complex Aggregation Queries,network,False,False,False,
List the names of all racks contained within the data center 'DC1'.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(rack:Rack)
RETURN rack.name",Complex Aggregation Queries,network,False,False,True,
What is the maximum disk size available in the type 'xl'?,"MATCH (t:Type {type: 'xl'})
RETURN max(t.disk) AS MaximumDiskSize",Complex Aggregation Queries,network,False,False,False,
Which types of machines (type names) have a CPU greater than 16?,"MATCH (t:Type)
WHERE t.cpu > 16
RETURN t.name",Complex Aggregation Queries,network,False,False,True,
How many applications are dependent on the service named 'java'?,"MATCH (s:Service {name: 'java'})<-[:DEPENDS_ON]-(a:Application)
RETURN count(a) AS NumberOfDependentApplications",Complex Aggregation Queries,network,False,False,True,
List all services listening on port 80.,"MATCH (s:Service)-[:LISTENS]->(p:Port {port: 80})
RETURN s",Complex Aggregation Queries,network,False,False,True,
What are the dependencies of the software named 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(dependency)
RETURN s.name AS Software, dependency.name AS Dependency",Complex Aggregation Queries,network,False,False,True,
Find all networks routing through the interface with IP '10.2.8.254'.,"MATCH (n:Network)-[:ROUTES]->(i:Interface {ip: '10.2.8.254'})
RETURN n",Complex Aggregation Queries,network,False,False,True,
Identify the ports exposed by the interface with IP '10.0.0.254'.,"MATCH (i:Interface {ip: '10.0.0.254'})-[:EXPOSES]->(p:Port)
RETURN p.port",Complex Aggregation Queries,network,False,False,True,
Which interfaces are connected to the router named 'DC1-R-2'?,"MATCH (r:Router {name: 'DC1-R-2'})-[:ROUTES]->(i:Interface)
RETURN i",Complex Aggregation Queries,network,False,False,True,
What are the top 3 applications by number of instances running on machines?,"MATCH (m:Machine)-[:RUNS]->(a:Application)
WITH a, count(m) AS instances
ORDER BY instances DESC
LIMIT 3
RETURN a.name, instances",Complex Aggregation Queries,network,False,False,True,
Show all processes that are instances of the software version '7.1'.,"MATCH (s:Software)-[:VERSION]->(v:Version {name: '7.1'})
MATCH (p:Process)-[:INSTANCE]->(v)
RETURN p",Complex Aggregation Queries,network,False,False,True,
How many machines are in rack 3 and what are their names?,"MATCH (r:Rack {rack: 3})-[:HOLDS]->(m:Machine)
RETURN count(m) AS NumberOfMachines, collect(m.name) AS MachineNames",Complex Aggregation Queries,network,False,False,False,
Which machines are running the application named 'crm'?,"MATCH (m:Machine)-[:RUNS]->(a:Application {name: 'crm'})
RETURN m",Complex Aggregation Queries,network,False,False,True,
List all software versions that depend on 'RHEL'.,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)
RETURN v.name",Complex Aggregation Queries,network,False,False,True,
What are the names of all switches in rack 5?,"MATCH (r:Rack {rack: 5})-[:HOLDS]->(s:Switch)
RETURN s.ip AS SwitchIP",Complex Aggregation Queries,network,False,False,True,
Which routers are located in zone 2?,"MATCH (r:Router {zone: 2})
RETURN r",Complex Aggregation Queries,network,False,False,False,
Which applications listen to port 80?,"MATCH (p:Port {port: 80})<-[:LISTENS]-(app:Application)
RETURN app.name AS ApplicationName",Pathfinding Queries,network,False,False,True,
What versions of software does the software 'RHEL' depend on?,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(v:Version)
RETURN v.name AS Version",Pathfinding Queries,network,False,False,False,
What is the total number of machines held in zone 4 racks?,"MATCH (z:Zone {zone: 4})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(r:Rack)-[:HOLDS]->(m:Machine)
RETURN count(m) AS TotalMachinesInZone4",Complex Aggregation Queries,network,False,False,True,
Display the top 3 services that started after timestamp 1606165629748.,"MATCH (s:Service)
WHERE s.startTime > 1606165629748
RETURN s
ORDER BY s.startTime ASC
LIMIT 3",Complex Retrieval Queries,network,False,False,True,
Show the earliest start time of any process running on machine 'DC1-RCK-1-1-M-1'.,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(p:Process)
RETURN min(p.startTime) AS EarliestStartTime",Complex Aggregation Queries,network,False,False,True,
List all ports exposed by the interface with IP '10.0.0.254'.,"MATCH (i:Interface {ip: '10.0.0.254'})-[:EXPOSES]->(p:Port)
RETURN p.port",Complex Retrieval Queries,network,False,False,False,
List the first 3 networks that route through interfaces in zone 2.,"MATCH (n:Network)-[:ROUTES]->(i:Interface)
WHERE n.zone = 2
RETURN n
LIMIT 3",Complex Aggregation Queries,network,False,False,True,
Which ports are listened by all instances of the application 'webserver'?,"MATCH (app:Application {name: 'webserver'})-[:INSTANCE]->(service:Service)-[:LISTENS]->(port:Port)
RETURN DISTINCT port.port",Complex Aggregation Queries,network,False,False,True,
What are the first 3 services that a machine named 'DC1-RCK-4-9-M-103' runs?,"MATCH (m:Machine {name: 'DC1-RCK-4-9-M-103'})-[:RUNS]->(s:Service)
RETURN s
LIMIT 3",Complex Aggregation Queries,network,False,False,True,
Which rack holds the most switches in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(rack:Rack)
WITH rack, count{(rack)-[:HOLDS]->(:Switch)} AS switchCount
RETURN rack.name AS RackName, switchCount
ORDER BY switchCount DESC
LIMIT 1",Complex Aggregation Queries,network,False,False,True,
What are the total dependencies of the application 'crm' including indirect dependencies?,"MATCH (app:Application {name: 'crm'})
CALL {
    WITH app
    MATCH (app)-[:DEPENDS_ON*]->(dependency)
    RETURN DISTINCT dependency
}
RETURN count(dependency) AS TotalDependencies",Complex Aggregation Queries,network,False,False,True,
List the first 3 machines in zone 4 that run an application named 'logstash'.,"MATCH (z:Zone {zone: 4})-[:ROUTES]->(i:Interface)-[:CONNECTS]->(m:Machine)-[:RUNS]->(a:Application {name: 'logstash'})
RETURN m
LIMIT 3",Complex Aggregation Queries,network,False,False,True,
Which type of machine has the highest average CPU in the schema?,"MATCH (m:Machine)-[:TYPE]->(t:Type)
RETURN t.type AS MachineType, AVG(t.cpu) AS AverageCPU
ORDER BY AverageCPU DESC
LIMIT 1",Complex Aggregation Queries,network,False,False,False,
What are the top 3 earliest starting processes in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(p:Process)
RETURN p.name, p.startTime
ORDER BY p.startTime ASC
LIMIT 3",Complex Aggregation Queries,network,False,False,True,
List the first 3 services that started after timestamp 1606165629748.,"MATCH (s:Service)
WHERE s.startTime > 1606165629748
RETURN s
ORDER BY s.startTime ASC
LIMIT 3",Complex Aggregation Queries,network,False,False,False,
What is the total number of interfaces that expose port 80 in the schema?,"MATCH (i:Interface)-[:EXPOSES]->(p:Port {port: 80})
RETURN count(i) AS TotalInterfacesExposingPort80",Complex Aggregation Queries,network,False,False,False,
Which process listens on the highest port number in the schema?,"MATCH (p:Process)-[:LISTENS]->(port:Port)
RETURN p.name AS ProcessName, port.port AS PortNumber
ORDER BY port.port DESC
LIMIT 1",Complex Aggregation Queries,network,False,False,True,
List the first 3 machines that run a service instance named 'java'.,"MATCH (m:Machine)-[:RUNS]->(s:Service {name: 'java'})
RETURN m
LIMIT 3",Complex Aggregation Queries,network,False,False,True,
What are the first 3 applications that depend on processes within zone 3?,"MATCH (z:Zone {zone: 3})-[:ROUTES]->(i:Interface)-[:CONNECTS]->(i2:Interface)<-[:ROUTES]-(m:Machine)-[:RUNS]->(p:Process),
      (app:Application)-[:DEPENDS_ON]->(p)
RETURN app
LIMIT 3",Complex Aggregation Queries,network,False,False,True,
Which applications are dependent on the service named 'java'?,"MATCH (s:Service {name: 'java'})<-[:DEPENDS_ON]-(app:Application)
RETURN app.name AS ApplicationName",Complex Aggregation Queries,network,True,False,False,
What are the top 3 previous versions of the version '7.1' in the schema?,"MATCH path=(v:Version {name: '7.1'})-[:PREVIOUS*1..3]->(prev:Version)
RETURN prev.name AS PreviousVersion
ORDER BY length(path) ASC
LIMIT 3",Complex Aggregation Queries,network,False,False,True,
What are the dependencies of the software named 'RHEL' and their versions?,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(dep:Software)
OPTIONAL MATCH (dep)-[:VERSION]->(v:Version)
RETURN dep.name AS Dependency, collect(v.name) AS Versions",Complex Aggregation Queries,network,False,False,True,
How many racks contain switches in zone 4 of DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack {zone: 4})
WHERE exists{(r)-[:HOLDS]->(:Switch)}
RETURN count(r) AS NumberOfRacks",Complex Aggregation Queries,network,False,False,True,
What are the top 5 latest services started in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(s:Service)
RETURN s.name, s.startTime
ORDER BY s.startTime DESC
LIMIT 5",Complex Aggregation Queries,network,False,False,True,
Which zones have switches with IP starting with '10.1'?,"MATCH (z:Zone)-[:ROUTES]->(i:Interface)<-[:ROUTES]-(s:Switch)
WHERE s.ip STARTS WITH '10.1'
RETURN DISTINCT z.zone AS Zone",Complex Aggregation Queries,network,False,False,True,
What is the total RAM of all types of machines grouped by their type in the DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack)-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN t.type AS MachineType, SUM(t.ram) AS TotalRAM
GROUP BY t.type",Complex Aggregation Queries,network,False,False,False,
List the first 3 processes that depend on the version '7.1'.,"MATCH (v:Version {name: '7.1'})<-[:INSTANCE]-(p:Process)
RETURN p
LIMIT 3",Complex Aggregation Queries,network,True,False,False,
Which switch is located in the highest rack number within DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack)-[:HOLDS]->(s:Switch)
RETURN s.ip AS SwitchIP, r.rack AS RackNumber
ORDER BY r.rack DESC
LIMIT 1",Complex Aggregation Queries,network,False,False,False,
What is the type of the machine that runs the most applications in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack)-[:HOLDS]->(m:Machine)
WITH m, count{(m)-[:RUNS]->(:Application)} AS appCount
ORDER BY appCount DESC
LIMIT 1
MATCH (m)-[:TYPE]->(t:Type)
RETURN t.type AS MachineType",Complex Aggregation Queries,network,False,False,False,
How many interfaces are connected to 'DC1-R-2'?,"MATCH (r:Router {name: 'DC1-R-2'})-[:ROUTES]->(i:Interface)
RETURN count(i) AS NumberOfInterfacesConnected",Complex Aggregation Queries,network,False,False,True,
Which network has the smallest size and what is its IP?,"MATCH (n:Network)
RETURN n.ip AS NetworkIP, n.size AS NetworkSize
ORDER BY n.size ASC
LIMIT 1",Complex Aggregation Queries,network,False,False,False,
What are the first 3 processes that depend on version '7.1' in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(m:Machine)-[:RUNS]->(p:Process)
WHERE exists {
    (p)-[:INSTANCE]->(:Version {name: '7.1'})
}
RETURN p
LIMIT 3",Complex Aggregation Queries,network,False,False,True,
Which racks in zone 1 contain more than one type of machine?,"MATCH (r:Rack {zone: 1})-[:HOLDS]->(m:Machine)
WITH r, collect(DISTINCT (m)-[:TYPE]->(t:Type)) AS types
WHERE size(types) > 1
RETURN r.name AS RackName, size(types) AS NumberOfMachineTypes",Complex Aggregation Queries,network,False,False,True,
List the top 5 switches by IP in zone 4.,"MATCH (s:Switch)-[:HOLDS]->(r:Rack {zone: 4})
RETURN s.ip AS SwitchIP
ORDER BY s.ip
LIMIT 5",Complex Aggregation Queries,network,False,False,True,
What is the name of the router that routes the most networks in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Router)-[:ROUTES]->(i:Interface)-[:ROUTES]->(n:Network)
WITH r, count(n) AS networkCount
ORDER BY networkCount DESC
LIMIT 1
RETURN r.name AS RouterName",Complex Aggregation Queries,network,False,False,False,
What are the names of the first 3 processes that depend on the service named 'java'?,"MATCH (s:Service {name: 'java'})<-[:DEPENDS_ON]-(p:Process)
RETURN p.name
LIMIT 3",Verbose query,network,False,False,True,
Which 3 applications are instances of the software named 'RHEL' and their start times?,"MATCH (s:Software {name: 'RHEL'})-[:INSTANCE]->(a:Application)
RETURN a.name AS ApplicationName, a.startTime AS StartTime
LIMIT 3",Verbose query,network,False,False,True,
Name the first 3 services that listen to port 80.,"MATCH (s:Service)-[:LISTENS]->(p:Port {port: 80})
RETURN s.name
LIMIT 3",Verbose query,network,False,False,True,
Which 3 zones have a size of 16 and are connected via interface IP '10.3.10.254'?,"MATCH (z:Zone {size: 16})-[:ROUTES]->(i:Interface {ip: '10.3.10.254'})
RETURN z.zone AS ZoneNumber
LIMIT 3",Verbose query,network,False,False,True,
What are the top 5 types of machines in terms of RAM and CPU available in the data center?,"MATCH (dc:DataCenter)-[:CONTAINS]->(r:Rack)-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN t.type AS Type, t.ram AS RAM, t.cpu AS CPU
ORDER BY t.ram DESC, t.cpu DESC
LIMIT 5",Verbose query,network,False,False,False,
Identify the first 3 versions of the software running on the application 'webserver'.,"MATCH (app:Application {name: 'webserver'})-[:RUNS]->(machine:Machine)-[:RUNS]->(software:Software)
MATCH (software)-[:VERSION]->(version:Version)
RETURN software.name, collect(version.name)[..3] AS first_three_versions",Verbose query,network,False,False,True,
List the first 3 applications that depend on the service named 'java'.,"MATCH (app:Application)-[:DEPENDS_ON]->(serv:Service {name: 'java'})
RETURN app
LIMIT 3",Verbose query,network,False,False,False,
What are the names and IPs of the first 3 interfaces routed by the network with IP '10.2'?,"MATCH (n:Network {ip: '10.2'})-[:ROUTES]->(i:Interface)
RETURN i.name, i.ip
LIMIT 3",Verbose query,network,False,False,True,Interface.name
Name the top 5 processes running on the machine with the name 'DC1-RCK-1-1-M-1'.,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(p:Process)
RETURN p.name
ORDER BY p.startTime DESC
LIMIT 5",Verbose query,network,False,False,True,
What are the names of the first 3 services running on the machine named 'DC1-RCK-1-1-M-1'?,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(s:Service)
RETURN s.name
LIMIT 3",Verbose query,network,False,False,False,
Which 3 ports are exposed by the interface with IP '10.1.1'?,"MATCH (i:Interface {ip: '10.1.1'})-[:EXPOSES]->(p:Port)
RETURN p.port
LIMIT 3",Verbose query,network,False,False,True,
List the first 3 software versions used by the software named 'RHEL'.,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)
RETURN v.name
ORDER BY v.name
LIMIT 3",Verbose query,network,False,False,True,
List the first 3 services that started on applications named 'webserver'.,"MATCH (app:Application {name: 'webserver'})-[:RUNS]->(service:Service)
RETURN service
ORDER BY service.startTime
LIMIT 3",Complex Aggregation Queries,network,False,False,True,
Identify the top 5 machines held in rack 'DC1-RCK-1-10' and their types.,"MATCH (r:Rack {name: 'DC1-RCK-1-10'})-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN m.name AS MachineName, t.name AS TypeName
LIMIT 5",Verbose query,network,False,False,True,
Name the first 3 applications running on the machine located in rack 'DC1-RCK-1-1'.,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)-[:RUNS]->(a:Application)
RETURN a.name
LIMIT 3",Verbose query,network,False,False,False,
Which 3 networks are routed to the interface with the IP '10.0.0.254'?,"MATCH (n:Network)-[:ROUTES]->(i:Interface {ip: '10.0.0.254'})
RETURN n.name AS NetworkName, n.ip AS NetworkIP, n.size AS NetworkSize, n.zone AS NetworkZone
LIMIT 3",Verbose query,network,False,False,False,Network.name
List the top 5 IP addresses of interfaces connected to the router named 'DC1-R-1'.,"MATCH (r:Router {name: 'DC1-R-1'})-[:ROUTES]->(i:Interface)
RETURN i.ip AS IPAddress
LIMIT 5",Verbose query,network,False,False,True,
What are the names of the first 3 routers located in zone 1 in the data center?,"MATCH (dc:DataCenter)-[:CONTAINS]->(r:Router)
WHERE r.zone = 1
RETURN r.name
LIMIT 3",Verbose query,network,False,False,True,
List the first 3 machines that run the latest version of the software 'RHEL'.,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)
WITH v
ORDER BY v.name DESC
LIMIT 1
MATCH (m:Machine)-[:RUNS]->(:OS)-[:INSTANCE]->(v)
RETURN m
LIMIT 3",Complex Aggregation Queries,network,False,False,True,
Which applications are running on machines that type 'l'?,"MATCH (m:Machine)-[:TYPE]->(t:Type {type: 'l'})
MATCH (m)-[:RUNS]->(a:Application)
RETURN a.name AS ApplicationName",Complex Aggregation Queries,network,False,False,False,
What are the direct and indirect dependencies of the process named '8966'?,"MATCH (p:Process {name: '8966'})
CALL {
    WITH p
    MATCH (p)-[:DEPENDS_ON*]->(dependency)
    RETURN dependency
}
RETURN p, COLLECT(dependency) AS dependencies",Complex Aggregation Queries,network,False,False,True,
List the first 3 applications that depend on the service named 'logstash'.,"MATCH (app:Application)-[:DEPENDS_ON]->(service:Service {name: 'logstash'})
RETURN app
LIMIT 3",Complex Aggregation Queries,network,False,False,False,
Which interface connects the most networks in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Router)-[:ROUTES]->(i:Interface)
WITH i, count{(i)-[:ROUTES]->(:Network)} AS networkCount
RETURN i, networkCount
ORDER BY networkCount DESC
LIMIT 1",Complex Aggregation Queries,network,False,False,True,
What are the total CPU resources allocated to machines in rack 'DC1-RCK-1-1'?,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN sum(t.cpu) AS TotalCPU",Complex Aggregation Queries,network,False,False,True,
List the top 3 processes that listen on port 80.,"MATCH (p:Process)-[:LISTENS]->(port:Port {port: 80})
RETURN p
LIMIT 3",Complex Aggregation Queries,network,False,False,True,
Which services started the earliest in application 'webapp'?,"MATCH (app:Application {name: 'webapp'})-[:RUNS]->(service:Service)
RETURN service
ORDER BY service.startTime ASC
LIMIT 1",Complex Aggregation Queries,network,False,False,False,
What are the names of the first 3 racks contained within the data center 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack)
RETURN r.name
LIMIT 3",Verbose query,network,False,False,False,
List the first 3 previous versions of the version named '7.1'.,"MATCH (v:Version {name: '7.1'})-[:PREVIOUS*1..3]->(prev:Version)
RETURN prev.name",Verbose query,network,False,False,True,
Which software has the most dependencies in the schema?,"MATCH (s:Software)
RETURN s.name, count{(s)-[:DEPENDS_ON]->()} AS dependency_count
ORDER BY dependency_count DESC
LIMIT 1",Complex Aggregation Queries,network,False,False,False,
What are the top 3 egress routes from DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(e:Egress)-[:ROUTES]->(i:Interface)
RETURN e.name AS EgressName, i.ip AS InterfaceIP
ORDER BY i.ip
LIMIT 3",Complex Aggregation Queries,network,False,False,True,
Which Zone routes to Interface with IP '10.2.8.254'?,"MATCH (z:Zone)-[:ROUTES]->(i:Interface {ip: '10.2.8.254'})
RETURN z",Pathfinding Queries,network,False,False,True,
List the top 3 DataCenters that contain more than 5 Routers.,"MATCH (dc:DataCenter)-[:CONTAINS]->(r:Router)
WITH dc, count(r) AS routerCount
WHERE routerCount > 5
RETURN dc
ORDER BY routerCount DESC
LIMIT 3",Pathfinding Queries,network,False,False,True,
Which Software requires version '7.1' to function?,"MATCH (s:Software)-[:DEPENDS_ON]->(v:Version {name: '7.1'})
RETURN s.name AS SoftwareName",Pathfinding Queries,network,False,False,True,
What are the names of the first 3 Types with a RAM size less than 64?,"MATCH (t:Type)
WHERE t.ram < 64
RETURN t.name
ORDER BY t.ram ASC
LIMIT 3",Pathfinding Queries,network,False,False,True,
Find the top 3 Processes that depend on themselves.,"MATCH (p:Process)-[:DEPENDS_ON]->(p)
RETURN p
ORDER BY p.startTime DESC
LIMIT 3",Pathfinding Queries,network,False,False,True,
What Ports are listened to by the 'crm' application?,"MATCH (app:Application {name: 'crm'})-[:LISTENS]->(port:Port)
RETURN port",Pathfinding Queries,network,False,False,True,
Which Applications depend on the 'webserver' application?,"MATCH (app:Application {name: 'webserver'})<-[:DEPENDS_ON]-(dependentApp:Application)
RETURN dependentApp.name",Pathfinding Queries,network,False,False,True,
Identify the first 3 Services that are instances of 'java'.,"MATCH (s:Service {name: 'java'})
RETURN s
LIMIT 3",Pathfinding Queries,network,False,False,True,
What are the IPs of the Networks in zone 2?,"MATCH (n:Network {zone: 2})
RETURN n.ip AS NetworkIP",Pathfinding Queries,network,False,False,True,
Which Routers are connected to Interfaces in zone 4?,"MATCH (r:Router)-[:ROUTES]->(i:Interface)
WHERE r.zone = 4
RETURN r.name, i.ip",Pathfinding Queries,network,False,False,True,
List the Machines of type 'xl' that have a disk size greater than 256.,"MATCH (m:Machine)-[:TYPE]->(t:Type {type: 'xl'})
WHERE t.disk > 256
RETURN m",Pathfinding Queries,network,False,False,False,
Which Type of machine has the highest CPU allocation?,"MATCH (t:Type)
RETURN t.name AS TypeName, t.cpu AS CPUAllocation
ORDER BY t.cpu DESC
LIMIT 1",Pathfinding Queries,network,False,False,False,
What are the first 5 Services that started after timestamp 1606165629748?,"MATCH (s:Service)
WHERE s.startTime > 1606165629748
RETURN s
ORDER BY s.startTime ASC
LIMIT 5",Pathfinding Queries,network,False,False,True,
Name the Applications that listen on port 443.,"MATCH (app:Application)-[:LISTENS]->(p:Port {port: 443})
RETURN app.name",Pathfinding Queries,network,False,False,False,
Which Process instances are linked to Version '7.1'?,"MATCH (p:Process)-[:INSTANCE]->(v:Version {name: '7.1'})
RETURN p",Pathfinding Queries,network,False,False,True,
List the top 5 Processes depending on the Service with PID 8966.,"MATCH (s:Service {pid: 8966})<-[:DEPENDS_ON]-(p:Process)
RETURN p
ORDER BY p.startTime DESC
LIMIT 5",Pathfinding Queries,network,False,False,True,
Name the Machines that run the OS 'RHEL'.,"MATCH (m:Machine)-[:RUNS]->(os:OS {name: 'RHEL'})
RETURN m.name",Pathfinding Queries,network,False,False,False,
Which Switches route to the Interface with IP '10.1.1'?,"MATCH (s:Switch)-[:ROUTES]->(i:Interface {ip: '10.1.1'})
RETURN s",Pathfinding Queries,network,False,False,True,
List the first 5 Switches in Rack 1.,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(s:Switch)
RETURN s
LIMIT 5",Pathfinding Queries,network,False,False,True,
What are the dependencies of the Software 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(dependency)
RETURN s.name AS Software, dependency.name AS Dependency",Pathfinding Queries,network,False,False,False,
Which Versions are marked as previous to '7.1'?,"MATCH (v:Version {name: '7.1'})<-[:PREVIOUS]-(prev:Version)
RETURN prev",Pathfinding Queries,network,False,False,False,
What are the names of the first 3 Applications that depend on the Service named 'java'?,"MATCH (s:Service {name: 'java'})<-[:DEPENDS_ON]-(a:Application)
RETURN a.name
LIMIT 3",Pathfinding Queries,network,False,False,False,
Which Ports are exposed by the Interface with IP '10.0.0.254'?,"MATCH (i:Interface {ip: '10.0.0.254'})-[:EXPOSES]->(p:Port)
RETURN p",Pathfinding Queries,network,False,False,True,
What are the first 3 zones with size 16 and IP starting with '10.2'?,"MATCH (z:Zone)
WHERE z.size = 16 AND z.ip STARTS WITH '10.2'
RETURN z
LIMIT 3",Complex Retrieval Queries,network,False,False,True,
Name the top 3 Services listening on Port 80.,"MATCH (s:Service)-[:LISTENS]->(p:Port {port: 80})
RETURN s.name
ORDER BY s.startTime DESC
LIMIT 3",Pathfinding Queries,network,False,False,True,
Name the first 3 Machines that are of type 'm' and are located in zone 3.,"MATCH (m:Machine)-[:TYPE]->(t:Type {type: 'm'})
WHERE exists {
    (m)-[:ROUTES]->(i:Interface)-[:ROUTES]->(z:Zone {zone: 3})
}
RETURN m.name
LIMIT 3",Pathfinding Queries,network,False,False,False,
List the first 5 Applications that depend on the Process with PID 8966.,"MATCH (p:Process {pid: 8966})-[:DEPENDS_ON]->(app:Application)
RETURN app
LIMIT 5",Pathfinding Queries,network,False,False,True,
What are the IPs of the Ports exposed by the Interface connected to Router 'DC1-R-1'?,"MATCH (r:Router {name: 'DC1-R-1'})-[:ROUTES]->(i:Interface)-[:EXPOSES]->(p:Port)
RETURN i.ip AS InterfaceIP, p.port AS PortIP",Pathfinding Queries,network,False,False,True,
Which Machine types are used in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN DISTINCT t.name AS MachineType",Pathfinding Queries,network,False,False,True,
How many machines in rack 'DC1-RCK-1-1' run the OS 'RHEL'?,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)-[:RUNS]->(os:OS {name: 'RHEL'})
RETURN count(m) AS NumberOfMachines",Complex Aggregation Queries,network,False,False,False,
Which application listens on port 80?,"MATCH (app:Application)-[:LISTENS]->(p:Port {port: 80})
RETURN app.name",Complex Aggregation Queries,network,False,False,True,
List the top 5 ports exposed by the interface with IP '10.0.0.254'.,"MATCH (i:Interface {ip: '10.0.0.254'})-[:EXPOSES]->(p:Port)
RETURN p.port
ORDER BY p.port
LIMIT 5",Complex Aggregation Queries,network,False,False,True,
What are the first 3 processes running on machines within 'DC1-RCK-4-9'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(rack:Rack {name: 'DC1-RCK-4-9'})-[:HOLDS]->(machine:Machine)
MATCH (machine)-[:RUNS]->(process:Process)
RETURN process
LIMIT 3",Complex Aggregation Queries,network,False,False,True,
Which zone has the most networks routed through it?,"MATCH (z:Zone)-[:ROUTES]->(i:Interface)
WITH z, count(i) AS interfacesCount
RETURN z.zone AS Zone, interfacesCount
ORDER BY interfacesCount DESC
LIMIT 1",Complex Aggregation Queries,network,False,False,True,
What are the top 3 applications running on the machine named 'DC1-RCK-1-1-M-1'?,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(a:Application)
RETURN a.name
ORDER BY a.startTime DESC
LIMIT 3",Complex Aggregation Queries,network,False,False,False,
Which software versions are dependent on the software named 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(v:Version)
RETURN v.name AS VersionName",Complex Aggregation Queries,network,False,False,False,
List the top 5 routers located in zone 2.,"MATCH (r:Router {zone: 2})
RETURN r
ORDER BY r.name
LIMIT 5",Complex Aggregation Queries,network,False,False,False,
What are the top 3 types of machines held in rack 'DC1-RCK-1-1'?,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN t.type AS MachineType, count(m) AS Count
ORDER BY Count DESC
LIMIT 3",Complex Aggregation Queries,network,False,False,False,
Which DataCenter contains the router named 'DC1-R-1'?,"MATCH (dc:DataCenter)-[:CONTAINS]->(r:Router {name: 'DC1-R-1'})
RETURN dc.name",Complex Aggregation Queries,network,False,False,False,
What are the IPs of the first 5 Interfaces connected to Zone 4?,"MATCH (z:Zone {zone: 4})-[:ROUTES]->(i:Interface)
RETURN i.ip
LIMIT 5",Pathfinding Queries,network,False,False,False,
Which Machine Interfaces are connected to Network '10.1'?,"MATCH (n:Network {ip: '10.1'})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(m:Machine)
RETURN m.name AS MachineName, i.ip AS InterfaceIP",Pathfinding Queries,network,False,False,False,
List all routers connected to interfaces in zone 3.,"MATCH (r:Router)-[:ROUTES]->(i:Interface)<-[:ROUTES]-(z:Zone {zone: 3})
RETURN r.name AS RouterName, i.ip AS InterfaceIP",Complex Aggregation Queries,network,False,False,True,
Name the Racks in Zone 1 that hold more than 3 Machines.,"MATCH (z:Zone {zone: 1})-[:ROUTES]->(i:Interface)-[:CONNECTS]->(i2:Interface)<-[:ROUTES]-(r:Rack)
WHERE count{(r)-[:HOLDS]->(:Machine)} > 3
RETURN r.name",Pathfinding Queries,network,False,False,True,
Which Zones have Networks with the IP '10.3'?,"MATCH (z:Zone)-[:ROUTES]->(i:Interface)<-[:ROUTES]-(n:Network {ip: '10.3'})
RETURN z",Pathfinding Queries,network,False,False,True,
What are the Versions dependent on the Software 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(v:Version)
RETURN v.name AS VersionName",Pathfinding Queries,network,False,False,True,
Which Processes are instances of the Software 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:INSTANCE]->(p:Process)
RETURN p",Pathfinding Queries,network,False,False,True,
Name the Applications running on Machines in Zone 4.,"MATCH (z:Zone {zone: 4})-[:ROUTES]->(i:Interface)-[:CONNECTS]-(mi:Interface)
MATCH (mi)-[:ROUTES]->(m:Machine)-[:RUNS]->(a:Application)
RETURN a.name AS ApplicationName",Pathfinding Queries,network,False,False,False,
List the top 3 Versions used by the Software 'RHEL'.,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)
RETURN v.name, count(v) AS usage
ORDER BY usage DESC
LIMIT 3",Pathfinding Queries,network,False,False,True,
Which Interfaces are directly connected to 'DC1-RE'?,"MATCH (r:Router {name: 'DC1-RE'})-[:ROUTES]->(i:Interface)
RETURN i",Pathfinding Queries,network,False,False,True,
What is the IP of the Interface in Rack 'DC1-RCK-1-1'?,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)-[:ROUTES]->(i:Interface)
RETURN i.ip AS InterfaceIP",Pathfinding Queries,network,False,False,False,
Which Switches are connected to Interfaces routing through network '10.2'?,"MATCH (n:Network {ip: '10.2'})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(s:Switch)
RETURN s",Pathfinding Queries,network,False,False,False,
List the first 3 Zones that have a size of 16.,"MATCH (z:Zone {size: 16})
RETURN z
LIMIT 3",Pathfinding Queries,network,False,False,True,
Which Routers have a connection to Interface with IP '10.3.8.253'?,"MATCH (r:Router)-[:ROUTES]->(i:Interface {ip: '10.3.8.253'})
RETURN r.name AS RouterName",Pathfinding Queries,network,False,False,True,
What are the dependencies of the application 'webapp'?,"MATCH (app:Application {name: 'webapp'})-[:DEPENDS_ON]->(dependency)
RETURN dependency",Pathfinding Queries,network,False,False,True,
Name the Egress points from the DataCenter 'DC1'.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(e:Egress)
RETURN e.name AS EgressName",Pathfinding Queries,network,False,False,False,
List the first 5 Ports listened to by the Service with name 'java'.,"MATCH (s:Service {name: 'java'})-[:LISTENS]->(p:Port)
RETURN p.port
LIMIT 5",Pathfinding Queries,network,False,False,False,
Which 3 machines in rack 'DC1-RCK-1-10' run the OS named 'RHEL'?,"MATCH (r:Rack {name: 'DC1-RCK-1-10'})-[:HOLDS]->(m:Machine)-[:RUNS]->(os:OS {name: 'RHEL'})
RETURN m LIMIT 3",Verbose query,network,False,False,True,
What are the first 3 Machines that run the OS starting after 1605733619064?,"MATCH (m:Machine)-[:RUNS]->(os:OS)
WHERE os.startTime > 1605733619064
RETURN m
ORDER BY os.startTime
LIMIT 3",Pathfinding Queries,network,False,False,False,
Which machines are running processes that depend on the service named 'java'?,"MATCH (m:Machine)-[:RUNS]->(p:Process)-[:DEPENDS_ON]->(s:Service {name: 'java'})
RETURN m.name AS MachineName",Simple Retrieval Queries,network,False,False,True,
What are the names and IPs of interfaces that connect to zone 1's network?,"MATCH (z:Zone {zone: 1})-[:ROUTES]->(i:Interface)
RETURN i.name, i.ip",Simple Retrieval Queries,network,False,False,True,Interface.name
List the first 3 services that depend on the process named '8966'.,"MATCH (p:Process {name: '8966'})-[:DEPENDS_ON]->(s:Service)
RETURN s
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
Which processes are instances of version '7.1' and listen to port 80?,"MATCH (p:Process)-[:INSTANCE]->(v:Version {name: '7.1'})
WHERE exists {
  (p)-[:LISTENS]->(:Port {port: 80})
}
RETURN p",Simple Retrieval Queries,network,False,False,True,
Find the top 3 types of machines by RAM that are held in racks in zone 1.,"MATCH (r:Rack {zone: 1})-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN t.type AS MachineType, t.ram AS RAM
ORDER BY t.ram DESC
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Identify all previous versions of the software named 'RHEL' that are depended upon by other software.,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)
MATCH (v)-[:PREVIOUS*]->(prev:Version)
WHERE exists {
    (prev)<-[:VERSION]-(dep:Software)-[:DEPENDS_ON]->(s)
}
RETURN prev",Simple Retrieval Queries,network,False,False,False,
What are the names of all machines in rack 'DC1-RCK-1-1' and their respective applications?,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)-[:RUNS]->(a:Application)
RETURN m.name AS MachineName, a.name AS ApplicationName",Simple Retrieval Queries,network,False,False,True,
List the top 3 networks by size that route through interfaces in zone 4.,"MATCH (n:Network)-[:ROUTES]->(i:Interface)
WHERE n.zone = 4
RETURN n.name, n.size
ORDER BY n.size DESC
LIMIT 3",Simple Retrieval Queries,network,False,False,True,Network.name
Which applications are instances of service named 'java'?,"MATCH (s:Service {name: 'java'})-[:INSTANCE]->(a:Application)
RETURN a.name AS ApplicationName",Simple Retrieval Queries,network,False,False,True,
What are the dependencies of the service named 'java' that started after 1605733619064?,"MATCH (s:Service {name: 'java'})
WHERE s.startTime > 1605733619064
MATCH (s)-[:INSTANCE|DEPENDS_ON*]->(dependency)
RETURN s.name AS ServiceName, s.startTime AS StartTime, COLLECT(dependency.name) AS Dependencies",Simple Retrieval Queries,network,False,False,True,
Find the top 5 types of machines by CPU in racks located in zone 2.,"MATCH (r:Rack {zone: 2})-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN t.type AS MachineType, t.cpu AS CPU
ORDER BY t.cpu DESC
LIMIT 5",Simple Retrieval Queries,network,False,False,False,
Which ports does the OS 'RHEL' listen to through its services?,"MATCH (os:OS {name: 'RHEL'})-[:RUNS]->(service:Service)-[:LISTENS]->(port:Port)
RETURN DISTINCT port.port AS ListeningPorts",Simple Retrieval Queries,network,False,False,False,
List the first 3 processes that are instances of software named 'webapp'.,"MATCH (p:Process)-[:INSTANCE]->(s:Software {name: 'webapp'})
RETURN p
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Which services started between timestamps 1605733619064 and 1606597376483 and listen to port 80?,"MATCH (s:Service)-[:LISTENS]->(p:Port {port: 80})
WHERE s.startTime >= 1605733619064 AND s.startTime <= 1606597376483
RETURN s",Simple Retrieval Queries,network,False,False,True,
What are the names of all switches in racks within zone 1?,"MATCH (r:Rack {zone: 1})-[:HOLDS]->(s:Switch)
RETURN s.name AS SwitchName",Simple Retrieval Queries,network,False,False,True,Switch.name
Find the top 3 racks by zone that contain the most machines.,"MATCH (r:Rack)-[:HOLDS]->(m:Machine)
RETURN r.zone, count(m) AS machine_count
ORDER BY machine_count DESC
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Which processes are instances of application named 'crm'?,"MATCH (app:Application {name: 'crm'})-[:INSTANCE]->(proc:Process)
RETURN proc",Simple Retrieval Queries,network,False,False,True,
List all versions that are previous to version named '7.1' and their dependencies.,"MATCH (v:Version {name: '7.1'})-[:PREVIOUS*]->(prev:Version)
OPTIONAL MATCH (prev)-[:DEPENDS_ON]->(dep)
RETURN prev, dep",Simple Retrieval Queries,network,False,False,False,
What are the names and IPs of interfaces that connect to network '10.3'?,"MATCH (n:Network {ip: '10.3'})-[:ROUTES]->(i:Interface)
RETURN i.name, i.ip",Simple Retrieval Queries,network,False,False,False,Interface.name
Which machines are running services that listen on port 80?,"MATCH (m:Machine)-[:RUNS]->(s:Service)-[:LISTENS]->(p:Port {port: 80})
RETURN m.name AS MachineName, s.name AS ServiceName",Simple Retrieval Queries,network,False,False,True,
Find the top 5 switches by rack number in zone 4.,"MATCH (z:Zone {zone: 4})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(s:Switch)
RETURN s.ip, s.rack
ORDER BY s.rack DESC
LIMIT 5",Simple Retrieval Queries,network,False,False,False,
What are the names of all routers routing through interface with IP '10.1.0.254'?,"MATCH (r:Router)-[:ROUTES]->(i:Interface {ip: '10.1.0.254'})
RETURN r.name",Simple Retrieval Queries,network,True,False,False,
List the top 3 types of machines based on disk size in racks located in zone 3.,"MATCH (r:Rack {zone: 3})-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN t.name AS TypeName, t.disk AS DiskSize
ORDER BY t.disk DESC
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
Which applications and their start times are running on machines in zone 2?,"MATCH (z:Zone {zone: 2})-[:ROUTES]->(i:Interface)-[:CONNECTS]->(m:Machine)-[:RUNS]->(a:Application)
RETURN a.name AS ApplicationName, a.startTime AS StartTime",Simple Retrieval Queries,network,False,False,True,
Identify the first 5 ports listened to by the process named '8966'.,"MATCH (p:Process {name: '8966'})-[:LISTENS]->(port:Port)
RETURN port.port
LIMIT 5",Simple Retrieval Queries,network,False,False,True,
What are the dependencies of the application named 'logstash'?,"MATCH (app:Application {name: 'logstash'})-[:DEPENDS_ON]->(dependency)
RETURN app.name AS Application, dependency.name AS Dependency",Simple Retrieval Queries,network,False,False,True,
List the first 3 services that are instances of the application named 'webserver'.,"MATCH (app:Application {name: 'webserver'})-[:INSTANCE]->(service:Service)
RETURN service
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Which versions of software named 'RHEL' are used by processes started after 1605733619064?,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)
WHERE exists {
    (s)<-[:INSTANCE]-(:Process {startTime: date}) WHERE date > 1605733619064
}
RETURN v.name",Simple Retrieval Queries,network,False,False,True,
Which applications listen to ports managed by software 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version),
      (s)-[:DEPENDS_ON]->(app:Application),
      (app)-[:LISTENS]->(p:Port)
RETURN app.name AS Application, collect(p.port) AS Ports",Simple Retrieval Queries,network,False,False,True,
What are the types of machines that are running applications named 'cms'?,"MATCH (m:Machine)-[:RUNS]->(a:Application {name: 'cms'})
MATCH (m)-[:TYPE]->(t:Type)
RETURN DISTINCT t.type AS MachineType",Simple Retrieval Queries,network,False,False,True,
Identify the first 5 machines by name that run the application named 'webserver'.,"MATCH (m:Machine)-[:RUNS]->(a:Application {name: 'webserver'})
RETURN m.name
LIMIT 5",Simple Retrieval Queries,network,False,False,True,
List all types of machines in rack 'DC1-RCK-1-1' and their disk sizes.,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN t.type AS MachineType, t.disk AS DiskSize",Simple Retrieval Queries,network,False,False,True,
Display the first 5 processes running on machine 'DC1-RCK-1-1-M-1' with PID greater than 5000.,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(p:Process)
WHERE p.pid > 5000
RETURN p
LIMIT 5",Complex Retrieval Queries,network,False,False,True,
Identify the first 3 machines running the application 'webserver'.,"MATCH (m:Machine)-[:RUNS]->(a:Application {name: 'webserver'})
RETURN m
LIMIT 3",Complex Retrieval Queries,network,False,False,True,
Which switches are located in rack 'DC1-RCK-1-1'?,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(s:Switch)
RETURN s",Complex Retrieval Queries,network,False,False,True,
Which DataCenter has the egress named 'DC1-RE'?,"MATCH (dc:DataCenter)-[:CONTAINS]->(e:Egress {name: 'DC1-RE'})
RETURN dc.name",Complex Retrieval Queries,network,False,False,True,
How many versions of the software 'RHEL' exist?,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)
RETURN count(v) AS NumberOfVersions",Complex Retrieval Queries,network,False,False,True,
What are the top 3 applications listening on port 80?,"MATCH (p:Port {port: 80})<-[:LISTENS]-(app:Application)
RETURN app.name AS ApplicationName
ORDER BY app.startTime DESC
LIMIT 3",Complex Retrieval Queries,network,False,False,False,
List the first 3 versions of software 'RHEL' installed on any machine.,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)
RETURN v.name
ORDER BY v.name
LIMIT 3",Complex Retrieval Queries,network,False,False,True,
What are the top 3 services running on machines in rack 'DC1-RCK-1-1'?,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)-[:RUNS]->(s:Service)
RETURN s.name, count(s) AS service_count
ORDER BY service_count DESC
LIMIT 3",Complex Retrieval Queries,network,False,False,False,
Find the top 5 egress routes from DataCenter 'DC1'.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(e:Egress)-[:ROUTES]->(i:Interface)
RETURN e.name AS EgressName, i.ip AS InterfaceIP
ORDER BY e.name
LIMIT 5",Complex Retrieval Queries,network,False,False,True,
Which type of machine has the maximum CPU capacity?,"MATCH (t:Type)
RETURN t.name AS MachineType, t.cpu AS CPUCapacity
ORDER BY t.cpu DESC
LIMIT 1",Complex Retrieval Queries,network,False,False,True,
List all the types of machines available in rack 'DC1-RCK-1-1'.,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN DISTINCT t.name AS MachineType",Complex Retrieval Queries,network,False,False,True,
Identify the first 3 networks routing through interface with IP '10.0.0.254'.,"MATCH (n:Network)-[:ROUTES]->(i:Interface {ip: '10.0.0.254'})
RETURN n
LIMIT 3",Complex Retrieval Queries,network,False,False,True,
What are the top 3 recent applications run on machine 'DC1-RCK-1-1-M-1'?,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(a:Application)
RETURN a.name, a.startTime
ORDER BY a.startTime DESC
LIMIT 3",Complex Retrieval Queries,network,False,False,False,
Name the top 5 software dependencies for the software 'RHEL'.,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(dep:Software)
RETURN dep.name, count(dep) AS dependency_count
ORDER BY dependency_count DESC
LIMIT 5",Complex Retrieval Queries,network,False,False,False,
How many machines are held in the rack 'DC1-RCK-1-1'?,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)
RETURN count(m) AS NumberOfMachines",Complex Retrieval Queries,network,False,False,True,
Find all interfaces connected to router 'DC1-R-2'.,"MATCH (r:Router {name: 'DC1-R-2'})-[:ROUTES]->(i:Interface)
RETURN i",Complex Retrieval Queries,network,False,False,True,
Which DataCenter contains the router 'DC1-R-1'?,"MATCH (dc:DataCenter)-[:CONTAINS]->(r:Router {name: 'DC1-R-1'})
RETURN dc.name",Complex Retrieval Queries,network,False,False,False,
List the top 3 routers located in zone 1.,"MATCH (r:Router {zone: 1})
RETURN r
ORDER BY r.name
LIMIT 3",Complex Retrieval Queries,network,False,False,False,
List the first 3 previous versions of the version named '7.1' and their software dependencies.,"MATCH (v:Version {name: '7.1'})-[:PREVIOUS*1..3]->(prev:Version)
OPTIONAL MATCH (prev)-[:DEPENDS_ON]->(s:Software)
RETURN prev.name AS Version, collect(s.name) AS Dependencies",Simple Retrieval Queries,network,False,False,False,
Which ports are listened to by all processes running on OS 'RHEL'?,"MATCH (os:OS {name: 'RHEL'})-[:RUNS]->(proc:Process)-[:LISTENS]->(port:Port)
RETURN DISTINCT port.port",Simple Retrieval Queries,network,False,False,True,
Find the top 5 applications by start time running on machines in rack 'DC1-RCK-1-1'.,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)-[:RUNS]->(a:Application)
RETURN a.name, a.startTime
ORDER BY a.startTime DESC
LIMIT 5",Simple Retrieval Queries,network,False,False,False,
What are the names and IPs of all switches in zone 4?,"MATCH (s:Switch)-[:HOLDS]-(:Rack {zone: 4})
RETURN s.name AS SwitchName, s.ip AS SwitchIP",Simple Retrieval Queries,network,False,False,True,Switch.name
List the top 3 networks by IP that are routed through interfaces connected to routers in zone 3.,"MATCH (r:Router {zone: 3})-[:ROUTES]->(i:Interface)-[:ROUTES]->(n:Network)
RETURN n.ip AS NetworkIP
ORDER BY n.ip
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
Identify all applications that are instances of process named '8966'.,"MATCH (p:Process {name: '8966'})-[:INSTANCE]->(a:Application)
RETURN a",Simple Retrieval Queries,network,False,False,False,
What are the dependencies of the software named 'RHEL' that are versions?,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(v:Version)
RETURN s.name AS Software, v.name AS Version",Simple Retrieval Queries,network,False,False,True,
Find the top 5 racks by zone that contain the most types of machines.,"MATCH (r:Rack)-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
WITH r.zone AS zone, r.name AS rackName, COUNT(DISTINCT t) AS typeCount
ORDER BY typeCount DESC
RETURN zone, rackName, typeCount
LIMIT 5",Simple Retrieval Queries,network,False,False,True,
Which versions of software are instances of other applications?,"MATCH (s:Software)-[:INSTANCE]->(a:Application)
RETURN s.name AS SoftwareName, a.name AS ApplicationName",Simple Retrieval Queries,network,False,False,True,
What are the IP addresses of all interfaces in routers located in zone 2?,"MATCH (r:Router {zone: 2})-[:ROUTES]->(i:Interface)
RETURN i.ip AS InterfaceIP",Simple Retrieval Queries,network,False,False,False,
Find the top 5 machines by name running the OS 'RHEL' in rack 'DC1-RCK-1-1'.,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)-[:RUNS]->(os:OS {name: 'RHEL'})
RETURN m.name
ORDER BY m.name
LIMIT 5",Simple Retrieval Queries,network,False,False,False,
Identify the first 5 applications by version that depend on the software 'RHEL'.,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)
WITH s, v
MATCH (s)-[:DEPENDS_ON]->(app:Application)
RETURN app.name, v.name
ORDER BY v.name
LIMIT 5",Simple Retrieval Queries,network,False,False,False,
List all processes that depend on the service named 'java'.,"MATCH (s:Service {name: 'java'})<-[:DEPENDS_ON]-(p:Process)
RETURN p",Simple Retrieval Queries,network,False,False,True,
Which racks in zone 4 hold more than 5 machines?,"MATCH (r:Rack {zone: 4})-[:HOLDS]->(m:Machine)
WITH r, count(m) AS machineCount
WHERE machineCount > 5
RETURN r.name, machineCount",Simple Retrieval Queries,network,False,False,True,
What are the names of the switches located in rack 'DC1-RCK-1-1'?,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(s:Switch)
RETURN s.name AS SwitchName",Simple Retrieval Queries,network,False,False,True,Switch.name
List the first 3 previous versions for version named '7.1'.,"MATCH (v:Version {name: '7.1'})-[:PREVIOUS*1..3]->(prev:Version)
RETURN prev.name",Simple Retrieval Queries,network,False,False,False,
Which services are instances of software named 'RHEL'?,"MATCH (s:Service)-[:INSTANCE]->(soft:Software {name: 'RHEL'})
RETURN s",Simple Retrieval Queries,network,False,False,False,
Find all machines running OS named 'RHEL' in the first 5 racks of zone 1.,"MATCH (dc:DataCenter)-[:CONTAINS]->(r:Rack {zone: 1})
WHERE r.rack <= 5
MATCH (r)-[:HOLDS]->(m:Machine)-[:RUNS]->(os:OS {name: 'RHEL'})
RETURN m.name AS MachineName, os.name AS OSName",Simple Retrieval Queries,network,False,False,True,
What are the top 3 processes that listen on port 80?,"MATCH (p:Process)-[:LISTENS]->(port:Port {port: 80})
RETURN p
ORDER BY p.startTime DESC
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
List the first 3 applications that started after timestamp 1606165629748.,"MATCH (a:Application)
WHERE a.startTime > 1606165629748
RETURN a
ORDER BY a.startTime ASC
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Which software depends on version '7.1'?,"MATCH (v:Version {name: '7.1'})<-[:VERSION]-(s:Software)
RETURN s.name AS SoftwareName",Simple Retrieval Queries,network,False,False,True,
Identify the first 5 types of machines in zone 3 by rack.,"MATCH (z:Zone {zone: 3})-[:ROUTES]->(i:Interface)-[:CONNECTS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN t.type AS MachineType, t.name AS TypeName
ORDER BY t.id
LIMIT 5",Simple Retrieval Queries,network,False,False,True,
Find the first 3 networks routing through interface with IP '10.1.0.254'.,"MATCH (n:Network)-[:ROUTES]->(i:Interface {ip: '10.1.0.254'})
RETURN n
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
Which racks are contained within Data Center DC1 and are in zone 2?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack {zone: 2})
RETURN r",Simple Retrieval Queries,network,False,False,True,
What are the names of the egress nodes in Data Center DC1?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(e:Egress)
RETURN e.name",Simple Retrieval Queries,network,False,False,True,
Can you list the first 4 dependencies of the 'webserver' application?,"MATCH (app:Application {name: 'webserver'})-[:DEPENDS_ON]->(dependency)
RETURN dependency
LIMIT 4",Simple Retrieval Queries,network,False,False,False,
Display the top 3 services by PID running in Data Center DC1.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(s:Service)
RETURN s.name, s.pid
ORDER BY s.pid DESC
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Which applications listen on port 80?,"MATCH (p:Port {port: 80})<-[:LISTENS]-(app:Application)
RETURN app.name",Simple Retrieval Queries,network,False,False,True,
List all versions that software 'RHEL' depends on.,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(v:Version)
RETURN v.name AS VersionName",Simple Retrieval Queries,network,False,False,True,
Which racks in zone 1 contain switches with IP starting with '10.1'?,"MATCH (r:Rack {zone: 1})-[:HOLDS]->(s:Switch)
WHERE s.ip STARTS WITH '10.1'
RETURN r.name AS RackName, s.ip AS SwitchIP",Simple Retrieval Queries,network,False,False,True,
Find the first 5 processes running on any machine in Data Center DC1.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(p:Process)
RETURN p
LIMIT 5",Simple Retrieval Queries,network,False,False,True,
Which ports are exposed by the interface with IP '10.0.0.254'?,"MATCH (i:Interface {ip: '10.0.0.254'})-[:EXPOSES]->(p:Port)
RETURN p.port",Simple Retrieval Queries,network,False,False,True,
List all software versions associated with the software named 'RHEL'.,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)
RETURN v.name AS Version",Simple Retrieval Queries,network,False,False,True,
What are the names of applications running on machines in rack 'DC1-RCK-1-1'?,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)-[:RUNS]->(a:Application)
RETURN a.name",Simple Retrieval Queries,network,False,False,True,
Identify the top 5 machines held in racks within zone 1.,"MATCH (r:Rack)-[:HOLDS]->(m:Machine)
WHERE r.zone = 1
RETURN m
ORDER BY m.name
LIMIT 5",Simple Retrieval Queries,network,False,False,True,
Which interfaces are connected to the router named 'DC1-R-1'?,"MATCH (r:Router {name: 'DC1-R-1'})-[:ROUTES]->(i:Interface)
RETURN i",Simple Retrieval Queries,network,False,False,False,
List the first 3 zones by IP address in ascending order.,"MATCH (z:Zone)
RETURN z.ip AS IP_Address
ORDER BY z.ip ASC
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
What are the names of the top 3 routers in Data Center DC1?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Router)
RETURN r.name
ORDER BY r.name
LIMIT 3",Simple Retrieval Queries,network,True,False,False,
Identify the top 5 applications by PID that depend on the service 'java'.,"MATCH (app:Application)-[:DEPENDS_ON]->(serv:Service {name: 'java'})
RETURN app.name, app.pid
ORDER BY app.pid DESC
LIMIT 5",Simple Retrieval Queries,network,False,False,True,
What are the IP addresses of networks in zone 2?,"MATCH (n:Network {zone: 2})
RETURN n.ip AS NetworkIP",Simple Retrieval Queries,network,False,False,True,
What are the top 3 largest types by disk size available in the system?,"MATCH (t:Type)
RETURN t.name, t.disk
ORDER BY t.disk DESC
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Which applications have 'cms' as a dependency?,"MATCH (app:Application)-[:DEPENDS_ON*]->(dep:Application {name: 'cms'})
RETURN DISTINCT app.name",Simple Retrieval Queries,network,False,False,True,
List the first 3 racks by name that contain switches.,"MATCH (r:Rack)-[:HOLDS]->(s:Switch)
RETURN r.name
LIMIT 3",Simple Retrieval Queries,network,False,False,False,
Identify all previous versions of the version named '7.1' that are used by a software.,"MATCH (v:Version {name: '7.1'})-[:PREVIOUS*]->(prev:Version)
WHERE exists {
    (prev)<-[:VERSION]-(s:Software)
}
RETURN prev, s",Simple Retrieval Queries,network,False,False,True,
What are the names of all egress nodes routing through interface with IP '10.0.0.254'?,"MATCH (e:Egress)-[:ROUTES]->(i:Interface {ip: '10.0.0.254'})
RETURN e.name",Simple Retrieval Queries,network,False,False,True,
List the first 3 interfaces that connect to routers in zone 1.,"MATCH (r:Router {zone: 1})-[:ROUTES]->(i:Interface)
RETURN i
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Which applications are instances of software named 'webapp'?,"MATCH (app:Application)-[:INSTANCE]->(soft:Software {name: 'webapp'})
RETURN app.name",Simple Retrieval Queries,network,False,False,False,
Which processes are instances of version '7.1'?,"MATCH (v:Version {name: '7.1'})<-[:INSTANCE]-(p:Process)
RETURN p",Simple Retrieval Queries,network,False,False,True,
List the first 3 ports exposed by any service running on OS 'RHEL'.,"MATCH (os:OS {name: 'RHEL'})-[:RUNS]->(service:Service)-[:LISTENS]->(port:Port)
RETURN port.port
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
What are the IP addresses of interfaces that are connected to zone 3's network?,"MATCH (z:Zone {zone: 3})-[:ROUTES]->(i:Interface)
RETURN i.ip AS InterfaceIP",Simple Retrieval Queries,network,False,False,False,
Identify the top 5 types of machines by CPU power available in the system.,"MATCH (m:Machine)-[:TYPE]->(t:Type)
RETURN t.type AS MachineType, t.cpu AS CPUPower
ORDER BY t.cpu DESC
LIMIT 5",Simple Retrieval Queries,network,False,False,True,
Which racks contain machines running application named 'logstash'?,"MATCH (r:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(a:Application {name: 'logstash'})
RETURN r.name AS RackName",Simple Retrieval Queries,network,False,False,True,
What are the dependencies of the process named '8966'?,"MATCH (p:Process {name: '8966'})-[:DEPENDS_ON]->(dependency)
RETURN p.name AS ProcessName, dependency.name AS DependencyName",Simple Retrieval Queries,network,False,False,False,
Find the top 3 largest services by RAM usage in Data Center DC1.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(s:Service),
      (m)-[:TYPE]->(t:Type)
RETURN s.name AS ServiceName, t.ram AS RAMUsage
ORDER BY t.ram DESC
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Find the top 3 types of machines by RAM in racks located in zone 4.,"MATCH (r:Rack {zone: 4})-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN t.type AS MachineType, t.ram AS RAM
ORDER BY t.ram DESC
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
List the first 3 applications that are dependencies of processes named '7.1'.,"MATCH (p:Process {name: '7.1'})-[:DEPENDS_ON]->(a:Application)
RETURN a.name
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Which ports does the application 'crm' listen to?,"MATCH (app:Application {name: 'crm'})-[:LISTENS]->(port:Port)
RETURN app.name AS Application, port.port AS Port",Simple Retrieval Queries,network,False,False,True,
Find the top 5 processes by PID that are instances of application 'webapp'.,"MATCH (p:Process)-[:INSTANCE]->(a:Application {name: 'webapp'})
RETURN p
ORDER BY p.pid DESC
LIMIT 5",Simple Retrieval Queries,network,False,False,True,
What ports are listened to by the service named 'java'?,"MATCH (s:Service {name: 'java'})-[:LISTENS]->(p:Port)
RETURN p.port",Simple Retrieval Queries,network,False,False,True,
List all machines and their types in rack 'DC1-RCK-1-1'.,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN m.name AS MachineName, t.name AS TypeName",Simple Retrieval Queries,network,False,False,True,
What are the top 3 software names that depend on 'webserver'?,"MATCH (s:Software)-[:DEPENDS_ON*]->(a:Application {name: 'webserver'})
RETURN s.name AS SoftwareName, count(*) AS DependencyCount
ORDER BY DependencyCount DESC
LIMIT 3",Simple Retrieval Queries,network,False,False,True,
Which versions of software are depended upon by more than one other software?,"MATCH (s:Software)-[:DEPENDS_ON]->(v:Version)
WITH v, count(DISTINCT s) AS softwareCount
WHERE softwareCount > 1
RETURN v.name AS VersionName, softwareCount",Simple Retrieval Queries,network,False,False,True,
Which services started after timestamp 1605733619064 and before 1606597376483?,"MATCH (s:Service)
WHERE s.startTime > 1605733619064 AND s.startTime < 1606597376483
RETURN s",Simple Retrieval Queries,network,False,False,True,
What are the names and IPs of all interfaces connected to network '10.2'?,"MATCH (n:Network {ip: '10.2'})-[:ROUTES]->(i:Interface)
RETURN i.name, i.ip",Simple Retrieval Queries,network,False,False,False,Interface.name
Identify all applications running on machines that are of type 'xl'.,"MATCH (m:Machine)-[:TYPE]->(t:Type {type: 'xl'})
MATCH (m)-[:RUNS]->(a:Application)
RETURN m.name AS MachineName, a.name AS ApplicationName",Simple Retrieval Queries,network,False,False,True,
Which product categories do not have any discontinued items?,"MATCH (c:Category)
WHERE NOT EXISTS {
    MATCH (c)<-[:PART_OF]-(p:Product)
    WHERE p.discontinued = TRUE
}
RETURN c.categoryName",Pathfinding Queries,northwind,False,False,True,
Which products are supplied by suppliers from the UK?,"MATCH (s:Supplier {country: 'UK'})-[:SUPPLIES]->(p:Product)
RETURN p.productName AS ProductName, p.productID AS ProductID",Pathfinding Queries,northwind,False,False,False,
Find the top 5 most frequently ordered products.,"MATCH (p:Product)<-[:ORDERS]-(:Order)
WITH p, count(*) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 5
RETURN p.productName, ordersCount",Pathfinding Queries,northwind,False,False,True,
List three customers who have purchased products ordered on '1996-07-04 00:00:00.000'.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order {orderDate: '1996-07-04 00:00:00.000'})
RETURN c.companyName, c.contactName
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
Which suppliers supply products to more than five different categories?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH s, count(DISTINCT c) AS numCategories
WHERE numCategories > 5
RETURN s",Pathfinding Queries,northwind,False,False,True,
What are the top 5 suppliers by number of products supplied?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, count(p) AS products_supplied
ORDER BY products_supplied DESC
LIMIT 5
RETURN s.companyName, products_supplied",Pathfinding Queries,northwind,False,False,True,
What are the top 3 categories with the most products?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c, count(p) AS productCount
ORDER BY productCount DESC
LIMIT 3
RETURN c.categoryName, productCount",Pathfinding Queries,northwind,False,False,True,
List all products that have 'seafood' in their category description.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE c.description CONTAINS 'seafood'
RETURN p",Pathfinding Queries,northwind,False,False,True,
List the top 5 orders with the highest quantity ordered.,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
RETURN o.orderID, SUM(r.quantity) AS TotalQuantity
ORDER BY TotalQuantity DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
Which categories include products with a reorder level of 25?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.reorderLevel = 25
RETURN DISTINCT c.categoryName",Pathfinding Queries,northwind,False,False,True,
Which products have a reorder level greater than 20 and are not discontinued?,"MATCH (p:Product)
WHERE p.reorderLevel > 20 AND p.discontinued = false
RETURN p.productName, p.productID, p.unitsInStock, p.unitPrice",Pathfinding Queries,northwind,False,False,True,
What are the top 3 most expensive products supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
Can you find three suppliers who supply 'Chang'?,"MATCH (p:Product {productName: 'Chang'})<-[:SUPPLIES]-(s:Supplier)
RETURN s
LIMIT 3",Pathfinding Queries,northwind,False,False,False,
What are the three products with the highest units on order?,"MATCH (p:Product)
WHERE p.unitsOnOrder IS NOT NULL
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
List the top 5 products that have been discontinued.,"MATCH (p:Product)
WHERE p.discontinued = true
RETURN p.productName, p.productID
ORDER BY p.productID
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
Who are the top 3 customers by number of orders placed in 1996?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE o.orderDate STARTS WITH '1996'
WITH c, count(o) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 3
RETURN c.companyName, ordersCount",Complex Aggregation Queries,northwind,False,False,True,
What are the names of the top 3 products with the highest units on order and are part of the 'Dairy Products' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
WHERE p.unitsOnOrder IS NOT NULL
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
Which products have a quantity per unit of '10 boxes x 20 bags'?,"MATCH (p:Product)
WHERE p.quantityPerUnit = '10 boxes x 20 bags'
RETURN p",Pathfinding Queries,northwind,False,False,True,
List the first 3 products with a discontinued status and a reorder level greater than 15.,"MATCH (p:Product)
WHERE p.discontinued = true AND p.reorderLevel > 15
RETURN p
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
Which product supplied by 'Exotic Liquids' has the least units in stock?,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)
RETURN p.productName AS ProductName, p.unitsInStock AS UnitsInStock
ORDER BY p.unitsInStock ASC
LIMIT 1",Pathfinding Queries,northwind,False,False,True,
Which categories have the least products available in stock?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c, sum(p.unitsInStock) AS totalUnitsInStock
ORDER BY totalUnitsInStock ASC
RETURN c.categoryName, totalUnitsInStock
LIMIT 1",Pathfinding Queries,northwind,False,False,True,
Find the top 3 orders by freight cost.,"MATCH (o:Order)
RETURN o
ORDER BY o.freight DESC
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
Find the top 5 most costly products in terms of unit price supplied by 'Exotic Liquids'.,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
Which products have been reordered when the stock level was below 5?,"MATCH (p:Product)
WHERE p.unitsInStock < 5 AND p.unitsOnOrder > 0
RETURN p.productName, p.unitsInStock, p.unitsOnOrder",Pathfinding Queries,northwind,False,False,True,
Which orders have a required date later than '1997-01-01' and were ordered by customers from 'Berlin'?,"MATCH (c:Customer {city: 'Berlin'})-[:PURCHASED]->(o:Order)
WHERE o.requiredDate > '1997-01-01'
RETURN o",Simple Aggregation Queries,northwind,False,False,True,
Which products have a unitsInStock count between 10 and 20?,"MATCH (p:Product)
WHERE p.unitsInStock >= 10 AND p.unitsInStock <= 20
RETURN p.productName, p.unitsInStock",Pathfinding Queries,northwind,False,False,False,
What are the top 5 most expensive products supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 5",Complex Aggregation Queries,northwind,False,False,False,
List the first 3 categories that have products with a unit price over $100.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitPrice > 100
RETURN DISTINCT c
LIMIT 3",Complex Aggregation Queries,northwind,False,False,True,
Which suppliers have a product named 'Chai' in their product list?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product {productName: 'Chai'})
RETURN s.companyName AS SupplierName",Complex Aggregation Queries,northwind,False,False,True,
List three suppliers based in 'London'.,"MATCH (s:Supplier {city: 'London'})
RETURN s
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
What are the top 5 products with the highest units in stock in the 'Condiments' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Condiments'})
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 5",Complex Aggregation Queries,northwind,False,False,True,
Find all products that are discontinued and supplied by a company in the UK.,"MATCH (p:Product)-[:SUPPLIES]->(s:Supplier)
WHERE p.discontinued = TRUE AND s.country = 'UK'
RETURN p",Complex Aggregation Queries,northwind,False,False,False,
Which products have been ordered more than 100 times?,"MATCH (p:Product)-[o:ORDERS]->(:Order)
WITH p, count(o) AS ordersCount
WHERE ordersCount > 100
RETURN p.productName, ordersCount",Pathfinding Queries,northwind,False,False,True,
What are the three most common product categories ordered in 'Reims'?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(cat:Category)
WHERE o.shipCity = 'Reims'
WITH cat, count(o) AS orders
ORDER BY orders DESC
LIMIT 3
RETURN cat.categoryName, orders",Pathfinding Queries,northwind,False,False,True,
Which suppliers provide products with a unit price less than $10?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.unitPrice < 10
RETURN s.companyName, p.productName, p.unitPrice",Pathfinding Queries,northwind,False,False,True,
List the top 5 customers based on the number of orders made.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
RETURN c.companyName, count(o) AS NumberOfOrders
ORDER BY NumberOfOrders DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
What is the average discount given on orders during '1996-07-04 00:00:00.000'?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WHERE o.orderDate = '1996-07-04 00:00:00.000'
RETURN AVG(toFloat(r.discount)) AS averageDiscount",Pathfinding Queries,northwind,False,False,True,
Which orders include the product with productID '72'?,"MATCH (p:Product {productID: '72'})-[:ORDERS]->(o:Order)
RETURN o",Pathfinding Queries,northwind,False,False,True,
List three products that are in the 'Dairy Products' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
RETURN p.productName, p.productID
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
Which categories have products with a unit price over $50?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitPrice > 50
RETURN DISTINCT c.categoryName",Pathfinding Queries,northwind,False,False,True,
List the top 5 cities where the most products have been shipped.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
RETURN o.shipCity AS City, count(p) AS NumberOfProductsShipped
ORDER BY NumberOfProductsShipped DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
What are the names of the first 3 suppliers with a home page containing 'http'?,"MATCH (s:Supplier)
WHERE s.homePage CONTAINS 'http'
RETURN s.companyName
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
What are the descriptions of categories that have products with a reorder level greater than 15?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.reorderLevel > 15
RETURN DISTINCT c.description",Verbose query,northwind,False,False,False,
Which products are supplied by suppliers with a fax number of 'NULL'?,"MATCH (s:Supplier {fax: 'NULL'})-[:SUPPLIES]->(p:Product)
RETURN p.productName AS ProductName, p.productID AS ProductID",Simple Aggregation Queries,northwind,False,False,False,
Which customers from 'Reims' have placed orders?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE o.shipCity = 'Reims'
RETURN DISTINCT c.companyName",Simple Aggregation Queries,northwind,False,False,True,
What are the names of products with a reorder level greater than the average reorder level of all products?,"MATCH (p:Product)
WITH AVG(p.reorderLevel) AS avgReorderLevel
MATCH (p2:Product)
WHERE p2.reorderLevel > avgReorderLevel
RETURN p2.productName AS ProductName",Simple Aggregation Queries,northwind,False,False,True,
List the top 3 most reordered products.,"MATCH (p:Product)
WHERE p.reorderLevel > 0
RETURN p.productName, p.reorderLevel
ORDER BY p.reorderLevel DESC
LIMIT 3",Simple Aggregation Queries,northwind,False,False,False,
Which suppliers have a contact name starting with 'C'?,"MATCH (s:Supplier)
WHERE s.contactName STARTS WITH 'C'
RETURN s",Simple Aggregation Queries,northwind,False,False,True,
What are the top 3 products with the smallest discount?,"MATCH (p:Product)-[o:ORDERS]->()
WITH p, o
ORDER BY o.discount
RETURN p.productName, o.discount
LIMIT 3",Simple Aggregation Queries,northwind,False,False,False,
List the first 3 categories where the average units in stock per product is less than 20.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c, AVG(p.unitsInStock) AS avgUnitsInStock
WHERE avgUnitsInStock < 20
RETURN c
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
Which orders have a ship via option of '3' and were shipped to 'USA'?,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipVia = '3' AND o.shipCountry = 'USA'
RETURN o.orderID, o.shippedDate, o.shipName",Simple Aggregation Queries,northwind,False,False,True,
What are the names of the first 3 products supplied by suppliers from 'Germany'?,"MATCH (s:Supplier {country: 'Germany'})-[:SUPPLIES]->(p:Product)
RETURN p.productName
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
List the top 3 products that have been ordered the most times.,"MATCH (p:Product)-[o:ORDERS]->(:Order)
RETURN p.productName, count(o) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
Which suppliers have the most products currently on order?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.unitsOnOrder > 0
RETURN s.companyName, count(p) AS NumberOfProductsOnOrder
ORDER BY NumberOfProductsOnOrder DESC",Simple Aggregation Queries,northwind,True,False,False,
Which products have a reorder level above 20 and are currently out of stock?,"MATCH (p:Product)
WHERE p.reorderLevel > 20 AND p.unitsInStock = 0
RETURN p.productName, p.productID, p.reorderLevel, p.unitsInStock",Complex Aggregation Queries,northwind,False,False,True,
What are the names of the top 3 categories based on the average unit price of their products?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS CategoryName, AVG(p.unitPrice) AS AvgUnitPrice
ORDER BY AvgUnitPrice DESC
RETURN CategoryName, AvgUnitPrice
LIMIT 3",Simple Aggregation Queries,northwind,False,False,False,
List the first 3 products with a unit price between 10 and 20.,"MATCH (p:Product)
WHERE p.unitPrice >= 10 AND p.unitPrice <= 20
RETURN p
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
Which products have a 'reorder level' of 10 and are part of the 'Beverages' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
WHERE p.reorderLevel = 10
RETURN p.productName, p.productID, p.unitPrice",Simple Aggregation Queries,northwind,False,False,True,
What are the top 3 most expensive products in the 'Seafood' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Seafood'})
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
List the first 3 orders that have a shipped date exactly one week after the order date.,"MATCH (o:Order)
WHERE o.shippedDate = date(o.orderDate) + duration({days: 7})
RETURN o
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
Which suppliers are located in 'London'?,"MATCH (s:Supplier {city: 'London'})
RETURN s",Simple Aggregation Queries,northwind,False,False,True,
"What are the names of products that are part of a category with description 'Sweet and savory sauces, relishes, spreads, and se'?","MATCH (p:Product)-[:PART_OF]->(c:Category {description: 'Sweet and savory sauces, relishes, spreads, and se'})
RETURN p.productName AS ProductName",Simple Aggregation Queries,northwind,False,False,False,
List the top 3 customers by the number of orders placed.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
RETURN c.companyName, count(o) AS NumberOfOrders
ORDER BY NumberOfOrders DESC
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
"List the first 3 products that are part of the 'Desserts, candies, and sweet breads' category and have a reorder level less than 10.","MATCH (p:Product)-[:PART_OF]->(c:Category {description: 'Desserts, candies, and sweet breads'})
WHERE p.reorderLevel < 10
RETURN p
LIMIT 3",Simple Aggregation Queries,northwind,False,False,False,
List the first 3 products with a description containing 'sauces' in their category.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE c.description CONTAINS 'sauces'
RETURN p.productName, p.productID, p.unitPrice
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
What are the names of the first 3 suppliers whose companies have a phone number ending in '8'?,"MATCH (s:Supplier)
WHERE s.phone ENDS WITH '8'
RETURN s.companyName
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
List the top 3 customers who have ordered products in the 'Meat/Poultry' category.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(cat:Category {categoryName: 'Meat/Poultry'})
WITH c, COUNT(o) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 3
RETURN c.companyName, ordersCount",Simple Aggregation Queries,northwind,False,False,True,
What are the names of the top 3 orders with a freight cost greater than 100?,"MATCH (o:Order)
WHERE o.freight > 100
RETURN o.shipName AS OrderName
ORDER BY o.freight DESC
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
List the first 3 products with units in stock less than 10.,"MATCH (p:Product)
WHERE p.unitsInStock < 10
RETURN p
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
Which products have a reorder level of 25 and are supplied by suppliers from 'London'?,"MATCH (p:Product)-[:SUPPLIES]->(s:Supplier)
WHERE p.reorderLevel = 25 AND s.city = 'London'
RETURN p",Simple Aggregation Queries,northwind,False,False,True,
What are the names of the top 3 most reordered products in the 'Produce' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Produce'})
WHERE p.reorderLevel IS NOT NULL AND p.reorderLevel > 0
RETURN p.productName AS ProductName, p.reorderLevel AS ReorderLevel
ORDER BY p.reorderLevel DESC
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
List the first 3 orders with a ship name containing 'Vins et alcools Chevalier'.,"MATCH (o:Order)
WHERE o.shipName CONTAINS 'Vins et alcools Chevalier'
RETURN o
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
Which suppliers have a postal code starting with 'EC'?,"MATCH (s:Supplier)
WHERE s.postalCode STARTS WITH 'EC'
RETURN s",Simple Aggregation Queries,northwind,False,False,True,
What are the names of the top 3 suppliers based on the number of cities they supply to?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)<-[:ORDERS]-(o:Order)
WITH s, COUNT(DISTINCT o.shipCity) AS citiesSupplied
ORDER BY citiesSupplied DESC
LIMIT 3
RETURN s.companyName AS SupplierName, citiesSupplied",Simple Aggregation Queries,northwind,False,False,True,
List the top 3 products that are part of the 'Beverages' category and have been ordered more than 10 times.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
WHERE exists {
  MATCH (p)<-[:ORDERS]-(:Order)
  WHERE count{(p)<-[:ORDERS]-(:Order)} > 10
}
RETURN p.productName, p.productID
ORDER BY count{(p)<-[:ORDERS]-(:Order)} DESC
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
Which categories have the most products with a units on order greater than 20?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitsOnOrder > 20
RETURN c.categoryName, count(p) AS ProductCount
ORDER BY ProductCount DESC",Simple Aggregation Queries,northwind,False,False,True,
What are the names of the first 3 products with a quantity per unit of '48 - 6 oz jars'?,"MATCH (p:Product {quantityPerUnit: '48 - 6 oz jars'})
RETURN p.productName
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
List the first 3 orders that have been shipped to a region other than 'NULL'.,"MATCH (o:Order)
WHERE o.shipRegion IS NOT NULL
RETURN o
LIMIT 3",Simple Aggregation Queries,northwind,False,False,False,
Which products have a units on order value of 0 and are not discontinued?,"MATCH (p:Product)
WHERE p.unitsOnOrder = 0 AND p.discontinued = FALSE
RETURN p.productName, p.productID",Simple Aggregation Queries,northwind,False,False,True,
What are the names of the top 3 suppliers based on the average freight of orders they supplied?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)<-[:ORDERS]-(o:Order)
WITH s, AVG(o.freight) AS avgFreight
ORDER BY avgFreight DESC
LIMIT 3
RETURN s.companyName AS SupplierName, avgFreight",Simple Aggregation Queries,northwind,False,False,False,
List the first 3 products that have been ordered with a discount of 0 and are from the 'Grains/Cereals' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Grains/Cereals'})
WHERE exists {
  (p)<-[:ORDERS {discount: '0'}]-(:Order)
}
RETURN p
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
Which orders were placed by customers with a 'Sales Representative' contact title?,"MATCH (c:Customer {contactTitle: 'Sales Representative'})-[:PURCHASED]->(o:Order)
RETURN o",Simple Aggregation Queries,northwind,False,False,False,
What are the names of the top 3 categories based on the number of suppliers providing products to them?,"MATCH (c:Category)<-[:PART_OF]-(p:Product)<-[:SUPPLIES]-(s:Supplier)
WITH c, count(DISTINCT s) AS suppliersCount
ORDER BY suppliersCount DESC
RETURN c.categoryName AS CategoryName, suppliersCount
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
List the first 3 products from suppliers located in 'USA'.,"MATCH (s:Supplier {country: 'USA'})-[:SUPPLIES]->(p:Product)
RETURN p
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
Which suppliers supply products to more than two different ships?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:ORDERS]->(o:Order)
WITH s, count(DISTINCT o.shipName) AS shipCount
WHERE shipCount > 2
RETURN s.companyName, shipCount",Simple Aggregation Queries,northwind,False,False,True,
What are the names of the first 3 products that have a unit price less than 5 and are discontinued?,"MATCH (p:Product)
WHERE p.unitPrice < 5 AND p.discontinued = true
RETURN p.productName
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
Which products have been ordered more than 100 times?,"MATCH (p:Product)-[o:ORDERS]->(:Order)
WITH p, count(o) AS ordersCount
WHERE ordersCount > 100
RETURN p.productName, ordersCount",Simple Aggregation Queries,northwind,False,False,True,
List the first 3 suppliers who supply products in the 'Dairy Products' category.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
RETURN s
LIMIT 3",Complex Aggregation Queries,northwind,False,False,True,
Which suppliers have products in both 'Desserts' and 'Sauces' categories?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WHERE c.categoryName IN ['Desserts', 'Condiments']
WITH s, collect(c.categoryName) AS categories
WHERE ALL(cat IN ['Desserts', 'Condiments'] WHERE cat IN categories)
RETURN s",Complex Aggregation Queries,northwind,False,False,False,
What are the top 5 most ordered products by quantity from orders shipped to France?,"MATCH (p:Product)<-[:ORDERS]-(o:Order)
WHERE o.shipCountry = 'France'
RETURN p.productName, sum(toInteger(o.quantity)) AS TotalQuantity
ORDER BY TotalQuantity DESC
LIMIT 5",Complex Aggregation Queries,northwind,False,False,True,Order.quantity
Which categories contain products that are discontinued?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.discontinued = true
RETURN DISTINCT c.categoryName",Verbose query,northwind,False,False,True,
List the top 5 products with the highest units in stock.,"MATCH (p:Product)
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 5",Verbose query,northwind,False,False,True,
Which products have a reorder level of exactly 10?,"MATCH (p:Product)
WHERE p.reorderLevel = 10
RETURN p",Verbose query,northwind,False,False,False,
What are the top 5 most ordered products by customers from 'Portland'?,"MATCH (c:Customer {city: 'Portland'})-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
RETURN p.productName, sum(r.quantity) AS TotalQuantityOrdered
ORDER BY TotalQuantityOrdered DESC
LIMIT 5",Complex Aggregation Queries,northwind,False,False,False,
List the first 3 products with a unit price between $10 and $20 and a discontinued status of true.,"MATCH (p:Product)
WHERE p.unitPrice >= 10 AND p.unitPrice <= 20 AND p.discontinued = true
RETURN p
LIMIT 3",Complex Aggregation Queries,northwind,False,False,True,
Which products from 'Mayumi's' have been ordered with a discount of 0?,"MATCH (s:Supplier {companyName: ""Mayumi's""})-[:SUPPLIES]->(p:Product)-[o:ORDERS]->(:Order)
WHERE o.discount = ""0""
RETURN p.productName AS ProductName, p.productID AS ProductID",Complex Aggregation Queries,northwind,False,False,True,
Find all suppliers that have a home page listed and supply products in the 'Seafood' category.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Seafood'})
WHERE s.homePage IS NOT NULL
RETURN s",Complex Aggregation Queries,northwind,False,False,False,
What are the top 5 most ordered products by customers from 'Berlin'?,"MATCH (c:Customer {city: 'Berlin'})-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
RETURN p.productName, SUM(r.quantity) AS TotalQuantityOrdered
ORDER BY TotalQuantityOrdered DESC
LIMIT 5",Complex Aggregation Queries,northwind,False,False,True,
What are the names of suppliers who supply products in the 'Beverages' category?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
RETURN DISTINCT s.companyName AS SupplierName",Verbose query,northwind,False,False,True,
List the first 3 customers who have placed orders totaling over $1000 in freight costs.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE o.freight >= 1000
RETURN c
LIMIT 3",Complex Aggregation Queries,northwind,False,False,True,
Find all products that have been shipped to 'London' and have a unit price over $30.,"MATCH (p:Product)-[:ORDERS]->(o:Order)
WHERE o.shipCity = 'London' AND toFloat(p.unitPrice) > 30
RETURN p",Complex Aggregation Queries,northwind,False,False,False,
What are the top 5 products with the highest number of units on order in the 'Meat/Poultry' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Meat/Poultry'})
WHERE p.unitsOnOrder IS NOT NULL
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 5",Complex Aggregation Queries,northwind,False,False,True,
List the first 3 orders that included products from more than three different categories.,"MATCH (o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(c:Category)
WITH o, count(DISTINCT c) AS numCategories
WHERE numCategories > 3
RETURN o
ORDER BY o.orderDate
LIMIT 3",Complex Aggregation Queries,northwind,False,False,True,
Which products have a discounted price of less than $15 in any of their orders?,"MATCH (p:Product)-[o:ORDERS]->(:Order)
WHERE toFloat(o.unitPrice) * (1 - toFloat(o.discount)) < 15
RETURN p.productName, p.productID, o.unitPrice, o.discount",Complex Aggregation Queries,northwind,False,False,True,
Find all suppliers who have a product in the 'Grains/Cereals' category with a reorder level above 10.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Grains/Cereals'})
WHERE p.reorderLevel > 10
RETURN s",Complex Aggregation Queries,northwind,False,False,True,
What are the top 5 most frequently shipped cities for orders?,"MATCH (o:Order)
RETURN o.shipCity AS City, count(o) AS NumberOfShipments
ORDER BY NumberOfShipments DESC
LIMIT 5",Complex Aggregation Queries,northwind,False,False,True,
List the first 3 products in the 'Beverages' category that have a unitsInStock greater than 50.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
WHERE p.unitsInStock > 50
RETURN p
LIMIT 3",Complex Aggregation Queries,northwind,False,False,True,
Which products from 'Exotic Liquids' have been ordered in quantities of less than 10?,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)-[o:ORDERS]->(ord:Order)
WHERE o.quantity < 10
RETURN p.productName, o.quantity",Complex Aggregation Queries,northwind,False,False,True,
Which suppliers provide products to more than one category? List the top 5 based on the number of categories supplied.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH s, count(DISTINCT c) AS numCategories
WHERE numCategories > 1
RETURN s.companyName, numCategories
ORDER BY numCategories DESC
LIMIT 5",Verbose query,northwind,False,False,True,
How many products does each supplier supply? Limit the results to the top 5 suppliers.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, count(p) AS productsSupplied
ORDER BY productsSupplied DESC
LIMIT 5
RETURN s.companyName, productsSupplied",Verbose query,northwind,False,False,False,
Which customers have purchased orders that include the product named 'Chai'?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product {productName: 'Chai'})
RETURN DISTINCT c.companyName AS CustomerName",Verbose query,northwind,False,False,True,
What are the top 3 orders with the highest quantity of a single product ordered?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
RETURN o.orderID, p.productID, r.quantity
ORDER BY r.quantity DESC
LIMIT 3",Verbose query,northwind,False,False,True,
List the top 3 categories based on the number of products they contain.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c, count(p) AS productCount
ORDER BY productCount DESC
LIMIT 3
RETURN c.categoryName, productCount",Verbose query,northwind,False,False,False,
Which products are supplied by companies located in 'London'?,"MATCH (s:Supplier {city: 'London'})-[:SUPPLIES]->(p:Product)
RETURN p.productName AS ProductName, p.productID AS ProductID",Verbose query,northwind,False,False,True,
Provide the names of all products that have a quantity per unit description containing 'bottles'.,"MATCH (p:Product)
WHERE p.quantityPerUnit CONTAINS 'bottles'
RETURN p.productName",Verbose query,northwind,False,False,True,
Which orders were placed by customers from 'USA' and have a shipped date later than '1997-06-01'?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE c.country = 'USA' AND o.shippedDate > '1997-06-01'
RETURN o.orderID, o.shippedDate, c.companyName",Verbose query,northwind,True,False,False,
Find products that have never been ordered (units on order = 0) and list the top 5 based on unit price.,"MATCH (p:Product)
WHERE p.unitsOnOrder = 0 AND NOT exists{(p)<-[:ORDERS]-(:Order)}
RETURN p
ORDER BY p.unitPrice DESC
LIMIT 5",Verbose query,northwind,False,False,True,
Which customers have a contact title of 'Sales Representative' and are located in 'Berlin'?,"MATCH (c:Customer)
WHERE c.contactTitle = 'Sales Representative' AND c.city = 'Berlin'
RETURN c",Verbose query,northwind,False,False,True,
Which products have a unit price greater than 100 and are still active (not discontinued)?,"MATCH (p:Product)
WHERE p.unitPrice > 100 AND p.discontinued = FALSE
RETURN p.productName, p.unitPrice",Verbose query,northwind,False,False,False,
Which products are associated with the supplier 'Plutzer'?,"MATCH (s:Supplier {companyName: 'Plutzer'})-[:SUPPLIES]->(p:Product)
RETURN p.productName AS ProductName, p.productID AS ProductID",Simple Aggregation Queries,northwind,False,False,True,
Who are the top 3 customers based on the number of orders placed?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
RETURN c.companyName, count(o) AS NumberOfOrders
ORDER BY NumberOfOrders DESC
LIMIT 3",Verbose query,northwind,False,False,True,
Which suppliers have a home page listed? Provide names for the first 5.,"MATCH (s:Supplier)
WHERE s.homePage IS NOT NULL
RETURN s.companyName
LIMIT 5",Verbose query,northwind,False,False,True,
What are the names of the categories where the average unit price of products is above 50?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitPrice > 50
RETURN c.categoryName AS CategoryName, AVG(p.unitPrice) AS AverageUnitPrice
GROUP BY c.categoryName
HAVING AverageUnitPrice > 50",Verbose query,northwind,False,False,True,
List the first 3 products that have been reordered (units on order > 0) and are not discontinued.,"MATCH (p:Product)
WHERE p.unitsOnOrder > 0 AND p.discontinued = FALSE
RETURN p
LIMIT 3",Verbose query,northwind,False,False,True,
Which customers are from 'Germany' and have ordered more than 3 different products?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE c.country = 'Germany'
WITH c, count(DISTINCT p) AS numProducts
WHERE numProducts > 3
RETURN c.companyName, numProducts",Verbose query,northwind,False,False,True,
What are the names of the products that have been ordered more than 50 times?,"MATCH (p:Product)-[o:ORDERS]->(:Order)
WITH p, count(o) AS ordersCount
WHERE ordersCount > 50
RETURN p.productName AS ProductName",Verbose query,northwind,False,False,False,
How many products are in the 'Confections' category and have a unit price greater than 20?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Confections'})
WHERE p.unitPrice > 20
RETURN count(p) AS NumberOfProducts",Verbose query,northwind,False,False,True,
Which orders were shipped to 'France' and required before '1997-01-01'?,"MATCH (o:Order)
WHERE o.shipCountry = 'France' AND o.requiredDate < '1997-01-01 00:00:00.000'
RETURN o",Verbose query,northwind,False,False,True,
List the top 5 orders with the greatest freight charges.,"MATCH (o:Order)
RETURN o
ORDER BY o.freight DESC
LIMIT 5",Verbose query,northwind,False,False,True,
Who are the contact names for suppliers in the 'UK'?,"MATCH (s:Supplier {country: 'UK'})
RETURN s.contactName",Verbose query,northwind,False,False,False,
Which products are part of the 'Dairy Products' category and have less than 20 units in stock?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
WHERE p.unitsInStock < 20
RETURN p.productName, p.unitsInStock",Verbose query,northwind,False,False,False,
Find all customers who have ordered products with a unit price less than $10.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE p.unitPrice < 10
RETURN DISTINCT c",Complex Aggregation Queries,northwind,False,False,True,
Which products have been ordered more than 100 times?,"MATCH (p:Product)-[o:ORDERS]->(:Order)
WITH p, count(o) AS ordersCount
WHERE ordersCount > 100
RETURN p.productName, ordersCount",Complex Aggregation Queries,northwind,False,False,True,
What are the top 5 suppliers based on the number of products they supply with a unit price over $50?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.unitPrice > 50
WITH s, count(p) AS products_count
ORDER BY products_count DESC
LIMIT 5
RETURN s.companyName, products_count",Complex Aggregation Queries,northwind,False,False,True,
Which products have a unitsOnOrder greater than 50?,"MATCH (p:Product)
WHERE p.unitsOnOrder > 50
RETURN p",Complex Aggregation Queries,northwind,False,False,True,
List the first 3 customers who have ordered 'Chai' and are from 'Portland'.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE p.productName = 'Chai' AND c.city = 'Portland'
RETURN c
LIMIT 3",Complex Aggregation Queries,northwind,False,False,True,
What are the top 5 suppliers based on the number of different cities they have shipped to?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)<-[:ORDERS]-(o:Order)-[:PURCHASED]->(c:Customer)
WITH s, COUNT(DISTINCT c.city) AS citiesShippedTo
ORDER BY citiesShippedTo DESC
LIMIT 5
RETURN s.companyName, citiesShippedTo",Complex Aggregation Queries,northwind,False,False,True,
Find all products from suppliers located in 'Germany' that have been ordered in 1998.,"MATCH (s:Supplier {country: 'Germany'})-[:SUPPLIES]->(p:Product)-[:ORDERS]->(o:Order)
WHERE o.orderDate STARTS WITH '1998'
RETURN p.productName, p.productID, s.companyName, s.supplierID, o.orderID, o.orderDate",Complex Aggregation Queries,northwind,False,False,True,
Which products have a quantity per unit description containing 'bags'?,"MATCH (p:Product)
WHERE p.quantityPerUnit CONTAINS 'bags'
RETURN p",Complex Aggregation Queries,northwind,False,False,True,
List the first 3 orders with the highest quantity of a single product ordered.,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
RETURN o.orderID, p.productID, r.quantity
ORDER BY r.quantity DESC
LIMIT 3",Complex Aggregation Queries,northwind,False,False,False,
Which suppliers have products in both 'Grains/Cereals' and 'Meat/Poultry' categories?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WHERE c.categoryName IN ['Grains/Cereals', 'Meat/Poultry']
WITH s, collect(DISTINCT c.categoryName) AS categories
WHERE size(categories) = 2
RETURN s",Complex Aggregation Queries,northwind,False,False,True,
What are the top 5 products with the lowest unit price in the 'Beverages' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice ASC
LIMIT 5",Complex Aggregation Queries,northwind,False,False,False,
List all products with a unit price between $50 and $100.,"MATCH (p:Product)
WHERE p.unitPrice >= 50 AND p.unitPrice <= 100
RETURN p",Complex Aggregation Queries,northwind,False,False,True,
Which categories have products with a reorder level above 25?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.reorderLevel > 25
RETURN DISTINCT c.categoryName",Complex Aggregation Queries,northwind,False,False,True,
Which customers have placed orders that required shipping via method '2'?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE o.shipVia = '2'
RETURN DISTINCT c.companyName",Complex Aggregation Queries,northwind,False,False,False,
What are the top 5 most frequently ordered products in 'Seafood' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Seafood'})
WITH p, count{(p)<-[:ORDERS]-()} AS ordersCount
ORDER BY ordersCount DESC
LIMIT 5
RETURN p.productName, ordersCount",Complex Aggregation Queries,northwind,True,False,False,
List the first 3 orders shipped to Berlin with a freight cost over $100.,"MATCH (o:Order)-[:PURCHASED]->(c:Customer {city: ""Berlin""})
WHERE o.freight > 100 AND o.shippedDate IS NOT NULL
RETURN o
ORDER BY o.shippedDate
LIMIT 3",Complex Aggregation Queries,northwind,False,False,True,
Which products have never been on order (unitsOnOrder = 0) and are not discontinued?,"MATCH (p:Product)
WHERE p.unitsOnOrder = 0 AND p.discontinued = false AND NOT exists{(p)-[:ORDERS]->(:Order)}
RETURN p.productName, p.productID",Complex Aggregation Queries,northwind,False,False,False,
Find all suppliers who do not have a homepage listed.,"MATCH (s:Supplier)
WHERE s.homePage IS NULL
RETURN s",Complex Aggregation Queries,northwind,False,False,True,
What are the top 5 customers based on the total freight costs of their orders?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WITH c, SUM(toFloat(o.freight)) AS totalFreight
ORDER BY totalFreight DESC
LIMIT 5
RETURN c.companyName, totalFreight",Complex Aggregation Queries,northwind,False,False,False,
List the first 3 products supplied by 'Mayumi's' with a unit price less than $20.,"MATCH (s:Supplier {companyName: ""Mayumi's""})-[:SUPPLIES]->(p:Product)
WHERE p.unitPrice < 20
RETURN p.productName, p.unitPrice
LIMIT 3",Complex Aggregation Queries,northwind,False,False,False,
Which suppliers supply more than 5 different products?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, count(DISTINCT p) AS numProducts
WHERE numProducts > 5
RETURN s.companyName, numProducts",Complex Aggregation Queries,northwind,False,False,False,
Find all products that are part of more than one category.,"MATCH (p:Product)
WHERE exists {
  MATCH (p)-[:PART_OF]->(c1:Category),
        (p)-[:PART_OF]->(c2:Category)
  WHERE c1 <> c2
}
RETURN p.productName, collect(DISTINCT c1.categoryName) AS categories",Complex Aggregation Queries,northwind,False,False,True,
Find the first 3 suppliers with products that have a reorder level of zero.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.reorderLevel = 0
RETURN s
LIMIT 3",Complex Aggregation Queries,northwind,False,False,True,
What are the top 5 products with the highest discount given in an order?,"MATCH (p:Product)-[o:ORDERS]->(:Order)
RETURN p.productName, o.discount
ORDER BY o.discount DESC
LIMIT 5",Complex Aggregation Queries,northwind,False,False,True,
Find all suppliers that supply discontinued products.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.discontinued = true
RETURN s",Complex Aggregation Queries,northwind,False,False,True,
Which products have been ordered in quantities larger than 50 and have a unit price over $20?,"MATCH (p:Product)-[o:ORDERS]->(:Order)
WHERE o.quantity > 50 AND o.unitPrice > ""20""
RETURN p.productName, o.quantity, o.unitPrice",Complex Aggregation Queries,northwind,False,False,True,
Find all products that have been ordered in the last quarter of any year.,"MATCH (p:Product)-[:ORDERS]->(o:Order)
WHERE o.orderDate >= date({month: 10, day: 1}) AND o.orderDate <= date({month: 12, day: 31})
RETURN p",Complex Aggregation Queries,northwind,False,False,True,
What are the top 5 orders by freight cost for orders shipped to 'Germany'?,"MATCH (o:Order)-[:PURCHASED]->(c:Customer)
WHERE c.country = 'Germany' AND o.freight IS NOT NULL
RETURN o.orderID, o.freight
ORDER BY o.freight DESC
LIMIT 5",Complex Aggregation Queries,northwind,False,False,True,
List the first 3 suppliers whose products have never been discontinued and have a unitsInStock less than 20.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.discontinued = false AND p.unitsInStock < 20
RETURN s
LIMIT 3",Complex Aggregation Queries,northwind,False,False,True,
Which products have a unit price greater than $75 and are in the 'Confections' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Confections'})
WHERE p.unitPrice > 75
RETURN p.productName, p.unitPrice",Complex Aggregation Queries,northwind,False,False,True,
Find all suppliers that are from the 'UK' and supply products to more than one category.,"MATCH (s:Supplier {country: 'UK'})-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH s, count(DISTINCT c) AS numCategories
WHERE numCategories > 1
RETURN s",Complex Aggregation Queries,northwind,False,False,True,
What are the top 5 most ordered products in December across all years?,"MATCH (p:Product)<-[:ORDERS]-(o:Order)
WHERE o.orderDate STARTS WITH '1996-12' OR o.orderDate STARTS WITH '1997-12' OR o.orderDate STARTS WITH '1998-12' OR o.orderDate STARTS WITH '1999-12' OR o.orderDate STARTS WITH '2000-12'
WITH p, COUNT(o) AS ordersCount
RETURN p.productName, ordersCount
ORDER BY ordersCount DESC
LIMIT 5",Complex Aggregation Queries,northwind,False,False,True,
List the first 3 orders with a required date before '1997-06-01' and a freight cost over $200.,"MATCH (o:Order)
WHERE o.requiredDate < '1997-06-01' AND toFloat(o.freight) > 200
RETURN o
ORDER BY o.requiredDate
LIMIT 3",Complex Aggregation Queries,northwind,False,False,True,
Which products have been ordered with a discount of 0 and are from the 'Dairy Products' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
WHERE exists {
    (p)<-[:ORDERS {discount: '0'}]-(:Order)
}
RETURN p.productName, p.productID",Complex Aggregation Queries,northwind,False,False,True,
Find all products supplied by companies with a fax number listed.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.fax IS NOT NULL
RETURN p",Complex Aggregation Queries,northwind,False,False,False,
What are the top 5 categories based on the average unit price of their products?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS Category, AVG(p.unitPrice) AS AvgUnitPrice
ORDER BY AvgUnitPrice DESC
RETURN Category, AvgUnitPrice
LIMIT 5",Complex Aggregation Queries,northwind,False,False,False,
List the first 3 customers who have placed more than 5 orders.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WITH c, count(o) AS ordersCount
WHERE ordersCount > 5
RETURN c
LIMIT 3",Complex Aggregation Queries,northwind,False,False,False,
Which products have been ordered on dates later than '1997-01-01'?,"MATCH (p:Product)<-[:ORDERS]-(o:Order)
WHERE o.orderDate > '1997-01-01'
RETURN p.productName, p.productID",Complex Aggregation Queries,northwind,False,False,True,
Find all orders shipped to 'Reims' with a freight cost less than $50.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipCity = 'Reims' AND toFloat(o.freight) < 50
RETURN o, p",Complex Aggregation Queries,northwind,False,False,True,
What are the top 5 most frequently ordered products by customers from 'USA'?,"MATCH (c:Customer {country: 'USA'})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
RETURN p.productName, count(o) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 5",Complex Aggregation Queries,northwind,False,False,True,
List the first 3 products with '20 bags' in their quantity per unit description and a reorder level below 15.,"MATCH (p:Product)
WHERE p.quantityPerUnit CONTAINS '20 bags' AND p.reorderLevel < 15
RETURN p
LIMIT 3",Complex Aggregation Queries,northwind,False,False,True,
Which suppliers have a contact title of 'Purchasing Manager' and supply more than 3 products?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.contactTitle = 'Purchasing Manager'
WITH s, count(p) AS productsSupplied
WHERE productsSupplied > 3
RETURN s",Complex Aggregation Queries,northwind,False,False,True,
Find all products that are both in 'Beverages' and 'Condiments' categories.,"MATCH (p:Product)-[:PART_OF]->(c1:Category {categoryName: 'Beverages'}),
      (p)-[:PART_OF]->(c2:Category {categoryName: 'Condiments'})
RETURN p.productName, p.productID",Complex Aggregation Queries,northwind,False,False,True,
What are the top 5 orders in terms of quantity for the product 'Chai'?,"MATCH (p:Product {productName: 'Chai'})-[:ORDERS]->(o:Order)
RETURN o.orderID AS OrderID, sum(o.quantity) AS TotalQuantity
ORDER BY TotalQuantity DESC
LIMIT 5",Complex Aggregation Queries,northwind,False,False,True,Order.quantity
List the first 3 products in the 'Confections' category with the most units on order.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Confections'})
WHERE p.unitsOnOrder IS NOT NULL
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 3",Complex Aggregation Queries,northwind,False,False,True,
List the first 3 categories with products that have been ordered more than 50 times.,"MATCH (c:Category)-[:PART_OF]-(p:Product)-[:ORDERS]-(o:Order)
WITH c, count(o) AS ordersCount
WHERE ordersCount > 50
RETURN c
LIMIT 3",Complex Aggregation Queries,northwind,False,False,True,
What are the top 3 most stocked products in the 'Grains/Cereals' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Grains/Cereals'})
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
Find all orders shipped to 'France' with a freight cost more than 50.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipCountry = 'France' AND toFloat(o.freight) > 50
RETURN o, p",Complex Retrieval Queries,northwind,False,False,True,
Which orders were placed by customers from 'Berlin'?,"MATCH (c:Customer {city: 'Berlin'})-[:PURCHASED]->(o:Order)
RETURN o",Simple Aggregation Queries,northwind,False,False,True,
Identify the top 3 most stocked products in the 'Dairy Products' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 3",Complex Retrieval Queries,northwind,False,False,True,
Which products are discontinued and have less than 10 units in stock?,"MATCH (p:Product)
WHERE p.discontinued = true AND p.unitsInStock < 10
RETURN p.productName, p.unitsInStock",Complex Retrieval Queries,northwind,False,False,True,
List all suppliers that supply products in the 'Beverages' category.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
RETURN s",Complex Retrieval Queries,northwind,False,False,True,
Which products have a reorder level greater than 15?,"MATCH (p:Product)
WHERE p.reorderLevel > 15
RETURN p.productName, p.reorderLevel",Complex Retrieval Queries,northwind,False,False,True,
What are the top 5 products by unit price?,"MATCH (p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 5",Complex Retrieval Queries,northwind,False,False,True,
What are the top 3 most ordered products in the 'Grains/Cereals' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Grains/Cereals'})
WITH p
MATCH (o:Order)-[r:ORDERS]->(p)
RETURN p.productName, SUM(r.quantity) AS TotalQuantityOrdered
ORDER BY TotalQuantityOrdered DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
List the top 5 suppliers based in 'London'.,"MATCH (s:Supplier {city: 'London'})
RETURN s.companyName, s.contactName
ORDER BY s.companyName
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 customers have ordered the most products from the 'Dairy Products' category?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(cat:Category {categoryName: ""Dairy Products""})
WITH c, count(p) AS products_ordered
ORDER BY products_ordered DESC
LIMIT 3
RETURN c.companyName, products_ordered",Simple Retrieval Queries,northwind,False,False,True,
What are the contact details for suppliers in the 'UK'?,"MATCH (s:Supplier {country: 'UK'})
RETURN s.companyName, s.contactName, s.phone, s.address, s.city, s.postalCode, s.contactTitle",Complex Retrieval Queries,northwind,False,False,False,
What are the top 3 ship cities for orders placed by 'Ernst Handel'?,"MATCH (c:Customer {companyName: ""Ernst Handel""})-[:PURCHASED]->(o:Order)
RETURN o.shipCity AS ShipCity, count(o) AS NumberOfOrders
ORDER BY NumberOfOrders DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,False,
Which 3 products are most often ordered by customers from Germany?,"MATCH (c:Customer {country: 'Germany'})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
RETURN p.productName, count(o) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
What are the top 3 products with the lowest units in stock?,"MATCH (p:Product)
WHERE p.unitsInStock IS NOT NULL
RETURN p
ORDER BY p.unitsInStock ASC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,False,
List the top 5 orders with the latest required dates.,"MATCH (o:Order)
RETURN o
ORDER BY o.requiredDate DESC
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 products have the highest units on order and are not discontinued?,"MATCH (p:Product)
WHERE p.discontinued = false AND p.unitsOnOrder IS NOT NULL
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
What are the top 3 cities where customers are located?,"MATCH (c:Customer)
RETURN c.city AS City, count(c) AS NumberOfCustomers
ORDER BY NumberOfCustomers DESC
LIMIT 3",Simple Retrieval Queries,northwind,True,False,False,
List the top 5 products with the lowest unit price supplied by 'Plutzer'.,"MATCH (s:Supplier {companyName: ""Plutzer""})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice ASC
LIMIT 5",Simple Retrieval Queries,northwind,False,False,False,
Which 3 products have the highest average quantity ordered?,"MATCH (p:Product)-[o:ORDERS]->()
RETURN p.productName, AVG(o.quantity) AS avgQuantity
ORDER BY avgQuantity DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
What are the top 3 most common ship addresses for orders?,"MATCH (o:Order)
RETURN o.shipAddress AS ShipAddress, count(o) AS NumberOfOrders
ORDER BY NumberOfOrders DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
List the top 5 products with the highest average discount in orders.,"MATCH (p:Product)-[o:ORDERS]->(:Order)
WITH p, AVG(TOFLOAT(o.discount)) AS avgDiscount
ORDER BY avgDiscount DESC
LIMIT 5
RETURN p.productName, avgDiscount",Simple Retrieval Queries,northwind,False,False,False,
Which customers are based in 'Berlin'?,"MATCH (c:Customer {city: 'Berlin'})
RETURN c",Complex Retrieval Queries,northwind,False,False,True,
List the top 5 most frequently ordered products.,"MATCH (p:Product)<-[:ORDERS]-(:Order)
WITH p, count(*) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 5
RETURN p.productName, ordersCount",Complex Retrieval Queries,northwind,False,False,True,
Which products have been ordered with a quantity greater than 100?,"MATCH (p:Product)<-[:ORDERS {quantity: q}]-(:Order)
WHERE q > 100
RETURN p.productName, p.productID, q",Complex Retrieval Queries,northwind,False,False,True,
What are the most expensive products ordered by 'LONESOME PINE RESTAURANT'?,"MATCH (c:Customer {companyName: 'LONESOME PINE RESTAURANT'})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC",Complex Retrieval Queries,northwind,False,False,True,
List the products ordered by 'VINET' customer.,"MATCH (c:Customer {customerID: 'VINET'})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
RETURN p.productName AS ProductOrdered",Complex Retrieval Queries,northwind,False,False,True,
Which suppliers have a fax number listed?,"MATCH (s:Supplier)
WHERE s.fax IS NOT NULL
RETURN s",Complex Retrieval Queries,northwind,False,False,True,
Show all products that have a discount applied in any order.,"MATCH (p:Product)-[o:ORDERS]->(:Order)
WHERE o.discount <> ""0""
RETURN DISTINCT p",Complex Retrieval Queries,northwind,False,False,True,
Which orders were placed in the year 1996?,"MATCH (o:Order)
WHERE o.orderDate STARTS WITH '1996'
RETURN o",Complex Retrieval Queries,northwind,False,False,True,
Find all products with a reorder level of 0 and still in stock.,"MATCH (p:Product)
WHERE p.reorderLevel = 0 AND p.unitsInStock > 0
RETURN p",Complex Retrieval Queries,northwind,False,False,True,
List all suppliers who are from cities starting with 'L'.,"MATCH (s:Supplier)
WHERE s.city STARTS WITH 'L'
RETURN s",Complex Retrieval Queries,northwind,False,False,True,
Display all products with 'unitsOnOrder' greater than 20.,"MATCH (p:Product)
WHERE p.unitsOnOrder > 20
RETURN p",Complex Retrieval Queries,northwind,False,False,True,
Which categories do not have any discontinued products?,"MATCH (c:Category)
WHERE NOT exists {
  MATCH (c)<-[:PART_OF]-(p:Product)
  WHERE p.discontinued = true
}
RETURN c.categoryName",Complex Retrieval Queries,northwind,False,False,False,
Find all products that have never been reordered (reorder level 0).,"MATCH (p:Product)
WHERE p.reorderLevel = 0
RETURN p",Complex Retrieval Queries,northwind,False,False,True,
Show details of customers who have placed more than 5 orders.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WITH c, count(o) AS ordersCount
WHERE ordersCount > 5
RETURN c",Complex Retrieval Queries,northwind,False,False,True,
List all orders from 'Lonesome Pine Restaurant' in 'Portland'.,"MATCH (c:Customer {companyName: 'Lonesome Pine Restaurant', city: 'Portland'})-[:PURCHASED]->(o:Order)
RETURN o",Complex Retrieval Queries,northwind,False,False,True,
Identify products with a unit price greater than 50 and are in the 'Confections' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Confections'})
WHERE p.unitPrice > 50
RETURN p",Complex Retrieval Queries,northwind,False,False,True,
Which suppliers supply the 'Chef Anton's Cajun Seasoning'?,"MATCH (p:Product {productName: ""Chef Anton's Cajun Seasoning""})-[:SUPPLIES]-(s:Supplier)
RETURN s",Complex Retrieval Queries,northwind,False,False,True,
Show all products in stock that are part of the 'Condiments' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Condiments'})
WHERE p.unitsInStock > 0
RETURN p",Complex Retrieval Queries,northwind,False,False,True,
What are the discontinued products supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product {discontinued: true})
RETURN p.productName AS DiscontinuedProducts",Complex Retrieval Queries,northwind,False,False,True,
List all products supplied by 'Exotic Liquids'.,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)
RETURN p",Complex Retrieval Queries,northwind,False,False,True,
Which suppliers provide products to more than one category?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH s, count(DISTINCT c) AS numCategories
WHERE numCategories > 1
RETURN s",Complex Retrieval Queries,northwind,False,False,True,
What are the top 3 categories with the highest number of products?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c, count(p) AS productCount
ORDER BY productCount DESC
LIMIT 3
RETURN c.categoryName, productCount",Complex Retrieval Queries,northwind,False,False,True,
List the top 5 suppliers with the most products in category 'Beverages'.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
WITH s, count(p) AS numProducts
ORDER BY numProducts DESC
LIMIT 5
RETURN s.companyName, numProducts",Simple Retrieval Queries,northwind,False,False,True,
Which 3 categories have the highest number of discontinued products?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.discontinued = true
WITH c, count(p) AS discontinuedCount
ORDER BY discontinuedCount DESC
LIMIT 3
RETURN c.categoryName, discontinuedCount",Simple Retrieval Queries,northwind,False,False,True,
What are the top 3 products with the highest units in stock?,"MATCH (p:Product)
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
List the top 5 most frequently ordered products by 'VINET'.,"MATCH (c:Customer {customerID: ""VINET""})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
RETURN p.productName, count(o) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
What are the top 5 products ordered by 'Alfreds Futterkiste'?,"MATCH (c:Customer {companyName: ""Alfreds Futterkiste""})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
RETURN p.productName, SUM(toInteger(o.quantity)) AS TotalQuantityOrdered
ORDER BY TotalQuantityOrdered DESC
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,Order.quantity
List the top 3 most frequent ship cities for orders.,"MATCH (o:Order)
RETURN o.shipCity AS ShipCity, count(o) AS NumberOfOrders
ORDER BY NumberOfOrders DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
Who are the top 3 customers based on the number of orders placed?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
RETURN c.companyName, count(o) AS NumberOfOrders
ORDER BY NumberOfOrders DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
List the top 3 products that are in stock and not discontinued.,"MATCH (p:Product)
WHERE p.unitsInStock > 0 AND p.discontinued = FALSE
RETURN p
ORDER BY p.unitsInStock DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
Identify the top 5 products with the lowest reorder level.,"MATCH (p:Product)
RETURN p.productName, p.reorderLevel
ORDER BY p.reorderLevel ASC
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 categories contain the most products?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c, count(p) AS productCount
ORDER BY productCount DESC
LIMIT 3
RETURN c.categoryName, productCount",Simple Retrieval Queries,northwind,False,False,False,
What are the names of the top 3 discontinued products?,"MATCH (p:Product)
WHERE p.discontinued = true
RETURN p.productName
ORDER BY p.productID
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
Find the top 5 most expensive products supplied by 'Exotic Liquids'.,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 suppliers supply the most products?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, count(p) AS products_supplied
ORDER BY products_supplied DESC
LIMIT 3
RETURN s.companyName, products_supplied",Simple Retrieval Queries,northwind,False,False,True,
List the top 5 products with the most units on order.,"MATCH (p:Product)
WHERE p.unitsOnOrder IS NOT NULL
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Provide the names of products that are part of the 'Seafood' category and have a reorder level of 0.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Seafood'})
WHERE p.reorderLevel = 0
RETURN p.productName AS ProductName",Verbose query,northwind,True,False,False,
List the top 3 customers who have ordered the product 'Chai' the most times.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product {productName: 'Chai'})
WITH c, count(o) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 3
RETURN c.companyName, ordersCount",Verbose query,northwind,False,False,True,
Which 3 products have the highest average discount applied in their orders?,"MATCH (p:Product)-[o:ORDERS]->(:Order)
WITH p, AVG(toFloat(o.discount)) AS avgDiscount
ORDER BY avgDiscount DESC
LIMIT 3
RETURN p.productName, avgDiscount",Verbose query,northwind,False,False,False,
Identify the 5 most common employee IDs associated with orders.,"MATCH (o:Order)
WITH o.employeeID AS EmployeeID, count(o) AS OrdersCount
ORDER BY OrdersCount DESC
LIMIT 5
RETURN EmployeeID, OrdersCount",Verbose query,northwind,False,False,True,
What are the top 3 most frequently reordered products?,"MATCH (p:Product)
WHERE p.reorderLevel > 0
RETURN p.productName, p.reorderLevel
ORDER BY p.reorderLevel DESC
LIMIT 3",Verbose query,northwind,False,False,True,
List the top 5 suppliers based on the number of cities they supply to.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)<-[:ORDERS]-(o:Order)<-[:PURCHASED]-(c:Customer)
WITH s, COUNT(DISTINCT c.city) AS citiesSupplied
ORDER BY citiesSupplied DESC
LIMIT 5
RETURN s.companyName, citiesSupplied",Verbose query,northwind,False,False,False,
Which 3 products have the largest quantity per unit in the 'Condiments' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Condiments'})
RETURN p.productName, p.quantityPerUnit
ORDER BY p.quantityPerUnit DESC
LIMIT 3",Verbose query,northwind,False,False,True,
Identify the 5 customers with the longest shipping durations for their orders.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE o.shippedDate IS NOT NULL AND o.orderDate IS NOT NULL
WITH c, o, duration.between(datetime(o.orderDate), datetime(o.shippedDate)) AS shippingDuration
ORDER BY shippingDuration DESC
RETURN c.companyName, c.contactName, shippingDuration
LIMIT 5",Verbose query,northwind,False,False,True,
What are the first 3 categories in which 'Exotic Liquids' supplies products?,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
RETURN DISTINCT c.categoryName
LIMIT 3",Verbose query,northwind,False,False,True,
Which 3 products have the highest discount in orders?,"MATCH (p:Product)-[o:ORDERS]->(:Order)
RETURN p.productName, o.discount
ORDER BY o.discount DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
Find the products with 'unitPrice' between 10 and 20.,"MATCH (p:Product)
WHERE p.unitPrice >= 10 AND p.unitPrice <= 20
RETURN p",Complex Retrieval Queries,northwind,False,False,True,
List the top 5 suppliers based on the number of products they supply.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, count(p) AS productsSupplied
ORDER BY productsSupplied DESC
LIMIT 5
RETURN s.companyName, productsSupplied",Simple Retrieval Queries,northwind,False,False,True,
Which 3 employees have processed the most orders?,"MATCH (e:Employee)-[:PROCESSED]->(o:Order)
RETURN e.employeeID, count(o) AS ordersProcessed
ORDER BY ordersProcessed DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,Employee
Which 3 employees have processed the most orders?,"MATCH (e:Employee)-[:PROCESSED]->(o:Order)
RETURN e.employeeID, count(o) AS ordersProcessed
ORDER BY ordersProcessed DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,PROCESSED
Which 3 employees have processed the most orders?,"MATCH (e:Employee)-[:PROCESSED]->(o:Order)
RETURN e.employeeID, count(o) AS ordersProcessed
ORDER BY ordersProcessed DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,Employee.employeeID
Which 3 suppliers are based in the UK?,"MATCH (s:Supplier {country: 'UK'})
RETURN s.companyName
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
What are the top 3 most common supplier countries?,"MATCH (s:Supplier)-[:SUPPLIES]->(:Product)
RETURN s.country AS Country, count(s) AS NumberOfSupplies
ORDER BY NumberOfSupplies DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
List the top 5 customers based on the number of unique products ordered.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WITH c, COUNT(DISTINCT p) AS uniqueProductsOrdered
ORDER BY uniqueProductsOrdered DESC
LIMIT 5
RETURN c.companyName, uniqueProductsOrdered",Simple Retrieval Queries,northwind,False,False,True,
Which 3 products have the lowest unit price and are still in stock?,"MATCH (p:Product)
WHERE p.unitPrice IS NOT NULL AND p.unitsInStock > 0
RETURN p
ORDER BY p.unitPrice ASC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
What are the top 3 categories with the least products available?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitsInStock IS NOT NULL
WITH c, count(p) AS productsAvailable
ORDER BY productsAvailable ASC
LIMIT 3
RETURN c.categoryName, productsAvailable",Simple Retrieval Queries,northwind,False,False,False,
List the top 5 products with the highest reorder level.,"MATCH (p:Product)
RETURN p.productName, p.reorderLevel
ORDER BY p.reorderLevel DESC
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 customers have the highest number of discontinued products ordered?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE p.discontinued = true
WITH c, count(p) AS discontinuedProductsCount
ORDER BY discontinuedProductsCount DESC
LIMIT 3
RETURN c.companyName, discontinuedProductsCount",Simple Retrieval Queries,northwind,False,False,True,
What are the top 3 most common ship vias used for orders?,"MATCH (o:Order)
RETURN o.shipVia AS ShipVia, count(o) AS NumberOfOrders
ORDER BY NumberOfOrders DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
List the top 5 orders with the most products ordered.,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WITH o, count(p) AS products_ordered
ORDER BY products_ordered DESC
LIMIT 5
RETURN o AS Order, products_ordered AS NumberOfProductsOrdered",Simple Retrieval Queries,northwind,False,False,True,
Which 3 products have the highest unit price among those supplied by 'Mayumi's'?,"MATCH (s:Supplier {companyName: ""Mayumi's""})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
What are the top 3 most common ship regions for orders?,"MATCH (o:Order)
WHERE o.shipRegion IS NOT NULL
RETURN o.shipRegion AS ShipRegion, count(o) AS NumberOfOrders
ORDER BY NumberOfOrders DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
List the top 5 products by number of times they have been ordered.,"MATCH (p:Product)-[o:ORDERS]->(:Order)
RETURN p.productName, count(o) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 suppliers have supplied products with the most units on order?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, sum(p.unitsOnOrder) AS totalUnitsOnOrder
ORDER BY totalUnitsOnOrder DESC
LIMIT 3
RETURN s.companyName, totalUnitsOnOrder",Simple Retrieval Queries,northwind,False,False,True,
List the top 3 categories by the average units in stock of their products.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS CategoryName, AVG(p.unitsInStock) AS AvgUnitsInStock
RETURN CategoryName, AvgUnitsInStock
ORDER BY AvgUnitsInStock DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,False,
Which 3 products have the smallest quantity per unit available?,"MATCH (p:Product)
RETURN p.productName, p.quantityPerUnit
ORDER BY p.quantityPerUnit
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
What are the top 3 most common ship countries for orders?,"MATCH (o:Order)
RETURN o.shipCountry AS ShipCountry, count(o) AS NumberOfOrders
ORDER BY NumberOfOrders DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
List the top 5 customers by total freight charges.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
RETURN c.companyName, SUM(toFloat(o.freight)) AS TotalFreight
ORDER BY TotalFreight DESC
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 products are most frequently ordered together?,"MATCH (p1:Product)-[:ORDERS]-(o:Order)-[:ORDERS]-(p2:Product)
WHERE p1.productID < p2.productID
WITH p1, p2, count(o) AS times_ordered_together
ORDER BY times_ordered_together DESC
RETURN p1.productName, p2.productName, times_ordered_together
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
List the top 3 orders with the highest freight charges.,"MATCH (o:Order)
RETURN o
ORDER BY o.freight DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
What are the top 3 categories with the highest average unit price of products?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS CategoryName, AVG(p.unitPrice) AS AvgUnitPrice
ORDER BY AvgUnitPrice DESC
RETURN CategoryName, AvgUnitPrice
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
List the first 3 suppliers whose home page starts with 'http'.,"MATCH (s:Supplier)
WHERE s.homePage STARTS WITH 'http'
RETURN s
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
List all products from suppliers located in 'Germany'.,"MATCH (s:Supplier {country: 'Germany'})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.productID",Complex Retrieval Queries,northwind,False,False,True,
Show all orders that required shipping to 'USA'.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipCountry = 'USA'
RETURN o AS Order, p AS Product",Complex Retrieval Queries,northwind,False,False,True,
Which products have a reorder level of 0 and are still in stock?,"MATCH (p:Product)
WHERE p.reorderLevel = 0 AND p.unitsInStock > 0
RETURN p.productName, p.unitsInStock",Simple Aggregation Queries,northwind,False,False,True,
What are the first 3 orders with the highest freight charges?,"MATCH (o:Order)
RETURN o
ORDER BY o.freight DESC
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
Which products are supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)
RETURN p.productName AS ProductName, p.productID AS ProductID",Simple Aggregation Queries,northwind,False,False,True,
List the first 3 discontinued products and their categories.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.discontinued = true
RETURN p.productName, c.categoryName
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
What are the company names of customers from Germany?,"MATCH (c:Customer {country: ""Germany""})
RETURN c.companyName",Simple Aggregation Queries,northwind,False,False,True,
Which categories contain more than 5 products?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c, count(p) AS numProducts
WHERE numProducts > 5
RETURN c.categoryName, numProducts",Simple Aggregation Queries,northwind,False,False,True,
What are the names of the top 3 products with the highest units on order?,"MATCH (p:Product)
WHERE p.unitsOnOrder IS NOT NULL
RETURN p.productName AS ProductName, p.unitsOnOrder AS UnitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
List the top 3 suppliers based in the UK.,"MATCH (s:Supplier {country: 'UK'})
RETURN s.companyName, s.contactName
ORDER BY s.companyName
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
List the first 3 categories with the most number of products.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c, count(p) AS productCount
ORDER BY productCount DESC
RETURN c.categoryName, productCount
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
What are the top 3 cities with the most orders shipped?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE o.shippedDate IS NOT NULL
RETURN o.shipCity AS City, count(o) AS NumberOfOrders
ORDER BY NumberOfOrders DESC
LIMIT 3",Simple Aggregation Queries,northwind,False,False,False,
List the first 3 categories and their descriptions.,"MATCH (c:Category)
RETURN c.categoryName, c.description
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
What are the product names of the top 5 most expensive products?,"MATCH (p:Product)
RETURN p.productName AS ProductName, p.unitPrice AS UnitPrice
ORDER BY p.unitPrice DESC
LIMIT 5",Simple Aggregation Queries,northwind,False,False,True,
"Which products are part of the 'Desserts, candies, and sweet breads' category and have a 'unitsOnOrder' above 5?","MATCH (p:Product)-[:PART_OF]->(c:Category {description: 'Desserts, candies, and sweet breads'})
WHERE p.unitsOnOrder > 5
RETURN p.productName, p.unitsOnOrder",Complex Retrieval Queries,northwind,False,False,True,
List all customers from 'Berlin' who have ordered more than three times.,"MATCH (c:Customer {city: 'Berlin'})-[:PURCHASED]->(o:Order)
WITH c, count(o) AS ordersCount
WHERE ordersCount > 3
RETURN c",Complex Retrieval Queries,northwind,False,False,True,
Show all products with a 'unitPrice' above 20 and a 'reorderLevel' below 5.,"MATCH (p:Product)
WHERE p.unitPrice > 20 AND p.reorderLevel < 5
RETURN p",Complex Retrieval Queries,northwind,False,False,True,
Identify all suppliers from 'Germany' who supply products in the 'Beverages' category.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WHERE s.country = 'Germany' AND c.categoryName = 'Beverages'
RETURN s",Complex Retrieval Queries,northwind,False,False,True,
Which products are part of the 'Meat/Poultry' category and have a reorder level above 20?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Meat/Poultry'})
WHERE p.reorderLevel > 20
RETURN p.productName, p.reorderLevel",Complex Retrieval Queries,northwind,False,False,True,
List the top 5 orders by quantity of products ordered.,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
RETURN o.orderID, SUM(r.quantity) AS TotalQuantity
ORDER BY TotalQuantity DESC
LIMIT 5",Complex Retrieval Queries,northwind,False,False,False,
Which suppliers provide products that are not discontinued?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.discontinued = false
RETURN s",Simple Aggregation Queries,northwind,False,False,True,
What are the top 5 products with the least units in stock?,"MATCH (p:Product)
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock ASC
LIMIT 5",Simple Aggregation Queries,northwind,False,False,True,
Which suppliers have a contact title of 'Purchasing Manager'?,"MATCH (s:Supplier {contactTitle: 'Purchasing Manager'})
RETURN s",Simple Aggregation Queries,northwind,False,False,True,
List the top 3 most frequently ordered products.,"MATCH (p:Product)<-[:ORDERS]-(:Order)
WITH p, count(*) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 3
RETURN p.productName, ordersCount",Simple Aggregation Queries,northwind,False,False,False,
What are the names of the first 3 products that have never been ordered?,"MATCH (p:Product)
WHERE NOT exists{ (p)-[:ORDERS]->(:Order) }
RETURN p.productName
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
List the first 3 categories that have a product with a unit price of less than 10.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitPrice < 10
RETURN DISTINCT c
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
Which products have 'NULL' as the region for their suppliers?,"MATCH (p:Product)-[:SUPPLIES]->(s:Supplier)
WHERE s.region = 'NULL'
RETURN p.productName, p.productID",Simple Aggregation Queries,northwind,False,False,True,
List the first 3 products supplied by 'Mayumi's'.,"MATCH (s:Supplier {companyName: ""Mayumi's""})-[:SUPPLIES]->(p:Product)
RETURN p
LIMIT 3",Simple Aggregation Queries,northwind,False,False,False,
Which products have a reorder level greater than 20?,"MATCH (p:Product)
WHERE p.reorderLevel > 20
RETURN p.productName, p.productID, p.reorderLevel",Simple Aggregation Queries,northwind,False,False,True,
What are the names of the top 3 customers who have ordered the most in terms of quantity?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
WITH c, sum(r.quantity) AS totalQuantity
ORDER BY totalQuantity DESC
LIMIT 3
RETURN c.companyName AS CustomerName, totalQuantity",Simple Aggregation Queries,northwind,False,False,False,
List the first 3 products that are in the category 'Confections' and have been discontinued.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Confections'})
WHERE p.discontinued = true
RETURN p
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
Which orders were shipped by ship via option '1'?,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipVia = '1'
RETURN o.orderID, o.shipName, o.shippedDate, o.shipCity",Simple Aggregation Queries,northwind,False,False,True,
What are the first 3 products with a quantity per unit of '10 boxes x 20 bags'?,"MATCH (p:Product {quantityPerUnit: '10 boxes x 20 bags'})
RETURN p
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
Which suppliers supply to more than three different categories of products?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH s, count(DISTINCT c) AS numCategories
WHERE numCategories > 3
RETURN s",Simple Aggregation Queries,northwind,False,False,False,
List the top 3 employees who processed the most orders.,"MATCH (e:Employee)-[:PROCESSED]->(o:Order)
RETURN e, count(o) AS ordersProcessed
ORDER BY ordersProcessed DESC
LIMIT 3",Simple Aggregation Queries,northwind,True,False,False,Employee
List the top 3 employees who processed the most orders.,"MATCH (e:Employee)-[:PROCESSED]->(o:Order)
RETURN e, count(o) AS ordersProcessed
ORDER BY ordersProcessed DESC
LIMIT 3",Simple Aggregation Queries,northwind,True,False,False,PROCESSED
Which products are in the category 'Beverages' and have more than 30 units in stock?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
WHERE p.unitsInStock > 30
RETURN p.productName, p.unitsInStock",Simple Aggregation Queries,northwind,False,False,True,
What are the names of products that have a discount of 0?,"MATCH (p:Product)-[r:ORDERS {discount: '0'}]->(:Order)
RETURN p.productName AS ProductName",Simple Aggregation Queries,northwind,False,False,False,
List the first 3 orders shipped to France.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipCountry = 'France'
RETURN o.orderID, o.shippedDate, o.shipName
ORDER BY o.shippedDate
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
Which products have a unit price greater than 50 and are part of the 'Dairy Products' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
WHERE p.unitPrice > 50
RETURN p.productName, p.unitPrice",Simple Aggregation Queries,northwind,False,False,True,
Which categories are associated with products that have more than 50 units on order?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitsOnOrder > 50
RETURN DISTINCT c.categoryName",Simple Aggregation Queries,northwind,False,False,False,
List the first 3 suppliers who do not have a fax number.,"MATCH (s:Supplier)
WHERE s.fax IS NULL
RETURN s
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
Which customers have purchased orders required in less than a month from the order date?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE o.requiredDate IS NOT NULL AND o.orderDate IS NOT NULL AND 
      duration.between(date(o.orderDate), date(o.requiredDate)).days < 30
RETURN c",Simple Aggregation Queries,northwind,False,False,True,
What are the top 3 products with the highest quantity per unit available?,"MATCH (p:Product)
RETURN p.productName, p.quantityPerUnit
ORDER BY p.unitsInStock DESC
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
Who are the customers with orders that have a 'freight' cost above 100?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE o.freight > 100
RETURN c.companyName AS CustomerName, o.orderID AS OrderID, o.freight AS FreightCost",Complex Retrieval Queries,northwind,False,False,True,
Find all products with a 'unitsOnOrder' of 0 and a 'reorderLevel' above 10.,"MATCH (p:Product)
WHERE p.unitsOnOrder = 0 AND p.reorderLevel > 10
RETURN p",Complex Retrieval Queries,northwind,False,False,True,
Which suppliers have more than 3 products in their supply list?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, count(p) AS numProducts
WHERE numProducts > 3
RETURN s",Complex Retrieval Queries,northwind,False,False,True,
List all discontinued products in the 'Dairy Products' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
WHERE p.discontinued = true
RETURN p.productName, p.productID, p.unitPrice, p.unitsInStock",Complex Retrieval Queries,northwind,False,False,True,
What is the average unit price of products in the 'Dairy Products' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
RETURN AVG(p.unitPrice) AS AverageUnitPrice",Complex Retrieval Queries,northwind,False,False,True,
Display all products that are not discontinued and have a 'unitPrice' above 35.,"MATCH (p:Product)
WHERE p.discontinued = false AND p.unitPrice > 35
RETURN p",Complex Retrieval Queries,northwind,False,False,False,
Which orders have a 'shippedDate' on or after '1996-07-16'?,"MATCH (o:Order)
WHERE o.shippedDate >= '1996-07-16 00:00:00.000'
RETURN o",Complex Retrieval Queries,northwind,False,False,True,
Find all suppliers in the 'NULL' region.,"MATCH (s:Supplier)
WHERE s.region = 'NULL'
RETURN s",Complex Retrieval Queries,northwind,False,False,True,
Show all categories for which there is at least one product with 'unitsOnOrder' above 0.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitsOnOrder > 0
RETURN DISTINCT c",Complex Retrieval Queries,northwind,False,False,True,
Which products are supplied by suppliers with a phone number ending in '2222'?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.phone ENDS WITH '2222'
RETURN p.productName AS ProductName, p.productID AS ProductID",Complex Retrieval Queries,northwind,False,False,True,
List all suppliers that supply discontinued products.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.discontinued = true
RETURN DISTINCT s",Complex Retrieval Queries,northwind,False,False,True,
What are the products ordered by 'FURIB' customer?,"MATCH (c:Customer {customerID: 'FURIB'})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
RETURN p.productName AS ProductName, p.productID AS ProductID",Complex Retrieval Queries,northwind,False,False,False,
Identify suppliers who do not have a home page listed.,"MATCH (s:Supplier)
WHERE s.homePage IS NULL
RETURN s",Complex Retrieval Queries,northwind,False,False,True,
Who are the customers in the 'NULL' region?,"MATCH (c:Customer {region: 'NULL'})
RETURN c",Complex Retrieval Queries,northwind,False,False,True,
List all orders with a freight cost less than 10.,"MATCH (o:Order)
WHERE o.freight < '10'
RETURN o",Complex Retrieval Queries,northwind,False,False,True,
Which products are supplied by a supplier in 'London'?,"MATCH (s:Supplier {city: 'London'})-[:SUPPLIES]->(p:Product)
RETURN p.productName AS ProductName, p.productID AS ProductID",Complex Retrieval Queries,northwind,False,False,True,
Show all products with a 'reorderLevel' of 25 or higher.,"MATCH (p:Product)
WHERE p.reorderLevel >= 25
RETURN p",Complex Retrieval Queries,northwind,False,False,True,
Which orders were required by a date earlier than '1997-01-01'?,"MATCH (o:Order)
WHERE o.requiredDate < '1997-01-01'
RETURN o",Complex Retrieval Queries,northwind,False,False,True,
Find all products that are part of more than one order.,"MATCH (p:Product)-[r:ORDERS]->(o:Order)
WITH p, count(o) AS ordersCount
WHERE ordersCount > 1
RETURN p",Complex Retrieval Queries,northwind,False,False,True,
List the top 3 customers by the number of orders placed.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WITH c, count(o) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 3
RETURN c.companyName, ordersCount",Complex Retrieval Queries,northwind,False,False,True,
What are the products with 'unitsInStock' less than 5?,"MATCH (p:Product)
WHERE p.unitsInStock < 5
RETURN p",Complex Retrieval Queries,northwind,False,False,True,
Identify all orders shipped by 'shipVia' 3.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipVia = '3'
RETURN o AS Order, collect(p) AS Products",Complex Retrieval Queries,northwind,False,False,True,
"Which products are part of the 'Breads, crackers, pasta, and cereal' category and have more than 50 units in stock?","MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Grains/Cereals'})
WHERE p.unitsInStock > 50
RETURN p.productName, p.unitsInStock",Complex Retrieval Queries,northwind,False,False,True,
List all customers with a fax number ending in '6545'.,"MATCH (c:Customer)
WHERE c.fax ENDS WITH '6545'
RETURN c",Complex Retrieval Queries,northwind,False,False,True,
Who are the customers in the 'Sales Representative' role?,"MATCH (c:Customer {contactTitle: 'Sales Representative'})
RETURN c",Complex Retrieval Queries,northwind,False,False,True,
Which products have a 'quantityPerUnit' specified as '10 boxes x 20 bags'?,"MATCH (p:Product)
WHERE p.quantityPerUnit = '10 boxes x 20 bags'
RETURN p",Complex Retrieval Queries,northwind,False,False,True,
Show all orders from customers in 'Portland'.,"MATCH (c:Customer {city: 'Portland'})-[:PURCHASED]->(o:Order)
RETURN o",Complex Retrieval Queries,northwind,False,False,False,
Show all orders placed in '1996' that were shipped to 'USA'.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.orderDate STARTS WITH '1996' AND o.shipCountry = 'USA'
RETURN o AS Order, collect(p) AS Products",Complex Retrieval Queries,northwind,False,False,True,
Which products have a 'productName' starting with 'C'?,"MATCH (p:Product)
WHERE p.productName STARTS WITH 'C'
RETURN p",Complex Retrieval Queries,northwind,False,False,True,
List all suppliers that are based outside of 'USA' and 'UK'.,"MATCH (s:Supplier)
WHERE s.country <> 'USA' AND s.country <> 'UK'
RETURN s",Complex Retrieval Queries,northwind,False,False,True,
What are the products with a 'unitPrice' less than 10 and are discontinued?,"MATCH (p:Product)
WHERE p.unitPrice < 10 AND p.discontinued = true
RETURN p.productName, p.unitPrice, p.discontinued",Complex Retrieval Queries,northwind,False,False,True,
Identify all orders shipped to 'France' and have a 'shipVia' of 1.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipCountry = 'France' AND o.shipVia = '1'
RETURN o, p",Complex Retrieval Queries,northwind,False,False,True,
Show all products that are part of the 'Grains/Cereals' category and have 'unitsOnOrder' above 10.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Grains/Cereals'})
WHERE p.unitsOnOrder > 10
RETURN p",Complex Retrieval Queries,northwind,False,False,True,
Which products are supplied by suppliers with no listed fax number?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.fax IS NULL
RETURN p.productName, p.productID",Complex Retrieval Queries,northwind,False,False,True,
List the top 3 products by reorder level.,"MATCH (p:Product)
RETURN p.productName, p.reorderLevel
ORDER BY p.reorderLevel DESC
LIMIT 3",Complex Retrieval Queries,northwind,False,False,True,
Find all suppliers who supply products in both 'Beverages' and 'Condiments' categories.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WHERE c.categoryName IN ['Beverages', 'Condiments']
WITH s, collect(c.categoryName) AS categories
WHERE ALL(cat IN ['Beverages', 'Condiments'] WHERE cat IN categories)
RETURN s",Complex Retrieval Queries,northwind,False,False,True,
Which customers have ordered products with a total quantity greater than 50?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
WITH c, sum(r.quantity) AS totalQuantity
WHERE totalQuantity > 50
RETURN c.companyName AS CustomerName, totalQuantity",Complex Retrieval Queries,northwind,False,False,True,
Show all products that are in the 'Seafood' category and have been ordered more than 5 times.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Seafood'})
WHERE count{(p)<-[:ORDERS]-(:Order)} > 5
RETURN p",Complex Retrieval Queries,northwind,False,False,True,
Identify the top 3 most expensive products supplied by suppliers from 'UK'.,"MATCH (s:Supplier {country: 'UK'})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 3",Complex Retrieval Queries,northwind,False,False,True,
Which orders were placed by 'Sales Representative' title holders?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE c.contactTitle = 'Sales Representative'
RETURN o",Complex Retrieval Queries,northwind,False,False,True,
Display products with 'unitPrice' higher than the average unit price of their category.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c, AVG(p.unitPrice) AS avgPrice
MATCH (p2:Product)-[:PART_OF]->(c)
WHERE p2.unitPrice > avgPrice
RETURN p2.productName, p2.unitPrice, c.categoryName, avgPrice",Complex Retrieval Queries,northwind,False,False,True,
List all products with 'unitPrice' less than 5.,"MATCH (p:Product)
WHERE p.unitPrice < 5
RETURN p",Complex Retrieval Queries,northwind,False,False,True,
Which categories contain products that have been reordered (reorder level > 0)?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.reorderLevel > 0
RETURN DISTINCT c.categoryName",Complex Retrieval Queries,northwind,False,False,True,
What are the highest discount rates applied to any products?,"MATCH (:Order)-[r:ORDERS]->(:Product)
RETURN MAX(r.discount) AS HighestDiscount",Complex Retrieval Queries,northwind,False,False,True,
Which products have 'unitsInStock' exactly 0 and are not discontinued?,"MATCH (p:Product)
WHERE p.unitsInStock = 0 AND p.discontinued = false
RETURN p",Complex Retrieval Queries,northwind,False,False,False,
List all discontinued products with zero units in stock.,"MATCH (p:Product)
WHERE p.discontinued = true AND p.unitsInStock = 0
RETURN p",Complex Retrieval Queries,northwind,False,False,True,
Identify the top 3 suppliers by the number of products supplied.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, count(p) AS products_supplied
ORDER BY products_supplied DESC
LIMIT 3
RETURN s.companyName, products_supplied",Complex Retrieval Queries,northwind,False,False,False,
Which orders have a required date in '1996' and were shipped via '2'?,"MATCH (o:Order)
WHERE o.requiredDate CONTAINS '1996' AND o.shipVia = '2'
RETURN o",Verbose query,northwind,False,False,True,
Find the top 3 most expensive products supplied by 'Exotic Liquids'.,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 3",Verbose query,northwind,False,False,True,
List the first 3 products that have never been reordered (reorder level = 0).,"MATCH (p:Product)
WHERE p.reorderLevel = 0
RETURN p
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
List the first 3 suppliers of products in the 'Confections' category.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Confections'})
RETURN s
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
Which 3 products have been reordered the most times?,"MATCH (p:Product)-[:ORDERS]->(o:Order)
RETURN p.productName, count(o) AS reorderCount
ORDER BY reorderCount DESC
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
List the top 5 orders with the highest freight costs.,"MATCH (o:Order)
RETURN o
ORDER BY o.freight DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
Which 3 customers ordered products on '1996-07-04'?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order {orderDate: '1996-07-04'})
RETURN c.companyName
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
What are the top 5 products with a reorder level above 20?,"MATCH (p:Product)
WHERE p.reorderLevel > 20
RETURN p
ORDER BY p.reorderLevel DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
List the first 3 orders that were required after '1997-01-01'.,"MATCH (o:Order)
WHERE o.requiredDate > '1997-01-01 00:00:00.000'
RETURN o
ORDER BY o.requiredDate
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
Which 3 categories contain products with no units on order?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitsOnOrder = 0
RETURN DISTINCT c.categoryName
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
List the top 5 customers based in London.,"MATCH (c:Customer {city: ""London""})
RETURN c.companyName, c.contactName
ORDER BY c.customerID
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
Which 3 suppliers have the most products with a reorder level of 0?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.reorderLevel = 0
RETURN s.companyName, count(p) AS NumberOfProducts
ORDER BY NumberOfProducts DESC
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
What are the top 5 products with the most units in stock in the category 'Dairy Products'?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
List the first 3 orders shipped to 'France' with a ship via code '1'.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipCountry = 'France' AND o.shipVia = '1'
RETURN o.orderID, o.shippedDate, o.shipName
ORDER BY o.shippedDate
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
Which 3 products are supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)
RETURN p.productName
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
List the first 3 customers who have purchased 'Chef Anton's Cajun Seasoning'.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product {productName: ""Chef Anton's Cajun Seasoning""})
RETURN c
LIMIT 3",Pathfinding Queries,northwind,True,False,False,
Which 3 products have the lowest unit price in the category 'Beverages'?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice ASC
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
List the top 5 suppliers located in the UK.,"MATCH (s:Supplier {country: 'UK'})
RETURN s.companyName, s.contactName, s.phone
ORDER BY s.companyName
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
Which 3 customers have purchased the most products by quantity?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
RETURN c.companyName, SUM(r.quantity) AS totalQuantity
ORDER BY totalQuantity DESC
LIMIT 3",Pathfinding Queries,northwind,False,False,False,
What are the top 5 products ordered by customers from Germany?,"MATCH (c:Customer {country: ""Germany""})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
RETURN p.productName, count(o) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
List the first 3 orders with a freight cost greater than $100.,"MATCH (o:Order)
WHERE o.freight > ""100""
RETURN o
ORDER BY o.orderDate
LIMIT 3",Pathfinding Queries,northwind,True,False,False,
Which 3 categories have the most products with a reorder level above 15?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.reorderLevel > 15
WITH c, count(p) AS productCount
ORDER BY productCount DESC
LIMIT 3
RETURN c.categoryName, productCount",Pathfinding Queries,northwind,False,False,True,
What are the top 5 products with the shortest names?,"MATCH (p:Product)
RETURN p
ORDER BY length(p.productName) ASC
LIMIT 5",Pathfinding Queries,northwind,False,False,False,
Which 3 suppliers supply products to more than one category?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH s, count(DISTINCT c) AS numCategories
WHERE numCategories > 1
RETURN s
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
List the top 5 most frequently ordered products.,"MATCH (p:Product)<-[:ORDERS]-(:Order)
WITH p, count(*) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 5
RETURN p.productName, ordersCount",Pathfinding Queries,northwind,False,False,True,
Which 3 products have the most discounts applied in orders?,"MATCH (p:Product)-[o:ORDERS]->(:Order)
WITH p, SUM(toFloat(o.discount)) AS totalDiscount
ORDER BY totalDiscount DESC
LIMIT 3
RETURN p.productName, totalDiscount",Pathfinding Queries,northwind,False,False,True,
List the first 3 orders where the shipped date is before the required date.,"MATCH (o:Order)
WHERE o.shippedDate < o.requiredDate
RETURN o
ORDER BY o.shippedDate
LIMIT 3",Pathfinding Queries,northwind,False,False,False,
Which 3 customers have the longest company names?,"MATCH (c:Customer)
RETURN c.companyName, c.customerID
ORDER BY length(c.companyName) DESC
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
What are the top 5 categories based on the average reorder level of their products?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS CategoryName, AVG(p.reorderLevel) AS AvgReorderLevel
ORDER BY AvgReorderLevel DESC
RETURN CategoryName, AvgReorderLevel
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
List the top 5 products with discontinued status and a reorder level above 5.,"MATCH (p:Product)
WHERE p.discontinued = TRUE AND p.reorderLevel > 5
RETURN p
ORDER BY p.reorderLevel DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
Which 3 suppliers have products listed in both 'Beverages' and 'Condiments' categories?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WHERE c.categoryName IN ['Beverages', 'Condiments']
WITH s, count(DISTINCT c) AS categoriesCount
WHERE categoriesCount = 2
RETURN s
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
List the top 5 products with the lowest units in stock.,"MATCH (p:Product)
WHERE p.unitsInStock IS NOT NULL
RETURN p
ORDER BY p.unitsInStock ASC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
Which 3 customers have ordered the most diverse range of product categories?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(cat:Category)
WITH c, COUNT(DISTINCT cat.categoryID) AS diversity
ORDER BY diversity DESC
LIMIT 3
RETURN c.companyName, diversity",Pathfinding Queries,northwind,False,False,True,
What are the top 5 most frequently shipped products to 'France'?,"MATCH (p:Product)<-[:ORDERS]-(o:Order)-[:PURCHASED]->(c:Customer)
WHERE o.shipCountry = 'France'
RETURN p.productName, count(o) AS shipments
ORDER BY shipments DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
Which 3 categories have the highest average unit price per product?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS Category, AVG(p.unitPrice) AS AvgUnitPrice
RETURN Category, AvgUnitPrice
ORDER BY AvgUnitPrice DESC
LIMIT 3",Pathfinding Queries,northwind,False,False,False,
List the top 5 most expensive products that are not discontinued.,"MATCH (p:Product)
WHERE p.discontinued = false AND p.unitPrice IS NOT NULL
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
List the top 5 orders placed by customers in 'Berlin'.,"MATCH (c:Customer {city: 'Berlin'})-[:PURCHASED]->(o:Order)
RETURN o
ORDER BY o.orderDate DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
List the top 5 customers who have ordered the most units of a single product.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
RETURN c.companyName, SUM(r.quantity) AS totalUnitsOrdered
ORDER BY totalUnitsOrdered DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
Which 3 products have the highest units on order in the 'Meat/Poultry' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Meat/Poultry'})
WHERE p.unitsOnOrder IS NOT NULL
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
What are the top 5 most frequently purchased categories by customers in the USA?,"MATCH (c:Customer {country: 'USA'})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(cat:Category)
WITH cat, count(o) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 5
RETURN cat.categoryName, ordersCount",Pathfinding Queries,northwind,False,False,False,
List the top 5 products from 'Exotic Liquids' by units in stock.,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
Which 3 categories have products that are all discontinued?,"MATCH (c:Category)<-[:PART_OF]-(p:Product)
WHERE p.discontinued = true
WITH c, count(p) AS totalProducts
WHERE NOT exists {
    MATCH (c)<-[:PART_OF]-(p2:Product)
    WHERE p2.discontinued = false
}
RETURN c.categoryName
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
List the first 3 products that are supplied exclusively by 'Mayumi's'.,"MATCH (s:Supplier {companyName: ""Mayumi's""})-[:SUPPLIES]->(p:Product)
WHERE NOT exists {
    MATCH (s2:Supplier)-[:SUPPLIES]->(p)
    WHERE s2 <> s
}
RETURN p.productName, p.productID
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
Which 3 orders have the largest quantity of a single product ordered?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
RETURN o.orderID, p.productID, r.quantity
ORDER BY r.quantity DESC
LIMIT 3",Pathfinding Queries,northwind,False,False,False,
What are the top 5 suppliers with the most products listed?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, count(p) AS numProducts
ORDER BY numProducts DESC
LIMIT 5
RETURN s.companyName, numProducts",Pathfinding Queries,northwind,False,False,True,
List the first 3 customers who have never ordered a discontinued product.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE NOT exists {
    MATCH (p)
    WHERE p.discontinued = true
}
RETURN c
LIMIT 3",Pathfinding Queries,northwind,False,False,False,
Which 3 products have the most variations in unit price among orders?,"MATCH (p:Product)-[o:ORDERS]->(:Order)
WITH p.productName AS productName, COUNT(DISTINCT o.unitPrice) AS priceVariations
ORDER BY priceVariations DESC
LIMIT 3
RETURN productName, priceVariations",Pathfinding Queries,northwind,False,False,True,
Which 3 suppliers supply products with more than 50 units in stock?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.unitsInStock > 50
RETURN s.companyName, count(p) AS ProductsCount
ORDER BY ProductsCount DESC
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
What are the top 5 products with the highest units on order?,"MATCH (p:Product)
WHERE p.unitsOnOrder IS NOT NULL
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
Which orders were placed before '1997-01-01' and have a freight greater than 100?,"MATCH (o:Order)
WHERE o.orderDate < '1997-01-01' AND toFloat(o.freight) > 100
RETURN o",Simple Aggregation Queries,northwind,False,False,True,
Which products have been ordered more than 100 times?,"MATCH (p:Product)-[o:ORDERS]->()
WITH p, count(o) AS ordersCount
WHERE ordersCount > 100
RETURN p.productName, ordersCount",Simple Aggregation Queries,northwind,False,False,False,
What is the average discount given across all orders?,"MATCH (:Order)-[o:ORDERS]->(:Product)
RETURN AVG(toFloat(o.discount)) AS averageDiscount",Simple Aggregation Queries,northwind,False,False,True,
Which orders were required by '1998-06-02'?,"MATCH (o:Order)
WHERE o.requiredDate = '1998-06-02'
RETURN o",Simple Aggregation Queries,northwind,False,False,True,
List the products that are part of the 'Dairy Products' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
RETURN p.productName AS ProductName, p.productID AS ProductID",Simple Aggregation Queries,northwind,False,False,True,
What are the three highest freight values in orders?,"MATCH (o:Order)
RETURN o.freight
ORDER BY o.freight DESC
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
Which customers have a contactTitle of 'Sales Representative'?,"MATCH (c:Customer {contactTitle: 'Sales Representative'})
RETURN c",Simple Aggregation Queries,northwind,False,False,True,
How many products are supplied by each supplier?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
RETURN s.companyName, count(p) AS NumberOfProductsSupplied",Simple Aggregation Queries,northwind,False,False,True,
Which products have a discount of 0 in their orders?,"MATCH (p:Product)-[o:ORDERS]->(:Order)
WHERE o.discount = '0'
RETURN p.productName AS ProductName, p.productID AS ProductID",Simple Aggregation Queries,northwind,False,False,True,
What are the names of suppliers based in the UK?,"MATCH (s:Supplier {country: 'UK'})
RETURN s.companyName AS SupplierName",Simple Aggregation Queries,northwind,False,False,True,
What are the names of the products that have a quantityPerUnit of '10 boxes x 20 bags'?,"MATCH (p:Product)
WHERE p.quantityPerUnit = '10 boxes x 20 bags'
RETURN p.productName",Simple Aggregation Queries,northwind,False,False,True,
Which category has the least number of products on order?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitsOnOrder IS NOT NULL AND p.unitsOnOrder > 0
WITH c, count(p) AS productsOnOrder
ORDER BY productsOnOrder ASC
LIMIT 1
RETURN c.categoryName AS CategoryWithLeastProductsOnOrder, productsOnOrder",Simple Aggregation Queries,northwind,False,False,True,
List three customers who have purchased orders shipped to France.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE o.shipCountry = 'France'
RETURN c.companyName, c.contactName, c.phone
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
Which suppliers have a contactTitle of 'Purchasing Manager'?,"MATCH (s:Supplier {contactTitle: 'Purchasing Manager'})
RETURN s",Simple Aggregation Queries,northwind,False,False,True,
What are the three most common product categories based on the number of products?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c, count(p) AS productCount
ORDER BY productCount DESC
LIMIT 3
RETURN c.categoryName, productCount",Simple Aggregation Queries,northwind,False,False,True,
Which categories include products that have been discontinued?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.discontinued = true
RETURN DISTINCT c.categoryName",Simple Aggregation Queries,northwind,False,False,True,
What is the average unitPrice of products in the 'Beverages' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
RETURN AVG(p.unitPrice) AS AverageUnitPrice",Simple Aggregation Queries,northwind,False,False,True,
List the products with unitsOnOrder greater than 30.,"MATCH (p:Product)
WHERE p.unitsOnOrder > 30
RETURN p",Simple Aggregation Queries,northwind,False,False,True,
Which products have a reorderLevel of 25 or higher?,"MATCH (p:Product)
WHERE p.reorderLevel >= 25
RETURN p.productName, p.productID, p.reorderLevel",Simple Aggregation Queries,northwind,False,False,True,
"What are the three most recent orders, based on orderDate?","MATCH (o:Order)
RETURN o
ORDER BY o.orderDate DESC
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
Name three customers from Berlin.,"MATCH (c:Customer {city: ""Berlin""})
RETURN c.companyName
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
What are the top 5 products by quantity ordered in the most recent orders?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WHERE o.orderDate IS NOT NULL
WITH p, r.quantity AS quantity_ordered, o.orderDate AS order_date
ORDER BY order_date DESC, quantity_ordered DESC
RETURN p.productName, quantity_ordered
LIMIT 5",Simple Aggregation Queries,northwind,False,False,True,
What are the top 5 products with the lowest unit price in the 'Seafood' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Seafood'})
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice ASC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
Name the top three most frequently ordered products.,"MATCH (p:Product)<-[:ORDERS]-(:Order)
WITH p, count(*) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 3
RETURN p.productName AS ProductName, ordersCount",Simple Aggregation Queries,northwind,False,False,True,
What is the maximum unitsOnOrder for products within the 'Confections' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Confections'})
RETURN MAX(p.unitsOnOrder) AS MaxUnitsOnOrder",Simple Aggregation Queries,northwind,False,False,True,
What are the top 5 categories by total unitsInStock?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS CategoryName, SUM(p.unitsInStock) AS TotalUnitsInStock
ORDER BY TotalUnitsInStock DESC
RETURN CategoryName, TotalUnitsInStock
LIMIT 5",Simple Aggregation Queries,northwind,False,False,True,
List the products supplied by suppliers with a phone number starting with '(171)'.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.phone STARTS WITH '(171)'
RETURN p.productName, p.productID",Simple Aggregation Queries,northwind,False,False,True,
Name three suppliers from Germany.,"MATCH (s:Supplier {country: 'Germany'})
RETURN s.companyName
LIMIT 3",Simple Aggregation Queries,northwind,False,False,False,
Which products have a unitsOnOrder of zero and are discontinued?,"MATCH (p:Product)
WHERE p.unitsOnOrder = 0 AND p.discontinued = true
RETURN p.productName, p.productID",Simple Aggregation Queries,northwind,False,False,True,
What are the three least expensive products in terms of unitPrice?,"MATCH (p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice ASC
LIMIT 3",Simple Aggregation Queries,northwind,True,False,False,
What are the names of customers who have ordered products in the 'Beverages' category?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(cat:Category {categoryName: 'Beverages'})
RETURN DISTINCT c.companyName AS CustomerName",Simple Aggregation Queries,northwind,False,False,True,
Which products have been reordered (unitsOnOrder greater than 0) but not discontinued?,"MATCH (p:Product)
WHERE p.unitsOnOrder > 0 AND p.discontinued = false
RETURN p.productName, p.unitsOnOrder",Simple Aggregation Queries,northwind,False,False,True,
List the top three categories by average unitPrice of products.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitPrice IS NOT NULL
RETURN c.categoryName, avg(p.unitPrice) AS averageUnitPrice
ORDER BY averageUnitPrice DESC
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
Which suppliers are located in cities starting with 'L'?,"MATCH (s:Supplier)
WHERE s.city STARTS WITH 'L'
RETURN s",Simple Aggregation Queries,northwind,False,False,True,
Which suppliers do not have a homePage listed?,"MATCH (s:Supplier)
WHERE s.homePage IS NULL
RETURN s",Simple Aggregation Queries,northwind,False,False,True,
Which categories have products with a unitPrice greater than 50?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitPrice > 50
RETURN DISTINCT c.categoryName",Simple Aggregation Queries,northwind,False,False,False,
What are the names of products that have been ordered with a quantity greater than 50?,"MATCH (p:Product)<-[:ORDERS {quantity: q}]-(:Order)
WHERE q > 50
RETURN p.productName AS ProductName",Simple Aggregation Queries,northwind,False,False,True,
Which orders have a shipVia of '1' and were shipped to 'France'?,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipVia = '1' AND o.shipCountry = 'France'
RETURN o.orderID, o.shippedDate, p.productName",Simple Aggregation Queries,northwind,False,False,False,
List the products with a unitsInStock less than 15.,"MATCH (p:Product)
WHERE p.unitsInStock < 15
RETURN p",Simple Aggregation Queries,northwind,False,False,True,
What is the minimum reorder level for products in the 'Seafood' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Seafood'})
RETURN min(p.reorderLevel) AS MinimumReorderLevel",Simple Aggregation Queries,northwind,False,False,True,
How many different categories of products do we have?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
RETURN COUNT(DISTINCT c) AS NumberOfDifferentCategories",Simple Aggregation Queries,northwind,False,False,True,
Which products have the lowest unitsInStock in the 'Grains/Cereals' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Grains/Cereals'})
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock ASC
LIMIT 1",Simple Aggregation Queries,northwind,False,False,True,
What are the names of suppliers who supply products to orders with a shipCountry of 'Denmark'?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:ORDERS]->(o:Order)
WHERE o.shipCountry = 'Denmark'
RETURN DISTINCT s.companyName AS SupplierName",Simple Aggregation Queries,northwind,False,False,True,
List the names of three customers who ordered products shipped via '3'.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipVia = '3'
RETURN DISTINCT c.companyName
LIMIT 3",Simple Aggregation Queries,northwind,False,False,True,
Which suppliers supply more than five different products?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, count(DISTINCT p) AS numProducts
WHERE numProducts > 5
RETURN s",Simple Aggregation Queries,northwind,False,False,True,
What is the total number of units ordered for products by 'Vins et alcools Chevalier'?,"MATCH (c:Customer {companyName: ""Vins et alcools Chevalier""})-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
RETURN sum(r.quantity) AS TotalUnitsOrdered",Simple Aggregation Queries,northwind,False,False,True,
Which suppliers provide products that are not discontinued?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.discontinued = false
RETURN s",Simple Aggregation Queries,northwind,False,False,True,
Which 3 suppliers have the most products with zero units on order?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.unitsOnOrder = 0
WITH s, count(p) AS ProductsCount
ORDER BY ProductsCount DESC
LIMIT 3
RETURN s.companyName, ProductsCount",Pathfinding Queries,northwind,False,False,True,
Which 3 products have been purchased the most times in the 'Dairy Products' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
WITH p, count{(p)<-[:ORDERS]-(:Order)} AS purchases
ORDER BY purchases DESC
LIMIT 3
RETURN p.productName, purchases",Pathfinding Queries,northwind,False,False,True,
Which customers have ordered 'Chai'?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product {productName: 'Chai'})
RETURN DISTINCT c.companyName AS CustomerName",Complex Aggregation Queries,northwind,False,False,True,
Show all products that are in stock but have a reorder level above 20.,"MATCH (p:Product)
WHERE p.unitsInStock > 0 AND p.reorderLevel > 20
RETURN p",Complex Aggregation Queries,northwind,False,False,True,
Which products are supplied by suppliers from the UK?,"MATCH (s:Supplier {country: 'UK'})-[:SUPPLIES]->(p:Product)
RETURN p.productName AS ProductName, p.productID AS ProductID",Complex Aggregation Queries,northwind,False,False,True,
List the top 5 suppliers based on the number of products they supply.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, count(p) AS products_supplied
ORDER BY products_supplied DESC
LIMIT 5
RETURN s.companyName, products_supplied",Complex Aggregation Queries,northwind,False,False,True,
Which categories contain products that have never been reordered (reorder level is 0)?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.reorderLevel = 0
RETURN DISTINCT c.categoryName",Complex Aggregation Queries,northwind,False,False,True,
List the first 3 products with the highest discount in orders.,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
RETURN p.productName, r.discount
ORDER BY r.discount DESC
LIMIT 3",Complex Aggregation Queries,northwind,False,False,True,
Which supplier supplies the most products to 'Alfreds Futterkiste'?,"MATCH (c:Customer {companyName: ""Alfreds Futterkiste""})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)<-[:SUPPLIES]-(s:Supplier)
RETURN s.companyName, count(p) AS NumberOfProductsSupplied
ORDER BY NumberOfProductsSupplied DESC
LIMIT 1",Complex Aggregation Queries,northwind,False,False,True,
What are the first 3 most frequently ordered products?,"MATCH (p:Product)<-[:ORDERS]-(:Order)
WITH p, count(*) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 3
RETURN p.productName, ordersCount",Complex Aggregation Queries,northwind,False,False,True,
List all customers who have purchased products with a unit price greater than 50.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE p.unitPrice > 50
RETURN DISTINCT c",Complex Aggregation Queries,northwind,False,False,True,
Which products have been ordered by 'Alfreds Futterkiste'?,"MATCH (c:Customer {companyName: ""Alfreds Futterkiste""})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
RETURN p.productName AS ProductOrdered",Complex Aggregation Queries,northwind,False,False,True,
What are the top 5 most stocked products in the 'Dairy Products' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 5",Complex Aggregation Queries,northwind,False,False,True,
List all products that have more than 50 units on order.,"MATCH (p:Product)
WHERE p.unitsOnOrder > 50
RETURN p",Complex Aggregation Queries,northwind,False,False,True,
Which suppliers provide products with a reorder level above 25?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.reorderLevel > 25
RETURN s",Complex Aggregation Queries,northwind,False,False,True,
Show the first 3 products that have been discontinued.,"MATCH (p:Product)
WHERE p.discontinued = true
RETURN p
LIMIT 3",Complex Aggregation Queries,northwind,True,False,False,
What are the top 5 most expensive products supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 5",Complex Aggregation Queries,northwind,False,False,True,
List all products that are part of the 'Beverages' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
RETURN p",Complex Aggregation Queries,northwind,False,False,True,
Which products are supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)
RETURN p.productName AS ProductName, p.productID AS ProductID",Complex Aggregation Queries,northwind,False,False,True,
Which 3 products have been ordered by the most distinct customers?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WITH p, count(DISTINCT c) AS distinctCustomers
ORDER BY distinctCustomers DESC
LIMIT 3
RETURN p.productName, distinctCustomers",Pathfinding Queries,northwind,False,False,True,
List the top 5 products by units on order in the 'Seafood' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Seafood'})
WHERE p.unitsOnOrder IS NOT NULL
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,False,
List the first 3 orders made by 'Alfreds Futterkiste' with a freight cost greater than 10.,"MATCH (c:Customer {companyName: ""Alfreds Futterkiste""})-[:PURCHASED]->(o:Order)
WHERE o.freight > ""10""
RETURN o
ORDER BY o.orderDate
LIMIT 3",Complex Aggregation Queries,northwind,False,False,True,
What are the top 5 most ordered products in terms of quantity?,"MATCH (p:Product)<-[:ORDERS]-(:Order)
WITH p, sum(toInteger(ORDERS.quantity)) AS totalQuantity
ORDER BY totalQuantity DESC
LIMIT 5
RETURN p.productName, totalQuantity",Complex Aggregation Queries,northwind,False,False,True,
List all categories that have products with units in stock less than 10.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitsInStock < 10
RETURN DISTINCT c",Complex Aggregation Queries,northwind,False,False,True,
Which suppliers have all their products with a unit price above 20?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE NOT exists {
    MATCH (s)-[:SUPPLIES]->(p2:Product)
    WHERE p2.unitPrice <= 20
}
RETURN s",Complex Aggregation Queries,northwind,False,False,True,
Which suppliers have products listed in more than three categories?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH s, count(DISTINCT c) AS numCategories
WHERE numCategories > 3
RETURN s",Complex Aggregation Queries,northwind,False,False,True,
List the first 3 products from the 'Grains/Cereals' category that have been reordered (reorder level > 0).,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Grains/Cereals'})
WHERE p.reorderLevel > 0
RETURN p
LIMIT 3",Complex Aggregation Queries,northwind,False,False,True,
Which products have a discount greater than 0 in their orders?,"MATCH (p:Product)-[o:ORDERS]->(:Order)
WHERE toFloat(o.discount) > 0
RETURN p.productName, o.unitPrice, o.discount",Complex Aggregation Queries,northwind,True,False,False,
Show the first 3 products with the highest units on order.,"MATCH (p:Product)
WHERE p.unitsOnOrder IS NOT NULL
RETURN p
ORDER BY p.unitsOnOrder DESC
LIMIT 3",Complex Aggregation Queries,northwind,False,False,True,
Which products have been ordered by customers from Berlin?,"MATCH (c:Customer {city: ""Berlin""})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
RETURN DISTINCT p.productName AS ProductOrdered",Complex Aggregation Queries,northwind,False,False,True,
List all suppliers that provide products to the 'Dairy Products' category.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
RETURN DISTINCT s",Complex Aggregation Queries,northwind,False,False,True,
What are the top 5 products by quantity ordered in the 'Condiments' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Condiments'})
WITH p
MATCH (p)<-[:ORDERS]-(o:Order)
RETURN p.productName, sum(o.quantity) AS TotalQuantityOrdered
ORDER BY TotalQuantityOrdered DESC
LIMIT 5",Complex Aggregation Queries,northwind,False,False,False,Order.quantity
Show the first 3 orders from 'Lonesome Pine Restaurant' with a freight cost less than 1.,"MATCH (c:Customer {companyName: ""Lonesome Pine Restaurant""})-[:PURCHASED]->(o:Order)
WHERE o.freight < ""1""
RETURN o
ORDER BY o.orderDate
LIMIT 3",Complex Aggregation Queries,northwind,False,False,True,
Which customers have ordered the product with productID '1'?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product {productID: '1'})
RETURN DISTINCT c.companyName AS CustomerName",Complex Aggregation Queries,northwind,False,False,True,
Which 3 customers have the shortest company names?,"MATCH (c:Customer)
RETURN c
ORDER BY length(c.companyName) ASC
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
List all products supplied by 'Exotic Liquids' that have a unit price above 10.,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)
WHERE p.unitPrice > 10
RETURN p.productName, p.unitPrice",Complex Aggregation Queries,northwind,False,False,True,
Which suppliers provide products to the 'Meat/Poultry' category with a unit price less than 20?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Meat/Poultry'})
WHERE p.unitPrice < 20
RETURN s.companyName, p.productName, p.unitPrice",Complex Aggregation Queries,northwind,False,False,False,
List the top 5 customers based on the number of orders placed.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
RETURN c.companyName, count(o) AS NumberOfOrders
ORDER BY NumberOfOrders DESC
LIMIT 5",Complex Aggregation Queries,northwind,False,False,True,
Show all products that are both in the 'Seafood' category and have been discontinued.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Seafood'})
WHERE p.discontinued = true
RETURN p",Complex Aggregation Queries,northwind,False,False,True,
Which categories have products with a unit price greater than 100?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitPrice > 100
RETURN DISTINCT c.categoryName",Complex Aggregation Queries,northwind,False,False,True,
List the first 3 products that have been ordered by customers from France.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE c.country = 'France'
RETURN p.productName, p.productID
LIMIT 3",Complex Aggregation Queries,northwind,False,False,True,
Which suppliers supply to more than one category?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH s, count(DISTINCT c) AS numCategories
WHERE numCategories > 1
RETURN s",Complex Aggregation Queries,northwind,False,False,True,
List all products that have been ordered in the month of July 1996.,"MATCH (p:Product)<-[:ORDERS]-(o:Order)
WHERE o.orderDate >= '1996-07-01 00:00:00.000' AND o.orderDate <= '1996-07-31 23:59:59.999'
RETURN p.productName, p.productID",Complex Aggregation Queries,northwind,False,False,False,
Which products have been ordered more than 100 times?,"MATCH (p:Product)-[o:ORDERS]->(:Order)
WITH p, count(o) AS ordersCount
WHERE ordersCount > 100
RETURN p.productName, ordersCount",Complex Aggregation Queries,northwind,False,False,False,
Show the first 3 products with the lowest units in stock in the 'Confections' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Confections'})
WITH p
ORDER BY p.unitsInStock ASC
LIMIT 3
RETURN p.productName, p.unitsInStock",Complex Aggregation Queries,northwind,False,False,True,
What are the first 3 products with the highest units on order in the 'Beverages' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
WHERE p.unitsOnOrder IS NOT NULL
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 3",Complex Aggregation Queries,northwind,False,False,True,
What are the top 5 most frequently ordered products in the 'Produce' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Produce'})
WITH p, count{(p)<-[:ORDERS]-(:Order)} AS ordersCount
ORDER BY ordersCount DESC
LIMIT 5
RETURN p.productName, ordersCount",Pathfinding Queries,northwind,False,False,True,
List the first 3 products from suppliers in 'UK'.,"MATCH (s:Supplier {country: 'UK'})-[:SUPPLIES]->(p:Product)
RETURN p
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
Which 3 suppliers have the least discontinued products?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.discontinued = false
WITH s, count(p) AS activeProducts
ORDER BY activeProducts ASC
RETURN s.companyName, activeProducts
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
Which 3 products have the highest average discount in orders?,"MATCH (p:Product)-[o:ORDERS]->(:Order)
WITH p, AVG(toFloat(o.discount)) AS avgDiscount
ORDER BY avgDiscount DESC
LIMIT 3
RETURN p.productName, avgDiscount",Pathfinding Queries,northwind,False,False,True,
List the top 5 products that have been ordered more than 50 times.,"MATCH (p:Product)-[o:ORDERS]->(:Order)
WITH p, count(o) AS ordersCount
WHERE ordersCount > 50
RETURN p.productName, ordersCount
ORDER BY ordersCount DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,False,
Which 3 suppliers have the most products discontinued?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product {discontinued: true})
WITH s, count(p) AS discontinuedProducts
ORDER BY discontinuedProducts DESC
LIMIT 3
RETURN s.companyName, discontinuedProducts",Pathfinding Queries,northwind,False,False,True,
List the top 5 products that have the highest reorder levels.,"MATCH (p:Product)
RETURN p.productName, p.reorderLevel
ORDER BY p.reorderLevel DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
Which 3 customers have the most orders with a ship via code '3'?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE o.shipVia = '3'
WITH c, count(o) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 3
RETURN c.companyName, ordersCount",Pathfinding Queries,northwind,False,False,True,
What are the top 5 products in the 'Grains/Cereals' category by units in stock?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Grains/Cereals'})
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
List the top 5 most frequently ordered products by customers in 'London'.,"MATCH (c:Customer {city: 'London'})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
RETURN p.productName, count(o) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
Which 3 categories have the least discontinued products?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.discontinued = false
WITH c, count(p) AS ActiveProducts
ORDER BY ActiveProducts ASC
RETURN c.categoryName, ActiveProducts
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
List the first 3 products that have been ordered with a discount of more than 5%.,"MATCH (p:Product)-[o:ORDERS]->(:Order)
WHERE toFloat(o.discount) > 0.05
RETURN p.productName, p.productID, o.unitPrice, o.discount
ORDER BY o.orderID
LIMIT 3",Pathfinding Queries,northwind,False,False,False,
List the top 5 customers who have ordered the most expensive products (by unit price).,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
RETURN c.companyName, SUM(toFloat(r.unitPrice) * r.quantity) AS totalSpent
ORDER BY totalSpent DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
Which 3 suppliers have the highest average unit price across their products?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, AVG(p.unitPrice) AS avgUnitPrice
ORDER BY avgUnitPrice DESC
LIMIT 3
RETURN s.companyName, avgUnitPrice",Pathfinding Queries,northwind,False,False,True,
List the top 5 products with a unit price between $10 and $50.,"MATCH (p:Product)
WHERE p.unitPrice >= 10 AND p.unitPrice <= 50
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
Which 3 orders have the highest number of distinct products ordered?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WITH o, count(DISTINCT p) AS numProducts
ORDER BY numProducts DESC
LIMIT 3
RETURN o.orderID AS OrderID, numProducts",Pathfinding Queries,northwind,False,False,True,
What are the top 5 discontinued products by units in stock?,"MATCH (p:Product)
WHERE p.discontinued = true
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
List the first 3 suppliers who have supplied products with a unit price over $100.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.unitPrice > 100
RETURN s
LIMIT 3",Pathfinding Queries,northwind,False,False,False,
Which 3 products have been ordered in the highest quantities?,"MATCH (p:Product)-[o:ORDERS]->(:Order)
RETURN p.productName, SUM(o.quantity) AS TotalQuantity
ORDER BY TotalQuantity DESC
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
List the top 5 suppliers with products in more than three categories.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH s, count(DISTINCT c) AS numCategories
WHERE numCategories > 3
RETURN s
ORDER BY numCategories DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
Which 3 categories contain the most products with a unit price over $50?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitPrice > 50
WITH c, count(p) AS ProductCount
ORDER BY ProductCount DESC
LIMIT 3
RETURN c.categoryName, ProductCount",Pathfinding Queries,northwind,False,False,True,
What are the top 5 customers based on the total freight cost of their orders?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WITH c, SUM(toFloat(o.freight)) AS totalFreight
ORDER BY totalFreight DESC
LIMIT 5
RETURN c.companyName, totalFreight",Pathfinding Queries,northwind,False,False,True,
List the first 3 products from suppliers in 'Germany'.,"MATCH (s:Supplier {country: 'Germany'})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.productID, p.unitPrice
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
What are the top 5 most frequently ordered products to 'Berlin'?,"MATCH (c:Customer {city: 'Berlin'})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
RETURN p.productName, count(o) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
List the top 5 products by quantity per unit ordered in '1996'.,"MATCH (p:Product)-[o:ORDERS]->(ord:Order)
WHERE ord.orderDate STARTS WITH '1996'
WITH p, SUM(o.quantity) AS totalQuantity
ORDER BY totalQuantity DESC
LIMIT 5
RETURN p.productName, totalQuantity",Pathfinding Queries,northwind,False,False,True,
What are the top 5 products with the most units on order in the 'Condiments' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Condiments'})
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
List the first 3 orders where the freight cost was less than $15.,"MATCH (o:Order)
WHERE o.freight < ""15""
RETURN o
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
What are the top 5 products with the highest reorder levels in the 'Meat/Poultry' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Meat/Poultry'})
RETURN p.productName, p.reorderLevel
ORDER BY p.reorderLevel DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
List the top 5 suppliers based on the average freight cost of orders for their products.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)<-[:ORDERS]-(o:Order)
WITH s, AVG(toFloat(o.freight)) AS avgFreight
ORDER BY avgFreight DESC
RETURN s.companyName, avgFreight
LIMIT 5",Pathfinding Queries,northwind,False,False,False,
Which 3 products are most frequently ordered in the 'Confections' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Confections'})
WITH p
MATCH (o:Order)-[r:ORDERS]->(p)
RETURN p.productName, count(r) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
List the top 5 orders with the most products ordered in a single order.,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WITH o, count(p) AS products_count
ORDER BY products_count DESC
LIMIT 5
RETURN o AS Order, products_count AS NumberOfProducts",Pathfinding Queries,northwind,False,False,True,
Which 3 categories have the most products with a unit price over $100?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitPrice > 100
WITH c, count(p) AS productCount
ORDER BY productCount DESC
LIMIT 3
RETURN c.categoryName, productCount",Pathfinding Queries,northwind,False,False,True,
What are the top 5 most frequently ordered products in the 'Grains/Cereals' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Grains/Cereals'})
WITH p, count{(p)<-[:ORDERS]-()} AS ordersCount
ORDER BY ordersCount DESC
LIMIT 5
RETURN p.productName, ordersCount",Pathfinding Queries,northwind,False,False,True,
List the first 3 products with a unit price less than $5.,"MATCH (p:Product)
WHERE p.unitPrice < 5
RETURN p
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
Which 3 suppliers have the highest average units in stock per product?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, AVG(p.unitsInStock) AS avgUnitsInStock
ORDER BY avgUnitsInStock DESC
LIMIT 3
RETURN s.companyName, avgUnitsInStock",Pathfinding Queries,northwind,False,False,True,
What are the top 5 products that have been reordered the least times?,"MATCH (p:Product)-[:ORDERS]->(o:Order)
WITH p, count(o) AS reorderCount
ORDER BY reorderCount ASC
LIMIT 5
RETURN p.productName, reorderCount",Pathfinding Queries,northwind,False,False,True,
Which 3 customers have ordered the most products in the 'Seafood' category?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(cat:Category {categoryName: ""Seafood""})
WITH c, count(p) AS products_ordered
ORDER BY products_ordered DESC
LIMIT 3
RETURN c.companyName, products_ordered",Pathfinding Queries,northwind,False,False,True,
List the top 5 products with the highest units on order in the 'Produce' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Produce'})
WHERE p.unitsOnOrder IS NOT NULL
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
What are the top 5 most frequently ordered products in the 'Dairy Products' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
WITH p, count{(p)<-[:ORDERS]-(:Order)} AS ordersCount
ORDER BY ordersCount DESC
LIMIT 5
RETURN p.productName, ordersCount",Pathfinding Queries,northwind,False,False,True,
List the first 3 orders that included both 'Beverages' and 'Condiments' products.,"MATCH (o:Order)-[:ORDERS]->(p1:Product)-[:PART_OF]->(c1:Category {categoryName: 'Beverages'}),
      (o)-[:ORDERS]->(p2:Product)-[:PART_OF]->(c2:Category {categoryName: 'Condiments'})
WITH o
ORDER BY o.orderDate
RETURN o
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
Which 3 suppliers have provided products to the most distinct categories?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH s, count(DISTINCT c) AS distinctCategories
ORDER BY distinctCategories DESC
LIMIT 3
RETURN s.companyName, distinctCategories",Pathfinding Queries,northwind,False,False,True,
What are the top 5 most frequently ordered products by customers from 'USA'?,"MATCH (c:Customer {country: 'USA'})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
RETURN p.productName, count(o) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
List the top 5 categories with the most products on order.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitsOnOrder > 0
WITH c, count(p) AS ProductsOnOrder
ORDER BY ProductsOnOrder DESC
LIMIT 5
RETURN c.categoryName, ProductsOnOrder",Pathfinding Queries,northwind,False,False,True,
Which 3 products have the lowest reorder levels but are not discontinued?,"MATCH (p:Product)
WHERE p.discontinued = FALSE AND p.reorderLevel IS NOT NULL
RETURN p
ORDER BY p.reorderLevel ASC
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
List the top 5 orders with the latest required dates.,"MATCH (o:Order)
RETURN o
ORDER BY o.requiredDate DESC
LIMIT 5",Pathfinding Queries,northwind,False,False,True,
Which 3 suppliers have the most orders for their products?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)<-[:ORDERS]-(o:Order)
WITH s, count(o) AS totalOrders
ORDER BY totalOrders DESC
LIMIT 3
RETURN s.companyName, totalOrders",Pathfinding Queries,northwind,False,False,True,
What are the top 5 most frequently ordered products in the 'Beverages' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
WITH p, count{(p)<-[:ORDERS]-()} AS ordersCount
ORDER BY ordersCount DESC
LIMIT 5
RETURN p.productName, ordersCount",Pathfinding Queries,northwind,False,False,True,
Which 3 customers have ordered the most distinct products?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WITH c, count(DISTINCT p) AS distinctProducts
ORDER BY distinctProducts DESC
LIMIT 3
RETURN c.companyName, distinctProducts",Pathfinding Queries,northwind,False,False,True,
Show all customers who have ordered the 'Aniseed Syrup' product.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product {productName: 'Aniseed Syrup'})
RETURN c",Complex Aggregation Queries,northwind,False,False,True,
How many products are there in each category?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
RETURN c.categoryName, count(p) AS NumberOfProducts",Simple Aggregation Queries,northwind,False,False,True,
List the top 5 most expensive products based on unitPrice.,"MATCH (p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 5",Simple Aggregation Queries,northwind,True,False,False,
Find the top 5 orders placed by customers from the 'UK'.,"MATCH (c:Customer {country: 'UK'})-[:PURCHASED]->(o:Order)
RETURN o
ORDER BY o.orderDate DESC
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 suppliers have the most diverse range of product categories?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH s, count(DISTINCT c) AS categoryCount
ORDER BY categoryCount DESC
LIMIT 3
RETURN s.companyName, categoryCount",Simple Retrieval Queries,northwind,False,False,True,
List the first 5 categories that do not have any discontinued products.,"MATCH (c:Category)
WHERE NOT exists {
  MATCH (c)<-[:PART_OF]-(p:Product)
  WHERE p.discontinued = true
}
RETURN c
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 products have a 'quantityPerUnit' specification involving 'bags'?,"MATCH (p:Product)
WHERE p.quantityPerUnit CONTAINS 'bags'
RETURN p
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
Find the top 5 orders with the lowest freight charges.,"MATCH (o:Order)
RETURN o
ORDER BY o.freight
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 customers have ordered the least number of products?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WITH c, count(p) AS products_ordered
ORDER BY products_ordered ASC
LIMIT 3
RETURN c.companyName, products_ordered",Simple Retrieval Queries,northwind,False,False,True,
List the first 5 products that have been ordered with a quantity greater than 50.,"MATCH (p:Product)<-[:ORDERS {quantity: q}]-(:Order)
WHERE q > 50
RETURN p.productName, p.productID, p.unitPrice
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 suppliers are located in 'NULL' region?,"MATCH (s:Supplier)
WHERE s.region = 'NULL'
RETURN s
LIMIT 3",Simple Retrieval Queries,northwind,False,False,False,
Find the top 5 orders that were shipped via 'shipVia' 2.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipVia = '2'
RETURN o.orderID, o.shippedDate, o.shipName
ORDER BY o.shippedDate DESC
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 customers have their phone numbers starting with '030'?,"MATCH (c:Customer)
WHERE c.phone STARTS WITH '030'
RETURN c
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
List the first 5 products that have a 'unitPrice' between $10 and $20.,"MATCH (p:Product)
WHERE p.unitPrice >= 10 AND p.unitPrice <= 20
RETURN p
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 orders were shipped to the same city as the customer's address?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipCity = c.city
RETURN o.orderID, o.shipName, o.shipCity, c.companyName, c.city
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
Find the top 5 categories with the most expensive products on average.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS Category, AVG(p.unitPrice) AS AvgPrice
ORDER BY AvgPrice DESC
LIMIT 5
RETURN Category, AvgPrice",Simple Retrieval Queries,northwind,False,False,True,
Which 3 suppliers have the least number of products listed?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, count(p) AS numProducts
ORDER BY numProducts ASC
LIMIT 3
RETURN s.companyName, numProducts",Simple Retrieval Queries,northwind,False,False,True,
List the first 5 products that have been ordered in the year 1998.,"MATCH (p:Product)-[:ORDERS]->(o:Order)
WHERE o.orderDate >= '1998-01-01' AND o.orderDate < '1999-01-01'
RETURN p.productName, p.productID
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 orders have the highest number of units ordered per product?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
RETURN o.orderID, p.productID, r.quantity
ORDER BY r.quantity DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,False,
Find the top 5 customers who have ordered the product with the highest unit price.,"MATCH (p:Product)
WITH p ORDER BY p.unitPrice DESC LIMIT 1
MATCH (c:Customer)-[:PURCHASED]->(:Order)-[:ORDERS]->(p)
RETURN c.companyName, COUNT(*) AS ordersCount
ORDER BY ordersCount DESC LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 products have the lowest reorder level?,"MATCH (p:Product)
RETURN p.productName, p.reorderLevel
ORDER BY p.reorderLevel ASC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
List the first 5 products that have been ordered by customers in 'Berlin'.,"MATCH (c:Customer {city: 'Berlin'})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
RETURN p.productName, p.productID
LIMIT 5",Simple Retrieval Queries,northwind,False,False,False,
Which 3 products are most frequently reordered (reorder level at maximum)?,"MATCH (p:Product)
WHERE p.reorderLevel = 30
RETURN p.productName, p.productID
ORDER BY p.unitsOnOrder DESC
LIMIT 3",Simple Retrieval Queries,northwind,True,False,False,
List the first 5 suppliers whose products have never been out of stock.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE NOT exists {
  MATCH (p)
  WHERE p.unitsInStock = 0
}
RETURN s
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 customers have ordered products with the highest average unit price?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WITH c, AVG(toFloat(o.unitPrice)) AS avgUnitPrice
ORDER BY avgUnitPrice DESC
LIMIT 3
RETURN c.companyName, avgUnitPrice",Simple Retrieval Queries,northwind,False,False,False,Order.unitPrice
Find the top 5 products with the most orders during the last quarter of 1997.,"MATCH (p:Product)-[o:ORDERS]->(ord:Order)
WHERE ord.orderDate >= '1997-10-01 00:00:00.000' AND ord.orderDate <= '1997-12-31 23:59:59.999'
WITH p, count(o) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 5
RETURN p.productName, ordersCount",Simple Retrieval Queries,northwind,False,False,True,
Find the top 5 orders with the most different products included.,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WITH o, count(DISTINCT p) AS numProducts
ORDER BY numProducts DESC
LIMIT 5
RETURN o.orderID, numProducts",Simple Retrieval Queries,northwind,False,False,True,
Which 3 suppliers have the most orders for their products?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)<-[:ORDERS]-(o:Order)
WITH s, count(o) AS totalOrders
ORDER BY totalOrders DESC
LIMIT 3
RETURN s.companyName, totalOrders",Simple Retrieval Queries,northwind,True,False,False,
List the first 5 orders that included a product from the 'Seafood' category.,"MATCH (c:Category {categoryName: 'Seafood'})<-[:PART_OF]-(p:Product)-[:ORDERS]->(o:Order)
RETURN o
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 categories have the shortest average shipping time for orders?,"MATCH (c:Category)<-[:PART_OF]-(p:Product)<-[:ORDERS]-(o:Order)
WHERE o.shippedDate IS NOT NULL AND o.orderDate IS NOT NULL
WITH c.categoryName AS Category, avg(duration.inDays(datetime(o.shippedDate), datetime(o.orderDate)).days) AS AvgShippingDays
RETURN Category, AvgShippingDays
ORDER BY AvgShippingDays ASC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,False,
Find the top 5 customers who have ordered the same product multiple times.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WITH c, p, COUNT(o) AS times_ordered
WHERE times_ordered > 1
RETURN c.companyName, p.productName, times_ordered
ORDER BY times_ordered DESC
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 products have never been ordered?,"MATCH (p:Product)
WHERE NOT exists{ (p)<-[:ORDERS]-(:Order) }
RETURN p.productName
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
List the first 5 suppliers with a 'homePage' listed.,"MATCH (s:Supplier)
WHERE s.homePage IS NOT NULL
RETURN s
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 categories have the most suppliers?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH c, count(DISTINCT s) AS supplierCount
ORDER BY supplierCount DESC
LIMIT 3
RETURN c.categoryName, supplierCount",Simple Retrieval Queries,northwind,False,False,True,
Find the top 5 products with the longest names.,"MATCH (p:Product)
RETURN p.productName, p.productID
ORDER BY length(p.productName) DESC
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 suppliers have the most products in the 'Grains/Cereals' category?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Grains/Cereals'})
WITH s, count(p) AS numProducts
ORDER BY numProducts DESC
LIMIT 3
RETURN s.companyName, numProducts",Simple Retrieval Queries,northwind,True,False,False,
Which 3 suppliers provide products to the most number of unique cities?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:ORDERS]->(o:Order)
WITH s, count(DISTINCT o.shipCity) AS uniqueCities
RETURN s.companyName, uniqueCities
ORDER BY uniqueCities DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
Which 3 products have the lowest 'unitPrice' in the 'Beverages' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
WITH p
ORDER BY p.unitPrice ASC
LIMIT 3
RETURN p.productName, p.unitPrice",Simple Retrieval Queries,northwind,False,False,False,
Find the top 5 customers with the most orders for the 'Dairy Products' category.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(cat:Category {categoryName: 'Dairy Products'})
WITH c, count(o) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 5
RETURN c.companyName, ordersCount",Simple Retrieval Queries,northwind,False,False,True,
Which 3 suppliers have the most products with a 'unitsOnOrder' above 10?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.unitsOnOrder > 10
RETURN s.companyName, count(p) AS NumberOfProducts
ORDER BY NumberOfProducts DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
List the first 5 categories where the average 'unitPrice' of products is above $30.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c, AVG(p.unitPrice) AS avgPrice
WHERE avgPrice > 30
RETURN c
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 orders had the highest discount applied?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
RETURN o.orderID, r.discount
ORDER BY r.discount DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
Find the top 5 products that have been supplied by more than one supplier.,"MATCH (p:Product)<-[:SUPPLIES]-(:Supplier)
WITH p, count(DISTINCT (:Supplier)) AS supplierCount
WHERE supplierCount > 1
RETURN p.productName, supplierCount
ORDER BY supplierCount DESC
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 customers have a 'fax' number listed?,"MATCH (c:Customer)
WHERE c.fax IS NOT NULL
RETURN c
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
List the first 5 products that have a 'unitsInStock' of exactly 50.,"MATCH (p:Product)
WHERE p.unitsInStock = 50
RETURN p
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 categories have the fewest products with units on order?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitsOnOrder IS NOT NULL
WITH c, count(p) AS productCount
ORDER BY productCount ASC
LIMIT 3
RETURN c.categoryName, productCount",Simple Retrieval Queries,northwind,False,False,True,
List the first 5 orders that included products from at least three different categories.,"MATCH (o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(c:Category)
WITH o, count(DISTINCT c) AS numCategories
WHERE numCategories >= 3
RETURN o
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Find the top 5 orders that were required in the year 1997.,"MATCH (o:Order)
WHERE o.requiredDate STARTS WITH '1997'
RETURN o
ORDER BY o.requiredDate
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 customers have ordered products from the most categories?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(cat:Category)
WITH c, COUNT(DISTINCT cat) AS numCategories
ORDER BY numCategories DESC
LIMIT 3
RETURN c.companyName, numCategories",Simple Retrieval Queries,northwind,False,False,True,
List the first 5 products that are part of the 'Meat/Poultry' category and have been discontinued.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Meat/Poultry'})
WHERE p.discontinued = true
RETURN p
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 suppliers supply the most products with a unit price over $20?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.unitPrice > 20
WITH s, count(p) AS products_count
ORDER BY products_count DESC
LIMIT 3
RETURN s.companyName, products_count",Simple Retrieval Queries,northwind,False,False,True,
Find the top 5 products that are part of the 'Confections' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Confections'})
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 orders had a required date in 1996?,"MATCH (o:Order)
WHERE o.requiredDate STARTS WITH '1996'
RETURN o
ORDER BY o.requiredDate
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
List the first 5 customers who have ordered more than once.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WITH c, count(o) AS ordersCount
WHERE ordersCount > 1
RETURN c
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 suppliers are located in the UK?,"MATCH (s:Supplier {country: 'UK'})
RETURN s.companyName
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
Find the top 5 products with the least quantity per unit in stock.,"MATCH (p:Product)
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock ASC
LIMIT 5",Simple Retrieval Queries,northwind,False,False,False,
Which 3 categories contain products with a unit price over $50?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitPrice > 50
RETURN DISTINCT c.categoryName
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
List the first 5 orders with the highest freight charges.,"MATCH (o:Order)
RETURN o
ORDER BY o.freight DESC
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 products have the lowest units on order and are not discontinued?,"MATCH (p:Product)
WHERE p.discontinued = false AND p.unitsOnOrder IS NOT NULL
RETURN p
ORDER BY p.unitsOnOrder ASC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
List the first 5 products with reorder levels set at 30.,"MATCH (p:Product)
WHERE p.reorderLevel = 30
RETURN p
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Find the top 5 suppliers with the most products in the 'Dairy Products' category.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
WITH s, count(p) AS numProducts
ORDER BY numProducts DESC
LIMIT 5
RETURN s.companyName, numProducts",Simple Retrieval Queries,northwind,False,False,True,
List the first 5 categories that have products supplied by 'Exotic Liquids'.,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
RETURN DISTINCT c
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 products have been ordered the most times?,"MATCH (p:Product)-[:ORDERS]->(o:Order)
RETURN p.productName, count(o) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
What are the top 5 most expensive products supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
List the first 3 orders shipped to France.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipCountry = 'France'
RETURN o.orderID, o.shippedDate, o.shipName
ORDER BY o.shippedDate
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
Which 3 products have the highest units in stock?,"MATCH (p:Product)
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
Find the top 5 customers based in Germany.,"MATCH (c:Customer {country: ""Germany""})
RETURN c.companyName, c.contactName
ORDER BY c.customerID
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 suppliers provide products in the 'Beverages' category?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
RETURN DISTINCT s.companyName
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
List the top 5 products that have been discontinued.,"MATCH (p:Product {discontinued: true})
RETURN p.productName, p.productID
ORDER BY p.productID
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
What are the first 3 products with a reorder level above 20?,"MATCH (p:Product)
WHERE p.reorderLevel > 20
RETURN p
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
Which 3 customers have purchased the most orders?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
RETURN c.companyName, count(o) AS NumberOfOrders
ORDER BY NumberOfOrders DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
Which 3 suppliers have the largest coverage in terms of countries?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, count(DISTINCT p.country) AS countries_covered
ORDER BY countries_covered DESC
LIMIT 3
RETURN s.companyName, countries_covered",Simple Retrieval Queries,northwind,False,False,True,Product.country
Which 3 customers have the most unique products ordered?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WITH c, count(DISTINCT p) AS uniqueProducts
ORDER BY uniqueProducts DESC
LIMIT 3
RETURN c.companyName, uniqueProducts",Simple Retrieval Queries,northwind,True,False,False,
Which 3 products have the most quantity per unit?,"MATCH (p:Product)
RETURN p.productName, p.quantityPerUnit
ORDER BY p.quantityPerUnit DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,False,
Which 3 orders include the most number of products?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WITH o, count(p) AS numProducts
ORDER BY numProducts DESC
LIMIT 3
RETURN o AS Order, numProducts AS NumberOfProducts",Simple Retrieval Queries,northwind,False,False,True,
Find the top 5 customers from the 'USA'.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE c.country = 'USA'
RETURN c.companyName, count(o) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 categories have the most products with units in stock over 50?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitsInStock > 50
RETURN c.categoryName, count(p) AS ProductCount
ORDER BY ProductCount DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
List the first 5 products that have a unit price less than the average unit price of all products.,"MATCH (p:Product)
WITH avg(p.unitPrice) AS avgPrice
MATCH (p2:Product)
WHERE p2.unitPrice < avgPrice
RETURN p2
ORDER BY p2.unitPrice
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 suppliers supply products with a unit price less than $10?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.unitPrice < 10
RETURN s.companyName, s.contactName, s.phone
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
Find the top 5 orders with the longest shipping time from order date to shipped date.,"MATCH (o:Order)
WHERE o.orderDate IS NOT NULL AND o.shippedDate IS NOT NULL
RETURN o.orderID, o.shippedDate, o.orderDate, duration.between(datetime(o.orderDate), datetime(o.shippedDate)) AS shippingDuration
ORDER BY shippingDuration DESC
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 products have the most discounts applied in orders?,"MATCH (p:Product)-[o:ORDERS]->(:Order)
WITH p, SUM(toFloat(o.discount)) AS totalDiscount
ORDER BY totalDiscount DESC
LIMIT 3
RETURN p.productName, totalDiscount",Simple Retrieval Queries,northwind,False,False,True,
List the first 5 suppliers that have provided products to more than three different customers.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)<-[:ORDERS]-(o:Order)<-[:PURCHASED]-(c:Customer)
WITH s, count(DISTINCT c) AS distinctCustomers
WHERE distinctCustomers > 3
RETURN s
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 categories are most frequently associated with discontinued products?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.discontinued = true
RETURN c.categoryName, count(p) AS DiscontinuedProducts
ORDER BY DiscontinuedProducts DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
Find the top 5 orders with the most units ordered.,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
RETURN o.orderID, SUM(r.quantity) AS TotalUnitsOrdered
ORDER BY TotalUnitsOrdered DESC
LIMIT 5",Simple Retrieval Queries,northwind,True,False,False,
Find the top 5 customers who have ordered the product 'Chai'.,"MATCH (p:Product {productName: 'Chai'})<-[:ORDERS]-(o:Order)<-[:PURCHASED]-(c:Customer)
RETURN c.companyName, count(o) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
List the first 5 suppliers based in 'London'.,"MATCH (s:Supplier {city: 'London'})
RETURN s
LIMIT 5",Simple Retrieval Queries,northwind,False,False,False,
Which 3 categories have the least number of products supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH c, count(p) AS productCount
ORDER BY productCount ASC
LIMIT 3
RETURN c.categoryName, productCount",Simple Retrieval Queries,northwind,False,False,True,
Find the top 5 products ordered during the month of July 1996.,"MATCH (p:Product)<-[:ORDERS]-(o:Order)
WHERE o.orderDate >= '1996-07-01 00:00:00.000' AND o.orderDate <= '1996-07-31 23:59:59.999'
WITH p, count(o) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 5
RETURN p.productName, ordersCount",Simple Retrieval Queries,northwind,False,False,True,
Which 3 customers have a contact title of 'Sales Representative'?,"MATCH (c:Customer {contactTitle: 'Sales Representative'})
RETURN c.companyName, c.contactName
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
List the first 5 orders shipped by 'shipVia' 1.,"MATCH (o:Order)
WHERE o.shipVia = '1'
RETURN o
ORDER BY o.shippedDate
LIMIT 5",Simple Retrieval Queries,northwind,False,False,False,
Which 3 products have the shortest lead time between order date and shipped date?,"MATCH (p:Product)<-[:ORDERS]-(o:Order)
WHERE o.orderDate IS NOT NULL AND o.shippedDate IS NOT NULL
WITH p, o, duration.between(datetime(o.orderDate), datetime(o.shippedDate)) AS leadTime
RETURN p.productName, leadTime
ORDER BY leadTime ASC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
Find the top 5 customers who have ordered products where the discount was not applied.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
WHERE r.discount = '0'
RETURN c.companyName, COUNT(o) AS OrdersCount
ORDER BY OrdersCount DESC
LIMIT 5",Simple Retrieval Queries,northwind,False,False,False,
Which 3 suppliers do not have a fax number?,"MATCH (s:Supplier)
WHERE s.fax IS NULL
RETURN s
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
List the first 5 categories with products that have a reorder level below 10.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.reorderLevel < 10
RETURN c
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which 3 products have the highest units on order?,"MATCH (p:Product)
WHERE p.unitsOnOrder IS NOT NULL
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
What are the names of the products supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)
RETURN p.productName AS ProductName",Simple Aggregation Queries,northwind,False,False,True,
List the first 5 products that were part of an order with a 'freight' cost over $250.,"MATCH (p:Product)-[:ORDERS]->(o:Order)
WHERE o.freight > 250
RETURN p.productName, p.productID
LIMIT 5",Simple Retrieval Queries,northwind,False,False,True,
Which products are part of the 'Beverages' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
RETURN p.productName AS ProductName",Complex Retrieval Queries,northwind,False,False,False,
Identify the orders that include products from the 'Seafood' category and were shipped to France.,"MATCH (c:Category {categoryName: 'Seafood'})<-[:PART_OF]-(p:Product)-[:ORDERS]->(o:Order)-[:PURCHASED]->(cust:Customer)
WHERE o.shipCountry = 'France'
RETURN o.orderID, o.shippedDate, cust.companyName",Complex Retrieval Queries,northwind,False,False,True,
List the first 3 orders that were placed in 1997 and required a freight charge over $25.,"MATCH (o:Order)
WHERE o.orderDate STARTS WITH '1997' AND toFloat(o.freight) > 25
RETURN o
ORDER BY o.orderDate
LIMIT 3",Complex Retrieval Queries,northwind,False,False,True,
Who are the customers with orders that have a shipVia of '3'?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE o.shipVia = '3'
RETURN c.companyName AS CustomerName",Complex Retrieval Queries,northwind,False,False,True,
Find the first 5 products from the 'Condiments' category that have been ordered in 1998.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Condiments'})
WHERE EXISTS {
  (p)<-[:ORDERS]-(o:Order)
  WHERE o.orderDate >= '1998-01-01' AND o.orderDate < '1999-01-01'
}
RETURN p
LIMIT 5",Complex Retrieval Queries,northwind,False,False,True,
Which suppliers have products with a minimum unitsInStock of 50?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.unitsInStock >= 50
RETURN DISTINCT s",Complex Retrieval Queries,northwind,False,False,True,
List the suppliers who are based in non-UK European countries.,"MATCH (s:Supplier)
WHERE s.country <> ""UK"" AND s.country IN [""Germany"", ""France"", ""Italy"", ""Spain"", ""Netherlands"", ""Belgium"", ""Sweden"", ""Norway"", ""Denmark"", ""Finland"", ""Poland"", ""Ireland"", ""Czech Republic"", ""Greece"", ""Portugal"", ""Hungary"", ""Austria"", ""Switzerland"", ""Bulgaria"", ""Slovakia"", ""Belarus"", ""Romania"", ""Croatia"", ""Lithuania"", ""Latvia"", ""Estonia"", ""Slovenia"", ""Luxembourg"", ""Malta"", ""Cyprus""]
RETURN s",Complex Retrieval Queries,northwind,False,False,True,
Identify the products that are part of orders that were required to be shipped before '1997-01-01'.,"MATCH (p:Product)-[:ORDERS]->(o:Order)
WHERE o.requiredDate < '1997-01-01'
RETURN p.productName, p.productID",Complex Retrieval Queries,northwind,False,False,True,
Find the first 3 products with a quantity per unit specification involving 'bottles'.,"MATCH (p:Product)
WHERE p.quantityPerUnit CONTAINS 'bottles'
RETURN p
LIMIT 3",Complex Retrieval Queries,northwind,False,False,True,
Which customers have ordered the product 'Spegesild'?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product {productName: 'Spegesild'})
RETURN DISTINCT c.companyName AS CustomerName",Complex Retrieval Queries,northwind,False,False,True,
List the top 5 discontinued products with the highest unit prices.,"MATCH (p:Product)
WHERE p.discontinued = true
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 5",Complex Retrieval Queries,northwind,False,False,True,
What are the order IDs for orders containing products from more than three different categories?,"MATCH (o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(c:Category)
WITH o, count(DISTINCT c) AS numCategories
WHERE numCategories > 3
RETURN o.orderID AS OrderID",Complex Retrieval Queries,northwind,False,False,True,
Identify the categories associated with products supplied by 'Mayumi's'.,"MATCH (s:Supplier {companyName: ""Mayumi's""})-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
RETURN DISTINCT c.categoryName",Complex Retrieval Queries,northwind,False,False,True,
List the first 3 products that are part of the 'Dairy Products' category and have more than 20 units on order.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
WHERE p.unitsOnOrder > 20
RETURN p
LIMIT 3",Complex Retrieval Queries,northwind,False,False,False,
Who are the suppliers for the 'Grains/Cereals' category?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Grains/Cereals'})
RETURN s.companyName AS SupplierName",Complex Retrieval Queries,northwind,False,False,True,
Which products have both more than 70 units on order and a reorder level above 15?,"MATCH (p:Product)
WHERE p.unitsOnOrder > 70 AND p.reorderLevel > 15
RETURN p",Complex Retrieval Queries,northwind,False,False,True,
List all orders with a shipVia of '2' and shipped to the 'USA'.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipVia = '2' AND o.shipCountry = 'USA'
RETURN o, p",Complex Retrieval Queries,northwind,False,False,False,
Which products are associated with categories that have a description including 'sauces'?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE c.description CONTAINS 'sauces'
RETURN p.productName AS ProductName, p.productID AS ProductID",Complex Retrieval Queries,northwind,False,False,True,
Find the first 3 orders that were shipped within Germany.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipCountry = 'Germany'
RETURN o, p
LIMIT 3",Complex Retrieval Queries,northwind,False,False,False,
Identify suppliers that have a contact title of 'Purchasing Manager'.,"MATCH (s:Supplier {contactTitle: 'Purchasing Manager'})
RETURN s",Complex Retrieval Queries,northwind,False,False,False,
Which products have been ordered with a quantity of 100 or more in a single order?,"MATCH (p:Product)-[o:ORDERS]->(:Order)
WHERE o.quantity >= 100
RETURN p.productName, o.quantity",Complex Retrieval Queries,northwind,False,False,False,
List the products that are in the 'Produce' category and have a discontinued status.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Produce'})
WHERE p.discontinued = TRUE
RETURN p.productName, p.productID",Complex Retrieval Queries,northwind,False,False,True,
Identify the suppliers whose products are all in the 'Beverages' category.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE NOT exists {
    MATCH (p)-[:PART_OF]->(c:Category)
    WHERE c.categoryName <> 'Beverages'
}
RETURN DISTINCT s",Complex Retrieval Queries,northwind,False,False,True,
What are the product IDs of products that have been marked as discontinued but have a reorder level of 10?,"MATCH (p:Product)
WHERE p.discontinued = true AND p.reorderLevel = 10
RETURN p.productID",Complex Retrieval Queries,northwind,False,False,True,
Which products have a unitsInStock value between 10 and 20?,"MATCH (p:Product)
WHERE p.unitsInStock >= 10 AND p.unitsInStock <= 20
RETURN p.productName, p.unitsInStock",Simple Aggregation Queries,northwind,False,False,False,
List the first 3 products that have been supplied by 'Plutzer'.,"MATCH (s:Supplier {companyName: ""Plutzer""})-[:SUPPLIES]->(p:Product)
RETURN p
LIMIT 3",Complex Retrieval Queries,northwind,False,False,True,
What are the supplierIDs for suppliers who have provided products to more than three different cities?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:ORDERS]->(o:Order)
WITH s.supplierID AS supplierID, COUNT(DISTINCT o.shipCity) AS cityCount
WHERE cityCount > 3
RETURN supplierID",Complex Retrieval Queries,northwind,False,False,True,
Identify the orders placed for products from the 'Meat/Poultry' category with a shipVia of '2'.,"MATCH (c:Category {categoryName: 'Meat/Poultry'})<-[:PART_OF]-(p:Product)-[:ORDERS]->(o:Order {shipVia: '2'})
RETURN o",Complex Retrieval Queries,northwind,False,False,True,
List the products that have a unitsInStock of zero and are not discontinued.,"MATCH (p:Product)
WHERE p.unitsInStock = 0 AND p.discontinued = false
RETURN p",Complex Retrieval Queries,northwind,False,False,True,
Who are the suppliers for products in the 'Confections' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Confections'})
MATCH (s:Supplier)-[:SUPPLIES]->(p)
RETURN s.companyName AS SupplierName",Complex Retrieval Queries,northwind,False,False,True,
Find the first 3 orders with a shipVia of '1' and a ship country of 'USA'.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipVia = '1' AND o.shipCountry = 'USA'
RETURN o, p
LIMIT 3",Complex Retrieval Queries,northwind,False,False,True,
Which products have been reordered (reorder level not 0) and are supplied by suppliers in 'Germany'?,"MATCH (p:Product)-[:SUPPLIES]->(s:Supplier)
WHERE p.reorderLevel > 0 AND s.country = 'Germany'
RETURN p.productName, p.productID, s.companyName, s.country",Complex Retrieval Queries,northwind,False,False,True,
List the top 5 orders in terms of quantity for the 'Dairy Products' category.,"MATCH (c:Category {categoryName: 'Dairy Products'})<-[:PART_OF]-(p:Product)
MATCH (o:Order)-[r:ORDERS]->(p)
RETURN o.orderID AS OrderID, sum(r.quantity) AS TotalQuantity
ORDER BY TotalQuantity DESC
LIMIT 5",Complex Retrieval Queries,northwind,False,False,False,
Which categories have products with a unit price less than $10?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitPrice < 10
RETURN DISTINCT c.categoryName",Complex Retrieval Queries,northwind,False,False,True,
Identify the customers who have ordered products with a total discount of 0.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
WHERE r.discount = '0'
RETURN DISTINCT c AS CustomersWithNoDiscountOrders",Complex Retrieval Queries,northwind,False,False,True,
List the first 3 categories that have products with unitsOnOrder above 30.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitsOnOrder > 30
RETURN DISTINCT c
LIMIT 3",Complex Retrieval Queries,northwind,False,False,True,
Identify the products supplied by suppliers with a phone number starting with '(171)'.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.phone STARTS WITH '(171)'
RETURN p.productName, p.productID",Complex Retrieval Queries,northwind,False,False,True,
Which orders have a required date in 1998 and a freight cost less than $5?,"MATCH (o:Order)
WHERE o.requiredDate >= '1998-01-01 00:00:00.000' AND o.requiredDate < '1999-01-01 00:00:00.000'
  AND toFloat(o.freight) < 5
RETURN o",Complex Retrieval Queries,northwind,False,False,False,
List the suppliers that have a fax number listed.,"MATCH (s:Supplier)
WHERE s.fax IS NOT NULL
RETURN s",Complex Retrieval Queries,northwind,False,False,True,
What are the ship cities for orders that included the product 'Chai'?,"MATCH (p:Product {productName: 'Chai'})-[:ORDERS]->(o:Order)
RETURN DISTINCT o.shipCity AS ShipCities",Complex Retrieval Queries,northwind,False,False,True,
Identify the products with a reorder level less than 5 and a unit price less than $15.,"MATCH (p:Product)
WHERE p.reorderLevel < 5 AND p.unitPrice < 15
RETURN p",Complex Retrieval Queries,northwind,False,False,False,
List the orders placed by customers in 'Berlin' that have a shipped date in 1997.,"MATCH (c:Customer {city: 'Berlin'})-[:PURCHASED]->(o:Order)
WHERE o.shippedDate STARTS WITH '1997'
RETURN o",Complex Retrieval Queries,northwind,False,False,True,
Which categories have at least one product with a unit price over $100?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitPrice > 100
RETURN DISTINCT c.categoryName",Complex Retrieval Queries,northwind,False,False,True,
Find the first 3 orders that were shipped to 'Portland'.,"MATCH (o:Order)
WHERE o.shipCity = 'Portland'
RETURN o
LIMIT 3",Complex Retrieval Queries,northwind,False,False,True,
What are the details of products that are part of the 'Grains/Cereals' category and have been ordered more than 50 times?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Grains/Cereals'})
WHERE count{(p)<-[:ORDERS]-(:Order)} > 50
RETURN p.productName, p.quantityPerUnit, p.unitsOnOrder, p.supplierID, p.productID, p.discontinued, p.categoryID, p.reorderLevel, p.unitsInStock, p.unitPrice",Complex Retrieval Queries,northwind,False,False,False,
List the first 5 customers who have placed orders with a total quantity greater than 200.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
WITH c, sum(r.quantity) AS totalQuantity
WHERE totalQuantity > 200
RETURN c
LIMIT 5",Complex Retrieval Queries,northwind,False,False,False,
Identify the products that have a reorder level of 25 and are not discontinued.,"MATCH (p:Product)
WHERE p.reorderLevel = 25 AND p.discontinued = false
RETURN p",Complex Retrieval Queries,northwind,False,False,True,
What are the ship countries for orders containing the product 'Aniseed Syrup'?,"MATCH (p:Product {productName: 'Aniseed Syrup'})-[:ORDERS]->(o:Order)
RETURN DISTINCT o.shipCountry AS ShipCountries",Complex Retrieval Queries,northwind,False,False,False,
What are the names of the products that are out of stock?,"MATCH (p:Product)
WHERE p.unitsInStock = 0
RETURN p.productName",Complex Retrieval Queries,northwind,False,False,True,
List orders that have a discount of 0.,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WHERE r.discount = '0'
RETURN o AS Order, r AS OrderDetails, p AS Product",Complex Retrieval Queries,northwind,False,False,False,
Which suppliers supply products to more than one category?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH s, count(DISTINCT c) AS numCategories
WHERE numCategories > 1
RETURN s",Complex Retrieval Queries,northwind,False,False,True,
Identify the products that have been ordered more than 100 times.,"MATCH (p:Product)-[o:ORDERS]->(:Order)
WITH p, count(o) AS ordersCount
WHERE ordersCount > 100
RETURN p.productName, ordersCount",Complex Retrieval Queries,northwind,False,False,True,
Which orders contain the product 'Chai'?,"MATCH (p:Product {productName: 'Chai'})-[:ORDERS]->(o:Order)
RETURN o",Complex Retrieval Queries,northwind,False,False,True,
What are the products in the order with ID '10248'?,"MATCH (o:Order {orderID: '10248'})-[:ORDERS]->(p:Product)
RETURN p",Complex Retrieval Queries,northwind,False,False,True,
Who are the employees that processed orders for 'Rattlesnake Canyon Grocery'?,"MATCH (c:Customer {companyName: 'Rattlesnake Canyon Grocery'})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
MATCH (e:Employee)-[:PROCESSED]->(o)
RETURN DISTINCT e",Complex Retrieval Queries,northwind,False,False,True,Employee
Who are the employees that processed orders for 'Rattlesnake Canyon Grocery'?,"MATCH (c:Customer {companyName: 'Rattlesnake Canyon Grocery'})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
MATCH (e:Employee)-[:PROCESSED]->(o)
RETURN DISTINCT e",Complex Retrieval Queries,northwind,False,False,True,PROCESSED
Find the first 3 orders that required shipping after '1997-01-01'.,"MATCH (o:Order)
WHERE o.requiredDate > '1997-01-01'
RETURN o
ORDER BY o.requiredDate
LIMIT 3",Complex Retrieval Queries,northwind,False,False,True,
Identify suppliers who do not have a home page listed.,"MATCH (s:Supplier)
WHERE s.homePage IS NULL
RETURN s",Complex Retrieval Queries,northwind,False,False,True,
Identify the top 3 suppliers by number of products supplied.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, count(p) AS productsSupplied
ORDER BY productsSupplied DESC
LIMIT 3
RETURN s.companyName, productsSupplied",Complex Retrieval Queries,northwind,False,False,True,
List the products with a unit price greater than $50.,"MATCH (p:Product)
WHERE p.unitPrice > 50
RETURN p.productName, p.unitPrice",Complex Retrieval Queries,northwind,False,False,True,
What are the top 3 most expensive products in the 'Dairy Products' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 3",Complex Retrieval Queries,northwind,False,False,True,
Which products are supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)
RETURN p.productName AS ProductName, p.productID AS ProductID",Complex Retrieval Queries,northwind,False,False,True,
List all orders shipped via ship method '1'.,"MATCH (o:Order {shipVia: '1'})
RETURN o",Complex Retrieval Queries,northwind,False,False,True,
Who are the customers that purchased orders shipped to France?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE o.shipCountry = 'France'
RETURN c.companyName AS CustomerName",Complex Retrieval Queries,northwind,False,False,True,
Identify products with units on order greater than 50.,"MATCH (p:Product)
WHERE p.unitsOnOrder > 50
RETURN p",Complex Retrieval Queries,northwind,False,False,True,
What are the discontinued products?,"MATCH (p:Product)
WHERE p.discontinued = true
RETURN p.productName, p.productID",Complex Retrieval Queries,northwind,False,False,True,
Find the first 3 customers located in Berlin.,"MATCH (c:Customer {city: ""Berlin""})
RETURN c
LIMIT 3",Complex Retrieval Queries,northwind,False,False,True,
Which products have a reorder level greater than 20?,"MATCH (p:Product)
WHERE p.reorderLevel > 20
RETURN p.productName, p.productID, p.reorderLevel",Complex Retrieval Queries,northwind,False,False,True,
List the top 5 suppliers based in the UK.,"MATCH (s:Supplier {country: 'UK'})
RETURN s.companyName, s.contactName
ORDER BY s.companyName
LIMIT 5",Complex Retrieval Queries,northwind,False,False,True,
Which categories contain more than 5 products?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c, count(p) AS productCount
WHERE productCount > 5
RETURN c.categoryName, productCount",Complex Retrieval Queries,northwind,False,False,True,
Which 3 categories have the most products with a reorder level of 0?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.reorderLevel = 0
RETURN c.categoryName, count(p) AS ProductCount
ORDER BY ProductCount DESC
LIMIT 3",Simple Retrieval Queries,northwind,False,False,True,
Which customers have a contact title of 'Sales Representative'?,"MATCH (c:Customer {contactTitle: 'Sales Representative'})
RETURN c",Complex Retrieval Queries,northwind,False,False,True,
What are the product names and prices for products that have been discontinued but are still in stock?,"MATCH (p:Product)
WHERE p.discontinued = true AND p.unitsInStock > 0
RETURN p.productName AS ProductName, p.unitPrice AS Price",Complex Retrieval Queries,northwind,False,False,False,
Who are the suppliers for the product with ID '3'?,"MATCH (p:Product {productID: '3'})-[:SUPPLIES]-(s:Supplier)
RETURN s",Complex Retrieval Queries,northwind,False,False,True,
Find the top 3 most ordered products in terms of quantity from orders.,"MATCH (p:Product)<-[:ORDERS]-(o:Order)
RETURN p.productName, sum(toInteger(o.quantity)) AS TotalQuantity
ORDER BY TotalQuantity DESC
LIMIT 3",Complex Retrieval Queries,northwind,False,False,True,Order.quantity
Which suppliers provide products to both 'Beverages' and 'Seafood' categories?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WHERE c.categoryName IN ['Beverages', 'Seafood']
WITH s, collect(DISTINCT c.categoryName) AS categories
WHERE ALL(cat IN ['Beverages', 'Seafood'] WHERE cat IN categories)
RETURN s",Complex Retrieval Queries,northwind,False,False,True,
List all the products ordered in the 'Confections' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Confections'})
WHERE EXISTS {
  (p)<-[:ORDERS]-(:Order)
}
RETURN p.productName AS ProductName, p.productID AS ProductID",Complex Retrieval Queries,northwind,False,False,True,
Which products have a unitsInStock value between 50 and 100?,"MATCH (p:Product)
WHERE p.unitsInStock >= 50 AND p.unitsInStock <= 100
RETURN p",Complex Retrieval Queries,northwind,False,False,True,
Find the first 5 orders made in 1996.,"MATCH (o:Order)
WHERE o.orderDate STARTS WITH '1996'
RETURN o
ORDER BY o.orderDate
LIMIT 5",Complex Retrieval Queries,northwind,False,False,True,
Identify the products supplied by suppliers with no listed phone number.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.phone IS NULL
RETURN p.productName, p.productID",Complex Retrieval Queries,northwind,False,False,True,
Which orders were placed by customers in the 'NULL' region?,"MATCH (c:Customer {region: 'NULL'})-[:PURCHASED]->(o:Order)
RETURN o",Complex Retrieval Queries,northwind,False,False,True,
List the categories of products that have never been reordered (reorder level is 0).,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.reorderLevel = 0
RETURN DISTINCT c.categoryName",Complex Retrieval Queries,northwind,False,False,True,
List the first 3 products with '0' units on order and a reorder level of 10.,"MATCH (p:Product)
WHERE p.unitsOnOrder = 0 AND p.reorderLevel = 10
RETURN p
LIMIT 3",Complex Retrieval Queries,northwind,False,False,True,
Which suppliers have supplied products that are currently discontinued?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.discontinued = true
RETURN s",Complex Retrieval Queries,northwind,False,False,True,
What are the details of orders that have a freight cost more than $50?,"MATCH (o:Order)
WHERE o.freight > '50'
RETURN o",Complex Retrieval Queries,northwind,False,False,True,
List the first 3 customers from 'Germany' who ordered 'Beverages'.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(cat:Category)
WHERE c.country = 'Germany' AND cat.categoryName = 'Beverages'
RETURN c.companyName, c.contactName, c.city
LIMIT 3",Complex Retrieval Queries,northwind,False,False,False,
Which customers ordered more than 10 different products?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WITH c, count(DISTINCT p) AS numProducts
WHERE numProducts > 10
RETURN c",Complex Retrieval Queries,northwind,False,False,True,
What are the category descriptions for categories supplying 'Spegesild'?,"MATCH (p:Product {productName: 'Spegesild'})-[:PART_OF]->(c:Category)
RETURN c.description",Complex Retrieval Queries,northwind,False,False,True,
List the products with quantities per unit described as 'boxes'.,"MATCH (p:Product)
WHERE p.quantityPerUnit CONTAINS 'boxes'
RETURN p",Complex Retrieval Queries,northwind,False,False,True,
Which suppliers are located in 'London'?,"MATCH (s:Supplier {city: 'London'})
RETURN s",Complex Retrieval Queries,northwind,False,False,True,
Identify products that are part of the 'Meat/Poultry' category and have more than 30 units in stock.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Meat/Poultry'})
WHERE p.unitsInStock > 30
RETURN p.productName, p.unitsInStock",Complex Retrieval Queries,northwind,False,False,True,
List the orders that were shipped by 'Vins et alcools Chevalier'.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipName = 'Vins et alcools Chevalier'
RETURN o.orderID, o.shippedDate, p.productName, p.unitPrice",Complex Retrieval Queries,northwind,False,False,True,
Which orders were shipped to the regions not specified (NULL region)?,"MATCH (o:Order)
WHERE o.shipRegion IS NULL
RETURN o",Complex Retrieval Queries,northwind,False,False,True,
Identify the top 5 most frequently ordered products.,"MATCH (p:Product)<-[:ORDERS]-(:Order)
RETURN p.productName, count(*) AS orderCount
ORDER BY orderCount DESC
LIMIT 5",Complex Retrieval Queries,northwind,False,False,True,
List the top 5 orders with the highest freight cost.,"MATCH (o:Order)
RETURN o
ORDER BY o.freight DESC
LIMIT 5",Complex Aggregation Queries,northwind,False,False,True,
What are the top 3 most frequently shipped products to 'France'?,"MATCH (p:Product)<-[:ORDERS]-(o:Order)
WHERE o.shipCountry = 'France'
RETURN p.productName, count(o) AS shipments
ORDER BY shipments DESC
LIMIT 3",Pathfinding Queries,northwind,False,False,True,
List all products that have been ordered by customers from the USA.,"MATCH (c:Customer {country: 'USA'})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
RETURN DISTINCT p.productName AS ProductName",Complex Aggregation Queries,northwind,False,False,True,
List the top 3 customers based on the number of orders placed.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
RETURN c.companyName, count(o) AS NumberOfOrders
ORDER BY NumberOfOrders DESC
LIMIT 3",Verbose query,northwind,False,False,True,
Which 5 orders have the most distinct products included?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WITH o, count(DISTINCT p) AS distinctProducts
ORDER BY distinctProducts DESC
LIMIT 5
RETURN o.orderID, distinctProducts",Verbose query,northwind,False,False,True,
Identify the 3 categories with the least number of products.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c, count(p) AS productCount
ORDER BY productCount ASC
LIMIT 3
RETURN c.categoryName, productCount",Verbose query,northwind,False,False,True,
What are the top 5 products with the lowest units on order and not discontinued?,"MATCH (p:Product)
WHERE p.unitsOnOrder IS NOT NULL AND p.discontinued = false
RETURN p
ORDER BY p.unitsOnOrder ASC
LIMIT 5",Verbose query,northwind,False,False,True,
List the 3 products with the highest units in stock supplied by 'Exotic Liquids'.,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 3",Verbose query,northwind,False,False,True,
Which 5 customers have orders with the required date in the year 1997?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE o.requiredDate STARTS WITH '1997'
RETURN c.companyName, c.contactName
LIMIT 5",Verbose query,northwind,False,False,True,
Identify the 3 most common product names supplied by 'Exotic Liquids'.,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)
RETURN p.productName, count(p) AS supplyCount
ORDER BY supplyCount DESC
LIMIT 3",Verbose query,northwind,False,False,True,
What are the first 5 orders placed in the year 1996?,"MATCH (o:Order)
WHERE o.orderDate STARTS WITH '1996'
RETURN o
ORDER BY o.orderDate
LIMIT 5",Verbose query,northwind,False,False,True,
List the top 3 products with the highest quantity per unit in the 'Dairy Products' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
RETURN p.productName, p.quantityPerUnit
ORDER BY p.quantityPerUnit DESC
LIMIT 3",Verbose query,northwind,False,False,False,
Which 5 products have the most suppliers?,"MATCH (p:Product)<-[:SUPPLIES]-(s:Supplier)
WITH p, count(s) AS supplierCount
ORDER BY supplierCount DESC
LIMIT 5
RETURN p.productName, supplierCount",Verbose query,northwind,False,False,True,
Identify the 3 suppliers from the city 'London' who supply the most products.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.city = 'London'
RETURN s.companyName, count(p) AS NumberOfProductsSupplied
ORDER BY NumberOfProductsSupplied DESC
LIMIT 3",Verbose query,northwind,False,False,True,
What are the top 5 most common contact titles among suppliers?,"MATCH (s:Supplier)
RETURN s.contactTitle AS ContactTitle, count(s) AS Count
ORDER BY Count DESC
LIMIT 5",Verbose query,northwind,True,False,False,
List the 3 customers who have ordered products with the highest average unit price.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WITH c, AVG(toFloat(p.unitPrice)) AS avgUnitPrice
ORDER BY avgUnitPrice DESC
LIMIT 3
RETURN c.companyName, avgUnitPrice",Verbose query,northwind,False,False,True,
Which 5 categories contain products that are all actively being supplied (none discontinued)?,"MATCH (c:Category)<-[:PART_OF]-(p:Product)
WHERE NOT exists {
  MATCH (p)
  WHERE p.discontinued = true
}
RETURN c.categoryName, count(p) as ProductCount
ORDER BY ProductCount DESC
LIMIT 5",Verbose query,northwind,False,False,False,
Identify the top 5 products with the lowest reorder level.,"MATCH (p:Product)
WHERE p.reorderLevel IS NOT NULL
RETURN p
ORDER BY p.reorderLevel ASC
LIMIT 5",Verbose query,northwind,False,False,True,
What are the first 5 products with a unit price greater than 50 supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)
WHERE p.unitPrice > 50
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice
LIMIT 5",Verbose query,northwind,False,False,True,
Identify the 3 most frequent ship countries for orders from 'Alfreds Futterkiste'.,"MATCH (c:Customer {companyName: ""Alfreds Futterkiste""})-[:PURCHASED]->(o:Order)
RETURN o.shipCountry AS ShipCountry, count(o) AS NumberOfOrders
ORDER BY NumberOfOrders DESC
LIMIT 3",Verbose query,northwind,False,False,True,
Which 5 customers have the most discontinued products ordered?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE p.discontinued = true
WITH c, count(p) AS discontinuedProductsCount
ORDER BY discontinuedProductsCount DESC
LIMIT 5
RETURN c.companyName, discontinuedProductsCount",Verbose query,northwind,False,False,True,
List the top 3 products with the highest discount given in any order.,"MATCH (p:Product)<-[:ORDERS {discount: maxDiscount}]-(o:Order)
WITH p, MAX(toFloat(o.discount)) AS maxDiscount
ORDER BY maxDiscount DESC
RETURN p.productName, maxDiscount
LIMIT 3",Verbose query,northwind,False,False,False,Order.discount
Which products from 'Exotic Liquids' are part of the 'Beverages' category and have a unit price less than 20?,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: ""Beverages""})
WHERE p.unitPrice < 20
RETURN p.productName, p.unitPrice",Complex Aggregation Queries,northwind,False,False,True,
List the top 5 products with the highest total sales quantity.,"MATCH (p:Product)-[o:ORDERS]->()
WITH p, sum(o.quantity) AS totalQuantity
ORDER BY totalQuantity DESC
LIMIT 5
RETURN p.productName, totalQuantity",Verbose query,northwind,False,False,True,
Which 3 categories have the most products with a reorder level above 15?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.reorderLevel > 15
WITH c, count(p) AS productCount
ORDER BY productCount DESC
LIMIT 3
RETURN c.categoryName, productCount",Verbose query,northwind,False,False,True,
Identify the 5 suppliers with the highest average unit price of products supplied.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, AVG(p.unitPrice) AS avgUnitPrice
ORDER BY avgUnitPrice DESC
LIMIT 5
RETURN s.companyName, avgUnitPrice",Verbose query,northwind,False,False,True,
What are the first 3 orders that were shipped to 'Reims'?,"MATCH (o:Order)
WHERE o.shipCity = 'Reims'
RETURN o
ORDER BY o.shippedDate
LIMIT 3",Verbose query,northwind,False,False,True,
List the top 5 most recently added products to the database.,"MATCH (p:Product)
RETURN p
ORDER BY p.productID DESC
LIMIT 5",Verbose query,northwind,False,False,True,
Which 3 products from 'Exotic Liquids' have been ordered the most in terms of quantity?,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)-[o:ORDERS]->()
WITH p, sum(o.quantity) AS totalQuantity
ORDER BY totalQuantity DESC
LIMIT 3
RETURN p.productName, totalQuantity",Verbose query,northwind,False,False,False,
What are the 3 most frequently supplied products by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)
RETURN p.productName, count(p) AS supplyCount
ORDER BY supplyCount DESC
LIMIT 3",Verbose query,northwind,False,False,True,
What are the first 3 products in the 'Produce' category with the lowest unit price?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Produce'})
WHERE p.unitPrice IS NOT NULL
RETURN p
ORDER BY p.unitPrice ASC
LIMIT 3",Verbose query,northwind,False,False,True,
Which 3 suppliers have the most diverse range of product categories supplied?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH s, count(DISTINCT c) AS numCategories
ORDER BY numCategories DESC
LIMIT 3
RETURN s.companyName, numCategories",Verbose query,northwind,False,False,True,
Identify the 5 most recently shipped orders.,"MATCH (o:Order)
WHERE o.shippedDate IS NOT NULL
RETURN o
ORDER BY o.shippedDate DESC
LIMIT 5",Verbose query,northwind,False,False,True,
What are the first 3 customers who have ordered the product with productID '1'?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product {productID: '1'})
RETURN c
LIMIT 3",Verbose query,northwind,False,False,True,
List the top 3 suppliers with the most products in the 'Beverages' category.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
WITH s, count(p) AS numProducts
ORDER BY numProducts DESC
LIMIT 3
RETURN s.companyName, numProducts",Verbose query,northwind,False,False,True,
Which 5 products have been reordered the most times?,"MATCH (p:Product)-[:ORDERS]->(o:Order)
RETURN p.productName, count(o) AS reorderCount
ORDER BY reorderCount DESC
LIMIT 5",Verbose query,northwind,False,False,True,
Identify the 3 most common ship addresses for orders.,"MATCH (o:Order)
RETURN o.shipAddress AS ShipAddress, count(o) AS NumberOfOrders
ORDER BY NumberOfOrders DESC
LIMIT 3",Verbose query,northwind,False,False,False,
What are the first 5 products from the 'Condiments' category with the most units in stock?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Condiments'})
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 5",Verbose query,northwind,False,False,True,
List the top 5 orders with the highest quantity of a single product.,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
RETURN o.orderID, p.productID, r.quantity
ORDER BY r.quantity DESC
LIMIT 5",Verbose query,northwind,False,False,True,
List the top 5 customers based on the total freight charges of their orders.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
RETURN c.companyName, SUM(toFloat(o.freight)) AS TotalFreight
ORDER BY TotalFreight DESC
LIMIT 5",Verbose query,northwind,False,False,False,
Identify the 5 customers who have ordered the most distinct categories of products.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(cat:Category)
WITH c, COUNT(DISTINCT cat) AS distinctCategories
ORDER BY distinctCategories DESC
LIMIT 5
RETURN c.companyName, distinctCategories",Verbose query,northwind,False,False,True,
Identify the 5 most common ship cities for orders.,"MATCH (o:Order)
RETURN o.shipCity AS ShipCity, count(o) AS NumberOfOrders
ORDER BY NumberOfOrders DESC
LIMIT 5",Verbose query,northwind,False,False,True,
List the top 5 products that have been discontinued.,"MATCH (p:Product {discontinued: true})
RETURN p.productName, p.productID
ORDER BY p.productID
LIMIT 5",Verbose query,northwind,False,False,True,
Which suppliers have a contact title of 'Purchasing Manager' and supply products with a unit price above 50?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.contactTitle = 'Purchasing Manager' AND p.unitPrice > 50
RETURN s.companyName, s.contactName, p.productName, p.unitPrice",Complex Aggregation Queries,northwind,False,False,True,
"List all products that belong to the 'Desserts, candies, and sweet breads' category and have a reorder level above 15.","MATCH (p:Product)-[:PART_OF]->(c:Category {description: 'Desserts, candies, and sweet breads'})
WHERE p.reorderLevel > 15
RETURN p",Complex Aggregation Queries,northwind,False,False,True,
What are the top 5 suppliers by number of different cities they supply to?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)<-[:ORDERS]-(o:Order)
WITH s, count(DISTINCT o.shipCity) AS citiesCount
ORDER BY citiesCount DESC
LIMIT 5
RETURN s.companyName, citiesCount",Complex Aggregation Queries,northwind,False,False,True,
Show the first 3 products from the 'Dairy Products' category that have been discontinued.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
WHERE p.discontinued = true
RETURN p
LIMIT 3",Complex Aggregation Queries,northwind,False,False,True,
Which suppliers provide products to more than one region?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)<-[:ORDERS]-(o:Order)
WITH s, count(DISTINCT o.shipRegion) AS regions
WHERE regions > 1
RETURN s.companyName, regions",Complex Aggregation Queries,northwind,False,False,True,
List all products that have been ordered by 'Vins et alcools Chevalier'.,"MATCH (c:Customer {companyName: ""Vins et alcools Chevalier""})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
RETURN p.productName AS ProductName, p.productID AS ProductID",Complex Aggregation Queries,northwind,False,False,False,
What are the top 3 most expensive products supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 3",Verbose query,northwind,False,False,True,
What are the top 5 categories by number of products supplied?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c, count(p) AS products_count
ORDER BY products_count DESC
LIMIT 5
RETURN c.categoryName, products_count",Complex Aggregation Queries,northwind,False,False,True,
Which products are supplied by suppliers from Germany?,"MATCH (s:Supplier {country: 'Germany'})-[:SUPPLIES]->(p:Product)
RETURN p.productName AS ProductName, p.productID AS ProductID",Complex Aggregation Queries,northwind,False,False,False,
List the first 3 products from the 'Seafood' category with a unitsOnOrder value above 20.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Seafood'})
WHERE p.unitsOnOrder > 20
RETURN p
LIMIT 3",Complex Aggregation Queries,northwind,False,False,True,
List all customers who have placed orders with a required date in 1998.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE o.requiredDate STARTS WITH '1998'
RETURN c",Complex Aggregation Queries,northwind,False,False,True,
What are the top 5 products by quantity per unit in the 'Produce' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Produce'})
RETURN p.productName, p.quantityPerUnit
ORDER BY p.quantityPerUnit DESC
LIMIT 5",Complex Aggregation Queries,northwind,False,False,True,
Show the first 3 discontinued products from the 'Confections' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Confections'})
WHERE p.discontinued = true
RETURN p
LIMIT 3",Complex Aggregation Queries,northwind,False,False,True,
Which 3 products have been ordered the most frequently?,"MATCH (p:Product)<-[:ORDERS]-(:Order)
WITH p, count(*) AS orderCount
ORDER BY orderCount DESC
LIMIT 3
RETURN p.productName, orderCount",Verbose query,northwind,False,False,True,
Which categories have products supplied by more than three different suppliers?,"MATCH (c:Category)<-[:PART_OF]-(p:Product)<-[:SUPPLIES]-(s:Supplier)
WITH c, count(DISTINCT s) AS supplierCount
WHERE supplierCount > 3
RETURN c.categoryName, supplierCount",Complex Aggregation Queries,northwind,False,False,True,
Show the first 3 orders for the product 'Chai'.,"MATCH (p:Product {productName: 'Chai'})-[:ORDERS]->(o:Order)
RETURN o
ORDER BY o.orderDate
LIMIT 3",Complex Aggregation Queries,northwind,False,False,True,
Identify 5 products that are part of the 'Beverages' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
RETURN p.productName, p.productID
LIMIT 5",Verbose query,northwind,False,False,True,
Which suppliers supply products with a unitsInStock value above 80?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.unitsInStock > 80
RETURN s",Complex Aggregation Queries,northwind,False,False,True,
Find the top 5 orders with the highest freight charges.,"MATCH (o:Order)
RETURN o
ORDER BY o.freight DESC
LIMIT 5",Verbose query,northwind,False,False,True,
Which 3 suppliers provide products in the 'Dairy Products' category?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
RETURN DISTINCT s.companyName
LIMIT 3",Verbose query,northwind,False,False,True,
What are the first 3 orders that included more than 100 units of any product?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WHERE r.quantity > 100
RETURN o
ORDER BY o.orderDate
LIMIT 3",Verbose query,northwind,False,False,True,
Which 3 customers have purchased the most products from the 'Seafood' category?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(cat:Category {categoryName: ""Seafood""})
WITH c, count(p) AS products_count
ORDER BY products_count DESC
LIMIT 3
RETURN c.companyName, products_count",Verbose query,northwind,False,False,True,
List the top 5 products ordered by 'Alfreds Futterkiste'.,"MATCH (c:Customer {companyName: ""Alfreds Futterkiste""})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
RETURN p.productName, count(o) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 5",Verbose query,northwind,False,False,True,
List the top 5 categories with the most products.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c, count(p) AS productCount
ORDER BY productCount DESC
LIMIT 5
RETURN c.categoryName, productCount",Verbose query,northwind,False,False,True,
What are the first 3 orders shipped via method '2' and have a discount?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WHERE o.shipVia = '2' AND r.discount <> '0'
RETURN o, r, p
LIMIT 3",Verbose query,northwind,False,False,True,
Find the 5 suppliers whose products have never been out of stock.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE NOT EXISTS {
  MATCH (p)-[:ORDERS]->(o:Order)
  WHERE p.unitsInStock = 0
}
RETURN s
LIMIT 5",Verbose query,northwind,False,False,True,
Name the top 3 products with the lowest unit price in the 'Grains/Cereals' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Grains/Cereals'})
RETURN p.productName AS ProductName, p.unitPrice AS UnitPrice
ORDER BY p.unitPrice ASC
LIMIT 3",Verbose query,northwind,False,False,True,
Identify the 3 suppliers with the highest number of products supplied to the 'Meat/Poultry' category.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Meat/Poultry'})
WITH s, count(p) AS products_count
ORDER BY products_count DESC
LIMIT 3
RETURN s.companyName, products_count",Verbose query,northwind,False,False,True,
List the 3 suppliers who supply the most products that have been discontinued.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product {discontinued: true})
WITH s, count(p) AS discontinuedProducts
ORDER BY discontinuedProducts DESC
LIMIT 3
RETURN s.companyName, discontinuedProducts",Verbose query,northwind,False,False,True,
Identify the 3 customers with the most orders placed.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WITH c, count(o) AS ordersCount
ORDER BY ordersCount DESC
LIMIT 3
RETURN c.companyName, ordersCount",Verbose query,northwind,False,False,True,
What are the top 5 products that have a reorder level above 20?,"MATCH (p:Product)
WHERE p.reorderLevel > 20
RETURN p.productName, p.reorderLevel
ORDER BY p.reorderLevel DESC
LIMIT 5",Verbose query,northwind,False,False,True,
Find the 5 most recent orders by ship date.,"MATCH (o:Order)
WHERE o.shippedDate IS NOT NULL
RETURN o
ORDER BY o.shippedDate DESC
LIMIT 5",Verbose query,northwind,False,False,True,
Which 3 customers have ordered the most units of any product?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
RETURN c.companyName, SUM(r.quantity) AS TotalUnitsOrdered
ORDER BY TotalUnitsOrdered DESC
LIMIT 3",Verbose query,northwind,False,True,False,
List the top 3 products with the highest units in stock in the 'Confections' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Confections'})
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 3",Verbose query,northwind,False,True,False,
Which 5 products have the highest units on order and are still active (not discontinued)?,"MATCH (p:Product)
WHERE p.discontinued = false AND p.unitsOnOrder IS NOT NULL
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 5",Verbose query,northwind,False,False,True,
What are the first 3 customers who have purchased orders shipped to France?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE o.shipCountry = 'France'
RETURN c
LIMIT 3",Verbose query,northwind,False,False,True,
What are the most common addresses used by entities?,"MATCH (e:Entity)-[:registered_address]->(a:Address)
RETURN a.address, count(e) AS entity_count
ORDER BY entity_count DESC",Simple Retrieval Queries,offshoreleaks,False,False,True,
What are the addresses of entities with a status of 'Defaulted'?,"MATCH (e:Entity)-[:registered_address]->(a:Address)
WHERE e.status = 'Defaulted'
RETURN a.address",Simple Retrieval Queries,offshoreleaks,False,True,False,
List the entities with a note mentioning 'Closed date stands for Liquidation date.',"MATCH (e:Entity)
WHERE e.note = 'Closed date stands for Liquidation date.'
RETURN e",Simple Retrieval Queries,offshoreleaks,False,False,True,
Which officers have a valid until date that matches 'The Panama Papers data is current through 2015'?,"MATCH (o:Officer)
WHERE o.valid_until = 'The Panama Papers data is current through 2015'
RETURN o",Simple Retrieval Queries,offshoreleaks,False,True,False,
Identify the entities with a former name and list them.,"MATCH (e:Entity)
WHERE e.former_name IS NOT NULL
RETURN e.name AS CurrentName, e.former_name AS FormerName",Simple Retrieval Queries,offshoreleaks,False,True,False,
List the top 5 officers by their last edit timestamp.,"MATCH (o:Officer)
WHERE o.lastEditTimestamp IS NOT NULL
RETURN o
ORDER BY o.lastEditTimestamp DESC
LIMIT 5",Simple Retrieval Queries,offshoreleaks,False,True,False,
What are the jurisdictions of the top 5 entities?,"MATCH (e:Entity)
RETURN e.jurisdiction_description AS Jurisdiction
ORDER BY e.node_id
LIMIT 5",Simple Retrieval Queries,offshoreleaks,False,False,False,
Find entities that are of the type 'FOREIGN FORMED CORPORATION'.,"MATCH (e:Entity {type: 'FOREIGN FORMED CORPORATION'})
RETURN e",Simple Retrieval Queries,offshoreleaks,False,False,True,
List the entities that have a tax description available.,"MATCH (e:Entity)
WHERE e.tax_stat_description IS NOT NULL
RETURN e",Simple Retrieval Queries,offshoreleaks,False,False,True,
Identify officers that are connected to entities through the 'connected to' relationship.,"MATCH (o:Officer)-[:connected_to]->(e:Entity)
RETURN o, e",Simple Retrieval Queries,offshoreleaks,False,True,False,
Which intermediaries serve as officers of entities?,"MATCH (i:Intermediary)-[:officer_of]->(e:Entity)
RETURN i, e",Simple Retrieval Queries,offshoreleaks,False,False,True,
Which entities have a company number and what are those numbers?,"MATCH (e:Entity)
WHERE e.company_number IS NOT NULL
RETURN e.name, e.company_number",Simple Retrieval Queries,offshoreleaks,False,False,True,
Identify officers linked to entities with a 'shareholder of' relationship.,"MATCH (o:Officer)-[r:officer_of {link: 'shareholder of'}]->(e:Entity)
RETURN o, r, e",Simple Retrieval Queries,offshoreleaks,True,False,False,
Identify entities with the same ID as other entities.,"MATCH (e1:Entity)-[:same_id_as]->(e2:Entity)
RETURN e1, e2",Simple Retrieval Queries,offshoreleaks,False,False,True,
List the top 5 entities with the most recent inactivation dates.,"MATCH (e:Entity)
WHERE e.inactivation_date IS NOT NULL
RETURN e
ORDER BY e.inactivation_date DESC
LIMIT 5",Simple Retrieval Queries,offshoreleaks,False,False,True,
What are the registered offices for the top 5 intermediaries?,"MATCH (i:Intermediary)-[:registered_address]->(a:Address)
RETURN i.name AS IntermediaryName, a.address AS RegisteredOffice
ORDER BY i.node_id
LIMIT 5",Simple Retrieval Queries,offshoreleaks,False,False,False,
Find officers who have the same name as other officers.,"MATCH (o1:Officer)-[:same_name_as]->(o2:Officer)
RETURN o1, o2",Simple Retrieval Queries,offshoreleaks,False,False,True,
Which intermediaries have the same name as entities?,"MATCH (i:Intermediary)-[:same_name_as]->(e:Entity)
RETURN i, e",Simple Retrieval Queries,offshoreleaks,False,False,True,
List the entities that have been struck off on '15-FEB-2013'.,"MATCH (e:Entity {struck_off_date: '15-FEB-2013'})
RETURN e",Simple Retrieval Queries,offshoreleaks,False,False,True,
Which officers have been officers of entities for the longest period?,"MATCH (o:Officer)-[r:officer_of]->(e:Entity)
WHERE r.start_date IS NOT NULL AND r.end_date IS NOT NULL
RETURN o.name AS OfficerName, e.name AS EntityName, r.start_date AS StartDate, r.end_date AS EndDate, duration.between(date(r.start_date), date(r.end_date)) AS Duration
ORDER BY Duration DESC",Simple Retrieval Queries,offshoreleaks,False,False,False,
Find the top 5 entities ordered by their internal ID.,"MATCH (e:Entity)
RETURN e
ORDER BY e.internal_id
LIMIT 5",Simple Retrieval Queries,offshoreleaks,False,False,True,
What are the most common country codes associated with the entities?,"MATCH (e:Entity)
WHERE e.country_codes IS NOT NULL
RETURN e.country_codes AS CountryCode, count(e) AS Frequency
ORDER BY Frequency DESC",Simple Retrieval Queries,offshoreleaks,False,True,False,
List the entities that are connected to the 'Paradise Papers - Aruba corporate registry'.,"MATCH (e:Entity)-[r:connected_to]->(:Other {sourceID: 'Paradise Papers - Aruba corporate registry'})
RETURN e",Simple Retrieval Queries,offshoreleaks,False,False,False,
Identify the intermediaries with a status of 'ACTIVE'.,"MATCH (i:Intermediary {status: 'ACTIVE'})
RETURN i",Simple Retrieval Queries,offshoreleaks,False,False,True,
Which addresses are linked to more than one entity as their registered address?,"MATCH (a:Address)<-[:registered_address]-(e:Entity)
WITH a, count(e) AS numEntities
WHERE numEntities > 1
RETURN a.address, numEntities",Simple Retrieval Queries,offshoreleaks,False,False,True,
List the entities with a 'same company as' relationship.,"MATCH (e:Entity)-[:same_company_as]->(related:Entity)
RETURN e, related",Simple Retrieval Queries,offshoreleaks,False,False,True,
List the entities that have a company type of 'LIMITED LIABILITY COMPANY'.,"MATCH (e:Entity {company_type: 'LIMITED LIABILITY COMPANY'})
RETURN e",Simple Retrieval Queries,offshoreleaks,False,False,True,
Which entities were incorporated in March 2006?,"MATCH (e:Entity)
WHERE e.incorporation_date CONTAINS ""MAR-2006""
RETURN e",Simple Retrieval Queries,offshoreleaks,False,False,False,
Identify entities that have the same company type as 'SOLE OWNERSHIP'.,"MATCH (e:Entity {type: 'SOLE OWNERSHIP'})
MATCH (e2:Entity)
WHERE e2.type = e.type AND e2.node_id <> e.node_id
RETURN e2",Simple Retrieval Queries,offshoreleaks,False,False,True,
"Identify the addresses connected to the entity 'TIANSHENG INDUSTRY AND TRADING CO., LTD.'.","MATCH (e:Entity {name: 'TIANSHENG INDUSTRY AND TRADING CO., LTD.'})-[:registered_address]->(a:Address)
RETURN a",Simple Retrieval Queries,offshoreleaks,False,True,False,
Find the top 3 officers based on the number of entities they are connected to.,"MATCH (o:Officer)-[:officer_of]->(e:Entity)
WITH o, count(e) AS num_entities
ORDER BY num_entities DESC
LIMIT 3
RETURN o.name, num_entities",Simple Retrieval Queries,offshoreleaks,False,False,True,
Who are the top 3 officers with the most connections to entities?,"MATCH (o:Officer)-[:officer_of]->(e:Entity)
WITH o, count(e) AS connections
ORDER BY connections DESC
LIMIT 3
RETURN o.name, connections",Simple Retrieval Queries,offshoreleaks,False,False,True,
What are the top 5 entities by node id?,"MATCH (e:Entity)
RETURN e
ORDER BY e.node_id DESC
LIMIT 5",Simple Retrieval Queries,offshoreleaks,False,False,False,
Find the entities that have been incorporated on '23-MAR-2006'.,"MATCH (e:Entity {incorporation_date: '23-MAR-2006'})
RETURN e",Simple Retrieval Queries,offshoreleaks,False,True,False,
Which officers have a similar name as 'KIM SOO IN'?,"MATCH (o:Officer)-[:similar]->(similarOfficer:Officer)
WHERE o.name = 'KIM SOO IN'
RETURN similarOfficer",Simple Retrieval Queries,offshoreleaks,False,False,True,
Identify the top 5 addresses used by intermediaries.,"MATCH (i:Intermediary)-[:registered_address]->(a:Address)
RETURN a.address, count(i) AS usage_count
ORDER BY usage_count DESC
LIMIT 5",Simple Retrieval Queries,offshoreleaks,False,False,False,
List the entities with a company type and their respective types.,"MATCH (e:Entity)
WHERE e.company_type IS NOT NULL
RETURN e.name, e.company_type",Simple Retrieval Queries,offshoreleaks,False,False,True,
What are the most recent entities added to the database based on their last edit timestamp?,"MATCH (e:Entity)
RETURN e
ORDER BY e.lastEditTimestamp DESC
LIMIT 10",Simple Retrieval Queries,offshoreleaks,False,False,False,
Find the entities that are registered in the jurisdiction of 'Samoa'.,"MATCH (e:Entity {jurisdiction: 'SAM'})
RETURN e",Simple Retrieval Queries,offshoreleaks,False,False,True,
Which officers are probably the same as 'KIM SOO IN'?,"MATCH (o1:Officer {name: 'KIM SOO IN'})
MATCH (o2:Officer)
WHERE EXISTS {
  (o1)-[:same_name_as]->(o2)
}
RETURN o2",Simple Retrieval Queries,offshoreleaks,False,False,False,
Identify entities with a company number.,"MATCH (e:Entity)
WHERE e.company_number IS NOT NULL
RETURN e",Simple Retrieval Queries,offshoreleaks,False,True,False,
What are the top 5 officers linked to the most entities?,"MATCH (o:Officer)-[:officer_of]->(e:Entity)
WITH o, count(e) AS numEntities
ORDER BY numEntities DESC
LIMIT 5
RETURN o.name, numEntities",Simple Retrieval Queries,offshoreleaks,False,False,True,
List the entities that have a similar name and address as 'Top Games Holdings Inc.'.,"MATCH (e:Entity)-[:similar]->(target:Entity {name: 'Top Games Holdings Inc.'})
RETURN e",Simple Retrieval Queries,offshoreleaks,False,False,False,
Which intermediaries have a source ID of 'Panama Papers'?,"MATCH (i:Intermediary {sourceID: 'Panama Papers'})
RETURN i",Simple Retrieval Queries,offshoreleaks,False,False,True,
List entities that have a company type of 'FOREIGN FORMED CORPORATION' and their jurisdiction.,"MATCH (e:Entity {company_type: 'FOREIGN FORMED CORPORATION'})
RETURN e.name AS EntityName, e.jurisdiction AS Jurisdiction",Simple Retrieval Queries,offshoreleaks,False,False,True,
What are the jurisdictions described for entities with a jurisdiction of 'SAM'?,"MATCH (e:Entity {jurisdiction: 'SAM'})
RETURN e.jurisdiction_description",Simple Retrieval Queries,offshoreleaks,False,False,False,
Find entities with incorporation dates in January 2006.,"MATCH (e:Entity)
WHERE e.incorporation_date STARTS WITH 'JAN-2006'
RETURN e",Simple Retrieval Queries,offshoreleaks,False,False,True,
Which entities have a struck off date and what are those dates?,"MATCH (e:Entity)
WHERE e.struck_off_date IS NOT NULL
RETURN e.name, e.struck_off_date",Simple Retrieval Queries,offshoreleaks,False,False,True,
List the top 3 entities based on their original name.,"MATCH (e:Entity)
WHERE e.original_name IS NOT NULL
RETURN e.original_name, e
ORDER BY e.original_name
LIMIT 3",Simple Retrieval Queries,offshoreleaks,False,False,False,
Who are the officers with the former name?,"MATCH (o:Officer)
WHERE o.former_name IS NOT NULL
RETURN o.name AS OfficerName, o.former_name AS FormerName",Simple Retrieval Queries,offshoreleaks,False,False,True,Officer.former_name
Find the top 5 addresses by the number of connections to entities.,"MATCH (a:Address)-[:registered_address]-(e:Entity)
WITH a, count(e) AS connections
ORDER BY connections DESC
LIMIT 5
RETURN a.address, connections",Simple Retrieval Queries,offshoreleaks,False,False,True,
Which intermediaries have a last edit timestamp through 2015?,"MATCH (i:Intermediary)
WHERE i.lastEditTimestamp <= '2015'
RETURN i",Simple Retrieval Queries,offshoreleaks,False,True,False,
"Identify entities with the same name as 'HOTFOCUS CO., LTD.'.","MATCH (e:Entity {name: 'HOTFOCUS CO., LTD.'})-[:same_name_as]->(sameNameEntity)
RETURN sameNameEntity",Simple Retrieval Queries,offshoreleaks,False,True,False,
List the entities that have a dorm date available.,"MATCH (e:Entity)
WHERE e.dorm_date IS NOT NULL
RETURN e",Simple Retrieval Queries,offshoreleaks,False,False,True,
What are the most common jurisdictions for entities?,"MATCH (e:Entity)
WHERE e.jurisdiction IS NOT NULL
RETURN e.jurisdiction AS Jurisdiction, count(e) AS NumberOfEntities
ORDER BY NumberOfEntities DESC",Simple Retrieval Queries,offshoreleaks,False,False,True,
Find the entities that have a similar name and address as other entities.,"MATCH (e1:Entity)-[:similar]->(e2:Entity)
RETURN e1, e2",Simple Retrieval Queries,offshoreleaks,False,False,False,
Which officers serve as intermediaries of entities?,"MATCH (o:Officer)-[:intermediary_of]->(e:Entity)
RETURN o, e",Simple Retrieval Queries,offshoreleaks,False,False,True,
Identify intermediaries that share the same address with other intermediaries.,"MATCH (i1:Intermediary)-[:registered_address]->(a:Address)<-[:registered_address]-(i2:Intermediary)
WHERE i1.node_id <> i2.node_id
RETURN i1.name AS Intermediary1, i2.name AS Intermediary2, a.address AS SharedAddress",Simple Retrieval Queries,offshoreleaks,False,False,False,
List the entities with the most recent struck off dates.,"MATCH (e:Entity)
WHERE e.struck_off_date IS NOT NULL
RETURN e
ORDER BY e.struck_off_date DESC",Simple Retrieval Queries,offshoreleaks,False,False,False,
What are the country codes for entities that have been struck off?,"MATCH (e:Entity)
WHERE e.struck_off_date IS NOT NULL
RETURN e.country_codes",Simple Retrieval Queries,offshoreleaks,False,False,True,
Which entities have been closed on '28-NOV-2012'?,"MATCH (e:Entity)
WHERE e.closed_date = '28-NOV-2012'
RETURN e",Simple Retrieval Queries,offshoreleaks,False,False,True,
Identify entities that have been closed and provide their closed date.,"MATCH (e:Entity)
WHERE e.closed_date IS NOT NULL
RETURN e.name, e.closed_date",Simple Retrieval Queries,offshoreleaks,False,False,True,
"Which entities have a similar name and address as 'NINGBO SUNRISE ENTERPRISES UNITED CO., LTD.'?","MATCH (e:Entity {name: 'NINGBO SUNRISE ENTERPRISES UNITED CO., LTD.'})-[:similar]->(similarEntity:Entity)
RETURN similarEntity",Simple Retrieval Queries,offshoreleaks,False,False,False,
What are the top 5 most recent addresses added to the database?,"MATCH (a:Address)
RETURN a.address, a.lastEditTimestamp
ORDER BY a.lastEditTimestamp DESC
LIMIT 5",Simple Retrieval Queries,offshoreleaks,False,False,True,
Provide the names of officers who have the same ICIJ ID and are connected to entities.,"MATCH (o1:Officer)-[:same_id_as]->(o2:Officer)
WHERE o1.icij_id IS NOT NULL AND o2.icij_id IS NOT NULL AND o1.icij_id = o2.icij_id
AND exists {
  (o1)-[:officer_of]->(:Entity)
}
RETURN o1.name AS OfficerName",Simple Retrieval Queries,offshoreleaks,False,False,True,
"List all entities that are the same as 'HOTFOCUS CO., LTD.' in terms of name and registration date.","MATCH (e1:Entity {name: 'HOTFOCUS CO., LTD.'})-[:same_as]->(e2:Entity)
RETURN e2",Simple Retrieval Queries,offshoreleaks,False,False,True,
List the entities that have a note regarding their status.,"MATCH (e:Entity)
WHERE e.note IS NOT NULL
RETURN e",Simple Retrieval Queries,offshoreleaks,False,False,True,
List the first 3 officers who are associated with entities incorporated in Samoa.,"MATCH (o:Officer)-[:officer_of]->(e:Entity {jurisdiction: 'SAM'})
RETURN o.name AS OfficerName, e.name AS EntityName
LIMIT 3",Simple Retrieval Queries,offshoreleaks,False,False,True,
What are the former names of entities that were incorporated in March 2006?,"MATCH (e:Entity)
WHERE e.incorporation_date CONTAINS ""MAR-2006"" AND e.former_name IS NOT NULL
RETURN e.former_name",Simple Retrieval Queries,offshoreleaks,False,False,True,
Provide the list of entities that have a connection to 'Top Games Holdings Inc.',"MATCH (e:Entity {name: 'Top Games Holdings Inc.'})-[:connected_to]->(connectedEntities:Entity)
RETURN connectedEntities",Simple Retrieval Queries,offshoreleaks,False,False,True,
Which addresses are associated with the sourceID 'Bahamas Leaks'?,"MATCH (a:Address)
WHERE a.sourceID = 'Bahamas Leaks'
RETURN a",Simple Retrieval Queries,offshoreleaks,False,False,False,
Provide names of officers that have the ICIJ ID 'E72326DEA50F1A9C2876E112AAEB42BC'.,"MATCH (o:Officer {icij_id: 'E72326DEA50F1A9C2876E112AAEB42BC'})
RETURN o.name",Simple Retrieval Queries,offshoreleaks,False,False,True,
List all officers from South Korea.,"MATCH (o:Officer {countries: ""South Korea""})
RETURN o",Simple Retrieval Queries,offshoreleaks,False,False,True,
Name intermediaries that are currently active.,"MATCH (i:Intermediary)
WHERE i.status = 'ACTIVE'
RETURN i.name",Simple Retrieval Queries,offshoreleaks,False,False,True,
Which intermediaries are associated with entities in South Africa?,"MATCH (i:Intermediary)-[:intermediary_of]->(e:Entity)
WHERE e.countries = 'South Africa'
RETURN i",Simple Retrieval Queries,offshoreleaks,False,True,False,
List the top 5 entities by their lastEditTimestamp.,"MATCH (e:Entity)
WHERE e.lastEditTimestamp IS NOT NULL
RETURN e
ORDER BY e.lastEditTimestamp DESC
LIMIT 5",Simple Retrieval Queries,offshoreleaks,False,False,True,
What is the original name of the entity with node_id 10000002?,"MATCH (e:Entity {node_id: 10000002})
RETURN e.original_name",Simple Retrieval Queries,offshoreleaks,False,True,False,
"List the intermediary names that have the same address as 'MICHAEL PAPAGEORGE, MR.'","MATCH (i1:Intermediary {name: 'MICHAEL PAPAGEORGE, MR.'})-[:registered_address]->(a:Address)
MATCH (i2:Intermediary)-[:registered_address]->(a)
RETURN DISTINCT i2.name AS IntermediaryName",Simple Retrieval Queries,offshoreleaks,False,False,True,
"Which officers have been linked to the entity 'NINGBO SUNRISE ENTERPRISES UNITED CO., LTD.'?","MATCH (o:Officer)-[:officer_of]->(e:Entity {name: 'NINGBO SUNRISE ENTERPRISES UNITED CO., LTD.'})
RETURN o.name AS OfficerName",Simple Retrieval Queries,offshoreleaks,False,False,True,
List all entities that have 'HKG' as their country code.,"MATCH (e:Entity {country_codes: 'HKG'})
RETURN e",Simple Retrieval Queries,offshoreleaks,False,False,True,
What are the names of entities that have been inactivated on '18-FEB-2013'?,"MATCH (e:Entity {inactivation_date: '18-FEB-2013'})
RETURN e.name",Simple Retrieval Queries,offshoreleaks,False,False,True,
Which entities have a status of 'Defaulted'?,"MATCH (e:Entity {status: 'Defaulted'})
RETURN e",Simple Retrieval Queries,offshoreleaks,False,False,True,
List entities that were incorporated on '23-MAR-2006'.,"MATCH (e:Entity {incorporation_date: '23-MAR-2006'})
RETURN e",Simple Retrieval Queries,offshoreleaks,False,False,True,
What are the names of entities with the service provider 'Mossack Fonseca'?,"MATCH (e:Entity {service_provider: 'Mossack Fonseca'})
RETURN e.name",Simple Retrieval Queries,offshoreleaks,False,False,True,
Which entities have been struck off on '15-FEB-2013'?,"MATCH (e:Entity {struck_off_date: '15-FEB-2013'})
RETURN e",Simple Retrieval Queries,offshoreleaks,False,True,False,
List all entities that have a jurisdiction of Samoa.,"MATCH (e:Entity {jurisdiction: 'SAM'})
RETURN e",Simple Retrieval Queries,offshoreleaks,False,False,True,
Which entities are registered in Hong Kong as per the Panama Papers?,"MATCH (e:Entity)
WHERE e.countries = ""Hong Kong"" AND e.sourceID = ""Panama Papers""
RETURN e",Simple Retrieval Queries,offshoreleaks,False,True,False,
What addresses are registered to more than one entity?,"MATCH (a:Address)<-[:registered_address]-(e:Entity)
WITH a, count(e) AS numEntities
WHERE numEntities > 1
RETURN a",Complex Retrieval Queries,offshoreleaks,False,True,False,
List entities that have the same name as officers.,"MATCH (e:Entity)-[:same_name_as]->(o:Officer)
RETURN e, o",Complex Retrieval Queries,offshoreleaks,False,False,False,
"Who is the intermediary of 'HOTFOCUS CO., LTD.' and what is their status?","MATCH (i:Intermediary)-[:intermediary_of]->(e:Entity {name: 'HOTFOCUS CO., LTD.'})
RETURN i.name AS IntermediaryName, i.status AS IntermediaryStatus",Complex Retrieval Queries,offshoreleaks,False,False,True,
Provide the names of all officers from South Korea.,"MATCH (o:Officer {countries: ""South Korea""})
RETURN o.name",Complex Retrieval Queries,offshoreleaks,False,False,False,
"What are the names of entities that have changed their names, and what are their former names?","MATCH (e:Entity)
WHERE e.former_name IS NOT NULL
RETURN e.name AS CurrentName, e.former_name AS FormerName",Complex Retrieval Queries,offshoreleaks,False,False,True,
What addresses are linked as registered addresses to entities in Samoa?,"MATCH (e:Entity)-[:registered_address]->(a:Address)
WHERE e.jurisdiction_description = 'Samoa'
RETURN a",Simple Retrieval Queries,offshoreleaks,False,False,True,
Which officers are probably the same as other officers?,"MATCH (o1:Officer)-[:same_name_as]->(o2:Officer)
RETURN o1, o2",Simple Retrieval Queries,offshoreleaks,False,False,True,
Which entities share the same company type and are registered in Hong Kong?,"MATCH (e1:Entity)-[:registered_address]->(a:Address)
WHERE e1.company_type IS NOT NULL AND a.countries = ""Hong Kong""
MATCH (e2:Entity)-[:registered_address]->(a2:Address)
WHERE e2.company_type = e1.company_type AND a2.countries = ""Hong Kong""
RETURN e1, e2",Simple Retrieval Queries,offshoreleaks,False,True,False,
List the original addresses associated with the sourceID 'Panama Papers'.,"MATCH (a:Address)
WHERE a.sourceID = 'Panama Papers' AND a.original_address IS NOT NULL
RETURN a.original_address",Simple Retrieval Queries,offshoreleaks,False,False,True,
List the entities that have been inactivated on '18-FEB-2013'.,"MATCH (e:Entity {inactivation_date: '18-FEB-2013'})
RETURN e",Simple Retrieval Queries,offshoreleaks,False,True,False,
"Which entities have the same name as 'TIANSHENG INDUSTRY AND TRADING CO., LTD.'?","MATCH (e:Entity {name: 'TIANSHENG INDUSTRY AND TRADING CO., LTD.'})-[:same_name_as]->(sameNameEntity)
RETURN sameNameEntity",Simple Retrieval Queries,offshoreleaks,False,False,True,
Find intermediaries that are similar to officers.,"MATCH (i:Intermediary)-[:similar]->(o:Officer)
RETURN i, o",Simple Retrieval Queries,offshoreleaks,False,False,True,
What addresses are registered to entities in Hong Kong?,"MATCH (e:Entity)-[:registered_address]->(a:Address)
WHERE e.countries = ""Hong Kong""
RETURN a",Simple Retrieval Queries,offshoreleaks,False,False,True,
Identify entities with a jurisdiction description of 'Samoa'.,"MATCH (e:Entity)
WHERE e.jurisdiction_description = 'Samoa'
RETURN e",Simple Retrieval Queries,offshoreleaks,False,False,True,
Which officers have a valid until date through 2015?,"MATCH (o:Officer)
WHERE o.valid_until = ""The Panama Papers data is current through 2015""
RETURN o",Simple Retrieval Queries,offshoreleaks,False,True,False,
What are the top 3 entities by last edit timestamp?,"MATCH (e:Entity)
RETURN e
ORDER BY e.lastEditTimestamp DESC
LIMIT 3",Simple Retrieval Queries,offshoreleaks,False,False,False,
Find all entities that share the same address as other entities.,"MATCH (e1:Entity)-[:registered_address]->(a:Address)<-[:registered_address]-(e2:Entity)
WHERE e1.node_id <> e2.node_id
RETURN e1, a, e2",Simple Retrieval Queries,offshoreleaks,False,False,True,
Who are the officers serving as intermediaries for more than one entity?,"MATCH (o:Officer)-[:intermediary_of]->(e:Entity)
WITH o, count(e) AS numEntities
WHERE numEntities > 1
RETURN o.name, numEntities",Simple Retrieval Queries,offshoreleaks,False,False,True,
List the top 5 entities with the service provider 'Mossack Fonseca'.,"MATCH (e:Entity {service_provider: 'Mossack Fonseca'})
RETURN e
ORDER BY e.node_id
LIMIT 5",Simple Retrieval Queries,offshoreleaks,False,False,True,
What are the names of entities struck off in February 2013?,"MATCH (e:Entity)
WHERE e.struck_off_date STARTS WITH '15-FEB-2013'
RETURN e.name",Simple Retrieval Queries,offshoreleaks,False,False,False,
Find entities that have a 'registered address' in Samoa.,"MATCH (e:Entity)-[:registered_address]->(a:Address)
WHERE a.countries = 'Samoa'
RETURN e",Simple Retrieval Queries,offshoreleaks,False,True,False,
Which intermediaries are connected to entities?,"MATCH (i:Intermediary)-[:intermediary_of]->(e:Entity)
RETURN i, e",Simple Retrieval Queries,offshoreleaks,False,False,True,
What are the names of entities that have a company number associated with Mossack Fonseca?,"MATCH (e:Entity {service_provider: ""Mossack Fonseca""})
WHERE e.company_number IS NOT NULL
RETURN e.name",Simple Retrieval Queries,offshoreleaks,False,False,True,
List the names of the top 5 officers from South Korea.,"MATCH (o:Officer {countries: ""South Korea""})
RETURN o.name
LIMIT 5",Simple Retrieval Queries,offshoreleaks,False,True,False,
What are the top 3 entities by incorporation date?,"MATCH (e:Entity)
WHERE e.incorporation_date IS NOT NULL
RETURN e
ORDER BY e.incorporation_date
LIMIT 3",Simple Retrieval Queries,offshoreleaks,False,False,True,
Which entities have a jurisdiction description of 'Samoa' and were incorporated in March?,"MATCH (e:Entity)
WHERE e.jurisdiction_description = 'Samoa' AND e.incorporation_date CONTAINS 'MAR'
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,True,
What is the service provider for entities that were incorporated in 2006?,"MATCH (e:Entity {incorporation_date: ""2006""})
RETURN e.name, e.service_provider",Complex Retrieval Queries,offshoreleaks,False,False,True,
Find all entities with the status 'Defaulted' and list their names.,"MATCH (e:Entity {status: 'Defaulted'})
RETURN e.name AS EntityName",Complex Retrieval Queries,offshoreleaks,False,True,False,
Identify entities that have been inactivated on '18-FEB-2013'.,"MATCH (e:Entity {inactivation_date: '18-FEB-2013'})
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,True,
What are the names of officers who have a registered address in the Bahamas?,"MATCH (o:Officer)-[:registered_address]->(a:Address {countries: ""Bahamas""})
RETURN o.name",Complex Retrieval Queries,offshoreleaks,False,False,False,
Can you provide the names of entities that have the same address as others?,"MATCH (e1:Entity)-[:registered_address]->(a:Address)<-[:registered_address]-(e2:Entity)
WHERE e1.node_id <> e2.node_id
RETURN e1.name AS Entity1, e2.name AS Entity2",Complex Retrieval Queries,offshoreleaks,False,True,False,
Which officers are connected to entities incorporated before 2000?,"MATCH (o:Officer)-[:officer_of]->(e:Entity)
WHERE e.incorporation_date < '01-JAN-2000'
RETURN o",Complex Retrieval Queries,offshoreleaks,False,True,False,
List the names of intermediaries based in South Africa with an active status.,"MATCH (i:Intermediary {countries: ""South Africa"", status: ""ACTIVE""})
RETURN i.name",Complex Retrieval Queries,offshoreleaks,False,False,True,
What are the names of entities that are registered in Samoa and have been struck off after 2010?,"MATCH (e:Entity)
WHERE e.jurisdiction_description = 'Samoa' AND e.struck_off_date >= '01-JAN-2011'
RETURN e.name",Complex Retrieval Queries,offshoreleaks,False,False,True,
List the officers who have been officers of more than one entity.,"MATCH (o:Officer)-[:officer_of]->(e:Entity)
WITH o, count(e) AS numEntities
WHERE numEntities > 1
RETURN o.name, numEntities",Simple Retrieval Queries,offshoreleaks,False,True,False,
"Provide the names of entities that have a struck off date similar to 'HOTFOCUS CO., LTD.'","MATCH (e1:Entity {name: 'HOTFOCUS CO., LTD.'})
MATCH (e2:Entity)
WHERE e1.struck_off_date IS NOT NULL AND e1.struck_off_date = e2.struck_off_date AND e1.node_id <> e2.node_id
RETURN e2.name",Simple Retrieval Queries,offshoreleaks,False,False,True,
"Which officers are nominees of 'NINGBO SUNRISE ENTERPRISES UNITED CO., LTD.' as per Offshore Leaks?","MATCH (o:Officer)-[:officer_of]->(e:Entity {name: 'NINGBO SUNRISE ENTERPRISES UNITED CO., LTD.'})
WHERE e.sourceID = 'Offshore Leaks'
RETURN o.name AS OfficerName",Simple Retrieval Queries,offshoreleaks,False,False,True,
Which entities have a status of 'Defaulted'?,"MATCH (e:Entity {status: 'Defaulted'})
RETURN e",Simple Retrieval Queries,offshoreleaks,False,False,True,
Identify intermediaries that are registered to the same address as entities.,"MATCH (i:Intermediary)-[:registered_address]->(a:Address)<-[:registered_address]-(e:Entity)
RETURN i, a, e",Simple Retrieval Queries,offshoreleaks,False,False,True,
List the intermediary names that are similar to any officers.,"MATCH (i:Intermediary)-[:similar]->(o:Officer)
RETURN i.name AS IntermediaryName",Complex Retrieval Queries,offshoreleaks,False,False,False,
Find the entities with the most recent dorm dates.,"MATCH (e:Entity)
WHERE e.dorm_date IS NOT NULL
RETURN e
ORDER BY e.dorm_date DESC
LIMIT 1;",Simple Retrieval Queries,offshoreleaks,False,False,False,
Find all intermediaries with an active status and their associated entities.,"MATCH (i:Intermediary {status: ""ACTIVE""})-[:intermediary_of]->(e:Entity)
RETURN i, e",Simple Aggregation Queries,offshoreleaks,False,False,True,
"Which officers are connected to entities with the original name 'TIANSHENG INDUSTRY AND TRADING CO., LTD.'?","MATCH (o:Officer)-[:officer_of]->(e:Entity {original_name: 'TIANSHENG INDUSTRY AND TRADING CO., LTD.'})
RETURN o",Simple Aggregation Queries,offshoreleaks,False,True,False,
List the entities that were incorporated in 2006 and their current status.,"MATCH (e:Entity)
WHERE e.incorporation_date CONTAINS '2006' AND e.status IS NOT NULL
RETURN e.name, e.status",Simple Aggregation Queries,offshoreleaks,False,False,True,
Identify entities with a struck-off date in February 2013 and their service providers.,"MATCH (e:Entity {struck_off_date: '15-FEB-2013'})-[:registered_address]->(a:Address)
RETURN e.name AS EntityName, e.service_provider AS ServiceProvider, a.address AS Address",Simple Aggregation Queries,offshoreleaks,False,True,False,
How many entities have 'Hong Kong' listed both as their country and jurisdiction description?,"MATCH (e:Entity)
WHERE e.countries = 'Hong Kong' AND e.jurisdiction_description = 'Hong Kong'
RETURN count(e) AS NumberOfEntities",Simple Aggregation Queries,offshoreleaks,False,False,True,
What entities are linked to the address 'ORION HOUSE SERVICES (HK) LIMITED ROOM 1401; 14/F.'?,"MATCH (a:Address {address: 'ORION HOUSE SERVICES (HK) LIMITED ROOM 1401; 14/F.'})<-[:registered_address]-(e:Entity)
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,True,
Identify entities and their corresponding officers that have been connected since 1999.,"MATCH (e:Entity)-[r:officer_of]->(o:Officer)
WHERE r.start_date <= '1999'
RETURN e, r, o",Simple Aggregation Queries,offshoreleaks,False,False,True,
List entities that have been inactive since February 2013 and their last known status.,"MATCH (e:Entity)
WHERE e.inactivation_date = '18-FEB-2013' AND e.status IS NOT NULL
RETURN e.name, e.status",Simple Aggregation Queries,offshoreleaks,False,False,False,
What are the countries and jurisdictions for entities that are still active as per the latest update?,"MATCH (e:Entity)
WHERE e.status = 'Active' AND e.lastEditTimestamp IS NOT NULL
RETURN e.countries AS Country, e.jurisdiction_description AS Jurisdiction",Simple Aggregation Queries,offshoreleaks,False,False,False,
Find entities that were both incorporated and struck off in 2013.,"MATCH (e:Entity)
WHERE e.incorporation_date CONTAINS '2013' AND e.struck_off_date CONTAINS '2013'
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,True,
List the entities with a former name and their current name.,"MATCH (e:Entity)
WHERE e.former_name IS NOT NULL
RETURN e.former_name AS FormerName, e.name AS CurrentName",Simple Aggregation Queries,offshoreleaks,False,False,True,
Which officers have a similar name or address to another officer?,"MATCH (o1:Officer)-[:similar]->(o2:Officer)
RETURN o1.name AS Officer1, o2.name AS Officer2, o1.address AS Address1, o2.address AS Address2",Simple Aggregation Queries,offshoreleaks,False,True,False,Officer.address
Find officers linked to entities that were incorporated in 2007 and are still active.,"MATCH (o:Officer)-[:officer_of]->(e:Entity)
WHERE e.incorporation_date CONTAINS '2007' AND e.status = 'Active'
RETURN o",Simple Aggregation Queries,offshoreleaks,False,False,True,
What are the last known addresses of entities with a status 'Defaulted' in 2013?,"MATCH (e:Entity)-[:registered_address]->(a:Address)
WHERE e.status = 'Defaulted' AND e.inactivation_date CONTAINS '2013'
RETURN e.name, a.address",Simple Aggregation Queries,offshoreleaks,False,True,False,
Identify entities with more than one officer linked to them and have a status of 'Active'.,"MATCH (e:Entity)-[:officer_of]->(o:Officer)
WHERE e.status = 'Active'
WITH e, count(o) AS officerCount
WHERE officerCount > 1
RETURN e, officerCount",Simple Aggregation Queries,offshoreleaks,False,False,True,
What are the last known statuses of entities that were incorporated in January 2006?,"MATCH (e:Entity)
WHERE e.incorporation_date STARTS WITH ""JAN-2006""
RETURN e.name, e.status",Simple Aggregation Queries,offshoreleaks,False,False,True,
List entities that have addresses in Hong Kong but are registered under jurisdictions outside of Hong Kong.,"MATCH (e:Entity)-[:registered_address]->(a:Address)
WHERE a.countries = 'Hong Kong' AND e.jurisdiction_description <> 'Hong Kong'
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,True,
Identify all entities that were incorporated on '23-MAR-2006' and their current status.,"MATCH (e:Entity {incorporation_date: '23-MAR-2006'})
RETURN e.name, e.status",Simple Aggregation Queries,offshoreleaks,False,True,False,
Which entities are associated with the service provider 'Mossack Fonseca' and have a status of 'Active'?,"MATCH (e:Entity)
WHERE e.service_provider = 'Mossack Fonseca' AND e.status = 'Active'
RETURN e",Simple Aggregation Queries,offshoreleaks,False,True,False,
List entities that have an incorporation date and a struck-off date within the same year.,"MATCH (e:Entity)
WHERE e.incorporation_date IS NOT NULL AND e.struck_off_date IS NOT NULL
  AND substring(e.incorporation_date, 7) = substring(e.struck_off_date, 7)
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,True,
What are the names of intermediaries that are linked to entities with a status of 'Defaulted'?,"MATCH (i:Intermediary)-[:intermediary_of]->(e:Entity {status: 'Defaulted'})
RETURN i.name",Simple Aggregation Queries,offshoreleaks,False,False,False,
Identify officers who have a registered address in Samoa.,"MATCH (o:Officer)-[:registered_address]->(a:Address)
WHERE a.countries = 'Samoa'
RETURN o",Simple Aggregation Queries,offshoreleaks,False,False,True,
Which entities were incorporated in March 2006 and are no longer active?,"MATCH (e:Entity)
WHERE e.incorporation_date CONTAINS ""MAR-2006"" AND e.status = ""Defaulted""
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,True,
Find entities that have changed their names and are currently active.,"MATCH (e:Entity)
WHERE e.former_name IS NOT NULL AND e.status = ""Active""
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,True,
Which officers are connected to entities registered in Samoa?,"MATCH (o:Officer)-[:officer_of]->(e:Entity)
WHERE e.jurisdiction_description = 'Samoa'
RETURN o",Simple Aggregation Queries,offshoreleaks,False,False,True,
List the entities that have 'Mossack Fonseca' as their service provider and are defaulted.,"MATCH (e:Entity {service_provider: 'Mossack Fonseca', status: 'Defaulted'})
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,False,
Which entities are registered in Samoa and have been struck off as of 2013?,"MATCH (e:Entity)
WHERE e.jurisdiction_description = 'Samoa' AND e.struck_off_date = '15-FEB-2013'
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,True,
"Find all entities with a 'same_as' relationship to 'NINGBO SUNRISE ENTERPRISES UNITED CO., LTD.'.","MATCH (e:Entity {name: 'NINGBO SUNRISE ENTERPRISES UNITED CO., LTD.'})-[:same_as]->(sameEntity:Entity)
RETURN sameEntity",Complex Retrieval Queries,offshoreleaks,False,False,False,
List the officers that have a valid status up until 2015 and are linked to Samoa.,"MATCH (o:Officer)-[:officer_of]->(e:Entity)
WHERE o.valid_until = ""The Panama Papers data is current through 2015""
  AND e.jurisdiction_description = ""Samoa""
RETURN o",Simple Aggregation Queries,offshoreleaks,True,False,False,
List entities registered in Samoa with a status of 'Active'.,"MATCH (e:Entity)
WHERE e.jurisdiction_description = 'Samoa' AND e.status = 'Active'
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,True,
Which entities have a service provider of 'Mossack Fonseca' and were incorporated in 2006?,"MATCH (e:Entity)
WHERE e.service_provider = 'Mossack Fonseca' AND e.incorporation_date CONTAINS '2006'
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,True,
Which entities are registered in Samoa and have a status of 'Defaulted'?,"MATCH (e:Entity)
WHERE e.jurisdiction_description = 'Samoa' AND e.status = 'Defaulted'
RETURN e",Pathfinding Queries,offshoreleaks,False,False,True,
"What are the registered office addresses for intermediaries named 'MICHAEL PAPAGEORGE, MR.'?","MATCH (i:Intermediary {name: 'MICHAEL PAPAGEORGE, MR.'})-[:registered_address]->(a:Address)
RETURN a.address AS RegisteredOfficeAddress",Pathfinding Queries,offshoreleaks,False,True,False,
List the entities that have a dorm date specified.,"MATCH (e:Entity)
WHERE e.dorm_date IS NOT NULL
RETURN e",Pathfinding Queries,offshoreleaks,False,False,True,
"Which entities have the same company number as 'HOTFOCUS CO., LTD.'?","MATCH (e1:Entity {name: 'HOTFOCUS CO., LTD.'}), (e2:Entity)
WHERE e1.company_number IS NOT NULL AND e1.company_number = e2.company_number AND e1 <> e2
RETURN e2",Pathfinding Queries,offshoreleaks,False,False,False,
What are the common jurisdictions described for entities registered under the jurisdiction code 'SAM'?,"MATCH (e:Entity {jurisdiction: 'SAM'})
RETURN e.jurisdiction_description AS JurisdictionDescription, count(e) AS Count
GROUP BY e.jurisdiction_description",Pathfinding Queries,offshoreleaks,False,False,True,
Identify the first 3 addresses that are shared by multiple entities or officers.,"MATCH (a:Address)<-[:registered_address]-(n)
WITH a, count(n) AS sharedCount
WHERE sharedCount > 1
RETURN a
LIMIT 3",Pathfinding Queries,offshoreleaks,False,False,False,
Which officers are connected to entities through the 'officer_of' relationship and have a status listed?,"MATCH (o:Officer)-[r:officer_of]->(e:Entity)
WHERE o.status IS NOT NULL
RETURN o, r, e",Pathfinding Queries,offshoreleaks,False,False,True,Officer.status
List the intermediary names that have a registered address linked to them.,"MATCH (i:Intermediary)-[:registered_address]->(a:Address)
RETURN i.name AS IntermediaryName",Pathfinding Queries,offshoreleaks,False,False,True,
Which entities have a tax status description available?,"MATCH (e:Entity)
WHERE e.tax_stat_description IS NOT NULL
RETURN e",Pathfinding Queries,offshoreleaks,False,True,False,
What are the different types of companies listed under the 'Other' node category?,"MATCH (o:Other)
WHERE o.type IS NOT NULL
RETURN DISTINCT o.type",Pathfinding Queries,offshoreleaks,False,False,True,
"Identify entities that have a similar name and address as 'HOTFOCUS CO., LTD.'.","MATCH (e:Entity)-[:similar]->(similarEntity:Entity)
WHERE e.name = 'HOTFOCUS CO., LTD.'
RETURN similarEntity",Pathfinding Queries,offshoreleaks,False,False,False,
What are the details of entities that have an incorporation date in 2006?,"MATCH (e:Entity)
WHERE e.incorporation_date CONTAINS '2006'
RETURN e",Pathfinding Queries,offshoreleaks,False,False,True,
Find all entities that have been registered to the same address as 'ORION HOUSE SERVICES (HK) LIMITED'.,"MATCH (a:Address {address: ""ORION HOUSE SERVICES (HK) LIMITED""})
MATCH (e:Entity)-[:registered_address]->(a)
RETURN e",Pathfinding Queries,offshoreleaks,False,False,True,
Which entities have a closed date listed and what are those dates?,"MATCH (e:Entity)
WHERE e.closed_date IS NOT NULL
RETURN e.name, e.closed_date",Pathfinding Queries,offshoreleaks,False,True,False,
List entities that are connected to officers named 'KIM SOO IN'.,"MATCH (o:Officer {name: 'KIM SOO IN'})-[:officer_of]->(e:Entity)
RETURN e",Pathfinding Queries,offshoreleaks,False,True,False,
Which officers are probably the same as other officers and share a similar name?,"MATCH (o1:Officer)-[:same_name_as]->(o2:Officer)
WHERE o1.node_id <> o2.node_id
RETURN o1.name AS Officer1, o2.name AS Officer2",Pathfinding Queries,offshoreleaks,False,False,True,
What addresses in Samoa are linked to more than one entity?,"MATCH (a:Address)<-[:registered_address]-(e:Entity)
WHERE e.jurisdiction_description = 'Samoa'
WITH a, count(e) AS entityCount
WHERE entityCount > 1
RETURN a.address, entityCount",Pathfinding Queries,offshoreleaks,False,False,True,
Identify entities that have a 'company_number' and are listed as 'Defaulted'.,"MATCH (e:Entity)
WHERE e.company_number IS NOT NULL AND e.status = 'Defaulted'
RETURN e",Pathfinding Queries,offshoreleaks,False,False,False,
Display the first 5 officers who have addresses in South Korea.,"MATCH (o:Officer)-[:registered_address]->(a:Address)
WHERE a.countries = ""South Korea""
RETURN o
LIMIT 5",Pathfinding Queries,offshoreleaks,False,True,False,
Which entities have been inactive since February 2013?,"MATCH (e:Entity)
WHERE e.inactivation_date = '18-FEB-2013'
RETURN e",Pathfinding Queries,offshoreleaks,False,True,False,
"What are the names of entities that have changed their names, and what are their former names?","MATCH (e:Entity)
WHERE e.former_name IS NOT NULL
RETURN e.name AS CurrentName, e.former_name AS FormerName",Pathfinding Queries,offshoreleaks,False,False,True,
Are there any addresses that are registered under multiple different nodes?,"MATCH (a:Address)
WITH a, count{(a)<-[:registered_address]-()} AS numEntities
WHERE numEntities > 1
RETURN a",Pathfinding Queries,offshoreleaks,False,False,True,
Which officers have a connection to entities registered in Samoa?,"MATCH (o:Officer)-[:officer_of]->(e:Entity)
WHERE e.jurisdiction_description = 'Samoa'
RETURN o.name AS OfficerName, e.name AS EntityName",Pathfinding Queries,offshoreleaks,False,False,False,
List top 3 intermediaries that have been linked as officers of entities.,"MATCH (i:Intermediary)-[:officer_of]->(e:Entity)
RETURN i.name, count(e) AS entities_linked
ORDER BY entities_linked DESC
LIMIT 3",Pathfinding Queries,offshoreleaks,False,False,False,
"Can you find any officers linked to the entity 'TIANSHENG INDUSTRY AND TRADING CO., LTD.'?","MATCH (e:Entity {name: 'TIANSHENG INDUSTRY AND TRADING CO., LTD.'})-[:officer_of]->(o:Officer)
RETURN o",Pathfinding Queries,offshoreleaks,False,False,True,
Which entities have a valid data period through 2015 and are associated with the service provider 'Mossack Fonseca'?,"MATCH (e:Entity)
WHERE e.valid_until = ""The Panama Papers data is current through 2015"" AND e.service_provider = ""Mossack Fonseca""
RETURN e",Pathfinding Queries,offshoreleaks,False,False,True,
What are the common addresses between two or more entities?,"MATCH (e1:Entity)-[:registered_address]->(a:Address)<-[:registered_address]-(e2:Entity)
WHERE e1.node_id <> e2.node_id
RETURN a.address, collect(e1.name) AS entity_names",Pathfinding Queries,offshoreleaks,False,True,False,
Identify three officers with addresses registered in the Bahamas.,"MATCH (o:Officer)-[:registered_address]->(a:Address {countries: ""Bahamas""})
RETURN o.name, a.address
LIMIT 3",Pathfinding Queries,offshoreleaks,False,False,True,
What are the names of intermediaries located in South Africa?,"MATCH (i:Intermediary {countries: ""South Africa""})
RETURN i.name",Pathfinding Queries,offshoreleaks,False,False,True,
List the first 5 entities that have been struck off as of 2013.,"MATCH (e:Entity)
WHERE e.struck_off_date STARTS WITH '2013'
RETURN e
LIMIT 5",Pathfinding Queries,offshoreleaks,False,False,True,
What is the address linked to the 'registered_address' relationship for entity node_id 10000002?,"MATCH (e:Entity {node_id: 10000002})-[:registered_address]->(a:Address)
RETURN a.address AS Address",Complex Retrieval Queries,offshoreleaks,False,False,True,
Which officers have been involved in a 'shareholder of' relationship the longest?,"MATCH (o:Officer)-[r:officer_of {link: 'shareholder of'}]->(e:Entity)
RETURN o.name AS OfficerName, e.name AS EntityName, r.start_date AS StartDate, r.end_date AS EndDate
ORDER BY r.start_date
LIMIT 10",Simple Retrieval Queries,offshoreleaks,False,False,True,
Show the first 5 officers with the sourceID 'Panama Papers'.,"MATCH (o:Officer {sourceID: 'Panama Papers'})
RETURN o
LIMIT 5",Complex Retrieval Queries,offshoreleaks,False,True,False,
What are the company numbers for entities that have 'Defaulted' as their status?,"MATCH (e:Entity {status: 'Defaulted'})
RETURN e.company_number AS CompanyNumber",Complex Retrieval Queries,offshoreleaks,False,False,True,
"What entities are connected to the intermediary 'MICHAEL PAPAGEORGE, MR.'?","MATCH (i:Intermediary {name: 'MICHAEL PAPAGEORGE, MR.'})-[:intermediary_of]->(e:Entity)
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,True,
List all officers from 'South Korea'.,"MATCH (o:Officer {countries: ""South Korea""})
RETURN o",Complex Retrieval Queries,offshoreleaks,False,True,False,
Which intermediaries have 'ACTIVE' as their status?,"MATCH (i:Intermediary {status: 'ACTIVE'})
RETURN i",Complex Retrieval Queries,offshoreleaks,False,False,True,
What are the names of intermediaries located in 'South Africa'?,"MATCH (i:Intermediary {countries: 'South Africa'})
RETURN i.name",Complex Retrieval Queries,offshoreleaks,False,False,False,
Show top 5 entities with addresses in 'Hong Kong'.,"MATCH (e:Entity)-[:registered_address]->(a:Address)
WHERE a.countries = 'Hong Kong'
RETURN e
LIMIT 5",Complex Retrieval Queries,offshoreleaks,False,False,True,
Which entities have 'Mossack Fonseca' as their service provider?,"MATCH (e:Entity {service_provider: 'Mossack Fonseca'})
RETURN e",Complex Retrieval Queries,offshoreleaks,False,True,False,
What are the names of entities struck off on '15-FEB-2013'?,"MATCH (e:Entity {struck_off_date: '15-FEB-2013'})
RETURN e.name",Complex Retrieval Queries,offshoreleaks,False,False,True,
Can you list all entities incorporated on '23-MAR-2006'?,"MATCH (e:Entity {incorporation_date: '23-MAR-2006'})
RETURN e",Complex Retrieval Queries,offshoreleaks,False,True,False,
What are the names of entities with the status 'Defaulted'?,"MATCH (e:Entity {status: 'Defaulted'})
RETURN e.name",Complex Retrieval Queries,offshoreleaks,False,True,False,
Which intermediaries are connected to more than one entity and list their names.,"MATCH (i:Intermediary)-[:intermediary_of]->(e:Entity)
WITH i, count(e) AS numEntities
WHERE numEntities > 1
RETURN i.name AS IntermediaryName",Simple Retrieval Queries,offshoreleaks,False,False,True,
Identify the officers linked to the entity with node id '12174285'.,"MATCH (e:Entity {node_id: 12174285})-[:officer_of]->(o:Officer)
RETURN o",Simple Retrieval Queries,offshoreleaks,False,False,True,
List the entities with a closed date and their closed dates.,"MATCH (e:Entity)
WHERE e.closed_date IS NOT NULL
RETURN e.name, e.closed_date",Simple Retrieval Queries,offshoreleaks,False,False,True,
Who are the officers with the most connections to addresses?,"MATCH (o:Officer)-[:registered_address]->(a:Address)
WITH o, count(a) AS num_addresses
RETURN o.name AS OfficerName, num_addresses
ORDER BY num_addresses DESC",Simple Retrieval Queries,offshoreleaks,False,False,True,
Show entities with a 'same_as' relationship to other entities.,"MATCH (e1:Entity)-[:same_as]->(e2:Entity)
RETURN e1, e2",Complex Retrieval Queries,offshoreleaks,False,False,True,
Find the entities with a tax status description available.,"MATCH (e:Entity)
WHERE e.tax_stat_description IS NOT NULL
RETURN e",Simple Retrieval Queries,offshoreleaks,False,True,False,
Identify entities and their corresponding service providers if their service provider is 'Mossack Fonseca'.,"MATCH (e:Entity)
WHERE e.service_provider = 'Mossack Fonseca'
RETURN e.name, e.service_provider",Simple Retrieval Queries,offshoreleaks,False,False,True,
List the entities with a jurisdiction of 'SAM' and their jurisdiction descriptions.,"MATCH (e:Entity)
WHERE e.jurisdiction = 'SAM'
RETURN e.name, e.jurisdiction_description",Simple Retrieval Queries,offshoreleaks,False,False,True,
What are the top 3 addresses based on their last edit timestamp?,"MATCH (a:Address)
RETURN a.address, a.lastEditTimestamp
ORDER BY a.lastEditTimestamp DESC
LIMIT 3",Simple Retrieval Queries,offshoreleaks,False,False,True,
Find entities by their internal id '1001256'.,"MATCH (e:Entity {internal_id: '1001256'})
RETURN e",Simple Retrieval Queries,offshoreleaks,False,False,True,
Which officers have addresses registered in 'Bahamas'?,"MATCH (o:Officer)-[:registered_address]->(a:Address)
WHERE a.countries = 'Bahamas'
RETURN o.name, a.address",Simple Retrieval Queries,offshoreleaks,False,False,False,
"Identify the intermediaries with the same name as 'MICHAEL PAPAGEORGE, MR.'.","MATCH (i:Intermediary {name: 'MICHAEL PAPAGEORGE, MR.'})
RETURN i",Simple Retrieval Queries,offshoreleaks,False,True,False,
List the entities associated with the 'Bahamas Leaks'.,"MATCH (e:Entity)
WHERE e.sourceID = 'Bahamas Leaks'
RETURN e",Simple Retrieval Queries,offshoreleaks,False,False,True,
What are the country codes for entities that are registered in Samoa?,"MATCH (e:Entity {jurisdiction_description: ""Samoa""})
RETURN e.country_codes",Simple Retrieval Queries,offshoreleaks,False,False,True,
Find the top 5 officers by the number of similar relationships with other officers.,"MATCH (o:Officer)-[r:similar]->(other:Officer)
WITH o, count(r) AS numSimilar
ORDER BY numSimilar DESC
LIMIT 5
RETURN o.name, numSimilar",Simple Retrieval Queries,offshoreleaks,False,False,True,
Which entities have a closed date of '28-NOV-2012' and what are their names?,"MATCH (e:Entity)
WHERE e.closed_date = '28-NOV-2012'
RETURN e.name",Simple Retrieval Queries,offshoreleaks,False,False,True,
Identify the officers that have a country code of 'KOR'.,"MATCH (o:Officer {country_codes: 'KOR'})
RETURN o",Simple Retrieval Queries,offshoreleaks,False,False,True,
List the entities connected to 'Paradise Papers - Appleby'.,"MATCH (e:Entity)-[:connected_to]->(o:Other)
WHERE o.sourceID = 'Paradise Papers - Appleby'
RETURN e",Simple Retrieval Queries,offshoreleaks,False,False,True,
What are the entities with a former name and their former names?,"MATCH (e:Entity)
WHERE e.former_name IS NOT NULL
RETURN e.name AS CurrentName, e.former_name AS FormerName",Simple Retrieval Queries,offshoreleaks,False,False,False,
Which entities have been incorporated in the year 2006?,"MATCH (e:Entity)
WHERE e.incorporation_date CONTAINS '2006'
RETURN e",Simple Retrieval Queries,offshoreleaks,False,False,True,
Which entities are registered at addresses in 'Samoa'?,"MATCH (e:Entity)-[:registered_address]->(a:Address)
WHERE a.countries = 'Samoa'
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,True,
List top 3 entities with the incorporation date '27-MAR-2006'.,"MATCH (e:Entity {incorporation_date: '27-MAR-2006'})
RETURN e
ORDER BY e.node_id
LIMIT 3",Complex Retrieval Queries,offshoreleaks,False,False,False,
Find all the officers who are named 'KIM SOO IN'.,"MATCH (o:Officer {name: 'KIM SOO IN'})
RETURN o",Complex Retrieval Queries,offshoreleaks,False,False,True,
"List the countries associated with the entity 'HOTFOCUS CO., LTD.'.","MATCH (e:Entity {name: ""HOTFOCUS CO., LTD.""})
RETURN e.countries AS Countries",Complex Retrieval Queries,offshoreleaks,False,False,True,
Find entities that were closed on '28-NOV-2012'.,"MATCH (e:Entity)
WHERE e.closed_date = '28-NOV-2012'
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,False,
What is the address of the intermediary with internal_id '10001'?,"MATCH (i:Intermediary {internal_id: '10001'})-[:registered_address]->(a:Address)
RETURN a.address AS Address",Complex Retrieval Queries,offshoreleaks,False,False,True,
List the former and current names of entities with a 'same_name_as' relationship.,"MATCH (e1:Entity)-[:same_name_as]->(e2:Entity)
RETURN e1.name AS CurrentName, e2.name AS FormerName",Complex Retrieval Queries,offshoreleaks,False,False,True,
Which entities are intermediaries of 'Top Games Holdings Inc.'?,"MATCH (i:Intermediary)-[:intermediary_of]->(e:Entity {name: 'Top Games Holdings Inc.'})
RETURN i",Complex Retrieval Queries,offshoreleaks,False,False,True,
Show entities that are connected to 'ANTAM ENTERPRISES N.V.'.,"MATCH (e:Entity {name: 'ANTAM ENTERPRISES N.V.'})-[:connected_to]->(connectedEntities:Entity)
RETURN connectedEntities",Complex Retrieval Queries,offshoreleaks,False,False,True,
What are the node_ids of entities that were incorporated on '10-JAN-2006'?,"MATCH (e:Entity {incorporation_date: '10-JAN-2006'})
RETURN e.node_id",Complex Retrieval Queries,offshoreleaks,False,False,True,
Can you list entities that have a note mentioning 'Closed date stands for Liquidation date.'?,"MATCH (e:Entity)
WHERE e.note = 'Closed date stands for Liquidation date.'
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,False,
Which entities have a 'same_id_as' relationship?,"MATCH (e1:Entity)-[:same_id_as]->(e2:Entity)
RETURN e1, e2",Complex Retrieval Queries,offshoreleaks,False,False,False,
What are the jurisdictions described for entities with country code 'HKG'?,"MATCH (e:Entity {country_codes: 'HKG'})
RETURN DISTINCT e.jurisdiction_description AS JurisdictionDescription",Complex Retrieval Queries,offshoreleaks,False,True,False,
Show the top 5 entities based on their last edit timestamp.,"MATCH (e:Entity)
WHERE e.lastEditTimestamp IS NOT NULL
RETURN e
ORDER BY e.lastEditTimestamp DESC
LIMIT 5",Complex Retrieval Queries,offshoreleaks,False,False,True,
Which entities were inactivated on '27-FEB-2014'?,"MATCH (e:Entity {inactivation_date: '27-FEB-2014'})
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,True,
List the types of companies found in the 'Other' node category.,"MATCH (o:Other)
RETURN DISTINCT o.type",Complex Retrieval Queries,offshoreleaks,False,False,True,
"What are the countries associated with intermediaries named 'MICHAEL PAPAGEORGE, MR.'?","MATCH (i:Intermediary {name: 'MICHAEL PAPAGEORGE, MR.'})
RETURN i.countries AS Countries",Complex Retrieval Queries,offshoreleaks,False,False,False,
Show entities with a 'same_name_as' relationship to 'ANTAM ENTERPRISES N.V.'.,"MATCH (e:Entity {name: ""ANTAM ENTERPRISES N.V.""})-[:same_name_as]->(related:Entity)
RETURN related",Complex Retrieval Queries,offshoreleaks,False,False,False,
Which addresses are similar to 'ORION HOUSE SERVICES (HK) LIMITED ROOM 1401; 14/F.'?,"MATCH (a:Address {address: ""ORION HOUSE SERVICES (HK) LIMITED ROOM 1401; 14/F.""})-[:similar]->(similarAddress:Address)
RETURN similarAddress",Complex Retrieval Queries,offshoreleaks,False,False,True,
Find all officers connected to entities with a jurisdiction of 'SAM'.,"MATCH (o:Officer)-[:officer_of]->(e:Entity {jurisdiction: 'SAM'})
RETURN o",Complex Retrieval Queries,offshoreleaks,False,False,False,
"List the entities that have 'NINGBO SUNRISE ENTERPRISES UNITED CO., LTD.' as their original name.","MATCH (e:Entity {original_name: 'NINGBO SUNRISE ENTERPRISES UNITED CO., LTD.'})
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,False,
What are the former names of entities that have 'Defaulted' as their status?,"MATCH (e:Entity {status: 'Defaulted'})
WHERE e.former_name IS NOT NULL
RETURN e.former_name",Complex Retrieval Queries,offshoreleaks,False,False,True,
Can you show entities that have been struck off on '15-FEB-2014'?,"MATCH (e:Entity {struck_off_date: '15-FEB-2014'})
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,True,
Which entities share the same company as 'Top Games Holdings Inc.'?,"MATCH (e:Entity {name: 'Top Games Holdings Inc.'})-[:same_company_as]->(sameCompany:Entity)
RETURN sameCompany",Complex Retrieval Queries,offshoreleaks,False,False,True,
List all entities with a 'registered_address' relationship to the address node_id 14048584.,"MATCH (e:Entity)-[:registered_address]->(a:Address {node_id: 14048584})
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,True,
What is the original name of the entity with ibcRUC '25221'?,"MATCH (e:Entity {ibcRUC: '25221'})
RETURN e.original_name",Complex Retrieval Queries,offshoreleaks,False,False,False,
Show all officers of the entity with node_id 12160432.,"MATCH (o:Officer)-[:officer_of]->(e:Entity {node_id: 12160432})
RETURN o",Complex Retrieval Queries,offshoreleaks,False,False,True,
"What are the country codes associated with the address 'ANNEX FREDERICK & SHIRLEY STS, P.O. BOX N-4805, NA'?","MATCH (a:Address {address: 'ANNEX FREDERICK & SHIRLEY STS, P.O. BOX N-4805, NA'})
RETURN a.country_codes",Complex Retrieval Queries,offshoreleaks,False,False,True,
Can you list the names of entities with multiple relationships types like 'same_as' and 'registered_address'?,"MATCH (e:Entity)
WHERE exists {
  (e)-[:same_as]->(:Entity)
} AND exists {
  (e)-[:registered_address]->(:Address)
}
RETURN e.name",Complex Retrieval Queries,offshoreleaks,False,False,True,
Which entities have an inactivation date of '18-FEB-2013'?,"MATCH (e:Entity {inactivation_date: '18-FEB-2013'})
RETURN e",Complex Retrieval Queries,offshoreleaks,False,True,False,
Can you list all officers with a 'probably_same_officer_as' relationship?,"MATCH (o1:Officer)-[:same_id_as]->(o2:Officer)
RETURN o1, o2",Complex Retrieval Queries,offshoreleaks,False,False,True,
What addresses are registered to entities in the 'Panama Papers'?,"MATCH (e:Entity)-[:registered_address]->(a:Address)
WHERE e.sourceID = 'Panama Papers'
RETURN a",Complex Retrieval Queries,offshoreleaks,False,False,True,
"Which entities have the same company type as 'NINGBO SUNRISE ENTERPRISES UNITED CO., LTD.'?","MATCH (e1:Entity {name: 'NINGBO SUNRISE ENTERPRISES UNITED CO., LTD.'})
MATCH (e2:Entity)
WHERE e1.company_type IS NOT NULL AND e2.company_type = e1.company_type AND e1 <> e2
RETURN e2",Complex Retrieval Queries,offshoreleaks,False,True,False,
What officers are shareholders of entities incorporated on '10-JAN-2006'?,"MATCH (o:Officer)-[r:officer_of]->(e:Entity)
WHERE e.incorporation_date = '10-JAN-2006' AND r.link = 'shareholder of'
RETURN o",Complex Retrieval Queries,offshoreleaks,False,False,True,
Identify entities that have an original name different from their current name and provide both names.,"MATCH (e:Entity)
WHERE e.original_name IS NOT NULL AND e.name IS NOT NULL AND e.original_name <> e.name
RETURN e.name AS CurrentName, e.original_name AS OriginalName",Complex Retrieval Queries,offshoreleaks,False,False,False,
Provide names of entities that were struck off on '15-FEB-2013'.,"MATCH (e:Entity {struck_off_date: '15-FEB-2013'})
RETURN e.name",Complex Retrieval Queries,offshoreleaks,False,False,True,
List all entities with their incorporation dates between 2005 and 2010.,"MATCH (e:Entity)
WHERE e.incorporation_date >= '01-JAN-2005' AND e.incorporation_date <= '31-DEC-2010'
RETURN e",Pathfinding Queries,offshoreleaks,False,False,True,
What are the names of entities incorporated in Samoa?,"MATCH (e:Entity {jurisdiction_description: ""Samoa""})
RETURN e.name",Pathfinding Queries,offshoreleaks,False,False,True,
How many entities have been struck off on '15-FEB-2013'?,"MATCH (e:Entity {struck_off_date: '15-FEB-2013'})
RETURN count(e) AS StruckOffEntitiesCount",Pathfinding Queries,offshoreleaks,False,False,True,
Identify entities that have 'Mossack Fonseca' as their service provider.,"MATCH (e:Entity {service_provider: 'Mossack Fonseca'})
RETURN e",Pathfinding Queries,offshoreleaks,False,False,False,
Which entities have a 'HKG' country code?,"MATCH (e:Entity {country_codes: 'HKG'})
RETURN e",Pathfinding Queries,offshoreleaks,False,False,True,
Can you list entities that were inactivated in February 2014?,"MATCH (e:Entity)
WHERE e.inactivation_date STARTS WITH 'FEB-2014'
RETURN e",Pathfinding Queries,offshoreleaks,False,False,False,
What are the names of intermediaries located in South Africa?,"MATCH (i:Intermediary {countries: ""South Africa""})
RETURN i.name",Pathfinding Queries,offshoreleaks,False,True,False,
List all officers with the country code 'KOR'.,"MATCH (o:Officer {country_codes: 'KOR'})
RETURN o",Pathfinding Queries,offshoreleaks,False,False,True,
What addresses are registered in the Bahamas?,"MATCH (a:Address)
WHERE a.countries = 'Bahamas'
RETURN a",Pathfinding Queries,offshoreleaks,False,False,True,
How many entities are connected to the address with node_id 24000001?,"MATCH (a:Address {node_id: 24000001})<--(e:Entity)
RETURN count(e) AS NumberOfConnectedEntities",Pathfinding Queries,offshoreleaks,False,False,True,
List entities that are the same as entity with node_id 10000001.,"MATCH (e1:Entity {node_id: 10000001})-[:same_as]->(e2:Entity)
RETURN e2",Pathfinding Queries,offshoreleaks,False,False,True,
Which entities are served by the intermediary with node_id 11000001?,"MATCH (i:Intermediary {node_id: 11000001})-[:intermediary_of]->(e:Entity)
RETURN e",Pathfinding Queries,offshoreleaks,False,False,True,
List all entities that share the same name as officer with node_id 12000001.,"MATCH (o:Officer {node_id: 12000001})-[:same_name_as]->(e:Entity)
RETURN e",Pathfinding Queries,offshoreleaks,False,False,True,
Which entities have a status of 'Defaulted'?,"MATCH (e:Entity {status: 'Defaulted'})
RETURN e",Pathfinding Queries,offshoreleaks,False,False,True,
Which officers are involved with the entity having node_id 10000002?,"MATCH (o:Officer)-[:officer_of]->(e:Entity {node_id: 10000002})
RETURN o",Pathfinding Queries,offshoreleaks,False,False,True,
How many entities are connected to the officer with node_id 12000001?,"MATCH (o:Officer {node_id: 12000001})-[:officer_of]->(e:Entity)
RETURN count(e) AS NumberOfConnectedEntities",Pathfinding Queries,offshoreleaks,False,True,False,
List the entities with a jurisdiction description of 'Samoa'.,"MATCH (e:Entity)
WHERE e.jurisdiction_description = 'Samoa'
RETURN e",Pathfinding Queries,offshoreleaks,False,False,False,
Which entities have an incorporation date of '23-MAR-2006'?,"MATCH (e:Entity {incorporation_date: '23-MAR-2006'})
RETURN e",Pathfinding Queries,offshoreleaks,False,False,False,
List all officers that have an address in South Korea.,"MATCH (o:Officer)-[:registered_address]->(a:Address)
WHERE a.countries = 'South Korea'
RETURN o",Pathfinding Queries,offshoreleaks,False,False,True,
"Find entities that have 'NINGBO SUNRISE ENTERPRISES UNITED CO., LTD.' as their original name.","MATCH (e:Entity {original_name: 'NINGBO SUNRISE ENTERPRISES UNITED CO., LTD.'})
RETURN e",Pathfinding Queries,offshoreleaks,False,True,False,
"Which intermediary has the name 'MICHAEL PAPAGEORGE, MR.'?","MATCH (i:Intermediary {name: 'MICHAEL PAPAGEORGE, MR.'})
RETURN i",Pathfinding Queries,offshoreleaks,False,False,False,
List the names of entities that were defaulted before 2014.,"MATCH (e:Entity)
WHERE e.status = 'Defaulted' AND e.inactivation_date < '01-JAN-2014'
RETURN e.name",Pathfinding Queries,offshoreleaks,False,False,True,
List entities with their service providers and incorporation dates.,"MATCH (e:Entity)
RETURN e.name AS EntityName, e.service_provider AS ServiceProvider, e.incorporation_date AS IncorporationDate",Pathfinding Queries,offshoreleaks,False,False,True,
Which entities are linked to the address with original_address starting with 'ANNEX FREDERICK'?,"MATCH (a:Address {original_address: 'ANNEX FREDERICK & SHIRLEY STS, P. O. BOX N-4805 NA'})-[:registered_address]-(e:Entity)
RETURN e",Pathfinding Queries,offshoreleaks,False,True,False,
Identify entities with closed dates in November 2012.,"MATCH (e:Entity)
WHERE e.closed_date STARTS WITH ""NOV-2012""
RETURN e",Pathfinding Queries,offshoreleaks,False,True,False,
What are the names of entities with a struck off date in February 2013?,"MATCH (e:Entity)
WHERE e.struck_off_date STARTS WITH '15-FEB-2013' OR e.struck_off_date STARTS WITH '18-FEB-2013'
RETURN e.name",Pathfinding Queries,offshoreleaks,False,False,False,
List entities that have changed their names and provide the former and current names.,"MATCH (e:Entity)
WHERE e.former_name IS NOT NULL AND e.name IS NOT NULL
RETURN e.node_id AS EntityID, e.former_name AS FormerName, e.name AS CurrentName",Pathfinding Queries,offshoreleaks,False,True,False,
Who are the officers connected to the entity with node_id 10000004?,"MATCH (e:Entity {node_id: 10000004})-[:officer_of]->(o:Officer)
RETURN o.name AS OfficerName, o.node_id AS OfficerNodeID",Pathfinding Queries,offshoreleaks,False,True,False,
What are the registered addresses of entities in Hong Kong?,"MATCH (e:Entity)-[:registered_address]->(a:Address)
WHERE e.countries = ""Hong Kong""
RETURN e.name, a.address",Pathfinding Queries,offshoreleaks,False,False,True,
List the intermediaries that have an active status.,"MATCH (i:Intermediary {status: 'ACTIVE'})
RETURN i",Pathfinding Queries,offshoreleaks,False,False,True,
List the officers that are connected to entities with a node_id greater than '12000000'.,"MATCH (o:Officer)-[:officer_of]->(e:Entity)
WHERE e.node_id > 12000000
RETURN o",Simple Aggregation Queries,offshoreleaks,False,False,False,
Which entities and intermediaries have the same country codes?,"MATCH (e:Entity), (i:Intermediary)
WHERE e.country_codes = i.country_codes AND e.country_codes IS NOT NULL
RETURN e, i",Simple Aggregation Queries,offshoreleaks,False,False,True,
List the intermediaries with a registered office in 'MICHAEL PAPAGEORGE; MR. 106 NICHOLSON STREET BROOK'.,"MATCH (i:Intermediary)-[:registered_address]->(a:Address)
WHERE a.address = 'MICHAEL PAPAGEORGE; MR. 106 NICHOLSON STREET BROOK'
RETURN i",Simple Aggregation Queries,offshoreleaks,False,True,False,
Which officers have a valid until date through 2015?,"MATCH (o:Officer)
WHERE o.valid_until = ""The Panama Papers data is current through 2015""
RETURN o",Simple Aggregation Queries,offshoreleaks,False,False,True,
Show entities that have a company type specified.,"MATCH (e:Entity)
WHERE e.company_type IS NOT NULL
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,True,
List all entities with a dorm date listed.,"MATCH (e:Entity)
WHERE e.dorm_date IS NOT NULL
RETURN e",Simple Aggregation Queries,offshoreleaks,False,True,False,
What are the top 5 entities with the most recent incorporation dates?,"MATCH (e:Entity)
WHERE e.incorporation_date IS NOT NULL
RETURN e
ORDER BY e.incorporation_date DESC
LIMIT 5",Simple Aggregation Queries,offshoreleaks,False,False,False,
Show the entities connected to 'ORION HOUSE SERVICES (HK) LIMITED ROOM 1401; 14/F.',"MATCH (a:Address {address: ""ORION HOUSE SERVICES (HK) LIMITED ROOM 1401; 14/F.""})-[:registered_address]-(e:Entity)
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,True,
List entities that are connected to intermediaries based in South Africa.,"MATCH (i:Intermediary)-[:intermediary_of]->(e:Entity)
WHERE i.countries = 'South Africa'
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,True,
Which entities have a different former name and current name?,"MATCH (e:Entity)
WHERE e.former_name IS NOT NULL AND e.name IS NOT NULL AND e.former_name <> e.name
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,True,
Show the top 5 officers by last edit timestamp.,"MATCH (o:Officer)
WHERE o.lastEditTimestamp IS NOT NULL
RETURN o
ORDER BY o.lastEditTimestamp DESC
LIMIT 5",Simple Aggregation Queries,offshoreleaks,False,True,False,
List the entities with a jurisdiction code of 'SAM'.,"MATCH (e:Entity {jurisdiction: 'SAM'})
RETURN e",Simple Aggregation Queries,offshoreleaks,False,True,False,
Which entities have a service provider listed as 'Mossack Fonseca'?,"MATCH (e:Entity {service_provider: 'Mossack Fonseca'})
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,False,
Show the entities that are connected to addresses with the ICIJ ID 'F969D23B2EDF91CAEBE119A675B61AAB'.,"MATCH (a:Address {icij_id: 'F969D23B2EDF91CAEBE119A675B61AAB'})-[:registered_address]-(e:Entity)
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,False,
List all entities with a note about their status.,"MATCH (e:Entity)
WHERE e.note IS NOT NULL
RETURN e.name, e.note",Simple Aggregation Queries,offshoreleaks,False,False,True,
Show the top 5 entities that were last edited before '1638311040000'.,"MATCH (e:Entity)
WHERE e.lastEditTimestamp < '1638311040000'
RETURN e
ORDER BY e.lastEditTimestamp DESC
LIMIT 5",Simple Aggregation Queries,offshoreleaks,False,True,False,
What are the countries codes associated with officers in the dataset?,"MATCH (o:Officer)
WHERE o.country_codes IS NOT NULL
RETURN DISTINCT o.country_codes AS CountryCodes",Simple Aggregation Queries,offshoreleaks,False,False,True,
List the intermediaries that are connected to entities with a status of 'Defaulted'.,"MATCH (i:Intermediary)-[:intermediary_of]->(e:Entity {status: 'Defaulted'})
RETURN i",Simple Aggregation Queries,offshoreleaks,False,False,True,
Which officers have been involved with entities since 1999?,"MATCH (o:Officer)-[r:officer_of]->(e:Entity)
WHERE r.start_date >= '1999-01-01'
RETURN o.name AS OfficerName, e.name AS EntityName, r.start_date AS StartDate",Simple Aggregation Queries,offshoreleaks,False,False,True,
Show the entities that have the same id as another entity.,"MATCH (e1:Entity)-[r:same_id_as]->(e2:Entity)
RETURN e1, r, e2",Simple Aggregation Queries,offshoreleaks,False,False,False,
List the entities that have been connected to other entities through the 'connected to' relationship.,"MATCH (e1:Entity)-[:connected_to]->(e2:Entity)
RETURN e1, e2",Simple Aggregation Queries,offshoreleaks,False,False,True,
Which entities and officers share the same name?,"MATCH (e:Entity)-[:same_name_as]->(o:Officer)
RETURN e, o",Simple Aggregation Queries,offshoreleaks,False,False,True,
Show the entities that have been struck off but have a different inactivation date.,"MATCH (e:Entity)
WHERE e.struck_off_date IS NOT NULL AND e.inactivation_date IS NOT NULL AND e.struck_off_date <> e.inactivation_date
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,True,
List the addresses that have been used for more than one entity.,"MATCH (a:Address)<-[:registered_address]-(e:Entity)
WITH a, count(e) AS numEntities
WHERE numEntities > 1
RETURN a",Simple Aggregation Queries,offshoreleaks,False,False,True,
What are the top 5 most recent entities by incorporation date?,"MATCH (e:Entity)
WHERE e.incorporation_date IS NOT NULL
RETURN e
ORDER BY e.incorporation_date DESC
LIMIT 5",Simple Aggregation Queries,offshoreleaks,False,False,False,
Show the intermediaries with the most connections to entities.,"MATCH (i:Intermediary)-[:intermediary_of]->(e:Entity)
RETURN i.name, count(e) AS connections
ORDER BY connections DESC",Simple Aggregation Queries,offshoreleaks,False,False,False,
List the entities with a jurisdiction description that matches their country codes.,"MATCH (e:Entity)
WHERE e.jurisdiction_description = e.country_codes
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,False,
Which entities have changed their name from their original name?,"MATCH (e:Entity)
WHERE e.name IS NOT NULL AND e.original_name IS NOT NULL AND e.name <> e.original_name
RETURN e.name AS CurrentName, e.original_name AS OriginalName",Simple Aggregation Queries,offshoreleaks,False,True,False,
Show the nodes that have a type of 'SOLE OWNERSHIP'.,"MATCH (n:Other {type: 'SOLE OWNERSHIP'})
RETURN n",Simple Aggregation Queries,offshoreleaks,False,False,True,
List the entities that have undergone liquidation as per their notes.,"MATCH (e:Entity)
WHERE e.note = 'Closed date stands for Liquidation date.'
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,True,
Show the top 5 entities sorted by their node_id.,"MATCH (e:Entity)
RETURN e
ORDER BY e.node_id DESC
LIMIT 5",Simple Aggregation Queries,offshoreleaks,False,False,True,
Which officers are linked as 'Nominee Shareholder of' with entities?,"MATCH (o:Officer)-[r:officer_of]->(e:Entity)
WHERE r.link = 'Nominee Shareholder of'
RETURN o AS Officer, e AS Entity",Pathfinding Queries,offshoreleaks,False,False,False,
Which entities are under the same company as entity with node_id 10000001?,"MATCH (e:Entity {node_id: 10000001})-[:same_company_as]->(sameCompany:Entity)
RETURN sameCompany",Pathfinding Queries,offshoreleaks,False,True,False,
Which addresses have the status 'active'?,"MATCH (a:Address)
WHERE a.status = 'ACTIVE'
RETURN a",Pathfinding Queries,offshoreleaks,False,True,False,Address.status
Identify entities that have been struck off after 2010 and list their node_ids.,"MATCH (e:Entity)
WHERE e.struck_off_date >= '01-JAN-2011' AND e.struck_off_date IS NOT NULL
RETURN e.node_id",Pathfinding Queries,offshoreleaks,False,False,False,
List all entities that have a closed date and their type.,"MATCH (e:Entity)
WHERE e.closed_date IS NOT NULL AND e.type IS NOT NULL
RETURN e.name, e.closed_date, e.type",Pathfinding Queries,offshoreleaks,False,False,True,
Which entities have a type of 'FOREIGN FORMED CORPORATION'?,"MATCH (e:Entity {type: 'FOREIGN FORMED CORPORATION'})
RETURN e",Pathfinding Queries,offshoreleaks,False,True,False,
Identify entities with multiple statuses and list the statuses.,"MATCH (e:Entity)
WITH e.name AS entityName, collect(e.status) AS statuses
WHERE size(statuses) > 1
RETURN entityName, statuses",Pathfinding Queries,offshoreleaks,False,False,False,
Which officers have served as 'Nominee Director of' for entities?,"MATCH (o:Officer)-[r:officer_of]->(e:Entity)
WHERE r.link = 'Nominee Director of'
RETURN o.name AS OfficerName, e.name AS EntityName",Pathfinding Queries,offshoreleaks,False,False,False,
List all entities with a last edit timestamp of '1638311020926'.,"MATCH (e:Entity)
WHERE e.lastEditTimestamp = '1638311020926'
RETURN e",Pathfinding Queries,offshoreleaks,False,False,True,
Which entities have a node_id less than 80000012 and their names?,"MATCH (e:Entity)
WHERE e.node_id < 80000012
RETURN e.node_id, e.name",Pathfinding Queries,offshoreleaks,False,False,True,
Identify all officers with a status of 'ACTIVE'.,"MATCH (o:Officer {status: 'ACTIVE'})
RETURN o",Pathfinding Queries,offshoreleaks,False,False,True,Officer.status
List entities that share the same jurisdiction as 'SAM' and their names.,"MATCH (e:Entity {jurisdiction: 'SAM'})
RETURN e.name",Pathfinding Queries,offshoreleaks,False,False,False,
Identify entities with a valid until date and their respective incorporation dates.,"MATCH (e:Entity)
WHERE e.valid_until IS NOT NULL AND e.incorporation_date IS NOT NULL
RETURN e.name, e.valid_until, e.incorporation_date",Pathfinding Queries,offshoreleaks,False,False,True,
Which entities have an address in 'KOWLOON; HONG KONG'?,"MATCH (e:Entity)-[:registered_address]->(a:Address)
WHERE a.address = 'KOWLOON; HONG KONG'
RETURN e",Pathfinding Queries,offshoreleaks,False,False,True,
List all officers connected to the address with node_id 24000001.,"MATCH (a:Address {node_id: 24000001})<-[:registered_address]-(o:Officer)
RETURN o",Pathfinding Queries,offshoreleaks,False,False,True,
Identify entities that have been both registered and struck off in Samoa.,"MATCH (e:Entity)
WHERE e.jurisdiction_description = 'Samoa' AND e.incorporation_date IS NOT NULL AND e.struck_off_date IS NOT NULL
RETURN e",Pathfinding Queries,offshoreleaks,False,False,True,
List the registered addresses for entities that were incorporated in March 2006.,"MATCH (e:Entity {incorporation_date: ""23-MAR-2006""})-[:registered_address]->(a:Address)
RETURN e.name AS EntityName, a.address AS RegisteredAddress",Pathfinding Queries,offshoreleaks,False,False,False,
Which entities are connected to the officer with icij_id 'CB195B5424E13A74A6F3BC719050A2B9'?,"MATCH (o:Officer {icij_id: 'CB195B5424E13A74A6F3BC719050A2B9'})-[:officer_of]->(e:Entity)
RETURN e",Pathfinding Queries,offshoreleaks,False,False,True,
Who are the officers with the former name 'MOSSFON SUBSCRIBERS LTD.' and their current names?,"MATCH (o:Officer {former_name: 'MOSSFON SUBSCRIBERS LTD.'})
RETURN o.name AS CurrentName",Pathfinding Queries,offshoreleaks,False,False,False,Officer.former_name
List all intermediaries that have been registered at more than one address.,"MATCH (i:Intermediary)-[:registered_address]->(a:Address)
WITH i, count(a) AS numAddresses
WHERE numAddresses > 1
RETURN i.name AS IntermediaryName, numAddresses",Pathfinding Queries,offshoreleaks,False,False,False,
Which officers are connected to entities with a struck off date of '15-FEB-2013'?,"MATCH (o:Officer)-[:officer_of]->(e:Entity {struck_off_date: '15-FEB-2013'})
RETURN o",Pathfinding Queries,offshoreleaks,False,True,False,
Identify entities that share the same company number and list their names.,"MATCH (e1:Entity)-[:same_company_as]-(e2:Entity)
RETURN e1.name AS Entity1, e2.name AS Entity2",Pathfinding Queries,offshoreleaks,False,False,False,
List all addresses that have been registered to more than one entity.,"MATCH (a:Address)<-[:registered_address]-(e:Entity)
WITH a, count(e) AS numEntities
WHERE numEntities > 1
RETURN a",Pathfinding Queries,offshoreleaks,False,True,False,
Which officers have a note mentioning a liquidation date?,"MATCH (o:Officer)
WHERE o.note CONTAINS 'Liquidation date'
RETURN o",Pathfinding Queries,offshoreleaks,False,False,True,
Identify all 'Other' nodes with a jurisdiction of 'AW' and their types.,"MATCH (o:Other {jurisdiction: 'AW'})
RETURN o.node_id, o.name, o.type",Pathfinding Queries,offshoreleaks,False,False,True,
List entities that have a company type of 'SOLE OWNERSHIP' and their incorporation dates.,"MATCH (e:Entity {company_type: 'SOLE OWNERSHIP'})
WHERE e.incorporation_date IS NOT NULL
RETURN e.name, e.incorporation_date",Pathfinding Queries,offshoreleaks,False,False,False,
Which entities have a sourceID of 'Panama Papers' and a company number?,"MATCH (e:Entity)
WHERE e.sourceID = 'Panama Papers' AND e.company_number IS NOT NULL
RETURN e",Pathfinding Queries,offshoreleaks,False,True,False,
List all officers and their respective last edit timestamps that are associated with entities.,"MATCH (o:Officer)-[:officer_of]->(e:Entity)
RETURN o.name, o.lastEditTimestamp",Pathfinding Queries,offshoreleaks,False,True,False,
Identify entities that are connected to more than one officer.,"MATCH (e:Entity)-[:officer_of]->(o:Officer)
WITH e, count(o) AS numOfficers
WHERE numOfficers > 1
RETURN e",Pathfinding Queries,offshoreleaks,False,False,True,
Which entities have a service provider of 'Mossack Fonseca' and are still active?,"MATCH (e:Entity)
WHERE e.service_provider = 'Mossack Fonseca' AND e.status = 'Active'
RETURN e",Pathfinding Queries,offshoreleaks,False,False,True,
List all entities that have a struck off date of '15-FEB-2014' and their jurisdictions.,"MATCH (e:Entity)
WHERE e.struck_off_date = '15-FEB-2014'
RETURN e.name, e.jurisdiction",Pathfinding Queries,offshoreleaks,False,False,True,
List entities with a jurisdiction description of 'Aruba' and their respective jurisdictions.,"MATCH (e:Entity)
WHERE e.jurisdiction_description = 'Aruba'
RETURN e.name, e.jurisdiction",Pathfinding Queries,offshoreleaks,False,False,True,
Who are the officers of entities that were inactivated in February 2012?,"MATCH (o:Officer)-[:officer_of]->(e:Entity)
WHERE e.inactivation_date STARTS WITH 'FEB-2012'
RETURN o.name AS OfficerName, e.name AS EntityName, e.inactivation_date AS InactivationDate",Complex Retrieval Queries,offshoreleaks,False,False,True,
Which entities and officers share the same country code 'WSM'?,"MATCH (e:Entity)
WHERE e.country_codes = 'WSM'
WITH e
MATCH (o:Officer)
WHERE o.country_codes = 'WSM'
RETURN e, o",Pathfinding Queries,offshoreleaks,False,True,False,
Identify all addresses connected to entities and their link types.,"MATCH (e:Entity)-[r:registered_address]->(a:Address)
RETURN e, r, a",Pathfinding Queries,offshoreleaks,False,True,False,
List all officers who are also registered as entities.,"MATCH (o:Officer)-[:officer_of]->(e:Entity)
WHERE exists{(o)-[:same_name_as]->(e)}
RETURN o, e",Pathfinding Queries,offshoreleaks,False,True,False,
Identify other nodes with type 'LIMITED LIABILITY COMPANY'.,"MATCH (o:Other {type: 'LIMITED LIABILITY COMPANY'})
RETURN o",Pathfinding Queries,offshoreleaks,False,False,True,
List all entities and their respective service providers that were inactivated on '18-FEB-2013'.,"MATCH (e:Entity)
WHERE e.inactivation_date = '18-FEB-2013'
RETURN e.name AS EntityName, e.service_provider AS ServiceProvider",Pathfinding Queries,offshoreleaks,False,True,False,
Which entities have a note indicating a liquidation date?,"MATCH (e:Entity)
WHERE e.note CONTAINS 'Liquidation date'
RETURN e",Pathfinding Queries,offshoreleaks,False,False,True,
List the entities with jurisdiction 'SAM' and their respective company types.,"MATCH (e:Entity {jurisdiction: 'SAM'})
WHERE e.company_type IS NOT NULL
RETURN e.name, e.company_type",Pathfinding Queries,offshoreleaks,False,False,False,
Identify all officers who have a sourceID of 'Panama Papers' and are connected to an entity.,"MATCH (o:Officer)-[:officer_of]->(e:Entity)
WHERE o.sourceID = 'Panama Papers'
RETURN o, e",Pathfinding Queries,offshoreleaks,False,False,True,
Which officers have been officers of more than one entity?,"MATCH (o:Officer)-[r:officer_of]->(e:Entity)
WITH o, count(DISTINCT e) AS numEntities
WHERE numEntities > 1
RETURN o.name, numEntities",Pathfinding Queries,offshoreleaks,False,True,False,
Identify entities with their last edit timestamp and those that have been struck off.,"MATCH (e:Entity)
WHERE e.lastEditTimestamp IS NOT NULL AND e.struck_off_date IS NOT NULL
RETURN e.name, e.lastEditTimestamp, e.struck_off_date",Pathfinding Queries,offshoreleaks,False,False,False,
Find all addresses with the country code 'BHS' and list their associated entities.,"MATCH (a:Address {country_codes: 'BHS'})-[:registered_address]-(e:Entity)
RETURN a, e",Pathfinding Queries,offshoreleaks,False,False,False,
Which entities have a valid until date of 'The Panama Papers data is current through 2015'?,"MATCH (e:Entity)
WHERE e.valid_until = 'The Panama Papers data is current through 2015'
RETURN e",Pathfinding Queries,offshoreleaks,False,True,False,
List all intermediaries with a registered address in the 'Bahamas'.,"MATCH (i:Intermediary)-[:registered_address]->(a:Address)
WHERE a.countries = 'Bahamas'
RETURN i",Pathfinding Queries,offshoreleaks,False,True,False,
Which entities have been involved with any type of 'Nominee' relationship?,"MATCH (e:Entity)-[r]->()
WHERE r.link CONTAINS 'Nominee'
RETURN e",Pathfinding Queries,offshoreleaks,False,True,False,
Identify the officers with the last name 'SOO' and list their associated entities.,"MATCH (o:Officer)-[:officer_of]->(e:Entity)
WHERE o.name CONTAINS ' SOO'
RETURN o.name AS OfficerName, e.name AS EntityName",Pathfinding Queries,offshoreleaks,False,False,True,
List all entities that have a struck off date and their last known status.,"MATCH (e:Entity)
WHERE e.struck_off_date IS NOT NULL
RETURN e.name, e.struck_off_date, e.status",Pathfinding Queries,offshoreleaks,False,False,False,
Who are the officers that share the same name as entity with node_id 10000002?,"MATCH (e:Entity {node_id: 10000002})-[:same_name_as]->(o:Officer)
RETURN o.name AS OfficerName, o.node_id AS OfficerNodeId",Pathfinding Queries,offshoreleaks,False,False,True,
Which entities have a similar name and address as the entity with node_id 10000004?,"MATCH (e1:Entity {node_id: 10000004})-[:similar]->(e2:Entity)
RETURN e2",Pathfinding Queries,offshoreleaks,False,False,True,
List entities that have a former name and their current names.,"MATCH (e:Entity)
WHERE e.former_name IS NOT NULL
RETURN e.name AS CurrentName, e.former_name AS FormerName",Pathfinding Queries,offshoreleaks,False,True,False,
Identify all officers with a node_id greater than 12000000.,"MATCH (o:Officer)
WHERE o.node_id > 12000000
RETURN o",Pathfinding Queries,offshoreleaks,False,False,False,
Which entities have a tax status description available?,"MATCH (e:Entity)
WHERE e.tax_stat_description IS NOT NULL
RETURN e",Pathfinding Queries,offshoreleaks,False,False,False,
List all 'Other' nodes connected to entities and their connection types.,"MATCH (o:Other)-[r:connected_to]->(e:Entity)
RETURN o, r, e",Pathfinding Queries,offshoreleaks,False,False,True,
Which entities are involved with 'Paradise Papers - Aruba corporate registry'?,"MATCH (e:Entity)-[r:connected_to]->(:Other {sourceID: 'Paradise Papers - Aruba corporate registry'})
RETURN e, r",Pathfinding Queries,offshoreleaks,False,True,False,
Identify entities with multiple addresses and list the addresses.,"MATCH (e:Entity)-[:registered_address]->(a:Address)
WITH e, count(a) AS numAddresses, collect(a.address) AS addresses
WHERE numAddresses > 1
RETURN e.name AS EntityName, addresses",Pathfinding Queries,offshoreleaks,False,False,True,
List officers who have a direct connection to entities incorporated in 2006.,"MATCH (o:Officer)-[:officer_of]->(e:Entity {incorporation_date: ""23-MAR-2006""})
RETURN o",Pathfinding Queries,offshoreleaks,False,False,True,
Find entities that have been both struck off and inactivated in the same year.,"MATCH (e:Entity)
WHERE e.struck_off_date IS NOT NULL AND e.inactivation_date IS NOT NULL
  AND substring(e.struck_off_date, 7) = substring(e.inactivation_date, 7)
RETURN e",Pathfinding Queries,offshoreleaks,False,False,True,
Which entities are registered at the same address as the officer with node_id 12000001?,"MATCH (o:Officer {node_id: 12000001})-[:registered_address]->(a:Address)
MATCH (e:Entity)-[:registered_address]->(a)
RETURN e",Pathfinding Queries,offshoreleaks,False,False,False,
List entities that are similar in name to 'Top Games Holdings Inc.' and their incorporation dates.,"MATCH (e:Entity)-[:same_name_as]->(similar:Entity {name: 'Top Games Holdings Inc.'})
RETURN e.name AS EntityName, e.incorporation_date AS IncorporationDate",Pathfinding Queries,offshoreleaks,False,True,False,
Identify the officers connected to the intermediary with node_id 11000001.,"MATCH (i:Intermediary {node_id: 11000001})-[:intermediary_of]->(e:Entity)<-[:officer_of]-(o:Officer)
RETURN o",Pathfinding Queries,offshoreleaks,False,False,True,
List all intermediaries and their associated entities based on the relationship 'intermediary_of'.,"MATCH (i:Intermediary)-[r:intermediary_of]->(e:Entity)
RETURN i, r, e",Pathfinding Queries,offshoreleaks,False,False,True,
Which entities have an inactivation date of '27-FEB-2014'?,"MATCH (e:Entity {inactivation_date: '27-FEB-2014'})
RETURN e",Pathfinding Queries,offshoreleaks,False,False,True,
Show the top 5 entities by last edit timestamp.,"MATCH (e:Entity)
RETURN e
ORDER BY e.lastEditTimestamp DESC
LIMIT 5",Simple Aggregation Queries,offshoreleaks,False,False,True,
Which entities have an incorporation date exactly on '23-MAR-2006'?,"MATCH (e:Entity {incorporation_date: '23-MAR-2006'})
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,False,
"Which entities have an address in Tsim Sha Tsui, Kowloon, Hong Kong?","MATCH (e:Entity)-[:registered_address]->(a:Address)
WHERE a.address CONTAINS ""Tsim Sha Tsui, Kowloon, Hong Kong""
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,True,
Show the entities that have a company number listed.,"MATCH (e:Entity)
WHERE e.company_number IS NOT NULL
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,False,
Which officers are connected to entities that were incorporated on '23-MAR-2006'?,"MATCH (o:Officer)-[:officer_of]->(e:Entity {incorporation_date: '23-MAR-2006'})
RETURN o",Complex Retrieval Queries,offshoreleaks,False,False,False,
List the names of entities with a service provider of 'Mossack Fonseca' and a jurisdiction of 'SAM'.,"MATCH (e:Entity)
WHERE e.service_provider = 'Mossack Fonseca' AND e.jurisdiction = 'SAM'
RETURN e.name",Complex Retrieval Queries,offshoreleaks,False,True,False,
What are the names of officers who have 'E72326DEA50F1A9C2876E112AAEB42BC' as their icij_id?,"MATCH (o:Officer {icij_id: 'E72326DEA50F1A9C2876E112AAEB42BC'})
RETURN o.name",Complex Retrieval Queries,offshoreleaks,False,False,True,
Which entities have a closed date exactly on '28-NOV-2012'?,"MATCH (e:Entity)
WHERE e.closed_date = '28-NOV-2012'
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,True,
List entities that have undergone a company type change from the original registration.,"MATCH (e:Entity)
WHERE EXISTS {
    (e)-[:same_company_as]->(e2:Entity)
    WHERE e.company_type IS NOT NULL AND e2.company_type IS NOT NULL AND e.company_type <> e2.company_type
}
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,True,
What officers are connected to entities with a struck off date on '15-FEB-2009'?,"MATCH (o:Officer)-[:officer_of]->(e:Entity {struck_off_date: '15-FEB-2009'})
RETURN o",Complex Retrieval Queries,offshoreleaks,False,False,False,
Identify entities that were incorporated in January 2006 and provide their country codes.,"MATCH (e:Entity)
WHERE e.incorporation_date STARTS WITH 'JAN-2006'
RETURN e.name, e.country_codes",Complex Retrieval Queries,offshoreleaks,False,False,True,
Which intermediaries have a registered office in 'MICHAEL PAPAGEORGE; MR. 106 NICHOLSON STREET BROOK'?,"MATCH (i:Intermediary {address: 'MICHAEL PAPAGEORGE; MR. 106 NICHOLSON STREET BROOK'})
RETURN i",Complex Retrieval Queries,offshoreleaks,False,False,False,
Provide the names of all entities that have a tax status description.,"MATCH (e:Entity)
WHERE e.tax_stat_description IS NOT NULL
RETURN e.name",Complex Retrieval Queries,offshoreleaks,False,False,True,
List the addresses that have been registered after 2010 in the Panama Papers.,"MATCH (a:Address)
WHERE a.valid_until IS NOT NULL AND a.sourceID = 'Panama Papers' AND toInteger(substring(a.valid_until, -4)) > 2010
RETURN a",Complex Retrieval Queries,offshoreleaks,False,False,True,
What are the names of entities that have a note stating they were closed due to liquidation?,"MATCH (e:Entity)
WHERE e.note = 'Closed date stands for Liquidation date.'
RETURN e.name",Complex Retrieval Queries,offshoreleaks,False,False,True,
Identify entities with multiple registered addresses.,"MATCH (e:Entity)-[:registered_address]->(a:Address)
WITH e, count(a) AS numAddresses
WHERE numAddresses > 1
RETURN e, numAddresses",Complex Retrieval Queries,offshoreleaks,False,False,True,
List officers who have been linked to entities through the 'intermediary_of' relationship with a start date before 2015.,"MATCH (i:Intermediary)-[r:intermediary_of]->(e:Entity)
WHERE r.start_date < '2015'
RETURN i AS Intermediary, r AS Relationship, e AS Entity",Complex Retrieval Queries,offshoreleaks,False,False,False,
Identify all entities that have 'Aruba corporate registry data is current through 2014' as their valid until date.,"MATCH (e:Entity)
WHERE e.valid_until = 'Aruba corporate registry data is current through 2014'
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,True,
Which entities have been described in the jurisdiction description as 'Samoa' and have a service provider of 'Mossack Fonseca'?,"MATCH (e:Entity)
WHERE e.jurisdiction_description = 'Samoa' AND e.service_provider = 'Mossack Fonseca'
RETURN e",Complex Retrieval Queries,offshoreleaks,False,True,False,
What are the names of intermediaries who have the same name as officers in the Panama Papers?,"MATCH (i:Intermediary)-[:same_name_as]->(o:Officer)
WHERE i.sourceID = 'Panama Papers' AND o.sourceID = 'Panama Papers'
RETURN i.name AS IntermediaryName",Complex Retrieval Queries,offshoreleaks,False,False,True,
List all entities that were struck off on '31-DEC-2002' in the Aruba corporate registry.,"MATCH (e:Entity)
WHERE e.struck_off_date = '31-DEC-2002' AND e.jurisdiction_description = 'Aruba'
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,False,
Which entities have an incorporation date and a struck off date in the same year?,"MATCH (e:Entity)
WHERE e.incorporation_date IS NOT NULL AND e.struck_off_date IS NOT NULL
  AND substring(e.incorporation_date, 7) = substring(e.struck_off_date, 7)
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,True,
Provide names of officers who are connected to entities with a 'shareholder of' link starting from '19-NOV-1999'.,"MATCH (o:Officer)-[r:officer_of {link: 'shareholder of', start_date: '19-NOV-1999'}]->(e:Entity)
RETURN o.name AS OfficerName",Complex Retrieval Queries,offshoreleaks,False,False,True,
Identify entities with a country code of 'HKG' and provide their incorporation dates.,"MATCH (e:Entity {country_codes: 'HKG'})
RETURN e.name, e.incorporation_date",Complex Retrieval Queries,offshoreleaks,False,False,True,
List entities with a valid until date through 2015 and associated with 'Bahamas Leaks'.,"MATCH (e:Entity)
WHERE e.valid_until = ""The Panama Papers data is current through 2015"" AND e.sourceID = ""Bahamas Leaks""
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,False,
Which entities have a note stating 'Closed date stands for Cancelled date.'?,"MATCH (e:Entity)
WHERE e.note = 'Closed date stands for Cancelled date.'
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,True,
Identify entities that have a former name and provide the current and former names.,"MATCH (e:Entity)
WHERE e.former_name IS NOT NULL
RETURN e.name AS CurrentName, e.former_name AS FormerName",Complex Retrieval Queries,offshoreleaks,False,False,True,
Which officers have a registered address in 'Level 5 Development; Bank of Samoa Building; Beach Road; Apia; Samoa'?,"MATCH (o:Officer)-[:registered_address]->(a:Address)
WHERE a.address = 'Level 5 Development; Bank of Samoa Building; Beach Road; Apia; Samoa'
RETURN o",Complex Retrieval Queries,offshoreleaks,False,False,False,
List the names of all officers from the 'Offshore Leaks' data with a nominee role.,"MATCH (o:Officer)-[r:officer_of]->(e:Entity)
WHERE o.sourceID = 'Offshore Leaks' AND r.link = 'nominee'
RETURN o.name",Complex Retrieval Queries,offshoreleaks,False,False,True,
Provide the names of entities with a jurisdiction of 'SAM' and an inactivation date on '15-FEB-2012'.,"MATCH (e:Entity)
WHERE e.jurisdiction = 'SAM' AND e.inactivation_date = '15-FEB-2012'
RETURN e.name",Complex Retrieval Queries,offshoreleaks,False,False,True,
Which intermediaries have a link as 'intermediary of' starting from '19-NOV-1999'?,"MATCH (i:Intermediary)-[r:intermediary_of]->(e:Entity)
WHERE r.start_date = '19-NOV-1999'
RETURN i, r, e",Complex Retrieval Queries,offshoreleaks,False,False,False,
Identify all entities that have undergone a change in company type since their incorporation.,"MATCH (e:Entity)
WHERE e.company_type IS NOT NULL AND EXISTS {
  MATCH (e)-[:same_as]->(e2:Entity)
  WHERE e2.company_type IS NOT NULL AND e.company_type <> e2.company_type
}
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,False,
Identify entities with a type of 'LIMITED LIABILITY COMPANY' in the Paradise Papers.,"MATCH (e:Entity)
WHERE e.type = 'LIMITED LIABILITY COMPANY' AND e.sourceID = 'Paradise Papers - Appleby'
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,False,
List all entities with a closed date on '28-NOV-2012' and provide their country codes.,"MATCH (e:Entity)
WHERE e.closed_date = '28-NOV-2012'
RETURN e.name, e.country_codes",Complex Retrieval Queries,offshoreleaks,False,False,False,
Provide the names of entities that were both incorporated and struck off in the year 2012.,"MATCH (e:Entity)
WHERE e.incorporation_date CONTAINS '2012' AND e.struck_off_date CONTAINS '2012'
RETURN e.name",Complex Retrieval Queries,offshoreleaks,False,False,True,
Which entities are connected to 'MOSSFON SUBSCRIBERS LTD.'?,"MATCH (e:Entity {name: 'MOSSFON SUBSCRIBERS LTD.'})-[:connected_to]->(connectedEntities:Entity)
RETURN connectedEntities",Complex Retrieval Queries,offshoreleaks,False,False,True,
Identify entities that have an 'inactivation_date' on '18-FEB-2013'.,"MATCH (e:Entity {inactivation_date: '18-FEB-2013'})
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,True,
List the entities that were incorporated in 2006 and are now defaulted.,"MATCH (e:Entity)
WHERE e.incorporation_date CONTAINS '2006' AND e.status = 'Defaulted'
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,False,
"What are the names of officers registered in 'Bahamas Leaks' with an address in 'ANNEX FREDERICK & SHIRLEY STS, P.O. BOX N-4805, NA'?","MATCH (o:Officer)-[:registered_address]->(a:Address)
WHERE o.sourceID = 'Bahamas Leaks' AND a.address = 'ANNEX FREDERICK & SHIRLEY STS, P.O. BOX N-4805, NA'
RETURN o.name",Complex Retrieval Queries,offshoreleaks,False,False,True,
Which entities are registered to the address 'Level 5 Development; Bank of Samoa Building; Beach Road; Apia; Samoa'?,"MATCH (e:Entity)-[:registered_address]->(a:Address)
WHERE a.address = 'Level 5 Development; Bank of Samoa Building; Beach Road; Apia; Samoa'
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,True,
List officers who are nominees in any form according to the 'Offshore Leaks' data.,"MATCH (o:Officer)-[r:officer_of]->(e:Entity)
WHERE o.sourceID = 'Offshore Leaks' AND r.link = 'nominee'
RETURN o.name, e.name",Complex Retrieval Queries,offshoreleaks,False,True,False,
Which entities are connected to 'Top Games Holdings Inc.'?,"MATCH (e:Entity {name: 'Top Games Holdings Inc.'})-[:connected_to]->(connectedEntities:Entity)
RETURN connectedEntities",Complex Retrieval Queries,offshoreleaks,False,True,False,
Provide the names of entities that have the same name as other entities.,"MATCH (e1:Entity)-[:same_name_as]->(e2:Entity)
RETURN e1.name AS EntityName1, e2.name AS EntityName2",Complex Retrieval Queries,offshoreleaks,False,False,True,
List officers with the same ID based on 'Paradise Papers - Malta corporate registry'.,"MATCH (o1:Officer)-[r:same_id_as {sourceID: 'Paradise Papers - Malta corporate registry'}]->(o2:Officer)
RETURN o1, r, o2",Complex Retrieval Queries,offshoreleaks,False,False,False,
Which entities have a jurisdiction of 'SAM' and a service provider of 'Mossack Fonseca'?,"MATCH (e:Entity)
WHERE e.jurisdiction = 'SAM' AND e.service_provider = 'Mossack Fonseca'
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,True,
Identify officers who have the former name 'KIM SOO IN'.,"MATCH (o:Officer {former_name: 'KIM SOO IN'})
RETURN o",Complex Retrieval Queries,offshoreleaks,False,False,True,Officer.former_name
"What are the names of entities that have been provided intermediary services by 'MICHAEL PAPAGEORGE, MR.'?","MATCH (i:Intermediary {name: 'MICHAEL PAPAGEORGE, MR.'})-[:intermediary_of]->(e:Entity)
RETURN e.name",Complex Retrieval Queries,offshoreleaks,True,False,False,
Which addresses are linked to multiple entities in the Panama Papers?,"MATCH (a:Address)<-[:registered_address]-(e:Entity)
WHERE e.sourceID = 'Panama Papers'
WITH a, count(e) AS entityCount
WHERE entityCount > 1
RETURN a.address, entityCount",Complex Retrieval Queries,offshoreleaks,False,True,False,
List all officers who have a valid data up to 2015 in the Panama Papers.,"MATCH (o:Officer)
WHERE o.valid_until = ""The Panama Papers data is current through 2015"" AND o.sourceID = ""Panama Papers""
RETURN o",Complex Retrieval Queries,offshoreleaks,False,False,True,
List the names of entities that have been struck off but have no recorded inactivation date.,"MATCH (e:Entity)
WHERE e.struck_off_date IS NOT NULL AND e.inactivation_date IS NULL
RETURN e.name",Complex Retrieval Queries,offshoreleaks,False,False,False,
Identify entities that were struck off in February 2013.,"MATCH (e:Entity)
WHERE e.struck_off_date STARTS WITH '15-FEB-2013' OR e.struck_off_date STARTS WITH '18-FEB-2013'
RETURN e",Complex Retrieval Queries,offshoreleaks,False,True,False,
What are the former names of entities that were struck off in February 2012?,"MATCH (e:Entity)
WHERE e.struck_off_date STARTS WITH 'FEB-2012' AND e.former_name IS NOT NULL
RETURN e.former_name",Complex Retrieval Queries,offshoreleaks,False,False,True,
List all entities with a country code of 'HKG' that are in default status.,"MATCH (e:Entity {country_codes: 'HKG', status: 'Defaulted'})
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,True,
Provide the names of officers who act as shareholder of entities incorporated on '19-NOV-1999'.,"MATCH (o:Officer)-[r:officer_of {link: 'shareholder of', start_date: '19-NOV-1999'}]->(e:Entity)
WHERE e.incorporation_date = '19-NOV-1999'
RETURN o.name AS OfficerName",Complex Retrieval Queries,offshoreleaks,False,False,False,
Which entities have a struck off date exactly one year before their inactivation date?,"MATCH (e:Entity)
WHERE e.struck_off_date IS NOT NULL AND e.inactivation_date IS NOT NULL
  AND date(e.struck_off_date) = date(e.inactivation_date) - duration({years: 1})
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,True,
Identify officers connected to entities with a jurisdiction description of 'Samoa'.,"MATCH (o:Officer)-[:officer_of]->(e:Entity)
WHERE e.jurisdiction_description = 'Samoa'
RETURN o",Complex Retrieval Queries,offshoreleaks,False,False,True,
Who are the officers of entities that were incorporated on '06-JAN-2006'?,"MATCH (o:Officer)-[:officer_of]->(e:Entity {incorporation_date: '06-JAN-2006'})
RETURN o.name AS OfficerName",Complex Retrieval Queries,offshoreleaks,False,False,True,
"Which entities are same as 'HOTFOCUS CO., LTD.' in terms of name and address?","MATCH (e1:Entity {name: 'HOTFOCUS CO., LTD.'})-[:registered_address]->(a:Address)
MATCH (e2:Entity)-[:same_as]->(e1)
RETURN e2",Complex Retrieval Queries,offshoreleaks,False,False,True,
List the entities that have a valid_until date through 2015 and are associated with the Panama Papers.,"MATCH (e:Entity)
WHERE e.valid_until = ""The Panama Papers data is current through 2015"" AND e.sourceID = ""Panama Papers""
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,True,
What are the names of entities with a service provider 'Mossack Fonseca' and struck off in 2013?,"MATCH (e:Entity)
WHERE e.service_provider = 'Mossack Fonseca' AND e.struck_off_date CONTAINS '2013'
RETURN e.name",Complex Retrieval Queries,offshoreleaks,False,False,True,
Identify intermediaries that have registered addresses outside of their country of operation.,"MATCH (i:Intermediary)-[:registered_address]->(a:Address)
WHERE i.countries IS NOT NULL AND a.countries IS NOT NULL AND NOT i.countries CONTAINS a.countries
RETURN i.name AS IntermediaryName, i.countries AS CountryOfOperation, a.address AS RegisteredAddress, a.countries AS AddressCountry",Complex Retrieval Queries,offshoreleaks,False,False,True,
Which officers have a status of 'ACTIVE' in the Panama Papers database?,"MATCH (o:Officer)
WHERE o.status = 'ACTIVE' AND o.sourceID = 'Panama Papers'
RETURN o",Complex Retrieval Queries,offshoreleaks,False,False,True,Officer.status
List all entities associated with 'Mossack Fonseca' that have an inactivation date on '16-FEB-2009'.,"MATCH (e:Entity {service_provider: 'Mossack Fonseca', inactivation_date: '16-FEB-2009'})
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,True,
Provide names of officers who are beneficiaries in any forms according to 'Offshore Leaks' data.,"MATCH (o:Officer)-[r:officer_of]->(e:Entity)
WHERE r.sourceID = 'Offshore Leaks' AND r.link = 'beneficiary of'
RETURN o.name",Complex Retrieval Queries,offshoreleaks,False,False,False,
Which entities have a company number that starts with '240'?,"MATCH (e:Entity)
WHERE e.company_number STARTS WITH '240'
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,True,
What officers are connected to 'Top Games Holdings Inc.' through a direct relationship?,"MATCH (o:Officer)-[:officer_of]->(e:Entity {name: 'Top Games Holdings Inc.'})
RETURN o",Complex Retrieval Queries,offshoreleaks,False,False,False,
Provide the names of entities that were incorporated on '10-JAN-2006' and have a jurisdiction of 'SAM'.,"MATCH (e:Entity)
WHERE e.incorporation_date = '10-JAN-2006' AND e.jurisdiction = 'SAM'
RETURN e.name",Complex Retrieval Queries,offshoreleaks,False,True,False,
Which entities are connected to officers with the icij_id 'E72326DEA50F1A9C2876E112AAEB42BC'?,"MATCH (o:Officer {icij_id: 'E72326DEA50F1A9C2876E112AAEB42BC'})-[:officer_of]->(e:Entity)
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,True,
Show top 3 most recent nodes in the category Other.,"MATCH (o:Other)
RETURN o
ORDER BY o.lastEditTimestamp DESC
LIMIT 3",Simple Aggregation Queries,offshoreleaks,False,False,True,
Which others have a note about the Liquidation date?,"MATCH (o:Other)
WHERE o.note = 'Closed date stands for Liquidation date.'
RETURN o",Simple Aggregation Queries,offshoreleaks,False,False,True,
List all entities that have a registered address in Samoa.,"MATCH (e:Entity)-[:registered_address]->(a:Address)
WHERE a.countries = 'Samoa'
RETURN e",Simple Aggregation Queries,offshoreleaks,True,False,False,
Show entities that have the same company name as 'Top Games Holdings Inc.',"MATCH (e1:Entity {name: 'Top Games Holdings Inc.'})-[:same_company_as]->(e2:Entity)
RETURN e2",Simple Aggregation Queries,offshoreleaks,False,True,False,
What are the top 5 most recent intermediary connections to entities?,"MATCH (i:Intermediary)-[r:intermediary_of]->(e:Entity)
RETURN i, e, r
ORDER BY i.lastEditTimestamp DESC
LIMIT 5",Simple Aggregation Queries,offshoreleaks,False,True,False,
List the officers who have the same name as 'MOSSFON SUBSCRIBERS LTD.',"MATCH (o:Officer)-[:same_name_as]->(e:Entity {name: 'MOSSFON SUBSCRIBERS LTD.'})
RETURN o.name AS OfficerName",Simple Aggregation Queries,offshoreleaks,False,False,False,
Show entities that have a former name listed.,"MATCH (e:Entity)
WHERE e.former_name IS NOT NULL
RETURN e",Simple Aggregation Queries,offshoreleaks,True,False,False,
Which entities are connected to addresses in Hong Kong?,"MATCH (e:Entity)-[:registered_address]->(a:Address)
WHERE a.countries = 'Hong Kong'
RETURN e",Simple Aggregation Queries,offshoreleaks,False,True,False,
List the top 5 intermediaries by last edit timestamp.,"MATCH (i:Intermediary)
RETURN i
ORDER BY i.lastEditTimestamp DESC
LIMIT 5",Simple Aggregation Queries,offshoreleaks,False,False,False,
What is the status of entities that were incorporated on '23-MAR-2006'?,"MATCH (e:Entity {incorporation_date: '23-MAR-2006'})
RETURN e.name, e.status",Simple Aggregation Queries,offshoreleaks,False,False,True,
Show entities that were struck off a day after their inactivation date.,"MATCH (e:Entity)
WHERE e.struck_off_date IS NOT NULL AND e.inactivation_date IS NOT NULL
  AND date(e.struck_off_date) = date(e.inactivation_date) + duration({days: 1})
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,True,
List all entities and their associated countries with status 'Defaulted'.,"MATCH (e:Entity {status: 'Defaulted'})
RETURN e.name AS EntityName, e.countries AS Country",Simple Aggregation Queries,offshoreleaks,False,True,False,
Which entities have a last edit timestamp earlier than '1638311040000'?,"MATCH (e:Entity)
WHERE e.lastEditTimestamp < '1638311040000'
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,True,
List other entities connected to Samoa.,"MATCH (e:Entity {jurisdiction_description: ""Samoa""})-[:connected_to]->(connected:Entity)
RETURN connected",Simple Aggregation Queries,offshoreleaks,False,False,True,
Show the top 5 intermediaries and the entities they are connected to.,"MATCH (i:Intermediary)-[:intermediary_of]->(e:Entity)
RETURN i, collect(e) AS connected_entities
ORDER BY count(e) DESC
LIMIT 5",Simple Aggregation Queries,offshoreleaks,False,False,False,
Which entities have a node id greater than '10000000'?,"MATCH (e:Entity)
WHERE e.node_id > 10000000
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,False,
Show officers that are linked as 'Nominee Shareholder of' other entities.,"MATCH (o:Officer)-[r:officer_of {link: 'Nominee Shareholder of'}]->(e:Entity)
RETURN o, r, e",Simple Aggregation Queries,offshoreleaks,False,False,True,
List the addresses that are registered to more than one entity.,"MATCH (a:Address)<-[:registered_address]-(e:Entity)
WITH a, count(e) AS numEntities
WHERE numEntities > 1
RETURN a.address, numEntities",Simple Aggregation Queries,offshoreleaks,False,False,True,
Show entities that were last edited on the same timestamp as 'Top Games Holdings Inc.',"MATCH (e1:Entity {name: 'Top Games Holdings Inc.'})
MATCH (e2:Entity)
WHERE e1.lastEditTimestamp = e2.lastEditTimestamp AND e1.node_id <> e2.node_id
RETURN e2",Simple Aggregation Queries,offshoreleaks,False,False,True,
Which entities have a tax description available?,"MATCH (e:Entity)
WHERE e.tax_stat_description IS NOT NULL
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,False,
List entities that have been closed but not struck off.,"MATCH (e:Entity)
WHERE e.closed_date IS NOT NULL AND e.struck_off_date IS NULL
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,False,
What are the top 3 most recent types of connection available in the schema?,"MATCH (n)-[r]->(m)
RETURN DISTINCT type(r) AS ConnectionType, max(r.lastEditTimestamp) AS MostRecent
ORDER BY MostRecent DESC
LIMIT 3",Simple Aggregation Queries,offshoreleaks,False,False,True,
"Show entities that are same as 'TIANSHENG INDUSTRY AND TRADING CO., LTD.'","MATCH (e:Entity {name: 'TIANSHENG INDUSTRY AND TRADING CO., LTD.'})-[:same_as]->(sameEntity:Entity)
RETURN sameEntity",Simple Aggregation Queries,offshoreleaks,False,False,True,
Which entities are registered at the same address as 'Top Games Holdings Inc.'?,"MATCH (e1:Entity {name: 'Top Games Holdings Inc.'})-[:registered_address]->(a:Address)
MATCH (e2:Entity)-[:registered_address]->(a)
RETURN e2",Simple Aggregation Queries,offshoreleaks,False,False,False,
List the intermediaries that have a source ID of 'Panama Papers' and are active.,"MATCH (i:Intermediary)
WHERE i.sourceID = 'Panama Papers' AND i.status = 'ACTIVE'
RETURN i",Simple Aggregation Queries,offshoreleaks,False,False,False,
Show the entities with a struck off date in 2014.,"MATCH (e:Entity)
WHERE e.struck_off_date CONTAINS '2014'
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,True,
"List officers who are connected to addresses in Apia, Samoa.","MATCH (o:Officer)-[:registered_address]->(a:Address)
WHERE a.countries = 'Samoa' AND a.address CONTAINS 'Apia'
RETURN o.name, o.node_id, a.address",Simple Aggregation Queries,offshoreleaks,False,False,True,
What are the closed dates for entities that have a jurisdiction of SAM?,"MATCH (e:Entity {jurisdiction: 'SAM'})
WHERE e.closed_date IS NOT NULL
RETURN e.name, e.closed_date",Simple Aggregation Queries,offshoreleaks,False,False,True,
"List the entities that have a similar name and address as 'NINGBO SUNRISE ENTERPRISES UNITED CO., LTD.'","MATCH (e:Entity)-[:similar]->(similarEntity:Entity {name: 'NINGBO SUNRISE ENTERPRISES UNITED CO., LTD.'})
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,False,
What are the names of other entities with type 'LIMITED LIABILITY COMPANY'?,"MATCH (o:Other {type: 'LIMITED LIABILITY COMPANY'})
RETURN o.name",Simple Aggregation Queries,offshoreleaks,False,False,True,
Show the top 5 most recently edited addresses.,"MATCH (a:Address)
RETURN a
ORDER BY a.lastEditTimestamp DESC
LIMIT 5",Simple Aggregation Queries,offshoreleaks,False,False,True,
List addresses that are valid until 2020.,"MATCH (a:Address)
WHERE a.valid_until = ""The Bahamas Leaks data is current through early 2020""
RETURN a",Simple Aggregation Queries,offshoreleaks,False,False,False,
List the entities that have multiple former names and provide all names.,"MATCH (e:Entity)
WHERE e.former_name IS NOT NULL
WITH e, split(e.former_name, "";"") AS names
WHERE size(names) > 1
RETURN e.name AS entity_name, names AS former_names",Complex Retrieval Queries,offshoreleaks,False,False,True,
Identify officers linked to entities with a company number starting with '240'.,"MATCH (o:Officer)-[:officer_of]->(e:Entity)
WHERE e.company_number STARTS WITH '240'
RETURN o",Complex Retrieval Queries,offshoreleaks,False,False,True,
What are the names of officers who have a note on their record in the Panama Papers?,"MATCH (o:Officer {sourceID: ""Panama Papers""})
WHERE o.note IS NOT NULL
RETURN o.name",Complex Retrieval Queries,offshoreleaks,False,False,False,
Which entities have an inactivation date on '18-FEB-2013' and a struck off date on '15-FEB-2013'?,"MATCH (e:Entity)
WHERE e.inactivation_date = '18-FEB-2013' AND e.struck_off_date = '15-FEB-2013'
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,True,
Provide the names of entities that have a company type of 'FOREIGN FORMED CORPORATION' according to the Paradise Papers.,"MATCH (e:Entity {company_type: 'FOREIGN FORMED CORPORATION'})
WHERE e.sourceID = 'Paradise Papers - Appleby'
RETURN e.name",Complex Retrieval Queries,offshoreleaks,False,True,False,
List the entities that were incorporated in '2006' and have a service provider of 'Mossack Fonseca'.,"MATCH (e:Entity)
WHERE e.incorporation_date CONTAINS '2006' AND e.service_provider = 'Mossack Fonseca'
RETURN e",Complex Retrieval Queries,offshoreleaks,False,False,True,
"What are the names of entities that are connected to 'MICHAEL PAPAGEORGE, MR.' as an intermediary and what is their status?","MATCH (i:Intermediary {name: 'MICHAEL PAPAGEORGE, MR.'})-[:intermediary_of]->(e:Entity)
RETURN e.name AS EntityName, e.status AS Status",Complex Retrieval Queries,offshoreleaks,False,False,False,
Identify officers with the source ID 'Bahamas Leaks' who have a status of 'ACTIVE'.,"MATCH (o:Officer {sourceID: 'Bahamas Leaks', status: 'ACTIVE'})
RETURN o",Complex Retrieval Queries,offshoreleaks,False,False,True,Officer.status
Which entities were incorporated in March 2006?,"MATCH (e:Entity)
WHERE e.incorporation_date CONTAINS ""MAR-2006""
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,True,
List all entities with jurisdiction description of Samoa.,"MATCH (e:Entity {jurisdiction_description: ""Samoa""})
RETURN e",Simple Aggregation Queries,offshoreleaks,False,True,False,
What are the names of entities that defaulted in 2013?,"MATCH (e:Entity {status: ""Defaulted""})
WHERE e.inactivation_date STARTS WITH ""2013"" OR e.struck_off_date STARTS WITH ""2013""
RETURN e.name",Simple Aggregation Queries,offshoreleaks,False,False,True,
Find top 5 entities serviced by Mossack Fonseca.,"MATCH (e:Entity {service_provider: ""Mossack Fonseca""})
RETURN e
ORDER BY e.node_id
LIMIT 5",Simple Aggregation Queries,offshoreleaks,False,False,True,
Which entities have a country code of HKG?,"MATCH (e:Entity {country_codes: 'HKG'})
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,False,
Show entities that were struck off in February 2013.,"MATCH (e:Entity)
WHERE e.struck_off_date STARTS WITH '15-FEB-2013' OR e.struck_off_date STARTS WITH '18-FEB-2013'
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,False,
List entities that have the same address as 'ORION HOUSE SERVICES (HK) LIMITED ROOM 1401; 14/F.',"MATCH (a:Address {address: ""ORION HOUSE SERVICES (HK) LIMITED ROOM 1401; 14/F.""})-[:registered_address]-(e:Entity)
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,True,
How many entities were inactivated in February 2013?,"MATCH (e:Entity)
WHERE e.inactivation_date STARTS WITH '18-FEB-2013'
RETURN count(e) AS InactivatedEntitiesCount",Simple Aggregation Queries,offshoreleaks,False,False,True,
What are the names of entities that were last edited at timestamp '1638311020926'?,"MATCH (e:Entity)
WHERE e.lastEditTimestamp = '1638311020926'
RETURN e.name",Simple Aggregation Queries,offshoreleaks,False,False,True,
List all entities that were valid until 2015.,"MATCH (e:Entity)
WHERE e.valid_until = ""The Panama Papers data is current through 2015""
RETURN e",Simple Aggregation Queries,offshoreleaks,False,False,True,
Show top 3 intermediaries from South Africa.,"MATCH (i:Intermediary {countries: ""South Africa""})
RETURN i
ORDER BY i.node_id
LIMIT 3",Simple Aggregation Queries,offshoreleaks,False,False,True,
Which intermediaries have an active status?,"MATCH (i:Intermediary {status: ""ACTIVE""})
RETURN i",Simple Aggregation Queries,offshoreleaks,False,True,False,
List intermediaries associated with the address 'MICHAEL PAPAGEORGE; MR. 106 NICHOLSON STREET BROOK'.,"MATCH (a:Address {address: 'MICHAEL PAPAGEORGE; MR. 106 NICHOLSON STREET BROOK'})<-[:registered_address]-(i:Intermediary)
RETURN i",Simple Aggregation Queries,offshoreleaks,False,False,True,
Find the intermediaries that deal with entities in Panama.,"MATCH (i:Intermediary)-[:intermediary_of]->(e:Entity)
WHERE e.jurisdiction = 'PAN'
RETURN i",Simple Aggregation Queries,offshoreleaks,False,True,False,
Show the name of intermediaries linked to the Panama Papers.,"MATCH (i:Intermediary {sourceID: ""Panama Papers""})
RETURN i.name",Simple Aggregation Queries,offshoreleaks,False,False,False,
What are the countries associated with intermediaries in the dataset?,"MATCH (i:Intermediary)
RETURN DISTINCT i.countries AS Countries",Simple Aggregation Queries,offshoreleaks,False,False,True,
List all officers named 'KIM SOO IN'.,"MATCH (o:Officer {name: 'KIM SOO IN'})
RETURN o",Simple Aggregation Queries,offshoreleaks,False,False,True,
Which officers are connected to entities incorporated in Samoa?,"MATCH (o:Officer)-[:officer_of]->(e:Entity {jurisdiction: 'SAM'})
RETURN o.name AS OfficerName, e.name AS EntityName",Simple Aggregation Queries,offshoreleaks,False,False,True,
Show officers who have a country code of KOR.,"MATCH (o:Officer {country_codes: 'KOR'})
RETURN o",Simple Aggregation Queries,offshoreleaks,False,False,True,
List all officers who have been officers of entities.,"MATCH (o:Officer)-[:officer_of]->(e:Entity)
RETURN o",Simple Aggregation Queries,offshoreleaks,False,False,True,
How many addresses are there in the Bahamas?,"MATCH (a:Address {countries: ""Bahamas""})
RETURN count(a) AS NumberOfAddressesInBahamas",Simple Aggregation Queries,offshoreleaks,False,False,False,
List the entities with their respective inactivation dates and statuses.,"MATCH (e:Entity)
WHERE e.inactivation_date IS NOT NULL AND e.status IS NOT NULL
RETURN e.name, e.inactivation_date, e.status",Simple Aggregation Queries,offshoreleaks,False,False,True,
"List the names of entities that share the same company as 'SKY-BLUE GIFTS & TOYS CO., LTD.'","MATCH (e:Entity {name: 'SKY-BLUE GIFTS & TOYS CO., LTD.'})-[:same_company_as]->(sameCompany:Entity)
RETURN sameCompany.name",Complex Retrieval Queries,offshoreleaks,True,False,False,
What are the top 5 movies with a runtime greater than 120 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m
ORDER BY m.runtime DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
List the first 3 genres with movies having an average IMDb rating under 5.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.imdbRating < 5
WITH g, avg(m.imdbRating) AS avgRating
ORDER BY avgRating ASC
RETURN g.name, avgRating
LIMIT 3",Verbose query,recommendations,False,False,True,
List the first 5 directors who have a biography listed in their profile.,"MATCH (d:Director)
WHERE d.bio IS NOT NULL
RETURN d
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Which 3 movies have the most detailed plot descriptions (longest text)?,"MATCH (m:Movie)
RETURN m.title, m.plot
ORDER BY size(m.plot) DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Show the top 5 actors who have acted in movies with at least three different directors.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(d:Director)
WITH a, m, count(DISTINCT d) AS numDirectors
WHERE numDirectors >= 3
RETURN a.name, count(DISTINCT m) AS moviesWithThreeDirectors
ORDER BY moviesWithThreeDirectors DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
List the first 5 movies that have been directed by women.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE d.gender = 'female'
RETURN m
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,Director.gender
Which 3 actors have the most roles listed in their ACTED_IN relationships?,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)
RETURN a.name, count(r) AS roles_count
ORDER BY roles_count DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies that have been rated 10 times or more?,"MATCH (m:Movie)
WHERE size{(u:User)-[:RATED]->(m)} >= 10
RETURN m
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 5 genres of movies with the most language diversity.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, count(DISTINCT m.languages) AS languageDiversity
ORDER BY languageDiversity DESC
RETURN g.name AS Genre, languageDiversity
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Show the first 3 actors who starred in a movie with a budget over 200 million USD.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.budget > 200000000
RETURN a
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which 5 directors have directed movies with the highest average imdbRating?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH d, AVG(m.imdbRating) AS avgRating
ORDER BY avgRating DESC
LIMIT 5
RETURN d.name, avgRating",Simple Retrieval Queries,recommendations,False,False,True,
What are the top 3 movies with the most significant difference between budget and revenue?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.budget, m.revenue, abs(m.revenue - m.budget) AS difference
ORDER BY difference DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the top 3 movies released during the Christmas season (December)?,"MATCH (m:Movie)
WHERE m.released STARTS WITH '12-' OR m.released CONTAINS '-12-'
RETURN m
ORDER BY m.released
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which 3 movies have the lowest imdbVotes but a rating higher than 7.0?,"MATCH (m:Movie)
WHERE m.imdbRating > 7.0 AND m.imdbVotes IS NOT NULL
RETURN m
ORDER BY m.imdbVotes ASC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 5 users who have rated the most movies released before 2000.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE m.year < 2000
WITH u, count(m) AS movies_rated
ORDER BY movies_rated DESC
LIMIT 5
RETURN u.userId, u.name, movies_rated",Simple Retrieval Queries,recommendations,False,False,False,
Show the first 3 movies that feature an actor from France.,"MATCH (a:Actor {bornIn: ""France""})-[:ACTED_IN]->(m:Movie)
RETURN m
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which 5 movies have been released in the most number of countries?,"MATCH (m:Movie)
RETURN m.title, size(m.countries) AS countries_count
ORDER BY countries_count DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
What are the top 3 genres of movies that have a budget less than 50 million USD?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget < 50000000
RETURN g.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 5 movies with a plot involving a 'young boy' or 'orphan'.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'young boy' OR m.plot CONTAINS 'orphan'
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Show the first 3 movies that have been rated by the youngest users.,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN m
ORDER BY u.born DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,False,User.born
Which 5 actors have acted in the most commercially successful movies (highest revenue)?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.revenue IS NOT NULL
RETURN a.name, sum(m.revenue) AS totalRevenue
ORDER BY totalRevenue DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,False,
What are the top 3 movies with the longest runtime?,"MATCH (m:Movie)
RETURN m
ORDER BY m.runtime DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the first 5 actors who have acted in movies directed by a director born in Nebraska.,"MATCH (d:Director {bornIn: ""Nebraska""})-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(a:Actor)
RETURN DISTINCT a.name
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Which 5 actors were born in the USA and have acted in at least two movies?,"MATCH (a:Actor {bornIn: ""USA""})-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS movies_count
WHERE movies_count >= 2
RETURN a.name, movies_count
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Show the first 3 movies that have a poster URL and were released after 2010.,"MATCH (m:Movie)
WHERE m.poster IS NOT NULL AND m.released > ""2010-01-01""
RETURN m
ORDER BY m.released
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 5 movies that have been rated the most number of times.,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN m.title, count(r) AS ratingsCount
ORDER BY ratingsCount DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies with the highest number of genres associated?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(g) AS genreCount
ORDER BY genreCount DESC
RETURN m.title, genreCount
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,False,
List the top 5 highest-rated movies by users named 'John'.,"MATCH (u:User {name: 'John'})-[:RATED]->(m:Movie)
RETURN m.title AS MovieTitle, avg(u.rating) AS AverageRating
ORDER BY AverageRating DESC
LIMIT 5",Simple Retrieval Queries,recommendations,True,False,False,User.rating
Show the first 3 genres that have movies with both an English and French language option.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE 'English' IN m.languages AND 'French' IN m.languages
RETURN DISTINCT g.name
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which 5 directors have the most movies released in the 2000s?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.year >= 2000 AND m.year < 2010
RETURN d.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
What are the top 3 movies based on the number of different languages they have been released in?,"MATCH (m:Movie)
RETURN m.title, size(m.languages) AS num_languages
ORDER BY num_languages DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the first 5 movies that were released on a Friday.,"MATCH (m:Movie)
WHERE m.released IS NOT NULL AND date(m.released).dayOfWeek = 5
RETURN m
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Which 3 movies have been rated by the oldest users in terms of account creation date?,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN m.title, m.released, m.imdbRating
ORDER BY u.accountCreationDate ASC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,User.accountCreationDate
Show the top 5 genres of movies that have a runtime of exactly 90 minutes.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.runtime = 90
RETURN g.name, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
List the first 5 actors who were born and died in the same country.,"MATCH (a:Actor)
WHERE a.bornIn = a.diedIn AND a.bornIn IS NOT NULL AND a.diedIn IS NOT NULL
RETURN a
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,Actor.diedIn
Which 3 directors have the longest bios in the database?,"MATCH (d:Director)
RETURN d.name, d.bio
ORDER BY length(d.bio) DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies that have a tmdbId and an imdbId listed?,"MATCH (m:Movie)
WHERE m.tmdbId IS NOT NULL AND m.imdbId IS NOT NULL
RETURN m
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 5 movies that have been rated by users from more than 5 different countries.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH m, count(DISTINCT u) AS userCount
WHERE userCount > 5
RETURN m
ORDER BY userCount DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Show the first 3 actors who have directed a movie.,"MATCH (a:Actor)-[:DIRECTED]->(m:Movie)
RETURN a.name, a.url, a.tmdbId
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which 5 movies have the most distinct countries of release listed?,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
RETURN m.title, size(m.countries) AS num_countries
ORDER BY num_countries DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
What are the top 3 directors who have directed movies with the most diverse set of actors?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(a:Actor)
WITH d, count(DISTINCT a) AS diversity
ORDER BY diversity DESC
LIMIT 3
RETURN d.name, diversity",Simple Retrieval Queries,recommendations,False,False,True,
List the first 5 movies that have a language listed as 'French'.,"MATCH (m:Movie)
WHERE 'French' IN m.languages
RETURN m
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Which 3 movies have been directed by directors who have also acted in movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists {
  (d)-[:ACTED_IN]->(:Movie)
}
RETURN m.title AS MovieTitle
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Show the top 5 movies with the most actors involved.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH m, count(a) AS num_actors
ORDER BY num_actors DESC
LIMIT 5
RETURN m.title, num_actors",Simple Retrieval Queries,recommendations,False,False,True,
List the first 5 directors who have directed a movie with an imdbRating of 9 or higher.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating >= 9
RETURN d
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Which 3 users have given the highest average rating to movies they've rated?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, AVG(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN u.userId, u.name, avgRating",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 genres in which Harold Lloyd has directed movies?,"MATCH (d:Director {name: ""Harold Lloyd""})-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN DISTINCT g.name
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the first 5 directors with the most diverse filmography based on genre diversity.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH d, COUNT(DISTINCT g) AS genreDiversity
ORDER BY genreDiversity DESC
RETURN d.name, genreDiversity
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Which 3 movies have been rated exactly 5 times by users?,"MATCH (m:Movie)<-[r:RATED]-(:User)
WITH m, count(r) AS ratingsCount
WHERE ratingsCount = 5
RETURN m
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Show the first 5 genres of movies directed by directors who were born after 1960.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE d.born > date('1960-01-01')
RETURN DISTINCT g.name
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
List the top 5 movies with the most user ratings.,"MATCH (m:Movie)<-[:RATED]-(u:User)
RETURN m.title, count(u) AS ratingsCount
ORDER BY ratingsCount DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
List the first 3 genres that have movies with a runtime greater than 120 minutes.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.runtime > 120
RETURN DISTINCT g.name
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the top 5 movies directed by Harold Lloyd?,"MATCH (d:Director {name: ""Harold Lloyd""})-[:DIRECTED]->(m:Movie)
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
List the top 5 users who have given the highest average ratings to movies.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, AVG(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 5
RETURN u.userId, u.name, avgRating",Verbose query,recommendations,False,False,True,
Find the top 5 directors who have directed movies with the highest average imdbRating.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH d, AVG(m.imdbRating) AS avgRating
ORDER BY avgRating DESC
LIMIT 5
RETURN d.name, avgRating",Verbose query,recommendations,False,False,True,
Which 5 actors have acted in movies with the highest average imdbRating?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, avg(m.imdbRating) AS avgRating
ORDER BY avgRating DESC
LIMIT 5
RETURN a.name, avgRating",Verbose query,recommendations,False,False,True,
List the top 5 movies with the smallest budgets.,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL
RETURN m
ORDER BY m.budget ASC
LIMIT 5",Verbose query,recommendations,False,False,True,
What are the top 5 movies with the highest budgets?,"MATCH (m:Movie)
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5",Verbose query,recommendations,False,False,True,
Who are the top 5 youngest directors based on the 'born' property?,"MATCH (d:Director)
WHERE d.born IS NOT NULL
RETURN d
ORDER BY d.born DESC
LIMIT 5",Verbose query,recommendations,False,False,True,
List the 5 oldest actors based on the 'born' property.,"MATCH (a:Actor)
WHERE a.born IS NOT NULL
RETURN a
ORDER BY a.born
LIMIT 5",Verbose query,recommendations,False,False,True,
What are the top 3 oldest movies based on the 'year' property?,"MATCH (m:Movie)
RETURN m
ORDER BY m.year ASC
LIMIT 3",Verbose query,recommendations,False,False,True,
Find the top 5 movies released most recently.,"MATCH (m:Movie)
WHERE m.released IS NOT NULL
RETURN m
ORDER BY m.released DESC
LIMIT 5",Verbose query,recommendations,False,False,True,
What are the top 5 languages in which movies are made based on the 'languages' property of movies?,"MATCH (m:Movie)
WHERE m.languages IS NOT NULL
UNWIND m.languages AS language
RETURN language, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 5",Verbose query,recommendations,False,False,True,
List the names of the top 3 users who have rated the most movies.,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN u.name, count(m) AS movies_rated
ORDER BY movies_rated DESC
LIMIT 3",Verbose query,recommendations,False,False,True,
What are the top 5 countries where the most movies originate from based on the 'countries' property of movies?,"MATCH (m:Movie)
UNWIND m.countries AS country
WITH country, COUNT(m) AS movieCount
ORDER BY movieCount DESC
RETURN country, movieCount
LIMIT 5",Verbose query,recommendations,False,False,True,
Which 5 movies have been rated by the highest number of users?,"MATCH (u:User)-[:RATED]->(m:Movie)
RETURN m.title AS MovieTitle, count(u) AS NumberOfRatings
ORDER BY NumberOfRatings DESC
LIMIT 5",Verbose query,recommendations,False,False,True,
List the names of the first 3 genres that have the most movies associated with them.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3",Verbose query,recommendations,False,False,True,
What are the top 5 actors who acted in the most number of movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
RETURN a.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 5",Verbose query,recommendations,False,False,True,
Find the names of the top 5 directors by the number of movies they have directed.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
RETURN d.name, count(m) AS movies_directed
ORDER BY movies_directed DESC
LIMIT 5",Verbose query,recommendations,False,False,True,
List the top 5 movies with the most imdbVotes.,"MATCH (m:Movie)
WHERE m.imdbVotes IS NOT NULL
RETURN m
ORDER BY m.imdbVotes DESC
LIMIT 5",Verbose query,recommendations,False,False,True,
Find the names of the top 5 movies with the lowest imdbRating.,"MATCH (m:Movie)
WHERE m.imdbRating IS NOT NULL
RETURN m.title AS MovieTitle, m.imdbRating AS Rating
ORDER BY m.imdbRating ASC
LIMIT 5",Verbose query,recommendations,False,False,True,
What are the top 5 longest movies by runtime?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5",Verbose query,recommendations,False,False,True,
Which 3 users rated the movie with the highest revenue?,"MATCH (m:Movie)
WITH m ORDER BY m.revenue DESC LIMIT 1
MATCH (u:User)-[:RATED]->(m)
RETURN u LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which 3 directors have directed the most movies with a runtime over 150 minutes?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.runtime > 150
WITH d, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3
RETURN d.name, movies_count",Simple Retrieval Queries,recommendations,False,False,True,
Show the first 5 actors who acted in movies released in the year 2014.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.year = 2014
RETURN a
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
List the first 5 directors born in France.,"MATCH (d:Director)
WHERE d.bornIn = 'France'
RETURN d
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Which 3 users have rated the oldest movies in the database?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH m, u ORDER BY m.year ASC, r.timestamp ASC
RETURN u.userId, u.name, COLLECT(m.title)[..3] AS movies_rated LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 directors who died after 2000?,"MATCH (d:Director)
WHERE d.died > date('2000-01-01')
RETURN d
ORDER BY d.died ASC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the 5 most recently released movies with a plot description available.,"MATCH (m:Movie)
WHERE m.plot IS NOT NULL
RETURN m
ORDER BY m.released DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Show the first 3 movies released in the USA that have a revenue exceeding 500 million USD.,"MATCH (m:Movie)
WHERE 'USA' IN m.countries AND m.revenue > 500000000
RETURN m
ORDER BY m.released
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which 5 movies have been directed by persons who also have an acting role in any movie?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE exists {
  MATCH (d)-[:ACTED_IN]->(:Movie)
}
RETURN m
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
What are the top 3 genres in which movies with an imdbRating above 8.0 fall?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.imdbRating > 8.0
RETURN g.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the first 5 actors who were born before 1900.,"MATCH (a:Actor)
WHERE a.born < date('1900-01-01')
RETURN a
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Which 3 movies have the highest budget-revenue ratio?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL AND m.revenue > 0
RETURN m.title, m.budget, m.revenue, (toFloat(m.budget) / m.revenue) AS budgetRevenueRatio
ORDER BY budgetRevenueRatio DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Show the top 5 users by the number of movies they have rated.,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN u, count(m) AS movies_rated
ORDER BY movies_rated DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
List the first 5 actors who have a poster URL listed on their profile.,"MATCH (a:Actor)
WHERE a.poster IS NOT NULL
RETURN a
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Which 3 directors have directed movies in more than one genre?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH d, count(DISTINCT g) AS genreCount
WHERE genreCount > 1
RETURN d.name, genreCount
ORDER BY genreCount DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 5 movies with the most distinct genres associated with them?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(DISTINCT g) AS genreCount
ORDER BY genreCount DESC
RETURN m.title, genreCount
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Show the first 3 movies that have been rated below 3.0 by any user.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE r.rating < 3.0
RETURN m
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 5 highest-grossing movies of 2006.,"MATCH (m:Movie)
WHERE m.year = 2006
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Which 3 actors have acted in movies with a runtime less than 90 minutes?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.runtime < 90
RETURN a.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 5 movies directed by directors born in the USA?,"MATCH (d:Director {bornIn: ""USA""})-[:DIRECTED]->(m:Movie)
RETURN m
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Who are the top 3 actors based on the number of movies they have acted in?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
RETURN a.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the 5 movies with the most languages spoken.,"MATCH (m:Movie)
RETURN m.title, m.languages
ORDER BY size(m.languages) DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 genres associated with movies that have been rated by at least 5 different users?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE exists {
  MATCH (u:User)-[:RATED]->(m)
  WITH m, count(DISTINCT u) AS userCount
  WHERE userCount >= 5
}
RETURN g.name AS Genre
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Show the top 5 movies with a budget greater than 100 million USD.,"MATCH (m:Movie)
WHERE m.budget > 100000000
RETURN m
ORDER BY m.budget DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Which 3 movies have the most number of votes cast by users?,"MATCH (m:Movie)<-[:RATED]-(:User)
RETURN m.title, count(*) AS votes
ORDER BY votes DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the top 3 movies with the highest imdbRating that were released in 1995?,"MATCH (m:Movie)
WHERE m.released STARTS WITH '1995' AND m.imdbRating IS NOT NULL
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the names of the top 5 movies with the highest revenue.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title AS MovieTitle, m.revenue AS Revenue
ORDER BY m.revenue DESC
LIMIT 5",Verbose query,recommendations,False,False,True,
List the first 5 actors who have a tmdbId and an imdbId listed on their profile.,"MATCH (a:Actor)
WHERE a.tmdbId IS NOT NULL AND a.imdbId IS NOT NULL
RETURN a
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Which 3 genres have the least number of movies associated with them?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, count(m) AS movieCount
ORDER BY movieCount ASC
LIMIT 3
RETURN g.name, movieCount",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies with a runtime less than 90 minutes?,"MATCH (m:Movie)
WHERE m.runtime < 90
RETURN m
ORDER BY m.runtime ASC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 3 actors by the number of IMDb votes they've received for their movies.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.imdbVotes IS NOT NULL
RETURN a.name, sum(m.imdbVotes) AS totalVotes
ORDER BY totalVotes DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which three directors were born in the USA?,"MATCH (d:Director {bornIn: ""USA""})
RETURN d.name
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies that were released in the USA?,"MATCH (m:Movie)
WHERE 'USA' IN m.countries
RETURN m
ORDER BY m.released
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 5 movies with the lowest revenue.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue ASC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Which three movies have the highest IMDb rating?,"MATCH (m:Movie)
WHERE m.imdbRating IS NOT NULL
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the top 3 highest rated movies by users?,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN m.title, AVG(r.rating) AS averageRating
ORDER BY averageRating DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the first 3 movies that have a budget greater than 100 million USD.,"MATCH (m:Movie)
WHERE m.budget > 100000000
RETURN m
ORDER BY m.budget DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which three actors have acted in the most movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
RETURN a.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which three users have the highest average rating given to movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, AVG(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN u.userId, u.name, avgRating",Simple Retrieval Queries,recommendations,False,False,True,
What are the top 3 genres by the number of movies?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS Genre, count(m) AS NumberOfMovies
ORDER BY NumberOfMovies DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,False,
Which three users have rated the most movies?,"MATCH (u:User)-[r:RATED]->(:Movie)
RETURN u, count(r) AS ratingsCount
ORDER BY ratingsCount DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies released after 2010?,"MATCH (m:Movie)
WHERE m.year > 2010
RETURN m
ORDER BY m.year ASC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 5 movies with the most number of IMDb votes.,"MATCH (m:Movie)
WHERE m.imdbVotes IS NOT NULL
RETURN m
ORDER BY m.imdbVotes DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Which three movies have the longest runtime?,"MATCH (m:Movie)
RETURN m
ORDER BY m.runtime DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the top 5 movies with the highest revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Name the top 5 movies with the highest budget to revenue ratio.,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL AND m.revenue > 0
RETURN m.title, m.budget, m.revenue, (toFloat(m.budget) / m.revenue) AS budgetToRevenueRatio
ORDER BY budgetToRevenueRatio DESC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,True,
Which 3 genres has 'Toy Story' been categorized under?,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,True,
List the top 5 actors who have acted in movies directed by 'Anthony Stacchi'.,"MATCH (d:Director {name: 'Anthony Stacchi'})-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(a:Actor)
RETURN a.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,True,
Which 3 movies have the lowest revenue despite having a high IMDb rating (over 7.0)?,"MATCH (m:Movie)
WHERE m.imdbRating > 7.0 AND m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue ASC
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,True,
List the top 3 directors by the number of movies directed.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, count(m) AS movies_directed
ORDER BY movies_directed DESC
LIMIT 3
RETURN d.name, movies_directed",Simple Retrieval Queries,recommendations,False,False,True,
List the top 3 movies with a plot mentioning 'love'.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'love'
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,False,
What are the first 3 movies that have a revenue to budget ratio greater than 3?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL AND m.revenue / m.budget > 3
RETURN m
ORDER BY m.revenue / m.budget DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which three actors have acted in movies in more than 3 different languages?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, count(DISTINCT m.languages) AS numLanguages
WHERE numLanguages > 3
RETURN a.name, numLanguages
ORDER BY numLanguages DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which three users have rated the oldest movies on average?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(m.year) AS avgYear
ORDER BY avgYear ASC
LIMIT 3
RETURN u",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies that have a language list containing 'Turkish'?,"MATCH (m:Movie)
WHERE 'Turkish' IN m.languages
RETURN m
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,False,
List the top 3 actors born in the 1980s.,"MATCH (a:Actor)
WHERE a.born >= date('1980-01-01') AND a.born <= date('1989-12-31')
RETURN a
ORDER BY a.born
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which three directors have the highest average IMDb rating for their movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH d, avg(m.imdbRating) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN d.name, avgRating",Simple Retrieval Queries,recommendations,True,False,False,
What are the first 3 movies with a plot mentioning 'zombie'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'zombie'
RETURN m
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 3 users who rated movies only in the 'Comedy' genre.,"MATCH (u:User)-[r:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Comedy'})
WITH u, count(DISTINCT m) AS comedyCount
WHERE NOT exists {
    (u)-[:RATED]->(m2:Movie)-[:IN_GENRE]->(g2:Genre)
    WHERE g2.name <> 'Comedy'
}
RETURN u
ORDER BY comedyCount DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which three genres have the least number of movies associated with them?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, count(m) AS movieCount
ORDER BY movieCount ASC
LIMIT 3
RETURN g.name, movieCount",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies with an IMDb rating greater than 8 and less than 9?,"MATCH (m:Movie)
WHERE m.imdbRating > 8 AND m.imdbRating < 9
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the first 3 directors who have died after 2000.,"MATCH (d:Director)
WHERE d.died > date(""2000-01-01"")
RETURN d
ORDER BY d.died ASC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which three movies feature both American and Japanese actors?,"MATCH (m:Movie)
WHERE exists {
  (m)<-[:ACTED_IN]-(a1:Actor {bornIn: 'USA'})
} AND exists {
  (m)<-[:ACTED_IN]-(a2:Actor {bornIn: 'Japan'})
}
RETURN m.title AS MovieTitle
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies with a poster URL containing 'face'?,"MATCH (m:Movie)
WHERE m.poster CONTAINS 'face'
RETURN m
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 3 actors who have acted in both comedy and drama genres.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name IN ['Comedy', 'Drama']
WITH a, count(DISTINCT g.name) AS genresCount
WHERE genresCount = 2
RETURN a.name, count(m) AS moviesCount
ORDER BY moviesCount DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which three directors have directed movies with a total revenue over 500 million USD?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.revenue > 500000000
RETURN d.name, sum(m.revenue) as totalRevenue
ORDER BY totalRevenue DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies with an IMDb rating lower than 5?,"MATCH (m:Movie)
WHERE m.imdbRating < 5
RETURN m
ORDER BY m.imdbRating ASC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,False,
List the top 3 movies that were most frequently rated by users.,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN m, count(r) AS ratingsCount
ORDER BY ratingsCount DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which three movies have the most diverse set of spoken languages?,"MATCH (m:Movie)
RETURN m.title, m.languages
ORDER BY size(m.languages) DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies where the main actor was born in France?,"MATCH (a:Actor {bornIn: ""France""})-[:ACTED_IN]->(m:Movie)
RETURN m
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 3 genres that have movies with an average IMDb rating over 7.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.imdbRating > 7
WITH g, avg(m.imdbRating) AS avgRating
ORDER BY avgRating DESC
RETURN g.name AS Genre, avgRating
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which three directors have directed movies in more than 2 different genres?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH d, count(DISTINCT g) AS genreCount
WHERE genreCount > 2
RETURN d.name, genreCount
ORDER BY genreCount DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies with a title starting with 'The'?,"MATCH (m:Movie)
WHERE m.title STARTS WITH 'The'
RETURN m
ORDER BY m.title
LIMIT 3",Simple Retrieval Queries,recommendations,True,False,False,
List the top 5 movies released in the 2000s.,"MATCH (m:Movie)
WHERE m.year >= 2000 AND m.year < 2010
RETURN m
ORDER BY m.year ASC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
What are the top 5 movies directed by directors born in Nebraska?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE d.bornIn = ""Nebraska""
RETURN m.title, m.year, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5",Complex Retrieval Queries,recommendations,True,False,False,
List the top 3 movies with the shortest runtime.,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m
ORDER BY m.runtime ASC
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,True,
Name the top 5 movies that have been rated by users named 'Omar Huffman'.,"MATCH (u:User {name: 'Omar Huffman'})-[:RATED]->(m:Movie)
RETURN m.title AS MovieTitle, m.imdbRating AS IMDbRating
ORDER BY m.imdbRating DESC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,True,
Which 3 actors have the most roles in comedy movies?,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: ""Comedy""})
WITH a, count(r.role) AS roles
ORDER BY roles DESC
LIMIT 3
RETURN a.name, roles",Complex Retrieval Queries,recommendations,False,False,False,
Which 3 users gave the highest ratings to the movie titled 'Toy Story'?,"MATCH (u:User)-[r:RATED]->(m:Movie {title: 'Toy Story'})
RETURN u.name, r.rating
ORDER BY r.rating DESC
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,True,
List the top 5 movies directed by a person named 'Graham Annable'.,"MATCH (d:Director {name: 'Graham Annable'})-[:DIRECTED]->(m:Movie)
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,True,
Show the top 5 actors with the longest bios.,"MATCH (a:Actor)
WHERE a.bio IS NOT NULL
RETURN a.name, a.bio, length(a.bio) AS bio_length
ORDER BY bio_length DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
List the first 5 movies with at least three different languages listed.,"MATCH (m:Movie)
WHERE size(m.languages) >= 3
RETURN m
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Which 3 users have rated movies with the most diverse range of imdbRatings?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, collect(m.imdbRating) AS ratings
WITH u, apoc.coll.min(ratings) AS minRating, apoc.coll.max(ratings) AS maxRating, maxRating - minRating AS range
ORDER BY range DESC
RETURN u.userId, u.name, range
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 genres of movies that have been directed by directors born after 1980?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE d.born > date('1980-01-01')
RETURN g.name AS Genre
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 5 directors with the most movies that have an imdbRating of 6 or higher.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating >= 6
WITH d, count(m) AS moviesCount
ORDER BY moviesCount DESC
LIMIT 5
RETURN d.name, moviesCount",Simple Retrieval Queries,recommendations,False,False,True,
Show the first 3 movies whose posters feature the color blue predominantly.,"MATCH (m:Movie)
WHERE m.poster CONTAINS ""blue""
RETURN m
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which 5 actors have acted in movies released in the most distinct years?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, collect(DISTINCT m.year) AS years
RETURN a.name, size(years) AS distinct_years
ORDER BY distinct_years DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
What are the top 3 movies with a plot involving a 'friendship'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'friendship'
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the first 5 movies with the highest number of directors involved.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH m, count(d) AS numDirectors
ORDER BY numDirectors DESC
RETURN m.title, numDirectors
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Which 3 actors have the most diverse range of genres in the movies they've acted in?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH a, COUNT(DISTINCT g) AS genreCount
ORDER BY genreCount DESC
LIMIT 3
RETURN a.name, genreCount",Simple Retrieval Queries,recommendations,False,False,True,
Show the top 5 genres of movies that have been rated by the most users.,"MATCH (u:User)-[:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, count(DISTINCT u) AS userCount
ORDER BY userCount DESC
RETURN g.name AS Genre, userCount
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
List the first 5 movies with a director who has also acted in a movie.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists {
    MATCH (d)-[:ACTED_IN]->(:Movie)
}
RETURN m
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Which 3 directors have directed both animated and non-animated movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists{(m)-[:IN_GENRE]->(:Genre {name: 'Animation'})}
WITH d, count(DISTINCT m) AS animatedCount
WHERE animatedCount > 0
MATCH (d)-[:DIRECTED]->(m2:Movie)
WHERE NOT exists{(m2)-[:IN_GENRE]->(:Genre {name: 'Animation'})}
WITH d, count(DISTINCT m2) AS nonAnimatedCount
WHERE nonAnimatedCount > 0
RETURN d.name
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies that have been released in exactly three different countries?,"MATCH (m:Movie)
WHERE size(m.countries) = 3
RETURN m
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 5 movies that have been rated by users with the most distinct names.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH m, COUNT(DISTINCT u.name) AS distinctUserNames
ORDER BY distinctUserNames DESC
RETURN m.title, distinctUserNames
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Show the first 3 actors who have acted in movies with a budget under 10 million USD.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.budget < 10000000
RETURN a
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which 5 directors have directed movies in more than three different countries?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, count(DISTINCT m.countries) AS numCountries
WHERE numCountries > 3
RETURN d.name, numCountries
ORDER BY numCountries DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
What are the top 3 movies with the shortest runtime?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m
ORDER BY m.runtime ASC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the first 5 movies with a plot involving an 'evil exterminator'.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'evil exterminator'
RETURN m
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Find the top 5 actors who have acted in more than 10 movies.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS movies_count
WHERE movies_count > 10
RETURN a.name, movies_count
ORDER BY movies_count DESC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,True,
Show the top 5 movies that have been rated exactly three times.,"MATCH (m:Movie)
WHERE count{(u:User)-[:RATED]->(m)} = 3
RETURN m
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
"What are the top 3 most profitable movies, considering the difference between revenue and budget?","MATCH (m:Movie)
WHERE m.revenue IS NOT NULL AND m.budget IS NOT NULL
RETURN m.title, m.revenue - m.budget AS profit
ORDER BY profit DESC
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,True,
Name the top 5 directors born in the USA.,"MATCH (d:Director {bornIn: ""USA""})
RETURN d.name
ORDER BY d.born DESC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,True,
What are the top 5 movies with the most distinct countries of origin?,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
RETURN m.title, size(m.countries) AS distinct_countries
ORDER BY distinct_countries DESC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,True,
List the 3 users who have given the lowest average ratings.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avgRating
ORDER BY avgRating ASC
LIMIT 3
RETURN u.userId, u.name, avgRating",Complex Retrieval Queries,recommendations,False,False,True,
Name the top 5 most voted movies on IMDb released after 2010.,"MATCH (m:Movie)
WHERE m.year > 2010
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,True,
Which 3 directors were born before 1900?,"MATCH (d:Director)
WHERE d.born < date('1900-01-01')
RETURN d
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,False,
List the top 5 actors with the most roles in movies released before 1980.,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)
WHERE m.year < 1980
RETURN a.name, count(r) AS roles
ORDER BY roles DESC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,True,
Which 3 movies have the highest number of languages spoken?,"MATCH (m:Movie)
RETURN m.title, size(m.languages) AS num_languages
ORDER BY num_languages DESC
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,True,
What are the top 5 movies in the 'Adventure' genre with the highest revenue?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Adventure'})
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,True,
List the top 3 directors who died after 2000.,"MATCH (d:Director)
WHERE d.died >= date('2000-01-01')
RETURN d
ORDER BY d.died DESC
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,True,
Name the top 5 movies with IMDb ratings lower than 5.0.,"MATCH (m:Movie)
WHERE m.imdbRating < 5.0
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating ASC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,True,
Which 3 users have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN u, count(m) AS movies_rated
ORDER BY movies_rated DESC
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,True,
What are the top 5 movies with a budget over $100 million?,"MATCH (m:Movie)
WHERE m.budget > 100000000
RETURN m
ORDER BY m.budget DESC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,True,
List 3 actors born in France who have directed a movie.,"MATCH (a:Actor)-[:DIRECTED]->(:Movie)
WHERE a.bornIn = 'France'
RETURN a
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,True,
Name the top 5 actors who have acted in movies with a runtime longer than 150 minutes.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.runtime > 150
RETURN a.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,True,
Which 3 movies have the highest IMDb votes?,"MATCH (m:Movie)
WHERE m.imdbVotes IS NOT NULL
RETURN m
ORDER BY m.imdbVotes DESC
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,True,
List the top 5 movies that have been rated after 2015.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE r.timestamp > 1451606400
RETURN m.title, m.year, r.rating
ORDER BY r.timestamp DESC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,True,
Which 3 directors have the longest filmography in the database?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, count(m) AS movies_directed
ORDER BY movies_directed DESC
LIMIT 3
RETURN d.name, movies_directed",Complex Retrieval Queries,recommendations,False,False,True,
What are the top 3 genres with the most movies?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS Genre, count(m) AS MovieCount
ORDER BY MovieCount DESC
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,True,
List the top 5 movies with an IMDb rating above 8.0.,"MATCH (m:Movie)
WHERE m.imdbRating > 8.0
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,True,
Which 3 actors have played roles in both acting and directing for the same movie?,"MATCH (a:Actor)-[r1:ACTED_IN]->(m:Movie)<-[r2:DIRECTED]-(a)
RETURN a.name, collect(m.title) AS movies, count(m) AS numberOfMovies
ORDER BY numberOfMovies DESC
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,True,
What are the top 5 highest-grossing movies of 2014?,"MATCH (m:Movie)
WHERE m.year = 2014
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,True,
List 3 movies released in 1995.,"MATCH (m:Movie)
WHERE m.released STARTS WITH '1995'
RETURN m
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,True,
Which 3 movies have been rated by the most users?,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN m.title, count(u) AS num_users
ORDER BY num_users DESC
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,False,
List the top 3 movies with a release date on or before '2000-01-01'.,"MATCH (m:Movie)
WHERE m.released <= '2000-01-01'
RETURN m
ORDER BY m.released DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 3 actors with the highest average imdbRating across movies they've acted in (minimum 3 movies).,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, avg(m.imdbRating) AS avgRating, count(m) AS moviesCount
WHERE moviesCount >= 3
RETURN a.name, avgRating
ORDER BY avgRating DESC
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
What are the top 5 movies with the highest imdbRating that were released in the 21st century?,"MATCH (m:Movie)
WHERE m.released >= ""2000-01-01"" AND m.imdbRating IS NOT NULL
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which genres have the most movies with a runtime over 120 minutes?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.runtime > 120
RETURN g.name AS Genre, count(m) AS MovieCount
ORDER BY MovieCount DESC",Complex Retrieval Queries,recommendations,False,False,True,
Name the top 5 movies with the most IMDb votes released before the year 2000.,"MATCH (m:Movie)
WHERE m.year < 2000 AND m.imdbVotes IS NOT NULL
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,True,
List the movies where the primary language is English and have a runtime of exactly 96 minutes.,"MATCH (m:Movie)
WHERE 'English' IN m.languages AND m.runtime = 96
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
Which movies have won more than 200 million dollars but were rated below 6.0 on IMDb?,"MATCH (m:Movie)
WHERE m.revenue > 200000000 AND m.imdbRating < 6.0
RETURN m.title, m.revenue, m.imdbRating",Complex Retrieval Queries,recommendations,False,False,True,
What are the three most common languages spoken in movies directed by Anthony Stacchi?,"MATCH (d:Director {name: ""Anthony Stacchi""})-[:DIRECTED]->(m:Movie)
UNWIND m.languages AS language
RETURN language, count(language) AS frequency
ORDER BY frequency DESC
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,False,
List the movies that have been both directed and acted in by the same person.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie), (p)-[:DIRECTED]->(m)
RETURN m.title AS MovieTitle, p.name AS PersonName",Complex Retrieval Queries,recommendations,False,False,True,
Name the actors who have acted in movies with a budget less than 50 million dollars.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.budget < 50000000
RETURN DISTINCT a.name",Complex Retrieval Queries,recommendations,False,False,True,
Which movies have a runtime longer than 180 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 180
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
Find the names of all directors who were born in France.,"MATCH (d:Director {bornIn: ""France""})
RETURN d.name",Complex Retrieval Queries,recommendations,False,False,True,
List the names of movies that have a plot mentioning 'friendship'.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'friendship'
RETURN m.title",Complex Retrieval Queries,recommendations,False,False,True,
What are the names of users who rated a movie from the 'Animation' genre?,"MATCH (u:User)-[:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN DISTINCT u.name",Complex Retrieval Queries,recommendations,False,False,True,
Which users rated the movie with an IMDb ID '0787474'?,"MATCH (m:Movie {imdbId: '0787474'})<-[:RATED]-(u:User)
RETURN u",Complex Retrieval Queries,recommendations,False,False,True,
What are the IMDb ratings of movies directed by François Lallement?,"MATCH (d:Director {name: ""François Lallement""})-[:DIRECTED]->(m:Movie)
RETURN m.title AS MovieTitle, m.imdbRating AS IMDbRating",Complex Retrieval Queries,recommendations,False,False,True,
Who are the top 5 actors by the number of movies acted in the 'Adventure' genre?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Adventure'})
WITH a, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 5
RETURN a.name, movies_count",Complex Retrieval Queries,recommendations,False,False,True,
List all genres associated with the movie 'Toy Story'.,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name",Complex Retrieval Queries,recommendations,False,False,True,
What are the three most recent movies added to the database?,"MATCH (m:Movie)
RETURN m
ORDER BY m.year DESC
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,True,
Name the top 5 highest-grossing movies directed by Harold Lloyd.,"MATCH (d:Director {name: ""Harold Lloyd""})-[:DIRECTED]->(m:Movie)
RETURN m.title AS MovieTitle, m.revenue AS Revenue
ORDER BY m.revenue DESC
LIMIT 5",Complex Retrieval Queries,recommendations,True,False,False,
"Which movies have been rated by more than 600,000 IMDb users?","MATCH (m:Movie)
WHERE m.imdbVotes > 600000
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
Who are the actors in the movie titled 'Open Season'?,"MATCH (m:Movie {title: 'Open Season'})<-[:ACTED_IN]-(a:Actor)
RETURN a.name AS ActorName",Complex Retrieval Queries,recommendations,False,False,True,
List the names of 3 directors who directed a movie released after 2010.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.year > 2010
RETURN d.name
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,True,
List the top 3 highest revenue movies released in the 2000s.,"MATCH (m:Movie)
WHERE m.released >= '2000-01-01' AND m.released < '2010-01-01' AND m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,True,
What are the top 3 countries producing movies with a revenue over 500 million dollars?,"MATCH (m:Movie)
WHERE m.revenue > 500000000
UNWIND m.countries AS country
RETURN country, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,False,
Who are the directors of movies that have an IMDb rating greater than 8.0?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating > 8.0
RETURN d.name, m.title, m.imdbRating",Complex Retrieval Queries,recommendations,False,False,True,
List the movies that have been rated by user '1'.,"MATCH (u:User {userId: '1'})-[:RATED]->(m:Movie)
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
Which movies have been rated by user '1' and have a rating greater than 8?,"MATCH (u:User {userId: '1'})-[:RATED {rating: r}]->(m:Movie)
WHERE r > 8
RETURN m",Simple Aggregation Queries,recommendations,False,False,True,
"What are the top 5 movies by IMDB rating that have more than 100,000 IMDB votes?","MATCH (m:Movie)
WHERE m.imdbVotes > 100000
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
Who are the top 5 directors by the number of movies they have directed?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, count(m) AS movies_directed
ORDER BY movies_directed DESC
LIMIT 5
RETURN d.name, movies_directed",Simple Aggregation Queries,recommendations,False,False,True,
What are the top 3 genres by the number of movies?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS Genre, count(m) AS NumberOfMovies
ORDER BY NumberOfMovies DESC
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
Which 5 actors have acted in the most movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
RETURN a.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
List 3 movies directed by 'Anthony Stacchi'.,"MATCH (d:Director {name: 'Anthony Stacchi'})-[:DIRECTED]->(m:Movie)
RETURN m
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
What are the top 5 highest-grossing movies that were released before 2010?,"MATCH (m:Movie)
WHERE m.released < ""2010-01-01"" AND m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
Which movies have a runtime greater than 120 minutes and were released after 2000?,"MATCH (m:Movie)
WHERE m.runtime > 120 AND m.released > '2000-01-01'
RETURN m",Simple Aggregation Queries,recommendations,False,False,True,
Name the movies that have been acted in and directed by the same person.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE exists {
  (p)-[:DIRECTED]->(m)
}
RETURN m.title AS MovieTitle",Complex Retrieval Queries,recommendations,False,False,True,
What are the IMDb ratings of movies that have a plot mentioning 'evil exterminator'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'evil exterminator'
RETURN m.title, m.imdbRating",Complex Retrieval Queries,recommendations,False,False,True,
List movies with a revenue less than 20 million dollars and released before 1980.,"MATCH (m:Movie)
WHERE m.revenue < 20000000 AND m.released < '1980-01-01'
RETURN m",Complex Retrieval Queries,recommendations,True,False,False,
Name the genres of movies that have a plot mentioning 'army'.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.plot CONTAINS 'army'
RETURN DISTINCT g.name",Complex Retrieval Queries,recommendations,False,False,True,
Which movies have been rated by users named 'Omar Huffman'?,"MATCH (u:User {name: 'Omar Huffman'})-[:RATED]->(m:Movie)
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
List the top 3 actors by the number of roles in movies released after 2010.,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)
WHERE m.year > 2010
RETURN a.name, count(r) AS roles
ORDER BY roles DESC
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,True,
Name the movies that have posters ending with 'w5Lctmkc1yah215Luxmci4djaiW.jpg'.,"MATCH (m:Movie)
WHERE m.poster ENDS WITH 'w5Lctmkc1yah215Luxmci4djaiW.jpg'
RETURN m.title",Complex Retrieval Queries,recommendations,False,False,True,
Which users have rated movies directed by directors born after 1960?,"MATCH (u:User)-[:RATED]->(m:Movie)<-[:DIRECTED]-(d:Director)
WHERE d.born > date('1960-01-01')
RETURN DISTINCT u",Complex Retrieval Queries,recommendations,False,False,False,
Name genres in which Harold Lloyd has directed movies.,"MATCH (d:Director {name: ""Harold Lloyd""})-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN DISTINCT g.name",Complex Retrieval Queries,recommendations,False,False,True,
List the top 3 movies with the highest budget to revenue ratio.,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL AND m.revenue > 0
RETURN m.title, m.budget, m.revenue, (toFloat(m.budget) / m.revenue) AS budgetToRevenueRatio
ORDER BY budgetToRevenueRatio DESC
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,True,
Name the movies where the main language is not English and have a budget over 75 million dollars.,"MATCH (m:Movie)
WHERE 'English' NOT IN m.languages AND m.budget > 75000000
RETURN m.title AS MovieTitle",Complex Retrieval Queries,recommendations,False,False,True,
"What are the names of the movies directed by persons born in 'Burchard, Nebraska, USA'?","MATCH (d:Director {bornIn: 'Burchard, Nebraska, USA'})-[:DIRECTED]->(m:Movie)
RETURN m.title AS MovieName",Complex Retrieval Queries,recommendations,False,False,True,
Which actors have appeared in movies released in the 'Comedy' genre?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Comedy'})
RETURN DISTINCT a.name",Complex Retrieval Queries,recommendations,False,False,True,
What are the names of the top 5 movies with a budget over 100 million dollars?,"MATCH (m:Movie)
WHERE m.budget > 100000000
RETURN m.title AS MovieName
ORDER BY m.budget DESC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,True,
Show the top 5 oldest movies that have been rated by at least 5 different users.,"MATCH (m:Movie)<-[:RATED]-(u:User)
WITH m, count(DISTINCT u) AS userCount
WHERE userCount >= 5
RETURN m
ORDER BY m.year ASC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Identify the first 3 movies that have been rated by users younger than 25.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE u.age < 25
RETURN m
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,User.age
Which 5 users have the most ratings in the 'Comedy' genre?,"MATCH (u:User)-[r:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Comedy'})
WITH u, count(r) AS ratingsCount
ORDER BY ratingsCount DESC
LIMIT 5
RETURN u, ratingsCount",Simple Retrieval Queries,recommendations,False,False,True,
List the first 5 directors who have a biography listed in the database.,"MATCH (d:Director)
WHERE d.bio IS NOT NULL
RETURN d
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
What are the top 3 oldest movies in the database?,"MATCH (m:Movie)
WHERE m.year IS NOT NULL
RETURN m
ORDER BY m.year ASC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Identify the first 5 actors who have acted in movies with a budget less than 50 million dollars.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.budget < 50000000
RETURN a
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Show the top 3 highest-grossing movies of the 2000s.,"MATCH (m:Movie)
WHERE m.year >= 2000 AND m.year < 2010 AND m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which 5 users have rated movies primarily in the 'Drama' genre?,"MATCH (u:User)-[:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Drama'})
WITH u, count(m) AS DramaCount
WHERE exists {
    MATCH (u)-[:RATED]->(m2:Movie)
    WITH count(m2) AS TotalCount, DramaCount
    WHERE DramaCount > TotalCount / 2
}
RETURN u
ORDER BY DramaCount DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
List the first 5 movies that involve actors born in France.,"MATCH (a:Actor {bornIn: 'France'})-[:ACTED_IN]->(m:Movie)
RETURN m
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,False,
What are the top 3 movies with the highest IMDb ratings that were released in the 1990s?,"MATCH (m:Movie)
WHERE m.released >= '1990-01-01' AND m.released < '2000-01-01' AND m.imdbRating IS NOT NULL
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which 5 directors were born in the USA and have directed at least 3 movies?,"MATCH (d:Director {bornIn: 'USA'})
WITH d, count{(d)-[:DIRECTED]->(:Movie)} AS directedMovies
WHERE directedMovies >= 3
RETURN d
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
List the first 3 actors who have played roles in both comedy and action movies.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name IN ['Comedy', 'Action']
WITH a, collect(DISTINCT g.name) AS genres
WHERE ALL(x IN ['Comedy', 'Action'] WHERE x IN genres)
RETURN a
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Show the top 5 movies with revenues exceeding 1 billion dollars.,"MATCH (m:Movie)
WHERE m.revenue > 1000000000
RETURN m
ORDER BY m.revenue DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Identify the first 3 genres most frequently linked to movies directed by 'Steven Spielberg'.,"MATCH (d:Director {name: 'Steven Spielberg'})-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS Genre, count(m) AS MoviesCount
ORDER BY MoviesCount DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which 5 movies have the most number of votes on IMDb?,"MATCH (m:Movie)
WHERE m.imdbVotes IS NOT NULL
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
List the top 3 users who have given the highest average ratings.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN u.userId, u.name, avgRating",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 5 movies that were rated by users named 'John Smith'?,"MATCH (u:User {name: 'John Smith'})-[:RATED]->(m:Movie)
RETURN m
LIMIT 5",Simple Retrieval Queries,recommendations,True,False,False,
Show the top 3 actors who have acted in movies that generated over 500 million in revenue.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.revenue > 500000000
RETURN a.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which 5 directors have directed at least 5 movies with an IMDb rating above 7.0?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating > 7.0
WITH d, count(m) AS moviesDirected
WHERE moviesDirected >= 5
RETURN d.name, moviesDirected
ORDER BY moviesDirected DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
List the first 3 movies with a budget over 100 million dollars.,"MATCH (m:Movie)
WHERE m.budget > 100000000
RETURN m
ORDER BY m.budget DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the top 3 genres associated with movies released after 2000?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.year > 2000
RETURN g.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Identify the top 5 actors who have acted in more than 10 movies.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS movies_count
WHERE movies_count > 10
RETURN a.name, movies_count
ORDER BY movies_count DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Which 5 users have rated more than 20 movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(m) AS movie_count
WHERE movie_count > 20
RETURN u
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,False,
List the first 3 directors born before 1950.,"MATCH (d:Director)
WHERE d.born < date('1950-01-01')
RETURN d
ORDER BY d.born
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which 5 movies have the most detailed plots (based on the length of the plot text)?,"MATCH (m:Movie)
WHERE m.plot IS NOT NULL
RETURN m
ORDER BY length(m.plot) DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
List the movies that have grossed over 1 billion USD in revenue.,"MATCH (m:Movie)
WHERE m.revenue > 1000000000
RETURN m",Simple Aggregation Queries,recommendations,False,False,True,
Show the top 3 movies that have been rated by the oldest users.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, m, r ORDER BY u.born ASC
RETURN m.title, m.year, m.imdbRating, collect(r.rating)[..3] AS ratings
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 3 movies that have been released on Christmas Day.,"MATCH (m:Movie)
WHERE m.released ENDS WITH ""-12-25""
RETURN m
ORDER BY m.year DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 3 movies with a budget under 10 million that have generated over 100 million in revenue.,"MATCH (m:Movie)
WHERE m.budget < 10000000 AND m.revenue > 100000000
RETURN m
ORDER BY m.revenue DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 5 movies to have a poster URL containing 'face'?,"MATCH (m:Movie)
WHERE m.poster CONTAINS 'face'
RETURN m
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Show the top 5 highest IMDb rated movies directed by female directors.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE d.gender = 'female' AND m.imdbRating IS NOT NULL
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,Director.gender
Identify the first 3 actors who have acted in movies with at least three different directors.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(d:Director)
WITH a, m, count(DISTINCT d) AS numDirectors
WHERE numDirectors >= 3
RETURN a.name, collect(m.title) AS movies
ORDER BY a.name
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which 5 directors have directed movies in more than 3 different genres?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH d, count(DISTINCT g) AS genreCount
WHERE genreCount > 3
RETURN d.name, genreCount
ORDER BY genreCount DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
List the top 3 movies with the most revenue that have a runtime under 90 minutes.,"MATCH (m:Movie)
WHERE m.runtime < 90 AND m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 5 movies with a plot containing the word 'adventure'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'adventure'
RETURN m
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Show the top 5 movies with the most IMDb votes released after 2010.,"MATCH (m:Movie)
WHERE m.year > 2010 AND m.imdbVotes IS NOT NULL
RETURN m
ORDER BY m.imdbVotes DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Identify the first 3 users who have rated movies released before 1980.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE m.released < ""1980-01-01""
RETURN u
ORDER BY r.timestamp
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which 5 movies have been rated exactly 5 times by users?,"MATCH (m:Movie)
WHERE count{(u:User)-[:RATED]->(m)} = 5
RETURN m
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
List the top 3 directors who have also acted in a movie they directed.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists{(d)-[:ACTED_IN]->(m)}
RETURN d.name, collect(m.title) AS movies
ORDER BY size(movies) DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 5 movies where the main actor has also directed the film?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(a)
RETURN m.title AS MovieTitle, a.name AS ActorDirector
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Show the top 5 movies with the most languages spoken.,"MATCH (m:Movie)
RETURN m.title, m.languages
ORDER BY size(m.languages) DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Identify the first 3 movies with the most number of genres associated.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(g) AS genreCount
ORDER BY genreCount DESC
RETURN m.title, genreCount
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which 5 users have rated the most number of 'Horror' movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Horror'})
WITH u, count(m) AS horrorMovieCount
ORDER BY horrorMovieCount DESC
LIMIT 5
RETURN u, horrorMovieCount",Simple Retrieval Queries,recommendations,False,False,True,
List the top 5 oldest actors in the database.,"MATCH (a:Actor)
WHERE a.born IS NOT NULL
RETURN a.name, a.born
ORDER BY a.born
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
What are the top 3 highest-budget films directed by directors born in the UK?,"MATCH (d:Director {bornIn: 'UK'})-[:DIRECTED]->(m:Movie)
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the first 5 movies that have been rated by users from more than 10 different countries.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH m, count(DISTINCT u) AS userCount
WHERE userCount > 10
RETURN m
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Show the top 5 movies with the shortest runtime.,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m
ORDER BY m.runtime ASC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
Identify the first 3 directors who have directed a movie with an IMDb rating lower than 4.0.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating < 4.0
RETURN d
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which 5 actors have the highest number of credited roles in the database?,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)
WHERE r.role IS NOT NULL
RETURN a.name, count(r) AS roles_count
ORDER BY roles_count DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 5 genres associated with movies having the most languages available?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS Genre, count(m.languages) AS LanguageCount
ORDER BY LanguageCount DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,False,
Which directors have directed movies in both the 'Horror' and 'Romance' genres?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name = 'Horror'
WITH d, collect(m) AS horrorMovies
WHERE exists {
    MATCH (d)-[:DIRECTED]->(m2:Movie)-[:IN_GENRE]->(g2:Genre)
    WHERE g2.name = 'Romance'
}
RETURN d.name, count(horrorMovies) AS HorrorMoviesDirected",Complex Aggregation Queries,recommendations,False,False,True,
What are the top 3 longest movies by runtime?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m
ORDER BY m.runtime DESC
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
Which 5 movies have the most diverse language offerings?,"MATCH (m:Movie)
RETURN m.title, m.languages
ORDER BY size(m.languages) DESC
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
List the top 3 movies with the highest budget to revenue ratio.,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL AND m.revenue > 0
RETURN m.title, m.budget, m.revenue, (toFloat(m.budget) / m.revenue) AS budgetToRevenueRatio
ORDER BY budgetToRevenueRatio DESC
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
Which actors have acted in both 'Comedy' and 'Drama' genres?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name = 'Comedy'
WITH a, count(DISTINCT m) AS ComedyMovies
WHERE ComedyMovies > 0
MATCH (a)-[:ACTED_IN]->(m2:Movie)-[:IN_GENRE]->(g2:Genre)
WHERE g2.name = 'Drama'
RETURN DISTINCT a.name",Complex Aggregation Queries,recommendations,True,False,False,
What are the 5 most recent movies directed by directors born in the USA?,"MATCH (d:Director {bornIn: ""USA""})-[:DIRECTED]->(m:Movie)
WHERE m.released IS NOT NULL
RETURN m.title, m.released
ORDER BY m.released DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
List the top 3 genres with the most movies associated with them.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3
RETURN g.name AS Genre, movieCount",Complex Aggregation Queries,recommendations,False,False,True,
Which users have rated more than 5 movies with a rating above 7.0?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE r.rating > 7.0
WITH u, count(m) AS moviesRated
WHERE moviesRated > 5
RETURN u",Complex Aggregation Queries,recommendations,False,False,True,
What are the top 5 movies with the most countries listed in their production?,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
RETURN m.title, size(m.countries) AS num_countries
ORDER BY num_countries DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
List the top 3 movies with the highest number of imdbVotes.,"MATCH (m:Movie)
WHERE m.imdbVotes IS NOT NULL
RETURN m
ORDER BY m.imdbVotes DESC
LIMIT 3",Complex Aggregation Queries,recommendations,False,True,False,
Which directors have directed more than one movie in the 'Drama' genre?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Drama'})
WITH d, count(m) AS movies_count
WHERE movies_count > 1
RETURN d.name, movies_count",Complex Aggregation Queries,recommendations,False,False,True,
What are the top 5 oldest actors who have acted in English language movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE 'English' IN m.languages
RETURN a.name, a.born
ORDER BY a.born
LIMIT 5",Complex Aggregation Queries,recommendations,True,False,False,
Which movies have been rated by more than 1000 users?,"MATCH (m:Movie)
WHERE size((:User)-[:RATED]->(m)) > 1000
RETURN m",Complex Aggregation Queries,recommendations,False,False,True,
List the top 3 highest imdbRating movies that were released before the year 2000.,"MATCH (m:Movie)
WHERE m.year < 2000 AND m.imdbRating IS NOT NULL
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
What are the top 5 movies by revenue released in 1995?,"MATCH (m:Movie)
WHERE m.released STARTS WITH '1995' AND m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which movies have been acted in by persons born before 1900?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born < date('1900-01-01')
RETURN m",Pathfinding Queries,recommendations,False,False,True,
"What are the IMDb IDs of movies that have more than 500,000 IMDb votes?","MATCH (m:Movie)
WHERE m.imdbVotes > 500000
RETURN m.imdbId",Pathfinding Queries,recommendations,False,False,True,
"Find all movies that have been rated after January 1st, 2015.","MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE r.timestamp > 1420070400
RETURN m",Pathfinding Queries,recommendations,False,False,True,
List the top 3 movies with the shortest runtime.,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m
ORDER BY m.runtime ASC
LIMIT 3",Pathfinding Queries,recommendations,False,False,True,
Which movies have a plot description longer than 150 characters?,"MATCH (m:Movie)
WHERE length(m.plot) > 150
RETURN m",Pathfinding Queries,recommendations,False,False,True,
"What is the total revenue generated by movies directed by directors born in 'Burchard, Nebraska, USA'?","MATCH (d:Director {bornIn: 'Burchard, Nebraska, USA'})-[:DIRECTED]->(m:Movie)
RETURN sum(m.revenue) AS TotalRevenue",Pathfinding Queries,recommendations,False,False,True,
List the movies that have a plot mentioning 'kingdom'.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'kingdom'
RETURN m",Pathfinding Queries,recommendations,False,False,False,
Which directors have a poster URL that includes 'w440_and_h660_face'?,"MATCH (d:Director)
WHERE d.poster CONTAINS 'w440_and_h660_face'
RETURN d",Pathfinding Queries,recommendations,False,False,True,
Which movies have a runtime longer than 150 minutes and less than 200 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 150 AND m.runtime < 200
RETURN m",Complex Aggregation Queries,recommendations,False,False,True,
What are the top 5 movies that have the most languages spoken in them?,"MATCH (m:Movie)
RETURN m.title, size(m.languages) AS num_languages
ORDER BY num_languages DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which actors have never acted in a movie released after 2010?,"MATCH (a:Actor)
WHERE NOT EXISTS {
    MATCH (a)-[:ACTED_IN]->(m:Movie)
    WHERE m.year > 2010
}
RETURN a.name",Complex Aggregation Queries,recommendations,False,False,True,
List the top 3 movies that have the highest revenue and were released in 2014.,"MATCH (m:Movie)
WHERE m.released STARTS WITH '2014' AND m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
List the top 3 movies with a plot involving 'love' that have a runtime over 120 minutes.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'love' AND m.runtime > 120
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
Which actors have acted in both high-budget (over 200 million dollars) and low-budget (under 10 million dollars) movies?,"MATCH (a:Actor)-[:ACTED_IN]->(high:Movie)
WHERE high.budget > 200000000
WITH a
MATCH (a)-[:ACTED_IN]->(low:Movie)
WHERE low.budget < 10000000
RETURN DISTINCT a",Complex Aggregation Queries,recommendations,False,False,False,
What are the top 5 directors who have directed movies that won an academy award?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists{(m)-[:WON]->(:Award {name: ""Academy Award""})}
RETURN d.name, count(m) AS moviesDirected
ORDER BY moviesDirected DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,False,Award
What are the top 5 directors who have directed movies that won an academy award?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists{(m)-[:WON]->(:Award {name: ""Academy Award""})}
RETURN d.name, count(m) AS moviesDirected
ORDER BY moviesDirected DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,False,WON
What are the top 5 directors who have directed movies that won an academy award?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists{(m)-[:WON]->(:Award {name: ""Academy Award""})}
RETURN d.name, count(m) AS moviesDirected
ORDER BY moviesDirected DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,False,Award.name
List the top 3 actors by number of movies acted in that were released in the 1990s.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.released >= '1990-01-01' AND m.released < '2000-01-01'
RETURN a.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
Which movies have more than five genres associated with their production?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(g) AS genreCount
WHERE genreCount > 5
RETURN m",Complex Aggregation Queries,recommendations,False,False,True,
What are the top 5 movies with the most distinct genres associated with them?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(DISTINCT g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN m.title, genreCount",Complex Aggregation Queries,recommendations,False,False,True,
List the top 3 highest grossing movies of 2013.,"MATCH (m:Movie)
WHERE m.year = 2013
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
Which directors were born in France and have directed at least two movies?,"MATCH (d:Director {bornIn: 'France'})-[:DIRECTED]->(m:Movie)
WITH d, count(m) AS moviesDirected
WHERE moviesDirected >= 2
RETURN d.name, moviesDirected",Complex Aggregation Queries,recommendations,False,False,True,
What are the top 5 actors who have acted in movies directed by Denzel Washington?,"MATCH (d:Director {name: ""Denzel Washington""})-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(a:Actor)
RETURN a.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
List the top 3 movies with the lowest imdbRating that have been rated by more than 500 users.,"MATCH (m:Movie)
WHERE exists {
  (u:User)-[:RATED]->(m)
}
WITH m, count{(u:User)-[:RATED]->(m)} AS ratingsCount
WHERE ratingsCount > 500
RETURN m
ORDER BY m.imdbRating ASC
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
Which users have rated the same movie more than once?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, m, count(r) AS num_ratings
WHERE num_ratings > 1
RETURN u AS User, m AS Movie, num_ratings",Complex Aggregation Queries,recommendations,False,False,True,
What are the top 5 movies with the highest number of actors involved?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH m, count(a) AS numActors
ORDER BY numActors DESC
LIMIT 5
RETURN m.title, numActors",Complex Aggregation Queries,recommendations,False,False,True,
List the top 3 movies with the smallest difference between budget and revenue.,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m, abs(m.revenue - m.budget) AS difference
ORDER BY difference ASC
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
Which directors have directed movies in more than three different languages?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, collect(DISTINCT m.languages) AS languages
WHERE size(languages) > 3
RETURN d.name, languages",Complex Aggregation Queries,recommendations,False,False,True,
What are the top 5 actors by number of movies acted in with a revenue greater than 500 million dollars?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.revenue > 500000000
WITH a, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 5
RETURN a.name, movies_count",Complex Aggregation Queries,recommendations,False,False,True,
List the top 3 movies with the lowest imdbVotes released after 2000.,"MATCH (m:Movie)
WHERE m.year > 2000 AND m.imdbVotes IS NOT NULL
RETURN m
ORDER BY m.imdbVotes ASC
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
Which actors have the most roles in movies with a budget over 100 million dollars?,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)
WHERE m.budget > 100000000
RETURN a.name, count(r.role) AS roles_count
ORDER BY roles_count DESC",Complex Aggregation Queries,recommendations,False,False,True,
What are the 5 most recent movies with a runtime less than 90 minutes?,"MATCH (m:Movie)
WHERE m.runtime < 90 AND m.released IS NOT NULL
RETURN m
ORDER BY m.released DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
List the genres that have movies with an imdbRating less than 4.0.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.imdbRating < 4.0
RETURN DISTINCT g.name",Complex Aggregation Queries,recommendations,False,False,True,
Which users have the highest average rating given to movies? (minimum 3 ratings),"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avgRating, count(r) AS numRatings
WHERE numRatings >= 3
RETURN u, avgRating
ORDER BY avgRating DESC",Complex Aggregation Queries,recommendations,False,False,True,
What are the top 5 directors by number of movies directed in the 'Action' genre?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Action'})
WITH d, count(m) AS moviesDirected
ORDER BY moviesDirected DESC
LIMIT 5
RETURN d.name, moviesDirected",Complex Aggregation Queries,recommendations,False,False,True,
What are the names of the users who rated the movie 'Dracula Untold'?,"MATCH (u:User)-[:RATED]->(m:Movie {title: 'Dracula Untold'})
RETURN u.name",Pathfinding Queries,recommendations,False,False,True,
Which actor has the most diverse filmography in terms of genres acted in?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH a, COUNT(DISTINCT g) AS genreCount
RETURN a.name AS ActorName, genreCount
ORDER BY genreCount DESC
LIMIT 1",Pathfinding Queries,recommendations,False,False,False,
List all the movies that have been both directed and acted in by the same person.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS MovieTitle, p.name AS PersonName",Pathfinding Queries,recommendations,False,False,True,
What are the different roles played by actors in the movie with the IMDb ID '0829150'?,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie {imdbId: '0829150'})
RETURN a.name AS ActorName, r.role AS Role",Pathfinding Queries,recommendations,False,False,True,
List the top 5 movies with the highest IMDb rating.,"MATCH (m:Movie)
WHERE m.imdbRating IS NOT NULL
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 5",Pathfinding Queries,recommendations,False,False,True,
Which movies have been rated by more than three users?,"MATCH (m:Movie)<-[:RATED]-(u:User)
WITH m, count(u) AS userCount
WHERE userCount > 3
RETURN m",Pathfinding Queries,recommendations,False,False,True,
What movies have a runtime longer than 120 minutes and were released after 2000?,"MATCH (m:Movie)
WHERE m.runtime > 120 AND m.released >= '2000-01-01'
RETURN m",Pathfinding Queries,recommendations,False,False,True,
Which actors have featured in movies released in multiple languages?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE size(m.languages) > 1
RETURN DISTINCT a.name",Simple Aggregation Queries,recommendations,False,False,True,
List the 3 directors who have directed the most movies of a single genre.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH d, g, count(m) AS movies_count
ORDER BY movies_count DESC
RETURN d.name, g.name, movies_count
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
Which movies have been rated by more than 1000 users?,"MATCH (m:Movie)<-[:RATED]-(u:User)
WITH m, count(u) AS userCount
WHERE userCount > 1000
RETURN m",Simple Aggregation Queries,recommendations,False,False,True,
What are the top 3 highest budget movies that failed to gross more than their budget?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL AND m.revenue < m.budget
RETURN m
ORDER BY m.budget DESC
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
List 5 genres that have the least number of movies associated with them.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, count(m) AS movieCount
ORDER BY movieCount ASC
LIMIT 5
RETURN g.name, movieCount",Simple Aggregation Queries,recommendations,False,False,False,
Which 3 users have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN u, count(m) AS movies_rated
ORDER BY movies_rated DESC
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
What are the most recent 3 movies directed by any director born in Canada?,"MATCH (d:Director {bornIn: ""Canada""})-[:DIRECTED]->(m:Movie)
RETURN m
ORDER BY m.year DESC
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
Which movies have both high revenue (over 500 million USD) and high imdbRating (above 8.0)?,"MATCH (m:Movie)
WHERE m.revenue > 500000000 AND m.imdbRating > 8.0
RETURN m",Simple Aggregation Queries,recommendations,False,False,True,
List the 3 oldest directors based on their birth date.,"MATCH (d:Director)
WHERE d.born IS NOT NULL
RETURN d
ORDER BY d.born
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
Who are the 5 most frequent actors in the 'Adventure' genre?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Adventure'})
WITH a, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 5
RETURN a.name, movies_count",Simple Aggregation Queries,recommendations,False,False,True,
Which actors have played in a movie and also directed a movie?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE exists {
  MATCH (a)-[:DIRECTED]->(m2:Movie)
}
RETURN DISTINCT a.name",Simple Aggregation Queries,recommendations,False,False,True,
What are the top 3 movies by revenue released in 2014?,"MATCH (m:Movie)
WHERE m.year = 2014 AND m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
Which 3 movies feature both English and Japanese languages?,"MATCH (m:Movie)
WHERE 'English' IN m.languages AND 'Japanese' IN m.languages
RETURN m
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
List the movies that have a budget greater than 200 million USD.,"MATCH (m:Movie)
WHERE m.budget > 200000000
RETURN m",Simple Aggregation Queries,recommendations,False,False,True,
"What are the top 5 highest-rated movies by users, based on the average user rating?","MATCH (u:User)-[r:RATED]->(m:Movie)
WITH m, avg(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 5
RETURN m.title, avgRating",Simple Aggregation Queries,recommendations,False,False,True,
Which directors were born in the USA?,"MATCH (d:Director)
WHERE d.bornIn = ""USA""
RETURN d.name, d.born, d.died, d.url, d.imdbId, d.tmdbId",Simple Aggregation Queries,recommendations,False,False,True,
List 3 movies that were released in the 1990s and have an IMDB rating above 7.,"MATCH (m:Movie)
WHERE m.released >= '1990-01-01' AND m.released < '2000-01-01' AND m.imdbRating > 7
RETURN m
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
What are the 3 most common countries for movie settings in the database?,"MATCH (m:Movie)
UNWIND m.countries AS country
RETURN country, count(country) AS count
ORDER BY count DESC
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
What are the names of actors who have acted in more than five movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS numMovies
WHERE numMovies > 5
RETURN a.name",Pathfinding Queries,recommendations,False,False,True,
Provide the names of 3 actors who have also directed movies.,"MATCH (a:Actor)-[:DIRECTED]->(:Movie)
RETURN DISTINCT a.name
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
Which users have rated movies in the 'Adventure' genre?,"MATCH (u:User)-[:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Adventure'})
RETURN DISTINCT u",Pathfinding Queries,recommendations,False,False,True,
Find all movies where the revenue was more than double the budget.,"MATCH (m:Movie)
WHERE m.revenue > 2 * m.budget
RETURN m",Pathfinding Queries,recommendations,False,False,True,
Which users have rated a movie but have not rated any movie in the 'Sci-Fi' genre?,"MATCH (u:User)-[:RATED]->(m:Movie)
WHERE NOT EXISTS {
    MATCH (u)-[:RATED]->(m2:Movie)-[:IN_GENRE]->(g:Genre {name: 'Sci-Fi'})
}
RETURN DISTINCT u",Pathfinding Queries,recommendations,False,False,True,
List the top 5 movies by revenue that were released in the last five years of the schema's data range.,"MATCH (m:Movie)
WHERE m.released >= ""2011-01-01"" AND m.released <= ""2016-12-31"" AND m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 5",Pathfinding Queries,recommendations,False,False,True,
Which directors have directed movies in more than two languages?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE size(m.languages) > 2
RETURN d.name, collect(m.title) AS movies",Pathfinding Queries,recommendations,False,False,True,
Find movies where the sum of the revenue and budget is more than 1 billion dollars.,"MATCH (m:Movie)
WHERE (m.revenue + m.budget) > 1000000000
RETURN m",Pathfinding Queries,recommendations,False,False,True,
Which movies have been rated exactly 5 by more than one user?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE r.rating = 5
WITH m, count(u) AS userCount
WHERE userCount > 1
RETURN m",Pathfinding Queries,recommendations,False,False,True,
What is the average IMDb rating of movies with a runtime under 90 minutes?,"MATCH (m:Movie)
WHERE m.runtime < 90 AND m.imdbRating IS NOT NULL
RETURN AVG(m.imdbRating) AS averageRating",Pathfinding Queries,recommendations,False,False,False,
Which movie had the largest number of actors participating?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
RETURN m.title AS Movie, count(a) AS NumberOfActors
ORDER BY NumberOfActors DESC
LIMIT 1",Pathfinding Queries,recommendations,False,False,True,
How many genres has each movie been classified under?,"MATCH (m:Movie)
RETURN m.title AS MovieTitle, count{(m)-[:IN_GENRE]->(:Genre)} AS GenreCount",Pathfinding Queries,recommendations,False,False,True,
What are the top 5 highest-grossing movies of 2014?,"MATCH (m:Movie)
WHERE m.year = 2014
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5",Pathfinding Queries,recommendations,False,False,True,
Which movies feature actors born in France?,"MATCH (a:Actor {bornIn: ""France""})-[:ACTED_IN]->(m:Movie)
RETURN m",Pathfinding Queries,recommendations,False,False,True,
Can you list all genres that a movie with the title 'Toy Story' falls under?,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name",Pathfinding Queries,recommendations,False,False,True,
Which actor has the highest number of roles in movies released before 1980?,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)
WHERE m.year < 1980
RETURN a.name, count(r) AS roles
ORDER BY roles DESC
LIMIT 1",Pathfinding Queries,recommendations,False,False,False,
How many users have rated the movie with the IMDb ID '0114709'?,"MATCH (m:Movie {imdbId: '0114709'})<-[:RATED]-(u:User)
RETURN count(u) AS numberOfUsers",Pathfinding Queries,recommendations,False,False,True,
What movies have both English and French as their languages?,"MATCH (m:Movie)
WHERE 'English' IN m.languages AND 'French' IN m.languages
RETURN m",Pathfinding Queries,recommendations,False,False,False,
Which directors have a bio that mentions 'Academy Award'?,"MATCH (d:Director)
WHERE d.bio CONTAINS 'Academy Award'
RETURN d.name, d.bio",Pathfinding Queries,recommendations,False,False,True,
List the top 3 movies with the most IMDb votes.,"MATCH (m:Movie)
WHERE m.imdbVotes IS NOT NULL
RETURN m
ORDER BY m.imdbVotes DESC
LIMIT 3",Pathfinding Queries,recommendations,False,False,True,
Which actors have acted in movies from at least three different countries?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, collect(DISTINCT m.countries) AS countries
WHERE size(countries) >= 3
RETURN a.name, countries",Pathfinding Queries,recommendations,False,False,True,
How many movies have been released in each year from 2010 to 2020?,"MATCH (m:Movie)
WHERE m.year >= 2010 AND m.year <= 2020
RETURN m.year AS ReleaseYear, count(m) AS NumberOfMovies
ORDER BY ReleaseYear",Pathfinding Queries,recommendations,False,False,True,
What are the names of directors who have directed both a 'Comedy' and a 'Drama' movie?,"MATCH (d:Director)-[:DIRECTED]->(m1:Movie)-[:IN_GENRE]->(g1:Genre {name: 'Comedy'})
MATCH (d)-[:DIRECTED]->(m2:Movie)-[:IN_GENRE]->(g2:Genre {name: 'Drama'})
RETURN DISTINCT d.name",Pathfinding Queries,recommendations,False,False,False,
Which movies have been rated by both user '1' and user '2'?,"MATCH (u1:User {userId: '1'})-[:RATED]->(m:Movie)<-[:RATED]-(u2:User {userId: '2'})
RETURN m",Pathfinding Queries,recommendations,False,False,False,
What genres have more than ten movies associated with them?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, count(m) AS movieCount
WHERE movieCount > 10
RETURN g.name, movieCount",Pathfinding Queries,recommendations,False,False,True,
What movies had a budget greater than 100 million dollars and were directed by a director born in the USA?,"MATCH (m:Movie)-[:DIRECTED]->(d:Director)
WHERE m.budget > 100000000 AND d.bornIn = ""USA""
RETURN m.title, m.budget, d.name, d.bornIn",Pathfinding Queries,recommendations,False,False,True,
What are the first 3 movies directed by a person who has also acted in movies?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE exists{ (p)-[:ACTED_IN]->(:Movie) }
RETURN m.title AS MovieTitle, m.year AS ReleaseYear
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List all movies directed by someone who was born after 1970.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE d.born > date('1970-01-01')
RETURN m",Pathfinding Queries,recommendations,False,False,True,
List the top 3 actors who have directed movies they acted in.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(a)
RETURN a.name, count(m) AS moviesDirectedAndActedIn
ORDER BY moviesDirectedAndActedIn DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,False,
Which directors have directed movies in more than three different languages?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, collect(DISTINCT m.languages) AS languages
WHERE size(languages) > 3
RETURN d.name, languages",Pathfinding Queries,recommendations,False,False,True,
Identify movies released in 'December' that have a genre of 'Horror'.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Horror'})
WHERE m.released STARTS WITH 'December'
RETURN m",Pathfinding Queries,recommendations,False,False,True,
What are the top 5 highest-rated movies by users from the USA?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE u.bornIn = 'USA'
RETURN m.title AS Movie, avg(r.rating) AS AverageRating
ORDER BY AverageRating DESC
LIMIT 5",Pathfinding Queries,recommendations,False,False,True,User.bornIn
List the movies where the plot mentions 'friendship' and the budget was under 20 million dollars.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'friendship' AND m.budget < 20000000
RETURN m",Pathfinding Queries,recommendations,False,False,True,
Which movies have actors with a bio that includes 'Wikipedia' and a revenue over 300 million dollars?,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor)
WHERE m.revenue > 300000000 AND a.bio CONTAINS 'Wikipedia'
RETURN m.title, m.revenue, a.name, a.bio",Pathfinding Queries,recommendations,False,False,True,
Identify directors who directed a movie in the year they were born.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE d.born.year = m.year
RETURN d, m",Pathfinding Queries,recommendations,False,False,False,
What are the movies that have a plot containing the word 'zombie' with an IMDb rating over 7?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'zombie' AND m.imdbRating > 7
RETURN m",Pathfinding Queries,recommendations,False,False,True,
List all movies that have been rated by both male and female users.,"MATCH (m:Movie)
WHERE exists {
  (m)<-[:RATED]-(u:User {gender: 'male'})
} AND exists {
  (m)<-[:RATED]-(u:User {gender: 'female'})
}
RETURN m",Pathfinding Queries,recommendations,False,True,False,User.gender
Which actors have acted in movies that grossed over 1 billion dollars?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.revenue > 1000000000
RETURN a.name, collect(m.title) AS movies",Pathfinding Queries,recommendations,False,False,True,
List all movies with a title that starts with 'The' and have a poster URL ending with 'jpg'.,"MATCH (m:Movie)
WHERE m.title STARTS WITH 'The' AND m.poster ENDS WITH 'jpg'
RETURN m",Pathfinding Queries,recommendations,False,False,False,
"Identify movies with more than 10,000 IMDb votes and a runtime under 90 minutes.","MATCH (m:Movie)
WHERE m.imdbVotes > 10000 AND m.runtime < 90
RETURN m",Pathfinding Queries,recommendations,False,False,True,
List all users who have rated more than 50 movies.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(m) AS movies_rated
WHERE movies_rated > 50
RETURN u",Pathfinding Queries,recommendations,False,False,True,
Which directors have the most movies with an IMDb rating over 8?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating > 8
WITH d, count(m) AS moviesCount
ORDER BY moviesCount DESC
RETURN d.name, moviesCount",Pathfinding Queries,recommendations,False,False,False,
Identify movies that have been released in both English and French.,"MATCH (m:Movie)
WHERE 'English' IN m.languages AND 'French' IN m.languages
RETURN m",Pathfinding Queries,recommendations,False,False,True,
What are the top 5 movies with the lowest IMDb ratings but highest revenues?,"MATCH (m:Movie)
WHERE m.imdbRating IS NOT NULL AND m.revenue IS NOT NULL
RETURN m
ORDER BY m.imdbRating ASC, m.revenue DESC
LIMIT 5",Pathfinding Queries,recommendations,False,False,True,
List all movies that have more than one genre associated with them.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(g) AS genreCount
WHERE genreCount > 1
RETURN m",Pathfinding Queries,recommendations,False,False,True,
Find the top 3 movies with the shortest runtime and a revenue over 100 million dollars.,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL AND m.revenue > 100000000
RETURN m
ORDER BY m.runtime ASC
LIMIT 3",Pathfinding Queries,recommendations,False,False,True,
Which actors have acted in movies that were released on their birthday?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.born IS NOT NULL AND m.released IS NOT NULL AND toString(a.born) = m.released
RETURN a.name AS ActorName, m.title AS MovieTitle, m.released AS ReleaseDate",Pathfinding Queries,recommendations,True,False,False,
Identify directors who have never directed a movie rated under 6 on IMDb.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE NOT exists {
  MATCH (m)-[r:RATED]->()
  WHERE r.rating < 6
}
RETURN d",Pathfinding Queries,recommendations,False,False,True,
What are the movies with a budget over 200 million dollars and a revenue under 500 million dollars?,"MATCH (m:Movie)
WHERE m.budget > 200000000 AND m.revenue < 500000000
RETURN m",Pathfinding Queries,recommendations,False,False,False,
What are the top 3 most popular movies among users named 'John'?,"MATCH (u:User {name: 'John'})-[:RATED]->(m:Movie)
WITH m, count(u) AS popularity
ORDER BY popularity DESC
LIMIT 3
RETURN m.title, m.url, popularity",Pathfinding Queries,recommendations,False,False,True,
What are the genres associated with movies that have an IMDb rating exactly 6.5?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.imdbRating = 6.5
RETURN g.name AS Genre",Pathfinding Queries,recommendations,False,False,True,
Identify all movies that have been directed by actors.,"MATCH (a:Actor)-[:DIRECTED]->(m:Movie)
RETURN m",Pathfinding Queries,recommendations,False,False,True,
Which movies have a director who was born after 1960 and have generated over 100 million in revenue?,"MATCH (m:Movie)<-[:DIRECTED]-(d:Director)
WHERE d.born > date('1960-01-01') AND m.revenue > 100000000
RETURN m.title, m.revenue, d.name, d.born",Pathfinding Queries,recommendations,False,False,True,
List the top 5 movies with the most countries available in their languages list.,"MATCH (m:Movie)
WHERE m.languages IS NOT NULL
RETURN m.title, m.languages
ORDER BY size(m.languages) DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 directors have directed movies with an imdbRating greater than 8.0?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating > 8.0
RETURN d.name, collect(m.title) AS movies
ORDER BY m.imdbRating DESC
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
What are the top 5 movies released in the 1990s by revenue?,"MATCH (m:Movie)
WHERE m.released >= '1990-01-01' AND m.released < '2000-01-01' AND m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 actors were born in France and acted in more than one movie?,"MATCH (a:Actor {bornIn: 'France'})-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS movies_count
WHERE movies_count > 1
RETURN a.name, movies_count
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
List the top 5 movies with the highest number of imdbVotes.,"MATCH (m:Movie)
WHERE m.imdbVotes IS NOT NULL
RETURN m
ORDER BY m.imdbVotes DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 users have rated the most number of movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN u, count(m) AS movies_rated
ORDER BY movies_rated DESC
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
What are the top 5 movies with the most languages available?,"MATCH (m:Movie)
RETURN m.title, m.languages
ORDER BY size(m.languages) DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,False,
Which 3 genres contain the most movies?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS Genre, count(m) AS MovieCount
ORDER BY MovieCount DESC
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
List the top 5 movies with the largest budgets released before 2000.,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.year < 2000
RETURN m
ORDER BY m.budget DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 movies have the longest runtime?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m
ORDER BY m.runtime DESC
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
List the top 5 directors by the number of movies they have directed.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
RETURN d.name, count(m) AS movies_directed
ORDER BY movies_directed DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 actors have acted in the most number of movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
RETURN a.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
What are the top 5 movies with the highest imdbRating?,"MATCH (m:Movie)
WHERE m.imdbRating IS NOT NULL
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which movies have actors who were born in Canada and have acted in a thriller genre?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: ""Thriller""})
MATCH (a:Actor)-[:ACTED_IN]->(m)
WHERE a.bornIn = ""Canada""
RETURN m.title AS MovieTitle, collect(a.name) AS CanadianActors",Pathfinding Queries,recommendations,False,False,True,
Identify movies that have been rated 10 times or more with a rating above 8.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE r.rating > 8
WITH m, count(r) AS ratingsCount
WHERE ratingsCount >= 10
RETURN m",Pathfinding Queries,recommendations,False,True,False,
What are the top 3 movies with a revenue of exactly 50 million dollars?,"MATCH (m:Movie)
WHERE m.revenue = 50000000
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 3",Pathfinding Queries,recommendations,False,False,False,
List all actors who have acted in movies with at least two different directors.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(d:Director)
WITH a, m, count(DISTINCT d) AS numDirectors
WHERE numDirectors >= 2
RETURN DISTINCT a.name AS ActorName",Pathfinding Queries,recommendations,False,False,True,
Which directors have directed movies with a plot mentioning 'evil'?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.plot CONTAINS 'evil'
RETURN d.name, m.title",Pathfinding Queries,recommendations,False,False,True,
Identify movies that have languages lists containing more than 5 languages.,"MATCH (m:Movie)
WHERE size(m.languages) > 5
RETURN m",Pathfinding Queries,recommendations,False,False,True,
What are the top 5 movies with the most revenue that are in the 'Sci-Fi' genre?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Sci-Fi'})
WHERE m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 5",Pathfinding Queries,recommendations,False,False,True,
List the top 3 movies with the highest budgets that were released in the 2000s.,"MATCH (m:Movie)
WHERE m.released >= '2000-01-01' AND m.released < '2010-01-01' AND m.budget IS NOT NULL
RETURN m
ORDER BY m.budget DESC
LIMIT 3",Pathfinding Queries,recommendations,False,False,True,
List the movies that have been released in at least three different languages.,"MATCH (m:Movie)
WHERE size(m.languages) >= 3
RETURN m",Pathfinding Queries,recommendations,False,False,False,
Which movies have been rated exactly 5 stars by at least one user?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE r.rating = 5.0
RETURN m",Pathfinding Queries,recommendations,False,False,True,
Identify all actors who have played roles in movies directed by directors born in Nebraska.,"MATCH (d:Director {bornIn: ""Nebraska""})-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(a:Actor)
RETURN DISTINCT a.name AS ActorName, collect(m.title) AS Movies",Pathfinding Queries,recommendations,False,False,True,
What are the top 5 movies by revenue that contain the word 'war' in their title?,"MATCH (m:Movie)
WHERE m.title CONTAINS 'war' AND m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 5",Pathfinding Queries,recommendations,False,False,False,
What are the first 3 movies with the highest number of languages available?,"MATCH (m:Movie)
RETURN m.title, m.languages
ORDER BY size(m.languages) DESC
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
List the top 5 actors by number of movies they've acted in with a budget over 100 million.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.budget > 100000000
WITH a, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 5
RETURN a.name, movies_count",Simple Aggregation Queries,recommendations,False,False,True,
Which 5 directors have the most distinct movies directed?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, count(DISTINCT m) AS moviesDirected
ORDER BY moviesDirected DESC
LIMIT 5
RETURN d.name, moviesDirected",Simple Aggregation Queries,recommendations,False,False,True,
List the first 3 movies with an imdbId that starts with '07'.,"MATCH (m:Movie)
WHERE m.imdbId STARTS WITH '07'
RETURN m
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
What are the top 5 movies with the most detailed biographies of their directors?,"MATCH (m:Movie)-[:DIRECTED]->(d:Director)
WHERE d.bio IS NOT NULL
RETURN m.title AS MovieTitle, d.name AS DirectorName, d.bio AS Biography
ORDER BY size(d.bio) DESC
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,False,
List the first 3 directors who have directed a movie with a runtime over 180 minutes.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.runtime > 180
RETURN d
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
Which 5 movies have the most diverse cast in terms of countries of origin?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH m, count(DISTINCT a.bornIn) AS diversity
ORDER BY diversity DESC
RETURN m.title, diversity
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
What are the first 3 movies with a director who has a bio longer than 500 words?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE size(split(d.bio, ' ')) > 500
RETURN m
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
List the top 5 movies by number of actors born in the USA who acted in them.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.bornIn = 'USA'
WITH m, count(a) AS numActors
ORDER BY numActors DESC
LIMIT 5
RETURN m.title, numActors",Simple Aggregation Queries,recommendations,False,False,True,
Which 5 movies have been directed by a person who also acted in them?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE exists{(p)-[:ACTED_IN]->(m)}
RETURN m.title AS MovieTitle, p.name AS PersonName
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,False,
List the first 3 directors who have a born date but no died date.,"MATCH (d:Director)
WHERE d.born IS NOT NULL AND d.died IS NULL
RETURN d
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
What are the top 5 movies with the most genres associated?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN m.title, genreCount",Simple Aggregation Queries,recommendations,False,False,True,
List the first 3 movies with a poster URL on tmdb but not on IMDb.,"MATCH (m:Movie)
WHERE m.poster IS NOT NULL AND m.tmdbId IS NOT NULL AND m.imdbId IS NULL
RETURN m
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
Which 5 movies had their entire plot translated into more than one language?,"MATCH (m:Movie)
WHERE size(m.languages) > 1
RETURN m.title, m.plot, m.languages
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
List the first 3 users who rated a movie with a budget over 200 million.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE m.budget > 200000000
RETURN u
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,False,
What are the top 5 movies with the smallest gap between release and rating date?,"MATCH (m:Movie)<-[:RATED]-(u:User)
WITH m, min(u.timestamp) AS firstRatingTimestamp
WHERE m.released IS NOT NULL
WITH m, firstRatingTimestamp, date(m.released) AS releaseDate
WITH m, firstRatingTimestamp, releaseDate, duration.inDays(releaseDate, datetime({epochSeconds: firstRatingTimestamp}).date).days AS gap
ORDER BY gap ASC
RETURN m.title, m.released, firstRatingTimestamp, gap
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,User.timestamp
List the first 3 actors who acted in a movie without having a born date listed.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.born IS NULL
RETURN a.name, a.url, m.title
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
Which 5 directors have directed the same movie?,"MATCH (d1:Director)-[:DIRECTED]->(m:Movie)<-[:DIRECTED]-(d2:Director)
WHERE d1 <> d2
RETURN d1.name AS Director1, d2.name AS Director2, m.title AS Movie
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
What are the first 3 movies directed by a director born in Nebraska?,"MATCH (d:Director {bornIn: ""Nebraska""})-[:DIRECTED]->(m:Movie)
RETURN m
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
List the top 5 most reviewed movies on IMDb.,"MATCH (m:Movie)
WHERE m.imdbVotes IS NOT NULL
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
Which 5 actors have the most roles listed as uncredited?,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)
WHERE r.role CONTAINS ""uncredited""
RETURN a.name, count(r) AS uncreditedRoles
ORDER BY uncreditedRoles DESC
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
Which 5 movies have the most distinct posters on IMDb?,"MATCH (m:Movie)
WHERE m.poster IS NOT NULL
RETURN m.title, m.poster
ORDER BY m.poster DESC
LIMIT 5",Simple Aggregation Queries,recommendations,True,False,False,
Which 3 actors have acted in movies and also directed movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE exists {
    MATCH (a)-[:DIRECTED]->(m)
}
RETURN a.name, collect(m.title) AS movies
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
List the first 3 movies released in the year 2000 or later with a rating under 5.,"MATCH (m:Movie)-[r:RATED]->()
WHERE m.year >= 2000 AND r.rating < 5
RETURN m
ORDER BY m.released
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
List the first 3 actors who have died after 2000.,"MATCH (a:Actor)
WHERE a.died >= date('2000-01-01')
RETURN a
ORDER BY a.died ASC
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
List all genres associated with movies that have a budget less than 5 million dollars.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget < 5000000
RETURN g.name AS Genre",Pathfinding Queries,recommendations,False,False,True,
Which movies have a poster URL that contains 'face' and an IMDb rating above 8?,"MATCH (m:Movie)
WHERE m.poster CONTAINS 'face' AND m.imdbRating > 8
RETURN m",Pathfinding Queries,recommendations,False,False,True,
Find movies where the plot includes the word 'love' and were released on Valentine's Day.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'love' AND m.released ENDS WITH '-02-14'
RETURN m",Pathfinding Queries,recommendations,False,False,True,
List all the directors who have both directed and acted in the same movie.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(d)
RETURN d.name, m.title",Pathfinding Queries,recommendations,False,False,True,
Which movies have actors who were born in the USA and have acted in a comedy genre?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: ""Comedy""})
MATCH (a:Actor)-[:ACTED_IN]->(m)
WHERE a.bornIn = ""USA""
RETURN m.title AS MovieTitle, collect(a.name) AS Actors",Pathfinding Queries,recommendations,False,False,True,
Identify movies that have been rated by more than 1000 users.,"MATCH (m:Movie)
WHERE size((:User)-[:RATED]->(m)) > 1000
RETURN m",Pathfinding Queries,recommendations,False,False,True,
What are the genres of movies that have generated over 500 million dollars in revenue?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.revenue > 500000000
RETURN g.name AS Genre, count(m) AS NumberOfMovies
ORDER BY NumberOfMovies DESC",Pathfinding Queries,recommendations,False,False,True,
List the top 3 movies with the most IMDb votes released before 2000.,"MATCH (m:Movie)
WHERE m.year < 2000 AND m.imdbVotes IS NOT NULL
RETURN m
ORDER BY m.imdbVotes DESC
LIMIT 3",Pathfinding Queries,recommendations,False,False,True,
Which directors have directed at least three movies with budgets over 100 million dollars?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.budget > 100000000
WITH d, count(m) AS moviesDirected
WHERE moviesDirected >= 3
RETURN d.name, moviesDirected",Pathfinding Queries,recommendations,False,False,True,
Find all actors who have acted in more than one movie with an IMDb rating over 7.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.imdbRating > 7
WITH a, count(m) AS movies_count
WHERE movies_count > 1
RETURN a.name, movies_count",Pathfinding Queries,recommendations,False,False,True,
What are the top 5 highest-grossing movies of the 1990s?,"MATCH (m:Movie)
WHERE m.released >= '1990-01-01' AND m.released < '2000-01-01'
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5",Pathfinding Queries,recommendations,False,False,True,
List all movies directed by a person born in France.,"MATCH (d:Director {bornIn: 'France'})-[:DIRECTED]->(m:Movie)
RETURN m",Pathfinding Queries,recommendations,False,False,True,
Which movies have a runtime greater than 120 minutes and were released after 2010?,"MATCH (m:Movie)
WHERE m.runtime > 120 AND m.year > 2010
RETURN m",Pathfinding Queries,recommendations,False,False,True,
Which 5 directors have the longest cumulative runtime of all movies they've directed?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.runtime IS NOT NULL
WITH d, sum(m.runtime) AS total_runtime
ORDER BY total_runtime DESC
LIMIT 5
RETURN d.name, total_runtime",Simple Aggregation Queries,recommendations,False,False,True,
What are the first 3 movies with a plot containing the word 'evil'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'evil'
RETURN m
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
List the top 5 actors by number of movies they've acted in that have been released on Christmas Day.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.released ENDS WITH '-12-25'
RETURN a.name, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
Which 5 movies have the most quotes listed in their plots?,"MATCH (m:Movie)
WHERE m.plot IS NOT NULL
RETURN m.title, size([c IN split(m.plot, '""') WHERE c <> '']) / 2 AS quote_count
ORDER BY quote_count DESC
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
List the first 3 movies where the main actor is also the director.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie), (p)-[:DIRECTED]->(m)
RETURN m.title AS MovieTitle, p.name AS PersonName
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
What are the top 5 movies with the most user ratings received in their first year of release?,"MATCH (m:Movie)<-[:RATED]-(u:User)
WHERE m.released IS NOT NULL AND m.year = toInteger(substring(m.released, 0, 4))
WITH m, count(u) AS ratingsCount
ORDER BY ratingsCount DESC
LIMIT 5
RETURN m.title, m.year, ratingsCount",Simple Aggregation Queries,recommendations,True,False,False,
List the first 3 movies with the most different directors involved.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH m, count(DISTINCT d) AS numDirectors
ORDER BY numDirectors DESC
RETURN m.title, numDirectors
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
Which 5 directors have directed movies with the highest average imdbRating?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH d, AVG(m.imdbRating) AS avgRating
ORDER BY avgRating DESC
LIMIT 5
RETURN d.name, avgRating",Simple Aggregation Queries,recommendations,False,False,True,
What are the top 5 movies with the highest revenue in the Adventure genre?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: ""Adventure""})
WHERE m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
List the first 3 directors who have directed a movie without having a bio on their profile.,"MATCH (d:Director)-[:DIRECTED]->(:Movie)
WHERE d.bio IS NULL
RETURN d
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
What are the top 5 oldest movies in the database by release year?,"MATCH (m:Movie)
WHERE m.year IS NOT NULL
RETURN m
ORDER BY m.year ASC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
List the top 5 movies with the smallest budgets that have an imdbRating over 7.0.,"MATCH (m:Movie)
WHERE m.imdbRating > 7.0 AND m.budget IS NOT NULL
RETURN m
ORDER BY m.budget ASC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 directors have directed movies in more than three genres?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH d, count(DISTINCT g) AS genreCount
WHERE genreCount > 3
RETURN d.name, genreCount
ORDER BY genreCount DESC
LIMIT 3",Verbose query,recommendations,False,False,True,
What are the top 5 longest movies that have been released after 2000?,"MATCH (m:Movie)
WHERE m.year > 2000
RETURN m
ORDER BY m.runtime DESC
LIMIT 5",Verbose query,recommendations,False,False,True,
List the first 3 movies that have been rated exactly by 3 different users.,"MATCH (m:Movie)
WHERE size((:User)-[:RATED]->(m)) = 3
RETURN m
LIMIT 3",Verbose query,recommendations,False,False,True,
Which 3 users have the highest average movie rating with at least 20 rated movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, AVG(r.rating) AS avgRating, COUNT(m) AS numMovies
WHERE numMovies >= 20
RETURN u.userId, u.name, avgRating
ORDER BY avgRating DESC
LIMIT 3",Verbose query,recommendations,False,False,True,
What are the top 5 movies with IMDb votes greater than 100000?,"MATCH (m:Movie)
WHERE m.imdbVotes > 100000
RETURN m
ORDER BY m.imdbVotes DESC
LIMIT 5",Verbose query,recommendations,False,False,False,
List the first 3 directors who have also acted in a movie.,"MATCH (d:Director)-[:ACTED_IN]->(m:Movie)
RETURN d.name, collect(m.title) AS movies
LIMIT 3",Verbose query,recommendations,False,False,True,
Which top 5 movies have the most diverse range of spoken languages?,"MATCH (m:Movie)
RETURN m.title, m.languages, size(m.languages) AS num_languages
ORDER BY num_languages DESC
LIMIT 5",Verbose query,recommendations,False,False,True,
What are the top 5 genres in which movies have the highest average IMDb rating?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.imdbRating IS NOT NULL
WITH g.name AS Genre, AVG(m.imdbRating) AS AvgRating
RETURN Genre, AvgRating
ORDER BY AvgRating DESC
LIMIT 5",Verbose query,recommendations,False,False,True,
List the first 3 users who have an average rating less than 3.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, AVG(r.rating) AS avgRating
WHERE avgRating < 3
RETURN u
LIMIT 3",Verbose query,recommendations,False,False,False,
List the first 3 actors who have acted in movies with a revenue of over 500 million USD.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.revenue > 500000000
RETURN a.name, a.url
LIMIT 3",Verbose query,recommendations,False,False,True,
Which 3 actors were born after 1980 and have acted in more than 5 movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.born > date('1980-01-01')
WITH a, count(m) AS movies_count
WHERE movies_count > 5
RETURN a.name, a.born, movies_count
ORDER BY a.born
LIMIT 3",Verbose query,recommendations,False,False,True,
What are the first 3 movies with a revenue to budget ratio greater than 5?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL AND m.budget IS NOT NULL AND m.revenue / m.budget > 5
RETURN m
ORDER BY m.revenue / m.budget DESC
LIMIT 3",Verbose query,recommendations,False,False,True,
Which top 5 directors have the highest number of directed movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
RETURN d.name, count(m) AS directedMovies
ORDER BY directedMovies DESC
LIMIT 5",Verbose query,recommendations,False,False,False,
List the first 3 movies that have both English and French languages.,"MATCH (m:Movie)
WHERE 'English' IN m.languages AND 'French' IN m.languages
RETURN m
LIMIT 3",Verbose query,recommendations,False,False,True,
Which 3 actors have played in both comedy and drama genres?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name IN ['Comedy', 'Drama']
WITH a, collect(DISTINCT g.name) AS genres
WHERE ALL(x IN ['Comedy', 'Drama'] WHERE x IN genres)
RETURN a.name
LIMIT 3",Verbose query,recommendations,False,False,True,
What are the top 5 movies with an IMDb rating above 8?,"MATCH (m:Movie)
WHERE m.imdbRating > 8
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 5",Verbose query,recommendations,False,False,True,
List the first 3 movies directed by a director born in France.,"MATCH (d:Director {bornIn: 'France'})-[:DIRECTED]->(m:Movie)
RETURN m
LIMIT 3",Verbose query,recommendations,True,False,False,
"Which top 5 movies have been rated by more than 500,000 users?","MATCH (m:Movie)<-[:RATED]-(u:User)
WITH m, count(u) AS userCount
WHERE userCount > 500000
RETURN m
ORDER BY userCount DESC
LIMIT 5",Verbose query,recommendations,False,False,True,
What are the top 3 genres by the number of movies?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS Genre, count(m) AS NumberOfMovies
ORDER BY NumberOfMovies DESC
LIMIT 3",Verbose query,recommendations,False,False,True,
List the top 5 actors who have acted in more than 10 movies.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS movies_count
WHERE movies_count > 10
RETURN a.name, movies_count
ORDER BY movies_count DESC
LIMIT 5",Verbose query,recommendations,False,False,True,
List the top 5 movies that were released in the '90s.,"MATCH (m:Movie)
WHERE m.released >= '1990-01-01' AND m.released < '2000-01-01'
RETURN m
ORDER BY m.released
LIMIT 5",Verbose query,recommendations,False,False,False,
What are the top 5 movies that have been directed by directors born in Nebraska?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE d.bornIn = ""Nebraska, USA""
RETURN m.title, m.year, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5",Verbose query,recommendations,False,False,True,
Which 3 movies have the highest number of actors involved?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH m, count(a) AS numActors
ORDER BY numActors DESC
LIMIT 3
RETURN m.title, numActors",Verbose query,recommendations,True,False,False,
List the first 3 genres that have more than 50 movies associated with them.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, count(m) AS movieCount
WHERE movieCount > 50
RETURN g.name AS Genre, movieCount
ORDER BY movieCount DESC
LIMIT 3",Verbose query,recommendations,False,False,True,
Which three movies have the most different countries listed?,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
RETURN m.title, size(m.countries) AS num_countries
ORDER BY num_countries DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which 3 actors have a bio longer than 1000 characters and have acted in more than 5 movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE length(a.bio) > 1000
WITH a, count(m) AS movies_count
WHERE movies_count > 5
RETURN a.name, a.bio, movies_count
ORDER BY movies_count DESC
LIMIT 3",Verbose query,recommendations,False,False,True,
What are the top 5 directors who have directed the most movies with a runtime under 90 minutes?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.runtime < 90
WITH d, count(m) AS moviesDirected
ORDER BY moviesDirected DESC
LIMIT 5
RETURN d.name, moviesDirected",Verbose query,recommendations,False,False,True,
List the first 3 movies that have been directed by actors.,"MATCH (a:Actor)-[:DIRECTED]->(m:Movie)
RETURN m
LIMIT 3",Verbose query,recommendations,False,False,True,
Which 3 movies have been rated exactly 5 times?,"MATCH (m:Movie)
WHERE count{(u:User)-[:RATED]->(m)} = 5
RETURN m
LIMIT 3",Verbose query,recommendations,False,False,False,
What are the top 5 movies with the most detailed biographies of their directors?,"MATCH (m:Movie)-[:DIRECTED]->(d:Director)
WHERE d.bio IS NOT NULL
RETURN m.title, d.name, d.bio
ORDER BY size(d.bio) DESC
LIMIT 5",Verbose query,recommendations,False,False,True,
List the first 3 actors who have acted in a movie without a poster link.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.poster IS NULL
RETURN a
LIMIT 3",Verbose query,recommendations,False,False,True,
Which 3 users have rated both the oldest and the newest movies in the database?,"MATCH (oldest:Movie), (newest:Movie)
WHERE oldest.year = (SELECT min(m.year) FROM Movie m)
  AND newest.year = (SELECT max(m.year) FROM Movie m)
MATCH (u:User)-[:RATED]->(oldest), (u)-[:RATED]->(newest)
RETURN u
LIMIT 3",Verbose query,recommendations,False,False,True,
What are the top 5 movies with the most number of genres associated?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN m.title, genreCount",Verbose query,recommendations,False,False,False,
List the first 3 directors who have directed both a comedy and a drama.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name IN ['Comedy', 'Drama']
WITH d, collect(DISTINCT g.name) AS genresDirected
WHERE ALL(genre IN ['Comedy', 'Drama'] WHERE genre IN genresDirected)
RETURN d
LIMIT 3",Verbose query,recommendations,True,False,False,
Which 3 movies have the highest budget to revenue ratio?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL AND m.revenue > 0
RETURN m.title, m.budget, m.revenue, (toFloat(m.budget) / m.revenue) AS budgetToRevenueRatio
ORDER BY budgetToRevenueRatio DESC
LIMIT 3",Verbose query,recommendations,True,False,False,
What are the top 5 oldest movies in the database?,"MATCH (m:Movie)
WHERE m.year IS NOT NULL
RETURN m
ORDER BY m.year ASC
LIMIT 5",Verbose query,recommendations,False,False,True,
List the first 3 movies with plots containing the word 'adventure'.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'adventure'
RETURN m
LIMIT 3",Verbose query,recommendations,False,False,True,
Which 3 actors were born in France and have acted in more than 20 movies?,"MATCH (a:Actor {bornIn: ""France""})-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS movies_count
WHERE movies_count > 20
RETURN a.name, movies_count
ORDER BY movies_count DESC
LIMIT 3",Verbose query,recommendations,False,False,True,
What are the top 5 movies with a budget less than 10 million USD but revenue over 100 million USD?,"MATCH (m:Movie)
WHERE m.budget < 10000000 AND m.revenue > 100000000
RETURN m
ORDER BY m.revenue DESC
LIMIT 5",Verbose query,recommendations,False,False,True,
List the first 3 movies with the most diverse country production origins.,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
RETURN m.title, m.countries, size(m.countries) AS country_count
ORDER BY country_count DESC
LIMIT 3",Verbose query,recommendations,False,False,True,
Which 3 directors have the most movies with a runtime over 180 minutes?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.runtime > 180
WITH d, count(m) AS movies_count
ORDER BY movies_count DESC
LIMIT 3
RETURN d.name, movies_count",Verbose query,recommendations,False,False,True,
What are the top 5 movies released in the last 5 years?,"MATCH (m:Movie)
WHERE m.released >= date().year - 5
RETURN m
ORDER BY m.released DESC
LIMIT 5",Verbose query,recommendations,False,False,False,
List the first 3 movies where the main language is not English but have an IMDb rating over 7.,"MATCH (m:Movie)
WHERE 'English' NOT IN m.languages AND m.imdbRating > 7
RETURN m
LIMIT 3",Verbose query,recommendations,False,False,True,
Which 3 actors have acted in both a highest and lowest grossing movie?,"MATCH (high:Movie)
WHERE high.revenue = (SELECT max(m.revenue) FROM Movie m)
WITH high
MATCH (low:Movie)
WHERE low.revenue = (SELECT min(m.revenue) FROM Movie m)
WITH high, low
MATCH (actor:Actor)-[:ACTED_IN]->(high)
MATCH (actor)-[:ACTED_IN]->(low)
RETURN actor.name
LIMIT 3",Verbose query,recommendations,False,False,True,
What are the top 5 movies with the lowest IMDb rating but highest revenue?,"MATCH (m:Movie)
WHERE m.imdbRating IS NOT NULL AND m.revenue IS NOT NULL
RETURN m
ORDER BY m.imdbRating ASC, m.revenue DESC
LIMIT 5",Verbose query,recommendations,False,False,True,
Which 3 users have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN u, count(m) AS movies_rated
ORDER BY movies_rated DESC
LIMIT 3",Verbose query,recommendations,True,False,False,
Name the top 5 highest-grossing movies.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5",Verbose query,recommendations,False,False,True,
What are the first 3 movies released after 2010 with a budget over 100 million USD?,"MATCH (m:Movie)
WHERE m.year > 2010 AND m.budget > 100000000
RETURN m
ORDER BY m.year ASC
LIMIT 3",Verbose query,recommendations,False,False,True,
List the top 3 directors born in the USA.,"MATCH (d:Director {bornIn: ""USA""})
RETURN d
ORDER BY d.born DESC
LIMIT 3",Verbose query,recommendations,False,False,True,
Which 3 directors have directed movies in more than three different genres?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH d, count(DISTINCT g) AS genreCount
WHERE genreCount > 3
RETURN d.name, genreCount
ORDER BY genreCount DESC
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
List the top 5 movies that have a plot description longer than 100 words.,"MATCH (m:Movie)
WHERE size(split(m.plot, ' ')) > 100
RETURN m
ORDER BY size(split(m.plot, ' ')) DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 genres have movies with an average imdbRating above 7.5?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.imdbRating > 7.5
WITH g, avg(m.imdbRating) AS avgRating
ORDER BY avgRating DESC
RETURN g.name, avgRating
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
What are the top 5 movies with the most budget and were released after 2010?,"MATCH (m:Movie)
WHERE m.released >= '2011-01-01' AND m.budget IS NOT NULL
RETURN m
ORDER BY m.budget DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 actors are born on or before 1900 and have acted in at least one movie?,"MATCH (a:Actor)-[:ACTED_IN]->(:Movie)
WHERE a.born <= date('1900-12-31')
RETURN a
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
List the top 5 movies that were released in languages other than English and have an imdbRating above 7.0.,"MATCH (m:Movie)
WHERE 'English' NOT IN m.languages AND m.imdbRating > 7.0
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 directors have the longest total runtime for all their directed movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.runtime IS NOT NULL
WITH d, sum(m.runtime) AS total_runtime
ORDER BY total_runtime DESC
LIMIT 3
RETURN d.name AS director, total_runtime",Complex Aggregation Queries,recommendations,False,False,True,
What are the top 5 movies with the most actors involved?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH m, count(a) AS num_actors
ORDER BY num_actors DESC
LIMIT 5
RETURN m.title, num_actors",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 users have the highest average rating given to movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, AVG(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN u.userId, u.name, avgRating",Complex Aggregation Queries,recommendations,False,False,True,
List the top 5 movies that have generated revenue more than 500 million USD.,"MATCH (m:Movie)
WHERE m.revenue > 500000000
RETURN m
ORDER BY m.revenue DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 movies have the most diverse set of genres associated with them?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(DISTINCT g) AS genreCount
ORDER BY genreCount DESC
LIMIT 3
RETURN m.title, genreCount",Complex Aggregation Queries,recommendations,False,False,True,
What are the top 5 movies directed by directors born in the USA?,"MATCH (d:Director {bornIn: ""USA""})-[:DIRECTED]->(m:Movie)
RETURN m.title AS MovieTitle, m.year AS ReleaseYear
ORDER BY m.year DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 actors have a poster listed and acted in at least two movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.poster IS NOT NULL
WITH a, count(m) AS movies_count
WHERE movies_count >= 2
RETURN a.name, a.poster, movies_count
ORDER BY movies_count DESC
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
List the top 5 movies that have been rated by the highest number of different users.,"MATCH (u:User)-[:RATED]->(m:Movie)
WITH m, count(DISTINCT u) AS userCount
ORDER BY userCount DESC
LIMIT 5
RETURN m.title, userCount",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 genres have the fewest movies associated with them in the database?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, count(m) AS movieCount
ORDER BY movieCount ASC
LIMIT 3
RETURN g.name, movieCount",Complex Aggregation Queries,recommendations,False,False,True,
What are the top 5 movies with runtime less than 90 minutes and imdbRating above 8.0?,"MATCH (m:Movie)
WHERE m.runtime < 90 AND m.imdbRating > 8.0
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 actors have the highest average imdbRating for movies they acted in?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH a, avg(m.imdbRating) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN a.name, avgRating",Complex Aggregation Queries,recommendations,False,False,True,
List the top 5 movies with a plot containing the word 'adventure'.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'adventure'
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 directors died after 2000 and directed more than two movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE d.died > date('2000-01-01')
WITH d, count(m) AS moviesDirected
WHERE moviesDirected > 2
RETURN d.name, d.died, moviesDirected
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
What are the top 5 most recent movies in the database and their genres?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN m.title, m.released, collect(g.name) AS genres
ORDER BY m.released DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 users have rated movies released before the year 2000?,"MATCH (u:User)-[:RATED]->(m:Movie)
WHERE m.year < 2000
RETURN u
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
What are the top 5 movies with the highest number of countries represented in their languages list?,"MATCH (m:Movie)
WHERE m.languages IS NOT NULL
RETURN m.title, m.languages, size(m.countries) AS num_countries
ORDER BY num_countries DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 genres are most common among movies with a budget over 100 million USD?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget > 100000000
RETURN g.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 actors have the lowest average imdbRating for movies they acted in and acted in more than three movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, avg(m.imdbRating) AS avgRating, count(m) AS moviesCount
WHERE moviesCount > 3
RETURN a.name, avgRating
ORDER BY avgRating ASC
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 users have rated the same movie with different ratings?,"MATCH (u1:User)-[r1:RATED]->(m:Movie)<-[r2:RATED]-(u2:User)
WHERE u1 <> u2 AND r1.rating <> r2.rating
RETURN u1, u2, m
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,False,
Which top 5 movies have a runtime longer than 150 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 150
RETURN m
ORDER BY m.runtime DESC
LIMIT 5",Verbose query,recommendations,False,False,True,
Which 3 users have rated the most movies with an imdbRating below 5.0?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE m.imdbRating < 5.0
WITH u, count(m) AS movies_rated
ORDER BY movies_rated DESC
LIMIT 3
RETURN u.userId, u.name, movies_rated",Complex Aggregation Queries,recommendations,False,False,True,
List the top 5 shortest movies with an imdbRating above 6.0.,"MATCH (m:Movie)
WHERE m.imdbRating > 6.0 AND m.runtime IS NOT NULL
RETURN m
ORDER BY m.runtime ASC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 actors have the highest total imdbVotes for all movies they acted in?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.imdbVotes IS NOT NULL
WITH a, sum(m.imdbVotes) AS totalVotes
ORDER BY totalVotes DESC
LIMIT 3
RETURN a.name, totalVotes",Complex Aggregation Queries,recommendations,False,False,True,
What are the top 5 movies with the most languages and at least one genre being 'Action'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Action'})
WHERE size(m.languages) IS NOT NULL
RETURN m.title, size(m.languages) AS num_languages
ORDER BY num_languages DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 directors have directed the most movies with a budget over 200 million USD?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.budget > 200000000
WITH d, count(m) AS moviesDirected
ORDER BY moviesDirected DESC
LIMIT 3
RETURN d.name, moviesDirected",Complex Aggregation Queries,recommendations,False,False,True,
List the top 5 movies that have the word 'love' in their plot description.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'love'
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 users have rated movies with an average rating below 3.0?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, AVG(r.rating) AS avgRating
WHERE avgRating < 3.0
RETURN u
ORDER BY avgRating ASC
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
What are the top 5 movies that were directed by persons who were not primarily directors?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE NOT (p:Director)
RETURN m.title AS MovieTitle, m.released AS ReleaseDate
ORDER BY m.imdbRating DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 movies released in the last 5 years of the database have the highest imdbVotes?,"MATCH (m:Movie)
WHERE m.released >= ""2011-01-01"" AND m.released <= ""2016-12-31""
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 3",Complex Aggregation Queries,recommendations,True,False,False,
List the top 5 movies with the most distinct directors involved.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH m, count(DISTINCT d) AS numDirectors
ORDER BY numDirectors DESC
LIMIT 5
RETURN m.title, numDirectors",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 actors have died and acted in more than two movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.died IS NOT NULL
WITH a, count(m) AS movies_count
WHERE movies_count > 2
RETURN a.name, a.died, movies_count
ORDER BY movies_count DESC
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
What are the top 5 movies with a single-country language setting and the highest imdbRating?,"MATCH (m:Movie)
WHERE size(m.countries) = 1 AND size(m.languages) = 1
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 genres are most common in movies with a runtime over 120 minutes?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.runtime > 120
RETURN g.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
List the top 5 oldest directors based on their birth year who have directed at least one movie.,"MATCH (d:Director)-[:DIRECTED]->(:Movie)
WHERE d.born IS NOT NULL
RETURN d
ORDER BY d.born
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 actors have the most distinct genres of movies they've acted in?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH a, count(DISTINCT g) AS genreCount
ORDER BY genreCount DESC
LIMIT 3
RETURN a.name, genreCount",Complex Aggregation Queries,recommendations,False,False,True,
What are the top 5 movies by revenue that were released in languages other than English?,"MATCH (m:Movie)
WHERE NOT 'English' IN m.languages AND m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 movies have the highest revenue to budget ratio?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL AND m.budget IS NOT NULL AND m.budget > 0
RETURN m.title, m.revenue, m.budget, m.revenue / m.budget AS revenueToBudgetRatio
ORDER BY revenueToBudgetRatio DESC
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,False,
List the top 5 movies where actors also served as directors.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE exists {
  MATCH (p)-[:DIRECTED]->(m)
}
RETURN m.title AS MovieTitle, collect(p.name) AS ActorDirectors
ORDER BY m.imdbRating DESC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,True,
Which 3 directors have the most distinct actors worked with across all movies directed?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(a:Actor)
WITH d, count(DISTINCT a) AS distinctActors
ORDER BY distinctActors DESC
RETURN d.name, distinctActors
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
What are the top 5 movies with the most genres associated with them?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN m.title, genreCount",Complex Aggregation Queries,recommendations,False,False,True,
List the top 5 movies with an imdbRating below 5.0 and a budget exceeding 50 million USD.,"MATCH (m:Movie)
WHERE m.imdbRating < 5.0 AND m.budget > 50000000
RETURN m
ORDER BY m.imdbRating ASC
LIMIT 5",Complex Aggregation Queries,recommendations,False,False,False,
What are the top 5 oldest movies in the database by release year?,"MATCH (m:Movie)
WHERE m.year IS NOT NULL
RETURN m
ORDER BY m.year ASC
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
What are the top 3 highest-grossing movies of all time?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 3",Complex Aggregation Queries,recommendations,False,False,True,
Which 5 directors have directed movies in more than 5 different languages?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, count(DISTINCT m.languages) AS num_languages
WHERE num_languages > 5
RETURN d.name, num_languages
ORDER BY num_languages DESC
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
Find all directors who were born after 1970.,"MATCH (d:Director)
WHERE d.born > date('1970-01-01')
RETURN d",Complex Retrieval Queries,recommendations,False,False,True,
Which movies feature both English and Spanish as languages?,"MATCH (m:Movie)
WHERE 'English' IN m.languages AND 'Spanish' IN m.languages
RETURN m",Complex Retrieval Queries,recommendations,False,False,False,
List the top 5 movies with the most IMDb votes.,"MATCH (m:Movie)
WHERE m.imdbVotes IS NOT NULL
RETURN m
ORDER BY m.imdbVotes DESC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,True,
Which users have given a rating of less than 3.0 to any movie?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE r.rating < 3.0
RETURN u",Complex Retrieval Queries,recommendations,False,False,True,
Find all movies where the main language is English and have a budget over 50 million dollars.,"MATCH (m:Movie)
WHERE 'English' IN m.languages AND m.budget > 50000000
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
List all genres that have less than 10 movies associated with them.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WITH g, count(m) AS movieCount
WHERE movieCount < 10
RETURN g.name AS Genre, movieCount",Complex Retrieval Queries,recommendations,False,False,True,
Which movies have been acted in and directed by the same person?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie), (p)-[:DIRECTED]->(m)
RETURN m.title AS MovieTitle, p.name AS PersonName",Complex Retrieval Queries,recommendations,False,False,True,
What are the top 3 movies with the highest IMDb ratings that were released before 1990?,"MATCH (m:Movie)
WHERE m.released < ""1990-01-01"" AND m.imdbRating IS NOT NULL
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,True,
List all actors born in the USA who have acted in at least two movies.,"MATCH (a:Actor {bornIn: 'USA'})-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS movies_count
WHERE movies_count >= 2
RETURN a.name, movies_count",Complex Retrieval Queries,recommendations,False,False,True,
Which genres are associated with movies that have a budget greater than 100 million dollars?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget > 100000000
RETURN DISTINCT g.name",Complex Retrieval Queries,recommendations,False,False,True,
Find all movies that have been rated by more than 1000 users.,"MATCH (m:Movie)<-[:RATED]-(u:User)
WITH m, count(u) AS userCount
WHERE userCount > 1000
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
Which users have rated more than 50 movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(m) AS movieCount
WHERE movieCount > 50
RETURN u",Complex Retrieval Queries,recommendations,False,False,False,
List all movies with an IMDb rating above 8.0 that were released in the 2000s.,"MATCH (m:Movie)
WHERE m.imdbRating > 8.0 AND m.year >= 2000 AND m.year < 2010
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
Which directors have directed more than three movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, count(m) AS moviesDirected
WHERE moviesDirected > 3
RETURN d.name, moviesDirected",Complex Retrieval Queries,recommendations,False,False,True,
Find all actors who acted in a movie that grossed over 500 million dollars.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.revenue > 500000000
RETURN a.name, m.title, m.revenue",Complex Retrieval Queries,recommendations,False,False,True,
What are the top 5 highest-grossing movies released after 2010?,"MATCH (m:Movie)
WHERE m.released >= '2011-01-01' AND m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,False,
List all movies directed by a person born in France.,"MATCH (d:Director {bornIn: 'France'})-[:DIRECTED]->(m:Movie)
RETURN m",Complex Retrieval Queries,recommendations,False,False,False,
Which movies have a runtime greater than 120 minutes and less than 180 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 120 AND m.runtime < 180
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
Which three directors have the most movies with a runtime under 80 minutes?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.runtime < 80
WITH d, count(m) AS moviesCount
ORDER BY moviesCount DESC
LIMIT 3
RETURN d.name, moviesCount",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies with a plot mentioning 'magic'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'magic'
RETURN m
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 3 movies that have been rated by over 1000 users.,"MATCH (m:Movie)<-[:RATED]-(u:User)
WITH m, count(u) AS userCount
WHERE userCount > 1000
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which actors have worked in both 'Animation' and 'Adventure' genres?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name IN ['Animation', 'Adventure']
WITH a, count(DISTINCT g) AS genreCount
WHERE genreCount = 2
RETURN a.name",Complex Retrieval Queries,recommendations,False,False,True,
Which three genres have the lowest average IMDb rating?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.imdbRating IS NOT NULL
WITH g.name AS genre, avg(m.imdbRating) AS avgRating
RETURN genre, avgRating
ORDER BY avgRating ASC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List all movies that have grossed more than their budget.,"MATCH (m:Movie)
WHERE m.revenue > m.budget
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
Find all users who rated a movie on its release date.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE m.released IS NOT NULL AND r.timestamp = datetime(m.released).epochMillis
RETURN u, r, m",Complex Retrieval Queries,recommendations,False,True,False,
Find all directors who have directed a movie that won an Oscar (assuming there's a property or indication about Oscar wins in the database).,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists{(m)-[:WON]->(:Award {name: 'Oscar'})}
RETURN d",Complex Retrieval Queries,recommendations,False,False,True,Award
Find all directors who have directed a movie that won an Oscar (assuming there's a property or indication about Oscar wins in the database).,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists{(m)-[:WON]->(:Award {name: 'Oscar'})}
RETURN d",Complex Retrieval Queries,recommendations,False,False,True,WON
Find all directors who have directed a movie that won an Oscar (assuming there's a property or indication about Oscar wins in the database).,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists{(m)-[:WON]->(:Award {name: 'Oscar'})}
RETURN d",Complex Retrieval Queries,recommendations,False,False,True,Award.name
List the movies that have been released in more than 5 countries.,"MATCH (m:Movie)
WHERE size(m.countries) > 5
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
Which actors have played a role in movies with a budget over 200 million dollars?,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)
WHERE m.budget > 200000000
RETURN a.name, collect(m.title) AS movies",Complex Retrieval Queries,recommendations,False,False,True,
Find all movies that have been rated exactly 5 times.,"MATCH (m:Movie)
WHERE count{(u:User)-[:RATED]->(m)} = 5
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
What are the top 5 movies with the shortest runtime?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m
ORDER BY m.runtime ASC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,True,
Which director has the most diverse portfolio of movie genres directed?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH d, count(DISTINCT g) AS genreCount
RETURN d.name AS Director, genreCount
ORDER BY genreCount DESC
LIMIT 1",Complex Retrieval Queries,recommendations,False,False,True,
List all actors who have never acted in an 'Action' genre movie.,"MATCH (a:Actor)
WHERE NOT EXISTS {
    MATCH (a)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Action'})
}
RETURN a",Complex Retrieval Queries,recommendations,False,False,True,
Which movies have been released on a leap day?,"MATCH (m:Movie)
WHERE m.released ENDS WITH '-02-29'
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
Find all movies with a poster URL that includes 'face' in it.,"MATCH (m:Movie)
WHERE m.poster CONTAINS 'face'
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
List all movies where the main actor is also the director.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie), (p)-[:DIRECTED]->(m)
RETURN m.title AS MovieTitle, p.name AS PersonName",Complex Retrieval Queries,recommendations,False,False,True,
Which movies have been rated 5.0 by more than 10 users?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE r.rating = 5.0
WITH m, count(u) AS userCount
WHERE userCount > 10
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
What are the top 3 movies with the highest budget to revenue ratio?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL AND m.revenue > 0
RETURN m.title, m.budget, m.revenue, (toFloat(m.budget) / m.revenue) AS budgetToRevenueRatio
ORDER BY budgetToRevenueRatio DESC
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,True,
List all directors who have directed a movie in the 'Sci-Fi' genre.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Sci-Fi'})
RETURN d",Complex Retrieval Queries,recommendations,False,False,True,
Which actors have the highest number of movies acted in the database?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
RETURN a.name, count(m) AS movies_count
ORDER BY movies_count DESC",Complex Retrieval Queries,recommendations,False,True,False,
Find the top 5 movies by revenue that have a runtime less than 100 minutes.,"MATCH (m:Movie)
WHERE m.runtime < 100 AND m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,True,
List all genres that a specific movie 'Toy Story' belongs to.,"MATCH (m:Movie {title: ""Toy Story""})-[:IN_GENRE]->(g:Genre)
RETURN g.name",Complex Retrieval Queries,recommendations,False,False,True,
Which movies have a plot mentioning 'war'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'war'
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
Find all actors who have acted in a movie directed by a director born in the same country as them.,"MATCH (actor:Actor)-[:ACTED_IN]->(movie:Movie)<-[:DIRECTED]-(director:Director)
WHERE actor.bornIn = director.bornIn
RETURN actor.name AS ActorName, movie.title AS MovieTitle, director.name AS DirectorName",Complex Retrieval Queries,recommendations,False,False,True,
What are the top 3 movies with the most diverse set of spoken languages?,"MATCH (m:Movie)
RETURN m.title, m.languages, size(m.languages) AS language_count
ORDER BY language_count DESC
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,True,
List all movies directed by someone who has also acted in a movie.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists {
    (d)-[:ACTED_IN]->(:Movie)
}
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
Which directors have a biography mentioning 'Academy Award'?,"MATCH (d:Director)
WHERE d.bio CONTAINS 'Academy Award'
RETURN d.name, d.bio",Complex Retrieval Queries,recommendations,False,False,True,
What are the top 5 movies with the lowest budgets that have a runtime over 90 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 90 AND m.budget IS NOT NULL
RETURN m
ORDER BY m.budget ASC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,True,
List all users who have rated the same movie with different ratings.,"MATCH (u1:User)-[r1:RATED]->(m:Movie)<-[r2:RATED]-(u2:User)
WHERE u1 <> u2 AND r1.rating <> r2.rating
RETURN u1, u2, m",Complex Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies with a main actor over the age of 50 at the time of filming?,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)
WHERE a.born <= date(datetime({epochMillis: apoc.date.parse(m.released, 'ms', 'yyyy-MM-dd')}) - duration({years: 50}))
RETURN m.title AS MovieTitle, m.released AS ReleaseDate, a.name AS ActorName, a.born AS ActorBirthDate
ORDER BY m.released
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which three directors have directed movies with the most diverse set of languages?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, count(DISTINCT m.languages) AS languageDiversity
ORDER BY languageDiversity DESC
LIMIT 3
RETURN d.name, languageDiversity",Simple Retrieval Queries,recommendations,False,False,True,
List the top 3 movies that have been directed by actors.,"MATCH (a:Actor)-[:DIRECTED]->(m:Movie)
RETURN m.title AS MovieTitle, m.released AS ReleaseDate
ORDER BY m.imdbRating DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which three users have rated movies in the most number of different genres?,"MATCH (u:User)-[:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH u, COUNT(DISTINCT g) AS genreCount
ORDER BY genreCount DESC
LIMIT 3
RETURN u, genreCount",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies with a majority of non-English languages?,"MATCH (m:Movie)
WHERE ALL(lang IN m.languages WHERE lang <> 'English')
RETURN m
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 3 actors who have the highest average IMDb rating across their movies.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH a, avg(m.imdbRating) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN a.name, avgRating",Simple Retrieval Queries,recommendations,False,False,True,
Which three genres are most common among movies with a budget over 100 million USD?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget > 100000000
RETURN g.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies that have a plot mentioning 'adventure'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'adventure'
RETURN m
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 3 directors based on the number of different countries their movies have been released in.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, count(DISTINCT m.countries) AS countriesCount
ORDER BY countriesCount DESC
LIMIT 3
RETURN d.name, countriesCount",Simple Retrieval Queries,recommendations,False,False,True,
Which three movies have been rated by the youngest users on average?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH m, AVG(u.age) AS avgAge
ORDER BY avgAge ASC
RETURN m.title AS MovieTitle, avgAge
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,User.age
What are the top 5 movies that have a genre of 'Sci-Fi'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Sci-Fi'})
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 5",Simple Retrieval Queries,recommendations,False,False,True,
List the first 3 actors who have acted in a movie with a budget over 50 million USD.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.budget > 50000000
RETURN a.name, a.url
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the first 3 movies where the main genre is 'Adventure'.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Adventure'})
RETURN m
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
What are the first 3 movies with the most number of associated actors?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH m, count(a) AS numActors
ORDER BY numActors DESC
RETURN m.title, numActors
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 3 movies that have been released on a leap year.,"MATCH (m:Movie)
WHERE m.year % 4 = 0 AND (m.year % 100 <> 0 OR m.year % 400 = 0)
RETURN m
ORDER BY m.year DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which three users have rated the most number of actors?,"MATCH (u:User)-[:RATED]->(:Movie)<-[:ACTED_IN]-(a:Actor)
WITH u, count(DISTINCT a) AS num_actors
ORDER BY num_actors DESC
LIMIT 3
RETURN u.userId, u.name, num_actors",Simple Retrieval Queries,recommendations,False,False,False,
What are the first 3 movies that have a plot mentioning 'war'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'war'
RETURN m
LIMIT 3",Simple Retrieval Queries,recommendations,True,False,False,
List the top 3 movies that have multiple languages but a single country of origin.,"MATCH (m:Movie)
WHERE size(m.languages) > 1 AND size(m.countries) = 1
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which three actors have the longest total screen time in movies?,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)
WHERE m.runtime IS NOT NULL
WITH a, sum(m.runtime) AS totalScreenTime
ORDER BY totalScreenTime DESC
LIMIT 3
RETURN a.name, totalScreenTime",Simple Retrieval Queries,recommendations,False,False,False,
What are the first 3 movies that have been rated exactly 5 times?,"MATCH (m:Movie)
WHERE count{(u:User)-[:RATED]->(m)} = 5
RETURN m
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 3 directors who have directed the most successful movies in terms of revenue.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.revenue IS NOT NULL
RETURN d.name, sum(m.revenue) AS totalRevenue
ORDER BY totalRevenue DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which three genres have the highest average revenue per movie?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.revenue IS NOT NULL
RETURN g.name AS Genre, AVG(m.revenue) AS AverageRevenue
ORDER BY AverageRevenue DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies with a revenue greater than their budget?,"MATCH (m:Movie)
WHERE m.revenue > m.budget
RETURN m
ORDER BY m.revenue DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies with a plot mentioning 'family'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'family'
RETURN m
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the first 3 actors who have acted in a superhero movie.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name = 'Superhero'
RETURN a.name
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,False,
Which three directors have directed movies that have won any cinematic awards?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists{ (m)-[:WON]->(:Award) }
RETURN d.name, collect(m.title) AS movies
ORDER BY count(m) DESC
LIMIT 3",Simple Retrieval Queries,recommendations,True,False,False,Award
Which three directors have directed movies that have won any cinematic awards?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists{ (m)-[:WON]->(:Award) }
RETURN d.name, collect(m.title) AS movies
ORDER BY count(m) DESC
LIMIT 3",Simple Retrieval Queries,recommendations,True,False,False,WON
What are the top 3 movies with a title ending in 'End'?,"MATCH (m:Movie)
WHERE m.title ENDS WITH 'End'
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies with a poster URL containing 'moon'?,"MATCH (m:Movie)
WHERE m.poster CONTAINS 'moon'
RETURN m
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 3 actors who have the most diverse filmography in terms of genres they acted in.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH a, COUNT(DISTINCT g) AS genreCount
ORDER BY genreCount DESC
LIMIT 3
RETURN a.name, genreCount",Simple Retrieval Queries,recommendations,False,False,True,
Which three users have rated the most diverse set of movies in terms of genres?,"MATCH (u:User)-[r:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH u, count(DISTINCT g) AS genreCount
ORDER BY genreCount DESC
LIMIT 3
RETURN u, genreCount",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies with a revenue less than 1000 USD?,"MATCH (m:Movie)
WHERE m.revenue < 1000
RETURN m
ORDER BY m.revenue ASC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 3 movies with a significant plot twist mentioned in the plot.,"MATCH (m:Movie)
WHERE m.plot CONTAINS ""twist""
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 3",Simple Retrieval Queries,recommendations,True,False,False,
Which three directors have the longest average movie runtime?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.runtime IS NOT NULL
WITH d, avg(m.runtime) AS avgRuntime
ORDER BY avgRuntime DESC
LIMIT 3
RETURN d.name, avgRuntime",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies released in 'January'?,"MATCH (m:Movie)
WHERE m.released STARTS WITH '01-' 
RETURN m
ORDER BY m.released
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 3 actors who have acted in both 'Action' and 'Romance' genres.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name IN ['Action', 'Romance']
WITH a, count(DISTINCT g) AS genresCount
WHERE genresCount = 2
RETURN a.name, count(DISTINCT m) AS moviesCount
ORDER BY moviesCount DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which three users have rated the highest budget movies on average?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(m.budget) AS avgBudget
ORDER BY avgBudget DESC
LIMIT 3
RETURN u.userId, u.name, avgBudget",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies with plots that involve a natural disaster?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'natural disaster'
RETURN m
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 3 directors who have worked with the most number of actors.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(a:Actor)
WITH d, count(DISTINCT a) AS actors_count
ORDER BY actors_count DESC
RETURN d.name, actors_count
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which three movies have the highest difference in revenue and budget?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL AND m.budget IS NOT NULL
RETURN m.title, m.revenue, m.budget, (m.revenue - m.budget) AS profit
ORDER BY profit DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies with an actor born before 1900?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.born < date('1900-01-01')
RETURN m
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,False,
List the top 3 users who have rated at least one movie in each genre available.,"MATCH (u:User)-[:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH u, collect(DISTINCT g) AS genres
WHERE size(genres) = size((:Genre))
RETURN u
ORDER BY count(DISTINCT m) DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which three genres have the most movies with a runtime over 120 minutes?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.runtime > 120
WITH g, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3
RETURN g.name, movieCount",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies with an actor who has a biography mentioning 'model'?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.bio CONTAINS 'model'
RETURN m
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the first 3 movies that were shot in more than five different locations.,"MATCH (m:Movie)
WHERE size(m.countries) > 5
RETURN m
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which three directors have directed the most number of movies in a single year?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, m.year AS year, count(m) AS movies_count
ORDER BY movies_count DESC
RETURN d.name, year, movies_count
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the first 3 movies with an IMDb rating above 7 and more than 100000 IMDb votes?,"MATCH (m:Movie)
WHERE m.imdbRating > 7 AND m.imdbVotes > 100000
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
List the top 3 movies with a released date on a Friday.,"MATCH (m:Movie)
WHERE m.released IS NOT NULL AND date(m.released).dayOfWeek = 5
RETURN m
ORDER BY m.released DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which three movies have the smallest difference between IMDb rating and user rating?,"MATCH (m:Movie)<-[:RATED]-(u:User)
WITH m, avg(u.rating) AS avgUserRating
RETURN m.title, m.imdbRating, avgUserRating, abs(m.imdbRating - avgUserRating) AS ratingDifference
ORDER BY ratingDifference ASC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,User.rating
List the first 3 actors who have acted in historical movies.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name = 'Historical'
RETURN a.name
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
What are the top 3 oldest movies in the database?,"MATCH (m:Movie)
RETURN m
ORDER BY m.year ASC
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,True,
Which three directors have directed movies in more than one language?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, collect(DISTINCT m.languages) AS languages
WHERE size(languages) > 1
RETURN d.name, languages
ORDER BY size(languages) DESC
LIMIT 3",Simple Retrieval Queries,recommendations,False,False,True,
Which movies have a plot that includes the word 'love'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'love'
RETURN m",Complex Retrieval Queries,recommendations,False,False,False,
What are the top 5 movies with the highest number of countries involved?,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
RETURN m.title, size(m.countries) AS num_countries
ORDER BY num_countries DESC
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
List the first 3 actors who have acted in a movie released before 1950.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.year < 1950
RETURN a
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
Which 5 directors have directed the most movies with budgets over 50 million?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.budget > 50000000
WITH d, count(m) AS moviesDirected
ORDER BY moviesDirected DESC
LIMIT 5
RETURN d.name, moviesDirected",Simple Aggregation Queries,recommendations,False,False,True,
What are the first 3 movies with a plot containing the word 'friendship'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'friendship'
RETURN m
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
Which actors have a poster URL on IMDb? Limit to 5 actors.,"MATCH (a:Actor)
WHERE a.poster IS NOT NULL
RETURN a.name, a.poster
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
What are the first 3 movies directed by a person born in France?,"MATCH (d:Director {bornIn: 'France'})-[:DIRECTED]->(m:Movie)
RETURN m
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
List the top 5 movies with the lowest imdbVotes.,"MATCH (m:Movie)
WHERE m.imdbVotes IS NOT NULL
RETURN m
ORDER BY m.imdbVotes ASC
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
Which 3 users have the highest average movie rating?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, AVG(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN u AS User, avgRating AS AverageRating",Simple Aggregation Queries,recommendations,False,False,True,
List 5 movies that have both English and French as languages.,"MATCH (m:Movie)
WHERE 'English' IN m.languages AND 'French' IN m.languages
RETURN m
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
What are the first 3 recent movies directed by directors born after 1970?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE d.born > date('1970-01-01')
RETURN m.title, m.released
ORDER BY m.released DESC
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
Which movies have a revenue to budget ratio greater than 2? Limit to 5 movies.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL AND m.budget IS NOT NULL AND m.revenue / m.budget > 2
RETURN m
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
List the first 3 directors who have also acted in movies.,"MATCH (d:Director)-[:ACTED_IN]->(m:Movie)
RETURN d.name, collect(m.title) AS movies
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
What are the top 5 movies with the most languages spoken?,"MATCH (m:Movie)
WHERE m.languages IS NOT NULL
RETURN m.title, m.languages, size(m.languages) AS num_languages
ORDER BY num_languages DESC
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
Which 3 movies have been rated by the most users?,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN m.title, count(u) AS num_users
ORDER BY num_users DESC
LIMIT 3",Simple Aggregation Queries,recommendations,True,False,False,
List 5 actors who have acted in more than 10 movies.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS movies_count
WHERE movies_count > 10
RETURN a.name, movies_count
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
What are the top 3 genres by number of movies?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS Genre, count(m) AS NumberOfMovies
ORDER BY NumberOfMovies DESC
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
Which movies released after 2010 have a budget over 100 million? Limit to 5 movies.,"MATCH (m:Movie)
WHERE m.released >= '2011-01-01' AND m.budget > 100000000
RETURN m
LIMIT 5",Simple Aggregation Queries,recommendations,False,True,False,
List the first 3 directors born in the USA.,"MATCH (d:Director)
WHERE d.bornIn = ""USA""
RETURN d
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
What are the top 5 longest movies by runtime?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
Which 3 users have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN u, count(m) AS movies_rated
ORDER BY movies_rated DESC
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,False,
Which 5 movies have the highest imdbRating?,"MATCH (m:Movie)
WHERE m.imdbRating IS NOT NULL
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
List the first 3 users who rated a movie on its release day.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE m.released IS NOT NULL AND r.timestamp = date(m.released).epochSeconds
RETURN u
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
List the first 3 actors born in France.,"MATCH (a:Actor {bornIn: ""France""})
RETURN a
LIMIT 3",Simple Aggregation Queries,recommendations,True,False,False,
Which 5 movies have the most detailed (longest) plots?,"MATCH (m:Movie)
WHERE m.plot IS NOT NULL
RETURN m
ORDER BY length(m.plot) DESC
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
Which actors have directed a movie they acted in? Limit to 5 actors.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(a)
RETURN DISTINCT a.name
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
List the first 3 actors who have a tmdbId but no imdbId.,"MATCH (a:Actor)
WHERE a.tmdbId IS NOT NULL AND a.imdbId IS NULL
RETURN a
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
Find all movies that have been acted in by an actor born before 1950.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.born < date('1950-01-01')
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
What are the top 5 movies with the longest plots?,"MATCH (m:Movie)
WHERE m.plot IS NOT NULL
RETURN m
ORDER BY size(m.plot) DESC
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
List the first 3 movies with exactly three languages spoken.,"MATCH (m:Movie)
WHERE size(m.languages) = 3
RETURN m
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
Which 3 directors were born in the same country they directed their first movie?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, m ORDER BY m.year ASC
WITH d, collect(m)[0] AS firstMovie
MATCH (firstMovie)-[:IN_GENRE]->(g:Genre)
WHERE d.bornIn IS NOT NULL AND exists{(d)-[:DIRECTED]->(:Movie)-[:IN_GENRE]->(:Genre {name: d.bornIn})}
RETURN d.name, d.bornIn, firstMovie.title, g.name
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
List the top 5 movies that have been rated the lowest by users.,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN m.title, avg(r.rating) AS average_rating
ORDER BY average_rating ASC
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
List the first 3 directors who died after 2000.,"MATCH (d:Director)
WHERE d.died > date('2000-01-01')
RETURN d
ORDER BY d.died ASC
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
Which 5 movies have the highest average user rating? Limit to movies rated by at least 10 users.,"MATCH (m:Movie)<-[:RATED]-(u:User)
WITH m, avg(r.rating) AS avgRating, count(u) AS numUsers
WHERE numUsers >= 10
RETURN m.title, avgRating
ORDER BY avgRating DESC
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
What are the first 3 most recently released movies with a revenue under 10 million?,"MATCH (m:Movie)
WHERE m.revenue < 10000000 AND m.released IS NOT NULL
RETURN m
ORDER BY m.released DESC
LIMIT 3",Simple Aggregation Queries,recommendations,True,False,False,
List the top 5 actors by number of different genres they've acted in.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH a, COUNT(DISTINCT g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN a.name, genreCount",Simple Aggregation Queries,recommendations,False,False,True,
Which 5 users have rated movies in the most diverse set of genres?,"MATCH (u:User)-[:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH u, count(DISTINCT g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN u, genreCount",Simple Aggregation Queries,recommendations,False,False,True,
What are the first 3 movies with a poster URL from tmdb?,"MATCH (m:Movie)
WHERE m.poster IS NOT NULL
RETURN m
ORDER BY m.tmdbId
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
List the first 3 movies that have been directed by more than one director.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH m, count(d) AS numDirectors
WHERE numDirectors > 1
RETURN m
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
Which 5 movies have been rated exactly 5 times by users?,"MATCH (m:Movie)
WHERE count{(u:User)-[:RATED]->(m)} = 5
RETURN m
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
What are the first 3 movies with a runtime less than 90 minutes and an imdbRating over 7?,"MATCH (m:Movie)
WHERE m.runtime < 90 AND m.imdbRating > 7
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
List the top 5 directors by number of movies directed in the 1990s.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.year >= 1990 AND m.year < 2000
WITH d, count(m) AS moviesDirected
ORDER BY moviesDirected DESC
LIMIT 5
RETURN d.name, moviesDirected",Simple Aggregation Queries,recommendations,False,False,True,
Which 5 movies have the most actors involved?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH m, count(a) AS numActors
ORDER BY numActors DESC
LIMIT 5
RETURN m.title, numActors",Simple Aggregation Queries,recommendations,False,False,False,
List the first 3 movies with the highest budget to revenue ratio.,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL AND m.revenue > 0
RETURN m.title, m.budget, m.revenue, (toFloat(m.budget) / m.revenue) AS budgetToRevenueRatio
ORDER BY budgetToRevenueRatio DESC
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,False,
Which 5 directors have the longest bios on their profile?,"MATCH (d:Director)
WHERE d.bio IS NOT NULL
RETURN d.name, d.bio
ORDER BY length(d.bio) DESC
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,False,
What are the first 3 movies with an imdbRating greater than 8.5?,"MATCH (m:Movie)
WHERE m.imdbRating > 8.5
RETURN m
ORDER BY m.imdbRating DESC
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,True,
List the top 5 highest-grossing movies of 2014.,"MATCH (m:Movie)
WHERE m.year = 2014
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
What are the first 3 movies where a director has also acted?,"MATCH (d:Director)-[:ACTED_IN]->(m:Movie)
WHERE exists{ (d)-[:DIRECTED]->(m) }
RETURN m.title AS MovieTitle, m.movieId AS MovieID
LIMIT 3",Simple Aggregation Queries,recommendations,False,False,False,
What are the top 5 movies by revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
What are the top 5 movies that have the most votes on IMDb?,"MATCH (m:Movie)
WHERE m.imdbVotes IS NOT NULL
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5",Simple Aggregation Queries,recommendations,False,False,True,
Which movies have been directed by directors who have also acted in movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists {
  MATCH (d)-[:ACTED_IN]->(:Movie)
}
RETURN m",Complex Retrieval Queries,recommendations,True,False,False,
What are the top 3 movies with the longest runtime?,"MATCH (m:Movie)
RETURN m
ORDER BY m.runtime DESC
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,False,
List all movies that have won an award and have been directed by a director born in the UK.,"MATCH (m:Movie)-[:DIRECTED_BY]->(d:Director {bornIn: 'UK'})
WHERE exists{(m)-[:WON_AWARD]->()}
RETURN m.title AS MovieTitle, d.name AS DirectorName",Complex Retrieval Queries,recommendations,False,False,True,"WON_AWARD, DIRECTED_BY"
Which movies have posters featuring a blue background (assuming there's a way to determine background color from the poster URL)?,"MATCH (m:Movie)
WHERE m.poster CONTAINS ""blue""
RETURN m.title, m.poster",Complex Retrieval Queries,recommendations,False,False,True,
Find all movies that have been rated by users born after 1980.,"MATCH (u:User)-[:RATED]->(m:Movie)
WHERE u.born > date('1980-01-01')
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,User.born
List all movies that have been released on Christmas Day.,"MATCH (m:Movie)
WHERE m.released ENDS WITH ""-12-25""
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
Which actors have acted in movies that have a plot mentioning 'adventure'?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.plot CONTAINS 'adventure'
RETURN DISTINCT a.name",Complex Retrieval Queries,recommendations,False,False,True,
Find all movies that have a movieId starting with '1' and have been rated by at least one user.,"MATCH (m:Movie)-[:RATED]->(u:User)
WHERE m.movieId STARTS WITH '1' AND exists{(m)-[:RATED]->(:User)}
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
What are the top 5 movies with the highest IMDb rating that have been directed by the same director?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, m ORDER BY m.imdbRating DESC
WITH d, collect(m) AS movies
WHERE size(movies) >= 2
RETURN d.name AS Director, movies[0..5] AS TopMovies",Complex Retrieval Queries,recommendations,False,False,True,
Which directors have directed both a comedy and a drama movie?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name = 'Comedy'
WITH d, collect(m) AS comedyMovies
WHERE exists {
    MATCH (d)-[:DIRECTED]->(m2:Movie)-[:IN_GENRE]->(g2:Genre)
    WHERE g2.name = 'Drama'
}
RETURN d, comedyMovies",Complex Retrieval Queries,recommendations,False,False,True,
List all movies where the main language is not English and have a runtime greater than 120 minutes.,"MATCH (m:Movie)
WHERE 'English' NOT IN m.languages AND m.runtime > 120
RETURN m",Complex Retrieval Queries,recommendations,True,False,False,
Which movies have been rated by users named 'John Smith'?,"MATCH (u:User {name: 'John Smith'})-[:RATED]->(m:Movie)
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
Find all movies that feature an actor born in Canada.,"MATCH (a:Actor {bornIn: ""Canada""})-[:ACTED_IN]->(m:Movie)
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
List all movies that have an IMDb rating and were released in the year 2000.,"MATCH (m:Movie)
WHERE m.imdbRating IS NOT NULL AND m.year = 2000
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
Which movies have actors who have also directed a movie?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE exists {
    MATCH (a)-[:DIRECTED]->(:Movie)
}
RETURN DISTINCT m",Complex Retrieval Queries,recommendations,False,False,True,
Find all directors who have directed a movie in their country of birth.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists {
    MATCH (m)-[:IN_GENRE]->(g:Genre)
    WHERE d.bornIn IN m.countries
}
RETURN d, m",Complex Retrieval Queries,recommendations,False,False,True,
What are the top 3 movies with the most countries listed in their release?,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
RETURN m.title, size(m.countries) AS countryCount
ORDER BY countryCount DESC
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,False,
What are the top 5 movies by number of languages spoken in them?,"MATCH (m:Movie)
RETURN m.title, size(m.languages) AS num_languages
ORDER BY num_languages DESC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,True,
Which actors have a biography mentioning 'Broadway'?,"MATCH (a:Actor)
WHERE a.bio CONTAINS 'Broadway'
RETURN a.name, a.bio",Complex Retrieval Queries,recommendations,False,False,True,
Find all users who have rated movies from more than three different genres.,"MATCH (u:User)-[:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH u, count(DISTINCT g) AS genreCount
WHERE genreCount > 3
RETURN u",Complex Retrieval Queries,recommendations,True,False,False,
List all movies that have a revenue greater than 100 million dollars and have been rated by more than 500 users.,"MATCH (m:Movie)
WHERE m.revenue > 100000000 AND size((:User)-[:RATED]->(m)) > 500
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
List all movies that have been directed by a person who died before 2000.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE d.died < date('2000-01-01')
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
Find all actors who have acted in a movie that has an IMDb rating of 9 or higher.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.imdbRating >= 9
RETURN a.name, m.title, m.imdbRating",Complex Retrieval Queries,recommendations,True,False,False,
Which movies have a plot that includes the word 'escape'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'escape'
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
List all movies with a revenue greater than 1 billion dollars.,"MATCH (m:Movie)
WHERE m.revenue > 1000000000
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
Find the top 5 movies with the highest revenue that were released in the 1990s.,"MATCH (m:Movie)
WHERE m.released >= '1990-01-01' AND m.released < '2000-01-01' AND m.revenue IS NOT NULL
RETURN m
ORDER BY m.revenue DESC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,False,
Find all actors who have acted in movies that have been released on New Year's Day.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie {released: ""2000-01-01""})
RETURN a.name, m.title",Complex Retrieval Queries,recommendations,False,False,True,
List all genres associated with movies that have a runtime less than 80 minutes.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.runtime < 80
RETURN g.name AS Genre",Complex Retrieval Queries,recommendations,False,False,True,
List all movies that have been acted in by an actor who has also directed a movie.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE exists {
  MATCH (a)-[:DIRECTED]->(:Movie)
}
RETURN m",Complex Retrieval Queries,recommendations,False,False,False,
What are the top 5 movies with the most detailed plots (assuming plot length can be measured)?,"MATCH (m:Movie)
WHERE m.plot IS NOT NULL
RETURN m.title, m.plot, length(m.plot) AS plot_length
ORDER BY plot_length DESC
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,True,
Find all movies with an IMDb rating less than 5 that have been directed by a director born in the USA.,"MATCH (m:Movie)<-[:DIRECTED]-(d:Director)
WHERE m.imdbRating < 5 AND d.bornIn = 'USA'
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
List all movies that have been rated by at least 5 different users.,"MATCH (m:Movie)<-[:RATED]-(u:User)
WITH m, count(DISTINCT u) AS userCount
WHERE userCount >= 5
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
Which actors have the longest bio in the database?,"MATCH (a:Actor)
RETURN a.name AS ActorName, a.bio AS Biography
ORDER BY length(a.bio) DESC
LIMIT 1",Complex Retrieval Queries,recommendations,False,False,False,
Find all directors who have directed a movie in a language other than English.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE NOT 'English' IN m.languages
RETURN d, m",Complex Retrieval Queries,recommendations,False,False,True,
What are the top 3 movies with the highest number of countries involved in their production?,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
RETURN m.title, size(m.countries) AS num_countries
ORDER BY num_countries DESC
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,True,
List all actors who have a poster URL that includes 'smile' in it.,"MATCH (a:Actor)
WHERE a.poster CONTAINS 'smile'
RETURN a",Complex Retrieval Queries,recommendations,False,False,True,
Which movies have a plot that includes the word 'monster'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'monster'
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
List all movies that have a language list including Japanese.,"MATCH (m:Movie)
WHERE 'Japanese' IN m.languages
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
Which directors have directed a movie that has been rated below 3.0?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)<-[:RATED]-(u:User)
WHERE u.rating < 3.0
RETURN DISTINCT d.name",Complex Retrieval Queries,recommendations,False,False,True,User.rating
Which actors have worked in a movie with a director from the same country?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(d:Director)
WHERE a.bornIn = d.bornIn AND a.bornIn IS NOT NULL
RETURN a.name AS ActorName, d.name AS DirectorName, m.title AS MovieTitle",Complex Retrieval Queries,recommendations,False,False,True,
What are the top 3 movies with the lowest IMDb votes?,"MATCH (m:Movie)
WHERE m.imdbVotes IS NOT NULL
RETURN m
ORDER BY m.imdbVotes ASC
LIMIT 3",Complex Retrieval Queries,recommendations,False,False,True,
List all movies that have a director who has also acted in a movie.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists {
    MATCH (d)-[:ACTED_IN]->(:Movie)
}
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
Which movies have been acted in by more than 10 different actors?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH m, count(DISTINCT a) AS numActors
WHERE numActors > 10
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
Find all movies where the director has directed more than 5 movies.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, count(m) AS directedMovies
WHERE directedMovies > 5
MATCH (m2:Movie)<-[:DIRECTED]-(d)
RETURN m2",Complex Retrieval Queries,recommendations,False,False,False,
Find all movies that have a plot mentioning 'hero'.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'hero'
RETURN m",Complex Retrieval Queries,recommendations,False,False,True,
Which movies have been rated the highest by users who have rated over 100 movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS ratingsCount
WHERE ratingsCount > 100
MATCH (u)-[r:RATED]->(m)
RETURN m.title AS MovieTitle, avg(r.rating) AS AverageRating
ORDER BY AverageRating DESC",Complex Retrieval Queries,recommendations,False,False,True,
List the top 5 oldest directors in the database.,"MATCH (d:Director)
WHERE d.born IS NOT NULL
RETURN d
ORDER BY d.born
LIMIT 5",Complex Retrieval Queries,recommendations,False,False,True,
Who are the 3 users with the most recent status expiration date?,"MATCH (u:User)
WHERE u.status_expiration IS NOT NULL
RETURN u
ORDER BY u.status_expiration DESC
LIMIT 3",Pathfinding Queries,slack,False,False,True,
What are the names of the 5 users in the 'Europe/Amsterdam' timezone?,"MATCH (u:User)-[:IN_TIMEZONE]->(tz:TimeZone {id: 'Europe/Amsterdam'})
RETURN u.name
LIMIT 5",Pathfinding Queries,slack,False,False,True,
List the first 5 channels that have been archived.,"MATCH (c:Channel)
WHERE c.is_archived = true
RETURN c
LIMIT 5",Pathfinding Queries,slack,False,False,True,
Which 3 users have posted messages in the 'neo4j-ruby' channel?,"MATCH (u:User)-[:POSTED]->(m:Message)-[:IN_CHANNEL]->(c:Channel {name: 'neo4j-ruby'})
RETURN u.name
LIMIT 3",Pathfinding Queries,slack,False,False,True,
What are the names of 3 users who reacted to the 'simple_smile' emoji?,"MATCH (u:User)-[:REACTED]->(r:Reaction)-[:REACTION_TYPE]->(e:Emoji {name: 'simple_smile'})
RETURN u.name
LIMIT 3",Pathfinding Queries,slack,False,False,True,
Which 3 users have posted the most messages?,"MATCH (u:User)-[:POSTED]->(m:Message)
RETURN u.name AS UserName, count(m) AS MessagesPosted
ORDER BY MessagesPosted DESC
LIMIT 3",Pathfinding Queries,slack,False,False,False,
List the first 5 reactions to messages posted by Michael Hunger.,"MATCH (u:User {name: ""Michael Hunger""})-[:POSTED]->(m:Message)
MATCH (r:Reaction)-[:TO_MESSAGE]->(m)
RETURN r
LIMIT 5",Pathfinding Queries,slack,False,False,True,
What are the top 3 most recent messages posted by Michael Hunger?,"MATCH (u:User {real_name: ""Michael Hunger""})-[:POSTED]->(m:Message)
RETURN m
ORDER BY m.createdAt DESC
LIMIT 3",Pathfinding Queries,slack,False,False,True,
Who are the primary owners of the top 3 channels by pagerank?,"MATCH (c:Channel)
WITH c
ORDER BY c.pagerank DESC
LIMIT 3
MATCH (po:PrimaryOwner)-[:CREATED]->(c)
RETURN po.display_name_normalized AS PrimaryOwner, c.name AS ChannelName, c.pagerank AS PageRank",Pathfinding Queries,slack,False,False,True,
Find the names of the top 5 bots by the number of messages they have posted.,"MATCH (b:Bot)-[:POSTED]->(m:Message)
WITH b, count(m) AS messagesPosted
ORDER BY messagesPosted DESC
LIMIT 5
RETURN b.name AS BotName, messagesPosted",Pathfinding Queries,slack,False,False,True,
Which 3 users have an avatar hash starting with 'g5'?,"MATCH (u:User)
WHERE u.avatar_hash STARTS WITH 'g5'
RETURN u
LIMIT 3",Pathfinding Queries,slack,False,False,True,
What are the names of the 5 most recently created channels by Michael Hunger?,"MATCH (o:Owner {real_name: ""Michael Hunger""})-[:CREATED]->(c:Channel)
RETURN c.name
ORDER BY c.createdAt DESC
LIMIT 5",Pathfinding Queries,slack,False,False,True,
Which 3 channels were created most recently?,"MATCH (c:Channel)
RETURN c
ORDER BY c.createdAt DESC
LIMIT 3",Pathfinding Queries,slack,False,False,True,
List the first 5 users who have a custom image set to true.,"MATCH (u:User)
WHERE u.is_custom_image = true
RETURN u
LIMIT 5",Pathfinding Queries,slack,False,False,True,
What are the names of the top 5 channels with the highest pagerank?,"MATCH (c:Channel)
RETURN c.name AS ChannelName, c.pagerank AS PageRank
ORDER BY c.pagerank DESC
LIMIT 5",Pathfinding Queries,slack,False,False,True,
What are the names of all channels where a bot named 'communitygraph' is a member?,"MATCH (b:Bot {name: 'communitygraph'})-[:MEMBER_OF]->(c:Channel)
RETURN c.name",Simple Aggregation Queries,slack,False,False,True,
List all attachments in messages posted by the primary owner named 'michael.neo'.,"MATCH (po:PrimaryOwner {name: 'michael.neo'})-[:POSTED]->(m:Message)-[:HAS_ATTACHMENT]->(a:Attachment)
RETURN a",Simple Aggregation Queries,slack,False,False,True,
What are the names of the 5 most recent threaded messages edited by any user?,"MATCH (u:User)-[:EDITED]->(tm:ThreadedMessage)
RETURN tm.text AS MessageText
ORDER BY tm.createdAt DESC
LIMIT 5",Pathfinding Queries,slack,False,False,True,
List the top 5 channels by the number of reactions received.,"MATCH (c:Channel)<-[:IN_CHANNEL]-(m:Message)
WITH c, count{(m)-[:HAS_REACTION]->()} AS reactionCount
ORDER BY reactionCount DESC
LIMIT 5
RETURN c.name AS ChannelName, reactionCount AS Reactions",Pathfinding Queries,slack,False,False,True,HAS_REACTION
Which 3 owners are part of the 'neo4j-graphql' channel?,"MATCH (o:Owner)-[:MEMBER_OF]->(c:Channel {name: 'neo4j-graphql'})
RETURN o
LIMIT 3",Pathfinding Queries,slack,False,False,True,
Which 5 users have changed their status text most recently?,"MATCH (u:User)
WHERE u.status_text IS NOT NULL
RETURN u.name, u.status_text, u.status_expiration
ORDER BY u.status_expiration DESC
LIMIT 5",Pathfinding Queries,slack,False,False,True,
What are the names of the top 5 channels mentioned in messages?,"MATCH (m:Message)-[:MENTIONS_CHANNEL]->(c:Channel)
RETURN c.name AS ChannelName, count(m) AS Mentions
ORDER BY Mentions DESC
LIMIT 5",Pathfinding Queries,slack,False,False,False,
Which 3 users have the most attachments in their messages?,"MATCH (u:User)-[:POSTED]->(m:Message)-[:HAS_ATTACHMENT]->(a:Attachment)
RETURN u.name AS UserName, count(a) AS NumberOfAttachments
ORDER BY NumberOfAttachments DESC
LIMIT 3",Pathfinding Queries,slack,False,False,True,
List the first 3 messages with the 'channel_join' subtype.,"MATCH (m:Message {subtype: 'channel_join'})
RETURN m
LIMIT 3",Pathfinding Queries,slack,False,False,False,
Which 5 users have the 'graphaware' status emoji set?,"MATCH (u:User)
WHERE u.status_emoji = ':graphaware:'
RETURN u
LIMIT 5",Pathfinding Queries,slack,False,False,True,
What are the names of 3 bots that posted messages in the 'neo4j-ruby' channel?,"MATCH (b:Bot)-[:POSTED]->(m:Message)-[:IN_CHANNEL]->(c:Channel {name: 'neo4j-ruby'})
RETURN b.name
LIMIT 3",Pathfinding Queries,slack,False,False,True,
List the first 5 primary owners who have posted threaded messages.,"MATCH (po:PrimaryOwner)-[:POSTED]->(tm:ThreadedMessage)
RETURN po
LIMIT 5",Pathfinding Queries,slack,False,False,True,
Which 3 admins have edited messages in the 'neo4j-graphql' channel?,"MATCH (a:Admin)-[:EDITED]->(m:Message)-[:IN_CHANNEL]->(c:Channel {name: 'neo4j-graphql'})
RETURN a
LIMIT 3",Pathfinding Queries,slack,False,False,True,
What are the names of the top 5 users by the number of channels they have created?,"MATCH (u:User)-[:CREATED]->(c:Channel)
RETURN u.name AS UserName, count(c) AS ChannelsCreated
ORDER BY ChannelsCreated DESC
LIMIT 5",Pathfinding Queries,slack,False,False,True,
List the first 3 deleted users who have posted messages.,"MATCH (d:Deleted)-[:POSTED]->(m:Message)
RETURN d
LIMIT 3",Pathfinding Queries,slack,False,False,True,
Which 5 users have the most reactions to their messages?,"MATCH (u:User)-[:POSTED]->(m:Message)
WITH u, count{(m)-[:REACTION_TYPE]->()} AS reactions
RETURN u.name AS UserName, reactions
ORDER BY reactions DESC
LIMIT 5",Pathfinding Queries,slack,False,False,True,
What are the names of 3 bots that are part of the 'T08J10GA2' team?,"MATCH (b:Bot)-[:IN_TIMEZONE]->(tz:TimeZone)
WHERE tz.team = 'T08J10GA2'
RETURN b.name
LIMIT 3",Pathfinding Queries,slack,False,False,True,TimeZone.team
List the first 5 messages in reply to the initial message in the 'neo4j-ruby' channel.,"MATCH (c:Channel {name: 'neo4j-ruby'})<-[:IN_CHANNEL]-(m:Message)
WHERE NOT EXISTS {
  MATCH (m)-[:IN_REPLY_TO]->(:Message)
}
WITH m
MATCH (m)<-[:IN_REPLY_TO]-(reply:Message)
RETURN reply
ORDER BY reply.createdAt
LIMIT 5",Pathfinding Queries,slack,False,False,True,
What are the names of the top 5 channels where the 'community-graph' bot is a member?,"MATCH (b:Bot {name: 'community-graph'})-[:MEMBER_OF]->(c:Channel)
RETURN c.name
ORDER BY c.pagerank DESC
LIMIT 5",Pathfinding Queries,slack,False,False,True,
Who are the first 3 users who edited their messages the most recently?,"MATCH (u:User)-[e:EDITED]->(m:Message)
RETURN u, e
ORDER BY e.editedAt DESC
LIMIT 3",Pathfinding Queries,slack,False,False,True,
List the top 5 messages by Michael Hunger with attachments.,"MATCH (u:User {real_name: ""Michael Hunger""})-[:POSTED]->(m:Message)-[:HAS_ATTACHMENT]->(a:Attachment)
RETURN m, a
ORDER BY m.createdAt DESC
LIMIT 5",Pathfinding Queries,slack,False,False,True,
Which 3 users have the 'python' status emoji set?,"MATCH (u:User)
WHERE u.status_emoji = ':python:'
RETURN u
LIMIT 3",Pathfinding Queries,slack,False,False,True,
What are the names of the 5 most recent messages that mention the 'random' channel?,"MATCH (m:Message)-[:MENTIONS_CHANNEL]->(c:Channel {name: 'random'})
RETURN m.text AS MessageText
ORDER BY m.createdAt DESC
LIMIT 5",Pathfinding Queries,slack,False,False,True,
List the 5 most recent emojis used in reactions.,"MATCH (e:Emoji)<-[:REACTION_TYPE]-(r:Reaction)
RETURN e.name AS EmojiName, max(r.createdAt) AS LastUsed
ORDER BY LastUsed DESC
LIMIT 5",Pathfinding Queries,slack,False,False,True,Reaction.createdAt
What are the titles of the top 3 attachments with the smallest thumb width?,"MATCH (a:Attachment)
RETURN a.title AS Title
ORDER BY a.thumb_width ASC
LIMIT 3",Pathfinding Queries,slack,False,False,False,
What are the names of 3 channels where the 'neo4j' status emoji was used?,"MATCH (u:User)-[:REACTED]->(r:Reaction)-[:REACTION_TYPE]->(e:Emoji {name: 'neo4j'})
MATCH (r)-[:TO_MESSAGE]->(m:Message)-[:IN_CHANNEL]->(c:Channel)
RETURN DISTINCT c.name
LIMIT 3",Pathfinding Queries,slack,False,False,False,
Which reactions are made to messages by the user with the skype id 'technige'?,"MATCH (u:User {skype: 'technige'})-[:POSTED]->(m:Message)
MATCH (r:Reaction)-[:TO_MESSAGE]->(m)
RETURN r",Simple Aggregation Queries,slack,False,False,True,
Which messages in the 'neo4j-graphql' channel have attachments?,"MATCH (m:Message)-[:IN_CHANNEL]->(c:Channel {name: 'neo4j-graphql'})
WHERE EXISTS { (m)-[:HAS_ATTACHMENT]->(:Attachment) }
RETURN m",Simple Aggregation Queries,slack,False,False,True,
What are the last names of all users who have posted messages in 2020?,"MATCH (u:User)-[:POSTED]->(m:Message)
WHERE m.createdAt >= datetime('2020-01-01T00:00:00Z') AND m.createdAt < datetime('2021-01-01T00:00:00Z')
RETURN DISTINCT u.last_name AS LastName",Simple Aggregation Queries,slack,False,False,True,
Show the profile pictures (image_72) of all users named 'Michael'.,"MATCH (u:User {first_name: 'Michael'})
RETURN u.image_72 AS profile_picture",Simple Aggregation Queries,slack,False,False,False,
What are the topics of all channels where the last message was posted in 2019?,"MATCH (m:Message)-[:IN_CHANNEL]->(c:Channel)
WHERE m.createdAt >= datetime('2019-01-01T00:00:00Z') AND m.createdAt <= datetime('2019-12-31T23:59:59Z')
WITH c, max(m.createdAt) AS LastMessageDate
MATCH (m2:Message)-[:IN_CHANNEL]->(c)
WHERE m2.createdAt = LastMessageDate
RETURN c.topic AS Topic",Simple Aggregation Queries,slack,False,False,True,
List all the channels a user named 'lee.freeman' has edited.,"MATCH (u:User {name: 'lee.freeman'})-[:EDITED]->(m)-[:IN_CHANNEL]->(c:Channel)
RETURN DISTINCT c",Simple Aggregation Queries,slack,False,False,True,
Which users have posted the most threaded messages?,"MATCH (u:User)-[:POSTED]->(tm:ThreadedMessage)
RETURN u.name AS UserName, count(tm) AS ThreadedMessagesCount
ORDER BY ThreadedMessagesCount DESC",Simple Aggregation Queries,slack,False,False,True,
Show all the statuses of the admin with the id 'U08J18KHB'.,"MATCH (a:Admin {id: 'U08J18KHB'})
RETURN a.status_text AS StatusText",Simple Aggregation Queries,slack,False,False,True,
What are the skype ids of all owners?,"MATCH (o:Owner)
WHERE o.skype IS NOT NULL
RETURN o.skype",Simple Aggregation Queries,slack,False,False,True,Owner.skype
List the display names of all bots in the timezone 'Europe/Amsterdam'.,"MATCH (b:Bot)-[:IN_TIMEZONE]->(tz:TimeZone {id: 'Europe/Amsterdam'})
RETURN b.display_name AS DisplayName",Simple Aggregation Queries,slack,False,False,True,
Which channels are owned by admins with the first name 'Michael'?,"MATCH (a:Admin {first_name: 'Michael'})-[:CREATED]->(c:Channel)
RETURN c",Simple Aggregation Queries,slack,False,False,True,
Show the images (image_512) of all deleted users.,"MATCH (d:Deleted)
RETURN d.image_512 AS Image512",Simple Aggregation Queries,slack,False,False,True,
What is the color of the bot named 'communitygraph'?,"MATCH (b:Bot {name: 'communitygraph'})
RETURN b.color AS Color",Simple Aggregation Queries,slack,False,True,False,
List all the channels that a user named 'ryguyrg.neo' is a member of.,"MATCH (u:User {name: 'ryguyrg.neo'})-[:MEMBER_OF]->(c:Channel)
RETURN c",Simple Aggregation Queries,slack,False,False,True,
What are the last names of the users who reacted to the threaded message with id '1581274875.020900'?,"MATCH (u:User)-[:REACTED]->(r:Reaction)-[:TO_MESSAGE]->(tm:ThreadedMessage {id: '1581274875.020900'})
RETURN u.last_name AS LastName",Simple Aggregation Queries,slack,False,False,True,
Show all channels that have been mentioned in messages.,"MATCH (m:Message)-[:MENTIONS_CHANNEL]->(c:Channel)
RETURN DISTINCT c",Simple Aggregation Queries,slack,False,False,True,
Which users have the title 'Caretaker General Community Neo4j'?,"MATCH (u:User {title: 'Caretaker General Community Neo4j'})
RETURN u",Simple Aggregation Queries,slack,False,False,True,
List the titles of all attachments in messages posted in 2018.,"MATCH (m:Message)-[:HAS_ATTACHMENT]->(a:Attachment)
WHERE m.createdAt >= datetime('2018-01-01T00:00:00Z') AND m.createdAt < datetime('2019-01-01T00:00:00Z')
RETURN a.title AS AttachmentTitle",Simple Aggregation Queries,slack,False,False,True,
What are the first names of all owners who have posted a message?,"MATCH (o:Owner)-[:POSTED]->(:Message)
RETURN DISTINCT o.first_name AS FirstName",Simple Aggregation Queries,slack,False,False,True,
List the first 5 deleted users by the date they posted their last message.,"MATCH (u:Deleted)-[:POSTED]->(m:Message)
WITH u, m.createdAt AS lastPostDate
ORDER BY lastPostDate DESC
RETURN u.id AS UserId, u.display_name AS DisplayName, lastPostDate
LIMIT 5",Pathfinding Queries,slack,False,False,False,
Which channels have a created date on or before '2017-01-01'?,"MATCH (c:Channel)
WHERE c.createdAt <= datetime('2017-01-01T00:00:00Z')
RETURN c",Simple Aggregation Queries,slack,False,False,True,
Show all users who have a status emoji of ':neo4j:'.,"MATCH (u:User)
WHERE u.status_emoji = ':neo4j:'
RETURN u",Simple Aggregation Queries,slack,False,False,False,
Which channels have a message type 'message' and subtype 'channel_join'?,"MATCH (m:Message {type: 'message', subtype: 'channel_join'})-[:IN_CHANNEL]->(c:Channel)
RETURN c",Simple Aggregation Queries,slack,False,False,True,
Show all users who have posted a threaded message with the type 'message'.,"MATCH (u:User)-[:POSTED]->(tm:ThreadedMessage {type: 'message'})
RETURN u",Simple Aggregation Queries,slack,False,False,True,
List the titles of all bots that have posted messages.,"MATCH (b:Bot)-[:POSTED]->(m:Message)
RETURN DISTINCT b.title AS BotTitle",Simple Aggregation Queries,slack,False,False,True,
Show all reactions to messages from the user with the display name 'michael.neo'.,"MATCH (u:User {display_name: 'michael.neo'})-[:POSTED]->(m:Message)
MATCH (r:Reaction)-[:TO_MESSAGE]->(m)
RETURN r",Simple Aggregation Queries,slack,False,False,True,
List the channels that have a message with the subtype 'channel_join'.,"MATCH (m:Message {subtype: 'channel_join'})-[:IN_CHANNEL]->(c:Channel)
RETURN DISTINCT c",Simple Aggregation Queries,slack,False,False,True,
Which users have the skype id 'maxdemarzi'?,"MATCH (u:User {skype: 'maxdemarzi'})
RETURN u",Simple Aggregation Queries,slack,False,False,False,
Show the first names of all primary owners with a status expiration of 0.,"MATCH (po:PrimaryOwner {status_expiration: 0})
RETURN po.first_name",Simple Aggregation Queries,slack,False,False,True,
List the real names of all bots in the channel 'neo4j-graphql'.,"MATCH (b:Bot)-[:MEMBER_OF]->(c:Channel {name: 'neo4j-graphql'})
RETURN b.real_name AS BotRealName",Simple Aggregation Queries,slack,False,False,False,
Which messages have an attachment with a thumb_url containing 'neo4j'?,"MATCH (m:Message)-[:HAS_ATTACHMENT]->(a:Attachment)
WHERE a.thumb_url CONTAINS 'neo4j'
RETURN m",Simple Aggregation Queries,slack,False,False,True,
Show all messages posted by bots in the channel 'neo4j-graphql'.,"MATCH (b:Bot)-[:POSTED]->(m:Message)-[:IN_CHANNEL]->(c:Channel {name: 'neo4j-graphql'})
RETURN m",Simple Aggregation Queries,slack,False,False,True,
What are the display names of users who have edited a message in the 'help-import' channel?,"MATCH (u:User)-[:EDITED]->(m:Message)-[:IN_CHANNEL]->(c:Channel {name: 'help-import'})
RETURN DISTINCT u.display_name AS DisplayName",Simple Aggregation Queries,slack,False,False,True,
List all deleted users who have reacted to a message.,"MATCH (d:Deleted)-[:REACTED]->(:Reaction)-[:TO_MESSAGE]->(:Message)
RETURN d",Simple Aggregation Queries,slack,False,False,False,
Show the skype ids of all users with the status text ':neo4j:'.,"MATCH (u:User)
WHERE u.status_text = ':neo4j:' AND u.skype IS NOT NULL
RETURN u.skype",Simple Aggregation Queries,slack,False,False,True,
What is the color of the app user named 'github'?,"MATCH (a:AppUser {name: 'github'})
RETURN a.color",Simple Aggregation Queries,slack,False,False,True,
List the reactions made by the primary owner named 'michael.neo' to the threaded message with id '1581274875.020900'.,"MATCH (po:PrimaryOwner {name: 'michael.neo'})-[:REACTED]->(r:Reaction)-[:TO_MESSAGE]->(tm:ThreadedMessage {id: '1581274875.020900'})
RETURN r",Simple Aggregation Queries,slack,False,False,True,
Which channels have their purpose related to 'Neo4j GraphQL integration'?,"MATCH (c:Channel)
WHERE c.purpose CONTAINS 'Neo4j GraphQL integration'
RETURN c",Simple Aggregation Queries,slack,False,False,True,
Show the images (image_1024) of admins.,"MATCH (a:Admin)
RETURN a.image_1024 AS Image",Simple Aggregation Queries,slack,False,False,True,
What are the names of channels where the primary owner is not 'michael.neo'?,"MATCH (po:PrimaryOwner)-[:CREATED]->(c:Channel)
WHERE po.name <> 'michael.neo'
RETURN c.name AS ChannelName",Simple Aggregation Queries,slack,False,False,True,
List all messages that were edited by a user named 'michael.neo'.,"MATCH (u:User {name: 'michael.neo'})-[:EDITED]->(m:Message)
RETURN m",Simple Aggregation Queries,slack,False,False,True,
Which channels have a topic related to 'import-export'?,"MATCH (c:Channel)
WHERE c.topic CONTAINS 'import-export'
RETURN c",Simple Aggregation Queries,slack,False,False,True,
Show the image_original links of all app users.,"MATCH (a:AppUser)
RETURN a.image_original AS ImageOriginalLinks",Simple Aggregation Queries,slack,False,False,True,
What are the names of all bots that have reacted to messages?,"MATCH (b:Bot)-[:REACTED]->(r:Reaction)-[:TO_MESSAGE]->(m:Message)
RETURN DISTINCT b.name AS BotNames",Simple Aggregation Queries,slack,False,False,True,
List the names of all users who have a color of '9f69e7'.,"MATCH (u:User)
WHERE u.color = '9f69e7'
RETURN u.name",Simple Aggregation Queries,slack,False,False,True,
What is the text of the latest message in the channel 'organize-meetups'?,"MATCH (c:Channel {name: 'organize-meetups'})<-[:IN_CHANNEL]-(m:Message)
RETURN m.text AS messageText
ORDER BY m.createdAt DESC
LIMIT 1",Simple Aggregation Queries,slack,False,False,False,
What are the names of the 3 most recent threaded messages mentioning Michael Hunger?,"MATCH (tm:ThreadedMessage)-[:MENTIONS_USER]->(u:User {real_name: ""Michael Hunger""})
RETURN tm.text AS ThreadedMessageText
ORDER BY tm.createdAt DESC
LIMIT 3",Pathfinding Queries,slack,False,False,True,
List the top 5 deleted users who have posted the most messages.,"MATCH (d:Deleted)-[:POSTED]->(m:Message)
WITH d, count(m) AS messagesPosted
ORDER BY messagesPosted DESC
LIMIT 5
RETURN d.name AS DeletedUserName, messagesPosted",Complex Aggregation Queries,slack,False,False,True,
List the first 5 channels with the most mentions in messages.,"MATCH (m:Message)-[:MENTIONS_CHANNEL]->(c:Channel)
WITH c, count(m) AS mentions
ORDER BY mentions DESC
LIMIT 5
RETURN c.name, mentions",Pathfinding Queries,slack,False,False,True,
Name the first three Bots that have posted Messages in any Channel.,"MATCH (b:Bot)-[:POSTED]->(m:Message)-[:IN_CHANNEL]->(c:Channel)
RETURN b.name AS BotName
LIMIT 3",Verbose query,slack,False,False,True,
Which three Owners have edited Messages in the 'neo4j-graphql' Channel?,"MATCH (o:Owner)-[:EDITED]->(m:Message)-[:IN_CHANNEL]->(c:Channel {name: 'neo4j-graphql'})
RETURN DISTINCT o LIMIT 3",Verbose query,slack,False,False,True,
List the names of the top five Users who are members of the Channel named 'help-cypher'.,"MATCH (u:User)-[:MEMBER_OF]->(c:Channel {name: 'help-cypher'})
RETURN u.name
LIMIT 5",Verbose query,slack,False,False,True,
What are the names of the first three Channels created by the user with the display name 'michael.neo'?,"MATCH (u:User {display_name: 'michael.neo'})-[:CREATED]->(c:Channel)
RETURN c.name
ORDER BY c.createdAt
LIMIT 3",Verbose query,slack,False,False,True,
List the top 3 primary owners by number of channels created.,"MATCH (p:PrimaryOwner)-[:CREATED]->(c:Channel)
WITH p, count(c) AS channels_created
ORDER BY channels_created DESC
LIMIT 3
RETURN p.display_name AS PrimaryOwner, channels_created",Complex Aggregation Queries,slack,True,False,False,
What are the top 5 messages with the most attachments?,"MATCH (m:Message)-[:HAS_ATTACHMENT]->(a:Attachment)
WITH m, count(a) AS attachment_count
ORDER BY attachment_count DESC
LIMIT 5
RETURN m, attachment_count",Complex Aggregation Queries,slack,False,False,True,
Which 3 channels have the most unique reactions to their messages?,"MATCH (c:Channel)-[:IN_CHANNEL]-(m:Message)
WITH c, m
MATCH (m)-[:HAS_REACTION]->(r:Reaction)
RETURN c.name AS ChannelName, COUNT(DISTINCT r) AS UniqueReactions
ORDER BY UniqueReactions DESC
LIMIT 3",Complex Aggregation Queries,slack,False,False,True,HAS_REACTION
List the top 5 channels based on the diversity of user titles of members.,"MATCH (u:User)-[:MEMBER_OF]->(c:Channel)
WITH c, count(DISTINCT u.title) AS diversity
ORDER BY diversity DESC
LIMIT 5
RETURN c.name AS ChannelName, diversity",Complex Aggregation Queries,slack,False,False,True,
What are the titles of the three most recent ThreadedMessages posted by the Admin named 'michael.neo'?,"MATCH (a:Admin {name: 'michael.neo'})-[:POSTED]->(tm:ThreadedMessage)
RETURN tm.title
ORDER BY tm.createdAt DESC
LIMIT 3",Verbose query,slack,False,False,True,ThreadedMessage.title
What are the top 3 time zones with the most users?,"MATCH (u:User)-[:IN_TIMEZONE]->(tz:TimeZone)
RETURN tz.id AS TimeZone, count(u) AS NumberOfUsers
ORDER BY NumberOfUsers DESC
LIMIT 3",Complex Aggregation Queries,slack,False,False,False,
List the top 3 bots by number of channels they are members of.,"MATCH (b:Bot)-[:MEMBER_OF]->(c:Channel)
WITH b, count(c) AS num_channels
ORDER BY num_channels DESC
LIMIT 3
RETURN b.name, num_channels",Complex Aggregation Queries,slack,False,False,True,
What are the top 5 channels by number of reactions received on their messages?,"MATCH (c:Channel)<-[:IN_CHANNEL]-(m:Message)<-[:TO_MESSAGE]-(r:Reaction)
RETURN c.name AS ChannelName, count(r) AS NumberOfReactions
ORDER BY NumberOfReactions DESC
LIMIT 5",Complex Aggregation Queries,slack,False,False,True,
Which 3 channels have the most mentions of other channels in their messages?,"MATCH (c:Channel)<-[:IN_CHANNEL]-(m:Message)-[:MENTIONS_CHANNEL]->(other:Channel)
WITH c, count(other) AS mentions
ORDER BY mentions DESC
LIMIT 3
RETURN c.name AS channelName, mentions",Complex Aggregation Queries,slack,False,False,False,
List the top 5 users based on the number of messages they have edited.,"MATCH (u:User)-[:EDITED]->(m:Message)
WITH u, count(m) AS edits
ORDER BY edits DESC
LIMIT 5
RETURN u.name AS UserName, edits",Complex Aggregation Queries,slack,False,False,False,
What are the top 3 messages with the longest text?,"MATCH (m:Message)
WHERE m.text IS NOT NULL
RETURN m
ORDER BY length(m.text) DESC
LIMIT 3",Complex Aggregation Queries,slack,False,False,True,
Which 5 channels have the largest number of members?,"MATCH (c:Channel)<-[:MEMBER_OF]-(u)
RETURN c.name, count(u) AS memberCount
ORDER BY memberCount DESC
LIMIT 5",Complex Aggregation Queries,slack,False,False,True,
List the top 3 users who have the most status updates.,"MATCH (u:User)
WHERE u.status_text IS NOT NULL
RETURN u.name, count(u.status_text) AS status_updates
ORDER BY status_updates DESC
LIMIT 3",Complex Aggregation Queries,slack,False,False,True,
What are the top 5 emojis used in reactions?,"MATCH (e:Emoji)<-[:REACTION_TYPE]-(r:Reaction)
RETURN e.name AS Emoji, count(r) AS UsageCount
ORDER BY UsageCount DESC
LIMIT 5",Complex Aggregation Queries,slack,False,False,True,
Who are the top 5 users with the most custom images?,"MATCH (u:User)
WHERE u.is_custom_image = true
RETURN u.name, count(u) AS customImageCount
ORDER BY customImageCount DESC
LIMIT 5",Complex Aggregation Queries,slack,False,False,False,
Which three Users reacted to the Message with the id '1507313352.000514'?,"MATCH (u:User)-[:REACTED]->(r:Reaction)-[:TO_MESSAGE]->(m:Message {id: '1507313352.000514'})
RETURN u
LIMIT 3",Verbose query,slack,False,False,True,
List the first names of the top five Users who are in the 'Europe/Amsterdam' TimeZone.,"MATCH (u:User)-[:IN_TIMEZONE]->(tz:TimeZone {id: 'Europe/Amsterdam'})
RETURN u.first_name
LIMIT 5",Verbose query,slack,False,False,True,
What are the names of the first three Channels where the PrimaryOwner with the real name 'Michael Hunger' is a member?,"MATCH (po:PrimaryOwner {real_name: 'Michael Hunger'})-[:MEMBER_OF]->(c:Channel)
RETURN c.name
LIMIT 3",Verbose query,slack,False,False,True,
List the real names of all bots that are members of the channel named 'neo4j-graphql'.,"MATCH (b:Bot)-[:MEMBER_OF]->(c:Channel {name: 'neo4j-graphql'})
RETURN b.real_name AS BotRealName",Simple Aggregation Queries,slack,False,False,True,
List the names of the first three Bots that have a status emoji set to ':python:'.,"MATCH (b:Bot {status_emoji: ':python:'})
RETURN b.name
LIMIT 3",Verbose query,slack,False,False,True,Bot.status_emoji
Which three Admins have edited Messages in the 'neo4j-graphql' Channel?,"MATCH (a:Admin)-[:EDITED]->(m:Message)-[:IN_CHANNEL]->(c:Channel {name: 'neo4j-graphql'})
RETURN a.name
LIMIT 3",Verbose query,slack,False,False,True,
What are the display names of the first three Users who reacted to the ThreadedMessage with the id '1581274875.020900'?,"MATCH (u:User)-[:REACTED]->(r:Reaction)-[:TO_MESSAGE]->(tm:ThreadedMessage {id: '1581274875.020900'})
RETURN u.display_name
LIMIT 3",Verbose query,slack,False,False,True,
List the titles of the top five ThreadedMessages that have an Attachment.,"MATCH (tm:ThreadedMessage)-[:HAS_ATTACHMENT]->(a:Attachment)
RETURN tm.title AS Title
ORDER BY tm.createdAt DESC
LIMIT 5",Verbose query,slack,False,False,True,ThreadedMessage.title
Which three Channels have the most Reactions associated with their Messages?,"MATCH (c:Channel)-[:IN_CHANNEL]-(m:Message)
WITH c, count{(m)-[:HAS_REACTION]->()} AS reactionCount
RETURN c.name AS ChannelName, reactionCount
ORDER BY reactionCount DESC
LIMIT 3",Verbose query,slack,False,False,True,HAS_REACTION
What are the first names of the first three Deleted users who are members of the Channel named 'help-cypher'?,"MATCH (d:Deleted)-[:MEMBER_OF]->(c:Channel {name: 'help-cypher'})
RETURN d.first_name
LIMIT 3",Verbose query,slack,False,False,True,
List the top five Messages that mention the User with the display name 'michael.neo'.,"MATCH (m:Message)-[:MENTIONS_USER]->(u:User {display_name: 'michael.neo'})
RETURN m
ORDER BY m.createdAt DESC
LIMIT 5",Verbose query,slack,False,False,True,
Which three Bots are members of the most Channels?,"MATCH (b:Bot)-[:MEMBER_OF]->(c:Channel)
WITH b, count(c) AS num_channels
ORDER BY num_channels DESC
LIMIT 3
RETURN b.name, num_channels",Verbose query,slack,False,False,True,
List the real names of the first three PrimaryOwners who have posted a Message in any Channel.,"MATCH (po:PrimaryOwner)-[:POSTED]->(:Message)-[:IN_CHANNEL]->(:Channel)
RETURN po.real_name
LIMIT 3",Verbose query,slack,False,False,True,
Which three Owners have their TimeZone set to 'Europe/Amsterdam'?,"MATCH (o:Owner)-[:IN_TIMEZONE]->(tz:TimeZone {id: 'Europe/Amsterdam'})
RETURN o
LIMIT 3",Verbose query,slack,False,False,True,
What are the names of the first three Channels created by any Admin?,"MATCH (a:Admin)-[:CREATED]->(c:Channel)
RETURN c.name
ORDER BY c.createdAt
LIMIT 3",Verbose query,slack,False,False,True,
List the top five Users by the number of Messages they have edited.,"MATCH (u:User)-[:EDITED]->(m:Message)
WITH u, count(m) AS edits
ORDER BY edits DESC
LIMIT 5
RETURN u.name AS UserName, edits",Verbose query,slack,False,False,True,
Which three Users have a custom image and are members of the Channel named 'neo4j-graphql'?,"MATCH (u:User)-[:MEMBER_OF]->(c:Channel {name: 'neo4j-graphql'})
WHERE u.is_custom_image = true
RETURN u
LIMIT 3",Verbose query,slack,False,False,True,
What are the text contents of the top five Attachments in Messages within the 'help-cypher' Channel?,"MATCH (c:Channel {name: 'help-cypher'})<-[:IN_CHANNEL]-(m:Message)-[:HAS_ATTACHMENT]->(a:Attachment)
RETURN a.text AS AttachmentText
ORDER BY a.createdAt DESC
LIMIT 5",Verbose query,slack,False,False,False,Attachment.createdAt
List the names of the first three Emojis used in Reactions to Messages.,"MATCH (e:Emoji)<-[:REACTION_TYPE]-(r:Reaction)-[:TO_MESSAGE]->(m:Message)
RETURN e.name AS EmojiName
LIMIT 3",Verbose query,slack,False,False,False,
Which three Users have the highest pagerank and are members of the Channel named 'neo4j-sdn-ogm'?,"MATCH (u:User)-[:MEMBER_OF]->(c:Channel {name: 'neo4j-sdn-ogm'})
WHERE c.pagerank IS NOT NULL
RETURN u
ORDER BY c.pagerank DESC
LIMIT 3",Verbose query,slack,False,False,True,
What are the ids of the first three Deleted users who have posted a ThreadedMessage?,"MATCH (d:Deleted)-[:POSTED]->(tm:ThreadedMessage)
RETURN d.id
LIMIT 3",Verbose query,slack,False,False,True,
List the top five Channels with the most Messages posted in them.,"MATCH (c:Channel)<-[:IN_CHANNEL]-(m:Message)
RETURN c.name, count(m) AS message_count
ORDER BY message_count DESC
LIMIT 5",Verbose query,slack,False,False,True,
Which 3 admins have created the most channels?,"MATCH (a:Admin)-[:CREATED]->(c:Channel)
WITH a, count(c) AS channels_created
ORDER BY channels_created DESC
LIMIT 3
RETURN a.display_name AS AdminName, channels_created",Complex Aggregation Queries,slack,False,False,True,
Which 5 users have the most threaded messages posted?,"MATCH (u:User)-[:POSTED]->(tm:ThreadedMessage)
RETURN u.name AS UserName, count(tm) AS ThreadedMessagesCount
ORDER BY ThreadedMessagesCount DESC
LIMIT 5",Pathfinding Queries,slack,False,False,True,
Which 5 users are in the most time zones?,"MATCH (u:User)-[:IN_TIMEZONE]->(tz:TimeZone)
WITH u, count(DISTINCT tz) AS num_timezones
ORDER BY num_timezones DESC
LIMIT 5
RETURN u.name AS user_name, num_timezones",Complex Aggregation Queries,slack,False,False,True,
Which 5 users have reacted to the most number of unique messages?,"MATCH (u:User)-[:REACTED]->(r:Reaction)-[:TO_MESSAGE]->(m:Message)
WITH u, COUNT(DISTINCT m) AS uniqueMessages
ORDER BY uniqueMessages DESC
LIMIT 5
RETURN u.name AS UserName, uniqueMessages",Complex Aggregation Queries,slack,False,False,True,
List the first 5 emojis used in reactions to messages in the 'neo4j-graphql' channel.,"MATCH (c:Channel {name: 'neo4j-graphql'})<-[:IN_CHANNEL]-(m:Message)
MATCH (r:Reaction)-[:TO_MESSAGE]->(m)
MATCH (e:Emoji)<-[:REACTION_TYPE]-(r)
RETURN e.name
LIMIT 5",Pathfinding Queries,slack,False,False,False,
Which 3 channels have the most edited messages?,"MATCH (c:Channel)<-[:IN_CHANNEL]-(m:Message)
WHERE exists{(m)-[:EDITED]->()}
RETURN c.name, count(m) AS editedMessages
ORDER BY editedMessages DESC
LIMIT 3",Pathfinding Queries,slack,False,False,False,
What are the names of the 5 most recent users who joined the 'random' channel?,"MATCH (u:User)-[:MEMBER_OF]->(c:Channel {name: 'random'})
RETURN u.name
ORDER BY u.createdAt DESC
LIMIT 5",Pathfinding Queries,slack,False,False,False,User.createdAt
List the first 3 messages that mention the 'neo4j-ruby' channel.,"MATCH (m:Message)-[:MENTIONS_CHANNEL]->(c:Channel {name: 'neo4j-ruby'})
RETURN m
LIMIT 3",Pathfinding Queries,slack,False,False,True,
Which 5 channels have the most users as members?,"MATCH (u:User)-[:MEMBER_OF]->(c:Channel)
RETURN c.name, count(u) AS memberCount
ORDER BY memberCount DESC
LIMIT 5",Pathfinding Queries,slack,True,False,False,
What are the names of 3 users with the most recent profile image updates?,"MATCH (u:User)
WHERE u.image_original IS NOT NULL
RETURN u.name
ORDER BY u.image_original DESC
LIMIT 3",Pathfinding Queries,slack,False,False,True,
List the first 5 channels where 'Michael Hunger' is a primary owner.,"MATCH (p:PrimaryOwner {real_name: 'Michael Hunger'})-[:CREATED]->(c:Channel)
RETURN c
LIMIT 5",Pathfinding Queries,slack,False,False,True,
Which 5 users have the most threaded messages mentioning them?,"MATCH (u:User)<-[:MENTIONS_USER]-(tm:ThreadedMessage)
RETURN u.name, count(tm) AS mentions
ORDER BY mentions DESC
LIMIT 5",Pathfinding Queries,slack,False,False,True,
What are the names of the 3 most recent messages with the 'message' type?,"MATCH (m:Message {type: 'message'})
RETURN m.text AS MessageText
ORDER BY m.createdAt DESC
LIMIT 3",Pathfinding Queries,slack,False,False,True,
What are the names of the 3 most recent messages posted by bots?,"MATCH (b:Bot)-[:POSTED]->(m:Message)
RETURN m.text AS message_text
ORDER BY m.createdAt DESC
LIMIT 3",Pathfinding Queries,slack,False,False,True,
Which 5 users have the most mentions in messages?,"MATCH (u:User)-[:MENTIONS_USER]->(m:Message)
RETURN u.name, count(m) AS mentions
ORDER BY mentions DESC
LIMIT 5",Pathfinding Queries,slack,True,False,False,
What are the names of the 3 most recent bots that joined the 'neo4j-graphql' channel?,"MATCH (b:Bot)-[:MEMBER_OF]->(c:Channel {name: 'neo4j-graphql'})
RETURN b.name
ORDER BY b.createdAt DESC
LIMIT 3",Pathfinding Queries,slack,False,False,True,Bot.createdAt
List the first 5 messages with reactions to the 'simple_smile' emoji.,"MATCH (m:Message)-[:REACTION_TYPE]->(e:Emoji {name: 'simple_smile'})
RETURN m
LIMIT 5",Pathfinding Queries,slack,False,False,True,
Which 3 primary owners have the most edited messages?,"MATCH (po:PrimaryOwner)-[:EDITED]->(m:Message)
WITH po, count(m) AS edits
ORDER BY edits DESC
LIMIT 3
RETURN po.display_name AS PrimaryOwner, edits",Pathfinding Queries,slack,False,False,True,
What are the names of the top 5 users who have posted messages in the 'random' channel?,"MATCH (u:User)-[:POSTED]->(m:Message)-[:IN_CHANNEL]->(c:Channel {name: 'random'})
RETURN u.name AS UserName
ORDER BY count(m) DESC
LIMIT 5",Pathfinding Queries,slack,False,False,False,
List the first 3 channels created by admins that are not archived.,"MATCH (a:Admin)-[:CREATED]->(c:Channel)
WHERE c.is_archived = false
RETURN c
ORDER BY c.createdAt
LIMIT 3",Pathfinding Queries,slack,False,False,True,
Which 5 users have posted the most reactions to messages?,"MATCH (u:User)-[:REACTED]->(r:Reaction)
WITH u, count(r) AS reactions_count
ORDER BY reactions_count DESC
LIMIT 5
RETURN u.name AS user_name, reactions_count",Pathfinding Queries,slack,False,False,True,
What are the names of 3 channels with the most threaded messages posted in them?,"MATCH (c:Channel)<-[:IN_CHANNEL]-(tm:ThreadedMessage)
RETURN c.name AS ChannelName, count(tm) AS ThreadedMessagesCount
ORDER BY ThreadedMessagesCount DESC
LIMIT 3",Pathfinding Queries,slack,False,False,True,
List the first 3 channels with the most reactions to messages.,"MATCH (c:Channel)<-[:IN_CHANNEL]-(m:Message)
WITH c, count{(m)-[:HAS_REACTION]->()} AS reactionCount
ORDER BY reactionCount DESC
LIMIT 3
RETURN c.name AS ChannelName, reactionCount",Pathfinding Queries,slack,False,False,True,HAS_REACTION
Which 5 users have the most reactions of type 'simple_smile'?,"MATCH (u:User)-[:REACTED]->(r:Reaction)-[:REACTION_TYPE]->(e:Emoji {name: 'simple_smile'})
WITH u, count(r) AS reaction_count
ORDER BY reaction_count DESC
LIMIT 5
RETURN u, reaction_count",Pathfinding Queries,slack,False,False,True,
List the first 3 channels with the longest text in their purpose descriptions.,"MATCH (c:Channel)
WHERE c.purpose IS NOT NULL
RETURN c.name, c.purpose
ORDER BY length(c.purpose) DESC
LIMIT 3",Pathfinding Queries,slack,False,False,True,
What are the names of the 5 most recent users who have changed their status emoji to ':neo4j:'?,"MATCH (u:User)
WHERE u.status_emoji = ':neo4j:'
RETURN u.name
ORDER BY u.status_expiration DESC
LIMIT 5",Pathfinding Queries,slack,False,False,True,
List the top 3 channels with the most threaded messages.,"MATCH (c:Channel)<-[:IN_CHANNEL]-(tm:ThreadedMessage)
RETURN c.name, count(tm) AS threadedMessageCount
ORDER BY threadedMessageCount DESC
LIMIT 3",Complex Aggregation Queries,slack,False,False,True,
Who are the top 5 owners by number of channels they are members of?,"MATCH (o:Owner)-[:MEMBER_OF]->(c:Channel)
WITH o, count(c) AS channels_count
ORDER BY channels_count DESC
LIMIT 5
RETURN o.display_name AS OwnerDisplayName, channels_count",Complex Aggregation Queries,slack,False,False,True,
What are the top 3 channels with the most edited messages?,"MATCH (c:Channel)<-[:IN_CHANNEL]-(m:Message)
WHERE exists{(m)-[:EDITED]->()}
RETURN c.name, count(m) AS editedMessages
ORDER BY editedMessages DESC
LIMIT 3",Complex Aggregation Queries,slack,False,False,True,
Which 5 users have the most mentions in other users' messages?,"MATCH (u:User)<-[:MENTIONS_USER]-(m:Message)
RETURN u.name AS UserName, count(m) AS MentionsCount
ORDER BY MentionsCount DESC
LIMIT 5",Complex Aggregation Queries,slack,False,False,True,
List the top 5 messages with the most reactions.,"MATCH (m:Message)
WITH m, count{(m)-[:REACTED]->(:Reaction)} AS reactionCount
ORDER BY reactionCount DESC
LIMIT 5
RETURN m, reactionCount",Complex Aggregation Queries,slack,False,False,True,
Which 3 channels have the most attachments added to their messages?,"MATCH (c:Channel)<-[:IN_CHANNEL]-(m:Message)-[:HAS_ATTACHMENT]->(a:Attachment)
RETURN c.name, count(a) AS attachment_count
ORDER BY attachment_count DESC
LIMIT 3",Complex Aggregation Queries,slack,False,False,True,
What are the top 5 most active bots based on message posting?,"MATCH (b:Bot)-[:POSTED]->(m:Message)
RETURN b.name, count(m) AS messages_posted
ORDER BY messages_posted DESC
LIMIT 5",Complex Aggregation Queries,slack,False,False,True,
Who are the top 3 users by number of threaded messages posted?,"MATCH (u:User)-[:POSTED]->(tm:ThreadedMessage)
RETURN u.name AS UserName, count(tm) AS ThreadedMessagesCount
ORDER BY ThreadedMessagesCount DESC
LIMIT 3",Complex Aggregation Queries,slack,False,False,True,
List the top 5 users who have posted messages in the most number of unique channels.,"MATCH (u:User)-[:POSTED]->(m:Message)-[:IN_CHANNEL]->(c:Channel)
WITH u, count(DISTINCT c) AS uniqueChannels
ORDER BY uniqueChannels DESC
LIMIT 5
RETURN u, uniqueChannels",Complex Aggregation Queries,slack,False,False,True,
Which 5 channels have the highest number of archived messages?,"MATCH (c:Channel)-[:IN_CHANNEL]-(m:Message)
WHERE c.is_archived = true
RETURN c.name, count(m) AS archived_messages
ORDER BY archived_messages DESC
LIMIT 5",Complex Aggregation Queries,slack,False,False,True,
What are the top 3 most mentioned users in messages?,"MATCH (m:Message)-[:MENTIONS_USER]->(u:User)
WITH u, count(m) AS mentions
ORDER BY mentions DESC
LIMIT 3
RETURN u.name AS UserName, mentions",Complex Aggregation Queries,slack,False,False,True,
Who are the top 3 users based on the number of reactions they have given?,"MATCH (u:User)-[:REACTED]->(r:Reaction)
WITH u, count(r) AS reactions_count
ORDER BY reactions_count DESC
LIMIT 3
RETURN u.name AS user_name, reactions_count",Complex Aggregation Queries,slack,False,False,True,
List the top 5 channels by the number of unique users who have posted messages.,"MATCH (u:User)-[:POSTED]->(m:Message)-[:IN_CHANNEL]->(c:Channel)
WITH c, count(DISTINCT u) AS uniqueUsers
ORDER BY uniqueUsers DESC
RETURN c.name AS ChannelName, uniqueUsers
LIMIT 5",Complex Aggregation Queries,slack,False,False,True,
Which 5 users have edited the most messages?,"MATCH (u:User)-[e:EDITED]->(m:Message)
RETURN u.name AS UserName, count(e) AS Edits
ORDER BY Edits DESC
LIMIT 5",Complex Aggregation Queries,slack,False,False,False,
What are the top 3 channels by number of messages posted?,"MATCH (c:Channel)<-[:IN_CHANNEL]-(m:Message)
RETURN c.name, count(m) AS message_count
ORDER BY message_count DESC
LIMIT 3",Complex Aggregation Queries,slack,False,False,True,
Who are the top 5 users by number of channels created?,"MATCH (u:User)-[:CREATED]->(c:Channel)
RETURN u.name AS UserName, count(c) AS ChannelsCreated
ORDER BY ChannelsCreated DESC
LIMIT 5",Complex Aggregation Queries,slack,False,False,True,
What are the names of the 3 most recent users to post a threaded message?,"MATCH (u:User)-[:POSTED]->(tm:ThreadedMessage)
RETURN u.name AS UserName
ORDER BY tm.createdAt DESC
LIMIT 3",Pathfinding Queries,slack,False,False,False,
List the first 5 messages that have an attachment with a title containing 'Neo4j'.,"MATCH (m:Message)-[:HAS_ATTACHMENT]->(a:Attachment)
WHERE a.title CONTAINS 'Neo4j'
RETURN m
LIMIT 5",Pathfinding Queries,slack,False,False,True,
Which 3 channels have been mentioned the most in messages?,"MATCH (c:Channel)<-[:MENTIONS_CHANNEL]-(m:Message)
RETURN c.name, count(m) AS mentions
ORDER BY mentions DESC
LIMIT 3",Pathfinding Queries,slack,False,False,False,
What are the top 3 channels with the highest page rank?,"MATCH (c:Channel)
RETURN c.name, c.pagerank
ORDER BY c.pagerank DESC
LIMIT 3",Complex Aggregation Queries,slack,False,False,True,
Show the display names of all primary owners who are members of more than one channel.,"MATCH (po:PrimaryOwner)-[:MEMBER_OF]->(c:Channel)
WITH po, count(c) AS numChannels
WHERE numChannels > 1
RETURN po.display_name AS DisplayName",Simple Aggregation Queries,slack,False,False,False,
List all the channels created by 'markneedham' that are currently archived.,"MATCH (o:Owner {name: 'markneedham'})-[:CREATED]->(c:Channel {is_archived: true})
RETURN c",Simple Retrieval Queries,slack,False,False,True,
What are the types of messages in the 'organize-meetups' channel?,"MATCH (c:Channel {name: 'organize-meetups'})-[:IN_CHANNEL]-(m:Message)
RETURN DISTINCT m.type AS MessageType",Simple Aggregation Queries,slack,False,False,True,
List all the users who are members of the channel with the ID 'C08J10PT2'.,"MATCH (u:User)-[:MEMBER_OF]->(c:Channel {id: 'C08J10PT2'})
RETURN u",Complex Retrieval Queries,slack,False,False,True,
Which channels were created by the user with the ID 'U08J18KHB'?,"MATCH (u:User {id: 'U08J18KHB'})-[:CREATED]->(c:Channel)
RETURN c",Complex Retrieval Queries,slack,False,False,False,
What are the names of the top 3 channels by the number of members?,"MATCH (c:Channel)<-[:MEMBER_OF]-(u)
WITH c, count(u) AS members
ORDER BY members DESC
LIMIT 3
RETURN c.name AS ChannelName, members AS NumberOfMembers",Simple Retrieval Queries,slack,False,False,True,
Which users have posted the most threaded messages in the 'neo4j-graphql' channel?,"MATCH (u:User)-[:POSTED]->(tm:ThreadedMessage)-[:IN_CHANNEL]->(c:Channel {name: 'neo4j-graphql'})
RETURN u.name AS UserName, count(tm) AS ThreadedMessagesCount
ORDER BY ThreadedMessagesCount DESC",Simple Retrieval Queries,slack,False,False,True,
What are the titles of the top 3 attachments in messages posted in channels created by 'michael.neo'?,"MATCH (u:User {name: 'michael.neo'})-[:CREATED]->(c:Channel)
MATCH (m:Message)-[:IN_CHANNEL]->(c)
MATCH (m)-[:HAS_ATTACHMENT]->(a:Attachment)
RETURN a.title
ORDER BY a.createdAt DESC
LIMIT 3",Simple Retrieval Queries,slack,False,False,True,Attachment.createdAt
Which channels have Michael mentioned in the last 5 messages?,"MATCH (m:Message)-[:MENTIONS_USER]->(u:User {name: ""Michael""})
WHERE m.createdAt >= datetime() - duration({days: 5})
WITH m
ORDER BY m.createdAt DESC
LIMIT 5
MATCH (m)-[:IN_CHANNEL]->(c:Channel)
RETURN DISTINCT c.name",Simple Retrieval Queries,slack,False,False,True,
What are the first names of the top 5 most active Bots in terms of message postings?,"MATCH (b:Bot)-[:POSTED]->(m:Message)
WITH b, count(m) AS messages_posted
ORDER BY messages_posted DESC
LIMIT 5
RETURN b.first_name AS BotFirstName, messages_posted",Simple Retrieval Queries,slack,False,False,False,
List the names of 3 Users who reacted to messages with the ':neo4j:' emoji.,"MATCH (u:User)-[:REACTED]->(r:Reaction)-[:REACTION_TYPE]->(e:Emoji {name: ':neo4j:'})
RETURN u.name
LIMIT 3",Simple Retrieval Queries,slack,False,False,True,
Which timezone is associated with the user named 'michael.neo'?,"MATCH (u:User {name: 'michael.neo'})-[:IN_TIMEZONE]->(tz:TimeZone)
RETURN tz;",Complex Retrieval Queries,slack,False,False,True,
Which users have a display name starting with 'm' and are part of the team 'T08J10GA2'?,"MATCH (u:User)
WHERE u.display_name_normalized STARTS WITH 'm' AND u.team = 'T08J10GA2'
RETURN u",Simple Retrieval Queries,slack,False,False,True,
Identify the top 3 channels by the number of reactions to their messages.,"MATCH (c:Channel)<-[:IN_CHANNEL]-(m:Message)
WITH c, count{(m)-[:HAS_REACTION]->()} AS reactionCount
ORDER BY reactionCount DESC
LIMIT 3
RETURN c.name AS ChannelName, reactionCount AS NumberOfReactions",Simple Retrieval Queries,slack,False,False,True,HAS_REACTION
Which Bots have posted messages with attachments in the 'neo4j-python' channel?,"MATCH (b:Bot)-[:POSTED]->(m:Message)-[:HAS_ATTACHMENT]->(a:Attachment),
      (m)-[:IN_CHANNEL]->(c:Channel {name: 'neo4j-python'})
RETURN b, m, a",Simple Retrieval Queries,slack,False,False,False,
List the names of all Users who are in the timezone 'Europe/Amsterdam' and have edited a threaded message.,"MATCH (u:User)-[:IN_TIMEZONE]->(tz:TimeZone {id: 'Europe/Amsterdam'}),
      (u)-[:EDITED]->(tm:ThreadedMessage)
RETURN DISTINCT u.name",Simple Retrieval Queries,slack,False,False,True,
What are the first names of the 3 most active Owners in terms of message postings?,"MATCH (o:Owner)-[:POSTED]->(m:Message)
WITH o, count(m) AS messages_posted
ORDER BY messages_posted DESC
LIMIT 3
RETURN o.first_name AS First_Name, messages_posted",Simple Retrieval Queries,slack,False,False,False,
Which Admins have a status text of ':neo4j:'?,"MATCH (a:Admin {status_text: ':neo4j:'})
RETURN a",Simple Retrieval Queries,slack,False,False,True,
List the first names of 5 users who have the most posts in the 'neo4j-python' channel.,"MATCH (u:User)-[:POSTED]->(m:Message)-[:IN_CHANNEL]->(c:Channel {name: 'neo4j-python'})
WITH u, count(m) AS posts
ORDER BY posts DESC
LIMIT 5
RETURN u.first_name AS FirstName",Simple Retrieval Queries,slack,False,False,True,
Which channels have a purpose related to 'Neo4j Ruby'?,"MATCH (c:Channel)
WHERE c.purpose CONTAINS 'Neo4j Ruby'
RETURN c",Simple Retrieval Queries,slack,False,False,True,
What are the 5 most recent emojis used in reactions by 'michael.neo'?,"MATCH (u:User {name: 'michael.neo'})-[:REACTED]->(r:Reaction)-[:REACTION_TYPE]->(e:Emoji)
RETURN e.name AS Emoji, r.createdAt AS TimeUsed
ORDER BY r.createdAt DESC
LIMIT 5",Simple Retrieval Queries,slack,False,False,True,Reaction.createdAt
What are the titles of the last 5 messages posted in the 'neo4j-graphql' channel by Admins?,"MATCH (a:Admin)-[:POSTED]->(m:Message)-[:IN_CHANNEL]->(c:Channel {name: 'neo4j-graphql'})
RETURN m.title
ORDER BY m.createdAt DESC
LIMIT 5",Simple Retrieval Queries,slack,False,False,True,Message.title
Identify the top 3 users by the number of threaded messages they have posted.,"MATCH (u:User)-[:POSTED]->(tm:ThreadedMessage)
RETURN u, count(tm) AS threadedMessageCount
ORDER BY threadedMessageCount DESC
LIMIT 3",Simple Retrieval Queries,slack,False,False,True,
Find all messages posted by the user 'michael.neo'.,"MATCH (u:User {name: 'michael.neo'})-[:POSTED]->(m:Message)
RETURN m",Complex Retrieval Queries,slack,False,False,True,
Which users have reacted to the message with ID '1507313352.000514'?,"MATCH (u:User)-[:REACTED]->(r:Reaction)-[:TO_MESSAGE]->(m:Message {id: '1507313352.000514'})
RETURN u",Complex Retrieval Queries,slack,False,False,False,
What are the channels that have been created by deleted users?,"MATCH (d:Deleted)-[:CREATED]->(c:Channel)
RETURN c",Complex Retrieval Queries,slack,False,False,True,
Who are the users mentioned in the threaded message with text containing 'preview release'?,"MATCH (tm:ThreadedMessage {text: 'We’re super excited to share the *preview* release'})-[:MENTIONS_USER]->(u:User)
RETURN u",Complex Retrieval Queries,slack,False,False,True,
List all the reactions to the message with ID '1581274875.020900'.,"MATCH (m:Message {id: '1581274875.020900'})<-[:TO_MESSAGE]-(r:Reaction)
RETURN r",Complex Retrieval Queries,slack,False,False,True,
What is the thumb_url of attachments in messages within the channel 'neo4j-graphql'?,"MATCH (c:Channel {name: 'neo4j-graphql'})<-[:IN_CHANNEL]-(m:Message)-[:HAS_ATTACHMENT]->(a:Attachment)
RETURN a.thumb_url AS ThumbURL",Complex Retrieval Queries,slack,False,False,False,
Find all messages that have an attachment with a thumb_width greater than 1000.,"MATCH (m:Message)-[:HAS_ATTACHMENT]->(a:Attachment)
WHERE a.thumb_width > 1000
RETURN m",Complex Retrieval Queries,slack,False,False,True,
Which channels have the user with avatar hash 'g522bc835d74' as a member?,"MATCH (u:User {avatar_hash: 'g522bc835d74'})-[:MEMBER_OF]->(c:Channel)
RETURN c",Complex Retrieval Queries,slack,False,False,True,
What is the title of the user with the ID 'U08J18KHB'?,"MATCH (u:User {id: 'U08J18KHB'})
RETURN u.title AS Title",Complex Retrieval Queries,slack,False,False,False,
List the top 5 users by the number of messages they have posted.,"MATCH (u:User)-[:POSTED]->(m:Message)
RETURN u.name AS UserName, count(m) AS MessagesPosted
ORDER BY MessagesPosted DESC
LIMIT 5",Complex Retrieval Queries,slack,False,False,False,
What are the names of channels where 'Michael Hunger' has posted a message?,"MATCH (u:User {real_name: 'Michael Hunger'})-[:POSTED]->(m:Message)-[:IN_CHANNEL]->(c:Channel)
RETURN DISTINCT c.name",Complex Retrieval Queries,slack,False,False,True,
Which channels have a 'pagerank' of 0.15 and are not archived?,"MATCH (c:Channel)
WHERE c.pagerank = 0.15 AND c.is_archived = FALSE
RETURN c",Complex Retrieval Queries,slack,False,False,True,
Who are the admins of the channel with the topic 'Technical Questions: <https://r.neo4j.com/newbies>'?,"MATCH (c:Channel {topic: 'Technical Questions: <https://r.neo4j.com/newbies>'})<-[:CREATED]-(a:Admin)
RETURN a",Complex Retrieval Queries,slack,False,False,True,
What is the purpose of the channel with the name 'neo4j-ruby'?,"MATCH (c:Channel {name: 'neo4j-ruby'})
RETURN c.purpose AS Purpose",Complex Retrieval Queries,slack,False,False,False,
List all messages that mention the user with display name 'michael.neo'.,"MATCH (m:Message)-[:MENTIONS_USER]->(u:User {display_name: 'michael.neo'})
RETURN m",Complex Retrieval Queries,slack,False,False,True,
Which bots are members of the channel named 'random'?,"MATCH (b:Bot)-[:MEMBER_OF]->(c:Channel {name: 'random'})
RETURN b",Complex Retrieval Queries,slack,False,False,True,
Find all the emojis used in reactions to messages posted by 'Michael Hunger'.,"MATCH (u:User {real_name: 'Michael Hunger'})-[:POSTED]->(m:Message)
MATCH (r:Reaction)-[:TO_MESSAGE]->(m)
MATCH (e:Emoji)<-[:REACTION_TYPE]-(r)
RETURN DISTINCT e.name",Complex Retrieval Queries,slack,False,False,True,
Who are the primary owners of channels created before 2016?,"MATCH (po:PrimaryOwner)-[:CREATED]->(c:Channel)
WHERE c.createdAt < datetime('2016-01-01T00:00:00Z')
RETURN po",Complex Retrieval Queries,slack,False,False,False,
List all the attachments in messages posted in the channel 'random'.,"MATCH (c:Channel {name: 'random'})<-[:IN_CHANNEL]-(m:Message)-[:HAS_ATTACHMENT]->(a:Attachment)
RETURN a",Complex Retrieval Queries,slack,False,False,True,
What are the first names of all users who have edited a message in the channel with ID 'C08J10PT2'?,"MATCH (u:User)-[:EDITED]->(m:Message)-[:IN_CHANNEL]->(c:Channel {id: 'C08J10PT2'})
RETURN DISTINCT u.first_name AS FirstName",Complex Retrieval Queries,slack,False,False,True,
What are the real names of users who have the status emoji ':python:'?,"MATCH (u:User)
WHERE u.status_emoji = ':python:'
RETURN u.real_name AS RealName",Complex Retrieval Queries,slack,False,False,True,
Which channels have 'Michael Hunger' mentioned in the last 5 messages?,"MATCH (m:Message)-[:MENTIONS_USER]->(u:User {real_name: 'Michael Hunger'})
WITH m ORDER BY m.createdAt DESC LIMIT 5
MATCH (m)-[:IN_CHANNEL]->(c:Channel)
RETURN DISTINCT c",Simple Retrieval Queries,slack,False,False,True,
List the names of all Bots that have a custom image.,"MATCH (b:Bot)
WHERE b.is_custom_image = true
RETURN b.name",Simple Retrieval Queries,slack,False,False,True,
What are the names of 3 Users who posted messages in the 'neo4j-graphql' channel last week?,"MATCH (u:User)-[:POSTED]->(m:Message)-[:IN_CHANNEL]->(c:Channel {name: 'neo4j-graphql'})
WHERE m.createdAt >= date({year: 2023, week: 11}) AND m.createdAt < date({year: 2023, week: 12})
RETURN u.name
LIMIT 3",Simple Retrieval Queries,slack,False,True,False,
Identify the top 3 channels by creation date that have been archived.,"MATCH (c:Channel)
WHERE c.is_archived = true
RETURN c
ORDER BY c.createdAt DESC
LIMIT 3",Simple Retrieval Queries,slack,False,False,True,
Which channels have 'Google Drive' mentioned in the last 5 messages?,"MATCH (m:Message)-[:IN_CHANNEL]->(c:Channel)
WHERE m.text CONTAINS 'Google Drive'
WITH c, m ORDER BY m.createdAt DESC LIMIT 5
RETURN DISTINCT c",Simple Retrieval Queries,slack,False,False,True,
What are the 3 most recent reactions made by 'michael.neo'?,"MATCH (u:User {name: 'michael.neo'})-[:REACTED]->(r:Reaction)-[:TO_MESSAGE]->(m)
RETURN r, m
ORDER BY m.createdAt DESC
LIMIT 3",Simple Retrieval Queries,slack,False,False,True,
Which users are in the timezone 'Europe/Amsterdam' and have edited a message in the past year?,"MATCH (u:User)-[:IN_TIMEZONE]->(tz:TimeZone {id: 'Europe/Amsterdam'}),
      (u)-[e:EDITED]->(m:Message)
WHERE e.editedAt >= timestamp() - 31536000000
RETURN u",Simple Retrieval Queries,slack,False,False,True,
List the first names of 3 Deleted users.,"MATCH (d:Deleted)
RETURN d.first_name
LIMIT 3",Simple Retrieval Queries,slack,False,False,True,
Which bots have posted messages in the 'neo4j-python' channel?,"MATCH (b:Bot)-[:POSTED]->(m:Message)-[:IN_CHANNEL]->(c:Channel {name: 'neo4j-python'})
RETURN b.name AS BotName",Simple Retrieval Queries,slack,False,False,True,
List all Owners who are members of the 'neo4j-graphql' channel.,"MATCH (o:Owner)-[:MEMBER_OF]->(c:Channel)
WHERE c.name = 'neo4j-graphql'
RETURN o",Simple Retrieval Queries,slack,False,False,True,
Which 5 users have their display name starting with 'm'?,"MATCH (u:User)
WHERE u.display_name_normalized STARTS WITH 'm'
RETURN u
LIMIT 5",Simple Retrieval Queries,slack,False,False,True,
Who are the top 5 users by the number of messages posted in the 'neo4j-graphql' channel?,"MATCH (u:User)-[:POSTED]->(m:Message)-[:IN_CHANNEL]->(c:Channel {name: 'neo4j-graphql'})
RETURN u.name AS UserName, count(m) AS MessagesPosted
ORDER BY MessagesPosted DESC
LIMIT 5",Simple Retrieval Queries,slack,False,False,True,
Which users have posted messages in the timezone 'Europe/Amsterdam'?,"MATCH (u:User)-[:POSTED]->(m:Message)-[:IN_CHANNEL]->(c:Channel)
WHERE exists {
  (u)-[:IN_TIMEZONE]->(:TimeZone {id: 'Europe/Amsterdam'})
}
RETURN u",Simple Aggregation Queries,slack,False,False,True,
List the last 3 messages posted by 'michael.neo' in any channel.,"MATCH (u:User {name: 'michael.neo'})-[:POSTED]->(m:Message)
RETURN m
ORDER BY m.createdAt DESC
LIMIT 3",Simple Retrieval Queries,slack,False,False,True,
What are the first names of the 5 users who have the most reactions to messages?,"MATCH (u:User)-[:REACTED]->(r:Reaction)
WITH u, count(r) AS reactions
ORDER BY reactions DESC
LIMIT 5
RETURN u.first_name AS FirstName, reactions",Simple Retrieval Queries,slack,False,False,True,
Which users have a status expiration set to 0 and are in the timezone 'Europe/Amsterdam'?,"MATCH (u:User)-[:IN_TIMEZONE]->(tz:TimeZone {id: 'Europe/Amsterdam'})
WHERE u.status_expiration = 0
RETURN u",Simple Retrieval Queries,slack,False,False,True,
Who are the primary owners of the channels created before 2016?,"MATCH (po:PrimaryOwner)-[:CREATED]->(c:Channel)
WHERE c.createdAt < datetime('2016-01-01T00:00:00Z')
RETURN po",Simple Retrieval Queries,slack,False,False,True,
Identify 3 users who are members of the most channels.,"MATCH (u:User)-[:MEMBER_OF]->(c:Channel)
WITH u, count(c) AS num_channels
ORDER BY num_channels DESC
LIMIT 3
RETURN u, num_channels",Simple Retrieval Queries,slack,False,False,True,
What are the names of the top 5 most recent channels created by Admins?,"MATCH (a:Admin)-[:CREATED]->(c:Channel)
RETURN c.name AS ChannelName, c.createdAt AS CreationDate
ORDER BY c.createdAt DESC
LIMIT 5",Simple Retrieval Queries,slack,False,False,True,
List all users who have edited a message in the 'neo4j-python' channel.,"MATCH (u:User)-[:EDITED]->(m:Message)-[:IN_CHANNEL]->(c:Channel {name: 'neo4j-python'})
RETURN DISTINCT u",Simple Retrieval Queries,slack,False,False,True,
Which channels were created by 'michael.neo'?,"MATCH (u:User {name: 'michael.neo'})-[:CREATED]->(c:Channel)
RETURN c",Simple Retrieval Queries,slack,False,False,True,
Which channels have a purpose related to 'Neo4j GraphQL'?,"MATCH (c:Channel)
WHERE c.purpose CONTAINS 'Neo4j GraphQL'
RETURN c",Simple Retrieval Queries,slack,False,False,True,
List the titles of the top 3 attachments in messages posted in the 'neo4j-python' channel.,"MATCH (c:Channel {name: 'neo4j-python'})<-[:IN_CHANNEL]-(m:Message)-[:HAS_ATTACHMENT]->(a:Attachment)
RETURN a.title
ORDER BY m.createdAt DESC
LIMIT 3",Simple Retrieval Queries,slack,False,False,True,
What are the first 5 emojis used in reactions to messages in the 'neo4j-graphql' channel?,"MATCH (c:Channel {name: 'neo4j-graphql'})<-[:IN_CHANNEL]-(m:Message)
MATCH (r:Reaction)-[:TO_MESSAGE]->(m)
MATCH (e:Emoji)<-[:REACTION_TYPE]-(r)
RETURN e.name AS EmojiName
LIMIT 5",Simple Retrieval Queries,slack,False,False,True,
Which users have posted threaded messages that mention 'michael.neo'?,"MATCH (u:User)-[:POSTED]->(tm:ThreadedMessage)-[:MENTIONS_USER]->(mentioned:User {name: 'michael.neo'})
RETURN DISTINCT u",Simple Retrieval Queries,slack,False,False,False,
Which TimeZone has the most users associated with it?,"MATCH (u:User)-[:IN_TIMEZONE]->(tz:TimeZone)
RETURN tz, count(u) AS userCount
ORDER BY userCount DESC
LIMIT 1",Simple Retrieval Queries,slack,False,False,True,
What are the titles of the 5 most recent attachments in messages posted by Owners?,"MATCH (o:Owner)-[:POSTED]->(m:Message)-[:HAS_ATTACHMENT]->(a:Attachment)
RETURN a.title AS AttachmentTitle
ORDER BY m.createdAt DESC
LIMIT 5",Simple Retrieval Queries,slack,False,False,True,
List the first 3 channels created by 'michael.neo' that have been archived.,"MATCH (u:User {name: 'michael.neo'})-[:CREATED]->(c:Channel {is_archived: true})
RETURN c
ORDER BY c.createdAt
LIMIT 3",Simple Retrieval Queries,slack,False,False,False,
Which channels have a topic that includes the word 'Graph'?,"MATCH (c:Channel)
WHERE c.topic CONTAINS 'Graph'
RETURN c.name, c.topic",Simple Retrieval Queries,slack,False,False,False,
What are the top 5 most mentioned users in messages across all channels?,"MATCH (m:Message)-[:MENTIONS_USER]->(u:User)
RETURN u.name AS UserName, count(m) AS Mentions
ORDER BY Mentions DESC
LIMIT 5",Simple Retrieval Queries,slack,False,False,True,
Identify the 3 most recent messages that have a 'channel_join' subtype in the 'neo4j-graphql' channel.,"MATCH (m:Message)-[:IN_CHANNEL]->(c:Channel {name: 'neo4j-graphql'})
WHERE m.subtype = 'channel_join'
RETURN m
ORDER BY m.createdAt DESC
LIMIT 3",Simple Retrieval Queries,slack,False,False,False,
Which Deleted users have posted messages in channels that are currently archived?,"MATCH (d:Deleted)-[:POSTED]->(m:Message)-[:IN_CHANNEL]->(c:Channel {is_archived: true})
RETURN d.name, c.name",Simple Retrieval Queries,slack,False,False,True,
List the last names of all Admins who have edited messages in the 'neo4j-python' channel.,"MATCH (a:Admin)-[:EDITED]->(m:Message)-[:IN_CHANNEL]->(c:Channel {name: 'neo4j-python'})
RETURN DISTINCT a.last_name AS LastName",Simple Retrieval Queries,slack,False,False,False,
What are the first names of the 3 PrimaryOwners who have created channels?,"MATCH (p:PrimaryOwner)-[:CREATED]->(:Channel)
RETURN p.first_name
LIMIT 3",Simple Retrieval Queries,slack,False,False,False,
Which users have reacted to messages with the ':python:' emoji?,"MATCH (u:User)-[:REACTED]->(r:Reaction)-[:REACTION_TYPE]->(e:Emoji {name: ':python:'})
RETURN DISTINCT u",Simple Retrieval Queries,slack,False,False,True,
What are the top 3 channels by the number of messages posted in them?,"MATCH (c:Channel)<-[:IN_CHANNEL]-(m:Message)
RETURN c.name, count(m) AS message_count
ORDER BY message_count DESC
LIMIT 3",Simple Retrieval Queries,slack,False,False,True,
List the names and titles of 5 Deleted users.,"MATCH (d:Deleted)
RETURN d.name AS Name, d.title AS Title
LIMIT 5",Simple Retrieval Queries,slack,False,False,True,
Which channels have a topic related to 'Python' and were created by 'michael.neo'?,"MATCH (u:User {name: 'michael.neo'})-[:CREATED]->(c:Channel)
WHERE c.topic CONTAINS 'Python'
RETURN c",Simple Retrieval Queries,slack,False,False,True,
Identify 3 channels where the most recent message was edited.,"MATCH (c:Channel)<-[:IN_CHANNEL]-(m:Message)
WHERE EXISTS {
    (m)-[:EDITED]->()
}
WITH c, m
ORDER BY m.createdAt DESC
RETURN c.name AS ChannelName, m.text AS MessageText, m.createdAt AS MessageCreatedAt
LIMIT 3",Simple Retrieval Queries,slack,False,False,True,
Which users have a custom image and are part of the team 'T08J10GA2'?,"MATCH (u:User)
WHERE u.is_custom_image = true AND u.team = 'T08J10GA2'
RETURN u",Simple Retrieval Queries,slack,False,False,True,
What are the titles of the last 5 threaded messages posted in the 'neo4j-graphql' channel?,"MATCH (c:Channel {name: 'neo4j-graphql'})<-[:IN_CHANNEL]-(tm:ThreadedMessage)
RETURN tm.title
ORDER BY tm.createdAt DESC
LIMIT 5",Simple Retrieval Queries,slack,False,False,False,ThreadedMessage.title
List the names of 3 bots that are members of any channel.,"MATCH (b:Bot)-[:MEMBER_OF]->(:Channel)
RETURN b.name
LIMIT 3",Simple Retrieval Queries,slack,False,False,True,
Which Admins have posted messages with attachments in the past month?,"MATCH (a:Admin)-[:POSTED]->(m:Message)-[:HAS_ATTACHMENT]->(att:Attachment)
WHERE m.createdAt >= date() - duration({months: 1})
RETURN a, m, att",Simple Retrieval Queries,slack,False,False,True,
List all channels where 'michael.neo' is a member and the channel is archived.,"MATCH (u:User {name: 'michael.neo'})-[:MEMBER_OF]->(c:Channel {is_archived: true})
RETURN c",Simple Retrieval Queries,slack,False,False,True,
List all the primary owners who are in the timezone 'Europe/Amsterdam'.,"MATCH (po:PrimaryOwner)-[:IN_TIMEZONE]->(tz:TimeZone {id: 'Europe/Amsterdam'})
RETURN po",Complex Retrieval Queries,slack,False,False,False,
Which bots have a custom image and are members of any channel?,"MATCH (b:Bot)-[:MEMBER_OF]->(:Channel)
WHERE b.is_custom_image = true
RETURN b",Complex Retrieval Queries,slack,False,False,True,
What are the names of the top 3 channels with the highest pagerank?,"MATCH (c:Channel)
RETURN c.name AS ChannelName, c.pagerank AS PageRank
ORDER BY c.pagerank DESC
LIMIT 3",Simple Retrieval Queries,slack,False,False,True,
Find all users who reacted with the emoji 'simple_smile' to any message.,"MATCH (u:User)-[:REACTED]->(r:Reaction)-[:REACTION_TYPE]->(e:Emoji {name: 'simple_smile'})
RETURN u",Complex Retrieval Queries,slack,False,False,True,
Which admin has the skype id 'technige'?,"MATCH (a:Admin {skype: 'technige'})
RETURN a",Simple Aggregation Queries,slack,False,False,True,
List all users who have the status emoji ':python:'.,"MATCH (u:User)
WHERE u.status_emoji = ':python:'
RETURN u",Simple Aggregation Queries,slack,False,False,True,
Which channels have the topic related to 'Neo4j GraphQL integration'?,"MATCH (c:Channel)
WHERE c.topic CONTAINS 'Neo4j GraphQL integration'
RETURN c",Simple Aggregation Queries,slack,False,False,True,
What is the display name of the bot with the first name 'Google'?,"MATCH (b:Bot {first_name: 'Google'})
RETURN b.display_name AS DisplayName",Simple Aggregation Queries,slack,False,False,True,
Which user has the highest number of edits across all messages?,"MATCH (u:User)-[e:EDITED]->(m:Message)
RETURN u, count(e) AS edits
ORDER BY edits DESC
LIMIT 1",Simple Aggregation Queries,slack,False,False,True,
What are the names of the top 3 channels by number of messages posted?,"MATCH (c:Channel)<-[:IN_CHANNEL]-(m:Message)
RETURN c.name AS ChannelName, count(m) AS MessagesCount
ORDER BY MessagesCount DESC
LIMIT 3",Simple Aggregation Queries,slack,False,False,False,
Who reacted to the message with the text '<@U08J18KHB> has joined the channel'?,"MATCH (m:Message {text: '<@U08J18KHB> has joined the channel'})<-[:TO_MESSAGE]-(r:Reaction)
MATCH (u:User)-[:REACTED]->(r)
RETURN u.name AS UserName",Simple Aggregation Queries,slack,False,False,False,
List all emojis used in reactions to messages from the channel 'help-import'.,"MATCH (c:Channel {name: 'help-import'})<-[:IN_CHANNEL]-(m:Message)
MATCH (r:Reaction)-[:TO_MESSAGE]->(m)
MATCH (e:Emoji)<-[:REACTION_TYPE]-(r)
RETURN DISTINCT e.name",Simple Aggregation Queries,slack,False,False,True,
What is the title of the deleted user with the skype id 'tvpind'?,"MATCH (d:Deleted {skype: 'tvpind'})
RETURN d.title AS Title",Simple Aggregation Queries,slack,False,False,True,
Show channels where the latest message was posted before 2020.,"MATCH (m:Message)-[:IN_CHANNEL]->(c:Channel)
WHERE m.createdAt < datetime('2020-01-01T00:00:00Z')
WITH c, max(m.createdAt) AS LatestMessageTime
RETURN c",Simple Aggregation Queries,slack,False,False,True,
Which channels have attachments in their messages?,"MATCH (c:Channel)-[:IN_CHANNEL]-(m:Message)-[:HAS_ATTACHMENT]->(a:Attachment)
RETURN DISTINCT c.name AS ChannelName",Simple Aggregation Queries,slack,False,False,False,
What is the purpose of the channel 'help-import'?,"MATCH (c:Channel {name: 'help-import'})
RETURN c.purpose AS Purpose",Simple Aggregation Queries,slack,False,False,True,
List all the custom images used by app users.,"MATCH (a:AppUser)
WHERE a.is_custom_image = true AND a.image_original IS NOT NULL
RETURN a.image_original AS CustomImage",Simple Aggregation Queries,slack,False,False,False,
Which deleted users have posted messages in 2017?,"MATCH (u:Deleted)-[:POSTED]->(m:Message)
WHERE m.createdAt >= datetime('2017-01-01T00:00:00Z') AND m.createdAt < datetime('2018-01-01T00:00:00Z')
RETURN u",Simple Aggregation Queries,slack,False,False,False,
Display the first names of all owners in the timezone 'Europe/Amsterdam'.,"MATCH (o:Owner)-[:IN_TIMEZONE]->(tz:TimeZone {id: 'Europe/Amsterdam'})
RETURN o.first_name AS FirstName",Simple Aggregation Queries,slack,False,False,True,
What are the names of the bots that have posted messages to the channel 'neo4j-graphql'?,"MATCH (b:Bot)-[:POSTED]->(m:Message)-[:IN_CHANNEL]->(c:Channel {name: 'neo4j-graphql'})
RETURN DISTINCT b.name AS BotNames",Simple Aggregation Queries,slack,False,False,True,
Which users have edited messages in the channel 'organize-meetups'?,"MATCH (u:User)-[:EDITED]->(m:Message)-[:IN_CHANNEL]->(c:Channel {name: 'organize-meetups'})
RETURN DISTINCT u",Simple Aggregation Queries,slack,False,False,False,
Can you list all reactions made by the admin named 'michael.neo'?,"MATCH (a:Admin {name: 'michael.neo'})-[:REACTED]->(r:Reaction)
RETURN r",Simple Aggregation Queries,slack,False,False,True,
What are the thumb widths of attachments in the channel 'neo4j-graphql'?,"MATCH (c:Channel {name: 'neo4j-graphql'})<-[:IN_CHANNEL]-(m:Message)-[:HAS_ATTACHMENT]->(a:Attachment)
RETURN a.thumb_width",Simple Aggregation Queries,slack,False,False,True,
Show all messages that mention the user with the name 'michael.neo'.,"MATCH (m:Message)-[:MENTIONS_USER]->(u:User {name: 'michael.neo'})
RETURN m",Simple Aggregation Queries,slack,False,False,True,
What are the titles of the threaded messages in the channel 'neo4j-graphql'?,"MATCH (c:Channel {name: 'neo4j-graphql'})<-[:IN_CHANNEL]-(tm:ThreadedMessage)
RETURN tm.title AS ThreadedMessageTitle",Simple Aggregation Queries,slack,False,False,True,ThreadedMessage.title
Which users are in the timezone labeled 'Central European Time'?,"MATCH (u:User)-[:IN_TIMEZONE]->(tz:TimeZone {label: 'Central European Time'})
RETURN u",Simple Aggregation Queries,slack,False,False,True,
What titles do the bots have who are members of the channel with the ID 'C08J10PT2'?,"MATCH (b:Bot)-[:MEMBER_OF]->(c:Channel {id: 'C08J10PT2'})
RETURN b.title AS BotTitle",Complex Retrieval Queries,slack,False,False,True,
List all channels where the most recent message was edited by an admin.,"MATCH (c:Channel)<-[:IN_CHANNEL]-(m:Message)
WHERE EXISTS {
  MATCH (m)<-[:EDITED]-(a:Admin)
}
WITH c, max(m.createdAt) AS LatestMessageTime
MATCH (m2:Message {createdAt: LatestMessageTime})<-[:EDITED]-(a:Admin)
WHERE (m2)<-[:IN_CHANNEL]-(c)
RETURN c",Simple Aggregation Queries,slack,False,False,True,
Show the top 5 users by number of messages they have posted.,"MATCH (u:User)-[:POSTED]->(m:Message)
RETURN u, count(m) AS messages_posted
ORDER BY messages_posted DESC
LIMIT 5",Simple Aggregation Queries,slack,False,False,True,
What are the page ranks of all channels where Michael Hunger is an admin?,"MATCH (a:Admin {real_name: ""Michael Hunger""})-[:MEMBER_OF]->(c:Channel)
RETURN c.name, c.pagerank",Simple Aggregation Queries,slack,False,False,False,
List the reactions made to the message with id '1507313352.000514'.,"MATCH (r:Reaction)-[:TO_MESSAGE]->(m:Message {id: '1507313352.000514'})
RETURN r",Simple Aggregation Queries,slack,False,False,True,
Which bots have a color of '3c8c69'?,"MATCH (b:Bot {color: '3c8c69'})
RETURN b",Simple Aggregation Queries,slack,False,False,False,
What are the topics of channels where the primary owner's name is 'michael.neo'?,"MATCH (po:PrimaryOwner {name: 'michael.neo'})-[:CREATED]->(c:Channel)
RETURN c.topic AS Topic",Simple Aggregation Queries,slack,False,False,False,
List all attachments with a thumb height greater than 3000.,"MATCH (a:Attachment)
WHERE a.thumb_height > 3000
RETURN a",Simple Aggregation Queries,slack,False,False,True,
Show the status texts of admins with the color '9f69e7'.,"MATCH (a:Admin {color: '9f69e7'})
RETURN a.status_text AS StatusText",Simple Aggregation Queries,slack,False,False,False,
Who is the owner with the last name 'Needham'?,"MATCH (o:Owner {last_name: 'Needham'})
RETURN o",Simple Aggregation Queries,slack,False,False,True,
List the names of all users who have custom images.,"MATCH (u:User)
WHERE u.is_custom_image = true
RETURN u.name",Simple Aggregation Queries,slack,False,False,True,
What are the names of channels created by the user with the team id 'T08J10GA2'?,"MATCH (u:User {team: 'T08J10GA2'})-[:CREATED]->(c:Channel)
RETURN c.name AS ChannelName",Simple Aggregation Queries,slack,False,False,True,
Show the profile pictures (image_512) of all admins.,"MATCH (a:Admin)
RETURN a.image_512 AS ProfilePicture",Simple Aggregation Queries,slack,False,False,True,
What is the real name of the bot that posted a message in the channel 'neo4j-graphql'?,"MATCH (b:Bot)-[:POSTED]->(m:Message)-[:IN_CHANNEL]->(c:Channel {name: 'neo4j-graphql'})
RETURN b.real_name AS BotRealName",Simple Aggregation Queries,slack,False,False,True,
Show all channels that have been archived.,"MATCH (c:Channel)
WHERE c.is_archived = true
RETURN c",Simple Aggregation Queries,slack,False,False,True,
Which messages have reactions of type 'simple_smile'?,"MATCH (m:Message)-[:HAS_REACTION]->(r:Reaction)-[:REACTION_TYPE]->(e:Emoji {name: 'simple_smile'})
RETURN m",Simple Aggregation Queries,slack,False,False,True,HAS_REACTION
Who are the users mentioned in the threaded message with id '1581274875.020900'?,"MATCH (tm:ThreadedMessage {id: '1581274875.020900'})-[:MENTIONS_USER]->(u:User)
RETURN u",Simple Aggregation Queries,slack,False,False,True,
What are the names of the channels where the primary owner has the display name 'michael.neo'?,"MATCH (po:PrimaryOwner {display_name: 'michael.neo'})-[:CREATED]->(c:Channel)
RETURN c.name",Simple Aggregation Queries,slack,False,False,True,
List all the statuses that expire in 2020.,"MATCH (n)
WHERE n.status_expiration >= datetime('2020-01-01T00:00:00Z').epochMillis AND n.status_expiration < datetime('2021-01-01T00:00:00Z').epochMillis
RETURN n",Simple Aggregation Queries,slack,False,False,False,
Who are the primary owners of the channels created before 2016?,"MATCH (po:PrimaryOwner)-[:CREATED]->(c:Channel)
WHERE c.createdAt < datetime('2016-01-01T00:00:00Z')
RETURN po",Simple Aggregation Queries,slack,False,False,True,
What is the creation date of the channel called 'neo4j-graphql'?,"MATCH (c:Channel {name: 'neo4j-graphql'})
RETURN c.createdAt AS CreationDate",Simple Aggregation Queries,slack,False,False,True,
Show the images (image_24) of users who have edited the most recent message in the 'help-import' channel.,"MATCH (u:User)-[:EDITED]->(m:Message)-[:IN_CHANNEL]->(c:Channel {name: 'help-import'})
WITH m, u
ORDER BY m.createdAt DESC
LIMIT 1
RETURN u.image_24 AS UserImage",Simple Aggregation Queries,slack,False,False,True,
Show the top 5 channels with the highest pagerank.,"MATCH (c:Channel)
RETURN c.name, c.pagerank
ORDER BY c.pagerank DESC
LIMIT 5",Simple Aggregation Queries,slack,False,False,False,
What are the topics of channels where the last message was posted before 2018?,"MATCH (m:Message)-[:IN_CHANNEL]->(c:Channel)
WHERE m.createdAt < datetime('2018-01-01T00:00:00Z')
RETURN DISTINCT c.topic AS ChannelTopic",Complex Retrieval Queries,slack,False,False,True,
List all the messages that have been posted by bots.,"MATCH (b:Bot)-[:POSTED]->(m:Message)
RETURN m",Complex Retrieval Queries,slack,False,False,True,
Which users are in the timezone 'Europe/Amsterdam' and have posted more than 5 messages?,"MATCH (u:User)-[:IN_TIMEZONE]->(tz:TimeZone {id: 'Europe/Amsterdam'})
WHERE exists {
  (u)-[:POSTED]->(m:Message)
}
WITH u, count{(u)-[:POSTED]->(m:Message)} AS messageCount
WHERE messageCount > 5
RETURN u",Complex Retrieval Queries,slack,False,False,True,
What are the display names of users who have the color '9f69e7'?,"MATCH (u:User {color: '9f69e7'})
RETURN u.display_name AS DisplayName",Complex Retrieval Queries,slack,False,False,True,
Find all channels where the primary owner has the title 'Caretaker General Community Neo4j'.,"MATCH (po:PrimaryOwner {title: 'Caretaker General Community Neo4j'})-[:CREATED]->(c:Channel)
RETURN c",Complex Retrieval Queries,slack,False,False,True,
List the first 5 messages that have been edited after their original posting date.,"MATCH (m:Message)-[e:EDITED]->()
WHERE e.editedAt > datetime(m.createdAt).epochMillis
RETURN m
ORDER BY m.createdAt
LIMIT 5",Complex Retrieval Queries,slack,False,False,True,
Which channels have messages that include attachments with a title_link containing 'neo4j.com'?,"MATCH (c:Channel)-[:IN_CHANNEL]-(m:Message)-[:HAS_ATTACHMENT]->(a:Attachment)
WHERE a.title_link CONTAINS 'neo4j.com'
RETURN DISTINCT c",Complex Retrieval Queries,slack,False,False,True,
What is the status text of the user with the highest pagerank in their channel?,"MATCH (u:User)-[:MEMBER_OF]->(c:Channel)
WITH u, c, c.pagerank AS pr
ORDER BY pr DESC
LIMIT 1
RETURN u.status_text AS StatusText",Complex Retrieval Queries,slack,False,False,True,
Who are the owners of the channel named 'neo4j-graphql'?,"MATCH (o:Owner)-[:CREATED]->(c:Channel {name: 'neo4j-graphql'})
RETURN o",Complex Retrieval Queries,slack,False,False,True,
List all the reactions made to messages in the channel with the ID 'C08J10PT2'.,"MATCH (c:Channel {id: 'C08J10PT2'})<-[:IN_CHANNEL]-(m:Message)
MATCH (r:Reaction)-[:TO_MESSAGE]->(m)
RETURN r",Complex Retrieval Queries,slack,False,False,True,
Who is the user with the skype ID 'technige'?,"MATCH (u:User {skype: 'technige'})
RETURN u",Complex Retrieval Queries,slack,False,False,True,
List the top 3 channels by the number of messages posted in them.,"MATCH (c:Channel)<-[:IN_CHANNEL]-(m:Message)
RETURN c.name, count(m) AS message_count
ORDER BY message_count DESC
LIMIT 3",Complex Retrieval Queries,slack,False,False,True,
What is the text of the last message posted in the channel named 'introduce-yourself'?,"MATCH (m:Message)-[:IN_CHANNEL]->(c:Channel {name: 'introduce-yourself'})
RETURN m.text AS LastMessageText
ORDER BY m.createdAt DESC
LIMIT 1",Complex Retrieval Queries,slack,False,False,True,
Find all messages edited by the admin named 'Michael Hunger'.,"MATCH (a:Admin {real_name: 'Michael Hunger'})-[:EDITED]->(m:Message)
RETURN m",Complex Retrieval Queries,slack,False,False,False,
What are the names of channels that have a topic containing 'Neo4j'?,"MATCH (c:Channel)
WHERE c.topic CONTAINS 'Neo4j'
RETURN c.name",Complex Retrieval Queries,slack,False,False,True,
List all channels that have been mentioned in messages posted by 'Michael Hunger'.,"MATCH (u:User {real_name: 'Michael Hunger'})-[:POSTED]->(m:Message)-[:MENTIONS_CHANNEL]->(c:Channel)
RETURN DISTINCT c",Complex Retrieval Queries,slack,False,False,False,
What are the names of the users who are members of the channel named 'help-import'?,"MATCH (u:User)-[:MEMBER_OF]->(c:Channel {name: 'help-import'})
RETURN u.name",Simple Aggregation Queries,slack,False,False,True,
Which users have an image_512 URL containing 'avatars.slack-edge'?,"MATCH (u:User)
WHERE u.image_512 CONTAINS 'avatars.slack-edge'
RETURN u",Complex Retrieval Queries,slack,False,False,True,
Which channels have a general purpose and are created by an admin?,"MATCH (a:Admin)-[:CREATED]->(c:Channel)
WHERE c.is_general = true
RETURN c.name, c.id, c.createdAt",Complex Retrieval Queries,slack,False,False,True,
Find all threaded messages that reply to the message with ID '1507313352.000514'.,"MATCH (tm:ThreadedMessage)-[:IN_REPLY_TO]->(m:Message {id: '1507313352.000514'})
RETURN tm",Complex Retrieval Queries,slack,False,False,True,
Who are the users with the display name normalized as 'michael.neo' and are members of a channel?,"MATCH (u:User {display_name_normalized: 'michael.neo'})-[:MEMBER_OF]->(c:Channel)
RETURN u, c",Complex Retrieval Queries,slack,False,False,False,
List the names of all emojis that have been used in reactions to messages by 'Michael Hunger'.,"MATCH (u:User {real_name: 'Michael Hunger'})-[:POSTED]->(m:Message)
MATCH (r:Reaction)-[:TO_MESSAGE]->(m)
MATCH (e:Emoji)<-[:REACTION_TYPE]-(r)
RETURN DISTINCT e.name",Complex Retrieval Queries,slack,False,False,False,
What is the maximum thumb_height found in attachments of messages within any channel?,"MATCH (m:Message)-[:HAS_ATTACHMENT]->(a:Attachment)
RETURN MAX(a.thumb_height) AS max_thumb_height",Complex Retrieval Queries,slack,False,False,True,
Find all users who have posted a message in the channel with the ID 'C08J10PT2' and have a status emoji ':python:'.,"MATCH (u:User)-[:POSTED]->(m:Message)-[:IN_CHANNEL]->(c:Channel {id: 'C08J10PT2'})
WHERE u.status_emoji = ':python:'
RETURN DISTINCT u",Complex Retrieval Queries,slack,False,False,True,
List all messages posted by the user named 'lee.freeman'.,"MATCH (u:User {name: 'lee.freeman'})-[:POSTED]->(m:Message)
RETURN m",Simple Aggregation Queries,slack,False,False,True,
List the real names of all bots in the channel named 'random'.,"MATCH (b:Bot)-[:MEMBER_OF]->(c:Channel {name: 'random'})
RETURN b.real_name AS BotRealName",Complex Retrieval Queries,slack,False,False,True,
Which messages have attachments with a thumb_url that includes 'neo4j' in the domain?,"MATCH (m:Message)-[:HAS_ATTACHMENT]->(a:Attachment)
WHERE a.thumb_url CONTAINS 'neo4j'
RETURN m, a",Complex Retrieval Queries,slack,False,False,False,
Find all users who have a skype ID listed and are members of a channel.,"MATCH (u:User)-[:MEMBER_OF]->(:Channel)
WHERE u.skype IS NOT NULL
RETURN u",Complex Retrieval Queries,slack,False,False,True,
What are the names of all channels that have been archived and were created by an admin?,"MATCH (a:Admin)-[:CREATED]->(c:Channel)
WHERE c.is_archived = true
RETURN c.name",Complex Retrieval Queries,slack,False,False,False,
List the channels where the primary owner's display name is 'michael.neo'.,"MATCH (po:PrimaryOwner {display_name: 'michael.neo'})-[:CREATED]->(c:Channel)
RETURN c",Complex Retrieval Queries,slack,False,False,False,
Which messages have a reaction of type 'simple_smile' and were posted in 2015?,"MATCH (m:Message)-[:REACTION_TYPE]->(e:Emoji {name: 'simple_smile'})
WHERE m.createdAt.year = 2015
RETURN m",Complex Retrieval Queries,slack,False,False,True,
Who are the primary owners with the status emoji ':palm_tree:'?,"MATCH (po:PrimaryOwner {status_emoji: ':palm_tree:'})
RETURN po",Complex Retrieval Queries,slack,False,False,True,PrimaryOwner.status_emoji
What is the color of the bot named 'archivebot'?,"MATCH (b:Bot {name: 'archivebot'})
RETURN b.color AS Color",Complex Retrieval Queries,slack,False,False,True,
Which users have a status expiration of 0 and are members of the channel with the ID 'C08LLJF16'?,"MATCH (u:User)-[:MEMBER_OF]->(c:Channel {id: 'C08LLJF16'})
WHERE u.status_expiration = 0
RETURN u",Complex Retrieval Queries,slack,False,False,True,
Find all users who have the title 'Caretaker General Community Neo4j' and have edited a message.,"MATCH (u:User {title: 'Caretaker General Community Neo4j'})-[:EDITED]->(m:Message)
RETURN u, m",Complex Retrieval Queries,slack,False,False,True,
Find all messages that include a mention of the channel with the ID 'C08J10PT2'.,"MATCH (m:Message)-[:MENTIONS_CHANNEL]->(c:Channel {id: 'C08J10PT2'})
RETURN m",Complex Retrieval Queries,slack,False,False,True,
Which channels have more than one primary owner?,"MATCH (p:PrimaryOwner)-[:CREATED]->(c:Channel)
WITH c, count(p) AS numOwners
WHERE numOwners > 1
RETURN c.name AS ChannelName, numOwners",Complex Retrieval Queries,slack,False,False,True,
Which channels were created by the user with the display name 'michael.neo'?,"MATCH (u:User {display_name: 'michael.neo'})-[:CREATED]->(c:Channel)
RETURN c",Simple Aggregation Queries,slack,False,False,True,
What are the first names of admins who are members of the channel with the ID 'C08J10PT2'?,"MATCH (a:Admin)-[:MEMBER_OF]->(c:Channel {id: 'C08J10PT2'})
RETURN a.first_name AS FirstName",Complex Retrieval Queries,slack,False,False,True,
Which bots have posted messages containing the word 'Google'?,"MATCH (b:Bot)-[:POSTED]->(m:Message)
WHERE m.text CONTAINS 'Google'
RETURN b",Complex Retrieval Queries,slack,False,False,True,
List the titles of all deleted users who have posted messages.,"MATCH (d:Deleted)-[:POSTED]->(m:Message)
RETURN DISTINCT d.title AS Title",Complex Retrieval Queries,slack,False,False,False,
List all the channels created by users with the last name 'Hunger'.,"MATCH (u:User {last_name: 'Hunger'})-[:CREATED]->(c:Channel)
RETURN c",Complex Retrieval Queries,slack,False,False,True,
Which questions have been commented on by the user with the display name 'DoubleMiP'? Limit to the top 3.,"MATCH (u:User {display_name: 'DoubleMiP'})-[:COMMENTED]->(c:Comment)-[:COMMENTED_ON]->(q:Question)
RETURN q
LIMIT 3",Pathfinding Queries,stackoverflow2,False,False,True,
List the top 3 users by the number of questions they have asked.,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN u.display_name, count(q) AS questions_asked
ORDER BY questions_asked DESC
LIMIT 3",Complex Aggregation Queries,stackoverflow2,False,False,True,
Which questions have been tagged with 'neo4j'?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'neo4j'})
RETURN q",Complex Aggregation Queries,stackoverflow2,False,False,True,
What are the titles of the top 5 questions with the highest view count?,"MATCH (q:Question)
RETURN q.title
ORDER BY q.view_count DESC
LIMIT 5",Complex Aggregation Queries,stackoverflow2,False,False,True,
What are the first 3 questions that have a view count between 50 and 100?,"MATCH (q:Question)
WHERE q.view_count >= 50 AND q.view_count <= 100
RETURN q
ORDER BY q.creation_date ASC
LIMIT 3",Pathfinding Queries,stackoverflow2,False,False,True,
List the top 3 tags that have been used the most in questions.,"MATCH (t:Tag)<-[:TAGGED]-(q:Question)
RETURN t.name, count(q) AS usage_count
ORDER BY usage_count DESC
LIMIT 3",Pathfinding Queries,stackoverflow2,True,False,False,
Who provided the answer with the link 'https://stackoverflow.com/a/69272967'?,"MATCH (u:User)-[:PROVIDED]->(a:Answer {link: 'https://stackoverflow.com/a/69272967'})
RETURN u.display_name AS user_who_provided_answer",Pathfinding Queries,stackoverflow2,False,False,True,
Find the first 3 users who have commented on questions with more than 100 views.,"MATCH (u:User)-[:COMMENTED]->(c:Comment)-[:COMMENTED_ON]->(q:Question)
WHERE q.view_count > 100
RETURN u
LIMIT 3",Pathfinding Queries,stackoverflow2,False,False,True,
Which questions have been answered by the user with the uuid 16922964? Limit to the top 3 questions.,"MATCH (u:User {uuid: 16922964})-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q:Question)
RETURN q
ORDER BY q.creation_date DESC
LIMIT 3",Pathfinding Queries,stackoverflow2,False,False,True,
Find the first 3 questions that have more than 2 answers.,"MATCH (q:Question)
WHERE q.answer_count > 2
RETURN q
ORDER BY q.creation_date
LIMIT 3",Pathfinding Queries,stackoverflow2,False,False,True,
Which users have provided answers to the question with the title 'even after null check why I am getting null value in neo4j?' Limit to the top 3.,"MATCH (u:User)-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q:Question {title: 'even after null check why I am getting null value in neo4j?'})
RETURN u
LIMIT 3",Pathfinding Queries,stackoverflow2,False,False,True,
List the first 3 questions that were asked before the year 2021.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.creation_date < 1609459200
RETURN q
ORDER BY q.creation_date ASC
LIMIT 3",Pathfinding Queries,stackoverflow2,False,False,True,
Who are the top 3 users by the number of questions they have asked?,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN u.display_name AS User, count(q) AS Questions_Asked
ORDER BY Questions_Asked DESC
LIMIT 3",Pathfinding Queries,stackoverflow2,False,False,False,
What are the top 5 most recent questions asked in the system?,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN q
ORDER BY q.creation_date DESC
LIMIT 5",Pathfinding Queries,stackoverflow2,False,False,True,
Who commented on the question titled 'Neo4j- APOC trigger fires without any reason'?,"MATCH (u:User)-[:COMMENTED]->(c:Comment)-[:COMMENTED_ON]->(q:Question)
WHERE q.title = 'Neo4j- APOC trigger fires without any reason'
RETURN u.display_name",Complex Aggregation Queries,stackoverflow2,False,False,True,
List the titles of the top 3 questions with the longest body markdown text.,"MATCH (q:Question)
RETURN q.title
ORDER BY length(q.body_markdown) DESC
LIMIT 3",Pathfinding Queries,stackoverflow2,False,False,True,
What are the top 5 questions with the lowest view count?,"MATCH (q:Question)
RETURN q
ORDER BY q.view_count ASC
LIMIT 5",Pathfinding Queries,stackoverflow2,True,False,False,
Which user has the highest average score on their provided answers?,"MATCH (u:User)-[:PROVIDED]->(a:Answer)
WITH u, avg(a.score) AS avgScore
ORDER BY avgScore DESC
LIMIT 1
RETURN u.display_name AS UserWithHighestAvgScore, avgScore",Complex Aggregation Queries,stackoverflow2,False,False,True,
Which user provided the answer to the question titled 'Create graph from recursive JSON data using apoc.load.json and use UNWIND and FOREACH for setting property'?,"MATCH (u:User)-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q:Question {title: 'Create graph from recursive JSON data using apoc.load.json and use UNWIND and FOREACH for setting property'})
RETURN u.display_name AS UserName",Complex Aggregation Queries,stackoverflow2,False,False,True,
Which users have asked more than 2 questions? Display the first 5.,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u, count(q) AS questions_count
WHERE questions_count > 2
RETURN u
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
List the top 3 comments with a score of 3.,"MATCH (c:Comment)
WHERE c.score = 3
RETURN c
ORDER BY c.uuid DESC
LIMIT 3",Pathfinding Queries,stackoverflow2,False,False,True,
List the top 3 most viewed questions tagged with 'neo4j'.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'neo4j'})
RETURN q.title, q.link, q.view_count
ORDER BY q.view_count DESC
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
List the UUIDs of all comments made on the question titled 'Specify a certain column as id values in Neo4j Spark connector'.,"MATCH (q:Question {title: 'Specify a certain column as id values in Neo4j Spark connector'})
MATCH (c:Comment)-[:COMMENTED_ON]->(q)
RETURN c.uuid",Complex Aggregation Queries,stackoverflow2,False,False,True,
Who has provided the most comments across all questions?,"MATCH (u:User)-[:COMMENTED]->(c:Comment)
RETURN u.display_name AS user, count(c) AS comments_count
ORDER BY comments_count DESC
LIMIT 1",Complex Aggregation Queries,stackoverflow2,False,False,True,
Display the creation dates of the top 3 questions with the most comments.,"MATCH (q:Question)
WITH q, count{(q)<-[:COMMENTED_ON]-(:Comment)} AS commentCount
ORDER BY commentCount DESC
LIMIT 3
RETURN q.creation_date AS CreationDate",Complex Aggregation Queries,stackoverflow2,False,False,True,
List all unique tags used in the dataset.,"MATCH (t:Tag)
RETURN DISTINCT t.name;",Complex Aggregation Queries,stackoverflow2,False,False,False,
What are the UUIDs of the answers that are marked as accepted?,"MATCH (:Answer {is_accepted: true})
RETURN uuid",Complex Aggregation Queries,stackoverflow2,False,False,True,
Which tags are linked to the most viewed questions?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
RETURN t.name AS Tag, max(q.view_count) AS MaxViewCount
ORDER BY MaxViewCount DESC",Complex Aggregation Queries,stackoverflow2,True,False,False,
List the top 3 most viewed questions that have no answers.,"MATCH (q:Question)
WHERE q.answer_count = 0
RETURN q
ORDER BY q.view_count DESC
LIMIT 3",Complex Aggregation Queries,stackoverflow2,False,False,True,
What are the body markdowns of the top 3 highest scoring answers?,"MATCH (a:Answer)-[:ANSWERED]->(:Question)
RETURN a.body_markdown
ORDER BY a.score DESC
LIMIT 3",Complex Aggregation Queries,stackoverflow2,False,False,False,
How many users have commented on the question with the title 'Neo4j- APOC trigger fires without any reason'?,"MATCH (q:Question {title: 'Neo4j- APOC trigger fires without any reason'})
MATCH (u:User)-[:COMMENTED]->(:Comment)-[:COMMENTED_ON]->(q)
RETURN count(DISTINCT u) AS NumberOfCommentingUsers",Complex Aggregation Queries,stackoverflow2,False,False,True,
List the questions asked in 2021 along with their view counts.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.creation_date >= 1609459200 AND q.creation_date <= 1640995199
RETURN q.title, q.view_count",Complex Aggregation Queries,stackoverflow2,False,False,True,
Which questions have more than one answer?,"MATCH (q:Question)
WHERE q.answer_count > 1
RETURN q",Complex Aggregation Queries,stackoverflow2,False,False,True,
What are the top 3 most commented on questions?,"MATCH (q:Question)
WITH q, count{(q)<-[:COMMENTED_ON]-(:Comment)} AS commentsCount
ORDER BY commentsCount DESC
LIMIT 3
RETURN q.title, q.link, commentsCount",Complex Aggregation Queries,stackoverflow2,False,False,True,
Can you list all tags associated with questions asked by the user 'Anu'?,"MATCH (u:User {display_name: 'Anu'})-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
RETURN t",Complex Aggregation Queries,stackoverflow2,True,False,False,
What are the links to the accepted answers for questions asked by 'Mohammed Faraz ali'?,"MATCH (u:User {display_name: 'Mohammed Faraz ali'})-[:ASKED]->(q:Question)
WHERE q.accepted_answer_id IS NOT NULL
MATCH (a:Answer {uuid: q.accepted_answer_id})
RETURN a.link AS AcceptedAnswerLink",Complex Aggregation Queries,stackoverflow2,False,False,True,
Find the top 3 answers with the highest score.,"MATCH (a:Answer)-[:ANSWERED]->(:Question)
RETURN a
ORDER BY a.score DESC
LIMIT 3",Pathfinding Queries,stackoverflow2,False,False,True,
Who provided the most answers to the questions with the most comments?,"MATCH (u:User)-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q:Question)
WITH q, count{(q)<-[:COMMENTED_ON]-(:Comment)} AS commentCount
ORDER BY commentCount DESC
LIMIT 1
WITH q
MATCH (u:User)-[:PROVIDED]->(:Answer)-[:ANSWERED]->(q)
RETURN u.display_name AS user, count(a) AS answersProvided
ORDER BY answersProvided DESC
LIMIT 1",Simple Aggregation Queries,stackoverflow2,False,False,True,
Who asked the question with the title 'Neo.ClientError.Statement.ExternalResourceFailed error on loading CSV file from local'?,"MATCH (u:User)-[:ASKED]->(q:Question {title: 'Neo.ClientError.Statement.ExternalResourceFailed error on loading CSV file from local'})
RETURN u.display_name AS asked_by",Pathfinding Queries,stackoverflow2,False,False,True,
Identify the 3 answers with the lowest scores provided to the most viewed questions.,"MATCH (q:Question)
WITH q
ORDER BY q.view_count DESC
LIMIT 1
MATCH (a:Answer)-[:ANSWERED]->(q)
RETURN a
ORDER BY a.score ASC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
What are the top 5 most tagged questions and their view counts?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WITH q, count(t) AS tags_count
ORDER BY tags_count DESC, q.view_count DESC
RETURN q.title, q.view_count
LIMIT 5",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the 3 users who have asked the questions with the highest view counts.,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN u.display_name AS user, q.view_count AS views
ORDER BY q.view_count DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
What are the top 3 questions with the highest scores of their unaccepted answers?,"MATCH (q:Question)<-[:ANSWERED]-(a:Answer)
WHERE a.is_accepted = false
RETURN q.title AS QuestionTitle, q.link AS QuestionLink, max(a.score) AS HighestUnacceptedAnswerScore
ORDER BY HighestUnacceptedAnswerScore DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the top 5 most recent questions with more than one answer.,"MATCH (q:Question)
WHERE q.answer_count > 1
RETURN q
ORDER BY q.creation_date DESC
LIMIT 5",Simple Aggregation Queries,stackoverflow2,True,False,False,
Who provided answers to the top 3 questions with the most tags?,"MATCH (q:Question)
WITH q, size((q)-[:TAGGED]->(:Tag)) AS tagCount
ORDER BY tagCount DESC
LIMIT 3
MATCH (u:User)-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q)
RETURN u.display_name AS UserName, q.title AS QuestionTitle, q.link AS QuestionLink",Simple Aggregation Queries,stackoverflow2,False,False,False,
List the top 3 most tagged questions without an accepted answer.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.accepted_answer_id IS NULL
RETURN q.title, count(t) AS tag_count
ORDER BY tag_count DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the top 3 questions with the least number of answers but with at least one accepted answer.,"MATCH (q:Question)
WHERE q.answer_count > 0 AND q.accepted_answer_id IS NOT NULL
RETURN q
ORDER BY q.answer_count ASC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
Which 3 questions have the most comments and what are their accepted answer ids?,"MATCH (q:Question)
WITH q, count{(q)<-[:COMMENTED_ON]-(:Comment)} AS commentCount
ORDER BY commentCount DESC
LIMIT 3
RETURN q.title AS QuestionTitle, q.accepted_answer_id AS AcceptedAnswerID, commentCount",Simple Aggregation Queries,stackoverflow2,False,False,True,
What are the top 3 questions with the most views and their titles?,"MATCH (q:Question)
RETURN q.title, q.view_count
ORDER BY q.view_count DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the top 5 questions with the most comments and their associated tags.,"MATCH (q:Question)-[:COMMENTED_ON]-(c:Comment)
WITH q, count(c) AS num_comments
ORDER BY num_comments DESC
LIMIT 5
MATCH (q)-[:TAGGED]->(t:Tag)
RETURN q.title, q.link, num_comments, collect(t.name) AS tags",Simple Aggregation Queries,stackoverflow2,False,False,True,
Who are the top 3 users with the most provided answers that were not accepted?,"MATCH (u:User)-[:PROVIDED]->(a:Answer {is_accepted: false})
WITH u, count(a) AS answersCount
ORDER BY answersCount DESC
LIMIT 3
RETURN u.display_name AS UserName, answersCount",Simple Aggregation Queries,stackoverflow2,False,False,False,
What are the top 3 most tagged questions and their answer counts?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WITH q, count(t) AS tags_count
ORDER BY tags_count DESC
LIMIT 3
RETURN q.title, q.answer_count",Simple Aggregation Queries,stackoverflow2,False,False,True,
"For the top 3 questions with the least views, who are the users that asked them?","MATCH (u:User)-[:ASKED]->(q:Question)
WITH q, u
ORDER BY q.view_count ASC
LIMIT 3
RETURN q, u",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the top 5 users who provided answers to the most viewed questions.,"MATCH (u:User)-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q:Question)
WITH q, count(a) AS answers, q.view_count AS views
ORDER BY views DESC
RETURN u.display_name, answers
LIMIT 5",Simple Aggregation Queries,stackoverflow2,False,False,True,
Find all the questions asked by 'schernichkin' with more than 100 views.,"MATCH (u:User {display_name: 'schernichkin'})-[:ASKED]->(q:Question)
WHERE q.view_count > 100
RETURN q",Verbose query,stackoverflow2,False,False,False,
List the top 3 users who provided the least answers.,"MATCH (u:User)-[:PROVIDED]->(a:Answer)
WITH u, count(a) AS answersCount
ORDER BY answersCount ASC
LIMIT 3
RETURN u.display_name AS UserName, answersCount",Simple Aggregation Queries,stackoverflow2,False,False,True,
What are the top 5 answers that are marked as accepted?,"MATCH (a:Answer {is_accepted: true})
RETURN a
ORDER BY a.score DESC
LIMIT 5",Pathfinding Queries,stackoverflow2,False,False,True,
What are the top 5 most commented-on questions and their titles?,"MATCH (q:Question)
WITH q, count{(q)<-[:COMMENTED_ON]-(:Comment)} AS commentsCount
ORDER BY commentsCount DESC
LIMIT 5
RETURN q.title AS Title, commentsCount AS NumberOfComments",Simple Aggregation Queries,stackoverflow2,False,False,True,
What are the top 3 questions with the most answers and their accepted answer ids?,"MATCH (q:Question)
RETURN q.title, q.accepted_answer_id, q.answer_count
ORDER BY q.answer_count DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the top 3 most viewed questions tagged with 'neo4j'.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'neo4j'})
RETURN q
ORDER BY q.view_count DESC
LIMIT 3",Pathfinding Queries,stackoverflow2,True,False,False,
Which tags are associated with the question titled 'Create graph from recursive JSON data using apoc.load.json'?,"MATCH (q:Question {title: 'Create graph from recursive JSON data using apoc.load.json'})-[:TAGGED]->(t:Tag)
RETURN t.name",Pathfinding Queries,stackoverflow2,True,False,False,
What are the top 5 questions with the highest number of answers?,"MATCH (q:Question)
RETURN q
ORDER BY q.answer_count DESC
LIMIT 5",Pathfinding Queries,stackoverflow2,False,False,True,
Find the top 3 users who have provided the most answers.,"MATCH (u:User)-[:PROVIDED]->(a:Answer)
RETURN u.display_name, count(a) AS answers_provided
ORDER BY answers_provided DESC
LIMIT 3",Pathfinding Queries,stackoverflow2,False,False,True,
Which user has commented the most number of times? Show the top 3 users.,"MATCH (u:User)-[:COMMENTED]->(c:Comment)
WITH u, count(c) AS commentsCount
ORDER BY commentsCount DESC
LIMIT 3
RETURN u.display_name AS UserName, commentsCount",Pathfinding Queries,stackoverflow2,False,False,False,
List the top 5 questions that have an accepted answer.,"MATCH (q:Question)-[:ANSWERED]->(a:Answer {is_accepted: true})
RETURN q
ORDER BY q.view_count DESC
LIMIT 5",Pathfinding Queries,stackoverflow2,False,False,True,
What are the top 3 highest scoring comments made on questions related to the tag 'cypher'?,"MATCH (c:Comment)-[:COMMENTED_ON]->(q:Question)-[:TAGGED]->(t:Tag {name: 'cypher'})
RETURN c.link AS CommentLink, c.score AS CommentScore
ORDER BY c.score DESC
LIMIT 3",Pathfinding Queries,stackoverflow2,False,False,True,
List the 3 most recent answers provided to questions tagged with 'neo4j'.,"MATCH (a:Answer)-[:ANSWERED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'neo4j'})
RETURN a
ORDER BY a.uuid DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
Find the first 3 questions with no answers.,"MATCH (q:Question)
WHERE q.answer_count = 0
RETURN q
LIMIT 3",Pathfinding Queries,stackoverflow2,False,False,True,
Which questions have been tagged with the tag named 'neo4j'? Limit to the top 5 questions.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'neo4j'})
RETURN q
ORDER BY q.creation_date DESC
LIMIT 5",Pathfinding Queries,stackoverflow2,False,False,True,
List the top 5 users who have provided answers to the most commented-on questions.,"MATCH (u:User)-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q:Question)
WHERE exists {
  (c:Comment)-[:COMMENTED_ON]->(q)
}
WITH q, count(c) AS commentsCount, u
ORDER BY commentsCount DESC
RETURN u.display_name, count(DISTINCT q) AS answeredQuestionsCount
ORDER BY answeredQuestionsCount DESC
LIMIT 5",Simple Aggregation Queries,stackoverflow2,False,False,True,
Which questions have the most tags and what are their titles?,"MATCH (q:Question)
WITH q, size((q)-[:TAGGED]->(:Tag)) AS tagCount
ORDER BY tagCount DESC
RETURN q.title AS Title, tagCount AS NumberOfTags
LIMIT 1",Simple Aggregation Queries,stackoverflow2,True,False,False,
List the 3 most recent tags applied to questions with at least one answer.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.answer_count > 0
RETURN t.name, t.link
ORDER BY q.creation_date DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
What are the top 3 most viewed questions and their associated users?,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN q.title, q.view_count, u.display_name
ORDER BY q.view_count DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the top 5 questions with the highest scores and their accepted answer links.,"MATCH (q:Question)-[:ANSWERED]->(a:Answer {is_accepted: true})
RETURN q.title AS QuestionTitle, q.score AS QuestionScore, a.link AS AcceptedAnswerLink
ORDER BY q.score DESC
LIMIT 5",Simple Aggregation Queries,stackoverflow2,False,False,True,Question.score
Who are the top 3 users by the number of questions they have provided answers to?,"MATCH (u:User)-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q:Question)
WITH u, COUNT(DISTINCT q) AS questions_answered
ORDER BY questions_answered DESC
LIMIT 3
RETURN u.display_name AS user, questions_answered",Simple Aggregation Queries,stackoverflow2,False,False,True,
What are the top 3 questions with the highest view count that were asked by the user with the display name 'schernichkin'?,"MATCH (u:User {display_name: 'schernichkin'})-[:ASKED]->(q:Question)
RETURN q
ORDER BY q.view_count DESC
LIMIT 3",Pathfinding Queries,stackoverflow2,False,False,True,
What are the top 5 highest scoring answers in the database?,"MATCH (a:Answer)
RETURN a
ORDER BY a.score DESC
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
List the first 3 questions where the same user has asked and provided an accepted answer.,"MATCH (u:User)-[:ASKED]->(q:Question)<-[:ANSWERED]-(a:Answer {is_accepted: true})
WHERE (u)-[:PROVIDED]->(a)
RETURN q
LIMIT 3",Verbose query,stackoverflow2,False,False,False,
Retrieve the first 5 tags used by questions with accepted answers.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.accepted_answer_id IS NOT NULL
RETURN t.name, count(q) AS usage
ORDER BY usage DESC
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
Retrieve the top 3 questions with the most answers during the year 2020.,"MATCH (q:Question)
WHERE q.creation_date >= 1577836800 AND q.creation_date <= 1609459199
RETURN q
ORDER BY q.answer_count DESC
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
Show the first 5 questions where the accepted answer was provided by a user who has answered more than 50 questions.,"MATCH (u:User)-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q:Question)
WHERE a.is_accepted = true AND q.accepted_answer_id IS NOT NULL
WITH u, count{(u)-[:PROVIDED]->(:Answer)} AS answersCount
WHERE answersCount > 50
RETURN u, a, q
LIMIT 5",Verbose query,stackoverflow2,False,False,False,
List the top 3 answers with the lowest scores.,"MATCH (a:Answer)-[:ANSWERED]->(:Question)
RETURN a
ORDER BY a.score ASC
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
Which 5 questions have the most comments and are tagged with 'neo4j'?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'neo4j'})
WITH q, count{(q)<-[:COMMENTED_ON]-(:Comment)} AS commentCount
ORDER BY commentCount DESC
LIMIT 5
RETURN q",Verbose query,stackoverflow2,False,False,True,
Display the top 3 most active users in terms of asking questions.,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN u.display_name, count(q) AS questions_asked
ORDER BY questions_asked DESC
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
What are the first 5 questions with the most unique tags?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WITH q, count(DISTINCT t) AS uniqueTags
ORDER BY uniqueTags DESC
RETURN q
LIMIT 5",Verbose query,stackoverflow2,False,False,False,
Retrieve the top 3 oldest answers in the database.,"MATCH (a:Answer)-[:ANSWERED]->(q:Question)
RETURN a, q
ORDER BY a.uuid ASC
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
Show the first 5 questions that have been tagged more than once.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WITH q, count(t) AS tagCount
WHERE tagCount > 1
RETURN q
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
List the top 3 questions where the accepted answer has a negative score.,"MATCH (q:Question)-[:ANSWERED]->(a:Answer {is_accepted: true})
WHERE a.score < 0
RETURN q.title, q.link, a.score
ORDER BY a.score ASC
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
Which 5 answers were provided by users who have never asked a question?,"MATCH (u:User)-[:PROVIDED]->(a:Answer)
WHERE NOT exists{ (u)-[:ASKED]->(:Question) }
RETURN a
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
Display the first 5 questions where the body markdown mentions 'index'.,"MATCH (q:Question)
WHERE q.body_markdown CONTAINS 'index'
RETURN q
LIMIT 5",Verbose query,stackoverflow2,True,False,False,
What are the top 3 questions asked by users with more than 1000 total answers provided?,"MATCH (u:User)-[:PROVIDED]->(a:Answer)
WITH u, count(a) AS totalAnswers
WHERE totalAnswers > 1000
MATCH (u)-[:ASKED]->(q:Question)
RETURN q
ORDER BY q.view_count DESC
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
Retrieve the first 5 questions with accepted answers that have a view count over 500.,"MATCH (q:Question)
WHERE q.accepted_answer_id IS NOT NULL AND q.view_count > 500
RETURN q
ORDER BY q.creation_date
LIMIT 5",Verbose query,stackoverflow2,False,False,False,
Show the top 5 questions with the highest score to comment ratio.,"MATCH (q:Question)
WHERE q.view_count IS NOT NULL AND q.answer_count IS NOT NULL
WITH q, toFloat(q.view_count) / q.answer_count AS score_to_comment_ratio
ORDER BY score_to_comment_ratio DESC
LIMIT 5
RETURN q.title, q.link, score_to_comment_ratio",Verbose query,stackoverflow2,False,False,True,
Which 5 questions have the most tags?,"MATCH (q:Question)
RETURN q, count{(q)-[:TAGGED]->(:Tag)} AS tagCount
ORDER BY tagCount DESC
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
What are the first 5 questions with the least views and no comments?,"MATCH (q:Question)
WHERE NOT EXISTS { (q)<-[:COMMENTED_ON]-(:Comment) }
RETURN q
ORDER BY q.view_count ASC
LIMIT 5",Verbose query,stackoverflow2,False,False,False,
Display the top 3 questions that received an answer on the same day they were asked.,"MATCH (q:Question)-[:ANSWERED]->(a:Answer)
WHERE q.creation_date = a.creation_date
RETURN q
ORDER BY q.view_count DESC
LIMIT 3",Verbose query,stackoverflow2,False,False,True,Answer.creation_date
Which 5 users have provided the most answers to questions they have never commented on?,"MATCH (u:User)-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q:Question)
WHERE NOT EXISTS {
  (u)-[:COMMENTED]->(:Comment)-[:COMMENTED_ON]->(q)
}
RETURN u.display_name, count(a) AS answers_provided
ORDER BY answers_provided DESC
LIMIT 5",Verbose query,stackoverflow2,False,False,False,
List the top 3 questions that have an accepted answer and are tagged with 'cypher'.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'cypher'})
WHERE q.accepted_answer_id IS NOT NULL
RETURN q
ORDER BY q.view_count DESC
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
What are the top 3 questions with the most different users commenting?,"MATCH (q:Question)<-[:COMMENTED_ON]-(c:Comment)<-[:COMMENTED]-(u:User)
WITH q, COUNT(DISTINCT u) AS uniqueCommenters
ORDER BY uniqueCommenters DESC
LIMIT 3
RETURN q, uniqueCommenters",Simple Aggregation Queries,stackoverflow2,False,False,True,
What are the first 5 questions where the user who commented also provided an answer?,"MATCH (u:User)-[:COMMENTED]->(c:Comment)-[:COMMENTED_ON]->(q:Question),
      (u)-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q)
RETURN q
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
Retrieve the top 3 questions with the most detailed body markdown.,"MATCH (q:Question)
RETURN q
ORDER BY length(q.body_markdown) DESC
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
Show the first 5 questions that have answers from users who have also asked questions.,"MATCH (u:User)-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q:Question)
WHERE exists {
  (u)-[:ASKED]->(:Question)
}
RETURN q
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
List the top 3 questions where the answer count is greater than the view count.,"MATCH (q:Question)
WHERE q.answer_count > q.view_count
RETURN q
ORDER BY q.answer_count DESC
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
Which 5 questions have the most comments from users who have provided more than 10 answers?,"MATCH (u:User)-[:PROVIDED]->(a:Answer)
WITH u, count(a) AS answersCount
WHERE answersCount > 10
MATCH (u)-[:COMMENTED]->(c:Comment)-[:COMMENTED_ON]->(q:Question)
WITH q, count(c) AS commentsCount
RETURN q
ORDER BY commentsCount DESC
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
Display the top 3 most commented questions by a single user.,"MATCH (u:User)-[:COMMENTED]->(c:Comment)-[:COMMENTED_ON]->(q:Question)
WITH q, count(c) AS commentsCount
ORDER BY commentsCount DESC
RETURN q.title, q.link, commentsCount
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
Display the top 3 most frequently commented-on answers.,"MATCH (a:Answer)<-[:ANSWERED]-(q:Question)
WITH a, count{(a)<-[:COMMENTED_ON]-(:Comment)} AS commentsCount
ORDER BY commentsCount DESC
LIMIT 3
RETURN a, commentsCount",Verbose query,stackoverflow2,False,False,True,
What are the first 5 questions tagged with 'neo4j' that have received answers from different users?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'neo4j'})
WHERE exists {
  MATCH (q)<-[:ANSWERED]-(a:Answer)<-[:PROVIDED]-(u:User)
  WITH q, count(DISTINCT u) AS distinctUsers
  WHERE distinctUsers > 1
}
RETURN q
ORDER BY q.creation_date
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
Show the first 5 questions asked by users who have commented on more than 100 different questions.,"MATCH (u:User)-[:COMMENTED]->(c:Comment)-[:COMMENTED_ON]->(q:Question)
WITH u, count(DISTINCT q) AS numQuestions
WHERE numQuestions > 100
MATCH (u)-[:ASKED]->(q2:Question)
RETURN q2
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
List the top 3 answers with the highest view to score ratio.,"MATCH (a:Answer)-[:ANSWERED]->(q:Question)
WHERE q.view_count IS NOT NULL AND a.score IS NOT NULL AND q.view_count > 0
WITH a, q, toFloat(q.view_count) / a.score AS ratio
ORDER BY ratio DESC
RETURN a.link AS AnswerLink, a.title AS AnswerTitle, ratio
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
Which 5 questions have been asked by the most users?,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH q, count(u) AS num_users
ORDER BY num_users DESC
LIMIT 5
RETURN q",Verbose query,stackoverflow2,False,False,True,
Display the top 3 questions with the most comments made by the user who asked the question.,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH q, count{(u)-[:COMMENTED]->(:Comment)-[:COMMENTED_ON]->(q)} AS commentsCount
ORDER BY commentsCount DESC
LIMIT 3
RETURN q, commentsCount",Verbose query,stackoverflow2,False,False,True,
What are the first 5 questions asked by the most recent user to join the platform?,"MATCH (u:User)
WHERE u.uuid IS NOT NULL
WITH u
ORDER BY u.uuid DESC
LIMIT 1
MATCH (u)-[:ASKED]->(q:Question)
RETURN q
ORDER BY q.creation_date
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
Retrieve the top 3 highest viewed questions that have been answered by users with less than 3 answers in total.,"MATCH (u:User)-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q:Question)
WITH u, count(a) AS totalAnswers, q
WHERE totalAnswers < 3
MATCH (q)
RETURN q
ORDER BY q.view_count DESC
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
Show the first 5 questions where the title contains the word 'update'.,"MATCH (q:Question)
WHERE q.title CONTAINS 'update'
RETURN q
LIMIT 5",Verbose query,stackoverflow2,False,False,False,
Retrieve the top 3 questions with the most votes.,"MATCH (q:Question)
RETURN q
ORDER BY q.view_count DESC
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
What are the first 5 questions where the accepted answer was provided by the user who asked the question?,"MATCH (u:User)-[:ASKED]->(q:Question)<-[:ANSWERED]-(a:Answer)
WHERE a.is_accepted = true AND (u)-[:PROVIDED]->(a)
RETURN q
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
Retrieve the top 3 questions where the body markdown contains 'neo4j'.,"MATCH (q:Question)
WHERE q.body_markdown CONTAINS 'neo4j'
RETURN q
ORDER BY q.view_count DESC
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
Show the first 5 users who have provided answers but have never asked a question.,"MATCH (u:User)-[:PROVIDED]->(:Answer)
WHERE NOT EXISTS { (u)-[:ASKED]->(:Question) }
RETURN u
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
List the top 5 users with the highest average answer score.,"MATCH (u:User)-[:PROVIDED]->(a:Answer)
WITH u, avg(a.score) AS avgScore
ORDER BY avgScore DESC
LIMIT 5
RETURN u.display_name AS UserName, avgScore",Verbose query,stackoverflow2,False,False,True,
Retrieve the first 3 users who commented on the most viewed question.,"MATCH (q:Question)
WHERE q.view_count IS NOT NULL
WITH q ORDER BY q.view_count DESC LIMIT 1
MATCH (u:User)-[:COMMENTED]->(:Comment)-[:COMMENTED_ON]->(q)
RETURN u
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
Show the first 5 questions that have been tagged with 'cypher' and have more than one answer.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'cypher'})
WHERE q.answer_count > 1
RETURN q
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
Find the top 3 questions with the most comments.,"MATCH (q:Question)
WITH q, count{(q)<-[:COMMENTED_ON]-(:Comment)} AS commentCount
ORDER BY commentCount DESC
LIMIT 3
RETURN q",Verbose query,stackoverflow2,False,False,True,
Which 5 users have provided an accepted answer?,"MATCH (u:User)-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q:Question)
WHERE a.is_accepted = true
RETURN u.display_name, COUNT(a) AS accepted_answers
ORDER BY accepted_answers DESC
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
Display the top 3 tags associated with questions that have accepted answers.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.accepted_answer_id IS NOT NULL
RETURN t.name, count(q) AS question_count
ORDER BY question_count DESC
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
What are the first 5 questions with the highest answer to view ratio?,"MATCH (q:Question)
WHERE q.answer_count IS NOT NULL AND q.view_count IS NOT NULL AND q.view_count > 0
RETURN q
ORDER BY toFloat(q.answer_count) / q.view_count DESC
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
What are the top 3 tags used in the most commented questions?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE exists{ (q)-[:COMMENTED_ON]->(:Comment) }
WITH t, count{(q)-[:COMMENTED_ON]->(:Comment)} AS commentCount
ORDER BY commentCount DESC
RETURN t.name, commentCount
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
List the top 5 tags most frequently associated with questions having more than 3 answers.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.answer_count > 3
RETURN t.name, count(q) AS question_count
ORDER BY question_count DESC
LIMIT 5",Verbose query,stackoverflow2,False,False,False,
Which 5 users have commented the most times?,"MATCH (u:User)-[:COMMENTED]->(c:Comment)
RETURN u.display_name, count(c) AS comments_count
ORDER BY comments_count DESC
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
List the top 3 questions with the lowest view counts.,"MATCH (q:Question)
RETURN q
ORDER BY q.view_count ASC
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
What are the first 3 most recent questions asked on the platform?,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN q
ORDER BY q.creation_date DESC
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
Find the first 5 questions that have no answers.,"MATCH (q:Question)
WHERE NOT exists{(q)<-[:ANSWERED]-(:Answer)}
RETURN q
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
Show 3 questions with the highest number of answers.,"MATCH (q:Question)
RETURN q
ORDER BY q.answer_count DESC
LIMIT 3",Verbose query,stackoverflow2,False,False,False,
Which questions have more than one answer but less than 50 views? List the first 5.,"MATCH (q:Question)
WHERE q.answer_count > 1 AND q.view_count < 50
RETURN q
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
Display the top 3 most commented on questions.,"MATCH (q:Question)
RETURN q, count{(u:User)-[:COMMENTED]->(:Comment)-[:COMMENTED_ON]->(q)} AS commentCount
ORDER BY commentCount DESC
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
Show the first 3 questions that have been both asked and commented on by the same user.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE exists {
  MATCH (u)-[:COMMENTED]->(:Comment)-[:COMMENTED_ON]->(q)
}
RETURN q
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
Identify the top 3 users by the number of answers provided.,"MATCH (u:User)-[:PROVIDED]->(a:Answer)
RETURN u.display_name, count(a) AS answers_provided
ORDER BY answers_provided DESC
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
Show the first 5 questions where the same user has asked and provided an answer.,"MATCH (u:User)-[:ASKED]->(q:Question), (u)-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q)
RETURN q
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
Find the first 5 users who have asked the most questions without ever providing an answer.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE NOT exists{ (u)-[:PROVIDED]->(:Answer) }
RETURN u, count(q) AS questions_asked
ORDER BY questions_asked DESC
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
List the top 3 questions with accepted answers that have the lowest scores.,"MATCH (q:Question)-[:ANSWERED]->(a:Answer {is_accepted: true})
RETURN q.title, a.score
ORDER BY a.score ASC
LIMIT 3",Verbose query,stackoverflow2,False,False,False,
Which 5 questions have the oldest creation dates?,"MATCH (q:Question)
RETURN q
ORDER BY q.creation_date
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
Display the first 5 questions tagged with 'neo4j' that have more than two answers.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'neo4j'})
WHERE q.answer_count > 2
RETURN q
ORDER BY q.creation_date
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
What are the top 3 most frequently commented tags?,"MATCH (t:Tag)<-[:TAGGED]-(q:Question)<-[:COMMENTED_ON]-(c:Comment)
WITH t, count(c) AS commentsCount
ORDER BY commentsCount DESC
LIMIT 3
RETURN t.name AS Tag, commentsCount",Verbose query,stackoverflow2,False,False,True,
Show the first 5 questions where the title contains the word 'error'.,"MATCH (q:Question)
WHERE q.title CONTAINS 'error'
RETURN q
LIMIT 5",Verbose query,stackoverflow2,False,False,False,
Find the top 5 highest viewed questions that have been answered by the same user who asked them.,"MATCH (u:User)-[:ASKED]->(q:Question)<-[:ANSWERED]-(a:Answer)
WHERE (a)-[:PROVIDED]->(u)
RETURN q.title, q.view_count
ORDER BY q.view_count DESC
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
Identify the first 3 users who commented on their own questions more than once.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE exists {
  (u)-[:COMMENTED]->(c:Comment)-[:COMMENTED_ON]->(q)
}
WITH u, q, count{(u)-[:COMMENTED]->(:Comment)-[:COMMENTED_ON]->(q)} AS ownComments
WHERE ownComments > 1
RETURN u
ORDER BY u.uuid
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
Identify the top 3 users who have provided answers to questions they have also commented on.,"MATCH (u:User)-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q:Question)
WHERE exists {
  (u)-[:COMMENTED]->(:Comment)-[:COMMENTED_ON]->(q)
}
RETURN u.display_name, count(a) AS answers_provided
ORDER BY answers_provided DESC
LIMIT 3",Verbose query,stackoverflow2,True,False,False,
List the top 5 most frequently tagged tags in questions with zero answers.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.answer_count = 0
RETURN t.name, count(t) AS frequency
ORDER BY frequency DESC
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
Display the top 3 most viewed questions that have been commented on.,"MATCH (q:Question)-[:COMMENTED_ON]-(:Comment)
WHERE q.view_count IS NOT NULL
RETURN q
ORDER BY q.view_count DESC
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
What are the first 5 questions asked in 2021?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.creation_date >= 1609459200 AND q.creation_date < 1640995200
RETURN q
ORDER BY q.creation_date ASC
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
Retrieve the top 3 questions with the most recent creation dates.,"MATCH (q:Question)
RETURN q
ORDER BY q.creation_date DESC
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
Show the first 5 questions where the accepted answer has a score of zero or less.,"MATCH (q:Question)-[:ANSWERED]->(a:Answer {is_accepted: true})
WHERE a.score <= 0
RETURN q
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
List the top 3 answers with the highest scores that have not been accepted.,"MATCH (a:Answer)-[:ANSWERED]->(q:Question)
WHERE a.is_accepted = false
RETURN a
ORDER BY a.score DESC
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
Which 5 users have the most comments without any answers?,"MATCH (u:User)-[:COMMENTED]->(c:Comment)
WHERE NOT exists{ (u)-[:PROVIDED]->(:Answer) }
RETURN u.display_name, count(c) AS comments_count
ORDER BY comments_count DESC
LIMIT 5",Verbose query,stackoverflow2,False,False,False,
Display the top 3 questions tagged 'neo4j' with no accepted answers.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'neo4j'})
WHERE q.accepted_answer_id IS NULL
RETURN q
ORDER BY q.view_count DESC
LIMIT 3",Verbose query,stackoverflow2,False,False,True,
Which 5 users have both asked and answered the same question?,"MATCH (u:User)-[:ASKED]->(q:Question)<-[:ANSWERED]-(a:Answer)-[:PROVIDED]->(u)
RETURN u.display_name, COUNT(DISTINCT q) AS num_questions
ORDER BY num_questions DESC
LIMIT 5",Verbose query,stackoverflow2,False,False,True,
List the top 3 answers that are accepted and have the highest scores.,"MATCH (a:Answer)-[:ANSWERED]->(q:Question)
WHERE a.is_accepted = true
RETURN a, q
ORDER BY a.score DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the top 5 questions with the most number of different commenters.,"MATCH (q:Question)<-[:COMMENTED_ON]-(c:Comment)<-[:COMMENTED]-(u:User)
WITH q, count(DISTINCT u) AS uniqueCommenters
ORDER BY uniqueCommenters DESC
LIMIT 5
RETURN q, uniqueCommenters",Simple Aggregation Queries,stackoverflow2,False,False,True,
What are the top 5 questions asked by users with the highest number of comments?,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u, q, size((u)-[:COMMENTED]->(:Comment)) AS commentsCount
ORDER BY commentsCount DESC
LIMIT 5
RETURN q",Simple Aggregation Queries,stackoverflow2,False,False,True,
"Show all the tags associated with questions that have over 100 views, limit to 5 tags.","MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.view_count > 100
RETURN t
LIMIT 5",Complex Retrieval Queries,stackoverflow2,True,False,False,
Which questions have more than two comments by a single user? Show only the first 3.,"MATCH (u:User)-[:COMMENTED]->(c:Comment)-[:COMMENTED_ON]->(q:Question)
WITH q, u, count(c) AS numComments
WHERE numComments > 2
RETURN q
LIMIT 3",Complex Retrieval Queries,stackoverflow2,False,False,True,
Identify the top 5 highest scoring answers provided by the user 'Anu'.,"MATCH (u:User {display_name: 'Anu'})-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q:Question)
RETURN a.link AS AnswerLink, a.score AS Score, q.title AS QuestionTitle
ORDER BY a.score DESC
LIMIT 5",Complex Retrieval Queries,stackoverflow2,False,False,True,
List the first 3 users who have asked more than one question.,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH u, count(q) AS questions_count
WHERE questions_count > 1
RETURN u
ORDER BY u.uuid
LIMIT 3",Complex Retrieval Queries,stackoverflow2,False,False,False,
What are the top 5 most viewed questions tagged with 'neo4j'?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'neo4j'})
RETURN q.title, q.link, q.view_count
ORDER BY q.view_count DESC
LIMIT 5",Complex Retrieval Queries,stackoverflow2,False,False,True,
List the first 3 questions with a view count between 50 and 100.,"MATCH (q:Question)
WHERE q.view_count >= 50 AND q.view_count <= 100
RETURN q
ORDER BY q.creation_date
LIMIT 3",Simple Retrieval Queries,stackoverflow2,False,False,True,
Which 3 answers are linked to questions asked by the most unique users?,"MATCH (u:User)-[:ASKED]->(q:Question)
WITH q, count(DISTINCT u) AS userCount
ORDER BY userCount DESC
LIMIT 1
MATCH (a:Answer)-[:ANSWERED]->(q)
RETURN a
ORDER BY a.score DESC
LIMIT 3",Simple Retrieval Queries,stackoverflow2,False,False,True,
What are the top 5 most recent comments?,"MATCH (c:Comment)
RETURN c
ORDER BY c.uuid DESC
LIMIT 5",Simple Retrieval Queries,stackoverflow2,True,False,False,
List the first 3 questions with the most comments.,"MATCH (q:Question)
WITH q, count{(q)<-[:COMMENTED_ON]-(:Comment)} AS commentCount
ORDER BY commentCount DESC
RETURN q
LIMIT 3",Simple Retrieval Queries,stackoverflow2,False,False,True,
Which 3 users have the most questions with accepted answers?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.accepted_answer_id IS NOT NULL
WITH u, count(q) AS num_accepted_questions
ORDER BY num_accepted_questions DESC
LIMIT 3
RETURN u.display_name, num_accepted_questions",Simple Retrieval Queries,stackoverflow2,False,False,True,
List all the questions that have been tagged with both 'neo4j' and 'cypher'.,"MATCH (q:Question)-[:TAGGED]->(t1:Tag), (q)-[:TAGGED]->(t2:Tag)
WHERE t1.name = 'neo4j' AND t2.name = 'cypher'
RETURN q",Simple Retrieval Queries,stackoverflow2,False,False,True,
What are the first 3 questions that have comments with a score of 3?,"MATCH (q:Question)<-[:COMMENTED_ON]-(c:Comment)
WHERE c.score = 3
RETURN q
LIMIT 3",Simple Retrieval Queries,stackoverflow2,False,False,True,
List the first 3 answers to questions that have at least 3 tags.,"MATCH (q:Question)
WHERE size{(q)-[:TAGGED]->(:Tag)} >= 3
WITH q
MATCH (a:Answer)-[:ANSWERED]->(q)
RETURN a
LIMIT 3",Simple Retrieval Queries,stackoverflow2,False,False,True,
Which users have asked the most questions in the last year?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.creation_date >= 1609459200 AND q.creation_date <= 1640995199
RETURN u.display_name, count(q) AS questions_asked
ORDER BY questions_asked DESC",Simple Retrieval Queries,stackoverflow2,False,False,True,
List the first 3 tags that appear in questions with zero answers.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.answer_count = 0
RETURN t
LIMIT 3",Simple Retrieval Queries,stackoverflow2,False,False,True,
What are the titles of the top 3 questions that have accepted answers with a negative score?,"MATCH (q:Question)-[:ANSWERED]->(a:Answer {is_accepted: true})
WHERE a.score < 0
RETURN q.title
ORDER BY q.view_count DESC
LIMIT 3",Complex Retrieval Queries,stackoverflow2,False,False,True,
Can you list the first 3 users who have commented on questions related to 'neo4j' more than once?,"MATCH (u:User)-[:COMMENTED]->(c:Comment)-[:COMMENTED_ON]->(q:Question)-[:TAGGED]->(t:Tag {name: 'neo4j'})
WITH u, COUNT(c) AS comments_count
WHERE comments_count > 1
RETURN u
ORDER BY comments_count DESC
LIMIT 3",Complex Retrieval Queries,stackoverflow2,False,False,True,
Which are the top 5 most recent questions asked by user 'Mohammed Faraz ali'?,"MATCH (u:User {display_name: 'Mohammed Faraz ali'})-[:ASKED]->(q:Question)
RETURN q
ORDER BY q.creation_date DESC
LIMIT 5",Complex Retrieval Queries,stackoverflow2,False,False,False,
Display the first 3 questions that have no answers.,"MATCH (q:Question)
WHERE NOT exists{(q)-[:ANSWERED]->(:Answer)}
RETURN q
LIMIT 3",Complex Retrieval Queries,stackoverflow2,False,False,True,
Identify the questions with the most comments. Limit the results to the first 5.,"MATCH (q:Question)
WITH q, size((:Comment)-[:COMMENTED_ON]->(q)) AS commentCount
ORDER BY commentCount DESC
LIMIT 5
RETURN q, commentCount",Complex Retrieval Queries,stackoverflow2,False,False,True,
What are the most recent 3 questions that have been asked by users with a display name starting with 'A'?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.display_name STARTS WITH 'A'
RETURN q
ORDER BY q.creation_date DESC
LIMIT 3",Complex Retrieval Queries,stackoverflow2,False,False,True,
List the first 3 questions that have been commented on by user 'Mohammed Faraz ali'.,"MATCH (u:User {display_name: 'Mohammed Faraz ali'})-[:COMMENTED]->(c:Comment)-[:COMMENTED_ON]->(q:Question)
RETURN q
LIMIT 3",Complex Retrieval Queries,stackoverflow2,False,False,True,
Show the top 5 users who have provided the most answers.,"MATCH (u:User)-[:PROVIDED]->(a:Answer)
RETURN u.display_name AS UserName, count(a) AS AnswersProvided
ORDER BY AnswersProvided DESC
LIMIT 5",Complex Retrieval Queries,stackoverflow2,False,False,True,
What are the first 3 most recent questions asked about 'neo4j' that have an accepted answer?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'neo4j'})
WHERE q.accepted_answer_id IS NOT NULL
RETURN q
ORDER BY q.creation_date DESC
LIMIT 3",Complex Retrieval Queries,stackoverflow2,False,False,True,
Which tags are associated with questions that have more than two answers? Show only the top 3 tags.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.answer_count > 2
RETURN t.name, count(q) AS question_count
ORDER BY question_count DESC
LIMIT 3",Complex Retrieval Queries,stackoverflow2,False,False,True,
List all the questions that have been provided answers by more than 3 different users. Limit to the first 5 questions.,"MATCH (q:Question)<-[:ANSWERED]-(a:Answer)<-[:PROVIDED]-(u:User)
WITH q, count(DISTINCT u) AS distinctUsers
WHERE distinctUsers > 3
RETURN q
LIMIT 5",Complex Retrieval Queries,stackoverflow2,False,False,False,
What are the first 3 questions asked by users with a UUID less than 500000?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.uuid < 500000
RETURN q
ORDER BY q.creation_date ASC
LIMIT 3",Simple Retrieval Queries,stackoverflow2,False,False,True,
What are the 3 most recent comments on the question with the highest view count?,"MATCH (q:Question)
WITH q ORDER BY q.view_count DESC LIMIT 1
MATCH (c:Comment)-[:COMMENTED_ON]->(q)
RETURN c ORDER BY c.uuid DESC LIMIT 3",Complex Retrieval Queries,stackoverflow2,False,False,True,
Can you find the first 3 questions that were tagged 'neo4j' and have an answer count of zero?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'neo4j'})
WHERE q.answer_count = 0
RETURN q
ORDER BY q.creation_date
LIMIT 3",Complex Retrieval Queries,stackoverflow2,False,False,True,
Which users have commented on the question titled 'Create graph from recursive JSON data using apoc.load.json and use UNWIND and FOREACH for setting property'? Show only the top 3.,"MATCH (u:User)-[:COMMENTED]->(c:Comment)-[:COMMENTED_ON]->(q:Question {title: 'Create graph from recursive JSON data using apoc.load.json and use UNWIND and FOREACH for setting property'})
RETURN u.display_name, count(c) AS comments_count
ORDER BY comments_count DESC
LIMIT 3",Complex Retrieval Queries,stackoverflow2,False,False,True,
"Display all the questions asked in 2021, limiting the results to the first 5.","MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.creation_date >= 1609459200 AND q.creation_date <= 1640995199
RETURN q
LIMIT 5",Complex Retrieval Queries,stackoverflow2,False,False,True,
What are the top 3 questions with the lowest view count that have been answered by 'Anu'?,"MATCH (u:User {display_name: 'Anu'})-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q:Question)
WHERE q.view_count IS NOT NULL
RETURN q
ORDER BY q.view_count ASC
LIMIT 3",Complex Retrieval Queries,stackoverflow2,False,False,True,
List the names of the top 5 tags most frequently used in questions that have been commented on.,"MATCH (t:Tag)<-[:TAGGED]-(q:Question)
WHERE exists{(q)<-[:COMMENTED_ON]-(:Comment)}
RETURN t.name, count(q) AS frequency
ORDER BY frequency DESC
LIMIT 5",Complex Retrieval Queries,stackoverflow2,False,False,True,
What are the links to the answers that were accepted for questions with more than 80 views? Show only the first 3.,"MATCH (a:Answer)-[:ANSWERED]->(q:Question)
WHERE q.view_count > 80 AND a.is_accepted = true
RETURN a.link
LIMIT 3",Complex Retrieval Queries,stackoverflow2,False,False,True,
Show the top 5 questions with the highest number of answers that have an accepted answer.,"MATCH (q:Question)
WHERE q.accepted_answer_id IS NOT NULL
RETURN q
ORDER BY q.answer_count DESC
LIMIT 5",Complex Retrieval Queries,stackoverflow2,False,False,False,
Identify the top 5 questions with the highest view count that do not have any answers.,"MATCH (q:Question)
WHERE q.answer_count = 0 AND q.view_count IS NOT NULL
RETURN q
ORDER BY q.view_count DESC
LIMIT 5",Complex Retrieval Queries,stackoverflow2,False,False,True,
List the top 5 comments with a link containing 'neomodel'.,"MATCH (c:Comment)
WHERE c.link CONTAINS 'neomodel'
RETURN c
ORDER BY c.score DESC
LIMIT 5",Simple Retrieval Queries,stackoverflow2,False,False,True,
Which 3 users have commented on questions asked by 'schernichkin'?,"MATCH (u:User {display_name: 'schernichkin'})-[:ASKED]->(q:Question)<-[:COMMENTED_ON]-(c:Comment)<-[:COMMENTED]-(commenter:User)
RETURN commenter.display_name, count(c) AS comments_count
ORDER BY comments_count DESC
LIMIT 3",Simple Retrieval Queries,stackoverflow2,False,False,True,
List all the answers with a negative score.,"MATCH (a:Answer)
WHERE a.score < 0
RETURN a",Simple Retrieval Queries,stackoverflow2,False,False,True,
What are the first 3 tags associated with the most questions?,"MATCH (t:Tag)<-[:TAGGED]-(q:Question)
WITH t, count(q) AS questionCount
ORDER BY questionCount DESC
LIMIT 3
RETURN t.name AS TagName, questionCount",Simple Retrieval Queries,stackoverflow2,False,False,True,
Which users have asked questions with more than 100 views?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.view_count > 100
RETURN u",Simple Retrieval Queries,stackoverflow2,False,False,True,
List the first 3 questions with no answers.,"MATCH (q:Question)
WHERE q.answer_count = 0
RETURN q
ORDER BY q.creation_date
LIMIT 3",Simple Retrieval Queries,stackoverflow2,False,False,True,
Which 3 answers have the lowest score?,"MATCH (a:Answer)
RETURN a
ORDER BY a.score ASC
LIMIT 3",Simple Retrieval Queries,stackoverflow2,True,False,False,
What are the top 5 questions with the lowest view count?,"MATCH (q:Question)
RETURN q
ORDER BY q.view_count ASC
LIMIT 5",Simple Retrieval Queries,stackoverflow2,False,False,True,
List the first 3 accepted answers.,"MATCH (a:Answer {is_accepted: true})
RETURN a
ORDER BY a.uuid
LIMIT 3",Simple Retrieval Queries,stackoverflow2,False,False,True,
Which 3 users provided the most answers?,"MATCH (u:User)-[:PROVIDED]->(a:Answer)
RETURN u.display_name, count(a) AS answers_provided
ORDER BY answers_provided DESC
LIMIT 3",Simple Retrieval Queries,stackoverflow2,False,False,True,
List all the answers provided by the user with UUID 16922964.,"MATCH (u:User {uuid: 16922964})-[:PROVIDED]->(a:Answer)
RETURN a",Simple Retrieval Queries,stackoverflow2,False,False,True,
Find the first 3 questions tagged with 'neo4j'.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'neo4j'})
RETURN q
ORDER BY q.creation_date
LIMIT 3",Simple Retrieval Queries,stackoverflow2,False,False,True,
Which 3 users have commented the most?,"MATCH (u:User)-[:COMMENTED]->(c:Comment)
WITH u, count(c) AS commentsCount
ORDER BY commentsCount DESC
LIMIT 3
RETURN u.display_name AS UserName, commentsCount",Simple Retrieval Queries,stackoverflow2,False,False,True,
List all questions asked by the user with display name 'Adrien Lemaire'.,"MATCH (u:User {display_name: 'Adrien Lemaire'})-[:ASKED]->(q:Question)
RETURN q",Simple Retrieval Queries,stackoverflow2,False,False,True,
What are the first 3 comments with a score of 2 or higher?,"MATCH (c:Comment)
WHERE c.score >= 2
RETURN c
ORDER BY c.uuid
LIMIT 3",Simple Retrieval Queries,stackoverflow2,False,False,True,
Find the top 5 answers with the highest score.,"MATCH (a:Answer)-[:ANSWERED]->(:Question)
RETURN a
ORDER BY a.score DESC
LIMIT 5",Simple Retrieval Queries,stackoverflow2,True,False,False,
List the first 3 users by UUID.,"MATCH (u:User)
RETURN u
ORDER BY u.uuid
LIMIT 3",Simple Retrieval Queries,stackoverflow2,False,False,True,
What are the top 5 most viewed questions?,"MATCH (q:Question)
RETURN q
ORDER BY q.view_count DESC
LIMIT 5",Simple Retrieval Queries,stackoverflow2,False,False,True,
Who commented on the top 3 most commented questions?,"MATCH (q:Question)
WITH q, size((:Comment)-[:COMMENTED_ON]->(q)) AS commentsCount
ORDER BY commentsCount DESC
LIMIT 3
MATCH (u:User)-[:COMMENTED]->(c:Comment)-[:COMMENTED_ON]->(q)
RETURN DISTINCT u.display_name AS commenter",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the top 5 questions with the most answers.,"MATCH (q:Question)
RETURN q
ORDER BY q.answer_count DESC
LIMIT 5",Simple Retrieval Queries,stackoverflow2,False,False,True,
What are the titles of the first 3 questions that have received an answer with the highest scores?,"MATCH (a:Answer)-[:ANSWERED]->(q:Question)
WITH q, a.score AS score
ORDER BY score DESC
LIMIT 3
RETURN q.title AS QuestionTitle",Complex Retrieval Queries,stackoverflow2,False,False,True,
Which 3 users have their name starting with 'A'?,"MATCH (u:User)
WHERE u.display_name STARTS WITH 'A'
RETURN u
LIMIT 3",Simple Retrieval Queries,stackoverflow2,False,False,True,
What are the top 5 most recent questions?,"MATCH (q:Question)
RETURN q
ORDER BY q.creation_date DESC
LIMIT 5",Simple Retrieval Queries,stackoverflow2,False,False,True,
What are the first 3 questions tagged with 'cypher' and have more than 1 answer?,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'cypher'})
WHERE q.answer_count > 1
RETURN q
ORDER BY q.creation_date
LIMIT 3",Simple Retrieval Queries,stackoverflow2,False,False,True,
List the top 5 questions with an accepted answer ID.,"MATCH (q:Question)
WHERE q.accepted_answer_id IS NOT NULL
RETURN q
ORDER BY q.view_count DESC
LIMIT 5",Simple Retrieval Queries,stackoverflow2,False,False,True,
Which users have provided answers to more than 3 different questions?,"MATCH (u:User)-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q:Question)
WITH u, count(DISTINCT q) AS questions_answered
WHERE questions_answered > 3
RETURN u",Simple Retrieval Queries,stackoverflow2,False,False,True,
List the first 3 questions with a title containing 'neo4j'.,"MATCH (q:Question)
WHERE q.title CONTAINS 'neo4j'
RETURN q
LIMIT 3",Simple Retrieval Queries,stackoverflow2,False,False,True,
Which 3 answers are linked to the question with the most tags?,"MATCH (q:Question)
WITH q, size((q)-[:TAGGED]->(:Tag)) AS tagCount
ORDER BY tagCount DESC
LIMIT 1
MATCH (a:Answer)-[:ANSWERED]->(q)
RETURN a
LIMIT 3",Simple Retrieval Queries,stackoverflow2,True,False,False,
List all the comments made by the user with the highest comment score.,"MATCH (u:User)-[:COMMENTED]->(c:Comment)
WITH u, sum(c.score) AS totalScore
ORDER BY totalScore DESC
LIMIT 1
MATCH (u)-[:COMMENTED]->(highScoreComment:Comment)
RETURN highScoreComment",Simple Retrieval Queries,stackoverflow2,False,False,True,
What are the first 3 tags used in questions asked by 'Adrien Lemaire'?,"MATCH (u:User {display_name: 'Adrien Lemaire'})-[:ASKED]->(q:Question)-[:TAGGED]->(t:Tag)
RETURN t.name
LIMIT 3",Simple Retrieval Queries,stackoverflow2,False,False,True,
List the first 3 questions that have been both asked and commented on by the same user.,"MATCH (u:User)-[:ASKED]->(q:Question)<-[:COMMENTED_ON]-(c:Comment)
WHERE (u)-[:COMMENTED]->(c)
RETURN q
LIMIT 3",Simple Retrieval Queries,stackoverflow2,False,False,True,
List the top 5 questions with creation dates before 1600000000.,"MATCH (q:Question)
WHERE q.creation_date < 1600000000
RETURN q
ORDER BY q.creation_date DESC
LIMIT 5",Simple Retrieval Queries,stackoverflow2,False,False,True,
List the first 3 questions asked in 2021.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.creation_date >= 1609459200 AND q.creation_date < 1640995200
RETURN q
ORDER BY q.creation_date ASC
LIMIT 3",Simple Retrieval Queries,stackoverflow2,False,False,True,
What are the first 3 questions with exactly 2 answers?,"MATCH (q:Question)
WHERE q.answer_count = 2
RETURN q
LIMIT 3",Simple Retrieval Queries,stackoverflow2,False,False,True,
Which users have commented on more than 5 questions?,"MATCH (u:User)-[:COMMENTED]->(c:Comment)-[:COMMENTED_ON]->(q:Question)
WITH u, count(DISTINCT q) AS questionsCommented
WHERE questionsCommented > 5
RETURN u",Simple Retrieval Queries,stackoverflow2,False,False,False,
List the first 3 answers that were not accepted.,"MATCH (a:Answer)-[:ANSWERED]->(q:Question)
WHERE a.is_accepted = false
RETURN a
LIMIT 3",Simple Retrieval Queries,stackoverflow2,False,False,True,
Which 3 tags appear in the least number of questions?,"MATCH (t:Tag)<-[:TAGGED]-(q:Question)
WITH t, count(q) AS questionCount
ORDER BY questionCount ASC
LIMIT 3
RETURN t.name AS Tag, questionCount AS NumberOfQuestions",Simple Retrieval Queries,stackoverflow2,False,False,False,
List the first 3 comments made on the question with the highest view count.,"MATCH (q:Question)
WITH q ORDER BY q.view_count DESC LIMIT 1
MATCH (c:Comment)-[:COMMENTED_ON]->(q)
RETURN c ORDER BY c.uuid ASC LIMIT 3",Simple Retrieval Queries,stackoverflow2,True,False,False,
Which 3 questions have the highest answer count?,"MATCH (q:Question)
RETURN q
ORDER BY q.answer_count DESC
LIMIT 3",Simple Retrieval Queries,stackoverflow2,True,False,False,
Which 3 users have the longest display names?,"MATCH (u:User)
WHERE u.display_name IS NOT NULL
RETURN u
ORDER BY length(u.display_name) DESC
LIMIT 3",Simple Retrieval Queries,stackoverflow2,True,False,False,
Can you list the first 3 questions that have a view count between 50 and 100?,"MATCH (q:Question)
WHERE q.view_count >= 50 AND q.view_count <= 100
RETURN q
ORDER BY q.creation_date
LIMIT 3",Complex Retrieval Queries,stackoverflow2,False,False,True,
Which tags are used by more than 5 questions?,"MATCH (t:Tag)<-[:TAGGED]-(q:Question)
WITH t, count(q) AS questionCount
WHERE questionCount > 5
RETURN t.name, questionCount",Simple Retrieval Queries,stackoverflow2,False,False,False,
What are the titles of the top 5 questions with the lowest view counts?,"MATCH (q:Question)
RETURN q.title
ORDER BY q.view_count ASC
LIMIT 5",Complex Retrieval Queries,stackoverflow2,True,False,False,
What are the top 5 most commented-on questions?,"MATCH (q:Question)
WITH q, count{(q)<-[:COMMENTED_ON]-(:Comment)} AS commentsCount
ORDER BY commentsCount DESC
LIMIT 5
RETURN q AS MostCommentedQuestions, commentsCount",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the 3 users who have asked the most questions with accepted answers.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.accepted_answer_id IS NOT NULL
WITH u, count(q) AS questionsWithAcceptedAnswers
ORDER BY questionsWithAcceptedAnswers DESC
LIMIT 3
RETURN u.display_name AS UserName, questionsWithAcceptedAnswers",Simple Aggregation Queries,stackoverflow2,False,False,True,
Which tags are associated with the top 3 questions by answer count?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
RETURN t, q.answer_count AS answers
ORDER BY q.answer_count DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
What are the top 3 lowest scored answers on the most viewed questions?,"MATCH (q:Question)
WITH q
ORDER BY q.view_count DESC
LIMIT 1
MATCH (a:Answer)-[:ANSWERED]->(q)
RETURN a
ORDER BY a.score ASC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the 3 most recent questions tagged with 'neo4j'.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'neo4j'})
RETURN q
ORDER BY q.creation_date DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
Who are the top 3 users by the number of comments on answers with a score of 3?,"MATCH (u:User)-[:COMMENTED]->(c:Comment)-[:COMMENTED_ON]->(:Answer {score: 3})
WITH u, count(c) AS commentsCount
ORDER BY commentsCount DESC
LIMIT 3
RETURN u.display_name AS UserName, commentsCount",Simple Aggregation Queries,stackoverflow2,False,False,True,
What are the top 3 questions with the highest number of tags and answers?,"MATCH (q:Question)
WITH q, size((q)-[:TAGGED]->(:Tag)) AS numTags, q.answer_count AS numAnswers
ORDER BY numTags DESC, numAnswers DESC
RETURN q
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the top 5 questions that have the longest body_markdown.,"MATCH (q:Question)
RETURN q
ORDER BY length(q.body_markdown) DESC
LIMIT 5",Simple Aggregation Queries,stackoverflow2,False,False,True,
Which 3 users have commented the most times on questions with more than 2 tags?,"MATCH (u:User)-[:COMMENTED]->(c:Comment)-[:COMMENTED_ON]->(q:Question)
WHERE size((q)-[:TAGGED]->(:Tag)) > 2
WITH u, count(c) AS commentsCount
ORDER BY commentsCount DESC
LIMIT 3
RETURN u.display_name AS UserName, commentsCount",Simple Aggregation Queries,stackoverflow2,False,False,True,
Identify the 3 questions with the highest view counts that also have an accepted answer.,"MATCH (q:Question)
WHERE q.accepted_answer_id IS NOT NULL
RETURN q
ORDER BY q.view_count DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the top 3 tags on questions that have no accepted answer but have comments.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.accepted_answer_id IS NULL AND exists{(q)-[:COMMENTED_ON]->(:Comment)}
RETURN t.name, count(q) AS question_count
ORDER BY question_count DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
Which users have the most comments on answers with scores higher than 1?,"MATCH (u:User)-[:COMMENTED]->(c:Comment)-[:COMMENTED_ON]->(:Answer {score: score})
WHERE score > 1
RETURN u.display_name, count(c) AS comment_count
ORDER BY comment_count DESC",Simple Aggregation Queries,stackoverflow2,False,False,True,
What are the top 3 most viewed questions without any answers?,"MATCH (q:Question)
WHERE q.answer_count = 0
RETURN q
ORDER BY q.view_count DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the top 5 comments on the questions asked by 'Anu'.,"MATCH (u:User {display_name: 'Anu'})-[:ASKED]->(q:Question)
MATCH (c:Comment)-[:COMMENTED_ON]->(q)
RETURN c
ORDER BY c.score DESC
LIMIT 5",Simple Aggregation Queries,stackoverflow2,False,False,True,
Who are the top 3 users based on the number of provided answers that have been accepted?,"MATCH (u:User)-[:PROVIDED]->(a:Answer {is_accepted: true})
WITH u, count(a) AS acceptedAnswers
ORDER BY acceptedAnswers DESC
LIMIT 3
RETURN u.display_name AS UserName, acceptedAnswers",Simple Aggregation Queries,stackoverflow2,True,False,False,
Who are the users who have provided answers to the 3 most recently asked questions?,"MATCH (u:User)-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q:Question)
WITH q
ORDER BY q.creation_date DESC
LIMIT 3
MATCH (u:User)-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q)
RETURN DISTINCT u.display_name AS UserName",Simple Aggregation Queries,stackoverflow2,False,False,False,
What are the top 3 tags associated with questions having the highest number of comments?,"MATCH (t:Tag)<-[:TAGGED]-(q:Question)
WHERE exists {
  (q)<-[:COMMENTED_ON]-(:Comment)
}
RETURN t.name, count{(q)<-[:COMMENTED_ON]-(:Comment)} AS commentCount
ORDER BY commentCount DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the 3 most recent tags used in questions.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
RETURN t.name, t.link, q.creation_date
ORDER BY q.creation_date DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,False,
"For the top 3 questions with the lowest view counts, list their associated tags.","MATCH (q:Question)-[:TAGGED]->(t:Tag)
WITH q, t
ORDER BY q.view_count ASC
LIMIT 3
RETURN q.title, collect(t.name) AS Tags",Simple Aggregation Queries,stackoverflow2,False,False,True,
Show the first 3 questions that have been tagged with 'neo4j' and have an answer with a score of 3 or higher.,"MATCH (q:Question)-[:TAGGED]->(t:Tag {name: 'neo4j'})
WHERE exists {
    (q)<-[:ANSWERED]-(a:Answer)
    WHERE a.score >= 3
}
RETURN q
LIMIT 3",Complex Retrieval Queries,stackoverflow2,False,False,True,
List the 3 questions with the highest scores and their associated tags.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
RETURN q.title, q.score, collect(t.name) AS tags
ORDER BY q.score DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,True,False,False,Question.score
Which 3 users provided answers to the most questions?,"MATCH (u:User)-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q:Question)
WITH u, count(DISTINCT q) AS questions_answered
ORDER BY questions_answered DESC
LIMIT 3
RETURN u.display_name AS user, questions_answered",Simple Aggregation Queries,stackoverflow2,True,False,False,
What are the top 3 questions with the highest scores of comments?,"MATCH (q:Question)<-[:COMMENTED_ON]-(c:Comment)
WITH q, sum(c.score) AS totalScore
ORDER BY totalScore DESC
LIMIT 3
RETURN q",Simple Aggregation Queries,stackoverflow2,False,False,True,
"For the top 3 questions with the most views, list the users who asked them.","MATCH (u:User)-[:ASKED]->(q:Question)
RETURN q.title AS QuestionTitle, q.view_count AS Views, u.display_name AS UserName
ORDER BY q.view_count DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the top 5 questions with the most answers and their tags.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
RETURN q.title, q.answer_count, collect(t.name) AS tags
ORDER BY q.answer_count DESC
LIMIT 5",Simple Aggregation Queries,stackoverflow2,False,False,True,
Who are the top 3 users who commented the most on the highest viewed questions?,"MATCH (u:User)-[:COMMENTED]->(c:Comment)-[:COMMENTED_ON]->(q:Question)
WHERE q.view_count IS NOT NULL
WITH q, u, count(c) AS comments_count
ORDER BY q.view_count DESC, comments_count DESC
LIMIT 3
RETURN u.display_name AS user, comments_count",Simple Aggregation Queries,stackoverflow2,False,False,True,
What are the top 3 questions with the most tags?,"MATCH (q:Question)
WITH q, size((q)-[:TAGGED]->(:Tag)) AS tagCount
ORDER BY tagCount DESC
LIMIT 3
RETURN q",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the top 3 questions with the highest scores of their accepted answers.,"MATCH (q:Question)-[:ANSWERED]->(a:Answer {is_accepted: true})
RETURN q.title AS QuestionTitle, q.link AS QuestionLink, a.score AS AcceptedAnswerScore
ORDER BY a.score DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
What are the top 5 questions with the lowest answer counts but with comments?,"MATCH (q:Question)
WHERE q.answer_count > 0 AND exists{(q)<-[:COMMENTED_ON]-(:Comment)}
RETURN q
ORDER BY q.answer_count ASC
LIMIT 5",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the top 3 most answered questions and their accepted answers.,"MATCH (q:Question)
WHERE q.answer_count IS NOT NULL
WITH q
ORDER BY q.answer_count DESC
LIMIT 3
MATCH (q)-[:ANSWERED]->(a:Answer {is_accepted: true})
RETURN q.title, q.link, a.title, a.link",Simple Aggregation Queries,stackoverflow2,False,False,True,
Identify the top 5 questions with the most different tags associated.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WITH q, count(DISTINCT t) AS numTags
ORDER BY numTags DESC
LIMIT 5
RETURN q.title, q.link, numTags",Simple Aggregation Queries,stackoverflow2,True,False,False,
What are the three most recent questions asked by users with a uuid greater than 15000000?,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE u.uuid > 15000000
RETURN q
ORDER BY q.creation_date DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the top 3 answers with the longest body_markdown.,"MATCH (a:Answer)
RETURN a
ORDER BY length(a.body_markdown) DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
Who commented on the 3 questions with the highest scores?,"MATCH (u:User)-[:COMMENTED]->(c:Comment)-[:COMMENTED_ON]->(q:Question)
WITH q, COUNT(c) AS comments
ORDER BY q.score DESC LIMIT 3
RETURN u.display_name AS UserWhoCommented, q.title AS QuestionTitle, comments",Simple Aggregation Queries,stackoverflow2,False,False,True,Question.score
What are the top 3 questions with the most answers and what are their view counts?,"MATCH (q:Question)
RETURN q.title, q.view_count, q.answer_count
ORDER BY q.answer_count DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
Which users have provided the most answers to questions tagged with 'neo4j'?,"MATCH (u:User)-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'neo4j'})
WITH u, count(a) AS answersCount
ORDER BY answersCount DESC
RETURN u.display_name, answersCount",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the top 3 answers that were not accepted but have the highest scores.,"MATCH (a:Answer)-[:ANSWERED]->(q:Question)
WHERE a.is_accepted = FALSE
RETURN a, q
ORDER BY a.score DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the tags associated with the 3 questions having the lowest view counts.,"MATCH (q:Question)
WITH q
ORDER BY q.view_count ASC
LIMIT 3
MATCH (q)-[:TAGGED]->(t:Tag)
RETURN t.name",Simple Aggregation Queries,stackoverflow2,False,False,True,
"For the questions with accepted answers, list the top 3 by view count.","MATCH (q:Question)
WHERE q.accepted_answer_id IS NOT NULL
RETURN q
ORDER BY q.view_count DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
Who are the top 3 users who provided the most answers?,"MATCH (u:User)-[:PROVIDED]->(a:Answer)
RETURN u.display_name AS UserName, count(a) AS AnswersProvided
ORDER BY AnswersProvided DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the top 5 most active users based on the total number of comments provided.,"MATCH (u:User)-[:COMMENTED]->(c:Comment)
WITH u, count(c) AS total_comments
ORDER BY total_comments DESC
LIMIT 5
RETURN u.display_name, total_comments",Simple Aggregation Queries,stackoverflow2,False,False,True,
"For the top 3 highest scoring answers, list the questions they answered.","MATCH (a:Answer)-[:ANSWERED]->(q:Question)
RETURN a, q
ORDER BY a.score DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
Which users commented on the top 5 most viewed questions?,"MATCH (u:User)-[:COMMENTED]->(c:Comment)-[:COMMENTED_ON]->(q:Question)
WITH q, COUNT(c) AS comments
ORDER BY q.view_count DESC
LIMIT 5
RETURN DISTINCT u.display_name AS UserWhoCommented",Simple Aggregation Queries,stackoverflow2,False,False,True,
What are the top 3 questions with the lowest view counts but with accepted answers?,"MATCH (q:Question)
WHERE q.accepted_answer_id IS NOT NULL AND q.view_count IS NOT NULL
RETURN q
ORDER BY q.view_count ASC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the top 3 most recent questions asked on the platform.,"MATCH (q:Question)
RETURN q
ORDER BY q.creation_date DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
Which tags are most frequently associated with questions having more than one answer?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WHERE q.answer_count > 1
RETURN t.name, count(q) AS frequency
ORDER BY frequency DESC",Simple Aggregation Queries,stackoverflow2,False,False,True,
What are the three most recent answers provided on the platform?,"MATCH (a:Answer)
RETURN a
ORDER BY a.uuid DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
Identify the top 5 users by the number of questions they have asked.,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN u.display_name, count(q) AS questions_asked
ORDER BY questions_asked DESC
LIMIT 5",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the top 5 answers with the highest score.,"MATCH (a:Answer)-[:ANSWERED]->(:Question)
RETURN a
ORDER BY a.score DESC
LIMIT 5",Simple Aggregation Queries,stackoverflow2,False,False,True,
What are the top 3 comments with the highest score?,"MATCH (c:Comment)
RETURN c
ORDER BY c.score DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
Which users provided answers to the top 5 questions by view count?,"MATCH (q:Question)
WITH q
ORDER BY q.view_count DESC
LIMIT 5
MATCH (u:User)-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q)
RETURN u.display_name AS UserName, q.title AS QuestionTitle, q.view_count AS Views",Simple Aggregation Queries,stackoverflow2,True,False,False,
Who are the users who asked the top 3 questions with the most answers?,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN u.display_name AS user, q.title AS question_title, q.answer_count AS answers
ORDER BY q.answer_count DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
List all tags associated with the top 3 most viewed questions.,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
RETURN t, q.view_count
ORDER BY q.view_count DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
What are the top 5 questions with the highest view count?,"MATCH (q:Question)
RETURN q
ORDER BY q.view_count DESC
LIMIT 5",Simple Aggregation Queries,stackoverflow2,False,False,True,
Which users have provided answers that were accepted for the top 3 most viewed questions?,"MATCH (q:Question)
WITH q
ORDER BY q.view_count DESC
LIMIT 3
MATCH (u:User)-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q)
WHERE a.is_accepted = true
RETURN u.display_name AS User, q.title AS QuestionTitle, q.view_count AS Views",Simple Aggregation Queries,stackoverflow2,False,False,True,
"For the 3 questions with the most answers, list their associated tags.","MATCH (q:Question)
WITH q
ORDER BY q.answer_count DESC
LIMIT 3
MATCH (q)-[:TAGGED]->(t:Tag)
RETURN q.title, q.answer_count, collect(t.name) AS tags",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the top 3 questions with the most comments.,"MATCH (q:Question)
WITH q, count{(q)<-[:COMMENTED_ON]-(:Comment)} AS commentCount
ORDER BY commentCount DESC
LIMIT 3
RETURN q",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the first 3 questions that have been provided answers by the user 'Anu' and have an accepted answer.,"MATCH (u:User {display_name: 'Anu'})-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q:Question)
WHERE q.accepted_answer_id IS NOT NULL
RETURN q
LIMIT 3",Complex Retrieval Queries,stackoverflow2,True,False,False,
List the top 5 comments based on their score that are on questions with more than 100 views.,"MATCH (c:Comment)-[:COMMENTED_ON]->(q:Question)
WHERE q.view_count > 100
RETURN c
ORDER BY c.score DESC
LIMIT 5",Simple Aggregation Queries,stackoverflow2,False,False,True,
Which users have provided answers to questions tagged with 'neo4j'?,"MATCH (u:User)-[:PROVIDED]->(a:Answer)-[:ANSWERED]->(q:Question)-[:TAGGED]->(t:Tag {name: 'neo4j'})
RETURN DISTINCT u.display_name",Simple Aggregation Queries,stackoverflow2,False,False,True,
Which 3 questions have the highest combined scores of answers?,"MATCH (q:Question)<-[:ANSWERED]-(a:Answer)
WITH q, sum(a.score) AS totalScore
ORDER BY totalScore DESC
LIMIT 3
RETURN q",Simple Aggregation Queries,stackoverflow2,False,False,True,
Identify the 3 users who have asked questions with the least views.,"MATCH (u:User)-[:ASKED]->(q:Question)
RETURN u.display_name AS user, MIN(q.view_count) AS min_views
ORDER BY min_views ASC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the tags associated with the 3 questions having the most comments.,"MATCH (q:Question)
WITH q, size((:Comment)-[:COMMENTED_ON]->(q)) AS commentCount
ORDER BY commentCount DESC
LIMIT 3
MATCH (q)-[:TAGGED]->(t:Tag)
RETURN t.name AS TagName",Simple Aggregation Queries,stackoverflow2,False,False,True,
What are the top 3 tags used in the most viewed questions?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
RETURN t.name, sum(q.view_count) AS total_views
ORDER BY total_views DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
Who are the users who commented on the top 3 highest scoring comments?,"MATCH (u:User)-[:COMMENTED]->(c:Comment)-[:COMMENTED_ON]->(:Question)
WITH c, u
ORDER BY c.score DESC
LIMIT 3
RETURN DISTINCT u",Simple Aggregation Queries,stackoverflow2,False,False,True,
Who has commented the most on questions tagged with 'neo4j'?,"MATCH (u:User)-[:COMMENTED]->(c:Comment)-[:COMMENTED_ON]->(q:Question)-[:TAGGED]->(t:Tag {name: 'neo4j'})
WITH u, count(c) AS commentsCount
RETURN u.display_name AS user, commentsCount
ORDER BY commentsCount DESC
LIMIT 1",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the top 5 questions asked by 'Mohammed Faraz ali'.,"MATCH (u:User {display_name: 'Mohammed Faraz ali'})-[:ASKED]->(q:Question)
RETURN q
ORDER BY q.creation_date DESC
LIMIT 5",Simple Aggregation Queries,stackoverflow2,True,False,False,
List the 3 questions with the highest answer scores.,"MATCH (q:Question)<-[:ANSWERED]-(a:Answer)
RETURN q.title, q.link, sum(a.score) AS totalScore
ORDER BY totalScore DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the top 3 users who asked questions with accepted answers.,"MATCH (u:User)-[:ASKED]->(q:Question)
WHERE q.accepted_answer_id IS NOT NULL
RETURN u.display_name, count(q) AS questions_with_accepted_answers
ORDER BY questions_with_accepted_answers DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
What are the top 3 longest body_markdown contents in answers?,"MATCH (a:Answer)
RETURN a.body_markdown, a.uuid
ORDER BY length(a.body_markdown) DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,False,
"For the top 5 questions by view count, list their creation dates.","MATCH (q:Question)
RETURN q.creation_date
ORDER BY q.view_count DESC
LIMIT 5",Simple Aggregation Queries,stackoverflow2,False,False,False,
Which users have commented on the most number of different questions?,"MATCH (u:User)-[:COMMENTED]->(c:Comment)-[:COMMENTED_ON]->(q:Question)
WITH u, COUNT(DISTINCT q) AS numQuestions
ORDER BY numQuestions DESC
RETURN u.display_name, numQuestions",Simple Aggregation Queries,stackoverflow2,False,False,True,
What are the top 3 questions with the most accepted answers?,"MATCH (q:Question)
WHERE q.accepted_answer_id IS NOT NULL
RETURN q
ORDER BY q.answer_count DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the 3 most recent comments made on questions.,"MATCH (c:Comment)-[:COMMENTED_ON]->(:Question)
RETURN c
ORDER BY c.uuid DESC
LIMIT 3",Simple Aggregation Queries,stackoverflow2,False,False,True,
What are the top 5 questions with the most unique tags?,"MATCH (q:Question)-[:TAGGED]->(t:Tag)
WITH q, count(DISTINCT t) AS uniqueTags
ORDER BY uniqueTags DESC
LIMIT 5
RETURN q",Simple Aggregation Queries,stackoverflow2,False,True,False,
Which questions have the highest number of comments and what are their tags?,"MATCH (q:Question)
WITH q, count{(q)<-[:COMMENTED_ON]-(:Comment)} AS commentCount
ORDER BY commentCount DESC
LIMIT 1
MATCH (q)-[:TAGGED]->(t:Tag)
RETURN q.title, q.link, collect(t.name) AS tags, commentCount",Simple Aggregation Queries,stackoverflow2,False,False,True,
List the 3 oldest teams based on creation date linked to streams.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
RETURN t
ORDER BY t.createdAt ASC
LIMIT 3",Pathfinding Queries,twitch,False,False,True,
List the URLs of the 3 newest streams in the database.,"MATCH (s:Stream)
RETURN s.url
ORDER BY s.createdAt DESC
LIMIT 3",Pathfinding Queries,twitch,False,False,True,
Show the 3 streams that have the longest descriptions.,"MATCH (s:Stream)
WHERE s.description IS NOT NULL
RETURN s
ORDER BY length(s.description) DESC
LIMIT 3",Pathfinding Queries,twitch,False,False,True,
Identify streams with more than 5 million total views that play 'VALORANT'.,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'VALORANT'})
WHERE s.total_view_count > 5000000
RETURN s",Pathfinding Queries,twitch,False,False,True,
What are the top 5 games played by streams created before 2015?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.createdAt < datetime('2015-01-01T00:00:00Z')
RETURN g.name, count(s) AS streams_count
ORDER BY streams_count DESC
LIMIT 5",Pathfinding Queries,twitch,False,False,True,
Which users are VIPs for the stream with the highest follower count?,"MATCH (s:Stream)
WHERE s.followers IS NOT NULL
WITH s ORDER BY s.followers DESC LIMIT 1
MATCH (u:User)-[:VIP]->(s)
RETURN u",Pathfinding Queries,twitch,False,True,False,
Which streams have a moderator named 'itsbigchase'?,"MATCH (s:Stream)-[:MODERATOR]->(u:User {name: 'itsbigchase'})
RETURN s",Pathfinding Queries,twitch,False,False,True,
Find the top 5 streams where the streamer plays 'Just Chatting'.,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Just Chatting'})
RETURN s
ORDER BY s.followers DESC
LIMIT 5",Pathfinding Queries,twitch,False,False,True,
Identify the 3 streams with the most user moderators.,"MATCH (s:Stream)-[:MODERATOR]->(u:User)
WITH s, count(u) AS moderatorCount
ORDER BY moderatorCount DESC
LIMIT 3
RETURN s.id AS StreamID, s.name AS StreamName, moderatorCount",Pathfinding Queries,twitch,False,False,True,
List the streams that have moderators who are also VIPs in other streams.,"MATCH (s:Stream)-[:MODERATOR]->(m:User)
WHERE exists {
  MATCH (m)-[:VIP]->(:Stream)
}
RETURN s",Pathfinding Queries,twitch,False,False,True,
What are the names of the 3 users who chatter the most across different streams?,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(DISTINCT s) AS distinct_streams_chatted
ORDER BY distinct_streams_chatted DESC
LIMIT 3
RETURN u.name AS user_name, distinct_streams_chatted",Pathfinding Queries,twitch,False,False,True,
Show the top 3 teams by the number of streams they are associated with.,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
WITH t, count(s) AS streamCount
ORDER BY streamCount DESC
LIMIT 3
RETURN t.name, streamCount",Pathfinding Queries,twitch,False,False,True,
Which streams are linked to a team named 'ESO Stream Team'?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
RETURN s",Pathfinding Queries,twitch,True,False,False,
Which streams have the most chatters? List the top 5.,"MATCH (s:Stream)
WITH s, count{(s)-[:CHATTER]->()} AS chatterCount
ORDER BY chatterCount DESC
LIMIT 5
RETURN s.id AS StreamID, s.name AS StreamName, chatterCount",Pathfinding Queries,twitch,False,False,True,
Show streams that feature more than 3 games.,"MATCH (s:Stream)
WITH s, count{(s)-[:PLAYS]->(:Game)} AS gamesCount
WHERE gamesCount > 3
RETURN s",Pathfinding Queries,twitch,False,False,False,
Find 3 teams that have been associated with streams since before 2017.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE s.createdAt < datetime('2017-01-01T00:00:00Z')
RETURN t
LIMIT 3",Pathfinding Queries,twitch,False,False,True,
Find the 3 streams with the newest creation dates.,"MATCH (s:Stream)
RETURN s
ORDER BY s.createdAt DESC
LIMIT 3",Pathfinding Queries,twitch,False,False,False,
Which users are chatters in more than 3 different streams? List the top 5.,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(DISTINCT s) AS streams_count
WHERE streams_count > 3
RETURN u.name, streams_count
ORDER BY streams_count DESC
LIMIT 5",Pathfinding Queries,twitch,False,False,True,
Find the streams with the most unique games played.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH s, COUNT(DISTINCT g) AS uniqueGames
ORDER BY uniqueGames DESC
RETURN s, uniqueGames",Pathfinding Queries,twitch,False,False,False,
Find out which 3 games are most frequently associated with streams having a 'VIP' relationship.,"MATCH (s:Stream)-[:VIP]->(:User)-[:PLAYS]->(g:Game)
WITH g, count(*) AS vipCount
ORDER BY vipCount DESC
LIMIT 3
RETURN g.name AS Game, vipCount",Pathfinding Queries,twitch,False,False,True,
Show the streams that have been moderated by a user more than once.,"MATCH (s:Stream)-[r:MODERATOR]->(u:User)
WITH s, count(r) AS timesModerated
WHERE timesModerated > 1
RETURN s",Pathfinding Queries,twitch,False,False,True,
Which streams have the most 'CHATTER' relationships? List the top 5.,"MATCH (s:Stream)
WITH s, count{(s)-[:CHATTER]->()} AS chatterCount
ORDER BY chatterCount DESC
LIMIT 5
RETURN s.id AS StreamID, s.name AS StreamName, chatterCount",Pathfinding Queries,twitch,True,False,False,
Find the 3 streams that have a 'CHATTER' relationship with users who are not streamers.,"MATCH (s:Stream)-[:CHATTER]->(u:User)
WHERE NOT EXISTS { (u)-[:STREAMER]->() }
RETURN s
LIMIT 3",Pathfinding Queries,twitch,False,False,True,STREAMER
List the streams with the highest number of chatters who are also streamers.,"MATCH (s:Stream)
WHERE exists {
  (s)-[:CHATTER]->(:Stream)
}
RETURN s, count{(s)-[:CHATTER]->(:Stream)} AS streamerChatters
ORDER BY streamerChatters DESC",Pathfinding Queries,twitch,False,False,True,
Show the streams that have more than 2 languages associated with them.,"MATCH (s:Stream)
WHERE size{(s)-[:HAS_LANGUAGE]->(:Language)} > 2
RETURN s",Pathfinding Queries,twitch,False,False,True,
Identify the top 3 games played by streams with a description containing 'hilarious moments'.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.description CONTAINS 'hilarious moments'
RETURN g.name, count(s) AS streams_count
ORDER BY streams_count DESC
LIMIT 3",Pathfinding Queries,twitch,False,False,True,
Which streams have a user named 'itsbigchase' as a VIP?,"MATCH (u:User {name: 'itsbigchase'})-[:VIP]->(s:Stream)
RETURN s",Pathfinding Queries,twitch,False,False,True,
List the top 5 users who are moderators for the most streams.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS moderated_streams
ORDER BY moderated_streams DESC
LIMIT 5
RETURN u.name, moderated_streams",Pathfinding Queries,twitch,False,False,True,
Which streams have both a 'MODERATOR' and a 'VIP' relationship with the same user?,"MATCH (s:Stream)-[:MODERATOR]->(u:User), (s)-[:VIP]->(u)
RETURN s, u",Pathfinding Queries,twitch,False,True,False,
Display streams that have a language set to 'en' and were created before 2012.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
WHERE s.createdAt < datetime('2012-01-01T00:00:00Z')
RETURN s",Pathfinding Queries,twitch,False,False,True,
Find the streams where the streamer has more than 1 million followers and plays 'Rust'.,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
WHERE s.followers > 1000000
RETURN s",Pathfinding Queries,twitch,False,False,True,
list the top 3 streams with the highest number of VIP relationships.,"MATCH (s:Stream)
WITH s, count{(s)-[:VIP]->()} AS vipCount
ORDER BY vipCount DESC
LIMIT 3
RETURN s.id AS StreamID, s.name AS StreamName, vipCount",Pathfinding Queries,twitch,False,False,True,
Show the streams that have the highest number of different games played.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH s, count(DISTINCT g) AS gamesCount
ORDER BY gamesCount DESC
RETURN s, gamesCount
LIMIT 1",Pathfinding Queries,twitch,False,False,True,
Find streams that have at least 3 languages associated with them.,"MATCH (s:Stream)
WHERE size{(s)-[:HAS_LANGUAGE]->(:Language)} >= 3
RETURN s",Pathfinding Queries,twitch,False,False,True,
List the 3 games most frequently played by streams with VIP users.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE exists {
  (s)-[:VIP]->(:User)
}
RETURN g.name, count(s) AS frequency
ORDER BY frequency DESC
LIMIT 3",Pathfinding Queries,twitch,False,False,True,
What are the URLs for streams that are part of teams created in 2020?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt >= datetime('2020-01-01T00:00:00Z') AND t.createdAt <= datetime('2020-12-31T23:59:59Z')
RETURN s.url AS StreamURL",Simple Aggregation Queries,twitch,False,False,True,
Identify 3 users who are VIPs for streams with a total view count over 1 million.,"MATCH (u:User)-[:VIP]->(s:Stream)
WHERE s.total_view_count > 1000000
RETURN u
LIMIT 3",Pathfinding Queries,twitch,False,False,True,
Find the streams by 'itsbigchase' and list their games.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.name = 'itsbigchase'
RETURN s.id, g.name",Simple Aggregation Queries,twitch,False,False,True,
What are the follower counts for streams named 'summit1g'?,"MATCH (s:Stream {name: 'summit1g'})
RETURN s.followers",Simple Aggregation Queries,twitch,False,False,True,
List streams that have a total view count greater than 500 million.,"MATCH (s:Stream)
WHERE s.total_view_count > 500000000
RETURN s",Simple Aggregation Queries,twitch,False,False,True,
How many users are chatters in more than one stream?,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(DISTINCT s) AS streams_count
WHERE streams_count > 1
RETURN count(u) AS users_with_multiple_streams",Simple Aggregation Queries,twitch,False,False,True,
Which teams were created before 2015?,"MATCH (t:Team)
WHERE t.createdAt < datetime('2015-01-01T00:00:00Z')
RETURN t",Simple Aggregation Queries,twitch,False,False,True,
What are the descriptions of the streams with the least followers?,"MATCH (s:Stream)
WHERE s.followers IS NOT NULL
RETURN s.description
ORDER BY s.followers ASC
LIMIT 1",Simple Aggregation Queries,twitch,False,False,True,
List the top 5 streams based on their creation date.,"MATCH (s:Stream)
RETURN s
ORDER BY s.createdAt DESC
LIMIT 5",Simple Aggregation Queries,twitch,False,False,True,
What are the names of users who are both moderators and VIPs in any stream?,"MATCH (u:User)-[:MODERATOR]->(:Stream)
WHERE exists {
  (u)-[:VIP]->(:Stream)
}
RETURN DISTINCT u.name",Simple Aggregation Queries,twitch,False,False,True,
Find 3 languages spoken in streams with the highest number of followers.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
RETURN l.name, sum(s.followers) AS total_followers
ORDER BY total_followers DESC
LIMIT 3",Simple Aggregation Queries,twitch,False,False,True,
Which games are played by the oldest streams in the database?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.createdAt IS NOT NULL
RETURN g.name AS Game, s.createdAt AS StreamCreationDate
ORDER BY s.createdAt ASC
LIMIT 1",Simple Aggregation Queries,twitch,False,False,True,
How many streams are part of the 'ESO Stream Team'?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
RETURN count(s) AS NumberOfStreams",Simple Aggregation Queries,twitch,False,False,True,
Which users are VIPs in the stream named 'itsbigchase'?,"MATCH (s:Stream {name: 'itsbigchase'})<-[:VIP]-(u:User)
RETURN u",Simple Aggregation Queries,twitch,False,False,True,
Show the 3 streams with the least followers.,"MATCH (s:Stream)
RETURN s
ORDER BY s.followers ASC
LIMIT 3",Pathfinding Queries,twitch,False,False,True,
What are the names of streams that play 'Grand Theft Auto V' and have English as their language?,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Grand Theft Auto V'}),
      (s)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
RETURN s.name AS StreamName",Simple Aggregation Queries,twitch,False,False,True,
List the streams that have more than 5 million followers.,"MATCH (s:Stream)
WHERE s.followers > 5000000
RETURN s",Simple Aggregation Queries,twitch,False,False,True,
What are the total view counts for streams that have moderators?,"MATCH (s:Stream)
WHERE exists{(s)-[:MODERATOR]->()}
RETURN sum(s.total_view_count) AS totalViewCountForModeratedStreams",Simple Aggregation Queries,twitch,False,False,True,
List the names of users who are VIPs in more than 3 streams.,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(s) AS vipCount
WHERE vipCount > 3
RETURN u.name AS UserName",Simple Aggregation Queries,twitch,False,False,True,
Which streams have chatters that are also streams?,"MATCH (s:Stream)-[:CHATTER]->(chatter:Stream)
RETURN s, chatter",Simple Aggregation Queries,twitch,False,False,True,
Name the games played by streams that have a follower count over 2 million.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers > 2000000
RETURN DISTINCT g.name",Simple Aggregation Queries,twitch,False,False,True,
"Which streams have a language set to 'ru' and more than 20,000 followers?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'ru'})
WHERE s.followers > 20000
RETURN s",Pathfinding Queries,twitch,False,False,True,
List the games played by streams that have a description containing 'game play'.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.description CONTAINS 'game play'
RETURN g.name AS GameName",Pathfinding Queries,twitch,False,False,True,
What are the top 5 streams by total view count that also have a team?,"MATCH (s:Stream)-[:HAS_TEAM]->(:Team)
WHERE s.total_view_count IS NOT NULL
RETURN s
ORDER BY s.total_view_count DESC
LIMIT 5",Pathfinding Queries,twitch,False,False,True,
"List the streams that have VIP users with less than 10,000 followers.","MATCH (s:Stream)-[:VIP]->(u:User)
WHERE u.followers < 10000
RETURN s",Pathfinding Queries,twitch,False,False,True,
Which streams are part of a team created after 2015?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt > datetime('2015-01-01T00:00:00Z')
RETURN s",Pathfinding Queries,twitch,False,False,True,
Show 3 streams that were created before 2010.,"MATCH (s:Stream)
WHERE s.createdAt < datetime('2010-01-01T00:00:00Z')
RETURN s
LIMIT 3",Pathfinding Queries,twitch,False,False,True,
Display the top 5 streams that play the game 'Rust'.,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
RETURN s
ORDER BY s.followers DESC
LIMIT 5",Pathfinding Queries,twitch,False,False,False,
Show the top 3 streams with the most moderators.,"MATCH (s:Stream)-[:MODERATOR]->(m)
WITH s, count(m) AS moderator_count
ORDER BY moderator_count DESC
LIMIT 3
RETURN s.id AS StreamID, s.name AS StreamName, moderator_count",Pathfinding Queries,twitch,False,False,True,
Which users are moderators for more than one stream? List the top 3.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS streams_count
WHERE streams_count > 1
RETURN u.name, streams_count
ORDER BY streams_count DESC
LIMIT 3",Pathfinding Queries,twitch,False,False,True,
What are the top 3 most common languages used by streams?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
RETURN l.name AS Language, count(s) AS StreamCount
ORDER BY StreamCount DESC
LIMIT 3",Pathfinding Queries,twitch,False,False,True,
"Identify 3 games most played by streams with more than 100,000 followers.","MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers > 100000
RETURN g.name, count(s) AS streams_count
ORDER BY streams_count DESC
LIMIT 3",Pathfinding Queries,twitch,False,False,True,
Which streams have a total view count greater than 10 million?,"MATCH (s:Stream)
WHERE s.total_view_count > 10000000
RETURN s",Pathfinding Queries,twitch,False,False,True,
List the top 5 streams with the highest follower count.,"MATCH (s:Stream)
RETURN s
ORDER BY s.followers DESC
LIMIT 5",Pathfinding Queries,twitch,False,False,True,
What are the names of streams with the oldest creation dates and their associated games?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
RETURN s.name AS StreamName, g.name AS GameName
ORDER BY s.createdAt ASC
LIMIT 1",Simple Aggregation Queries,twitch,False,False,True,
"How many streams have the language 'de' and more than 10,000 followers?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'de'})
WHERE s.followers > 10000
RETURN count(s) AS NumberOfStreams",Simple Aggregation Queries,twitch,False,False,True,
List the top 3 teams by the number of associated streams.,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
WITH t, count(s) AS streamCount
ORDER BY streamCount DESC
LIMIT 3
RETURN t.name, streamCount",Simple Aggregation Queries,twitch,False,False,True,
"Find the streams that have 'en' as their language and more than 500,000 followers.","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
WHERE s.followers > 500000
RETURN s",Pathfinding Queries,twitch,False,False,True,
List the top 5 languages spoken by streams with a moderator relationship.,"MATCH (s:Stream)-[:MODERATOR]->(:User)
WITH s
MATCH (s)-[:HAS_LANGUAGE]->(l:Language)
RETURN l.name, count(s) AS streams_count
ORDER BY streams_count DESC
LIMIT 5",Pathfinding Queries,twitch,False,False,True,
Identify the streams where 'itsbigchase' is both a moderator and VIP.,"MATCH (u:User {name: 'itsbigchase'})
MATCH (s:Stream)-[:MODERATOR]->(u)
WHERE exists{ (s)-[:VIP]->(u) }
RETURN s",Pathfinding Queries,twitch,False,False,True,
Which streams have the highest number of unique games played?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH s, COUNT(DISTINCT g) AS uniqueGames
RETURN s.id, s.name, uniqueGames
ORDER BY uniqueGames DESC",Pathfinding Queries,twitch,False,False,True,
What are the names of the top 5 users who are moderators in streams that have more than 1 million total views?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WHERE s.total_view_count > 1000000
RETURN u.name
ORDER BY u.followers DESC
LIMIT 5",Complex Aggregation Queries,twitch,False,False,True,
List the names of games played by streams that have chatters also listed as VIPs.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE exists {
  (s)-[:CHATTER]->(u:User)
  WHERE exists {
    (u)-[:VIP]->(s)
  }
}
RETURN DISTINCT g.name",Complex Aggregation Queries,twitch,False,False,True,
Which teams are associated with more than three different streams?,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
WITH t, count(DISTINCT s) AS streamCount
WHERE streamCount > 3
RETURN t",Complex Aggregation Queries,twitch,False,False,True,
"What are the names of streams that have the language 'en' and more than 50,000 followers?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
WHERE s.followers > 50000
RETURN s.name",Complex Aggregation Queries,twitch,False,False,True,
List the names of the top 5 users who are VIPs in the most number of different streams.,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(DISTINCT s) AS vipCount
ORDER BY vipCount DESC
LIMIT 5
RETURN u.name AS UserName, vipCount",Complex Aggregation Queries,twitch,False,False,True,
Which streams have been created after 2018 and are part of a team created before 2015?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE s.createdAt > datetime('2018-01-01T00:00:00Z') AND t.createdAt < datetime('2015-01-01T00:00:00Z')
RETURN s",Complex Aggregation Queries,twitch,False,False,True,
"What are the names of streams that play the game 'Rust' and have more than 100,000 followers?","MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
WHERE s.followers > 100000
RETURN s.name",Complex Aggregation Queries,twitch,False,False,True,
Name the top 3 users who are moderators for more than one stream.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS streams_count
WHERE streams_count > 1
RETURN u.name, streams_count
ORDER BY streams_count DESC
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
Which languages are used by streams that have more than 1 million total views?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.total_view_count > 1000000
RETURN DISTINCT l.name",Complex Aggregation Queries,twitch,False,False,True,
"List the names of the top 3 games most frequently played by streams with over 500,000 followers.","MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers > 500000
RETURN g.name, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
Which streams have a total view count greater than 5 million but less than 10 million?,"MATCH (s:Stream)
WHERE s.total_view_count > 5000000 AND s.total_view_count < 10000000
RETURN s",Complex Aggregation Queries,twitch,False,False,True,
What are the names of the top 5 streams with the highest follower counts?,"MATCH (s:Stream)
RETURN s.name AS StreamName, s.followers AS Followers
ORDER BY s.followers DESC
LIMIT 5",Complex Aggregation Queries,twitch,False,False,False,
List the streams with the most distinct teams associated.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WITH s, count(DISTINCT t) AS teamCount
ORDER BY teamCount DESC
RETURN s.id, s.name, teamCount",Pathfinding Queries,twitch,False,False,True,
Show the streams that have the most distinct languages.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH s, COUNT(DISTINCT l) AS num_languages
ORDER BY num_languages DESC
RETURN s, num_languages
LIMIT 1",Pathfinding Queries,twitch,False,True,False,
Which streams have the most distinct games played? List the top 5.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH s, COUNT(DISTINCT g) AS gamesCount
ORDER BY gamesCount DESC
LIMIT 5
RETURN s.id AS StreamID, s.name AS StreamName, gamesCount",Pathfinding Queries,twitch,False,False,False,
Which streams have a total view count of between 1 million and 2 million and are moderated by at least three different users?,"MATCH (s:Stream)-[:MODERATOR]->(u:User)
WHERE s.total_view_count >= 1000000 AND s.total_view_count <= 2000000
WITH s, count(DISTINCT u) AS moderatorCount
WHERE moderatorCount >= 3
RETURN s",Complex Aggregation Queries,twitch,False,False,True,
Find the streams with the most user chatters.,"MATCH (s:Stream)
WITH s, count{(s)-[:CHATTER]->(:User)} AS userChatters
ORDER BY userChatters DESC
RETURN s, userChatters",Pathfinding Queries,twitch,False,False,True,
List the names of the top 3 streams that have the most chatters.,"MATCH (s:Stream)
WITH s, count{(s)-[:CHATTER]->()} AS chatterCount
ORDER BY chatterCount DESC
LIMIT 3
RETURN s.name AS StreamName, chatterCount",Complex Aggregation Queries,twitch,False,False,True,
Which streams have chatters who are also moderators in other streams?,"MATCH (s:Stream)-[:CHATTER]->(u:User)
WHERE exists {
  MATCH (u)-[:MODERATOR]->(:Stream)
}
RETURN s",Complex Aggregation Queries,twitch,False,False,True,
Which streams are moderated by users who are also VIPs in the same stream?,"MATCH (s:Stream)-[:MODERATOR]->(u:User)-[:VIP]->(s)
RETURN s",Complex Aggregation Queries,twitch,False,False,False,
Which users are moderators in more than one stream?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS streams_count
WHERE streams_count > 1
RETURN u.name, streams_count",Simple Aggregation Queries,twitch,True,False,False,
List the names of teams that have been involved with streams that play 'Just Chatting' and have total views over 1 million.,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Just Chatting'})
WHERE s.total_view_count > 1000000
MATCH (s)-[:HAS_TEAM]->(t:Team)
RETURN DISTINCT t.name",Complex Aggregation Queries,twitch,False,False,True,
Name the top 3 users who are moderators in the stream with the highest follower count.,"MATCH (s:Stream)
WHERE s.followers IS NOT NULL
WITH s
ORDER BY s.followers DESC
LIMIT 1
MATCH (u:User)-[:MODERATOR]->(s)
RETURN u.name
ORDER BY u.followers DESC
LIMIT 3",Complex Aggregation Queries,twitch,False,False,False,
"Which streams have a user named 'tranth' as a VIP and have more than 10,000 followers?","MATCH (s:Stream)-[:VIP]->(u:User {name: 'tranth'})
WHERE s.followers > 10000
RETURN s",Complex Aggregation Queries,twitch,False,False,True,
List the streams that have the same game played by both itsbigchase and 9linda.,"MATCH (u1:User {name: 'itsbigchase'})-[:PLAYS]->(g:Game)<-[:PLAYS]-(u2:User {name: '9linda'})
MATCH (s:Stream)-[:PLAYS]->(g)
RETURN s",Complex Aggregation Queries,twitch,False,False,True,
Name the top 5 users who have chatted in more than three streams.,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(DISTINCT s) AS streams_chatted_in
WHERE streams_chatted_in > 3
RETURN u.name AS user_name, streams_chatted_in
ORDER BY streams_chatted_in DESC
LIMIT 5",Complex Aggregation Queries,twitch,False,False,True,
Which streams created in 2020 have users who are both moderators and VIPs?,"MATCH (s:Stream)-[:MODERATOR]->(u:User), (s)-[:VIP]->(u)
WHERE s.createdAt >= datetime('2020-01-01T00:00:00Z') AND s.createdAt <= datetime('2020-12-31T23:59:59Z')
RETURN s, u",Complex Aggregation Queries,twitch,False,False,True,
"List the streams that have chatters with the name 'itsbigchase' and more than 100,000 total views.","MATCH (s:Stream)-[:CHATTER]->(u:User {name: 'itsbigchase'})
WHERE u.total_view_count > 100000
RETURN s",Complex Aggregation Queries,twitch,False,False,True,
Name the top 3 games played by streams that also have chatters who are VIPs.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE exists {
  MATCH (s)-[:CHATTER]->(u:User)-[:VIP]->(s)
}
RETURN g.name, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
Which streams have users named 'gonsabellla' as a VIP?,"MATCH (u:User {name: 'gonsabellla'})-[:VIP]->(s:Stream)
RETURN s",Complex Aggregation Queries,twitch,False,False,True,
"List the names of the top 3 teams associated with streams that have more than 500,000 total views.","MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE s.total_view_count > 500000
RETURN t.name
ORDER BY s.total_view_count DESC
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
Name the streams that are VIPs in the stream named 'itsbigchase'.,"MATCH (s:Stream {name: 'itsbigchase'})-[:VIP]->(vipStream:Stream)
RETURN vipStream.name",Complex Aggregation Queries,twitch,False,False,True,
Which games are played by streams that have at least two different languages associated with them?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE size{(s)-[:HAS_LANGUAGE]->(:Language)} >= 2
RETURN DISTINCT g.name",Complex Aggregation Queries,twitch,False,False,True,
List the top 5 streams by total view count that have a team associated with them.,"MATCH (s:Stream)-[:HAS_TEAM]->(:Team)
RETURN s
ORDER BY s.total_view_count DESC
LIMIT 5",Complex Aggregation Queries,twitch,False,False,True,
Name the streams that have a user named 'itsbigchase' as a moderator.,"MATCH (s:Stream)-[:MODERATOR]->(u:User {name: 'itsbigchase'})
RETURN s.name",Complex Aggregation Queries,twitch,False,False,True,
List the top 5 streams by number of games played.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH s, count(g) AS games_played
ORDER BY games_played DESC
LIMIT 5
RETURN s.id AS StreamID, s.name AS StreamName, games_played",Pathfinding Queries,twitch,False,False,True,
Show the 3 newest teams associated with streams.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
RETURN t
ORDER BY t.createdAt DESC
LIMIT 3",Pathfinding Queries,twitch,True,False,False,
Which streams have a team created before 2015?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt < datetime('2015-01-01T00:00:00Z')
RETURN s",Pathfinding Queries,twitch,False,False,True,
Identify the streams with the most followers who play 'Rust'.,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
RETURN s
ORDER BY s.followers DESC",Pathfinding Queries,twitch,False,False,True,
List the 3 newest games introduced to streams.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
RETURN g.name AS Game, g.createdAt AS Introduced
ORDER BY g.createdAt DESC
LIMIT 3",Pathfinding Queries,twitch,False,False,True,Game.createdAt
Show the top 3 streams that have been followed by more than 2 million users.,"MATCH (s:Stream)
WHERE s.followers > 2000000
RETURN s
ORDER BY s.followers DESC
LIMIT 3",Pathfinding Queries,twitch,True,False,False,
Which streams have the most distinct moderators? List the top 5.,"MATCH (s:Stream)-[:MODERATOR]->(m)
WITH s, count(DISTINCT m) AS moderator_count
ORDER BY moderator_count DESC
LIMIT 5
RETURN s.id AS StreamID, s.name AS StreamName, moderator_count",Pathfinding Queries,twitch,False,False,True,
Identify the streams with more than 3 VIP users.,"MATCH (s:Stream)-[:VIP]->(u:User)
WITH s, count(u) AS vipCount
WHERE vipCount > 3
RETURN s",Pathfinding Queries,twitch,False,False,True,
Find the top 5 streams that have been active the longest based on the creation date.,"MATCH (s:Stream)
RETURN s
ORDER BY s.createdAt ASC
LIMIT 5",Pathfinding Queries,twitch,False,False,True,
List the 3 streams with the highest number of games played.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH s, count(g) AS gamesCount
ORDER BY gamesCount DESC
LIMIT 3
RETURN s.id AS StreamID, s.name AS StreamName, gamesCount",Pathfinding Queries,twitch,False,False,False,
Show the top 5 users who are VIPs in the most streams.,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(s) AS vipCount
ORDER BY vipCount DESC
LIMIT 5
RETURN u.name, vipCount",Pathfinding Queries,twitch,False,False,True,
Which streams are part of a team with the most streams associated?,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
WITH t, count(s) AS streamCount
ORDER BY streamCount DESC
LIMIT 1
MATCH (s2:Stream)-[:HAS_TEAM]->(t)
RETURN s2",Pathfinding Queries,twitch,False,False,True,
"List the streams that play a game named 'Just Chatting' and have more than 100,000 followers.","MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Just Chatting'})
WHERE s.followers > 100000
RETURN s",Pathfinding Queries,twitch,False,False,True,
Which streams have a user as both a VIP and a MODERATOR?,"MATCH (s:Stream)
WHERE exists {
    (s)-[:VIP]->(u:User)
    AND exists {
        (s)-[:MODERATOR]->(u)
    }
}
RETURN s",Pathfinding Queries,twitch,False,False,False,
Find 3 streams with the most varied language settings.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH s, count(DISTINCT l) AS num_languages
ORDER BY num_languages DESC
LIMIT 3
RETURN s.id, s.name, num_languages",Pathfinding Queries,twitch,False,False,True,
Show the top 5 streams with the most user chatters.,"MATCH (s:Stream)-[:CHATTER]->(u:User)
WITH s, count(u) AS userChatters
ORDER BY userChatters DESC
LIMIT 5
RETURN s.id AS StreamID, s.name AS StreamName, userChatters",Pathfinding Queries,twitch,False,False,True,
List the 3 streams where the streamer has the longest ongoing stream based on the creation date.,"MATCH (s:Stream)
WHERE s.createdAt IS NOT NULL
RETURN s
ORDER BY s.createdAt
LIMIT 3",Pathfinding Queries,twitch,False,True,False,
Identify 5 streams where users are both VIPs and moderators.,"MATCH (s:Stream)
WHERE exists {
  (u:User)-[:VIP]->(s) AND (u)-[:MODERATOR]->(s)
}
RETURN s
LIMIT 5",Pathfinding Queries,twitch,False,False,False,
Show the streams with the most languages.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH s, count(l) AS num_languages
ORDER BY num_languages DESC
RETURN s, num_languages",Pathfinding Queries,twitch,False,False,True,
"List the streams that are moderated by users with more than 10,000 followers.","MATCH (s:Stream)-[:MODERATOR]->(u:User)
WHERE u.followers > 10000
RETURN s",Pathfinding Queries,twitch,False,False,True,
Find the 3 streams with the most distinct languages used.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH s, count(DISTINCT l) AS distinctLanguages
ORDER BY distinctLanguages DESC
LIMIT 3
RETURN s.id, s.name, distinctLanguages",Pathfinding Queries,twitch,False,False,True,
Which streams have a user named 'itsbigchase' as a moderator and a chatter?,"MATCH (s:Stream)-[:MODERATOR]->(u:User {name: 'itsbigchase'})
WHERE exists {
  (s)-[:CHATTER]->(:User {name: 'itsbigchase'})
}
RETURN s",Pathfinding Queries,twitch,False,False,True,
List the 3 streams with the most distinct users as VIPs.,"MATCH (s:Stream)-[:VIP]->(u:User)
WITH s, count(DISTINCT u) AS uniqueVips
ORDER BY uniqueVips DESC
LIMIT 3
RETURN s.id AS StreamID, s.name AS StreamName, uniqueVips",Pathfinding Queries,twitch,False,False,True,
Show the streams with the most distinct moderators.,"MATCH (s:Stream)-[:MODERATOR]->(m)
WITH s, count(DISTINCT m) AS moderatorCount
ORDER BY moderatorCount DESC
RETURN s, moderatorCount",Pathfinding Queries,twitch,False,False,True,
Which streams have the most languages? List the top 5.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH s, count(l) AS num_languages
ORDER BY num_languages DESC
LIMIT 5
RETURN s.id AS StreamID, s.name AS StreamName, num_languages",Pathfinding Queries,twitch,False,False,True,
Find the streams that have a user named 'itsbigchase' as a chatter and a VIP.,"MATCH (s:Stream)-[:CHATTER]->(u:User {name: 'itsbigchase'}),
      (s)-[:VIP]->(u)
RETURN s",Pathfinding Queries,twitch,True,False,False,
List the 3 streams with the most distinct teams associated.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WITH s, count(DISTINCT t) AS teamCount
ORDER BY teamCount DESC
LIMIT 3
RETURN s.id AS StreamID, s.name AS StreamName, teamCount",Pathfinding Queries,twitch,False,False,True,
Show the streams that have the most teams associated with them.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WITH s, count(t) AS teamCount
ORDER BY teamCount DESC
RETURN s, teamCount",Pathfinding Queries,twitch,False,False,True,
Identify the top 3 users who are chatters in the most streams.,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(s) AS streams_count
ORDER BY streams_count DESC
LIMIT 3
RETURN u.name, streams_count",Pathfinding Queries,twitch,False,False,False,
Find streams where the user 'itsbigchase' is both a moderator and a chatter.,"MATCH (u:User {name: 'itsbigchase'})
MATCH (s:Stream)
WHERE exists{(u)-[:MODERATOR]->(s)} AND exists{(u)-[:CHATTER]->(s)}
RETURN s",Pathfinding Queries,twitch,False,False,True,
List the top 5 streams that have the most user moderators.,"MATCH (s:Stream)-[:MODERATOR]->(u:User)
WITH s, count(u) AS moderatorCount
ORDER BY moderatorCount DESC
LIMIT 5
RETURN s.id AS StreamID, s.name AS StreamName, moderatorCount",Pathfinding Queries,twitch,False,False,False,
Find the 3 streams that have the most distinct games played.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH s, COUNT(DISTINCT g) AS gamesCount
ORDER BY gamesCount DESC
LIMIT 3
RETURN s, gamesCount",Pathfinding Queries,twitch,False,False,True,
List the top 5 streams that are part of the team with the newest creation date.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WITH t ORDER BY t.createdAt DESC LIMIT 1
MATCH (s:Stream)-[:HAS_TEAM]->(t)
RETURN s
ORDER BY s.followers DESC LIMIT 5",Pathfinding Queries,twitch,False,False,True,
Show the 3 streams with the most users as chatters.,"MATCH (s:Stream)
WITH s, count{(s)-[:CHATTER]->(:User)} AS chatterCount
ORDER BY chatterCount DESC
LIMIT 3
RETURN s, chatterCount",Pathfinding Queries,twitch,False,False,True,
Which streams have the most followers but fewer than 1 million total views?,"MATCH (s:Stream)
WHERE s.followers IS NOT NULL AND s.total_view_count < 1000000
RETURN s
ORDER BY s.followers DESC",Pathfinding Queries,twitch,False,False,True,
Identify the streams with the highest total view count that have a user moderator.,"MATCH (s:Stream)-[:MODERATOR]->(u:User)
RETURN s
ORDER BY s.total_view_count DESC
LIMIT 1",Pathfinding Queries,twitch,True,False,False,
List the 3 streams that have been followed by more than 1 million users.,"MATCH (s:Stream)
WHERE s.followers > 1000000
RETURN s
ORDER BY s.followers DESC
LIMIT 3",Pathfinding Queries,twitch,False,False,False,
Show the top 5 games played by streams with the most language diversity.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH g, count(DISTINCT (s)-[:HAS_LANGUAGE]->(:Language)) AS languageDiversity
ORDER BY languageDiversity DESC
LIMIT 5
RETURN g.name AS Game, languageDiversity",Pathfinding Queries,twitch,True,False,False,
Which streams have the highest number of user VIPs?,"MATCH (s:Stream)-[:VIP]->(u:User)
WITH s, count(u) AS vipCount
ORDER BY vipCount DESC
RETURN s, vipCount",Pathfinding Queries,twitch,False,False,True,
What are the URLs of the top 3 streams by total view count?,"MATCH (s:Stream)
RETURN s.url
ORDER BY s.total_view_count DESC
LIMIT 3",Simple Aggregation Queries,twitch,False,False,True,
List the first 5 streams that have been moderated by the same user for over 5 years.,"MATCH (u:User)-[r:MODERATOR]->(s:Stream)
WHERE duration.between(r.startDate, COALESCE(r.endDate, date())) >= duration('P5Y')
RETURN s
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,"MODERATOR.endDate, MODERATOR.startDate"
What are the names of the 3 newest teams in the database?,"MATCH (t:Team)
RETURN t.name
ORDER BY t.createdAt DESC
LIMIT 3",Simple Aggregation Queries,twitch,False,False,True,
List the first 5 streams where the game name and the stream name are the same.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.name = g.name
RETURN s
LIMIT 5",Simple Retrieval Queries,twitch,False,True,False,
"Who are the first 5 users who have been VIPs in streams with fewer than 10,000 followers?","MATCH (u:User)-[:VIP]->(s:Stream)
WHERE s.followers < 10000
RETURN u
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
What are the first 3 streams that have a user chatter who also has a moderator role in another stream?,"MATCH (s:Stream)-[:CHATTER]->(u:User)
WHERE exists {
    MATCH (u)-[:MODERATOR]->(:Stream)
}
RETURN s
LIMIT 3",Simple Retrieval Queries,twitch,True,False,False,
List the first 5 streams that have the most languages associated with them.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH s, count(l) AS num_languages
ORDER BY num_languages DESC
RETURN s.id, s.name, num_languages
LIMIT 5",Simple Retrieval Queries,twitch,False,False,False,
"Which streams have been moderated by users with the most followers, listing the top 3?","MATCH (u:User)-[:MODERATOR]->(s:Stream)
WHERE u.followers IS NOT NULL
RETURN s, u
ORDER BY u.followers DESC
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
Name the first 5 streams that have a game with the shortest name.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH g, LENGTH(g.name) AS nameLength
ORDER BY nameLength ASC
LIMIT 1
MATCH (s:Stream)-[:PLAYS]->(g)
RETURN s.name AS StreamName
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
"List the first 3 games that have been featured in streams with a team having over 1,000 followers.","MATCH (s:Stream)-[:PLAYS]->(g:Game), (s)-[:HAS_TEAM]->(t:Team)
WHERE t.followers > 1000
RETURN g.name AS GameName
LIMIT 3",Simple Retrieval Queries,twitch,False,False,False,Team.followers
What are the URLs of the first 3 streams with the most chatters?,"MATCH (s:Stream)
WHERE exists{ (s)-[:CHATTER]->(:Stream) OR (s)-[:CHATTER]->(:User) }
RETURN s.url
ORDER BY count{(s)-[:CHATTER]->()} DESC
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
Who are the first 5 moderators in streams that play 'VALORANT'?,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'VALORANT'})
MATCH (s)-[:MODERATOR]->(m)
RETURN m
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
List the first 5 streams that have been in the same language and game for over 5 years.,"MATCH (s:Stream)-[:PLAYS]->(g:Game), (s)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.createdAt <= datetime('2018-01-01T00:00:00Z')
RETURN s.id AS StreamID, s.name AS StreamName, g.name AS Game, l.name AS Language
ORDER BY s.createdAt
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
Which streams have the description mentioning 'enjoy' and list the first 3.,"MATCH (s:Stream)
WHERE s.description CONTAINS 'enjoy'
RETURN s
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
What are the first 5 streams that have a moderator with the same name as the stream's user?,"MATCH (s:Stream)-[:MODERATOR]->(m:User), (s)-[:CHATTER]->(u:User)
WHERE m.name = u.name
RETURN s
LIMIT 5",Simple Retrieval Queries,twitch,True,False,False,
Name the first 3 users who are chatters in the most streams with different games.,"MATCH (u:User)-[:CHATTER]->(s:Stream)-[:PLAYS]->(g:Game)
WITH u, count(DISTINCT g) AS gamesCount
ORDER BY gamesCount DESC
RETURN u.name
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
List the first 5 streams that have a team and a game that both have the letter 'E' in them.,"MATCH (s:Stream)-[:PLAYS]->(g:Game), (s)-[:HAS_TEAM]->(t:Team)
WHERE g.name CONTAINS 'E' AND t.name CONTAINS 'E'
RETURN s
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
Who are the first 3 VIPs in streams with the most languages spoken?,"MATCH (s:Stream)
WITH s, size((s)-[:HAS_LANGUAGE]->(:Language)) AS num_languages
ORDER BY num_languages DESC
LIMIT 1
MATCH (s)-[:VIP]->(vip:User)
RETURN vip
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
Which are the first 3 streams that have had a VIP relationship with the same user for over 3 years?,"MATCH (s:Stream)-[r:VIP]->(u:User)
WHERE duration.between(r.createdAt, datetime()).years >= 3
RETURN s
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,VIP.createdAt
"What are the first 5 streams that have been active for over 5 years and have over 100,000 followers?","MATCH (s:Stream)
WHERE s.createdAt <= datetime('2018-01-01T00:00:00Z') AND s.followers > 100000
RETURN s
ORDER BY s.createdAt
LIMIT 5",Simple Retrieval Queries,twitch,False,True,False,
Name the first 5 users who are VIPs in streams with descriptions mentioning 'fun'.,"MATCH (u:User)-[:VIP]->(s:Stream)
WHERE s.description CONTAINS 'fun'
RETURN u.name
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
Who are the first 3 moderators for the oldest stream?,"MATCH (s:Stream)
WITH s
ORDER BY s.createdAt ASC
LIMIT 1
MATCH (s)-[:MODERATOR]->(m)
RETURN m
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
Name the first 5 streams with the lowest follower count and still active.,"MATCH (s:Stream)
WHERE s.followers IS NOT NULL
RETURN s
ORDER BY s.followers ASC
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
What are the first 3 streams that are part of a team with the most streams?,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
WITH t, count(s) AS streamCount
ORDER BY streamCount DESC
LIMIT 1
MATCH (t)<-[:HAS_TEAM]-(topStream:Stream)
RETURN topStream
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
List the first 5 games with streams that have been active for over 10 years.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE duration.between(s.createdAt, datetime()).years > 10
RETURN g.name AS Game, count(s) AS StreamsCount
ORDER BY StreamsCount DESC
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
Who are the first 3 users who have VIP status in streams playing 'Rust'?,"MATCH (u:User)-[:VIP]->(s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
RETURN u
LIMIT 3",Simple Retrieval Queries,twitch,True,False,False,
Which are the first 5 streams that have more than one language associated with them?,"MATCH (s:Stream)
WHERE size{(s)-[:HAS_LANGUAGE]->(:Language)} > 1
RETURN s
LIMIT 5",Simple Retrieval Queries,twitch,True,False,False,
List the first 3 streams that have a game and team name starting with the same letter.,"MATCH (s:Stream)-[:PLAYS]->(g:Game), (s)-[:HAS_TEAM]->(t:Team)
WHERE g.name STARTS WITH substring(t.name, 0, 1)
RETURN s.id AS StreamID, s.name AS StreamName, g.name AS GameName, t.name AS TeamName
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
What are the top 3 streams by total view count that also have a team associated with them?,"MATCH (s:Stream)-[:HAS_TEAM]->(:Team)
RETURN s
ORDER BY s.total_view_count DESC
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
Who are the first 5 moderators in streams that have changed games at least twice?,"MATCH (s:Stream)-[:MODERATOR]->(m)
WITH s, m, count{(s)-[:PLAYS]->(:Game)} AS gameChanges
WHERE gameChanges >= 2
RETURN m
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
List the first 3 teams with the most streams playing 'Dota 2'.,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Dota 2'})
WITH s, count(s) AS streamCount
ORDER BY streamCount DESC
LIMIT 3
MATCH (s)-[:HAS_TEAM]->(t:Team)
RETURN t.name, streamCount",Simple Retrieval Queries,twitch,False,False,False,
"Which users are chatters in the most streams, listing the first 5.","MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(s) AS streams_count
ORDER BY streams_count DESC
LIMIT 5
RETURN u.name, streams_count",Simple Retrieval Queries,twitch,False,False,True,
Name the first 3 streams that have had the same game since creation and more than 5 million total views.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.createdAt = s.createdAt AND s.total_view_count > 5000000
RETURN s.name AS StreamName, g.name AS GameName
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
List the first 5 streams that have a description mentioning 'channel'.,"MATCH (s:Stream)
WHERE s.description CONTAINS 'channel'
RETURN s
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
Who are the first 5 users who are moderators in streams with over a million followers?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WHERE s.followers > 1000000
RETURN u
LIMIT 5",Simple Retrieval Queries,twitch,True,False,False,
What are the top 3 streams that have changed their language at least once?,"MATCH (s:Stream)-[r1:HAS_LANGUAGE]->(l1:Language)
WITH s, COUNT(DISTINCT l1) AS num_languages
WHERE num_languages > 1
RETURN s
ORDER BY s.createdAt DESC
LIMIT 3",Simple Retrieval Queries,twitch,False,False,False,
Which streams have no team associated and list the first 5.,"MATCH (s:Stream)
WHERE NOT EXISTS { (s)-[:HAS_TEAM]->(:Team) }
RETURN s
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
List the first 5 streams that have a game played by less than 10 other streams.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH g, count{(s)-[:PLAYS]->(g)} AS gameCount
WHERE gameCount < 10
RETURN s
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
List the first 3 games played by streams with the most moderators.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH s, count{(s)-[:MODERATOR]->()} AS moderatorCount
ORDER BY moderatorCount DESC
LIMIT 3
RETURN g.name AS Game, moderatorCount",Simple Retrieval Queries,twitch,True,False,False,
"Which streams have a follower count between 200,000 and 500,000, listing the first 5?","MATCH (s:Stream)
WHERE s.followers >= 200000 AND s.followers <= 500000
RETURN s
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
Who are the first 5 users who are chatters and VIPs in the same streams?,"MATCH (u:User)-[:CHATTER]->(s:Stream)<-[:VIP]-(u)
RETURN u
LIMIT 5",Simple Retrieval Queries,twitch,False,False,False,
What are the follower counts of streams that play 'Rust' and have 'en' as their language?,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
MATCH (s)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
RETURN s.name, s.followers",Complex Retrieval Queries,twitch,False,False,False,
Which users are VIPs for the stream with the highest follower count?,"MATCH (s:Stream)
WHERE s.followers IS NOT NULL
WITH s ORDER BY s.followers DESC LIMIT 1
MATCH (u:User)-[:VIP]->(s)
RETURN u",Complex Retrieval Queries,twitch,False,False,True,
List the streams that have more than one moderator.,"MATCH (s:Stream)-[:MODERATOR]->(m)
WITH s, count(m) AS moderatorCount
WHERE moderatorCount > 1
RETURN s",Complex Retrieval Queries,twitch,False,False,True,
What are the names of users who have moderated other users?,"MATCH (u:User)-[:MODERATOR]->(:User)
RETURN DISTINCT u.name AS ModeratorNames",Complex Retrieval Queries,twitch,False,False,True,
Which streams have no team associations?,"MATCH (s:Stream)
WHERE NOT EXISTS { (s)-[:HAS_TEAM]->(:Team) }
RETURN s",Complex Retrieval Queries,twitch,False,False,True,
What are the follower and view count details for streams with more than 3 moderators?,"MATCH (s:Stream)
WHERE size{(s)-[:MODERATOR]->()} > 3
RETURN s.id AS StreamID, s.name AS StreamName, s.followers AS Followers, s.total_view_count AS ViewCount",Complex Retrieval Queries,twitch,False,False,True,
Find the descriptions of streams that have chatted with the user '9linda'.,"MATCH (u:User {name: '9linda'})-[:CHATTER]->(s:Stream)
RETURN s.description AS StreamDescription",Complex Retrieval Queries,twitch,False,False,True,
Which teams were formed in 2020?,"MATCH (t:Team)
WHERE t.createdAt >= datetime('2020-01-01T00:00:00Z') AND t.createdAt <= datetime('2020-12-31T23:59:59Z')
RETURN t",Complex Retrieval Queries,twitch,False,False,False,
How many languages are associated with streams that have over 1 million total views?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.total_view_count > 1000000
RETURN COUNT(DISTINCT l) AS NumberOfLanguages",Complex Retrieval Queries,twitch,False,False,True,
List the games played by streams that have more than 5 VIP relationships.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE size{(s)-[:VIP]->()} > 5
RETURN g.name AS Game, count(s) AS NumberOfStreams",Complex Retrieval Queries,twitch,False,False,False,
What is the total view count of streams that are moderated by 'itsbigchase'?,"MATCH (u:User {name: 'itsbigchase'})-[:MODERATOR]->(s:Stream)
RETURN sum(s.total_view_count) AS totalViewCount",Complex Retrieval Queries,twitch,False,False,True,
"Which streams have the user 'creightonolsen' as a chatter and have more than 100,000 views?","MATCH (s:Stream)-[:CHATTER]->(u:User {name: 'creightonolsen'})
WHERE s.total_view_count > 100000
RETURN s",Complex Retrieval Queries,twitch,False,False,True,
List the streams where 'romandoduik' is a chatter.,"MATCH (u:User {name: 'romandoduik'})-[:CHATTER]->(s:Stream)
RETURN s",Complex Retrieval Queries,twitch,False,False,True,
Which users are moderators in streams that play 'Rust'?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
RETURN u",Complex Retrieval Queries,twitch,False,False,True,
How many streams has each team associated with them?,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
RETURN t.name AS TeamName, count(s) AS NumberOfStreams",Complex Retrieval Queries,twitch,False,False,True,
Identify streams that were created on or after 2018 and are part of teams.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE s.createdAt >= datetime('2018-01-01T00:00:00Z')
RETURN s, t",Complex Retrieval Queries,twitch,False,False,True,
"Which streams were created between 2015 and 2020 and have more than 100,000 followers?","MATCH (s:Stream)
WHERE s.createdAt >= datetime('2015-01-01T00:00:00Z') AND s.createdAt <= datetime('2020-12-31T23:59:59Z')
  AND s.followers > 100000
RETURN s",Complex Retrieval Queries,twitch,False,False,True,
"What are the first 3 languages spoken in streams with more than 10,000 followers?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 10000
RETURN DISTINCT l.name
LIMIT 3",Complex Retrieval Queries,twitch,False,False,True,
How many users are moderators for the stream 'itsbigchase'?,"MATCH (s:Stream {name: 'itsbigchase'})-[:MODERATOR]->(u:User)
RETURN count(u) AS ModeratorCount",Complex Retrieval Queries,twitch,False,False,True,
List the first 3 streams that have a moderator with a name starting with 'G'.,"MATCH (s:Stream)-[:MODERATOR]->(m:User)
WHERE m.name STARTS WITH 'G'
RETURN s
LIMIT 3",Simple Retrieval Queries,twitch,False,True,False,
Who are the first 5 users who have moderated streams with descriptions mentioning 'professional'?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WHERE s.description CONTAINS 'professional'
RETURN u
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
List the first 5 streams where the user and moderator have the same name.,"MATCH (s:Stream)-[:MODERATOR]->(u:User)
WHERE s.name = u.name
RETURN s
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
Which streams have a total view count of over 10 million?,"MATCH (s:Stream)
WHERE s.total_view_count > 10000000
RETURN s",Complex Retrieval Queries,twitch,False,False,True,
List the top 5 streams by follower count.,"MATCH (s:Stream)
RETURN s
ORDER BY s.followers DESC
LIMIT 5",Complex Retrieval Queries,twitch,False,False,True,
"What are the names of games played by streams with more than 100,000 followers?","MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers > 100000
RETURN DISTINCT g.name",Complex Retrieval Queries,twitch,False,False,True,
"Which users are moderators for streams with more than 500,000 total views?","MATCH (u:User)-[:MODERATOR]->(s:Stream)
WHERE s.total_view_count > 500000
RETURN u",Complex Retrieval Queries,twitch,False,False,True,
"Which streams with a description mentioning 'streaming' have the most followers, listing the first 5?","MATCH (s:Stream)
WHERE s.description CONTAINS 'streaming' AND s.followers IS NOT NULL
RETURN s
ORDER BY s.followers DESC
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
What are the descriptions of streams that play the game 'Rust'?,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
RETURN s.description AS StreamDescription",Complex Retrieval Queries,twitch,False,False,True,
List the names of all teams created before 2015.,"MATCH (t:Team)
WHERE t.createdAt < datetime('2015-01-01T00:00:00Z')
RETURN t.name",Complex Retrieval Queries,twitch,False,False,True,
Which streams are part of the 'ESO Stream Team'?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
RETURN s",Complex Retrieval Queries,twitch,False,False,True,
What are the URLs of the top 3 streams by total view count?,"MATCH (s:Stream)
RETURN s.url
ORDER BY s.total_view_count DESC
LIMIT 3",Complex Retrieval Queries,twitch,False,False,True,
Which users have chatted with more than 5 different streams?,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(DISTINCT s) AS distinctStreams
WHERE distinctStreams > 5
RETURN u",Complex Retrieval Queries,twitch,False,False,True,
List all users who are VIPs in at least two different streams.,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(DISTINCT s) AS vipCount
WHERE vipCount >= 2
RETURN u",Complex Retrieval Queries,twitch,False,False,True,
Find streams that have both 'MODERATOR' and 'VIP' relationships.,"MATCH (s:Stream)
WHERE exists{(s)-[:MODERATOR]->()} AND exists{(s)-[:VIP]->()}
RETURN s",Complex Retrieval Queries,twitch,False,False,True,
"Which games are played by streams that have a total view count greater than 500,000?","MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count > 500000
RETURN DISTINCT g.name",Complex Retrieval Queries,twitch,False,False,True,
Which streams have 'en' as their language and more than 1 million total views?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
WHERE s.total_view_count > 1000000
RETURN s",Complex Retrieval Queries,twitch,False,False,True,
How many streams are associated with the game 'Rust'?,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
RETURN count(s) AS RustStreamCount",Simple Aggregation Queries,twitch,False,False,True,
Who are the first 3 VIPs in streams with a total view count exceeding 10 million?,"MATCH (s:Stream)-[:VIP]->(vip:User)
WHERE s.total_view_count > 10000000
RETURN vip
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
What are the URLs of the first 3 streams with the most languages spoken?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH s, count(l) AS num_languages
ORDER BY num_languages DESC
LIMIT 3
RETURN s.url AS StreamURL",Simple Retrieval Queries,twitch,False,False,True,
Identify streams that have a creation date before 2010.,"MATCH (s:Stream)
WHERE s.createdAt < datetime('2010-01-01T00:00:00Z')
RETURN s",Complex Retrieval Queries,twitch,False,False,True,
"Which language is most commonly associated with streams that have more than 500,000 followers?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 500000
RETURN l.name, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 1",Complex Retrieval Queries,twitch,False,False,True,
What are the names of the first 5 streams created before 2010?,"MATCH (s:Stream)
WHERE s.createdAt < datetime('2010-01-01T00:00:00Z')
RETURN s.name
ORDER BY s.createdAt
LIMIT 5",Simple Retrieval Queries,twitch,False,False,False,
List the top 3 games with the most streams playing them.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
RETURN g.name AS Game, count(s) AS StreamCount
ORDER BY StreamCount DESC
LIMIT 3",Simple Retrieval Queries,twitch,True,False,False,
Which 5 streams have the highest total view count?,"MATCH (s:Stream)
RETURN s
ORDER BY s.total_view_count DESC
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
Name the top 5 users who are moderators for more than one stream.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS streams_count
WHERE streams_count > 1
RETURN u.name AS user_name, streams_count
ORDER BY streams_count DESC
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
What are the first 3 languages spoken by streams with over 1 million total views?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.total_view_count > 1000000
RETURN l.name AS Language
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
Which streams are part of a team created after 2015 and list the first 5.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt > datetime('2015-01-01T00:00:00Z')
RETURN s
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
"What are the descriptions of the first 3 streams with fewer than 100,000 followers?","MATCH (s:Stream)
WHERE s.followers < 100000 AND s.description IS NOT NULL
RETURN s.description
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
List the top 5 teams by the number of streams they have.,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
RETURN t.name AS TeamName, count(s) AS NumberOfStreams
ORDER BY NumberOfStreams DESC
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
Which users are VIPs for the first 5 streams with the most followers?,"MATCH (s:Stream)
WITH s
ORDER BY s.followers DESC
LIMIT 5
MATCH (u:User)-[:VIP]->(s)
RETURN u.name AS UserName, s.name AS StreamName, s.followers AS Followers",Simple Retrieval Queries,twitch,False,False,True,
Identify the top 3 streams that have the language 'en'.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
RETURN s
ORDER BY s.followers DESC
LIMIT 3",Simple Retrieval Queries,twitch,False,False,False,
What are the top 5 streams by followers that play the game 'Dota 2'?,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Dota 2'})
RETURN s
ORDER BY s.followers DESC
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
"List all the games that have been played by streams with more than 5 million total views, showing the first 3.","MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count > 5000000
RETURN g.name AS Game
LIMIT 3",Simple Retrieval Queries,twitch,False,False,False,
Who are the first 5 moderators for the stream with the highest total view count?,"MATCH (s:Stream)
WITH s
ORDER BY s.total_view_count DESC
LIMIT 1
MATCH (s)-[:MODERATOR]->(m)
RETURN m
LIMIT 5",Simple Retrieval Queries,twitch,True,False,False,
Which streams have users with the role of both VIP and moderator?,"MATCH (s:Stream)
WHERE exists {
    (s)-[:VIP]->(u:User)
    AND exists {
        (s)-[:MODERATOR]->(u)
    }
}
RETURN s",Complex Retrieval Queries,twitch,False,True,False,
What are the URLs of the first 3 streams that have no chatters?,"MATCH (s:Stream)
WHERE NOT exists{(s)-[:CHATTER]->()}
RETURN s.url
LIMIT 3",Simple Retrieval Queries,twitch,True,False,False,
List the top 5 users by the number of streams they moderate.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS moderated_streams
ORDER BY moderated_streams DESC
LIMIT 5
RETURN u.name, moderated_streams",Complex Retrieval Queries,twitch,False,False,True,
Which games are played by streams that are part of teams created after 2017?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE exists {
    (s)-[:HAS_TEAM]->(t:Team)
    WHERE t.createdAt > datetime('2017-01-01T00:00:00Z')
}
RETURN g.name AS Game",Complex Retrieval Queries,twitch,False,False,False,
Which streams have moderators who are also users?,"MATCH (s:Stream)-[:MODERATOR]->(u:User)
RETURN s, u",Simple Aggregation Queries,twitch,False,False,True,
List the names of 3 streams that are conducted in the English language.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: ""en""})
RETURN s.name
LIMIT 3",Simple Aggregation Queries,twitch,False,False,True,
Which games have been played by streams with more than 1 million total views?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count > 1000000
RETURN DISTINCT g.name",Simple Aggregation Queries,twitch,False,False,True,
What are the names of the top 5 streams with the highest follower counts?,"MATCH (s:Stream)
RETURN s.name AS StreamName, s.followers AS Followers
ORDER BY s.followers DESC
LIMIT 5",Simple Aggregation Queries,twitch,False,False,True,
What are the properties of the streams where '9linda' is a VIP?,"MATCH (u:User {name: '9linda'})-[:VIP]->(s:Stream)
RETURN s.id, s.createdAt, s.description, s.url, s.name, s.followers, s.total_view_count",Complex Retrieval Queries,twitch,False,False,True,
Identify streams with more than 10 VIP relationships.,"MATCH (s:Stream)
WHERE count{(s)-[:VIP]->()} > 10
RETURN s",Complex Retrieval Queries,twitch,False,False,True,
What are the URLs of streams where 'itsbigchase' is a moderator?,"MATCH (u:User {name: 'itsbigchase'})-[:MODERATOR]->(s:Stream)
RETURN s.url AS StreamURL",Complex Retrieval Queries,twitch,False,False,True,
Which streams are connected to the game 'Rust' and have at least one VIP?,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
WHERE exists {
  (s)-[:VIP]->(:User) OR (s)-[:VIP]->(:Stream)
}
RETURN s",Complex Retrieval Queries,twitch,False,False,True,
List all users who have chatted with the stream 'itsbigchase'.,"MATCH (s:Stream {name: 'itsbigchase'})<-[:CHATTER]-(u:User)
RETURN u",Complex Retrieval Queries,twitch,False,False,False,
Which streams have more than two team associations?,"MATCH (s:Stream)
WHERE size{(s)-[:HAS_TEAM]->(:Team)} > 2
RETURN s",Complex Retrieval Queries,twitch,False,False,False,
What are the follower counts for streams that have 'ru' as their language?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'ru'})
RETURN s.id AS StreamID, s.followers AS Followers",Complex Retrieval Queries,twitch,False,False,True,
Find streams where 'itsbigchase' is a moderator.,"MATCH (u:User {name: 'itsbigchase'})-[:MODERATOR]->(s:Stream)
RETURN s",Complex Retrieval Queries,twitch,False,False,False,
Which users have been VIPs in streams with a total view count over 5 million?,"MATCH (u:User)-[:VIP]->(s:Stream)
WHERE s.total_view_count > 5000000
RETURN u",Complex Retrieval Queries,twitch,False,False,True,
List the top 3 streams that have the most chatters.,"MATCH (s:Stream)
WITH s, count{(s)-[:CHATTER]->()} AS chatterCount
ORDER BY chatterCount DESC
LIMIT 3
RETURN s.id AS StreamID, s.name AS StreamName, chatterCount",Complex Retrieval Queries,twitch,True,False,False,
How many streams are associated with each language?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
RETURN l.name AS Language, count(s) AS NumberOfStreams",Complex Retrieval Queries,twitch,False,False,True,
What are the descriptions of the streams with the oldest creation dates?,"MATCH (s:Stream)
RETURN s.description
ORDER BY s.createdAt ASC
LIMIT 1",Complex Retrieval Queries,twitch,False,False,False,
Name the first 5 streams that have no moderators and no VIPs.,"MATCH (s:Stream)
WHERE NOT EXISTS { (s)-[:MODERATOR]->() }
  AND NOT EXISTS { (s)-[:VIP]->() }
RETURN s
LIMIT 5",Simple Retrieval Queries,twitch,True,False,False,
"Which users have moderated the most streams, and list the top 3.","MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS moderated_streams
ORDER BY moderated_streams DESC
LIMIT 3
RETURN u.name AS user_name, moderated_streams",Simple Retrieval Queries,twitch,False,False,True,
List the first 3 users who are both moderators and VIPs in different streams.,"MATCH (u:User)-[:MODERATOR]->(s1:Stream), (u)-[:VIP]->(s2:Stream)
WHERE s1 <> s2
RETURN u
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
Who are the first 3 users who are VIPs in the stream with the highest number of moderators?,"MATCH (s:Stream)
WITH s, count{(s)-[:MODERATOR]->()} AS moderatorCount
ORDER BY moderatorCount DESC
LIMIT 1
MATCH (s)-[:VIP]->(u:User)
RETURN u
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
"List the first 5 streams with a follower count exactly at 100,000.","MATCH (s:Stream)
WHERE s.followers = 100000
RETURN s
LIMIT 5",Simple Retrieval Queries,twitch,False,True,False,
What are the first 3 streams that have been in the same team since their creation and still active?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE s.createdAt = t.createdAt
WITH s, t
ORDER BY s.createdAt ASC
LIMIT 3
RETURN s, t",Simple Retrieval Queries,twitch,True,False,False,
"Name the first 5 users who have more than one role (VIP, moderator, or chatter) in the same stream.","MATCH (u:User)-[r]->(s:Stream)
WITH u, s, collect(type(r)) AS roles
WHERE size([x IN roles WHERE x IN ['VIP', 'MODERATOR', 'CHATTER'] | x]) > 1
RETURN u.name
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
Which 3 streams had the most chatters in the past month?,"MATCH (s:Stream)-[:CHATTER]->(c)
WHERE s.createdAt >= datetime('2023-02-01T00:00:00Z') AND s.createdAt < datetime('2023-03-01T00:00:00Z')
RETURN s.id, s.name, count(c) AS chatterCount
ORDER BY chatterCount DESC
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
Who are the first 5 users who have been moderators in streams with a language other than 'en'?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE l.name <> 'en'
RETURN u
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
List the top 3 games played by streams with a description length over 50 characters.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE length(s.description) > 50
RETURN g.name, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
"Which streams are the first 3 that have a VIP user with over 500,000 followers?","MATCH (s:Stream)-[:VIP]->(u:User)
WHERE u.followers > 500000
RETURN s
ORDER BY s.createdAt
LIMIT 3",Simple Retrieval Queries,twitch,True,False,False,
What are the first 5 streams that have a user who is both a moderator and a VIP?,"MATCH (s:Stream)-[:MODERATOR]->(u:User), (s)-[:VIP]->(u)
RETURN s
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
Which game is streamed by the most teams and list the first 3 teams?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH g, count(DISTINCT (s)-[:HAS_TEAM]->(:Team)) AS teamCount
ORDER BY teamCount DESC
LIMIT 1
MATCH (s:Stream)-[:PLAYS]->(g)
WHERE exists{ (s)-[:HAS_TEAM]->(:Team) }
WITH g, s
MATCH (s)-[:HAS_TEAM]->(t:Team)
RETURN g.name AS Game, collect(t.name)[..3] AS Teams",Simple Retrieval Queries,twitch,False,False,True,
What are the first 3 streams that have a team with more than 5 streams?,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
WITH t, count(s) AS streamCount
WHERE streamCount > 5
WITH t
MATCH (s:Stream)-[:HAS_TEAM]->(t)
RETURN s
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
Who are the first 5 chatters in the stream with the highest follower count?,"MATCH (s:Stream)
WHERE s.followers IS NOT NULL
WITH s
ORDER BY s.followers DESC
LIMIT 1
MATCH (s)-[:CHATTER]->(u:User)
RETURN u.name AS ChatterName
LIMIT 5",Simple Retrieval Queries,twitch,False,False,False,
List the first 3 streams with the oldest teams associated with them.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WITH s, t
ORDER BY t.createdAt
RETURN s
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
Which 3 users have chatted in the most streams and what are their names?,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(s) AS streams_chatted_in
ORDER BY streams_chatted_in DESC
LIMIT 3
RETURN u.name AS user_name, streams_chatted_in",Simple Retrieval Queries,twitch,False,False,True,
Name the first 5 streams that are part of a team with no other streams.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE NOT exists{ (:Stream)-[:HAS_TEAM]->(t) WHERE s <> (:Stream) }
RETURN s.name
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
List the first 3 games played by streams with a language 'ja'.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE EXISTS { (s)-[:HAS_LANGUAGE]->(:Language {name: 'ja'}) }
RETURN g.name AS Game
LIMIT 3",Simple Retrieval Queries,twitch,False,False,False,
Which are the first 5 streams that have a language and a game both starting with the same letter?,"MATCH (s:Stream)-[:PLAYS]->(g:Game), (s)-[:HAS_LANGUAGE]->(l:Language)
WHERE g.name STARTS WITH substring(l.name, 0, 1)
RETURN s
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
"How many languages are used by streams with a total view count over 10 million, listing the first 3?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.total_view_count > 10000000
RETURN DISTINCT l.name
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
What are the first 5 user names who are chatters in streams playing 'Dota 2'?,"MATCH (u:User)-[:CHATTER]->(s:Stream)-[:PLAYS]->(g:Game {name: 'Dota 2'})
RETURN u.name
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
What are the first 5 streams that have a language not listed in 'en' or 'ja'?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE l.name NOT IN ['en', 'ja']
RETURN s
LIMIT 5",Simple Retrieval Queries,twitch,False,False,False,
"Which game has the fewest streams playing it, listing the first 3 streams?","MATCH (g:Game)<-[:PLAYS]-(s:Stream)
WITH g, count(s) AS streamCount
ORDER BY streamCount ASC
LIMIT 1
MATCH (g)<-[:PLAYS]-(s:Stream)
RETURN g.name AS game, collect(s)[..3] AS streams",Simple Retrieval Queries,twitch,False,False,True,
"Name the first 5 users who are chatters in streams with more than 500,000 followers.","MATCH (u:User)-[:CHATTER]->(s:Stream)
WHERE s.followers > 500000
RETURN u.name
LIMIT 5",Simple Retrieval Queries,twitch,False,False,False,
List the top 5 games by the number of languages they are streamed in.,"MATCH (g:Game)<-[:PLAYS]-(s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH g, count(DISTINCT l) AS num_languages
ORDER BY num_languages DESC
LIMIT 5
RETURN g.name AS game, num_languages",Simple Retrieval Queries,twitch,False,False,True,
Which 3 teams were created most recently and have at least one stream associated with them?,"MATCH (t:Team)-[:HAS_TEAM]->(s:Stream)
WITH t, s
ORDER BY t.createdAt DESC
RETURN t.name, collect(s.name) AS streams
LIMIT 3",Simple Retrieval Queries,twitch,False,False,False,
What are the first 3 streams that have been played continuously since their creation date without changing the game?,"MATCH (s:Stream)-[p:PLAYS]->(g:Game)
WHERE NOT exists {
    (s)-[:PLAYS]->(g2:Game)
    WHERE g2 <> g AND s.createdAt < g2.createdAt
}
RETURN s
ORDER BY s.createdAt
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,Game.createdAt
"Which streams have a follower count between 10,000 and 50,000, listing the first 5?","MATCH (s:Stream)
WHERE s.followers >= 10000 AND s.followers <= 50000
RETURN s
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
What are the top 3 streams with the highest follower counts?,"MATCH (s:Stream)
RETURN s
ORDER BY s.followers DESC
LIMIT 3",Verbose query,twitch,False,False,True,
Name the top 3 users who are VIPs in the stream with the most followers.,"MATCH (s:Stream)
WHERE s.followers IS NOT NULL
WITH s
ORDER BY s.followers DESC
LIMIT 1
MATCH (u:User)-[:VIP]->(s)
RETURN u.name
ORDER BY u.followers DESC
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
Who are the first 5 users chatting in streams labeled with the game 'Rust'?,"MATCH (u:User)-[:CHATTER]->(s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
RETURN u
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
What are the first 3 streams that have a team with a creation date before 2015?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt < datetime('2015-01-01T00:00:00Z')
RETURN s
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
"Which streams play 'VALORANT' and have over one million total views, listing the first 5?","MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'VALORANT'})
WHERE s.total_view_count > 1000000
RETURN s
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
Who are the first 3 stream moderators who have been in that role since before 2015?,"MATCH (s:Stream)-[r:MODERATOR]->(m)
WHERE r.createdAt < datetime('2015-01-01T00:00:00Z')
RETURN s, m
ORDER BY r.createdAt
LIMIT 3",Simple Retrieval Queries,twitch,False,False,False,MODERATOR.createdAt
List the first 5 streams that have changed their primary game at least once.,"MATCH (s:Stream)-[r:PLAYS]->(g:Game)
WITH s, count(DISTINCT g) AS gamesCount
WHERE gamesCount > 1
RETURN s
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
What are the names of the first 3 teams with streams playing 'Rust' and having over a million followers?,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
WHERE s.followers > 1000000
WITH s
MATCH (s)-[:HAS_TEAM]->(t:Team)
RETURN t.name
LIMIT 3",Simple Retrieval Queries,twitch,False,False,False,
Which streams have the description mentioning 'professional' and list the first 3.,"MATCH (s:Stream)
WHERE s.description CONTAINS 'professional'
RETURN s
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
"List the first 3 streams that have VIP relationships only with other streams, not users.","MATCH (s:Stream)
WHERE NOT EXISTS {
  (s)-[:VIP]->(:User)
}
WITH s
LIMIT 3
MATCH (s)-[r:VIP]->(other:Stream)
RETURN s, r, other",Simple Retrieval Queries,twitch,False,False,False,
Which streams have a total view count greater than 1 million and what games are they playing?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count > 1000000
RETURN s.id, s.name, s.total_view_count, g.name AS game_playing",Verbose query,twitch,False,False,True,
Identify the first 3 streams that play a game and have a VIP who is a user.,"MATCH (s:Stream)-[:PLAYS]->(g:Game), (s)-[:VIP]->(u:User)
RETURN s, g, u
LIMIT 3",Verbose query,twitch,False,False,True,
Which users are moderators for more than one stream?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS streams_count
WHERE streams_count > 1
RETURN u.name, streams_count",Verbose query,twitch,False,False,True,
Which 3 users have the highest number of chatter relationships?,"MATCH (u:User)
WITH u, count{(u)-[:CHATTER]->()} AS chatterCount
ORDER BY chatterCount DESC
LIMIT 3
RETURN u.name, chatterCount",Simple Aggregation Queries,twitch,False,False,True,
List the top 5 oldest streams in the graph.,"MATCH (s:Stream)
RETURN s
ORDER BY s.createdAt ASC
LIMIT 5",Simple Aggregation Queries,twitch,False,False,True,
What are the top 3 most viewed games by streams that have a team?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE exists{(s)-[:HAS_TEAM]->(:Team)}
RETURN g.name AS Game, sum(s.total_view_count) AS TotalViews
ORDER BY TotalViews DESC
LIMIT 3",Simple Aggregation Queries,twitch,False,False,True,
Which 3 streams have the most moderators?,"MATCH (s:Stream)
WITH s, count{(s)-[:MODERATOR]->()} AS moderatorCount
ORDER BY moderatorCount DESC
LIMIT 3
RETURN s.id AS StreamID, s.name AS StreamName, moderatorCount",Simple Aggregation Queries,twitch,False,False,True,
List the 3 languages spoken by the least number of streams.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH l, count(s) AS streamCount
ORDER BY streamCount ASC
LIMIT 3
RETURN l.name, streamCount",Simple Aggregation Queries,twitch,False,False,True,
Which 3 users have moderated the most streams and users combined?,"MATCH (u:User)-[:MODERATOR]->()
WITH u, count(*) AS total_moderations
ORDER BY total_moderations DESC
LIMIT 3
RETURN u.name, total_moderations",Simple Aggregation Queries,twitch,False,False,True,
List the 3 streams with the highest number of VIP relationships.,"MATCH (s:Stream)
WITH s, count{(s)-[:VIP]->()} AS vipCount
ORDER BY vipCount DESC
LIMIT 3
RETURN s, vipCount",Simple Aggregation Queries,twitch,False,False,True,
Find the top 5 games played by streams that also chatter with other streams.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE exists {
  (s)-[:CHATTER]->(:Stream)
}
RETURN g.name, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 5",Simple Aggregation Queries,twitch,False,False,True,
What are the top 3 most recent streams to reach over 1 million followers?,"MATCH (s:Stream)
WHERE s.followers > 1000000
RETURN s
ORDER BY s.createdAt DESC
LIMIT 3",Simple Aggregation Queries,twitch,False,False,True,
Which 3 users are VIPs on the most diverse set of streams?,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(DISTINCT s) AS diversity
ORDER BY diversity DESC
LIMIT 3
RETURN u.name, diversity",Simple Aggregation Queries,twitch,False,False,True,
Which streams have a total view count over 1 million?,"MATCH (s:Stream)
WHERE s.total_view_count > 1000000
RETURN s",Pathfinding Queries,twitch,False,False,True,
List the games that have been played by more than five different streams.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH g, count(DISTINCT s) AS streamCount
WHERE streamCount > 5
RETURN g.name AS Game, streamCount",Pathfinding Queries,twitch,False,False,True,
What are the names of users who are moderators for more than three streams?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS moderatedStreams
WHERE moderatedStreams > 3
RETURN u.name",Pathfinding Queries,twitch,False,False,True,
Identify streams that have moderators who are also VIPs.,"MATCH (s:Stream)-[:MODERATOR]->(m)
WHERE exists{(m)-[:VIP]->(s)}
RETURN s, m",Pathfinding Queries,twitch,False,False,True,
Which streams are part of a team created before 2015?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt < datetime('2015-01-01T00:00:00Z')
RETURN s",Pathfinding Queries,twitch,False,False,True,
Find the 3 streams that play the least common games based on follower count.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH g, count(s) AS streamCount
ORDER BY streamCount ASC
LIMIT 1
MATCH (s2:Stream)-[:PLAYS]->(g)
RETURN s2
ORDER BY s2.followers DESC
LIMIT 3",Simple Aggregation Queries,twitch,False,False,True,
What are the top 5 languages used by streams with more than 10000 followers?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 10000
RETURN l.name, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 5",Pathfinding Queries,twitch,False,False,True,
Which 3 teams were created most recently?,"MATCH (t:Team)
RETURN t
ORDER BY t.createdAt DESC
LIMIT 3",Simple Aggregation Queries,twitch,False,False,True,
What are the 3 most common languages for streams that have been created after 2015?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.createdAt > datetime('2015-01-01T00:00:00Z')
RETURN l.name, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 3",Simple Aggregation Queries,twitch,False,False,True,
Which 3 games are the most played by streams with over 1 million followers?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers > 1000000
RETURN g.name, count(s) AS streams_count
ORDER BY streams_count DESC
LIMIT 3",Simple Aggregation Queries,twitch,False,False,True,
Find the top 5 streams with the most total view count that use English language.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: ""en""})
RETURN s
ORDER BY s.total_view_count DESC
LIMIT 5",Simple Aggregation Queries,twitch,False,False,True,
Which 3 users are moderators for the most streams?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS streams_moderated
ORDER BY streams_moderated DESC
LIMIT 3
RETURN u.name, streams_moderated",Simple Aggregation Queries,twitch,False,False,True,
What are the top 3 most common games played by streams created before 2010?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.createdAt < datetime('2010-01-01T00:00:00Z')
RETURN g.name, count(s) AS streams_count
ORDER BY streams_count DESC
LIMIT 3",Simple Aggregation Queries,twitch,False,False,True,
List the 3 teams with the most associated streams.,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
WITH t, count(s) AS streamCount
ORDER BY streamCount DESC
LIMIT 3
RETURN t.name, streamCount",Simple Aggregation Queries,twitch,False,False,True,
Which 3 streams have the highest number of VIP users?,"MATCH (s:Stream)-[:VIP]->(u:User)
WITH s, count(u) AS vipCount
ORDER BY vipCount DESC
LIMIT 3
RETURN s.id AS StreamID, s.name AS StreamName, vipCount",Simple Aggregation Queries,twitch,False,False,True,
What are the names of the top 5 oldest teams in the graph?,"MATCH (t:Team)
RETURN t.name
ORDER BY t.createdAt
LIMIT 5",Simple Aggregation Queries,twitch,False,False,True,
"List the top 3 languages used by streams with over 10,000 followers.","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 10000
RETURN l.name, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 3",Simple Aggregation Queries,twitch,False,False,True,
Who are the top 3 users who chatter the most with other users?,"MATCH (u:User)-[:CHATTER]->(other:User)
WITH u, count(other) AS chatter_count
ORDER BY chatter_count DESC
LIMIT 3
RETURN u.name, chatter_count",Simple Aggregation Queries,twitch,False,True,False,
List the 3 streams with the lowest follower count but with over 1 million total views.,"MATCH (s:Stream)
WHERE s.followers IS NOT NULL AND s.total_view_count > 1000000
RETURN s
ORDER BY s.followers ASC
LIMIT 3",Simple Aggregation Queries,twitch,False,False,True,
What are the top 3 games played by streams that also have a moderator relationship with a user?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE exists{(s)-[:MODERATOR]->(:User)}
RETURN g.name, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 3",Simple Aggregation Queries,twitch,False,False,True,
Which 3 users have VIP status on the most streams?,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(s) AS vipCount
ORDER BY vipCount DESC
LIMIT 3
RETURN u.name, vipCount",Simple Aggregation Queries,twitch,False,False,True,
List the top 5 streams that have created the most chatter relationships.,"MATCH (s:Stream)
WITH s, count{(s)-[:CHATTER]->()} AS chatterCount
ORDER BY chatterCount DESC
LIMIT 5
RETURN s.id AS StreamID, s.name AS StreamName, chatterCount",Simple Aggregation Queries,twitch,False,False,True,
Which 3 games are mostly played by streams with a total view count exceeding 100 million?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count > 100000000
RETURN g.name, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 3",Simple Aggregation Queries,twitch,False,False,True,
Find the top 5 users who moderate the highest number of other users.,"MATCH (u:User)-[:MODERATOR]->(moderated:User)
WITH u, count(moderated) AS moderatedCount
ORDER BY moderatedCount DESC
LIMIT 5
RETURN u.name, moderatedCount",Simple Aggregation Queries,twitch,False,False,True,
List the top 5 streams with the most chatter interactions.,"MATCH (s:Stream)
RETURN s, count{(s)-[:CHATTER]->()} AS chatterCount
ORDER BY chatterCount DESC
LIMIT 5",Simple Aggregation Queries,twitch,False,False,True,
Which streams have chatters who are also moderators?,"MATCH (s:Stream)-[:CHATTER]->(u:User)
WHERE exists {
    MATCH (u)-[:MODERATOR]->(s)
}
RETURN s",Pathfinding Queries,twitch,False,False,True,
How many streams have played the game 'Rust'?,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
RETURN count(s) AS NumberOfStreams",Pathfinding Queries,twitch,False,False,True,
List all teams associated with streams having more than 50000 followers.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE s.followers > 50000
RETURN t",Pathfinding Queries,twitch,False,False,True,
Find streams that play 'Rust' and have more than 10000 followers.,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
WHERE s.followers > 10000
RETURN s",Pathfinding Queries,twitch,False,False,True,
List the top 5 streams with the highest number of followers.,"MATCH (s:Stream)
RETURN s
ORDER BY s.followers DESC
LIMIT 5",Complex Aggregation Queries,twitch,False,False,True,
Which 3 games have the most streams associated with them?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
RETURN g.name, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
"What are the top 5 languages used by streams with more than 100,000 followers?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 100000
RETURN l.name, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 5",Complex Aggregation Queries,twitch,False,False,True,
Identify the first 3 teams that were created in the database.,"MATCH (t:Team)
RETURN t
ORDER BY t.createdAt ASC
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
Which 3 users are moderators for the most number of streams?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS streamsModerated
ORDER BY streamsModerated DESC
LIMIT 3
RETURN u.name, streamsModerated",Complex Aggregation Queries,twitch,False,False,True,
Find the top 5 streams with the highest total view count.,"MATCH (s:Stream)
RETURN s
ORDER BY s.total_view_count DESC
LIMIT 5",Complex Aggregation Queries,twitch,False,False,True,
What are the names of the top 3 streams that have a VIP user?,"MATCH (s:Stream)-[:VIP]->(u:User)
RETURN s.name AS StreamName
ORDER BY s.followers DESC
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
List the top 5 streams that play 'Rust' and have more than 5000 followers.,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
WHERE s.followers > 5000
RETURN s
ORDER BY s.followers DESC
LIMIT 5",Complex Aggregation Queries,twitch,False,False,True,
Which 3 streams have the most chatter relationships?,"MATCH (s:Stream)
RETURN s, count{(s)-[:CHATTER]->()} AS chatterCount
ORDER BY chatterCount DESC
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
Which 3 users have VIP status in the most streams?,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(s) AS vipCount
ORDER BY vipCount DESC
LIMIT 3
RETURN u.name, vipCount",Complex Aggregation Queries,twitch,False,False,True,
What are the top 5 oldest streams based on the 'createdAt' property?,"MATCH (s:Stream)
RETURN s
ORDER BY s.createdAt ASC
LIMIT 5",Complex Aggregation Queries,twitch,False,False,True,
Find the first 3 languages that are most frequently associated with streams.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
RETURN l.name, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
What are the top 5 streams with the longest descriptions?,"MATCH (s:Stream)
WHERE s.description IS NOT NULL
RETURN s
ORDER BY length(s.description) DESC
LIMIT 5",Complex Aggregation Queries,twitch,True,False,False,
List the top 5 games played by streams with over 1 million total views.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count > 1000000
RETURN g.name, count(s) AS streams_count
ORDER BY streams_count DESC
LIMIT 5",Complex Aggregation Queries,twitch,False,False,True,
How many users have VIP status in more than one stream?,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(DISTINCT s) AS streams_count
WHERE streams_count > 1
RETURN count(u) AS users_with_multiple_vip_status",Pathfinding Queries,twitch,False,False,True,
Which streams have chatters who have less than 1000 followers?,"MATCH (s:Stream)-[:CHATTER]->(u:User)
WHERE u.followers < 1000
RETURN s",Pathfinding Queries,twitch,False,False,True,
Identify streams where the same user is both a chatter and a moderator.,"MATCH (u:User)-[:CHATTER]->(s:Stream), (u)-[:MODERATOR]->(s)
RETURN s, u",Pathfinding Queries,twitch,False,False,True,
List the top 5 users who are chatters in the most streams.,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(s) AS streams_count
ORDER BY streams_count DESC
LIMIT 5
RETURN u.name, streams_count",Pathfinding Queries,twitch,False,True,False,
What are the descriptions of streams that play 'Call of Duty: Warzone'?,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Call of Duty: Warzone'})
RETURN s.description AS StreamDescription",Pathfinding Queries,twitch,False,False,True,
Which users are VIPs on at least two different streams?,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(DISTINCT s) AS streams_count
WHERE streams_count >= 2
RETURN u.name, streams_count",Pathfinding Queries,twitch,False,False,True,
Find streams that have a follower count between 1000 and 5000.,"MATCH (s:Stream)
WHERE s.followers >= 1000 AND s.followers <= 5000
RETURN s",Pathfinding Queries,twitch,False,False,True,
List the top 5 streams with the highest follower counts.,"MATCH (s:Stream)
RETURN s
ORDER BY s.followers DESC
LIMIT 5",Pathfinding Queries,twitch,False,False,True,
Which games are played by streams that also have an 'en' language setting?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE exists { (s)-[:HAS_LANGUAGE]->(:Language {name: 'en'}) }
RETURN g.name AS Game",Pathfinding Queries,twitch,False,False,True,
Find streams that are moderated by users who are also chatters.,"MATCH (s:Stream)-[:MODERATOR]->(u:User)
WHERE exists {
  MATCH (u)-[:CHATTER]->(:Stream)
}
RETURN s",Pathfinding Queries,twitch,False,False,True,
What is the URL of the stream with the highest total view count?,"MATCH (s:Stream)
RETURN s.url AS StreamURL
ORDER BY s.total_view_count DESC
LIMIT 1",Pathfinding Queries,twitch,False,False,True,
List the top 5 streams with the highest follower count.,"MATCH (s:Stream)
RETURN s
ORDER BY s.followers DESC
LIMIT 5",Simple Aggregation Queries,twitch,False,False,True,
List all languages spoken on streams with a total view count over 500000.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.total_view_count > 500000
RETURN DISTINCT l.name",Pathfinding Queries,twitch,False,False,True,
Find streams that have VIP relationships with more than three users.,"MATCH (s:Stream)-[:VIP]->(u:User)
WITH s, count(u) AS vipCount
WHERE vipCount > 3
RETURN s",Pathfinding Queries,twitch,False,False,True,
What are the names of teams associated with streams created after 2018?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE s.createdAt > datetime('2018-01-01T00:00:00Z')
RETURN DISTINCT t.name",Pathfinding Queries,twitch,False,False,True,
How many streams have a description containing the word 'strategy'?,"MATCH (s:Stream)
WHERE s.description CONTAINS 'strategy'
RETURN count(s) AS NumberOfStreams",Pathfinding Queries,twitch,False,False,True,
"Which streams have the longest moderator chains (a moderator, who is also a moderator, and so on)?","MATCH path=(s:Stream)-[:MODERATOR*]->(u:User)
WHERE ALL(node IN nodes(path) WHERE node:Stream OR node:User)
RETURN s AS Stream, length(path) AS ModeratorChainLength
ORDER BY ModeratorChainLength DESC",Pathfinding Queries,twitch,False,True,False,
Identify the streams that have the most moderators.,"MATCH (s:Stream)
WITH s, count{(s)-[:MODERATOR]->()} AS moderatorCount
RETURN s, moderatorCount
ORDER BY moderatorCount DESC
LIMIT 1",Pathfinding Queries,twitch,False,False,True,
List the games played by streams with the lowest follower counts.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers IS NOT NULL
RETURN g.name AS Game, s.followers AS Followers
ORDER BY s.followers ASC
LIMIT 1",Pathfinding Queries,twitch,False,False,True,
Which streams are part of the team 'ESO Stream Team'?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
RETURN s",Pathfinding Queries,twitch,False,False,True,
Which users are chatters on more than five different streams?,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(DISTINCT s) AS streams_count
WHERE streams_count > 5
RETURN u",Pathfinding Queries,twitch,False,True,False,
Which 3 users are chatters in the most number of different streams?,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(DISTINCT s) AS num_streams
ORDER BY num_streams DESC
LIMIT 3
RETURN u.name, num_streams",Complex Aggregation Queries,twitch,False,True,False,
List the names of streams that have both English and Russian languages associated.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE l.name = 'en'
WITH s
MATCH (s)-[:HAS_LANGUAGE]->(l2:Language)
WHERE l2.name = 'ru'
RETURN s.name",Complex Retrieval Queries,twitch,False,False,False,
What are the top 3 games played by streams with a total view count less than 500000?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count < 500000
RETURN g.name, count(s) AS streams_count
ORDER BY streams_count DESC
LIMIT 3",Complex Retrieval Queries,twitch,False,False,True,
What are the names of the first 3 languages spoken in streams with a total view count over 10000000?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.total_view_count > 10000000
RETURN l.name
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
How many unique games are played by streams with more than 500000 followers?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers > 500000
RETURN COUNT(DISTINCT g) AS unique_games_count",Simple Retrieval Queries,twitch,False,False,True,
List the first 3 games played on streams that were created in 2019.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.createdAt >= datetime('2019-01-01T00:00:00Z') AND s.createdAt <= datetime('2019-12-31T23:59:59Z')
RETURN g.name AS Game
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
What are the first 5 streams that a user named 'itsbigchase' moderates?,"MATCH (u:User {name: 'itsbigchase'})-[:MODERATOR]->(s:Stream)
RETURN s
LIMIT 5",Simple Retrieval Queries,twitch,False,False,False,
Who are the top 3 chatters in the stream named 'summit1g'?,"MATCH (s:Stream {name: 'summit1g'})<-[:CHATTER]-(u:User)
RETURN u.name, count(*) AS messages
ORDER BY messages DESC
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
List the first 3 games played by streams that have a follower count under 1000.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers < 1000
RETURN g.name
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
Which streams are part of the team 'ESO Stream Team'?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
RETURN s",Simple Retrieval Queries,twitch,False,False,True,
What are the first 5 streams that have been played by more than 5 different users?,"MATCH (s:Stream)
WHERE exists {
  MATCH (u:User)-[:PLAYS]->(s)
  WITH s, count(u) AS userCount
  WHERE userCount > 5
  RETURN s
}
RETURN s
LIMIT 5",Simple Retrieval Queries,twitch,False,False,False,
Who are the top 3 users who chatter in the stream with the highest total view count?,"MATCH (s:Stream)
WITH s
ORDER BY s.total_view_count DESC
LIMIT 1
MATCH (u:User)-[:CHATTER]->(s)
RETURN u.name AS UserName, u.followers AS UserFollowers
ORDER BY u.followers DESC
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
List the first 3 games played by streams that have a URL containing 'twitch.tv'.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.url CONTAINS 'twitch.tv'
RETURN g.name AS Game
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
What are the names of the first 5 users who are moderators in the stream '9linda'?,"MATCH (s:Stream {name: '9linda'})-[:MODERATOR]->(u:User)
RETURN u.name
LIMIT 5",Simple Retrieval Queries,twitch,False,False,False,
How many streams have a follower count between 10000 and 50000?,"MATCH (s:Stream)
WHERE s.followers >= 10000 AND s.followers <= 50000
RETURN count(s) AS StreamCount",Simple Retrieval Queries,twitch,False,False,True,
List the first 3 streams that have a description mentioning 'game'.,"MATCH (s:Stream)
WHERE s.description CONTAINS 'game'
RETURN s
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
Which streams have the user 'itsbigchase' as a VIP?,"MATCH (u:User {name: 'itsbigchase'})-[:VIP]->(s:Stream)
RETURN s",Simple Retrieval Queries,twitch,False,False,False,
List the top 5 games played by the streams created in the first half of 2020.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.createdAt >= datetime('2020-01-01T00:00:00Z') AND s.createdAt <= datetime('2020-06-30T23:59:59Z')
RETURN g.name, count(s) AS streams_count
ORDER BY streams_count DESC
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
List the top 5 streams with the highest total view count.,"MATCH (s:Stream)
RETURN s
ORDER BY s.total_view_count DESC
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
What are the first 3 languages used by streams with a follower count of exactly 33366?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers = 33366
RETURN l.name
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
What are the first 3 streams that have a description containing the word 'hilarious'?,"MATCH (s:Stream)
WHERE s.description CONTAINS 'hilarious'
RETURN s
ORDER BY s.createdAt
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
List the first 3 users who are VIPs in the stream 'itsbigchase'.,"MATCH (s:Stream {name: 'itsbigchase'})-[:VIP]->(u:User)
RETURN u
LIMIT 3",Simple Retrieval Queries,twitch,False,False,False,
What are the first 3 games played by the stream 'itsbigchase'?,"MATCH (s:Stream {name: 'itsbigchase'})-[:PLAYS]->(g:Game)
RETURN g.name
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
List the top 5 streams that have a total view count greater than 5000000.,"MATCH (s:Stream)
WHERE s.total_view_count > 5000000
RETURN s
ORDER BY s.total_view_count DESC
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
Which users are moderators for the stream with the name '9linda'?,"MATCH (s:Stream {name: '9linda'})<-[:MODERATOR]-(u:User)
RETURN u",Simple Retrieval Queries,twitch,False,False,True,
Find the top 3 languages used by streams with more than 1000000 followers.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 1000000
RETURN l.name, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
What are the first 3 streams that have a follower count between 20000 and 50000?,"MATCH (s:Stream)
WHERE s.followers >= 20000 AND s.followers <= 50000
RETURN s
ORDER BY s.createdAt ASC
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
List the names of the first 5 streams that were created before 2015.,"MATCH (s:Stream)
WHERE s.createdAt < datetime('2015-01-01T00:00:00Z')
RETURN s.name
ORDER BY s.createdAt
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
Who are the top 3 VIPs in the stream named 'summit1g'?,"MATCH (s:Stream {name: 'summit1g'})-[:VIP]->(vip)
RETURN vip
ORDER BY vip.followers DESC
LIMIT 3",Simple Retrieval Queries,twitch,False,False,False,
What are the first 3 teams associated with the stream 'itsbigchase'?,"MATCH (s:Stream {name: 'itsbigchase'})-[:HAS_TEAM]->(t:Team)
RETURN t
LIMIT 3",Simple Retrieval Queries,twitch,False,False,False,
Which streams are chatters in the stream with the name '9linda'?,"MATCH (s:Stream {name: '9linda'})<-[:CHATTER]-(chatterStream:Stream)
RETURN chatterStream",Simple Retrieval Queries,twitch,False,False,False,
List the first 5 users who are chatters in more than one stream.,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(DISTINCT s) AS streams_count
WHERE streams_count > 1
RETURN u
LIMIT 5",Simple Retrieval Queries,twitch,False,True,False,
Which game is the most commonly played among the top 5 streams by follower count?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
RETURN g.name AS Game, count(s) AS StreamsCount
ORDER BY s.followers DESC
LIMIT 5",Simple Retrieval Queries,twitch,True,False,False,
What are the names of the first 3 users who are both moderators and VIPs for any stream?,"MATCH (u:User)-[:MODERATOR]->(:Stream), (u)-[:VIP]->(:Stream)
RETURN DISTINCT u.name
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
List the first 5 streams that have the language 'en'.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
RETURN s
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
Who are the top 3 moderators for the stream with the highest follower count?,"MATCH (s:Stream)
WHERE s.followers IS NOT NULL
WITH s
ORDER BY s.followers DESC
LIMIT 1
MATCH (s)-[:MODERATOR]->(m)
RETURN m.name AS ModeratorName, m.id AS ModeratorID
ORDER BY m.followers DESC
LIMIT 3",Simple Retrieval Queries,twitch,False,False,False,
What are the first 5 streams created in 2021?,"MATCH (s:Stream)
WHERE s.createdAt >= datetime('2021-01-01T00:00:00Z') AND s.createdAt < datetime('2022-01-01T00:00:00Z')
RETURN s
ORDER BY s.createdAt ASC
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
Which user has moderated the most streams?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS moderated_streams
RETURN u.name AS user_name, moderated_streams
ORDER BY moderated_streams DESC
LIMIT 1",Simple Retrieval Queries,twitch,False,False,True,
Who are the top 3 VIPs in the streams that were created in 2018?,"MATCH (s:Stream)-[:VIP]->(vip)
WHERE s.createdAt >= datetime('2018-01-01T00:00:00Z') AND s.createdAt <= datetime('2018-12-31T23:59:59Z')
RETURN vip
ORDER BY vip.followers DESC
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
List the first 5 streams that play the game 'Rust'.,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
RETURN s
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
Which teams are associated with the top 3 streams by total view count?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE s.total_view_count IS NOT NULL
RETURN t
ORDER BY s.total_view_count DESC
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
Find streams that were created after 2015 and have at least one chatter who is a user.,"MATCH (s:Stream)
WHERE s.createdAt > datetime('2015-01-01T00:00:00Z')
AND exists {
  (s)-[:CHATTER]->(:User)
}
RETURN s",Complex Retrieval Queries,twitch,False,False,True,
Can you list streams that have a follower count between 1000 and 5000?,"MATCH (s:Stream)
WHERE s.followers >= 1000 AND s.followers <= 5000
RETURN s",Complex Retrieval Queries,twitch,False,False,True,
What are the names of teams associated with streams created before 2018?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE s.createdAt < datetime('2018-01-01T00:00:00Z')
RETURN DISTINCT t.name",Complex Retrieval Queries,twitch,False,False,True,
Which games are played by the top 3 streams based on followers count?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
RETURN g.name AS Game, s.followers AS Followers
ORDER BY s.followers DESC
LIMIT 3",Complex Retrieval Queries,twitch,False,False,True,
Which users are moderators in at least two different streams?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(DISTINCT s) AS streams_count
WHERE streams_count >= 2
RETURN u",Complex Retrieval Queries,twitch,False,False,True,
What are the names of streams that play 'Rust' and have more than 5000 followers?,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
WHERE s.followers > 5000
RETURN s.name",Complex Retrieval Queries,twitch,False,False,True,
How many streams have a moderator who is also a stream?,"MATCH (s:Stream)-[:MODERATOR]->(mod:Stream)
RETURN count(DISTINCT s) AS NumberOfStreams",Complex Retrieval Queries,twitch,False,False,True,
List all streams that have a VIP who is a user.,"MATCH (s:Stream)-[:VIP]->(u:User)
RETURN s",Complex Retrieval Queries,twitch,False,False,True,
Name the languages spoken in streams with a total view count exceeding 10 million.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.total_view_count > 10000000
RETURN DISTINCT l.name",Complex Retrieval Queries,twitch,False,False,True,
Who are the moderators of the stream named 'summit1g'?,"MATCH (s:Stream {name: 'summit1g'})-[:MODERATOR]->(m)
RETURN m",Complex Retrieval Queries,twitch,False,False,False,
Identify streams that have more than one language associated with them.,"MATCH (s:Stream)
WHERE size{(s)-[:HAS_LANGUAGE]->(:Language)} > 1
RETURN s",Complex Retrieval Queries,twitch,True,False,False,
Which users are chatters in more than three streams?,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(s) AS streams_count
WHERE streams_count > 3
RETURN u.name, streams_count",Complex Retrieval Queries,twitch,False,True,False,
List the streams that have the most followers who also play 'Grand Theft Auto V'.,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Grand Theft Auto V'})
WHERE s.followers IS NOT NULL
RETURN s
ORDER BY s.followers DESC",Complex Retrieval Queries,twitch,False,False,True,
Which streams were created in 2019 and have a description longer than 50 characters?,"MATCH (s:Stream)
WHERE s.createdAt >= datetime('2019-01-01T00:00:00Z') AND s.createdAt < datetime('2020-01-01T00:00:00Z')
  AND length(s.description) > 50
RETURN s",Complex Retrieval Queries,twitch,True,False,False,
Find the streams that are moderated by users named 'itsbigchase'.,"MATCH (s:Stream)-[:MODERATOR]->(u:User {name: 'itsbigchase'})
RETURN s",Complex Retrieval Queries,twitch,False,False,False,
What languages are used by streams that have over 10000 followers?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 10000
RETURN DISTINCT l.name",Complex Retrieval Queries,twitch,False,False,True,
Which users are VIPs in more than one stream?,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(s) AS streams_count
WHERE streams_count > 1
RETURN u.name, streams_count",Complex Retrieval Queries,twitch,False,False,True,
Identify the streams that are part of the 'ESO Stream Team'.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
RETURN s",Complex Retrieval Queries,twitch,False,False,True,
Which streams have moderators who are also users?,"MATCH (s:Stream)-[:MODERATOR]->(u:User)
RETURN s, u",Complex Retrieval Queries,twitch,False,False,True,
What are the first 3 streams that have a user named 'itsbigchase' as a chatter?,"MATCH (s:Stream)-[:CHATTER]->(u:User {name: 'itsbigchase'})
RETURN s
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
List the names of the first 5 users who are chatters in the stream 'summit1g'.,"MATCH (s:Stream {name: 'summit1g'})<-[:CHATTER]-(u:User)
RETURN u.name
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
Which streams are chatters in the stream with the most followers?,"MATCH (s:Stream)
WHERE s.followers IS NOT NULL
WITH s ORDER BY s.followers DESC LIMIT 1
MATCH (s)-[:CHATTER]->(chatterStream:Stream)
RETURN chatterStream",Simple Retrieval Queries,twitch,False,False,True,
List the first 5 users who are moderators in streams that play 'Grand Theft Auto V'.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)-[:PLAYS]->(g:Game {name: 'Grand Theft Auto V'})
RETURN u
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
What are the names of the first 3 games played by streams that have a URL ending in 'itsbigchase'?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.url ENDS WITH 'itsbigchase'
RETURN g.name
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
Who are the top 3 users who are VIPs in the stream with the name '9linda'?,"MATCH (s:Stream {name: '9linda'})<-[:VIP]-(u:User)
RETURN u
ORDER BY u.followers DESC
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
List the first 5 streams that have been VIP in more than one stream.,"MATCH (s:Stream)-[:VIP]->(other:Stream)
WITH s, count{(s)-[:VIP]->(other)} AS vipCount
WHERE vipCount > 1
RETURN s
LIMIT 5",Simple Retrieval Queries,twitch,False,False,False,
Who are the VIP users in streams that have over 1000000 followers?,"MATCH (s:Stream)-[:VIP]->(u:User)
WHERE s.followers > 1000000
RETURN u.name AS VIPUserName, u.id AS VIPUserId",Complex Retrieval Queries,twitch,False,False,True,
Which streams have a language named after a country code 'en'?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
RETURN s",Simple Retrieval Queries,twitch,False,False,True,
What are the first 5 streams that have the most chatters?,"MATCH (s:Stream)
WITH s, count{(s)-[:CHATTER]->()} AS chatterCount
ORDER BY chatterCount DESC
LIMIT 5
RETURN s",Simple Retrieval Queries,twitch,False,False,True,
Who are the top 3 moderators in the stream with the lowest follower count?,"MATCH (s:Stream)
WHERE s.followers IS NOT NULL
WITH s
ORDER BY s.followers ASC
LIMIT 1
MATCH (s)-[:MODERATOR]->(m:User)
RETURN m.name, m.id
ORDER BY m.followers DESC
LIMIT 3",Simple Retrieval Queries,twitch,False,False,False,
List the first 5 streams that have a follower count exactly 5898590.,"MATCH (s:Stream)
WHERE s.followers = 5898590
RETURN s
LIMIT 5",Simple Retrieval Queries,twitch,False,False,True,
What are the names of the first 3 languages spoken by the stream 'itsbigchase'?,"MATCH (s:Stream {name: ""itsbigchase""})-[:HAS_LANGUAGE]->(l:Language)
RETURN l.name
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
Which streams have more than 5000000 followers?,"MATCH (s:Stream)
WHERE s.followers > 5000000
RETURN s",Complex Retrieval Queries,twitch,False,False,True,
List the top 5 streams by total view count.,"MATCH (s:Stream)
RETURN s
ORDER BY s.total_view_count DESC
LIMIT 5",Complex Retrieval Queries,twitch,False,False,True,
What are the names of games played by streams with more than 1 million total views?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count > 1000000
RETURN DISTINCT g.name",Complex Retrieval Queries,twitch,False,False,True,
"List the first 3 streams that were created on or before January 1, 2010.","MATCH (s:Stream)
WHERE s.createdAt <= datetime('2010-01-01T00:00:00Z')
RETURN s
ORDER BY s.createdAt
LIMIT 3",Simple Retrieval Queries,twitch,False,False,True,
"List the first 3 languages used by streams that have more than 10,000 followers.","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 10000
RETURN l.name AS Language
LIMIT 3",Verbose query,twitch,False,False,True,
What are the top 5 teams by the number of streams they are associated with?,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
RETURN t.name, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 5",Complex Aggregation Queries,twitch,False,False,True,
List the top 5 streams that have a 'createdAt' date after 2019.,"MATCH (s:Stream)
WHERE s.createdAt > datetime('2019-01-01T00:00:00Z')
RETURN s
ORDER BY s.createdAt DESC
LIMIT 5",Complex Aggregation Queries,twitch,False,False,True,
"Which streams have a total view count below 10,000 and are linked to a language named 'en'?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
WHERE s.total_view_count < 10000
RETURN s",Verbose query,twitch,False,False,True,
What are the first 3 streams that have a VIP named 'itsbigchase'?,"MATCH (s:Stream)-[:VIP]->(u:User {name: 'itsbigchase'})
RETURN s
LIMIT 3",Verbose query,twitch,False,False,False,
List the top 5 streams with moderators who are users and have a follower count above 2000.,"MATCH (s:Stream)-[:MODERATOR]->(u:User)
WHERE u.followers > 2000
RETURN s
ORDER BY s.followers DESC
LIMIT 5",Verbose query,twitch,False,False,True,
Identify the first 3 streams that have chatters who are streams created before 2017.,"MATCH (s:Stream)-[:CHATTER]->(c:Stream)
WHERE c.createdAt < datetime('2017-01-01T00:00:00Z')
RETURN s
LIMIT 3",Verbose query,twitch,False,False,True,
Which streams have a total view count above 1 million and a moderator named 'creightonolsen'?,"MATCH (s:Stream)-[:MODERATOR]->(u:User {name: 'creightonolsen'})
WHERE s.total_view_count > 1000000
RETURN s",Verbose query,twitch,False,False,False,
What are the first 3 streams that have a team with a creation date after 2015?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt > datetime('2015-01-01T00:00:00Z')
RETURN s
ORDER BY s.createdAt
LIMIT 3",Verbose query,twitch,False,False,True,
List the top 5 streams that have at least one user as a chatter and are associated with the game 'Rust'.,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
WHERE exists {
  (s)-[:CHATTER]->(:User)
}
RETURN s
ORDER BY s.followers DESC
LIMIT 5",Verbose query,twitch,False,False,True,
Identify the first 3 streams that have a language set to 'ru' and a moderator with a follower count above 5000.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'ru'})
WHERE exists {
  (s)-[:MODERATOR]->(m:User) WHERE m.followers > 5000
}
RETURN s
LIMIT 3",Verbose query,twitch,False,False,True,
Which streams are played by users with a name containing 'doduik' and have a total view count above 3000?,"MATCH (u:User)-[:PLAYS]->(s:Stream)
WHERE u.name CONTAINS 'doduik' AND u.total_view_count > 3000
RETURN s",Verbose query,twitch,False,False,False,
What are the first 3 streams with a moderator named 'itsbigchase'?,"MATCH (s:Stream)-[:MODERATOR]->(u:User {name: 'itsbigchase'})
RETURN s
LIMIT 3",Verbose query,twitch,False,False,False,
List the top 5 streams that are linked to teams created before 2015.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt < datetime('2015-01-01T00:00:00Z')
RETURN s
ORDER BY s.followers DESC
LIMIT 5",Verbose query,twitch,False,False,True,
Identify the first 3 streams that have chatters who are users with a follower count below 3000.,"MATCH (s:Stream)-[:CHATTER]->(u:User)
WHERE u.followers < 3000
RETURN s
LIMIT 3",Verbose query,twitch,False,False,True,
Which streams have a description containing 'premiere' and have at least 5000 followers?,"MATCH (s:Stream)
WHERE s.description CONTAINS 'premiere' AND s.followers >= 5000
RETURN s",Verbose query,twitch,False,False,True,
What are the top 5 most viewed streams that have a language set to 'en'?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
WHERE s.total_view_count IS NOT NULL
RETURN s
ORDER BY s.total_view_count DESC
LIMIT 5",Verbose query,twitch,False,False,True,
Which 3 streams have the most moderators?,"MATCH (s:Stream)
WITH s, count{(s)-[:MODERATOR]->()} AS moderatorCount
ORDER BY moderatorCount DESC
LIMIT 3
RETURN s.id AS StreamID, s.name AS StreamName, moderatorCount",Complex Aggregation Queries,twitch,False,False,True,
What are the properties of the stream with the highest number of followers?,"MATCH (s:Stream)
RETURN s
ORDER BY s.followers DESC
LIMIT 1",Complex Retrieval Queries,twitch,False,False,True,
"Which streams have a follower count above 10,000 and are associated with a game named 'Rust'?","MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
WHERE s.followers > 10000
RETURN s",Verbose query,twitch,False,False,True,
"List the top 5 streams that have chatters with a total view count over 10,000.","MATCH (s:Stream)-[:CHATTER]->(u:User)
WHERE u.total_view_count > 10000
RETURN s
ORDER BY s.followers DESC
LIMIT 5",Verbose query,twitch,False,False,True,
Identify the first 3 users who are VIPs in streams with a name containing 'big'.,"MATCH (u:User)-[:VIP]->(s:Stream)
WHERE s.name CONTAINS 'big'
RETURN u
LIMIT 3",Verbose query,twitch,False,False,True,
Which streams have at least one user named 'itsbigchase' as a chatter?,"MATCH (s:Stream)-[:CHATTER]->(u:User {name: 'itsbigchase'})
RETURN s",Verbose query,twitch,False,False,True,
What are the first 3 streams with the most VIPs linked to them?,"MATCH (s:Stream)
WITH s, count{(s)-[:VIP]->(:User)} AS vipCount
ORDER BY vipCount DESC
LIMIT 3
RETURN s",Verbose query,twitch,False,False,True,
List the top 5 streams with the lowest follower count that play the game 'Rust'.,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
RETURN s
ORDER BY s.followers ASC
LIMIT 5",Verbose query,twitch,False,False,True,
Identify the first 3 streams that have moderators named 'itsbigchase'.,"MATCH (s:Stream)-[:MODERATOR]->(u:User {name: 'itsbigchase'})
RETURN s
LIMIT 3",Verbose query,twitch,False,False,False,
Which users are chatters in streams with a description containing 'inclusive'?,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WHERE s.description CONTAINS 'inclusive'
RETURN u",Verbose query,twitch,False,False,True,
List the first 3 streams that have VIPs who are users with a name containing 'chase'.,"MATCH (s:Stream)-[:VIP]->(u:User)
WHERE u.name CONTAINS 'chase'
RETURN s
LIMIT 3",Verbose query,twitch,False,False,False,
What are the top 5 streams created before 2010?,"MATCH (s:Stream)
WHERE s.createdAt < datetime('2010-01-01T00:00:00Z')
RETURN s
ORDER BY s.createdAt
LIMIT 5",Verbose query,twitch,False,False,True,
"Identify the first 3 teams that are linked to streams with over 10,000 followers.","MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE s.followers > 10000
RETURN t
LIMIT 3",Verbose query,twitch,False,False,True,
Identify the first 3 streams that play a game named 'Rust' and have a VIP who is a user.,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
WHERE exists {
  (s)-[:VIP]->(:User)
}
RETURN s
LIMIT 3",Verbose query,twitch,False,False,True,
List the top 5 streams that have chatters named 'itsbigchase'.,"MATCH (s:Stream)-[:CHATTER]->(u:User {name: 'itsbigchase'})
RETURN s
ORDER BY s.followers DESC
LIMIT 5",Verbose query,twitch,False,False,True,
What are the first 3 streams that were created after 2015 and have a follower count above 1000?,"MATCH (s:Stream)
WHERE s.createdAt > datetime('2015-01-01T00:00:00Z') AND s.followers > 1000
RETURN s
ORDER BY s.createdAt ASC
LIMIT 3",Verbose query,twitch,False,False,True,
Which streams have a follower count exceeding 2000 and are playing a game named 'Rust'?,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
WHERE s.followers > 2000
RETURN s",Verbose query,twitch,False,False,True,
What are the names of the top 5 most followed streams that have been created since 2018?,"MATCH (s:Stream)
WHERE s.createdAt >= datetime('2018-01-01T00:00:00Z') AND s.followers IS NOT NULL
RETURN s.name
ORDER BY s.followers DESC
LIMIT 5",Verbose query,twitch,False,False,True,
Identify the first 3 games played by streams that have at least 5000 followers.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers >= 5000
RETURN g.name AS GameName
LIMIT 3",Verbose query,twitch,False,False,True,
Which stream has the lowest total view count and what language is it using?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.total_view_count IS NOT NULL
RETURN s, l
ORDER BY s.total_view_count ASC
LIMIT 1",Verbose query,twitch,False,False,True,
List the top 3 users who chatter in more than one stream.,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(DISTINCT s) AS streams_count
WHERE streams_count > 1
RETURN u.name, streams_count
ORDER BY streams_count DESC
LIMIT 3",Verbose query,twitch,False,True,False,
What are the names and URLs of the first 3 streams that are part of a team created before 2015?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt < datetime('2015-01-01T00:00:00Z')
RETURN s.name, s.url
LIMIT 3",Verbose query,twitch,False,False,True,
Which streams have VIP users and what are the names of these VIPs?,"MATCH (s:Stream)-[:VIP]->(vip:User)
RETURN s.id AS StreamID, vip.name AS VIPName",Verbose query,twitch,False,False,True,
Identify the top 5 teams by the number of associated streams they have.,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
RETURN t.name, count(s) AS NumberOfStreams
ORDER BY NumberOfStreams DESC
LIMIT 5",Verbose query,twitch,False,False,True,
List the first 3 users who are moderators for streams playing 'Rust'.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
RETURN u
LIMIT 3",Verbose query,twitch,False,False,True,
Which users are VIP in both 'itsbigchase' and another stream?,"MATCH (u:User)-[:VIP]->(s1:Stream {name: 'itsbigchase'})
MATCH (u)-[:VIP]->(s2:Stream)
WHERE s1 <> s2
RETURN DISTINCT u",Verbose query,twitch,False,False,False,
What are the top 3 streams with the least followers that still have moderators?,"MATCH (s:Stream)-[:MODERATOR]->(:User)
WHERE s.followers IS NOT NULL
RETURN s
ORDER BY s.followers ASC
LIMIT 3",Verbose query,twitch,False,False,True,
Which games are played by streams that have both English and German-speaking users?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE exists {
    (s)-[:HAS_LANGUAGE]->(:Language {name: 'en'}) 
    AND 
    (s)-[:HAS_LANGUAGE]->(:Language {name: 'de'})
}
RETURN DISTINCT g.name",Verbose query,twitch,True,False,False,
List the top 3 streams that have the most chatters.,"MATCH (s:Stream)
WITH s, count{(s)-[:CHATTER]->()} AS chatterCount
ORDER BY chatterCount DESC
LIMIT 3
RETURN s.id AS StreamID, s.name AS StreamName, chatterCount",Verbose query,twitch,False,False,True,
Which users are chatters in streams that have over 10000 total views?,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WHERE s.total_view_count > 10000
RETURN u",Verbose query,twitch,False,True,False,
"Which streams have a total view count below 50,000 and are associated with the language 'ru'?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'ru'})
WHERE s.total_view_count < 50000
RETURN s",Verbose query,twitch,False,False,True,
What are the names of the first 3 languages used by streams with a description containing 'strategy'?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.description CONTAINS 'strategy'
RETURN l.name
LIMIT 3",Verbose query,twitch,False,False,True,
What are the descriptions of streams that are moderated by users with names starting with 'c'?,"MATCH (s:Stream)-[:MODERATOR]->(u:User)
WHERE u.name STARTS WITH 'c'
RETURN s.description",Verbose query,twitch,False,False,True,
Which streams have users as VIPs and moderators and list those users' names?,"MATCH (s:Stream)-[:VIP]->(vipUser:User), (s)-[:MODERATOR]->(modUser:User)
RETURN s.id AS StreamID, collect(DISTINCT vipUser.name) AS VIPUserNames, collect(DISTINCT modUser.name) AS ModeratorUserNames",Verbose query,twitch,False,False,True,
How many streams does each game have associated with it? List the top 5 games based on this count.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH g.name AS GameName, count(s) AS StreamCount
ORDER BY StreamCount DESC
LIMIT 5
RETURN GameName, StreamCount",Verbose query,twitch,False,False,True,
What are the first 3 streams that were created after 2019 and their total view count?,"MATCH (s:Stream)
WHERE s.createdAt > datetime('2019-01-01T00:00:00Z')
RETURN s.id, s.createdAt, s.total_view_count
ORDER BY s.createdAt ASC
LIMIT 3",Verbose query,twitch,False,False,True,
Which streams are part of teams created after 2018 and what are the team names?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt > datetime('2018-01-01T00:00:00Z')
RETURN s.id AS StreamID, t.name AS TeamName",Verbose query,twitch,False,False,True,
List the top 3 users who have moderated the most streams.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS moderated_streams
ORDER BY moderated_streams DESC
LIMIT 3
RETURN u.name, moderated_streams",Verbose query,twitch,False,False,True,
"What are the first 3 streams with a language named 'ru' and a total view count below 10,000?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'ru'})
WHERE s.total_view_count < 10000
RETURN s
LIMIT 3",Verbose query,twitch,False,False,True,
List the top 5 streams that have a moderator named 'itsbigchase' and were created before 2018.,"MATCH (s:Stream)-[:MODERATOR]->(u:User {name: 'itsbigchase'})
WHERE s.createdAt < datetime('2018-01-01T00:00:00Z')
RETURN s
ORDER BY s.createdAt DESC
LIMIT 5",Verbose query,twitch,False,False,False,
Identify the first 3 streams that have a team named 'ESO Stream Team' and a follower count below 5000.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
WHERE s.followers < 5000
RETURN s
LIMIT 3",Verbose query,twitch,False,False,False,
"Which streams have a description containing 'casual play' and a total view count above 100,000?","MATCH (s:Stream)
WHERE s.description CONTAINS 'casual play' AND s.total_view_count > 100000
RETURN s",Verbose query,twitch,False,False,True,
What are the first 3 streams that have a language set to 'en' and a VIP who is a user?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
WHERE exists {
  (s)-[:VIP]->(:User)
}
RETURN s
LIMIT 3",Verbose query,twitch,False,False,True,
List the top 5 streams with the most chatters who are users.,"MATCH (s:Stream)-[:CHATTER]->(u:User)
WITH s, count(u) AS userChatters
ORDER BY userChatters DESC
LIMIT 5
RETURN s.id AS StreamID, s.name AS StreamName, userChatters",Verbose query,twitch,False,False,True,
"Identify the first 3 users who are moderators for streams with a total view count exceeding 500,000.","MATCH (u:User)-[:MODERATOR]->(s:Stream)
WHERE s.total_view_count > 500000
RETURN u
ORDER BY s.createdAt
LIMIT 3",Verbose query,twitch,False,False,True,
Identify the first 3 streams that play 'DayZ' and their respective follower counts.,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: ""DayZ""})
RETURN s.id, s.name, s.followers
ORDER BY s.createdAt ASC
LIMIT 3",Verbose query,twitch,False,False,True,
List the first 3 streams that have chatters who are also streams.,"MATCH (s:Stream)-[:CHATTER]->(c:Stream)
RETURN s
LIMIT 3",Verbose query,twitch,False,False,True,
List the first 3 streams that are linked to the game 'Rust' and have been created after 2018.,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
WHERE s.createdAt > datetime('2018-01-01T00:00:00Z')
RETURN s
LIMIT 3",Verbose query,twitch,False,False,True,
What are the top 5 streams with the highest total view count and are associated with the 'ESO Stream Team'?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
WHERE s.total_view_count IS NOT NULL
RETURN s
ORDER BY s.total_view_count DESC
LIMIT 5",Verbose query,twitch,False,False,True,
Which 3 streams have the most complex descriptions based on word count?,"MATCH (s:Stream)
WHERE s.description IS NOT NULL
RETURN s, size(split(s.description, ' ')) AS WordCount
ORDER BY WordCount DESC
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
What are the first 3 streams that have a language setup other than 'en' or 'ru'?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE l.name NOT IN ['en', 'ru']
RETURN s
LIMIT 3",Complex Aggregation Queries,twitch,True,False,False,
List the top 5 streams that have chatters with more than 5000 followers.,"MATCH (s:Stream)-[:CHATTER]->(u:User)
WHERE u.followers > 5000
RETURN s
ORDER BY s.followers DESC
LIMIT 5",Complex Aggregation Queries,twitch,False,False,True,
Which 3 users have the most moderator relationships with other users?,"MATCH (u:User)-[:MODERATOR]->(:User)
WITH u, count(*) AS moderator_count
ORDER BY moderator_count DESC
LIMIT 3
RETURN u.name, moderator_count",Complex Aggregation Queries,twitch,False,False,True,
What are the top 5 streams that have VIP relationships with other streams?,"MATCH (s:Stream)-[:VIP]->(:Stream)
WITH s, count{(s)-[:VIP]->(:Stream)} AS vipCount
ORDER BY vipCount DESC
LIMIT 5
RETURN s",Complex Aggregation Queries,twitch,False,False,True,
List the first 3 games played by streams with the highest follower counts.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers IS NOT NULL
RETURN g.name AS Game, s.followers AS Followers
ORDER BY s.followers DESC
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
Identify the first 3 languages associated with streams that have a description containing 'coverage'.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.description CONTAINS 'coverage'
RETURN l.name
LIMIT 3",Verbose query,twitch,False,False,True,
Which 3 streams have the most users as chatters?,"MATCH (s:Stream)-[:CHATTER]->(u:User)
WITH s, count(u) AS chatterCount
ORDER BY chatterCount DESC
LIMIT 3
RETURN s.id AS StreamID, s.name AS StreamName, chatterCount",Complex Aggregation Queries,twitch,False,False,True,
List the top 5 oldest teams based on the 'createdAt' property.,"MATCH (t:Team)
RETURN t
ORDER BY t.createdAt ASC
LIMIT 5",Complex Aggregation Queries,twitch,False,False,True,
"What are the first 3 users who are VIPs in streams with more than 10,000 total views?","MATCH (u:User)-[:VIP]->(s:Stream)
WHERE s.total_view_count > 10000
RETURN u
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
List the top 5 streams that have had more than three different languages associated with them.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH s, count(DISTINCT l) AS num_languages
WHERE num_languages > 3
RETURN s
ORDER BY s.total_view_count DESC
LIMIT 5",Complex Aggregation Queries,twitch,False,False,False,
Which 3 streams have the most unique games played?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH s, COUNT(DISTINCT g) AS uniqueGames
ORDER BY uniqueGames DESC
LIMIT 3
RETURN s.id AS StreamID, s.name AS StreamName, uniqueGames",Complex Aggregation Queries,twitch,False,False,True,
What are the names of the first 3 streams that have a moderator with more than 5000 followers?,"MATCH (s:Stream)-[:MODERATOR]->(u:User)
WHERE u.followers > 5000
RETURN s.name
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
"List the top 5 games associated with streams that have more than 10,000 total views.","MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count > 10000
RETURN g.name, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 5",Complex Aggregation Queries,twitch,False,False,True,
List the top 5 streams that are part of a team created before 2015.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt < datetime('2015-01-01T00:00:00Z')
RETURN s
ORDER BY s.followers DESC
LIMIT 5",Complex Aggregation Queries,twitch,False,False,True,
"What are the first 3 streams to play 'Rust' with more than 100,000 total views?","MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
WHERE s.total_view_count > 100000
RETURN s
ORDER BY s.createdAt ASC
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
List the top 5 streams that have been added to the most teams.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WITH s, count(t) AS teamsCount
ORDER BY teamsCount DESC
LIMIT 5
RETURN s.id AS StreamID, s.name AS StreamName, teamsCount",Complex Aggregation Queries,twitch,False,False,True,
Which streams have a VIP relationship with more than three different users?,"MATCH (s:Stream)-[:VIP]->(u:User)
WITH s, count(DISTINCT u) AS vipCount
WHERE vipCount > 3
RETURN s",Complex Aggregation Queries,twitch,False,False,True,
What are the three most common teams that streams belong to?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
RETURN t.name, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
List the top 5 users who have the role of chatter in the highest number of other user's streams.,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(DISTINCT s) AS chatterCount
ORDER BY chatterCount DESC
LIMIT 5
RETURN u.name, chatterCount",Complex Aggregation Queries,twitch,False,True,False,
"Which 3 languages are least common among streams with more than 10,000 followers?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 10000
WITH l, count(s) AS stream_count
ORDER BY stream_count ASC
LIMIT 3
RETURN l.name, stream_count",Complex Aggregation Queries,twitch,False,False,True,
Find the top 5 streams by oldest to newest based on the 'createdAt' property.,"MATCH (s:Stream)
RETURN s
ORDER BY s.createdAt ASC
LIMIT 5",Complex Aggregation Queries,twitch,False,False,True,
Which 3 streams have the highest ratio of followers to total view count?,"MATCH (s:Stream)
WHERE s.followers IS NOT NULL AND s.total_view_count IS NOT NULL AND s.total_view_count > 0
RETURN s.id, s.name, s.followers, s.total_view_count, s.followers * 1.0 / s.total_view_count AS ratio
ORDER BY ratio DESC
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
List the 3 games most commonly played by streams with an English language setup.,"MATCH (s:Stream)-[:PLAYS]->(g:Game), (s)-[:HAS_LANGUAGE]->(l:Language {name: ""en""})
RETURN g.name, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
What are the names of the first 3 streams moderated by 'itsbigchase'?,"MATCH (u:User {name: 'itsbigchase'})-[:MODERATOR]->(s:Stream)
RETURN s.name
LIMIT 3",Complex Aggregation Queries,twitch,False,False,False,
Identify the top 5 streams that have users as VIPs.,"MATCH (s:Stream)-[:VIP]->(u:User)
RETURN s.id AS StreamID, s.name AS StreamName, count(u) AS NumberOfVIPUsers
ORDER BY NumberOfVIPUsers DESC
LIMIT 5",Complex Aggregation Queries,twitch,False,False,True,
Which 3 streams have the highest follower count but the lowest total view count?,"MATCH (s:Stream)
RETURN s
ORDER BY s.followers DESC, s.total_view_count ASC
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
What are the top 3 most common games played by streams with a 'ru' language setup?,"MATCH (s:Stream)-[:PLAYS]->(g:Game), (s)-[:HAS_LANGUAGE]->(l:Language {name: 'ru'})
RETURN g.name AS Game, count(s) AS StreamCount
ORDER BY StreamCount DESC
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
Which 3 users have served as moderators for the oldest streams in the database?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH s, u ORDER BY s.createdAt ASC
LIMIT 3
RETURN u.name AS UserName, s.createdAt AS StreamCreationDate",Complex Aggregation Queries,twitch,False,False,True,
Which 3 users are VIPs in the most number of different users' streams?,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(DISTINCT s) AS vipCount
ORDER BY vipCount DESC
LIMIT 3
RETURN u.name, vipCount",Complex Aggregation Queries,twitch,False,False,True,
List all games that have been played by streams associated with the 'ESO Stream Team'.,"MATCH (t:Team {name: 'ESO Stream Team'})<-[:HAS_TEAM]-(s:Stream)-[:PLAYS]->(g:Game)
RETURN DISTINCT g.name AS GameName",Complex Retrieval Queries,twitch,False,False,True,
"What are the top 5 teams by number of associated streams with over 10,000 followers?","MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
WHERE s.followers > 10000
WITH t, count(s) AS streamCount
ORDER BY streamCount DESC
LIMIT 5
RETURN t.name, streamCount",Complex Aggregation Queries,twitch,False,False,True,
List the top 5 users who are moderators in the most number of streams with an 'en' language setup.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
WITH u, count(s) AS moderated_streams
ORDER BY moderated_streams DESC
LIMIT 5
RETURN u.name, moderated_streams",Complex Aggregation Queries,twitch,False,False,True,
List the first 3 streams that were created after 2020.,"MATCH (s:Stream)
WHERE s.createdAt > datetime('2020-01-01T00:00:00Z')
RETURN s
ORDER BY s.createdAt ASC
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
What are the top 5 oldest streams by the 'createdAt' property that are still active?,"MATCH (s:Stream)
WHERE s.createdAt IS NOT NULL
RETURN s
ORDER BY s.createdAt ASC
LIMIT 5",Complex Aggregation Queries,twitch,False,False,True,
Which 3 games are played by streams with the highest ratio of followers to total view counts?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers IS NOT NULL AND s.total_view_count IS NOT NULL AND s.total_view_count > 0
WITH g, s.followers * 1.0 / s.total_view_count AS ratio
ORDER BY ratio DESC
RETURN g.name, COLLECT(ratio)[..3] AS top_ratios
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
List the first 3 streams that were created in 2018.,"MATCH (s:Stream)
WHERE s.createdAt >= datetime('2018-01-01T00:00:00Z') AND s.createdAt < datetime('2019-01-01T00:00:00Z')
RETURN s
ORDER BY s.createdAt ASC
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
What are the top 5 languages associated with streams that have the most moderators?,"MATCH (s:Stream)-[:MODERATOR]->()
WITH s, count{(s)-[:MODERATOR]->()} AS moderatorCount
ORDER BY moderatorCount DESC
LIMIT 5
MATCH (s)-[:HAS_LANGUAGE]->(l:Language)
RETURN l.name, count(l) AS languageCount
ORDER BY languageCount DESC",Complex Aggregation Queries,twitch,False,False,True,
Which 3 streams have the most users as VIPs?,"MATCH (s:Stream)-[:VIP]->(u:User)
WITH s, count(u) AS vipCount
ORDER BY vipCount DESC
LIMIT 3
RETURN s.id AS StreamID, s.name AS StreamName, vipCount",Complex Aggregation Queries,twitch,False,False,True,
List the top 5 streams that are associated with teams and have more than 10000 followers.,"MATCH (s:Stream)-[:HAS_TEAM]->(:Team)
WHERE s.followers > 10000
RETURN s
ORDER BY s.followers DESC
LIMIT 5",Complex Aggregation Queries,twitch,False,False,True,
What are the first 3 streams that have a chatter who is also a moderator?,"MATCH (s:Stream)-[:CHATTER]->(u:User)
WHERE exists {
  MATCH (u)-[:MODERATOR]->(s)
}
RETURN s
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
List the first 3 streams that have a language set to 'en'.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
RETURN s
LIMIT 3",Verbose query,twitch,False,False,True,
What are the top 5 games played by streams with more than 5000 followers?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers > 5000
RETURN g.name, count(s) AS streams_count
ORDER BY streams_count DESC
LIMIT 5",Verbose query,twitch,False,False,True,
Which streams have a total view count above 1 million and are associated with the 'ESO Stream Team'?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
WHERE s.total_view_count > 1000000
RETURN s",Verbose query,twitch,False,False,True,
Identify the first 3 users who are moderators for streams with a description containing 'Belarus'.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WHERE s.description CONTAINS 'Belarus'
RETURN u
LIMIT 3",Verbose query,twitch,False,False,True,
Find the top 5 streams that are playing the game 'Rust'.,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
RETURN s
ORDER BY s.followers DESC
LIMIT 5",Verbose query,twitch,False,False,True,
List the first 3 streams that have at least one VIP who is also a user.,"MATCH (s:Stream)-[:VIP]->(u:User)
WHERE exists{ (s)-[:VIP]->(:User) }
RETURN s
LIMIT 3",Verbose query,twitch,False,False,True,
"Which users are VIPs in streams with a total view count exceeding 500,000?","MATCH (u:User)-[:VIP]->(s:Stream)
WHERE s.total_view_count > 500000
RETURN u",Verbose query,twitch,False,False,True,
Which 3 streams have the most VIP users who also have more than 5000 followers?,"MATCH (s:Stream)-[:VIP]->(u:User)
WHERE u.followers > 5000
WITH s, count(u) AS vipCount
ORDER BY vipCount DESC
LIMIT 3
RETURN s",Complex Aggregation Queries,twitch,False,False,True,
"What are the top 5 games played by streams created after January 1, 2015?","MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.createdAt > datetime('2015-01-01T00:00:00Z')
RETURN g.name, count(s) AS streams_count
ORDER BY streams_count DESC
LIMIT 5",Verbose query,twitch,False,False,True,
Identify the first 3 streams that have moderators with a follower count over 1000.,"MATCH (s:Stream)-[:MODERATOR]->(u:User)
WHERE u.followers > 1000
RETURN s
LIMIT 3",Verbose query,twitch,False,False,True,
List the top 5 most followed streams that are linked to the language 'en'.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
WHERE s.followers IS NOT NULL
RETURN s
ORDER BY s.followers DESC
LIMIT 5",Verbose query,twitch,False,False,True,
Which streams have a follower count between 1000 and 5000 and play the game 'Rust'?,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
WHERE s.followers >= 1000 AND s.followers <= 5000
RETURN s",Verbose query,twitch,False,False,True,
Find the first 3 users who are moderators of more than one stream.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS streams_count
WHERE streams_count > 1
RETURN u
LIMIT 3",Verbose query,twitch,False,False,True,
What are the first 3 streams that have a language set to 'ru'?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'ru'})
RETURN s
LIMIT 3",Verbose query,twitch,False,False,True,
What are the first 3 streams to have a team relationship with 'ESO Stream Team'?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
RETURN s
ORDER BY s.createdAt
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
List the top 5 streams with the most complex URLs.,"MATCH (s:Stream)
WHERE s.url IS NOT NULL
RETURN s
ORDER BY length(s.url) DESC
LIMIT 5",Complex Aggregation Queries,twitch,True,False,False,
"Which 3 streams have the least followers but are associated with a game with more than 100,000 total views?","MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers IS NOT NULL AND g.total_view_count > 100000
RETURN s
ORDER BY s.followers ASC
LIMIT 3",Complex Aggregation Queries,twitch,False,False,False,Game.total_view_count
What are the first 3 streams that have a chatter with a description longer than 50 words?,"MATCH (s:Stream)-[:CHATTER]->(u:User)
WHERE size(split(u.description, ' ')) > 50
RETURN s
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
List the top 5 streams that have the most number of languages associated.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH s, count(l) AS num_languages
ORDER BY num_languages DESC
LIMIT 5
RETURN s.id AS StreamID, s.name AS StreamName, num_languages",Complex Aggregation Queries,twitch,False,False,True,
Which 3 languages are associated with the streams that have the least followers?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
RETURN l.name, s.followers
ORDER BY s.followers ASC
LIMIT 3",Complex Aggregation Queries,twitch,False,False,True,
Show the first 3 tweets that 'Me' has retweeted.,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweeted:Tweet)
RETURN retweeted
ORDER BY retweeted.created_at DESC
LIMIT 3",Complex Retrieval Queries,twitter,False,False,True,
What are the top 3 tweets by favorites posted from 'Graphs Are Everywhere'?,"MATCH (u:User {location: 'Graphs Are Everywhere'})-[:POSTS]->(t:Tweet)
RETURN t
ORDER BY t.favorites DESC
LIMIT 3",Simple Retrieval Queries,twitter,False,False,True,
Who are the top 5 users with similar screen names to 'Neo4j'?,"MATCH (u:User)
WHERE u.screen_name CONTAINS 'Neo4j'
RETURN u
ORDER BY u.screen_name
LIMIT 5",Complex Retrieval Queries,twitter,False,False,True,
Show the first 3 hashtags tagged in tweets that have been retweeted more than 100 times.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.favorites > 100
RETURN h.name AS Hashtag
LIMIT 3",Complex Retrieval Queries,twitter,False,False,False,
Find all tweets by 'Neo4j' that mention 'Me'.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:MENTIONS]->(m:Me)
RETURN t",Complex Retrieval Queries,twitter,False,False,True,
Which users with a profile image URL containing 'horned_reaper' follow 'Neo4j'?,"MATCH (u:User)-[:FOLLOWS]->(m:Me {screen_name: 'neo4j'})
WHERE u.profile_image_url CONTAINS 'horned_reaper'
RETURN u",Simple Retrieval Queries,twitter,False,False,True,
List the first 3 hashtags used in tweets mentioning 'Neo4j'.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {name: 'Neo4j'})
MATCH (t)-[:TAGS]->(h:Hashtag)
RETURN h.name AS Hashtag
LIMIT 3",Simple Retrieval Queries,twitter,False,False,True,
Who are the top 5 users followed by 'Neo4j' based on betweenness score?,"MATCH (u:User {screen_name: 'neo4j'})-[:FOLLOWS]->(f:User)
RETURN f
ORDER BY f.betweenness DESC
LIMIT 5",Simple Retrieval Queries,twitter,False,False,True,
Identify the top 3 tweets that contain links to 'https://twitter.com'.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WHERE l.url CONTAINS 'https://twitter.com'
RETURN t
ORDER BY t.favorites DESC
LIMIT 3",Simple Retrieval Queries,twitter,False,False,True,
List the first 3 tweets that 'Neo4j' retweets on '2021-03-16'.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:RETWEETS]->(rt:Tweet)
WHERE date(t.created_at) = date('2021-03-16')
RETURN rt
LIMIT 3",Simple Retrieval Queries,twitter,False,False,True,
What are the top 5 sources used in tweets by users located in 'Sweden'?,"MATCH (u:User {location: 'Sweden'})-[:POSTS]->(t:Tweet)-[:USING]->(s:Source)
RETURN s.name, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 5",Simple Retrieval Queries,twitter,False,False,False,
Find all tweets posted by 'Neo4j' containing a hashtag.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN t, h",Complex Retrieval Queries,twitter,False,False,True,
Display the first 3 users followed by 'Neo4j' who have more than 10000 followers.,"MATCH (u:User {screen_name: 'neo4j'})-[:FOLLOWS]->(f:User)
WHERE f.followers > 10000
RETURN f
LIMIT 3",Complex Retrieval Queries,twitter,False,False,True,
Show the top 5 tweets with the most favorites that were posted using 'Buffer'.,"MATCH (t:Tweet)-[:USING]->(s:Source {name: 'Buffer'})
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Complex Retrieval Queries,twitter,False,False,True,
Identify the first 3 hashtags used in tweets that mention 'Neo4j'.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {name: 'Neo4j'})
MATCH (t)-[:TAGS]->(h:Hashtag)
RETURN h.name AS Hashtag
LIMIT 3",Complex Retrieval Queries,twitter,False,False,True,
Display the first 3 tweets by 'Neo4j' that were amplified by 'Me'.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)
WHERE exists {
  (m:Me)-[:AMPLIFIES]->(t)
}
RETURN t
ORDER BY t.created_at ASC
LIMIT 3",Complex Retrieval Queries,twitter,False,False,False,
List all tweets by 'Neo4j' that reply to another tweet.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:REPLY_TO]->(other:Tweet)
RETURN t, other",Complex Retrieval Queries,twitter,False,False,True,
List the first 3 links contained in tweets posted by 'Neo4j'.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN l.url
LIMIT 3",Complex Retrieval Queries,twitter,False,False,True,
Find the top 5 tweets with the highest number of favorites.,"MATCH (t:Tweet)
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Complex Retrieval Queries,twitter,False,False,True,
Who are the top 3 users most similar to 'Neo4j' based on similarity score?,"MATCH (u:User {screen_name: 'neo4j'})-[:SIMILAR_TO]->(similar:User)
RETURN similar
ORDER BY similar.score DESC
LIMIT 3",Complex Retrieval Queries,twitter,False,False,False,User.score
Identify the first 3 tweets by 'Neo4j' that retweet another user's tweets.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:RETWEETS]->(:Tweet)
RETURN t
ORDER BY t.created_at ASC
LIMIT 3",Complex Retrieval Queries,twitter,False,False,True,
Show all tweets that mention 'Neo4j' and contain a link.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {name: 'Neo4j'}), (t)-[:CONTAINS]->(l:Link)
RETURN t, l",Complex Retrieval Queries,twitter,False,False,True,
List the first 3 users who follow 'Neo4j' and are located in 'Graphs Are Everywhere'.,"MATCH (u:User)-[:FOLLOWS]->(m:Me {name: 'Neo4j', location: 'Graphs Are Everywhere'})
RETURN u
LIMIT 3",Complex Retrieval Queries,twitter,False,False,True,
Display the top 5 most recent tweets by 'Neo4j'.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)
RETURN t
ORDER BY t.created_at DESC
LIMIT 5",Complex Retrieval Queries,twitter,False,False,True,
Who are the top 3 users followed by 'Me' with the highest betweenness?,"MATCH (me:Me)-[:FOLLOWS]->(user:User)
RETURN user
ORDER BY user.betweenness DESC
LIMIT 3",Complex Retrieval Queries,twitter,False,False,True,
Identify all tweets by 'Neo4j' that mention a user with at least 5000 followers.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:MENTIONS]->(m:User)
WHERE m.followers >= 5000
RETURN t",Complex Retrieval Queries,twitter,False,False,True,
List the top 5 sources used in tweets posted by 'Neo4j'.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:USING]->(s:Source)
RETURN s.name, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 5",Complex Retrieval Queries,twitter,False,False,True,
Show the top 5 users that 'Neo4j' interacts with based on the number of interactions.,"MATCH (u:User {name: 'Neo4j'})-[:INTERACTS_WITH]->(other:User)
RETURN other, count(*) AS interactions
ORDER BY interactions DESC
LIMIT 5",Complex Retrieval Queries,twitter,False,False,True,
List the top 5 users with the highest betweenness.,"MATCH (u:User)
RETURN u
ORDER BY u.betweenness DESC
LIMIT 5",Complex Retrieval Queries,twitter,False,False,True,
List all tweets by 'neo4j' that have more than 200 favorites and show the first 5.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
WHERE t.favorites > 200
RETURN t
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
Identify the first 3 users who interact with 'Neo4j' and have a similar location.,"MATCH (u:User)-[:INTERACTS_WITH]->(n:User {name: 'Neo4j'})
WHERE u.location = n.location AND u.location IS NOT NULL
RETURN u
LIMIT 3",Complex Retrieval Queries,twitter,False,False,False,
List the first 3 users followed by 'neo4j' who have posted a tweet with more than 50 favorites.,"MATCH (u:User {screen_name: 'neo4j'})-[:FOLLOWS]->(f:User)-[:POSTS]->(t:Tweet)
WHERE t.favorites > 50
RETURN f
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
Show the top 5 tweets by 'neo4j' that have been retweeted and contain a link.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(:Link)
WHERE exists{(t)-[:RETWEETS]->(:Tweet)}
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
Find the first 3 users who have amplified tweets posted by 'neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)<-[:AMPLIFIES]-(amplifier:User)
RETURN amplifier
LIMIT 3",Pathfinding Queries,twitter,False,False,False,
What are the top 5 sources used in tweets that mention 'neo4j'?,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {name: 'Neo4j'})
MATCH (t)-[:USING]->(s:Source)
RETURN s.name, count(t) AS mentions
ORDER BY mentions DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
List all tweets by 'neo4j' that reply to another tweet and contain a hashtag.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:REPLY_TO]->(:Tweet), (t)-[:TAGS]->(:Hashtag)
RETURN t",Pathfinding Queries,twitter,False,False,False,
Which users mentioned in 'neo4j' tweets have more following than 'neo4j'?,"MATCH (neo4j:User {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(mentioned:User)
WHERE mentioned.following > neo4j.following
RETURN mentioned",Pathfinding Queries,twitter,False,False,True,
Show the first 3 tweets from 'neo4j' that have been amplified by other users.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
WHERE exists {
  (m:Me)-[:AMPLIFIES]->(t)
}
RETURN t
ORDER BY t.created_at ASC
LIMIT 3",Pathfinding Queries,twitter,False,False,False,
Find the top 5 tweets by 'neo4j' that mention another user and have been retweeted.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:MENTIONS]->(:User)
WHERE exists{(t)-[:RETWEETS]->(:Tweet)}
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
Which users followed by 'neo4j' have a location of 'Graphs Are Everywhere' and list the top 5.,"MATCH (u:User {screen_name: 'neo4j'})-[:FOLLOWS]->(f:User)
WHERE f.location = 'Graphs Are Everywhere'
RETURN f
ORDER BY f.followers DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,False,
List the first 3 users who follow 'neo4j' and have been mentioned in tweets by 'neo4j'.,"MATCH (neo4j:User {screen_name: 'neo4j'})-[:FOLLOWS]->(follower:User)
WHERE exists {
    MATCH (neo4j)-[:POSTS]->(:Tweet)-[:MENTIONS]->(follower)
}
RETURN follower
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
Show the top 5 tweets by 'neo4j' that have been retweeted and tag a hashtag.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:RETWEETS]->(rt:Tweet),
      (t)-[:TAGS]->(h:Hashtag)
RETURN t, rt, h
ORDER BY t.favorites DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
Which tweets by 'neo4j' have been retweeted more than 50 times?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
WHERE t.favorites > 50
RETURN t",Pathfinding Queries,twitter,False,False,True,
Find all tweets that 'neo4j' has retweeted from users located in 'Graphs Are Everywhere' and show the first 5.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(rt:Tweet)-[:RETWEETS]->(t:Tweet)<-[:POSTS]-(other:User {location: 'Graphs Are Everywhere'})
RETURN t
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
List the first 3 tweets from 'neo4j' that contain links to external websites.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN t, l.url
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
What are the names of the top 5 users with the highest number of followers?,"MATCH (u:User)
RETURN u.name
ORDER BY u.followers DESC
LIMIT 5",Complex Aggregation Queries,twitter,False,False,True,
List the top 3 tweets with the most favorites.,"MATCH (t:Tweet)
RETURN t
ORDER BY t.favorites DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,True,
Which users are followed by 'Neo4j' and have more than 1000 followers?,"MATCH (u:User {name: 'Neo4j'})-[:FOLLOWS]->(f:User)
WHERE f.followers > 1000
RETURN f",Complex Aggregation Queries,twitter,False,False,True,
Find the top 5 users with the highest betweenness centrality.,"MATCH (u:User)
RETURN u
ORDER BY u.betweenness DESC
LIMIT 5",Complex Aggregation Queries,twitter,False,False,True,
Who are the top 3 users that 'Neo4j' interacts with most frequently?,"MATCH (u:User {name: 'Neo4j'})-[:INTERACTS_WITH]->(other:User)
RETURN other.name, count(*) AS interactions
ORDER BY interactions DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,True,
What are the names of the top 3 hashtags used in tweets by 'Neo4j'?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN h.name, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,True,
Which sources are used in the top 5 most favorited tweets?,"MATCH (t:Tweet)-[:USING]->(s:Source)
RETURN s.name AS SourceName, t.favorites AS Favorites
ORDER BY t.favorites DESC
LIMIT 5",Complex Aggregation Queries,twitter,False,False,True,
List the top 3 tweets that mention 'Neo4j' and have more than 100 favorites.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {name: 'Neo4j'})
WHERE t.favorites > 100
RETURN t
ORDER BY t.favorites DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,True,
What are the locations of the top 5 users by number of statuses posted?,"MATCH (u:User)
RETURN u.location AS Location, u.statuses AS Statuses
ORDER BY u.statuses DESC
LIMIT 5",Complex Aggregation Queries,twitter,False,False,True,
Who has 'Neo4j' retweeted the most? List the top 3 users.,"MATCH (neo:User {name: 'Neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweetedTweet:Tweet)-[:POSTS]-(retweetedUser:User)
WHERE neo.name IS NOT NULL
RETURN retweetedUser.name, count(retweetedTweet) AS retweets
ORDER BY retweets DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,True,
Which users followed by 'neo4j' have tweeted using the source 'Buffer' and list the top 5.,"MATCH (u:User {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)-[:POSTS]->(t:Tweet)-[:USING]->(s:Source {name: 'Buffer'})
RETURN followed.name, followed.screen_name, t.text
ORDER BY t.created_at DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
Find all users who mention 'neo4j' in their tweets and are located in 'Graphs Are Everywhere'.,"MATCH (u:User {location: 'Graphs Are Everywhere'})-[:POSTS]->(t:Tweet)-[:MENTIONS]->(m:User {name: 'Neo4j'})
RETURN u, t",Pathfinding Queries,twitter,False,False,True,
Show the tweets where 'neo4j' is mentioned and the tweet has a favorite count over 100.,"MATCH (u:User {screen_name: 'neo4j'})-[:MENTIONS]->(t:Tweet)
WHERE t.favorites > 100
RETURN t",Pathfinding Queries,twitter,False,False,False,
Who are the top 5 users that 'neo4j' retweets the most?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:RETWEETS]->(rt:Tweet)-[:POSTS]-(retweeter:User)
RETURN retweeter.screen_name, count(rt) AS retweet_count
ORDER BY retweet_count DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
Show the top 5 tweets that reply to another tweet and contain a link.,"MATCH (t:Tweet)-[:REPLY_TO]->(:Tweet), (t)-[:CONTAINS]->(:Link)
RETURN t
ORDER BY t.created_at DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
Find the first 3 users who follow 'neo4j' and have a betweenness greater than 100 million.,"MATCH (u:User)-[:FOLLOWS]->(m:Me {screen_name: 'neo4j'})
WHERE u.betweenness > 100000000
RETURN u
LIMIT 3",Pathfinding Queries,twitter,False,False,False,
List the first 3 tweets by 'neo4j' that have been tagged with a hashtag and mention another user.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(:Hashtag),
      (t)-[:MENTIONS]->(:User)
RETURN t
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
Which users followed by 'neo4j' have posted tweets mentioning 'neo4j'?,"MATCH (u:User {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(mentioned:User {screen_name: 'neo4j'})
RETURN followed, t",Pathfinding Queries,twitter,False,False,True,
Show the tweets that 'neo4j' has retweeted from users with a lower follower count.,"MATCH (neo4j:User {screen_name: 'neo4j'})-[:POSTS]->(retweet:Tweet)-[:RETWEETS]->(original:Tweet)<-[:POSTS]-(otherUser:User)
WHERE neo4j.followers > otherUser.followers
RETURN original AS TweetRetweeted, otherUser AS OriginalPoster",Pathfinding Queries,twitter,False,False,True,
What are the top 5 locations of users who interact with 'neo4j'?,"MATCH (u:User {screen_name: 'neo4j'})-[:INTERACTS_WITH]->(other:User)
WHERE other.location IS NOT NULL
RETURN other.location AS Location, count(other) AS InteractionCount
ORDER BY InteractionCount DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
List all tweets from 'neo4j' that have been amplified and show the first 5.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
WHERE exists {
    (u)-[:AMPLIFIES]->(:User)-[:POSTS]->(t)
}
RETURN t
LIMIT 5",Pathfinding Queries,twitter,False,False,False,
Find the first 3 users who have retweeted tweets posted by 'neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)<-[:RETWEETS]-(rt:Tweet)<-[:POSTS]-(ru:User)
RETURN ru
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
Which tweets posted by 'neo4j' mention a user with a follower count greater than 'neo4j'?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:MENTIONS]->(mentioned:User)
WHERE mentioned.followers > u.followers
RETURN t",Pathfinding Queries,twitter,False,False,True,
Display the first 3 tweets by 'neo4j' that use the source 'Buffer'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:USING]->(s:Source {name: 'Buffer'})
RETURN t
ORDER BY t.created_at ASC
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
Who are the top 5 users followed by 'neo4j' with the highest betweenness?,"MATCH (u:User {screen_name: 'neo4j'})-[:FOLLOWS]->(f:User)
WHERE f.betweenness IS NOT NULL
RETURN f
ORDER BY f.betweenness DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
List the first 3 tweets where 'neo4j' is mentioned and the tweet has been favorited more than 50 times.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {screen_name: 'neo4j'})
WHERE t.favorites > 50
RETURN t
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
What are the top 5 hashtags in tweets retweeted by 'neo4j'?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:RETWEETS]->(rt:Tweet)-[:TAGS]->(h:Hashtag)
RETURN h.name, count(h) AS hashtag_count
ORDER BY hashtag_count DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
Find all tweets from users who follow 'neo4j' and list the top 5.,"MATCH (u:User)-[:FOLLOWS]->(m:Me {screen_name: 'neo4j'})
MATCH (u)-[:POSTS]->(t:Tweet)
RETURN t
ORDER BY t.created_at DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
Which users followed by 'neo4j' have a higher status count than 'neo4j'?,"MATCH (n:User {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)
WHERE u.statuses > n.statuses
RETURN u",Pathfinding Queries,twitter,False,False,False,
Show the first 3 tweets from users who have interacted with 'neo4j'.,"MATCH (u:User)-[:INTERACTS_WITH]->(neo4j:User {screen_name: 'neo4j'})
MATCH (u)-[:POSTS]->(t:Tweet)
RETURN t
ORDER BY t.created_at ASC
LIMIT 3",Pathfinding Queries,twitter,False,False,False,
List the first 3 users similar to 'neo4j' with a similarity score below 0.5.,"MATCH (u:User {screen_name: 'neo4j'})-[:SIMILAR_TO]->(similar:User)
WHERE similar.score < 0.5
RETURN similar
LIMIT 3",Pathfinding Queries,twitter,False,False,False,User.score
Which tweets posted by 'neo4j' have been tagged with 'education'?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN t",Pathfinding Queries,twitter,False,False,True,
Show the top 5 tweets that contain links and are retweeted by 'neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:RETWEETS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN t, l
ORDER BY t.favorites DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,False,
Find the first 3 tweets by 'neo4j' that reply to another tweet.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:REPLY_TO]->(:Tweet)
RETURN t
ORDER BY t.created_at ASC
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
Who are the top 5 users that 'neo4j' mentions the most in tweets?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:MENTIONS]->(mentioned:User)
RETURN mentioned.name, count(t) AS mentions_count
ORDER BY mentions_count DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
Identify the top 5 users who have exactly 663 followers.,"MATCH (u:User)
WHERE u.followers = 663
RETURN u
ORDER BY u.betweenness DESC
LIMIT 5",Simple Retrieval Queries,twitter,False,False,True,
Which users does 'neo4j' amplify the most and list the top 5?,"MATCH (me:Me {screen_name: 'neo4j'})-[:AMPLIFIES]->(user:User)
RETURN user, count(*) AS amplification_count
ORDER BY amplification_count DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
Find the first 3 users who have mentioned 'neo4j' in tweets and follow 'neo4j'.,"MATCH (u:User)-[:FOLLOWS]->(neo:User {screen_name: 'neo4j'}),
      (u)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(neo)
RETURN u
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
List the first 3 tweets from 'neo4j' that have been retweeted and mention another user.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
WHERE exists{(t)-[:RETWEETS]->(:Tweet)} AND exists{(t)-[:MENTIONS]->(:User)}
RETURN t
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
Find the top 5 tweets with links and sort them by number of favorites.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
RETURN t.id, t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 5",Complex Aggregation Queries,twitter,False,False,True,
What are the screen names of the top 3 users who have posted the most tweets?,"MATCH (u:User)-[:POSTS]->(t:Tweet)
WITH u, count(t) AS tweetsCount
ORDER BY tweetsCount DESC
LIMIT 3
RETURN u.screen_name AS screen_name",Complex Aggregation Queries,twitter,False,False,True,
Which hashtags have been tagged in tweets that have more than 200 favorites? List the top 3.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.favorites > 200
RETURN h.name, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,False,
List the top 3 users with the lowest following counts who follow 'Neo4j'.,"MATCH (u:User)-[:FOLLOWS]->(m:Me {screen_name: 'neo4j'})
RETURN u
ORDER BY u.following ASC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,True,
Who are the top 3 users mentioned in tweets posted by 'Me'?,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(user:User)
RETURN user, count(tweet) AS mentions
ORDER BY mentions DESC
LIMIT 3",Verbose query,twitter,False,False,True,
What are the first 3 links contained in tweets posted by 'Me'?,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:CONTAINS]->(link:Link)
RETURN link.url
LIMIT 3",Verbose query,twitter,False,False,True,
Identify the first 3 tweets posted by 'Me' that reply to another tweet.,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:REPLY_TO]->(:Tweet)
RETURN tweet
ORDER BY tweet.created_at ASC
LIMIT 3",Verbose query,twitter,False,False,True,
List the top 5 tweets by 'Me' using a specific source named 'Buffer'.,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:USING]->(source:Source {name: 'Buffer'})
RETURN tweet
ORDER BY tweet.created_at DESC
LIMIT 5",Verbose query,twitter,False,False,True,
Which users does 'Neo4j' follow that have a location set to 'Graphs Are Everywhere'?,"MATCH (u:User {name: 'Neo4j'})-[:FOLLOWS]->(f:User)
WHERE f.location = 'Graphs Are Everywhere'
RETURN f",Verbose query,twitter,False,False,False,
List the first 3 tweets containing a hashtag named 'education'.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN t
LIMIT 3",Verbose query,twitter,False,False,True,
Who are the top 5 users that 'Neo4j' interacts with and also follows?,"MATCH (u:User {name: 'Neo4j'})-[:INTERACTS_WITH]->(other:User)
WHERE exists{(u)-[:FOLLOWS]->(other)}
RETURN other
ORDER BY other.followers DESC
LIMIT 5",Verbose query,twitter,False,False,True,
What are the top 3 tweets that retweet a tweet by 'Neo4j'?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(original:Tweet)-[:RETWEETS]->(retweet:Tweet)
RETURN retweet
ORDER BY retweet.favorites DESC
LIMIT 3",Verbose query,twitter,False,False,True,
List the first 3 users followed by 'Me' who have a profile image URL ending with 'normal.jpg'.,"MATCH (me:Me)-[:FOLLOWS]->(user:User)
WHERE user.profile_image_url ENDS WITH 'normal.jpg'
RETURN user
LIMIT 3",Verbose query,twitter,False,False,True,
Identify the top 5 tweets by 'Neo4j' that have been favorited more than 100 times.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)
WHERE t.favorites > 100
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Verbose query,twitter,False,False,True,
Which users followed by 'Neo4j' have a URL starting with 'https'?,"MATCH (u:User {name: 'Neo4j'})-[:FOLLOWS]->(f:User)
WHERE f.url STARTS WITH 'https'
RETURN f",Verbose query,twitter,False,False,True,
List the first 3 hashtags used in tweets that 'Me' posts.,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:TAGS]->(hashtag:Hashtag)
RETURN hashtag.name
LIMIT 3",Verbose query,twitter,False,False,True,
Who are the top 3 users mentioned in the tweets that 'Me' retweets?,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweetedTweet:Tweet)-[:MENTIONS]->(mentionedUser:User)
RETURN mentionedUser.name, count(mentionedUser) AS mentionsCount
ORDER BY mentionsCount DESC
LIMIT 3",Verbose query,twitter,False,False,True,
What are the first 3 sources used in tweets that 'Me' amplifies?,"MATCH (me:Me)-[:AMPLIFIES]->(user:User)-[:POSTS]->(tweet:Tweet)-[:USING]->(source:Source)
RETURN DISTINCT source
LIMIT 3",Verbose query,twitter,False,False,True,
List the first 3 tweets by 'Neo4j' that contain a link to 'https://twitter.com'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
WHERE l.url CONTAINS 'https://twitter.com'
RETURN t
LIMIT 3",Verbose query,twitter,False,False,True,
Which users does 'Me' follow that are similar to 'Neo4j' with a similarity score above 0.8?,"MATCH (me:Me)-[:FOLLOWS]->(user:User)-[sim:SIMILAR_TO]->(neo4j:User {name: 'Neo4j'})
WHERE sim.score > 0.8
RETURN user",Verbose query,twitter,False,False,False,
List the first 3 users that 'Me' interacts with who have a betweenness greater than 100000000.,"MATCH (me:Me)-[:INTERACTS_WITH]->(user:User)
WHERE user.betweenness > 100000000
RETURN user
LIMIT 3",Verbose query,twitter,False,False,False,
Identify the top 5 users who follow 'Neo4j' and are located in 'Graphs Are Everywhere'.,"MATCH (u:User)-[:FOLLOWS]->(m:Me {name: 'Neo4j', location: 'Graphs Are Everywhere'})
RETURN u
ORDER BY u.followers DESC
LIMIT 5",Verbose query,twitter,False,False,True,
What are the first 3 tweets posted by 'Me' that tag a hashtag named 'education'?,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:TAGS]->(hashtag:Hashtag {name: 'education'})
RETURN tweet
ORDER BY tweet.created_at ASC
LIMIT 3",Verbose query,twitter,False,False,True,
List the top 5 users that 'Me' mentions in tweets.,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(user:User)
RETURN user, count(tweet) AS mentions
ORDER BY mentions DESC
LIMIT 5",Verbose query,twitter,False,False,True,
Who are the top 3 users that 'Neo4j' retweets?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:RETWEETS]->(rt:Tweet)-[:POSTS]-(retweetUser:User)
RETURN retweetUser.name AS UserName, COUNT(rt) AS RetweetCount
ORDER BY RetweetCount DESC
LIMIT 3",Verbose query,twitter,False,False,True,
Identify the first 3 links in tweets posted by 'Neo4j' that lead to a government website.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
WHERE l.url CONTAINS 'gov'
RETURN l.url
LIMIT 3",Verbose query,twitter,False,False,False,
List the top 5 tweets by 'Me' that were created between January and February 2021.,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)
WHERE tweet.created_at >= datetime('2021-01-01T00:00:00Z') AND tweet.created_at <= datetime('2021-02-28T23:59:59Z')
RETURN tweet
ORDER BY tweet.favorites DESC
LIMIT 5",Verbose query,twitter,False,False,True,
Which users followed by 'Neo4j' have a profile image URL that does not end with 'normal.jpg'?,"MATCH (u:User {name: 'Neo4j'})-[:FOLLOWS]->(f:User)
WHERE f.profile_image_url IS NOT NULL AND NOT f.profile_image_url ENDS WITH 'normal.jpg'
RETURN f",Verbose query,twitter,False,False,True,
List the first 3 hashtags used in tweets that 'Neo4j' amplifies.,"MATCH (me:Me {name: 'Neo4j'})-[:AMPLIFIES]->(tweet:Tweet)-[:TAGS]->(hashtag:Hashtag)
RETURN hashtag.name
LIMIT 3",Verbose query,twitter,False,False,False,
List the top 3 users who follow 'Me' and also have a following count over 10000.,"MATCH (u:User)-[:FOLLOWS]->(me:Me)
WHERE u.following > 10000
RETURN u
ORDER BY u.following DESC
LIMIT 3",Verbose query,twitter,False,False,True,
Which tweets posted by 'neo4j' have been retweeted by other users?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
WHERE exists{(t)-[:RETWEETS]->(:Tweet)}
RETURN t",Pathfinding Queries,twitter,False,False,True,
Which users are amplified by 'Me' according to the AMPLIFIES relationship?,"MATCH (me:Me)-[:AMPLIFIES]->(user:User)
RETURN user",Verbose query,twitter,False,False,True,
Which users are similar to 'Neo4j' with a similarity score above 0.5?,"MATCH (u:User {name: 'Neo4j'})-[:SIMILAR_TO {score: score}]->(similar:User)
WHERE score > 0.5
RETURN similar",Verbose query,twitter,True,False,False,
Which users have a similar score greater than 0.5 with 'Neo4j'? List the top 3.,"MATCH (u:User)-[s:SIMILAR_TO]->(m:Me {name: 'Neo4j'})
WHERE s.score > 0.5
RETURN u.name, s.score
ORDER BY s.score DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,False,
Who are the top 5 most followed users that 'Neo4j' amplifies?,"MATCH (me:Me {name: 'Neo4j'})-[:AMPLIFIES]->(user:User)
RETURN user
ORDER BY user.followers DESC
LIMIT 5",Complex Aggregation Queries,twitter,False,False,True,
List the profile image URLs of the top 3 users who have mentioned 'Neo4j' in their tweets.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(m:User {name: 'Neo4j'})
RETURN u.profile_image_url
ORDER BY t.created_at DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,True,
What are the URLs of the top 3 most favorited tweets containing links?,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
RETURN t.id AS TweetID, l.url AS LinkURL, t.favorites AS Favorites
ORDER BY t.favorites DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,True,
Who are the top 3 followers of 'Neo4j' based on betweenness centrality?,"MATCH (u:User)-[:FOLLOWS]->(m:Me {name: 'Neo4j'})
RETURN u.name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,True,
List the names of the top 5 tweets that reply to another tweet and have more than 50 favorites.,"MATCH (t:Tweet)-[:REPLY_TO]->(:Tweet)
WHERE t.favorites > 50
RETURN t.text AS TweetName
ORDER BY t.favorites DESC
LIMIT 5",Complex Aggregation Queries,twitter,False,False,True,
What are the top 3 locations where users who interact with 'Neo4j' are based?,"MATCH (u:User)-[:INTERACTS_WITH]->(m:Me {name: 'Neo4j'})
WHERE u.location IS NOT NULL
RETURN u.location AS Location, count(u) AS UserCount
ORDER BY UserCount DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,False,
Which users followed by 'Neo4j' have posted the most about a specific hashtag? List the top 3.,"MATCH (u:User {name: 'Neo4j'})-[:FOLLOWS]->(followed:User)-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE h.name = 'specificHashtag'
WITH followed, count(t) AS tweetsCount
ORDER BY tweetsCount DESC
LIMIT 3
RETURN followed.name, tweetsCount",Complex Aggregation Queries,twitter,False,False,False,
Find the top 5 tweets by 'Neo4j' using a specific source.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:USING]->(s:Source)
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Complex Aggregation Queries,twitter,False,False,True,
What are the top 3 hashtags used in the tweets that have been retweeted by 'Neo4j'?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:RETWEETS]->(rt:Tweet)-[:TAGS]->(h:Hashtag)
RETURN h.name, count(h) AS usage
ORDER BY usage DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,True,
List the top 3 tweets from 'Neo4j' that have been retweeted more than 100 times.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)
WHERE t.favorites > 100
RETURN t
ORDER BY t.favorites DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,True,
Which users have 'Neo4j' mentioned the most in tweets? List the top 3.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(m:User {name: 'Neo4j'})
WITH u, count(t) AS mentions
ORDER BY mentions DESC
LIMIT 3
RETURN u.name, mentions",Complex Aggregation Queries,twitter,False,False,True,
Find the top 5 users who follow 'Neo4j' and are from the same location as 'Neo4j'.,"MATCH (me:Me {name: 'Neo4j'})
MATCH (user:User)-[:FOLLOWS]->(me)
WHERE user.location = me.location
RETURN user
ORDER BY user.followers DESC
LIMIT 5",Complex Aggregation Queries,twitter,False,False,False,
What are the URL profiles of the top 3 users who have retweeted 'Neo4j's tweets?,"MATCH (neo:User {name: ""Neo4j""})-[:POSTS]->(tweet:Tweet)<-[:RETWEETS]-(user:User)
RETURN user.profile_image_url AS ProfileURL
ORDER BY tweet.created_at DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,False,
List the names of the top 5 users who have the highest scores of being similar to 'Neo4j'.,"MATCH (u:User)-[s:SIMILAR_TO]->(m:Me {name: 'Neo4j'})
RETURN u.name AS UserName, s.score AS SimilarityScore
ORDER BY s.score DESC
LIMIT 5",Complex Aggregation Queries,twitter,False,False,True,
Who are the top 3 users that 'Neo4j' follows and have tweeted more than 500 times?,"MATCH (u:User {name: 'Neo4j'})-[:FOLLOWS]->(followed:User)
WHERE followed.statuses > 500
RETURN followed
ORDER BY followed.statuses DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,True,
Who are the top 5 users that a specific user named 'Neo4j' follows?,"MATCH (u:User {name: 'Neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed
ORDER BY followed.followers DESC
LIMIT 5",Verbose query,twitter,False,False,True,
List the first 3 users followed by a user with the screen name 'thobe'.,"MATCH (u:User {screen_name: 'thobe'})-[:FOLLOWS]->(followed:User)
RETURN followed
LIMIT 3",Verbose query,twitter,False,False,True,
What are the top 3 tweets posted by the user with the screen name 'neo4j'?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
RETURN t
ORDER BY t.created_at DESC
LIMIT 3",Verbose query,twitter,False,False,True,
Which users have a betweenness greater than 300000000?,"MATCH (u:User)
WHERE u.betweenness > 300000000
RETURN u",Verbose query,twitter,False,False,True,
Identify the first 3 users followed by 'Neo4j' who have more than 500 followers.,"MATCH (u:User {screen_name: 'neo4j'})-[:FOLLOWS]->(f:User)
WHERE f.followers > 500
RETURN f
ORDER BY f.followers DESC
LIMIT 3",Verbose query,twitter,False,False,True,
List the top 5 tweets that mention the user with the screen name 'neo4j'.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {screen_name: 'neo4j'})
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Verbose query,twitter,False,False,True,
What are the top 5 hashtags used in tweets by the user named 'Neo4j'?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN h.name, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 5",Verbose query,twitter,False,False,True,
List the first 3 sources used in tweets posted by 'Neo4j'.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:USING]->(s:Source)
RETURN DISTINCT s.name
LIMIT 3",Verbose query,twitter,False,False,True,
Who are the top 5 users interacting with 'Neo4j' via the INTERACTS_WITH relationship?,"MATCH (u:User)-[:INTERACTS_WITH]->(m:User {name: 'Neo4j'})
RETURN u
ORDER BY u.followers DESC
LIMIT 5",Verbose query,twitter,False,False,False,
Show the first 3 tweets that 'Neo4j' retweets.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:RETWEETS]->(rt:Tweet)
RETURN rt
ORDER BY rt.created_at DESC
LIMIT 3",Verbose query,twitter,False,False,True,
List all users who have both posted a tweet mentioning 'Neo4j' and have been mentioned by 'Neo4j' in a tweet.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(m:User {name: 'Neo4j'})
WHERE EXISTS {
    (m)-[:POSTS]->(:Tweet)-[:MENTIONS]->(u)
}
RETURN u",Complex Retrieval Queries,twitter,False,False,True,
Find all users who follow 'neo4j' and are located in 'Graphs Are Everywhere'.,"MATCH (u:User)-[:FOLLOWS]->(m:Me {screen_name: 'neo4j', location: 'Graphs Are Everywhere'})
WHERE u.location = 'Graphs Are Everywhere'
RETURN u",Pathfinding Queries,twitter,False,False,False,
Show the first 3 users followed by 'neo4j' who also follow 'neo4j'.,"MATCH (u1:User {screen_name: 'neo4j'})-[:FOLLOWS]->(u2:User)-[:FOLLOWS]->(u3:User {screen_name: 'neo4j'})
RETURN u2
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
List the top 3 tweets with the highest number of favorites.,"MATCH (t:Tweet)
RETURN t
ORDER BY t.favorites DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
What are the top 5 tweets by 'Neo4j' based on favorites count?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Simple Aggregation Queries,twitter,False,False,True,
Who are the top 3 users that 'Neo4j' follows?,"MATCH (u:User {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed
ORDER BY followed.followers DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
What are the names of the top 3 hashtags used in tweets?,"MATCH (:Tweet)-[:TAGS]->(h:Hashtag)
RETURN h.name AS Hashtag, count(*) AS UsageCount
ORDER BY UsageCount DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
Which tweets contain links and have more than 100 favorites?,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WHERE t.favorites > 100
RETURN t, l",Simple Aggregation Queries,twitter,False,False,True,
Who are the top 5 users most similar to 'Neo4j' based on the similarity score?,"MATCH (u:User {screen_name: 'neo4j'})-[:SIMILAR_TO]->(similar:User)
RETURN similar.name, similar.screen_name, similar.location, similar.followers
ORDER BY similar.score DESC
LIMIT 5",Simple Aggregation Queries,twitter,False,False,False,User.score
What are the top 3 sources used in tweets by 'Neo4j'?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:USING]->(s:Source)
RETURN s.name, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
Which users have a betweenness higher than 1000000?,"MATCH (u:User)
WHERE u.betweenness > 1000000
RETURN u",Simple Aggregation Queries,twitter,False,False,True,
Find the top 3 users based on the number of statuses they have posted.,"MATCH (u:User)-[:POSTS]->(t:Tweet)
RETURN u.name, count(t) AS num_statuses
ORDER BY num_statuses DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
What are the 3 most recent tweets posted by any user?,"MATCH (u:User)-[:POSTS]->(t:Tweet)
RETURN t
ORDER BY t.created_at DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
Who are the users mentioned in the most favorited tweet?,"MATCH (t:Tweet)-[:MENTIONS]->(u:User)
RETURN u
ORDER BY t.favorites DESC
LIMIT 1",Simple Aggregation Queries,twitter,False,False,True,
Which users follow 'Neo4j' and have more than 500 followers?,"MATCH (u:User)-[:FOLLOWS]->(m:Me {name: 'Neo4j'})
WHERE u.followers > 500
RETURN u",Simple Aggregation Queries,twitter,False,False,True,
List the top 3 tweets that mention 'Neo4j'.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {name: 'Neo4j'})
RETURN t
ORDER BY t.favorites DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
What are the top 3 tweets retweeted by other users?,"MATCH (t:Tweet)<-[:RETWEETS]-(other:User)
RETURN t, count(other) AS retweet_count
ORDER BY retweet_count DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,False,
Which users have the highest following to follower ratio?,"MATCH (u:User)
WHERE u.followers > 0
RETURN u, (toFloat(u.following) / u.followers) AS ratio
ORDER BY ratio DESC",Simple Aggregation Queries,twitter,False,False,True,
List the top 5 users based on betweenness centrality.,"MATCH (u:User)
RETURN u
ORDER BY u.betweenness DESC
LIMIT 5",Simple Aggregation Queries,twitter,False,False,True,
What are the top 3 locations from where the most tweets originate?,"MATCH (u:User)-[:POSTS]->(t:Tweet)
WHERE u.location IS NOT NULL
RETURN u.location AS Location, count(t) AS TweetCount
ORDER BY TweetCount DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
Which tweets from 'Neo4j' mention other users and what are these users' screen names?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:MENTIONS]->(other:User)
RETURN t, other.screen_name",Simple Aggregation Queries,twitter,False,False,True,
Who are the top 3 users that have interacted with 'Neo4j' the most?,"MATCH (u:User)-[:INTERACTS_WITH]->(n:User {name: 'Neo4j'})
RETURN u.name, count(*) AS interactions
ORDER BY interactions DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,False,
List the 5 most recent users who started following 'Neo4j'.,"MATCH (u:User)-[f:FOLLOWS]->(m:Me {screen_name: 'neo4j'})
RETURN u
ORDER BY f.date DESC
LIMIT 5",Simple Aggregation Queries,twitter,False,False,True,FOLLOWS.date
What are the top 3 hashtags associated with tweets that have been retweeted more than 50 times?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.favorites > 50
RETURN h.name, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
Which tweets have been replied to and have more than 50 favorites?,"MATCH (t:Tweet)-[:REPLY_TO]->(:Tweet)
WHERE t.favorites > 50
RETURN t",Simple Aggregation Queries,twitter,False,False,True,
List the top 3 users with the lowest number of followers who follow 'Neo4j'.,"MATCH (u:User)-[:FOLLOWS]->(m:Me {screen_name: 'neo4j'})
RETURN u
ORDER BY u.followers ASC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
What are the top 3 tweets with the least favorites posted by 'Neo4j'?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)
RETURN t
ORDER BY t.favorites ASC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
Who are the top 5 followers of 'Neo4j' based on the number of statuses they have?,"MATCH (u:User)-[:FOLLOWS]->(m:Me {screen_name: 'neo4j'})
RETURN u.name, u.screen_name, u.statuses
ORDER BY u.statuses DESC
LIMIT 5",Simple Aggregation Queries,twitter,False,False,True,
What are the top 5 users with the highest number of followers?,"MATCH (u:User)
RETURN u
ORDER BY u.followers DESC
LIMIT 5",Simple Aggregation Queries,twitter,False,False,True,
Who are the top 3 users with the most statuses who follow 'Neo4j'?,"MATCH (u:User)-[:FOLLOWS]->(n:User {screen_name: 'neo4j'})
RETURN u.name, u.screen_name, u.statuses
ORDER BY u.statuses DESC
LIMIT 3",Complex Retrieval Queries,twitter,False,False,True,
Display all tweets by 'Neo4j' that mention a user and contain a hashtag.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:MENTIONS]->(:User),
      (t)-[:TAGS]->(:Hashtag)
RETURN t",Complex Retrieval Queries,twitter,False,False,True,
Show the top 5 tweets by 'Neo4j' that were posted from a location outside 'Graphs Are Everywhere'.,"MATCH (u:User {name: ""Neo4j""})-[:POSTS]->(t:Tweet)
WHERE u.location IS NOT NULL AND u.location <> ""Graphs Are Everywhere""
RETURN t
ORDER BY t.created_at DESC
LIMIT 5",Complex Retrieval Queries,twitter,False,False,False,
Who are the top 3 users that 'Neo4j' amplifies the most?,"MATCH (me:Me {name: 'Neo4j'})-[:AMPLIFIES]->(user:User)
RETURN user, count(*) AS amplification_count
ORDER BY amplification_count DESC
LIMIT 3",Complex Retrieval Queries,twitter,False,False,True,
List the first 3 tweets by 'Me' that contain a link.,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:CONTAINS]->(link:Link)
RETURN tweet, link
LIMIT 3",Complex Retrieval Queries,twitter,False,False,True,
Find all tweets by 'Neo4j' that were posted on or after '2021-01-01'.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)
WHERE t.created_at >= datetime('2021-01-01T00:00:00Z')
RETURN t",Complex Retrieval Queries,twitter,False,False,True,
Display the top 5 users who follow both 'Neo4j' and 'Me'.,"MATCH (u:User)-[:FOLLOWS]->(neo:User {name: 'Neo4j'}),
      (u)-[:FOLLOWS]->(me:Me)
RETURN u
LIMIT 5",Complex Retrieval Queries,twitter,False,False,False,
Identify the first 3 tweets by 'Me' that have been mentioned by another user.,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)
WHERE exists {
    (tweet)-[:MENTIONS]->(:User)
}
RETURN tweet
ORDER BY tweet.created_at ASC
LIMIT 3",Complex Retrieval Queries,twitter,False,False,True,
Show all hashtags that have appeared in more than 5 tweets mentioning 'Neo4j'.,"MATCH (h:Hashtag)<-[:TAGS]-(t:Tweet)-[:MENTIONS]->(u:User {name: 'Neo4j'})
WITH h, count(t) AS tweetCount
WHERE tweetCount > 5
RETURN h.name, tweetCount",Complex Retrieval Queries,twitter,False,False,True,
List the top 5 users who have a similar betweenness to 'Neo4j'.,"MATCH (u:User {name: 'Neo4j'})
MATCH (other:User)
WHERE abs(u.betweenness - other.betweenness) < 0.1 AND u.name <> other.name
RETURN other
ORDER BY abs(u.betweenness - other.betweenness) ASC
LIMIT 5",Complex Retrieval Queries,twitter,False,False,False,
Find the first 3 tweets by 'Neo4j' that were favorited more than 300 times.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)
WHERE t.favorites > 300
RETURN t
ORDER BY t.created_at ASC
LIMIT 3",Complex Retrieval Queries,twitter,False,False,True,
Display all tweets by 'Neo4j' that mention at least two different users.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)
WHERE exists {
  MATCH (t)-[:MENTIONS]->(m:User)
  WITH t, count(DISTINCT m) AS mentionCount
  WHERE mentionCount >= 2
  RETURN t
}
RETURN t",Complex Retrieval Queries,twitter,False,False,True,
Identify the first 3 users followed by 'Me' who are located in the same location as 'Me'.,"MATCH (me:Me)-[:FOLLOWS]->(user:User)
WHERE me.location = user.location
RETURN user
LIMIT 3",Complex Retrieval Queries,twitter,False,False,False,
Show the top 5 tweets that 'Me' has replied to.,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:REPLY_TO]->(repliedTweet:Tweet)
RETURN repliedTweet
ORDER BY repliedTweet.created_at DESC
LIMIT 5",Complex Retrieval Queries,twitter,False,False,True,
List all users who have been retweeted by 'Neo4j' at least twice.,"MATCH (neo:User {name: 'Neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweetedTweet:Tweet)<-[:POSTS]-(user:User)
WITH user, count(retweetedTweet) AS retweetCount
WHERE retweetCount >= 2
RETURN user",Complex Retrieval Queries,twitter,False,False,True,
Find the top 5 tweets by 'Neo4j' that contain the hashtag '#education'.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Complex Retrieval Queries,twitter,False,False,True,
Display the first 3 users who mention 'Neo4j' in their tweets and have a similar profile image.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(m:User {name: 'Neo4j'})
WHERE u.profile_image_url = 'http://pbs.twimg.com/profile_images/11837552737537'
RETURN u
LIMIT 3",Complex Retrieval Queries,twitter,False,False,False,
Identify all tweets by 'Neo4j' that were posted using a source other than 'Buffer'.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:USING]->(s:Source)
WHERE NOT s.name = 'Buffer'
RETURN t",Complex Retrieval Queries,twitter,False,False,True,
Show the first 3 tweets mentioning 'Neo4j' that have been retweeted by 'Me'.,"MATCH (me:Me {name: 'Neo4j'})-[:RETWEETS]->(tweet:Tweet)-[:MENTIONS]->(user:User {name: 'Neo4j'})
RETURN tweet
LIMIT 3",Complex Retrieval Queries,twitter,False,False,False,
List the top 5 users who interact most frequently with both 'Neo4j' and 'Me'.,"MATCH (u:User)-[:INTERACTS_WITH]->(neo:User {name: 'Neo4j'}),
      (u)-[:INTERACTS_WITH]->(me:Me)
WITH u, count{(u)-[:INTERACTS_WITH]->(neo)} AS interactions_with_neo, count{(u)-[:INTERACTS_WITH]->(me)} AS interactions_with_me
ORDER BY interactions_with_neo + interactions_with_me DESC
LIMIT 5
RETURN u.name, interactions_with_neo, interactions_with_me",Complex Retrieval Queries,twitter,False,False,False,
Find all tweets by 'Neo4j' that tag a hashtag and mention a user.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag),
      (t)-[:MENTIONS]->(m:User)
RETURN t, h, m",Complex Retrieval Queries,twitter,False,False,True,
Display the first 3 users with the highest following who follow 'Neo4j'.,"MATCH (u:User)-[:FOLLOWS]->(me:Me {name: 'Neo4j'})
RETURN u
ORDER BY u.following DESC
LIMIT 3",Complex Retrieval Queries,twitter,False,False,True,
Who are the top 5 most recent users followed by 'Neo4j'?,"MATCH (u:User {screen_name: 'neo4j'})-[:FOLLOWS]->(f:User)
RETURN f
ORDER BY f.followers DESC
LIMIT 5",Complex Retrieval Queries,twitter,False,False,True,
Identify the first 3 tweets by 'Neo4j' that contain a link to an external website.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
WHERE NOT l.url STARTS WITH 'https://twitter.com'
RETURN t
ORDER BY t.created_at ASC
LIMIT 3",Complex Retrieval Queries,twitter,False,False,True,
Show all tweets that 'Me' has amplified.,"MATCH (me:Me)-[:AMPLIFIES]->(user:User)-[:POSTS]->(tweet:Tweet)
RETURN tweet",Complex Retrieval Queries,twitter,False,False,True,
List the first 3 hashtags appearing in the latest tweets by 'Neo4j'.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)
WITH t
ORDER BY t.created_at DESC
LIMIT 3
MATCH (t)-[:TAGS]->(h:Hashtag)
RETURN h.name",Complex Retrieval Queries,twitter,False,False,True,
Find the top 5 tweets mentioning 'Neo4j' with the most favorites.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {name: 'Neo4j'})
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Complex Retrieval Queries,twitter,False,False,True,
Who are the top 3 users based on the number of users they interact with?,"MATCH (u:User)-[:INTERACTS_WITH]->(other:User)
WITH u, count(DISTINCT other) AS interactions
ORDER BY interactions DESC
LIMIT 3
RETURN u.name, interactions",Simple Aggregation Queries,twitter,False,False,True,
What are the top 5 tweets containing the hashtag 'education'?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Simple Aggregation Queries,twitter,False,False,True,
Which users are similar to 'Neo4j' with a similarity score above 0.5?,"MATCH (u:User {name: 'Neo4j'})-[:SIMILAR_TO {score: score}]->(similar:User)
WHERE score > 0.5
RETURN similar",Simple Aggregation Queries,twitter,True,False,False,
Who are the top 3 users that 'Neo4j' has amplified?,"MATCH (me:Me {name: 'Neo4j'})-[:AMPLIFIES]->(user:User)
RETURN user
ORDER BY user.followers DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
What are the top 5 locations from where users have tweeted?,"MATCH (u:User)-[:POSTS]->(t:Tweet)
WHERE u.location IS NOT NULL
RETURN u.location AS Location, count(t) AS TweetsCount
ORDER BY TweetsCount DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
List all the tweets that link to a URL containing 'twitter.com'.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WHERE l.url CONTAINS 'twitter.com'
RETURN t",Pathfinding Queries,twitter,False,False,True,
Which users interact most frequently with 'neo4j' and list the top 5?,"MATCH (u:User)-[:INTERACTS_WITH]->(neo:User {screen_name: 'neo4j'})
WITH u, count(*) AS interactions
ORDER BY interactions DESC
LIMIT 5
RETURN u.screen_name, interactions",Pathfinding Queries,twitter,False,False,False,
Show the tweets that replied to a tweet by 'neo4j' and list the first 3.,"MATCH (neo4j:User {screen_name: 'neo4j'})-[:POSTS]->(originalTweet:Tweet)<-[:REPLY_TO]-(replyTweet:Tweet)
RETURN replyTweet
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
What are the top 3 tweets by number of retweets?,"MATCH (t:Tweet)
RETURN t
ORDER BY t.favorites DESC
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
Find all tweets from users located in 'Graphs Are Everywhere' and show the first 5.,"MATCH (u:User {location: 'Graphs Are Everywhere'})-[:POSTS]->(t:Tweet)
RETURN t
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
Who are the top 5 users similar to 'neo4j' based on the similarity score?,"MATCH (u:User {screen_name: 'neo4j'})-[:SIMILAR_TO]->(similar:User)
RETURN similar
ORDER BY similar.score DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,False,User.score
List all the links contained in tweets posted by 'neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN l.url AS LinkURL",Pathfinding Queries,twitter,False,False,True,
Find tweets mentioning any user and list the top 5.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User)
RETURN t
ORDER BY t.created_at DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
What are the top 3 sources from which 'neo4j' has tweeted?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:USING]->(s:Source)
RETURN s.name, count(t) AS tweets_count
ORDER BY tweets_count DESC
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
Display the first 3 tweets from 'neo4j' that contain a hashtag.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(:Hashtag)
RETURN t
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
Who are the first 3 users that 'neo4j' has retweeted?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:RETWEETS]->(rt:Tweet)-[:POSTS]-(ru:User)
RETURN ru
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
Find the top 5 users by number of statuses posted.,"MATCH (u:User)
RETURN u.name, u.screen_name, u.statuses
ORDER BY u.statuses DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
Which tweets from 'neo4j' contain a link to an external website?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN t, l.url AS LinkURL",Pathfinding Queries,twitter,False,False,True,
List the first 3 users followed by 'neo4j' with a betweenness of zero.,"MATCH (u:User {screen_name: 'neo4j'})-[:FOLLOWS]->(f:User)
WHERE f.betweenness = 0
RETURN f
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
Show the tweets with a favorite count between 50 and 100 and list the first 5.,"MATCH (t:Tweet)
WHERE t.favorites >= 50 AND t.favorites <= 100
RETURN t
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
What are the top 5 most active users in terms of tweeting from 'Graphs Are Everywhere'?,"MATCH (u:User {location: 'Graphs Are Everywhere'})-[:POSTS]->(t:Tweet)
RETURN u.name, count(t) AS tweets_count
ORDER BY tweets_count DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
Which users mentioned by 'neo4j' in tweets have more followers than 'neo4j'?,"MATCH (neo4j:User {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(mentioned:User)
WHERE mentioned.followers > neo4j.followers
RETURN mentioned",Pathfinding Queries,twitter,False,False,True,
Show the first 3 tweets that 'neo4j' has amplified.,"MATCH (me:Me {screen_name: 'neo4j'})-[:AMPLIFIES]->(tweet:Tweet)
RETURN tweet
ORDER BY tweet.created_at ASC
LIMIT 3",Pathfinding Queries,twitter,False,False,False,
Find the first 3 tweets where 'neo4j' is mentioned and the tweet is a retweet.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {screen_name: 'neo4j'})
WHERE EXISTS {
  (t)-[:RETWEETS]->(:Tweet)
}
RETURN t
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
Which users does 'neo4j' interact with the most and list the top 5?,"MATCH (u:User {screen_name: 'neo4j'})-[:INTERACTS_WITH]->(other:User)
RETURN other, count(*) AS interactions
ORDER BY interactions DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
List the first 3 users similar to 'neo4j' with a similarity score above 0.5.,"MATCH (u:User {screen_name: 'neo4j'})-[:SIMILAR_TO {score: score}]->(similar:User)
WHERE score > 0.5
RETURN similar
ORDER BY score DESC
LIMIT 3",Pathfinding Queries,twitter,True,False,False,
Show the top 5 users that have posted tweets using the source 'Buffer'.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:USING]->(s:Source {name: 'Buffer'})
RETURN u
ORDER BY count(t) DESC
LIMIT 5",Pathfinding Queries,twitter,True,False,False,
Which tweets have been retweeted by 'neo4j' and contain a hashtag?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:RETWEETS]->(rt:Tweet)
WHERE EXISTS { (rt)-[:TAGS]->(:Hashtag) }
RETURN t, rt",Pathfinding Queries,twitter,False,False,True,
"List the first 3 tweets from users who follow more than 10,000 users.","MATCH (u:User)-[:POSTS]->(t:Tweet)
WHERE u.following > 10000
RETURN t
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
Who follows 'neo4j' and has a higher follower count than 'neo4j'?,"MATCH (u:User)-[:FOLLOWS]->(neo4j:User {screen_name: 'neo4j'})
WHERE u.followers > neo4j.followers
RETURN u",Pathfinding Queries,twitter,False,False,True,
What are the top 5 tweets by 'neo4j' with the most replies?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
WITH t, size((t)-[:REPLY_TO]->(:Tweet)) AS replies
ORDER BY replies DESC
LIMIT 5
RETURN t",Pathfinding Queries,twitter,True,False,False,
Display the first 3 tweets that mention 'neo4j'.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User)
WHERE u.name = 'Neo4j'
RETURN t
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
What are the top 3 hashtags used in tweets posted by 'neo4j'?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN h.name, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
List the top 5 tweets that contain links and are posted by 'Neo4j'.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN t
ORDER BY t.created_at DESC
LIMIT 5",Simple Aggregation Queries,twitter,False,False,True,
What are the top 3 tweets that 'Neo4j' has retweeted?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:RETWEETS]->(rt:Tweet)
RETURN rt
ORDER BY rt.favorites DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
Which users have 'Neo4j' mentioned in its tweets the most?,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(m:User {name: 'Neo4j'})
RETURN u, count(t) AS mentions
ORDER BY mentions DESC",Simple Aggregation Queries,twitter,False,False,True,
List the top 3 tweets from users located in 'Graphs Are Everywhere'.,"MATCH (u:User {location: 'Graphs Are Everywhere'})-[:POSTS]->(t:Tweet)
RETURN t
ORDER BY t.favorites DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
What are the top 5 tweets by favorites that contain the hashtag 'education'?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Simple Aggregation Queries,twitter,False,False,True,
Which users follow 'Neo4j' and are from 'Graphs Are Everywhere'?,"MATCH (u:User)-[:FOLLOWS]->(m:Me {name: 'Neo4j', location: 'Graphs Are Everywhere'})
RETURN u",Simple Aggregation Queries,twitter,False,False,True,
List the 3 most recent tweets that mention 'Neo4j' and contain a link.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {name: 'Neo4j'})
WHERE EXISTS { (t)-[:CONTAINS]->(:Link) }
RETURN t
ORDER BY t.created_at DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
Who are the top 3 users that 'Neo4j' retweets mentions from?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:RETWEETS]->(rt:Tweet)-[:MENTIONS]->(mentioned:User)
RETURN mentioned.name, count(rt) AS retweet_mentions
ORDER BY retweet_mentions DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
What are the top 3 tweets by 'Neo4j' that reply to other tweets?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:REPLY_TO]->(:Tweet)
RETURN t
ORDER BY t.created_at DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
Which tweets have been amplified by 'Neo4j' and have more than 100 favorites?,"MATCH (me:Me {name: 'Neo4j'})-[:AMPLIFIES]->(tweet:Tweet)
WHERE tweet.favorites > 100
RETURN tweet",Simple Aggregation Queries,twitter,False,False,False,
What are the names of the top 3 sources from tweets retweeted by 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweeted:Tweet)
MATCH (retweeted)-[:USING]->(source:Source)
RETURN source.name, count(retweeted) AS retweets
ORDER BY retweets DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
Who are the 3 users with the most tweets that contain the hashtag 'education'?,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
WITH u, count(t) AS tweetCount
ORDER BY tweetCount DESC
LIMIT 3
RETURN u",Simple Aggregation Queries,twitter,False,False,True,
List the top 5 tweets that 'Neo4j' has replied to.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:REPLY_TO]->(rt:Tweet)
RETURN rt
ORDER BY rt.created_at DESC
LIMIT 5",Simple Aggregation Queries,twitter,False,False,True,
What are the top 3 tweets tagged with 'education' that have been retweeted by others?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
WHERE exists{(t)-[:RETWEETS]->(:Tweet)}
RETURN t
ORDER BY t.favorites DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,False,
Which users from 'Graphs Are Everywhere' have posted the most tweets?,"MATCH (u:User {location: 'Graphs Are Everywhere'})-[:POSTS]->(t:Tweet)
RETURN u.name, count(t) AS tweets_count
ORDER BY tweets_count DESC",Simple Aggregation Queries,twitter,False,False,True,
Which users have a betweenness greater than 300 million?,"MATCH (u:User)
WHERE u.betweenness > 300000000
RETURN u",Pathfinding Queries,twitter,False,False,True,
List the top 5 users by number of followers.,"MATCH (u:User)
RETURN u
ORDER BY u.followers DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
Who are the first 3 users that a specific user identified by screen name 'neo4j' follows?,"MATCH (u:User {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
Find all tweets containing the hashtag 'education' and show the first 5.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN t
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
Which users are mentioned in the tweets posted by 'neo4j'?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:MENTIONS]->(mentioned:User)
RETURN DISTINCT mentioned",Pathfinding Queries,twitter,False,False,True,
Show the top 3 most recent tweets by date.,"MATCH (t:Tweet)
RETURN t
ORDER BY t.created_at DESC
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
Which users have posted tweets with more than 100 favorites?,"MATCH (u:User)-[:POSTS]->(t:Tweet)
WHERE t.favorites > 100
RETURN u",Pathfinding Queries,twitter,False,False,True,
List all sources used for tweets and show the first 5.,"MATCH (t:Tweet)-[:USING]->(s:Source)
RETURN DISTINCT s.name
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
Who are the users that have been retweeted by 'neo4j'?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:RETWEETS]->(rt:Tweet)-[:POSTS]-(ru:User)
RETURN DISTINCT ru",Pathfinding Queries,twitter,False,False,True,
Find the top 5 tweets with the highest number of favorites.,"MATCH (t:Tweet)
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
Which users have the highest betweenness and list the top 5.,"MATCH (u:User)
WHERE u.betweenness IS NOT NULL
RETURN u
ORDER BY u.betweenness DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
List the first 3 tweets posted by 'Neo4j' using the source 'Buffer'.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:USING]->(s:Source {name: 'Buffer'})
RETURN t
ORDER BY t.created_at ASC
LIMIT 3",Simple Retrieval Queries,twitter,False,False,True,
Which users followed by 'Neo4j' have posted tweets mentioning 'Neo4j'? Show the top 5.,"MATCH (n:User {name: 'Neo4j'})-[:FOLLOWS]->(u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(m:User {name: 'Neo4j'})
RETURN u.name AS UserName, count(t) AS TweetsCount
ORDER BY TweetsCount DESC
LIMIT 5",Verbose query,twitter,False,False,True,
What are the top 5 hashtags in tweets containing the word 'education'?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.text CONTAINS 'education'
RETURN h.name, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 5",Simple Retrieval Queries,twitter,False,False,True,
List all users who follow 'neo4j'.,"MATCH (u:User)-[:FOLLOWS]->(m:Me {screen_name: 'neo4j'})
RETURN u",Pathfinding Queries,twitter,False,False,True,
Which users have a betweenness higher than 300000000?,"MATCH (u:User)
WHERE u.betweenness > 300000000
RETURN u",Pathfinding Queries,twitter,False,False,True,
Who are the first 5 users retweeted by 'Neo4j'?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:RETWEETS]->(rt:Tweet)-[:POSTS]-(ru:User)
RETURN ru.name AS RetweetedUser
LIMIT 5",Simple Aggregation Queries,twitter,False,False,True,
Identify the top 5 tweets mentioning 'Neo4j' with the greatest number of favorites.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {name: 'Neo4j'})
RETURN t.id AS TweetID, t.text AS TweetText, t.favorites AS Favorites
ORDER BY t.favorites DESC
LIMIT 5",Simple Aggregation Queries,twitter,False,False,True,
What are the top 3 most used hashtags in tweets by 'Neo4j'?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN h.name, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
List the top 5 users who mostly tweet about 'education'.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN u.name AS UserName, count(t) AS TweetCount
ORDER BY TweetCount DESC
LIMIT 5",Simple Aggregation Queries,twitter,False,False,True,
Which 3 tweets have the highest aggregation of favorites and retweets?,"MATCH (t:Tweet)
OPTIONAL MATCH (t)-[:RETWEETS]->(rt:Tweet)
WITH t, coalesce(sum(rt.favorites), 0) AS retweet_favorites
RETURN t.id AS TweetID, t.text AS Text, t.favorites + retweet_favorites AS TotalFavorites
ORDER BY TotalFavorites DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
Identify the top 5 users with the most similar profiles to 'Neo4j' based on betweenness and following.,"MATCH (me:Me {name: 'Neo4j'})
MATCH (user:User)
WHERE user.betweenness = me.betweenness AND user.following = me.following
RETURN user
ORDER BY user.followers DESC
LIMIT 5",Simple Aggregation Queries,twitter,False,False,True,
What are the top 3 most common tweet sources for the user 'neo4j'?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:USING]->(s:Source)
RETURN s.name, count(t) AS tweets_count
ORDER BY tweets_count DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
Who are the first 3 users followed by 'Neo4j'?,"MATCH (u:User {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
"List the top 5 tweets by the total interaction (mentions, retweets, replies).","MATCH (t:Tweet)
WITH t, count{(t)-[:MENTIONS]->()} + count{(t)-[:RETWEETS]->()} + count{(t)-[:REPLY_TO]->()} AS totalInteractions
ORDER BY totalInteractions DESC
LIMIT 5
RETURN t, totalInteractions",Simple Aggregation Queries,twitter,False,False,True,
Which 5 tweets contain the hashtag 'education'?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN t
LIMIT 5",Simple Aggregation Queries,twitter,False,False,True,
Identify the top 3 tweets with links pointing to 'https://twitter.com'.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WHERE l.url STARTS WITH 'https://twitter.com'
RETURN t
ORDER BY t.favorites DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
Which tweets mention the user with the screen name 'neo4j'?,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {screen_name: 'neo4j'})
RETURN t",Pathfinding Queries,twitter,False,False,True,
What are the names of the top 5 users interacting most frequently with others?,"MATCH (u:User)-[:INTERACTS_WITH]->(other:User)
WITH u, count(other) AS interactions
ORDER BY interactions DESC
LIMIT 5
RETURN u.name AS UserName, interactions",Simple Aggregation Queries,twitter,False,False,True,
Who are the top 5 users mentioned in the most tweets?,"MATCH (u:User)<-[:MENTIONS]-(t:Tweet)
WITH u, count(t) AS mentions
ORDER BY mentions DESC
LIMIT 5
RETURN u.name, mentions",Simple Aggregation Queries,twitter,False,False,True,
Identify the top 3 users who have amplified the most tweets.,"MATCH (u:User)-[:AMPLIFIES]->(t:Tweet)
WITH u, count(t) AS amplified_count
ORDER BY amplified_count DESC
LIMIT 3
RETURN u, amplified_count",Simple Aggregation Queries,twitter,False,False,False,
Which 5 tweets have the most replies?,"MATCH (t:Tweet)
WITH t, size((t)<-[:REPLY_TO]-(:Tweet)) AS repliesCount
ORDER BY repliesCount DESC
LIMIT 5
RETURN t, repliesCount",Simple Aggregation Queries,twitter,True,False,False,
List the top 5 tweets that have been retweeted the most times.,"MATCH (t:Tweet)
WITH t, size{(t)-[:RETWEETS]->(:Tweet)} AS retweetCount
ORDER BY retweetCount DESC
LIMIT 5
RETURN t, retweetCount",Simple Aggregation Queries,twitter,True,False,False,
What are the first 3 locations where the most users are based?,"MATCH (u:User)
WHERE u.location IS NOT NULL
RETURN u.location AS Location, count(u) AS UserCount
ORDER BY UserCount DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
Who are the top 3 users most similar to 'Neo4j' based on the SIMILAR_TO score?,"MATCH (u:User {name: 'Neo4j'})-[:SIMILAR_TO]->(similar:User)
RETURN similar.name AS UserName, similar.screen_name AS ScreenName, similar.location AS Location
ORDER BY similar.score DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,False,User.score
List the URLs of the top 3 tweets containing links.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
RETURN t.id AS TweetID, l.url AS LinkURL
ORDER BY t.favorites DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
What are the top 5 most recent tweets based on the creation date?,"MATCH (t:Tweet)
RETURN t
ORDER BY t.created_at DESC
LIMIT 5",Simple Aggregation Queries,twitter,False,False,True,
Identify the top 3 hashtags used in tweets.,"MATCH (:Tweet)-[r:TAGS]->(h:Hashtag)
RETURN h.name, count(r) AS usage
ORDER BY usage DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
Which 5 users have posted the most tweets?,"MATCH (u:User)-[:POSTS]->(t:Tweet)
RETURN u, count(t) AS TweetsCount
ORDER BY TweetsCount DESC
LIMIT 5",Simple Aggregation Queries,twitter,False,False,True,
What are the top 3 sources used most frequently in tweets?,"MATCH (t:Tweet)-[:USING]->(s:Source)
RETURN s.name AS SourceName, count(t) AS TweetCount
ORDER BY TweetCount DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
List the first 5 tweets with the highest number of favorites.,"MATCH (t:Tweet)
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Simple Aggregation Queries,twitter,False,False,True,
Who are the three users with the most mentions in tweets?,"MATCH (u:User)<-[:MENTIONS]-(t:Tweet)
WITH u, count(t) AS mentions
ORDER BY mentions DESC
LIMIT 3
RETURN u.name, mentions",Simple Aggregation Queries,twitter,False,False,True,
List the first 3 tweets that mention the user with the highest betweenness.,"MATCH (u:User)
WITH u ORDER BY u.betweenness DESC LIMIT 1
MATCH (t:Tweet)-[:MENTIONS]->(u)
RETURN t
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
Find the top 5 most recent tweets by 'neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
RETURN t
ORDER BY t.created_at DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
What are the top 3 hashtags used by 'neo4j' in their tweets?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN h.name, count(t) AS usage
ORDER BY usage DESC
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
Who are the top 5 followers of 'neo4j' by number of followers?,"MATCH (u:User {screen_name: 'neo4j'})<-[:FOLLOWS]-(follower:User)
RETURN follower
ORDER BY follower.followers DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
Find the tweets where 'neo4j' has been mentioned by users with more than 10000 followers.,"MATCH (u:User)-[:MENTIONS]->(m:User {screen_name: 'neo4j'})
WHERE u.followers > 10000
MATCH (u)-[:POSTS]->(t:Tweet)
RETURN t",Pathfinding Queries,twitter,False,False,False,
Which users followed by 'neo4j' also follow 'Me'?,"MATCH (u:User {screen_name: 'neo4j'})-[:FOLLOWS]->(other:User)-[:FOLLOWS]->(me:Me)
RETURN other",Pathfinding Queries,twitter,False,False,True,
List all the hashtags used in tweets that mention 'neo4j'.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {screen_name: 'neo4j'})
MATCH (t)-[:TAGS]->(h:Hashtag)
RETURN DISTINCT h.name",Pathfinding Queries,twitter,False,False,True,
Which tweets by 'neo4j' use the source named 'Buffer'?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:USING]->(s:Source {name: 'Buffer'})
RETURN t",Pathfinding Queries,twitter,False,False,True,
Find the top 5 tweets mentioning 'neo4j' with the most favorites.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User)
WHERE u.name = 'Neo4j'
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
What are the locations of the top 3 users who interact with 'neo4j'?,"MATCH (u:User {screen_name: 'neo4j'})-[:INTERACTS_WITH]->(other:User)
RETURN other.location AS Location
ORDER BY other.followers DESC
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
List the top 5 users who have mentioned 'neo4j' in their tweets.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(m:User {screen_name: 'neo4j'})
RETURN u.name AS UserName, count(t) AS MentionsCount
ORDER BY MentionsCount DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
Which tweets made by 'neo4j' were retweeted by users with more than 10000 followers?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
WHERE exists {
    (t)<-[:RETWEETS]-(other:User)
    WHERE other.followers > 10000
}
RETURN t",Pathfinding Queries,twitter,False,False,False,
How many users does 'neo4j' amplify?,"MATCH (me:Me {screen_name: 'neo4j'})-[:AMPLIFIES]->(user:User)
RETURN count(user) AS AmplifiedUsersCount",Pathfinding Queries,twitter,False,False,True,
Find the top 3 tweets with the most retweets made by 'neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
WITH t, size((t)-[:RETWEETS]->()) AS retweet_count
ORDER BY retweet_count DESC
LIMIT 3
RETURN t, retweet_count",Pathfinding Queries,twitter,True,False,False,
Which users followed by 'neo4j' have the highest betweenness values?,"MATCH (u:User {screen_name: 'neo4j'})-[:FOLLOWS]->(f:User)
RETURN f
ORDER BY f.betweenness DESC",Pathfinding Queries,twitter,False,False,True,
What are the profile image URLs of users who follow 'neo4j'?,"MATCH (u:User)-[:FOLLOWS]->(m:Me {screen_name: 'neo4j'})
RETURN u.profile_image_url",Pathfinding Queries,twitter,False,False,True,
List all the links contained in tweets posted by 'neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN l.url AS LinkURL",Pathfinding Queries,twitter,False,False,True,
Which tweets by 'neo4j' contain the hashtag 'education'?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN t",Pathfinding Queries,twitter,False,False,True,
"Who are the top 3 users that 'neo4j' interacts with, sorted by interaction frequency?","MATCH (u:User {screen_name: 'neo4j'})-[:INTERACTS_WITH]->(other:User)
WITH other, count(*) AS interactions
ORDER BY interactions DESC
LIMIT 3
RETURN other.name, other.screen_name, interactions",Pathfinding Queries,twitter,False,False,True,
Which users following 'neo4j' have tweeted about 'education'?,"MATCH (u:User)-[:FOLLOWS]->(neo:User {screen_name: 'neo4j'}),
      (u)-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN u.name AS UserName, t.text AS TweetText",Pathfinding Queries,twitter,False,False,False,
List the top 3 tweets with hashtags posted by 'neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN t, COLLECT(h.name) AS hashtags
ORDER BY t.favorites DESC
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
Which users mentioned by 'neo4j' in tweets have the highest betweenness?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:MENTIONS]->(mentioned:User)
RETURN mentioned.name, mentioned.betweenness
ORDER BY mentioned.betweenness DESC",Pathfinding Queries,twitter,False,False,True,
What are the profile URLs of the top 3 users followed by 'neo4j'?,"MATCH (u:User {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed.profile_image_url
ORDER BY followed.followers DESC
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
Which users follow 'neo4j' and are located in 'Graphs Are Everywhere'?,"MATCH (u:User)-[:FOLLOWS]->(m:Me {screen_name: 'neo4j', location: 'Graphs Are Everywhere'})
RETURN u",Pathfinding Queries,twitter,False,False,True,
List all tweets that 'neo4j' has replied to.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:REPLY_TO]->(rt:Tweet)
RETURN rt",Pathfinding Queries,twitter,False,False,True,
Who are the top 3 users amplified by 'Me'?,"MATCH (me:Me)-[:AMPLIFIES]->(user:User)
RETURN user
ORDER BY user.followers DESC
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
List the top 5 tweets by 'neo4j' with the most favorites.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
Which users have retweeted 'neo4j''s tweets the most?,"MATCH (u:User)-[:POSTS]->(t:Tweet)<-[:RETWEETS]-(rt:Tweet)<-[:POSTS]-(ru:User)
WHERE u.screen_name = 'neo4j'
RETURN ru.screen_name AS Retweeter, count(rt) AS Retweets
ORDER BY Retweets DESC",Pathfinding Queries,twitter,False,False,True,
List the top 3 users similar to 'neo4j' by similarity score.,"MATCH (u:User {screen_name: 'neo4j'})-[:SIMILAR_TO]->(similar:User)
RETURN similar
ORDER BY similar.score DESC
LIMIT 3",Pathfinding Queries,twitter,False,False,False,User.score
Who does 'neo4j' interact with most frequently?,"MATCH (u:User {screen_name: 'neo4j'})-[:INTERACTS_WITH]->(other:User)
RETURN other, count(*) AS interactions
ORDER BY interactions DESC
LIMIT 1",Pathfinding Queries,twitter,False,False,True,
Find tweets that contain links and were posted by 'neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN t, l",Pathfinding Queries,twitter,False,False,True,
Which users are followed by 'neo4j' and have more than 10000 followers?,"MATCH (u:User {screen_name: 'neo4j'})-[:FOLLOWS]->(f:User)
WHERE f.followers > 10000
RETURN f",Pathfinding Queries,twitter,False,False,True,
List all the sources used by 'neo4j' for tweeting.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:USING]->(s:Source)
RETURN s.name AS SourceName",Pathfinding Queries,twitter,False,False,True,
Identify the top 3 users by the number of people they are following.,"MATCH (u:User)
RETURN u.name, u.screen_name, count{(u)-[:FOLLOWS]->(:User)} AS followingCount
ORDER BY followingCount DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
List the URLs of tweets posted by 'neo4j' that contain links.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN t.id AS TweetID, l.url AS LinkURL",Pathfinding Queries,twitter,False,False,True,
Who are the top 5 users based on the number of statuses they have posted?,"MATCH (u:User)
RETURN u.name, u.screen_name, u.statuses
ORDER BY u.statuses DESC
LIMIT 5",Simple Aggregation Queries,twitter,False,False,True,
What are the names of the top 5 users with the highest betweenness?,"MATCH (u:User)
RETURN u.name
ORDER BY u.betweenness DESC
LIMIT 5",Simple Aggregation Queries,twitter,False,False,True,
Find tweets that mention 'Neo4j' and are tagged with 'education'.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {name: 'Neo4j'}),
      (t)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN t",Simple Retrieval Queries,twitter,False,False,False,
Identify the users who are mentioned and retweeted in the same tweet.,"MATCH (u:User)-[:MENTIONS]->(t:Tweet)-[:RETWEETS]->(t2:Tweet)
RETURN DISTINCT u",Simple Retrieval Queries,twitter,False,False,False,
Retrieve the top 3 users sorted by their following count in descending order.,"MATCH (u:User)
RETURN u
ORDER BY u.following DESC
LIMIT 3",Simple Retrieval Queries,twitter,False,False,True,
Which users have posted tweets containing the link 'https://twitter.com/i/web/status/13718150212657479'?,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link {url: 'https://twitter.com/i/web/status/13718150212657479'})
RETURN u",Simple Retrieval Queries,twitter,False,False,False,
List the screen names of users who follow at least 100 other users.,"MATCH (u:User)
WHERE size((u)-[:FOLLOWS]->()) >= 100
RETURN u.screen_name",Simple Retrieval Queries,twitter,True,False,False,
What is the location of the user with the highest betweenness value?,"MATCH (u:User)
RETURN u.location AS Location
ORDER BY u.betweenness DESC
LIMIT 1",Simple Retrieval Queries,twitter,False,False,True,
How many followers does the user with screen name 'neo4j' have?,"MATCH (u:User {screen_name: 'neo4j'})
RETURN u.followers AS followers",Simple Retrieval Queries,twitter,False,False,True,
Show all users followed by 'Me' with more than 10000 followers.,"MATCH (me:Me)-[:FOLLOWS]->(user:User)
WHERE user.followers > 10000
RETURN user",Simple Retrieval Queries,twitter,False,False,True,
Retrieve the top 5 tweets with the most favorites.,"MATCH (t:Tweet)
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Simple Retrieval Queries,twitter,False,False,True,
Which users are amplified by 'Me'?,"MATCH (me:Me)-[:AMPLIFIES]->(user:User)
RETURN user",Simple Retrieval Queries,twitter,False,False,True,
List all tweets that reply to the tweet with ID 1371815021265747970.,"MATCH (t:Tweet)-[:REPLY_TO]->(original:Tweet {id_str: ""1371815021265747970""})
RETURN t",Simple Retrieval Queries,twitter,False,False,False,
What are the names of all hashtags used in tweets from 'Neo4j'?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN h.name",Simple Retrieval Queries,twitter,False,False,True,
Find all tweets posted by 'Neo4j' between January and February 2021.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)
WHERE t.created_at >= datetime('2021-01-01T00:00:00Z') AND t.created_at <= datetime('2021-02-28T23:59:59Z')
RETURN t",Simple Retrieval Queries,twitter,False,False,True,
Show the sources used by tweets that mention 'Neo4j'.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {name: 'Neo4j'})
MATCH (t)-[:USING]->(s:Source)
RETURN DISTINCT s.name",Simple Retrieval Queries,twitter,False,False,True,
Display tweets that use the source named 'Buffer'.,"MATCH (t:Tweet)-[:USING]->(s:Source {name: 'Buffer'})
RETURN t",Simple Retrieval Queries,twitter,False,False,True,
List the names of users who have interacted with 'Neo4j'.,"MATCH (u:User)-[:INTERACTS_WITH]->(m:User {name: 'Neo4j'})
RETURN u.name",Simple Retrieval Queries,twitter,False,False,False,
Which users are similar to 'Neo4j' with a similarity score above 0.5?,"MATCH (u:User {name: 'Neo4j'})-[:SIMILAR_TO {score: score}]->(similar:User)
WHERE score > 0.5
RETURN similar",Simple Retrieval Queries,twitter,True,False,False,
Find all tweets that retweet the tweet with ID 690028662083612672.,"MATCH (original:Tweet {id: 690028662083612672})<-[:RETWEETS]-(retweet:Tweet)
RETURN retweet",Simple Retrieval Queries,twitter,False,False,False,
Show the top 3 users with the highest number of statuses.,"MATCH (u:User)
RETURN u.name, u.screen_name, u.statuses
ORDER BY u.statuses DESC
LIMIT 3",Simple Retrieval Queries,twitter,False,False,True,
What are the URLs of the links contained in tweets from 'Neo4j'?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN l.url",Simple Retrieval Queries,twitter,False,False,True,
List all users who follow 'Neo4j' and have a betweenness greater than 1000000.,"MATCH (u:User)-[:FOLLOWS]->(m:Me {name: 'Neo4j'})
WHERE u.betweenness > 1000000
RETURN u",Simple Retrieval Queries,twitter,False,False,False,
Which users are mentioned in the tweet with ID 1371846247913512966?,"MATCH (t:Tweet {id: 1371846247913512966})-[:MENTIONS]->(u:User)
RETURN u",Simple Retrieval Queries,twitter,False,False,False,
Retrieve the top 5 most recent tweets.,"MATCH (t:Tweet)
RETURN t
ORDER BY t.created_at DESC
LIMIT 5",Simple Retrieval Queries,twitter,False,False,True,
What are the profile image URLs of users located in 'Graphs Are Everywhere'?,"MATCH (u:User {location: 'Graphs Are Everywhere'})
RETURN u.profile_image_url",Simple Retrieval Queries,twitter,False,False,True,
Find all users who have more than 30000 followers.,"MATCH (u:User)
WHERE u.followers > 30000
RETURN u",Simple Retrieval Queries,twitter,False,False,True,
List all tweets tagged with the hashtag 'education'.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN t",Simple Retrieval Queries,twitter,False,False,True,
Which users follow 'Neo4j'?,"MATCH (u:User)-[:FOLLOWS]->(m:Me {name: 'Neo4j'})
RETURN u",Simple Retrieval Queries,twitter,False,False,True,
Who are the top 3 users mentioned in the tweets that 'Neo4j' mentions?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:MENTIONS]->(mentioned:User)
RETURN mentioned.name, count(*) AS mentions
ORDER BY mentions DESC
LIMIT 3",Verbose query,twitter,False,False,True,
How many users does 'Neo4j' follow?,"MATCH (u:User {name: 'Neo4j'})-[:FOLLOWS]->(followed)
RETURN count(followed) AS followingCount",Simple Retrieval Queries,twitter,False,False,True,
What is the text of the most favorited tweet?,"MATCH (t:Tweet)
RETURN t.text AS text
ORDER BY t.favorites DESC
LIMIT 1",Simple Retrieval Queries,twitter,False,False,True,
List all users retweeted by 'Me'.,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweetedTweet:Tweet)-[:POSTS]-(user:User)
WHERE me.name = 'Neo4j'
RETURN user",Simple Retrieval Queries,twitter,False,False,True,
List the top 5 users by number of followers.,"MATCH (u:User)
RETURN u
ORDER BY u.followers DESC
LIMIT 5",Complex Retrieval Queries,twitter,False,False,True,
List the 3 tweets by Neo4j that have been retweeted by users with more than 10000 followers.,"MATCH (u:User {name: ""Neo4j""})-[:POSTS]->(t:Tweet)
WHERE exists {
  (t)<-[:RETWEETS]-(other:User)
  WHERE other.followers > 10000
}
RETURN t
LIMIT 3",Complex Retrieval Queries,twitter,False,False,False,
Which 3 tweets by Neo4j have the most favorites and were posted in 2020?,"MATCH (u:User {name: ""Neo4j""})-[:POSTS]->(t:Tweet)
WHERE t.created_at >= datetime('2020-01-01T00:00:00Z') AND t.created_at <= datetime('2020-12-31T23:59:59Z')
RETURN t
ORDER BY t.favorites DESC
LIMIT 3",Complex Retrieval Queries,twitter,False,False,True,
Find the top 3 users who amplified tweets by Neo4j and have a high betweenness score.,"MATCH (me:Me {name: ""Neo4j""})-[:POSTS]->(tweet:Tweet)<-[:AMPLIFIES]-(user:User)
WHERE user.betweenness IS NOT NULL
RETURN user
ORDER BY user.betweenness DESC
LIMIT 3",Complex Retrieval Queries,twitter,False,False,False,
Who are the top 5 users followed by Neo4j that have tweeted more than 1000 times?,"MATCH (n:User {name: ""Neo4j""})-[:FOLLOWS]->(u:User)
WHERE u.statuses > 1000
RETURN u
ORDER BY u.statuses DESC
LIMIT 5",Complex Retrieval Queries,twitter,False,False,True,
List the top 3 sources used by tweets mentioning 'Neo4j' and containing a hashtag.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {name: 'Neo4j'})
WHERE exists{(t)-[:TAGS]->(:Hashtag)}
MATCH (t)-[:USING]->(s:Source)
RETURN s.name, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3",Complex Retrieval Queries,twitter,False,False,True,
Which 3 users with the highest betweenness have tweeted about 'education'?,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
WHERE u.betweenness IS NOT NULL
RETURN u
ORDER BY u.betweenness DESC
LIMIT 3",Complex Retrieval Queries,twitter,False,False,True,
Find the 3 most recent tweets by Neo4j.,"MATCH (u:User {name: ""Neo4j""})-[:POSTS]->(t:Tweet)
RETURN t
ORDER BY t.created_at DESC
LIMIT 3",Complex Retrieval Queries,twitter,False,False,True,
Identify the top 5 tweets with texts containing the word 'education'.,"MATCH (t:Tweet)
WHERE t.text CONTAINS 'education'
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Complex Retrieval Queries,twitter,False,False,True,
Which 3 users have the most followers among those who have interacted with Neo4j?,"MATCH (u:User)-[:INTERACTS_WITH]->(neo4j:User {screen_name: 'neo4j'})
RETURN u.name, u.followers
ORDER BY u.followers DESC
LIMIT 3",Complex Retrieval Queries,twitter,False,False,False,
List the tweets containing the link 'https://twitter.com/i/web/status/13718150212657479' and were created in March 2021.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link {url: 'https://twitter.com/i/web/status/13718150212657479'})
WHERE t.created_at >= datetime('2021-03-01T00:00:00Z') AND t.created_at <= datetime('2021-03-31T23:59:59Z')
RETURN t",Complex Retrieval Queries,twitter,False,False,False,
What are the 3 most common hashtags in tweets that have been retweeted more than 100 times?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.favorites > 100
RETURN h.name, count(h) AS hashtag_count
ORDER BY hashtag_count DESC
LIMIT 3",Complex Retrieval Queries,twitter,False,False,False,
Identify the top 5 tweets that mention Neo4j and contain a link.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {name: ""Neo4j""})
WHERE EXISTS {
  (t)-[:CONTAINS]->(:Link)
}
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Complex Retrieval Queries,twitter,False,False,True,
Which 3 tweets posted by Neo4j have the most replies?,"MATCH (u:User {name: ""Neo4j""})-[:POSTS]->(t:Tweet)
WITH t, size((t)-[:REPLY_TO]->(:Tweet)) AS replies
ORDER BY replies DESC
LIMIT 3
RETURN t",Complex Retrieval Queries,twitter,True,False,False,
List 3 users who have posted tweets tagging the hashtag 'education'.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN u
LIMIT 3",Complex Retrieval Queries,twitter,False,False,True,
Who are the top 3 users that Neo4j has retweeted mentions from?,"MATCH (neo4j:User {name: ""Neo4j""})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweet:Tweet)-[:MENTIONS]->(mentioned:User)
RETURN mentioned.name, COUNT(*) AS mentions_count
ORDER BY mentions_count DESC
LIMIT 3",Complex Retrieval Queries,twitter,False,False,True,
Find the top 5 tweets by Neo4j that have been retweeted and mention another user.,"MATCH (u:User {name: ""Neo4j""})-[:POSTS]->(t:Tweet)
WHERE exists{(t)-[:RETWEETS]->(:Tweet)} AND exists{(t)-[:MENTIONS]->(:User)}
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Complex Retrieval Queries,twitter,False,False,True,
Which 3 users amplified Neo4j the most?,"MATCH (u:User)-[:AMPLIFIES]->(m:Me {name: ""Neo4j""})
RETURN u, count(*) AS amplification_count
ORDER BY amplification_count DESC
LIMIT 3",Complex Retrieval Queries,twitter,False,False,False,
List the top 3 tweets that retweet content from Neo4j.,"MATCH (neo:User {name: ""Neo4j""})-[:POSTS]->(originalTweet:Tweet)
MATCH (tweet:Tweet)-[:RETWEETS]->(originalTweet)
RETURN tweet
ORDER BY tweet.favorites DESC
LIMIT 3",Complex Retrieval Queries,twitter,False,False,True,
Who are the 5 users with the most interactions with other users?,"MATCH (u:User)-[:INTERACTS_WITH]->(other:User)
WITH u, count(other) AS interactions
ORDER BY interactions DESC
LIMIT 5
RETURN u.name, interactions",Complex Retrieval Queries,twitter,False,False,True,
What are the top 3 sources used in the tweets that mention Neo4j?,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {name: ""Neo4j""})
MATCH (t)-[:USING]->(s:Source)
RETURN s.name, count(t) AS mentions
ORDER BY mentions DESC
LIMIT 3",Complex Retrieval Queries,twitter,False,False,True,
List the top 3 hashtags used in tweets posted by users from 'Graphs Are Everywhere'.,"MATCH (u:User {location: 'Graphs Are Everywhere'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN h.name, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3",Complex Retrieval Queries,twitter,False,False,True,
Which 5 users are most similar to Neo4j based on the SIMILAR_TO score?,"MATCH (u:User {name: ""Neo4j""})-[:SIMILAR_TO]->(similar:User)
RETURN similar
ORDER BY similar.score DESC
LIMIT 5",Complex Retrieval Queries,twitter,False,False,False,User.score
Find 3 tweets that contain links and were created in 2021.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WHERE t.created_at >= datetime('2021-01-01T00:00:00Z') AND t.created_at <= datetime('2021-12-31T23:59:59Z')
RETURN t
LIMIT 3",Complex Retrieval Queries,twitter,False,False,True,
Identify 5 users who follow more than 5000 users but have fewer than 10000 followers.,"MATCH (u:User)
WHERE u.following > 5000 AND u.followers < 10000
RETURN u
LIMIT 5",Complex Retrieval Queries,twitter,False,False,True,
What are the names of the top 5 users with the highest betweenness centrality?,"MATCH (u:User)
RETURN u.name AS UserName
ORDER BY u.betweenness DESC
LIMIT 5",Complex Retrieval Queries,twitter,False,False,True,
List 3 users who follow Neo4j and have a location specified as 'Graphs Are Everywhere'.,"MATCH (u:User)-[:FOLLOWS]->(m:Me {name: 'Neo4j', location: 'Graphs Are Everywhere'})
WHERE u.location = 'Graphs Are Everywhere'
RETURN u
LIMIT 3",Complex Retrieval Queries,twitter,False,False,False,
Who are the top 5 most followed users that Neo4j follows?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(user:User)
RETURN user
ORDER BY user.followers DESC
LIMIT 5",Complex Retrieval Queries,twitter,False,False,True,
Find the top 3 tweets with the highest number of favorites.,"MATCH (t:Tweet)
RETURN t
ORDER BY t.favorites DESC
LIMIT 3",Complex Retrieval Queries,twitter,False,False,True,
Which users have more than 10000 followers and less than 15000 statuses?,"MATCH (u:User)
WHERE u.followers > 10000 AND u.statuses < 15000
RETURN u",Complex Retrieval Queries,twitter,False,False,True,
List the screen names of the first 3 users who have the most followers.,"MATCH (u:User)
RETURN u.screen_name
ORDER BY u.followers DESC
LIMIT 3",Simple Aggregation Queries,twitter,False,False,True,
What are the names of the top 3 users with the most followers who follow 'neo4j'?,"MATCH (u:User)-[:FOLLOWS]->(m:Me {screen_name: 'neo4j'})
RETURN u.name AS UserName, u.followers AS Followers
ORDER BY u.followers DESC
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
Find the top 5 users who have retweeted tweets made by 'neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)<-[:RETWEETS]-(rt:Tweet)<-[:POSTS]-(retweeter:User)
RETURN retweeter, count(rt) AS retweets
ORDER BY retweets DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
List all the tweets by 'neo4j' that reply to another tweet.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:REPLY_TO]->(other:Tweet)
RETURN t, other",Pathfinding Queries,twitter,False,False,True,
Which users have a profile image URL and follow 'Neo4j'? Show the first 3.,"MATCH (u:User)-[:FOLLOWS]->(m:Me {name: 'Neo4j'})
WHERE u.profile_image_url IS NOT NULL
RETURN u
LIMIT 3",Verbose query,twitter,False,False,True,
List the top 5 users that 'Neo4j' retweeted and who have a following of more than 10000.,"MATCH (neo:User {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweet:Tweet)-[:POSTS]-(retweetedUser:User)
WHERE retweetedUser.following > 10000
RETURN retweetedUser
ORDER BY retweetedUser.following DESC
LIMIT 5",Verbose query,twitter,False,False,True,
Identify the first 3 tweets that 'Neo4j' has amplified and were posted in 2021.,"MATCH (me:Me {name: 'Neo4j'})-[:AMPLIFIES]->(user:User)-[:POSTS]->(tweet:Tweet)
WHERE tweet.created_at >= datetime('2021-01-01T00:00:00Z') AND tweet.created_at < datetime('2022-01-01T00:00:00Z')
RETURN tweet
ORDER BY tweet.created_at ASC
LIMIT 3",Verbose query,twitter,False,False,True,
What are the top 5 tweets by 'Neo4j' that contain the hashtag 'education' and were created in 2021?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
WHERE t.created_at >= datetime('2021-01-01T00:00:00Z') AND t.created_at <= datetime('2021-12-31T23:59:59Z')
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Verbose query,twitter,False,False,True,
List the first 3 users who follow 'Neo4j' and have a betweenness score of exactly 349332601.0.,"MATCH (u:User)-[:FOLLOWS]->(m:Me {name: 'Neo4j'})
WHERE u.betweenness = 349332601.0
RETURN u
LIMIT 3",Verbose query,twitter,False,False,False,
Identify the top 5 hashtags used in tweets that mention 'Neo4j' and were created in 2021.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.created_at >= datetime('2021-01-01T00:00:00Z') AND t.created_at <= datetime('2021-12-31T23:59:59Z')
  AND exists{(t)-[:MENTIONS]->(:User {name: 'Neo4j'})}
RETURN h.name, count(t) AS mentions
ORDER BY mentions DESC
LIMIT 5",Verbose query,twitter,False,False,True,
What are the first 3 tweets posted by 'Neo4j' that include a source named 'Buffer'?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:USING]->(s:Source {name: 'Buffer'})
RETURN t
ORDER BY t.created_at ASC
LIMIT 3",Verbose query,twitter,False,False,True,
List the top 5 tweets that include a link and were posted by users following 'Neo4j'.,"MATCH (u:User)-[:FOLLOWS]->(m:Me {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN t
ORDER BY t.created_at DESC
LIMIT 5",Verbose query,twitter,False,False,True,
Identify the top 5 users who interact with 'Neo4j' and have a location specified as 'Graphs Are Everywhere'.,"MATCH (u:User)-[:INTERACTS_WITH]->(n:User {name: 'Neo4j', location: 'Graphs Are Everywhere'})
WHERE u.location IS NOT NULL
RETURN u
ORDER BY u.followers DESC
LIMIT 5",Verbose query,twitter,False,False,False,
What are the first 3 tweets that 'Neo4j' has retweeted and were tagged with 'education'?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:RETWEETS]->(rt:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN rt
ORDER BY rt.created_at ASC
LIMIT 3",Verbose query,twitter,False,False,False,
Which users follow 'Neo4j' and have tweeted more than 500 times? Show the first 3.,"MATCH (u:User)-[:FOLLOWS]->(m:Me {name: 'Neo4j'})
WHERE u.statuses > 500
RETURN u
LIMIT 3",Verbose query,twitter,False,False,True,
List the top 5 users followed by 'Neo4j' who have a screen_name starting with 'n'.,"MATCH (u:User {name: 'Neo4j'})-[:FOLLOWS]->(f:User)
WHERE f.screen_name STARTS WITH 'n'
RETURN f
ORDER BY f.followers DESC
LIMIT 5",Verbose query,twitter,False,False,True,
Identify the first 3 tweets mentioning 'Neo4j' that also tag a hashtag and were created in 2021.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {name: 'Neo4j'}), (t)-[:TAGS]->(h:Hashtag)
WHERE t.created_at >= datetime('2021-01-01T00:00:00Z') AND t.created_at <= datetime('2021-12-31T23:59:59Z')
RETURN t
LIMIT 3",Verbose query,twitter,False,False,True,
List the first 3 tweets that include a link to 'https://twitter.com' and were favorited more than 100 times.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WHERE l.url CONTAINS 'https://twitter.com' AND t.favorites > 100
RETURN t
LIMIT 3",Verbose query,twitter,False,False,True,
What are the top 5 tweets that link to URLs starting with 'https://' and were posted by 'Neo4j'?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
WHERE l.url STARTS WITH 'https://'
RETURN t
ORDER BY t.created_at DESC
LIMIT 5",Verbose query,twitter,False,False,True,
List the first 3 users that 'Neo4j' follows with the highest number of tweets.,"MATCH (u:User {name: 'Neo4j'})-[:FOLLOWS]->(f:User)
RETURN f
ORDER BY f.statuses DESC
LIMIT 3",Verbose query,twitter,False,False,True,
Identify the top 5 hashtags used in tweets that 'Neo4j' has retweeted.,"MATCH (u:User {name: ""Neo4j""})-[:POSTS]->(:Tweet)-[:RETWEETS]->(rt:Tweet)-[:TAGS]->(h:Hashtag)
RETURN h.name, count(h) AS usage
ORDER BY usage DESC
LIMIT 5",Verbose query,twitter,False,False,True,
What are the first 3 tweets by 'Neo4j' that have been retweeted by other users with more than 10000 followers?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)
WHERE exists {
  (t)-[:RETWEETS]->(rt:Tweet)<-[:POSTS]-(other:User)
  WHERE other.followers > 10000
}
RETURN t
ORDER BY t.created_at ASC
LIMIT 3",Verbose query,twitter,False,False,True,
List the top 5 tweets that have replied to 'Neo4j' and contain a hashtag.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)<-[:REPLY_TO]-(rt:Tweet)-[:TAGS]->(h:Hashtag)
RETURN rt, h
ORDER BY rt.favorites DESC
LIMIT 5",Verbose query,twitter,False,False,True,
Which users have retweeted 'Neo4j' and have a profile image URL? List the first 3.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:RETWEETS]->(:Tweet)-[:MENTIONS]->(m:User {name: 'Neo4j'})
WHERE u.profile_image_url IS NOT NULL
RETURN u
LIMIT 3",Verbose query,twitter,False,False,True,
Identify the top 5 users who have a following between 5000 and 15000 and follow 'Neo4j'.,"MATCH (u:User)-[:FOLLOWS]->(n:User {name: 'Neo4j'})
WHERE u.following >= 5000 AND u.following <= 15000
RETURN u
ORDER BY u.following DESC
LIMIT 5",Verbose query,twitter,False,False,True,
What are the first 3 tweets that 'Neo4j' has mentioned other users in and were created in 2021?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:MENTIONS]->(:User)
WHERE t.created_at >= datetime('2021-01-01T00:00:00Z') AND t.created_at < datetime('2022-01-01T00:00:00Z')
RETURN t
ORDER BY t.created_at ASC
LIMIT 3",Verbose query,twitter,False,False,True,
List the top 5 most recent tweets that 'Neo4j' has posted.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)
RETURN t
ORDER BY t.created_at DESC
LIMIT 5",Verbose query,twitter,False,False,True,
Identify the first 3 users who mention 'Neo4j' and have a location of 'Graphs Are Everywhere'.,"MATCH (u:User)-[:MENTIONS]->(m:Me {name: 'Neo4j', location: 'Graphs Are Everywhere'})
RETURN u
LIMIT 3",Verbose query,twitter,False,False,False,
What are the top 5 tweets that 'Neo4j' has amplified?,"MATCH (me:Me {name: 'Neo4j'})-[:AMPLIFIES]->(tweet:Tweet)
RETURN tweet
ORDER BY tweet.favorites DESC
LIMIT 5",Verbose query,twitter,False,False,False,
Which tweets posted by 'Neo4j' include links and were created in January 2021? Show the first 3.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
WHERE t.created_at >= datetime('2021-01-01T00:00:00Z') AND t.created_at < datetime('2021-02-01T00:00:00Z')
RETURN t, l
LIMIT 3",Verbose query,twitter,False,False,True,
List the first 3 users who have been retweeted by 'Neo4j' and have more than 500 followers.,"MATCH (me:User {name: 'Neo4j'})-[:POSTS]->(:Tweet)-[:RETWEETS]->(tweet:Tweet)-[:MENTIONS]->(user:User)
WHERE user.followers > 500
RETURN user
LIMIT 3",Verbose query,twitter,False,False,True,
What are the top 5 tweets by favorites that were posted by 'Me'?,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)
RETURN tweet
ORDER BY tweet.favorites DESC
LIMIT 5",Verbose query,twitter,False,False,True,
Which users have mentioned 'Neo4j' in their tweets and have a following of more than 20000? Show the top 5.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(m:User {name: 'Neo4j'})
WHERE u.following > 20000
RETURN u.name, u.screen_name, u.following
ORDER BY u.following DESC
LIMIT 5",Verbose query,twitter,False,False,True,
What are the top 5 users who have amplified 'Neo4j' and have a following of more than 5000?,"MATCH (u:User)-[:AMPLIFIES]->(m:Me {name: 'Neo4j'})
WHERE u.following > 5000
RETURN u
ORDER BY u.following DESC
LIMIT 5",Verbose query,twitter,False,False,False,
Identify the first 3 tweets that 'Neo4j' has retweeted and were posted by users with a profile image URL ending in 'normal.jpg'.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:RETWEETS]->(rt:Tweet)<-[:POSTS]-(ou:User)
WHERE ou.profile_image_url ENDS WITH 'normal.jpg'
RETURN rt
LIMIT 3",Verbose query,twitter,False,False,True,
List the top 5 tweets that 'Neo4j' has mentioned and were created after January 2021.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:MENTIONS]->(:User)
WHERE t.created_at > datetime('2021-01-01T00:00:00Z')
RETURN t
ORDER BY t.created_at DESC
LIMIT 5",Verbose query,twitter,False,False,True,
List the profile URLs of the top 3 users by betweenness.,"MATCH (u:User)
WHERE u.betweenness IS NOT NULL
RETURN u.profile_image_url
ORDER BY u.betweenness DESC
LIMIT 3",Simple Retrieval Queries,twitter,False,False,True,
Identify the top 5 tweets with text containing 'critical service'.,"MATCH (t:Tweet)
WHERE t.text CONTAINS 'critical service'
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Simple Retrieval Queries,twitter,False,False,True,
Who are the users that 'Neo4j' mentions in tweets?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:MENTIONS]->(mentioned:User)
RETURN DISTINCT mentioned",Simple Retrieval Queries,twitter,False,False,True,
List the first 3 tweets that retweet tweets created on '2020-12-06'.,"MATCH (t:Tweet)-[:RETWEETS]->(original:Tweet)
WHERE original.created_at = datetime('2020-12-06T00:00:00Z')
RETURN t
LIMIT 3",Simple Retrieval Queries,twitter,False,False,False,
Which tweets by 'Neo4j' mention at least one other user?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
WHERE exists {
    (t)-[:MENTIONS]->(:User)
}
RETURN t",Simple Retrieval Queries,twitter,False,False,True,
What are the top 5 links contained in the tweets posted by users with fewer than 100 followers?,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
WHERE u.followers < 100
RETURN l.url, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 5",Simple Retrieval Queries,twitter,False,False,True,
Identify the top 5 users by betweenness and name starting with 'N'.,"MATCH (u:User)
WHERE u.betweenness IS NOT NULL AND u.name STARTS WITH 'N'
RETURN u
ORDER BY u.betweenness DESC
LIMIT 5",Simple Retrieval Queries,twitter,False,False,True,
List the first 3 tweets with a creation date on '2021-03-16'.,"MATCH (t:Tweet)
WHERE t.created_at = datetime('2021-03-16T00:00:00Z')
RETURN t
LIMIT 3",Simple Retrieval Queries,twitter,False,False,False,
Which users with a location of 'Sweden' follow more than 10 users?,"MATCH (u:User {location: 'Sweden'})
WHERE size{(u)-[:FOLLOWS]->(:User)} > 10
RETURN u",Simple Retrieval Queries,twitter,True,False,False,
What are the profile images of the top 5 users by followers?,"MATCH (u:User)
WHERE u.followers IS NOT NULL
RETURN u.profile_image_url
ORDER BY u.followers DESC
LIMIT 5",Simple Retrieval Queries,twitter,False,False,True,
List the first 3 tweets that link to 'https://twitter.com'.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WHERE l.url STARTS WITH 'https://twitter.com'
RETURN t
LIMIT 3",Simple Retrieval Queries,twitter,False,False,True,
Identify the top 5 hashtags used in tweets from '2020-12-06'.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.created_at = date('2020-12-06')
RETURN h.name, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 5",Simple Retrieval Queries,twitter,False,False,False,
What are the first 3 tweets replied to by 'Neo4j'?,"MATCH (me:Me {name: 'Neo4j'})-[:POSTS]->(tweet:Tweet)-[:REPLY_TO]->(originalTweet:Tweet)
RETURN originalTweet
ORDER BY originalTweet.created_at DESC
LIMIT 3",Simple Retrieval Queries,twitter,False,False,True,
List the first 3 users that 'Neo4j' amplifies.,"MATCH (me:Me {name: 'Neo4j'})-[:AMPLIFIES]->(user:User)
RETURN user
LIMIT 3",Simple Retrieval Queries,twitter,False,False,True,
Which tweets mention 'Neo4j' and were created after '2021-01-01'?,"MATCH (t:Tweet)-[:MENTIONS]->(u:User)
WHERE u.name = 'Neo4j' AND t.created_at > datetime('2021-01-01T00:00:00Z')
RETURN t",Simple Retrieval Queries,twitter,False,False,True,
Who are the top 5 users interacting with 'Neo4j'?,"MATCH (u:User)-[:INTERACTS_WITH]->(m:Me {name: 'Neo4j'})
RETURN u.name, count(u) AS interactions
ORDER BY interactions DESC
LIMIT 5",Simple Retrieval Queries,twitter,False,False,False,
List the first 3 tweets retweeted by users located in 'Graphs Are Everywhere'.,"MATCH (u:User {location: 'Graphs Are Everywhere'})-[:POSTS]->(t:Tweet)-[:RETWEETS]->(rt:Tweet)
RETURN rt
LIMIT 3",Simple Retrieval Queries,twitter,False,False,True,
Which users are followed by 'neo4j' and have more than 500 followers?,"MATCH (u:User {screen_name: 'neo4j'})-[:FOLLOWS]->(f:User)
WHERE f.followers > 500
RETURN f",Simple Retrieval Queries,twitter,False,False,True,
What are the urls for the top 3 links contained in the most retweeted tweets?,"MATCH (t:Tweet)-[:RETWEETS]->(rt:Tweet)
WITH rt, count{(t)-[:RETWEETS]->(rt)} AS retweet_count
ORDER BY retweet_count DESC
LIMIT 1
MATCH (rt)-[:CONTAINS]->(l:Link)
RETURN l.url
LIMIT 3",Simple Retrieval Queries,twitter,False,False,False,
Who are the top 5 users most similar to 'Neo4j' based on the SIMILAR_TO score?,"MATCH (u:User {screen_name: 'neo4j'})-[:SIMILAR_TO]->(similar:User)
RETURN similar.name, similar.screen_name, similar.location, similar.followers
ORDER BY similar.score DESC
LIMIT 5",Simple Retrieval Queries,twitter,False,False,False,User.score
What are the first 3 sources used by the most popular tweets?,"MATCH (t:Tweet)-[:USING]->(s:Source)
WHERE t.favorites >= 394
RETURN s.name, count(t) AS usage_count
ORDER BY usage_count DESC
LIMIT 3",Simple Retrieval Queries,twitter,False,False,True,
List the top 5 tweets by 'Neo4j' based on favorites.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Simple Retrieval Queries,twitter,False,False,True,
Who are the first 3 users mentioned in tweets on '2021-03-16'?,"MATCH (t:Tweet)-[:MENTIONS]->(u:User)
WHERE t.created_at = date('2021-03-16')
RETURN u
LIMIT 3",Simple Retrieval Queries,twitter,False,False,False,
What are the first 3 tweets containing the hashtag 'education'?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN t
ORDER BY t.created_at ASC
LIMIT 3",Simple Retrieval Queries,twitter,False,False,True,
Which users follow 'Neo4j'?,"MATCH (u:User)-[:FOLLOWS]->(m:Me {name: 'Neo4j'})
RETURN u",Simple Retrieval Queries,twitter,False,False,True,
Identify the top 3 tweets with the highest number of favorites.,"MATCH (t:Tweet)
RETURN t
ORDER BY t.favorites DESC
LIMIT 3",Simple Retrieval Queries,twitter,False,False,True,
What are the names of the top 5 users with the most following?,"MATCH (u:User)
RETURN u.name
ORDER BY u.following DESC
LIMIT 5",Simple Retrieval Queries,twitter,False,False,True,
List the first 3 users with the lowest number of followers.,"MATCH (u:User)
RETURN u
ORDER BY u.followers ASC
LIMIT 3",Simple Retrieval Queries,twitter,False,False,True,
Who are the top 5 users with the highest betweenness?,"MATCH (u:User)
RETURN u
ORDER BY u.betweenness DESC
LIMIT 5",Simple Retrieval Queries,twitter,False,False,True,
Identify the first 3 users who have retweeted tweets mentioning 'Neo4j'.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:RETWEETS]->(rt:Tweet)-[:MENTIONS]->(m:User {name: 'Neo4j'})
RETURN u
LIMIT 3",Verbose query,twitter,False,False,True,
"Which users follow 'Neo4j' and have a betweenness score higher than 300,000,000? Show the top 5.","MATCH (u:User)-[:FOLLOWS]->(m:Me {name: 'Neo4j'})
WHERE u.betweenness > 300000000
RETURN u
ORDER BY u.betweenness DESC
LIMIT 5",Verbose query,twitter,False,False,False,
List the first 3 tweets created by users located in 'Graphs Are Everywhere' and posted after December 2020.,"MATCH (u:User {location: 'Graphs Are Everywhere'})-[:POSTS]->(t:Tweet)
WHERE t.created_at > datetime('2020-12-31T23:59:59Z')
RETURN t
ORDER BY t.created_at ASC
LIMIT 3",Verbose query,twitter,False,False,True,
Who are the top 3 users that 'Neo4j' follows and who also follow 'Neo4j'?,"MATCH (n:User {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)-[:FOLLOWS]->(n)
RETURN u
ORDER BY u.followers DESC
LIMIT 3",Verbose query,twitter,False,False,True,
What are the top 3 locations where the most active users are based?,"MATCH (u:User)
WHERE u.statuses IS NOT NULL
RETURN u.location AS Location, count(u) AS NumberOfUsers
ORDER BY NumberOfUsers DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,True,
Identify the top 5 users who are followed by 'Neo4j'.,"MATCH (n:User {name: 'Neo4j'})-[:FOLLOWS]->(u:User)
RETURN u
ORDER BY u.followers DESC
LIMIT 5",Complex Aggregation Queries,twitter,False,False,True,
Which three tweets have the highest retweet counts?,"MATCH (t:Tweet)
RETURN t
ORDER BY t.retweets DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,True,Tweet.retweets
List the screen names of the top 5 users followed by the most number of other users.,"MATCH (u:User)-[:FOLLOWS]->(followed:User)
WITH followed, count(u) AS followersCount
ORDER BY followersCount DESC
LIMIT 5
RETURN followed.screen_name AS ScreenName, followersCount",Complex Aggregation Queries,twitter,False,False,True,
Who are the top 3 users that 'Neo4j' follows?,"MATCH (u:User {name: 'Neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed
ORDER BY followed.followers DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,True,
Find the top 5 hashtags mentioned by 'Neo4j'.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN h.name, count(t) AS mentions
ORDER BY mentions DESC
LIMIT 5",Complex Aggregation Queries,twitter,False,False,True,
Which three users have the highest 'betweenness' metric in the network?,"MATCH (u:User)
RETURN u.name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,True,
What are the names of the top 3 sources most used in tweeting?,"MATCH (t:Tweet)-[:USING]->(s:Source)
RETURN s.name, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,True,
List the URLs of the top 5 most linked-to external sites in tweets.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
RETURN l.url AS ExternalURL, count(l) AS LinksCount
ORDER BY LinksCount DESC
LIMIT 5",Complex Aggregation Queries,twitter,False,False,True,
Which three users are most similar to 'Neo4j' based on the 'SIMILAR_TO' score?,"MATCH (u:User {name: 'Neo4j'})-[:SIMILAR_TO]->(similar:User)
RETURN similar.name, similar.screen_name, similar.location, similar.profile_image_url
ORDER BY similar.score DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,False,User.score
Identify the top 5 users based on the number of posts they have made.,"MATCH (u:User)-[:POSTS]->(t:Tweet)
WITH u, count(t) AS posts_count
ORDER BY posts_count DESC
LIMIT 5
RETURN u, posts_count",Complex Aggregation Queries,twitter,False,False,True,
What are the three most commonly used hashtags in tweets?,"MATCH (:Tweet)-[r:TAGS]->(h:Hashtag)
RETURN h.name, count(r) AS usage
ORDER BY usage DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,True,
List the top 5 most recent tweets based on the 'created_at' date.,"MATCH (t:Tweet)
RETURN t
ORDER BY t.created_at DESC
LIMIT 5",Complex Aggregation Queries,twitter,False,False,True,
Which three tweets have the most mentions of other users?,"MATCH (t:Tweet)-[:MENTIONS]->(u:User)
WITH t, count(u) AS mentions_count
ORDER BY mentions_count DESC
LIMIT 3
RETURN t, mentions_count",Complex Aggregation Queries,twitter,False,False,True,
What are the names of the top 3 users who have a betweenness greater than 300000000?,"MATCH (u:User)
WHERE u.betweenness > 300000000
RETURN u.name
ORDER BY u.betweenness DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,True,
Identify the top 5 tweets with the highest favorite counts.,"MATCH (t:Tweet)
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Complex Aggregation Queries,twitter,False,False,True,
Which three users have tweeted the most as of the latest date in the dataset?,"MATCH (u:User)-[:POSTS]->(t:Tweet)
WITH u, MAX(t.created_at) AS LatestDate
WHERE t.created_at = LatestDate
RETURN u.name AS UserName, COUNT(t) AS TweetsCount
ORDER BY TweetsCount DESC
LIMIT 3",Complex Aggregation Queries,twitter,True,False,False,
List the top 5 users with the highest number of followers.,"MATCH (u:User)
RETURN u
ORDER BY u.followers DESC
LIMIT 5",Complex Aggregation Queries,twitter,False,False,True,
Find the top 3 tweets that mention 'neo4j' and are tagged with 'education'.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {name: 'Neo4j'}),
      (t)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN t
ORDER BY t.favorites DESC
LIMIT 3",Pathfinding Queries,twitter,False,False,False,
Who are the top 5 users that follow both 'neo4j' and 'Me'?,"MATCH (u:User)-[:FOLLOWS]->(neo:User {screen_name: 'neo4j'}),
      (u)-[:FOLLOWS]->(me:Me)
RETURN u
LIMIT 5",Pathfinding Queries,twitter,False,False,False,
List the tweets by 'neo4j' that have been retweeted by more than 5 different users.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
WHERE exists {
  MATCH (other:User)-[:RETWEETS]->(t)
  WITH count(DISTINCT other) AS retweeters
  WHERE retweeters > 5
  RETURN retweeters
}
RETURN t",Pathfinding Queries,twitter,False,False,False,
Which tweets by 'neo4j' have the highest number of favorites?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
RETURN t.text AS TweetText, t.favorites AS Favorites
ORDER BY t.favorites DESC
LIMIT 1",Pathfinding Queries,twitter,False,False,True,
What are the most common locations of users who follow 'neo4j'?,"MATCH (u:User)-[:FOLLOWS]->(m:Me {screen_name: 'neo4j'})
RETURN u.location AS Location, count(u) AS NumberOfUsers
WHERE u.location IS NOT NULL
GROUP BY u.location
ORDER BY NumberOfUsers DESC",Pathfinding Queries,twitter,True,False,False,
Who are the top 3 users that 'neo4j' has the highest similarity scores with?,"MATCH (u:User {screen_name: 'neo4j'})-[:SIMILAR_TO]->(similar:User)
RETURN similar
ORDER BY similar.score DESC
LIMIT 3",Pathfinding Queries,twitter,False,False,False,User.score
Find the top 5 tweets by 'neo4j' tagged with a hashtag.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Pathfinding Queries,twitter,False,False,True,
Which users followed by 'neo4j' have tweeted the most?,"MATCH (u:User {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
WITH followed
MATCH (followed)-[:POSTS]->(t:Tweet)
RETURN followed.name, followed.screen_name, count(t) AS tweets_count
ORDER BY tweets_count DESC",Pathfinding Queries,twitter,False,False,True,
List the top 3 most followed users who mention 'neo4j' in their tweets.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(m:User {name: 'Neo4j'})
WHERE u.followers IS NOT NULL
RETURN u.name, u.followers
ORDER BY u.followers DESC
LIMIT 3",Pathfinding Queries,twitter,False,False,True,
Which tweets by 'neo4j' have been retweeted and also contain a link?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
WHERE exists{(t)-[:RETWEETS]->(:Tweet)}
RETURN t, l",Pathfinding Queries,twitter,False,False,True,
Who are the users that 'neo4j' mentions most frequently in their tweets?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:MENTIONS]->(mentioned:User)
RETURN mentioned.screen_name, count(t) AS mentions_count
ORDER BY mentions_count DESC",Pathfinding Queries,twitter,False,False,True,
Which three tweets contain the word 'graph' in their text?,"MATCH (t:Tweet)
WHERE t.text CONTAINS 'graph'
RETURN t
LIMIT 3",Complex Aggregation Queries,twitter,False,False,True,
Which users with over 10000 followers are located in 'Graphs Are Everywhere'?,"MATCH (u:User)
WHERE u.followers > 10000 AND u.location = 'Graphs Are Everywhere'
RETURN u",Simple Retrieval Queries,twitter,False,False,True,
List the top 5 tweets which mention the user with the highest followers.,"MATCH (u:User)
WITH u ORDER BY u.followers DESC LIMIT 1
MATCH (t:Tweet)-[:MENTIONS]->(u)
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Complex Aggregation Queries,twitter,False,False,True,
Identify the URLs of the top 5 tweets retweeted by 'Neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:RETWEETS]->(rt:Tweet)
RETURN rt.url AS RetweetedURL
ORDER BY rt.favorites DESC
LIMIT 5",Complex Aggregation Queries,twitter,False,False,True,Tweet.url
Identify the first 3 links contained in tweets that have been favorited more than 200 times.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WHERE t.favorites > 200
RETURN l.url
LIMIT 3",Verbose query,twitter,False,False,True,
What are the top 5 hashtags used in tweets by 'Neo4j'?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN h.name, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 5",Verbose query,twitter,False,False,True,
List the first 3 tweets that reply to another tweet and were created before March 2021.,"MATCH (t:Tweet)-[:REPLY_TO]->(:Tweet)
WHERE t.created_at < datetime('2021-03-01T00:00:00Z')
RETURN t
ORDER BY t.created_at DESC
LIMIT 3",Verbose query,twitter,False,False,True,
Identify the top 5 users who have a profile image URL ending with 'normal.jpg' and follow 'Neo4j'.,"MATCH (u:User)-[:FOLLOWS]->(m:Me {name: 'Neo4j'})
WHERE u.profile_image_url ENDS WITH 'normal.jpg'
RETURN u
ORDER BY u.followers DESC
LIMIT 5",Verbose query,twitter,False,False,True,
Which users have amplified 'Neo4j' and also follow more than 1000 users? List the first 3.,"MATCH (u:User)-[:AMPLIFIES]->(m:Me {name: 'Neo4j'})
WHERE u.following > 1000
RETURN u
LIMIT 3",Verbose query,twitter,False,False,False,
List the first 3 users who interact most frequently with 'Neo4j' based on the INTERACTS_WITH relationship.,"MATCH (u:User)-[r:INTERACTS_WITH]->(m:User {name: 'Neo4j'})
WITH u, count(r) AS interactions
ORDER BY interactions DESC
LIMIT 3
RETURN u.name, interactions",Verbose query,twitter,False,False,False,
What are the top 5 sources used in tweets that have been retweeted more than 50 times?,"MATCH (t:Tweet)-[:USING]->(s:Source)
WHERE t.favorites > 50
RETURN s.name, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 5",Verbose query,twitter,False,False,True,
Which tweets mention 'Neo4j' and contain a hashtag? Show the first 3.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {name: 'Neo4j'})
WHERE exists{(t)-[:TAGS]->(:Hashtag)}
RETURN t
LIMIT 3",Verbose query,twitter,False,False,True,
List the first 3 tweets that 'Neo4j' has retweeted.,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:RETWEETS]->(rt:Tweet)
RETURN rt
LIMIT 3",Verbose query,twitter,False,False,True,
Who are the top 3 users followed by 'Me' with the highest betweenness scores?,"MATCH (me:Me)-[:FOLLOWS]->(user:User)
RETURN user
ORDER BY user.betweenness DESC
LIMIT 3",Verbose query,twitter,False,False,True,
List the top 5 users by the number of statuses they have posted.,"MATCH (u:User)
RETURN u.name, u.screen_name, u.statuses
ORDER BY u.statuses DESC
LIMIT 5",Verbose query,twitter,False,False,True,
What are the first 3 tweets that contain a link starting with 'https://twitter.com'?,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WHERE l.url STARTS WITH 'https://twitter.com'
RETURN t
LIMIT 3",Verbose query,twitter,False,False,True,
Identify the first 3 users who mentioned 'Neo4j' in their tweets.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(m:User {name: 'Neo4j'})
RETURN u
LIMIT 3",Verbose query,twitter,False,False,True,
Which users are most similar to 'Neo4j' based on the SIMILAR_TO relationship score? Show the top 5.,"MATCH (u:User {name: 'Neo4j'})-[:SIMILAR_TO]->(similar:User)
RETURN similar.name, similar.screen_name, similar.location, similar.followers
ORDER BY similar.score DESC
LIMIT 5",Verbose query,twitter,False,False,False,User.score
List the first 3 tweets posted using the source named 'Buffer'.,"MATCH (t:Tweet)-[:USING]->(s:Source {name: 'Buffer'})
RETURN t
ORDER BY t.created_at
LIMIT 3",Verbose query,twitter,False,False,True,
Who are the top 5 most followed users that 'Neo4j' follows?,"MATCH (n:User {name: 'Neo4j'})-[:FOLLOWS]->(u:User)
RETURN u.name, u.followers
ORDER BY u.followers DESC
LIMIT 5",Verbose query,twitter,False,False,True,
Identify the top 5 tweets tagged with the hashtag 'education'.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Verbose query,twitter,False,False,True,
Find the first 3 tweets that have been retweeted more than 100 times.,"MATCH (t:Tweet)
WHERE t.favorites > 100
RETURN t
ORDER BY t.created_at ASC
LIMIT 3",Verbose query,twitter,False,False,True,
Which users follow 'Neo4j' and have a location specified as 'Graphs Are Everywhere'?,"MATCH (u:User)-[:FOLLOWS]->(m:Me {name: 'Neo4j', location: 'Graphs Are Everywhere'})
WHERE u.location IS NOT NULL
RETURN u",Verbose query,twitter,False,False,True,
List the first 3 users who have more than 10000 followers.,"MATCH (u:User)
WHERE u.followers > 10000
RETURN u
ORDER BY u.followers DESC
LIMIT 3",Verbose query,twitter,False,False,True,
What are the top 5 users with the highest betweenness scores?,"MATCH (u:User)
RETURN u
ORDER BY u.betweenness DESC
LIMIT 5",Verbose query,twitter,False,False,True,
List the top 5 tweets by 'Neo4j' based on favorite counts.,"MATCH (u:User {name: ""Neo4j""})-[:POSTS]->(t:Tweet)
RETURN t
ORDER BY t.favorites DESC
LIMIT 5",Complex Aggregation Queries,twitter,False,False,True,
Which three tweets have the highest replies?,"MATCH (t:Tweet)
WHERE EXISTS {
    (t)-[:REPLY_TO]->(:Tweet)
}
RETURN t
ORDER BY t.favorites DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,True,
What are the top 3 external sources linked in tweets about software?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag {name: 'software'})
MATCH (t)-[:CONTAINS]->(l:Link)
MATCH (l)-[:USING]->(s:Source)
RETURN s.name, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,False,
Identify the top 5 tweets linking to the most popular external sources.,"MATCH (t:Tweet)-[:USING]->(s:Source)
WITH s, count(t) AS tweets_count
ORDER BY tweets_count DESC
LIMIT 5
MATCH (t:Tweet)-[:USING]->(s)
RETURN t, s",Complex Aggregation Queries,twitter,False,False,True,
Who are the top 3 users that 'Neo4j' has retweeted?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:RETWEETS]->(rt:Tweet)<-[:POSTS]-(retweetUser:User)
RETURN retweetUser.name AS RetweetedUser, count(rt) AS Retweets
ORDER BY Retweets DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,True,
"List the top 5 most active users based on total social interactions (follows, mentions, retweets).","MATCH (u:User)
WITH u, 
     count{(u)-[:FOLLOWS]->(:User)} AS followsCount,
     count{(u)-[:MENTIONS]->(:User)} AS mentionsCount,
     count{(u)-[:RETWEETS]->(:Tweet)} AS retweetsCount
RETURN u.name, u.screen_name, followsCount + mentionsCount + retweetsCount AS totalInteractions
ORDER BY totalInteractions DESC
LIMIT 5",Complex Aggregation Queries,twitter,False,False,True,
Which three users have posted the most about 'education'?,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
WITH u, count(t) AS tweets_about_education
ORDER BY tweets_about_education DESC
LIMIT 3
RETURN u.name, tweets_about_education",Complex Aggregation Queries,twitter,False,False,True,
What are the names of the top 3 hashtags used in tweets about technology?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.text CONTAINS 'technology'
WITH h, count(t) AS tweetCount
ORDER BY tweetCount DESC
LIMIT 3
RETURN h.name AS HashtagName, tweetCount",Complex Aggregation Queries,twitter,False,False,True,
Who are the top 3 users that have interacted the most with 'Neo4j'?,"MATCH (u:User)-[:INTERACTS_WITH]->(n:User {name: 'Neo4j'})
RETURN u.name, count(u) AS interactions
ORDER BY interactions DESC
LIMIT 3",Complex Aggregation Queries,twitter,False,False,False,
What are the first 3 sources used in tweets that 'Neo4j' retweets?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:RETWEETS]->(rt:Tweet)-[:USING]->(s:Source)
RETURN s.name
LIMIT 3",Verbose query,twitter,False,False,True,
